/*
 * sweethome3d.min.js  version 6.6.4i
 *
 * Sweet Home 3D, Copyright (c) 2022 Emmanuel PUYBARET / eTeks <info@eteks.com>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
var __extends=(this&&this.__extends)||(function(){var a=function(e,c){a=Object.setPrototypeOf||({__proto__:[]} instanceof Array&&function(g,f){g.__proto__=f})||function(h,f){for(var g in f){if(f.hasOwnProperty(g)){h[g]=f[g]}}};return a(e,c)};return function(f,c){a(f,c);function e(){this.constructor=f}f.prototype=c===null?Object.create(c):(e.prototype=c.prototype,new e())}})();var HomeXMLHandler=(function(b){__extends(a,b);function a(c){var g=this;if(((c!=null&&c instanceof UserPreferences)||c===null)){var f=arguments;g=b.call(this)||this;if(g.preferences===undefined){g.preferences=null}if(g.home===undefined){g.home=null}if(g.homeElementName===undefined){g.homeElementName=null}if(g.labelText===undefined){g.labelText=null}if(g.leftSideBaseboard===undefined){g.leftSideBaseboard=null}if(g.rightSideBaseboard===undefined){g.rightSideBaseboard=null}if(g.homeBackgroundImage===undefined){g.homeBackgroundImage=null}if(g.backgroundImage===undefined){g.backgroundImage=null}if(g.materialTexture===undefined){g.materialTexture=null}g.buffer={str:"",toString:function(){return this.str}};g.elements=([]);g.attributes=([]);g.groupsFurniture=([]);g.properties=([]);g.textStyles=([]);g.levels=({});g.joinedWalls=({});g.textures=({});g.materials=([]);g.transformations=([]);g.sashes=([]);g.lightSources=([]);g.points=([]);g.furnitureVisibleProperties=([]);g.preferences=c!=null?c:new DefaultUserPreferences(false,null)}else{if(c===undefined){var f=arguments;var d=arguments;var e=null;g=b.call(this)||this;if(g.preferences===undefined){g.preferences=null}if(g.home===undefined){g.home=null}if(g.homeElementName===undefined){g.homeElementName=null}if(g.labelText===undefined){g.labelText=null}if(g.leftSideBaseboard===undefined){g.leftSideBaseboard=null}if(g.rightSideBaseboard===undefined){g.rightSideBaseboard=null}if(g.homeBackgroundImage===undefined){g.homeBackgroundImage=null}if(g.backgroundImage===undefined){g.backgroundImage=null}if(g.materialTexture===undefined){g.materialTexture=null}g.buffer={str:"",toString:function(){return this.str}};g.elements=([]);g.attributes=([]);g.groupsFurniture=([]);g.properties=([]);g.textStyles=([]);g.levels=({});g.joinedWalls=({});g.textures=({});g.materials=([]);g.transformations=([]);g.sashes=([]);g.lightSources=([]);g.points=([]);g.furnitureVisibleProperties=([]);g.preferences=e!=null?e:new DefaultUserPreferences(false,null);if(g.preferences===undefined){g.preferences=null}if(g.home===undefined){g.home=null}if(g.homeElementName===undefined){g.homeElementName=null}if(g.labelText===undefined){g.labelText=null}if(g.leftSideBaseboard===undefined){g.leftSideBaseboard=null}if(g.rightSideBaseboard===undefined){g.rightSideBaseboard=null}if(g.homeBackgroundImage===undefined){g.homeBackgroundImage=null}if(g.backgroundImage===undefined){g.backgroundImage=null}if(g.materialTexture===undefined){g.materialTexture=null}g.buffer={str:"",toString:function(){return this.str}};g.elements=([]);g.attributes=([]);g.groupsFurniture=([]);g.properties=([]);g.textStyles=([]);g.levels=({});g.joinedWalls=({});g.textures=({});g.materials=([]);g.transformations=([]);g.sashes=([]);g.lightSources=([]);g.points=([]);g.furnitureVisibleProperties=([])}else{throw new Error("invalid overload")}}return g}a.prototype.startDocument=function(){this.home=null;(this.elements.length=0);(this.attributes.length=0);(this.groupsFurniture.length=0);(function(c){for(var d in c){delete c[d]}})(this.levels);(function(c){for(var d in c){delete c[d]}})(this.joinedWalls)};a.prototype.startElement=function(h,d,f,c){var j=this;(function(l,k){return l.str=l.str.substring(0,k)})(this.buffer,0);(this.elements.push(f)>0);var e=({});for(var g=0;g<c.getLength();g++){(e[c.getQName(g)]=c.getValue(g).replace("&quot;",'"').replace("&lt;","<").replace("&gt;",">").replace("&amp;","&"))}(this.attributes.push(e)>0);if(!("property"===f)&&!("furnitureVisibleProperty"===f)&&!("textStyle"===f)){(this.properties.push({})>0);(this.textStyles.push({})>0)}if("home"===f){this.setHome(this.createHome(f,e));(this.furnitureVisibleProperties.length=0);this.homeBackgroundImage=null}else{if("environment"===f){(function(k){for(var l in k){delete k[l]}})(this.textures)}else{if("level"===f){this.backgroundImage=null}else{if(("pieceOfFurniture"===f)||("doorOrWindow"===f)||("light"===f)||("furnitureGroup"===f)){(function(k){for(var l in k){delete k[l]}})(this.textures);(this.materials.length=0);(this.transformations.length=0);(this.sashes.length=0);(this.lightSources.length=0);if("furnitureGroup"===f){(this.groupsFurniture.push([])>0)}}else{if("room"===f){(function(k){for(var l in k){delete k[l]}})(this.textures);(this.points.length=0)}else{if("polyline"===f){(this.points.length=0)}else{if("label"===f){this.labelText=null}else{if("wall"===f){(function(k){for(var l in k){delete k[l]}})(this.textures);this.leftSideBaseboard=null;this.rightSideBaseboard=null}else{if("baseboard"===f){(function(l){var k=j.textures[a.UNIQUE_ATTRIBUTE];delete j.textures[a.UNIQUE_ATTRIBUTE];return k})(this.textures)}else{if("material"===f){this.materialTexture=null}}}}}}}}}}};a.prototype.characters=function(c,e,d){(function(f){f.str+=c.substr(e,d);return f})(this.buffer)};a.prototype.endElement=function(n,j,E){this.elements.pop();var q=(this.elements.length==0)?null:(function(F){return F.length==0?null:F[F.length-1]})(this.elements);var y=this.attributes.pop();if(this.homeElementName!=null&&(this.homeElementName===E)){this.setHomeAttributes(this.home,E,y)}else{if("furnitureVisibleProperty"===E){try{if((function(F,G){return F[G]===undefined?null:F[G]})(y,"name")==null){throw new SAXException("Missing name attribute")}(this.furnitureVisibleProperties.push((function(F,G){return F[G]===undefined?null:F[G]})(y,"name"))>0)}catch(A){}}else{if("environment"===E){this.setEnvironmentAttributes(this.home.getEnvironment(),E,y)}else{if("compass"===E){this.setCompassAttributes(this.home.getCompass(),E,y)}else{if("print"===E){this.home.setPrint(this.createPrint(y))}else{if("level"===E){var c=this.createLevel(E,y);this.setLevelAttributes(c,E,y);(this.levels[(function(F,G){return F[G]===undefined?null:F[G]})(y,"id")]=c);this.home.addLevel(c)}else{if(("camera"===E)||("observerCamera"===E)){var z=this.createCamera(E,y);this.setCameraAttributes(z,E,y);var s=(function(F,G){return F[G]===undefined?null:F[G]})(y,"attribute");if("cameraPath"===s){var x=(this.home.getEnvironment().getVideoCameraPath().slice(0));(x.push(z)>0);this.home.getEnvironment().setVideoCameraPath(x)}else{if("topCamera"===s){var k=this.home.getTopCamera();k.setCamera(z);k.setTime(z.getTime());k.setLens(z.getLens())}else{if("observerCamera"===s){var D=this.home.getObserverCamera();D.setCamera(z);D.setTime(z.getTime());D.setLens(z.getLens());D.setFixedSize(z.isFixedSize())}else{if("storedCamera"===s){var u=(this.home.getStoredCameras().slice(0));(u.push(z)>0);this.home.setStoredCameras(u)}}}}}else{if(("pieceOfFurniture"===E)||("doorOrWindow"===E)||("light"===E)||("furnitureGroup"===E)){var g="furnitureGroup"===E?this.createFurnitureGroup(E,y,this.groupsFurniture.pop()):this.createPieceOfFurniture(E,y);this.setPieceOfFurnitureAttributes(g,E,y);if(this.homeElementName!=null&&(this.homeElementName===q)){this.home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(g);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){g.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("furnitureGroup"===q){((function(F){return F.length==0?null:F[F.length-1]})(this.groupsFurniture).push(g)>0)}}}else{if("wall"===E){var C=this.createWall(E,y);(this.joinedWalls[(function(F,G){return F[G]===undefined?null:F[G]})(y,"id")]=new a.JoinedWall(C,(function(F,G){return F[G]===undefined?null:F[G]})(y,"wallAtStart"),(function(F,G){return F[G]===undefined?null:F[G]})(y,"wallAtEnd")));this.setWallAttributes(C,E,y);this.home.addWall(C);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){C.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("baseboard"===E){var o=this.createBaseboard(E,y);if("leftSideBaseboard"===(function(F,G){return F[G]===undefined?null:F[G]})(y,"attribute")){this.leftSideBaseboard=o}else{this.rightSideBaseboard=o}}else{if("room"===E){var B=this.createRoom(E,y,this.points.slice(0));this.setRoomAttributes(B,E,y);this.home.addRoom$com_eteks_sweethome3d_model_Room(B);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){B.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("polyline"===E){var t=this.createPolyline(E,y,this.points.slice(0));this.setPolylineAttributes(t,E,y);this.home.addPolyline$com_eteks_sweethome3d_model_Polyline(t);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){t.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("dimensionLine"===E){var m=this.createDimensionLine(E,y);this.setDimensionLineAttributes(m,E,y);this.home.addDimensionLine(m);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){m.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("label"===E){var p=this.createLabel(E,y,this.labelText);this.setLabelAttributes(p,E,y);this.home.addLabel(p);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){p.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("text"===E){this.labelText=this.getCharacters()}else{if("textStyle"===E){var s=(function(F,G){return F[G]===undefined?null:F[G]})(y,"attribute");((function(F){return F.length==0?null:F[F.length-1]})(this.textStyles)[s!=null?s:a.UNIQUE_ATTRIBUTE]=this.createTextStyle(E,y))}else{if("texture"===E){if("material"===q){this.materialTexture=this.createTexture(E,y)}else{var s=(function(F,G){return F[G]===undefined?null:F[G]})(y,"attribute");(this.textures[s!=null?s:a.UNIQUE_ATTRIBUTE]=this.createTexture(E,y))}}else{if("material"===E){(this.materials.push(this.createMaterial(E,y))>0)}else{if("transformation"===E){var f=(function(F,G){return F[G]===undefined?null:F[G]})(y,"matrix");if(f==null){throw new SAXException("Missing attribute matrix")}else{var e=f.split(" ",12);if(e.length<12){throw new SAXException("Missing values for attribute matrix")}try{var w=[[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])],[parseFloat(e[4]),parseFloat(e[5]),parseFloat(e[6]),parseFloat(e[7])],[parseFloat(e[8]),parseFloat(e[9]),parseFloat(e[10]),parseFloat(e[11])]];var r=new Transformation((function(F,G){return F[G]===undefined?null:F[G]})(y,"name"),w);(this.transformations.push(this.resolveObject(r,E,y))>0)}catch(A){throw new SAXException("Invalid value for attribute matrix",A)}}}else{if("point"===E){(this.points.push([this.parseFloat(y,"x"),this.parseFloat(y,"y")])>0)}else{if("sash"===E){var v=new Sash(this.parseFloat(y,"xAxis"),this.parseFloat(y,"yAxis"),this.parseFloat(y,"width"),this.parseFloat(y,"startAngle"),this.parseFloat(y,"endAngle"));(this.sashes.push(this.resolveObject(v,E,y))>0)}else{if("lightSource"===E){var l=new LightSource(this.parseFloat(y,"x"),this.parseFloat(y,"y"),this.parseFloat(y,"z"),this.parseOptionalColor(y,"color"),this.parseOptionalFloat(y,"diameter"));(this.lightSources.push(this.resolveObject(l,E,y))>0)}else{if("backgroundImage"===E){var d=new BackgroundImage(this.parseContent((function(F,G){return F[G]===undefined?null:F[G]})(y,"image"),null,false),this.parseFloat(y,"scaleDistance"),this.parseFloat(y,"scaleDistanceXStart"),this.parseFloat(y,"scaleDistanceYStart"),this.parseFloat(y,"scaleDistanceXEnd"),this.parseFloat(y,"scaleDistanceYEnd"),(function(F,G){return F[G]===undefined?null:F[G]})(y,"xOrigin")!=null?this.parseFloat(y,"xOrigin"):0,(function(F,G){return F[G]===undefined?null:F[G]})(y,"yOrigin")!=null?this.parseFloat(y,"yOrigin"):0,!("false"===(function(F,G){return F[G]===undefined?null:F[G]})(y,"visible")));d=this.resolveObject(d,E,y);if(this.homeElementName!=null&&(this.homeElementName===q)){this.homeBackgroundImage=d}else{this.backgroundImage=d}}else{if("property"===E){if(this.homeElementName!=null){((function(F){return F.length==0?null:F[F.length-1]})(this.properties)[(function(F,G){return F[G]===undefined?null:F[G]})(y,"name")]=(function(F,G){return F[G]===undefined?null:F[G]})(y,"value"))}}}}}}}}}}}}}}}}}}}}}}}}}if(!("property"===E)&&!("furnitureVisibleProperty"===E)&&!("textStyle"===E)){this.properties.pop();this.textStyles.pop()}};a.prototype.getCharacters=function(){return this.buffer.str.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};a.prototype.endDocument=function(){var h=(function(j){return Object.keys(j).map(function(k){return j[k]})})(this.joinedWalls);for(var d=0;d<h.length;d++){var f=h[d];var c=f.getWall();if(f.getWallAtStartId()!=null&&!(f.getWallAtStartId()===c.getId())){var e=(function(j,l){return j[l]===undefined?null:j[l]})(this.joinedWalls,f.getWallAtStartId());if(e!=null){c.setWallAtStart(e.getWall())}}if(f.getWallAtEndId()!=null&&!(f.getWallAtEndId()===c.getId())){var g=(function(j,l){return j[l]===undefined?null:j[l]})(this.joinedWalls,f.getWallAtEndId());if(g!=null){c.setWallAtEnd(g.getWall())}}}};a.prototype.resolveObject=function(e,c,d){return e};a.prototype.createHome=function(c,e){var g;if((function(h,j){return h[j]===undefined?null:h[j]})(e,"wallHeight")!=null){g=new Home(this.parseFloat(e,"wallHeight"))}else{g=new Home()}var d=(function(h,j){return h[j]===undefined?null:h[j]})(e,"version");if(d!=null){try{g.setVersion(parseInt(d))}catch(f){throw new SAXException("Invalid value for integer attribute version",f)}}return this.resolveObject(g,c,e)};a.prototype.setHomeAttributes=function(h,l,d){var f=(function(p){var m=[];for(var n in p){m.push({k:n,v:p[n],getKey:function(){return this.k},getValue:function(){return this.v}})}return m})((function(m){return m.length==0?null:m[m.length-1]})(this.properties));for(var e=0;e<f.length;e++){var k=f[e];h.setProperty(k.getKey(),k.getValue())}if(this.furnitureVisibleProperties.length>0){this.home.setFurnitureVisibleProperties(this.furnitureVisibleProperties)}this.home.setBackgroundImage(this.homeBackgroundImage);h.setName((function(n,o){return n[o]===undefined?null:n[o]})(d,"name"));var j=(function(n,o){return n[o]===undefined?null:n[o]})(d,"selectedLevel");if(j!=null){this.home.setSelectedLevel((function(n,o){return n[o]===undefined?null:n[o]})(this.levels,j))}if("observerCamera"===(function(n,o){return n[o]===undefined?null:n[o]})(d,"camera")){this.home.setCamera(this.home.getObserverCamera())}h.setBasePlanLocked("true"===(function(n,o){return n[o]===undefined?null:n[o]})(d,"basePlanLocked"));var c=(function(n,o){return n[o]===undefined?null:n[o]})(d,"furnitureSortedProperty");if(c!=null){try{h.setFurnitureSortedProperty(c)}catch(g){}}h.setFurnitureDescendingSorted("true"===(function(n,o){return n[o]===undefined?null:n[o]})(d,"furnitureDescendingSorted"));if(d.structure){h.structure=this.parseContent(d.structure,null,false)}};a.prototype.setEnvironmentAttributes=function(u,l,j){this.setProperties(u);var v=this.parseOptionalColor(j,"groundColor");if(v!=null){u.setGroundColor(v)}u.setGroundTexture((function(x,y){return x[y]===undefined?null:x[y]})(this.textures,"groundTexture"));u.setBackgroundImageVisibleOnGround3D("true"===(function(x,y){return x[y]===undefined?null:x[y]})(j,"backgroundImageVisibleOnGround3D"));var s=this.parseOptionalColor(j,"skyColor");if(s!=null){u.setSkyColor(s)}u.setSkyTexture((function(x,y){return x[y]===undefined?null:x[y]})(this.textures,"skyTexture"));var n=this.parseOptionalColor(j,"lightColor");if(n!=null){u.setLightColor(n)}var k=this.parseOptionalFloat(j,"wallsAlpha");if(k!=null){u.setWallsAlpha(k)}u.setAllLevelsVisible("true"===(function(x,y){return x[y]===undefined?null:x[y]})(j,"allLevelsVisible"));u.setObserverCameraElevationAdjusted(!("false"===(function(x,y){return x[y]===undefined?null:x[y]})(j,"observerCameraElevationAdjusted")));var d=this.parseOptionalColor(j,"ceillingLightColor");if(d!=null){u.setCeillingLightColor(d)}var c=(function(x,y){return x[y]===undefined?null:x[y]})(j,"drawingMode");if(c!=null){try{u.setDrawingMode(HomeEnvironment.DrawingMode[c])}catch(q){}}var h=this.parseOptionalFloat(j,"subpartSizeUnderLight");if(h!=null){u.setSubpartSizeUnderLight(h)}var p=this.parseOptionalInteger(j,"photoWidth");if(p!=null){u.setPhotoWidth(p)}var o=this.parseOptionalInteger(j,"photoHeight");if(o!=null){u.setPhotoHeight(o)}var r=(function(x,y){return x[y]===undefined?null:x[y]})(j,"photoAspectRatio");if(r!=null){try{u.setPhotoAspectRatio(AspectRatio[r])}catch(q){}}var w=this.parseOptionalInteger(j,"photoQuality");if(w!=null){u.setPhotoQuality(w)}var f=this.parseOptionalInteger(j,"videoWidth");if(f!=null){u.setVideoWidth(f)}var e=(function(x,y){return x[y]===undefined?null:x[y]})(j,"videoAspectRatio");if(e!=null){try{u.setVideoAspectRatio(AspectRatio[e])}catch(q){}}var t=this.parseOptionalInteger(j,"videoQuality");if(t!=null){u.setVideoQuality(t)}var g=this.parseOptionalFloat(j,"videoSpeed");if(g!=null){u.setVideoSpeed(g)}var m=this.parseOptionalInteger(j,"videoFrameRate");if(m!=null){u.setVideoFrameRate(m)}};a.prototype.createPrint=function(c){var f=HomePrint.PaperOrientation.PORTRAIT;try{if((function(g,h){return g[h]===undefined?null:g[h]})(c,"paperOrientation")==null){throw new SAXException("Missing paperOrientation attribute")}f=HomePrint.PaperOrientation[(function(g,h){return g[h]===undefined?null:g[h]})(c,"paperOrientation")]}catch(e){}var d=new HomePrint(f,this.parseFloat(c,"paperWidth"),this.parseFloat(c,"paperHeight"),this.parseFloat(c,"paperTopMargin"),this.parseFloat(c,"paperLeftMargin"),this.parseFloat(c,"paperBottomMargin"),this.parseFloat(c,"paperRightMargin"),!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(c,"furniturePrinted")),!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(c,"planPrinted")),!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(c,"view3DPrinted")),this.parseOptionalFloat(c,"planScale"),(function(g,h){return g[h]===undefined?null:g[h]})(c,"headerFormat"),(function(g,h){return g[h]===undefined?null:g[h]})(c,"footerFormat"));return this.resolveObject(d,"print",c)};a.prototype.setCompassAttributes=function(g,c,d){this.setProperties(g);g.setX(this.parseOptionalFloat(d,"x"));g.setY(this.parseOptionalFloat(d,"y"));g.setDiameter(this.parseOptionalFloat(d,"diameter"));var f=this.parseOptionalFloat(d,"northDirection");if(f!=null){g.setNorthDirection(f)}var h=this.parseOptionalFloat(d,"longitude");if(h!=null){g.setLongitude(h)}var j=this.parseOptionalFloat(d,"latitude");if(j!=null){g.setLatitude(j)}var e=(function(l,n){return l[n]===undefined?null:l[n]})(d,"timeZone");if(e!=null){g.setTimeZone(e)}g.setVisible(!("false"===(function(l,n){return l[n]===undefined?null:l[n]})(d,"visible")))};a.prototype.createCamera=function(m,f){var c=(function(n,o){return n[o]===undefined?null:n[o]})(f,"id");var l=this.parseFloat(f,"x");var k=this.parseFloat(f,"y");var j=this.parseFloat(f,"z");var e=this.parseFloat(f,"yaw");var d=this.parseFloat(f,"pitch");var g=this.parseFloat(f,"fieldOfView");var h;if("observerCamera"===m){h=c!=null?new ObserverCamera(c,l,k,j,e,d,g):new ObserverCamera(l,k,j,e,d,g)}else{h=c!=null?new Camera(c,l,k,j,e,d,g):new Camera(l,k,j,e,d,g)}return this.resolveObject(h,m,f)};a.prototype.setCameraAttributes=function(g,c,d){this.setProperties(g);if(g!=null&&g instanceof ObserverCamera){g.setFixedSize("true"===(function(j,l){return j[l]===undefined?null:j[l]})(d,"fixedSize"))}var e=(function(j,l){return j[l]===undefined?null:j[l]})(d,"lens");if(e!=null){try{g.setLens(Camera.Lens[e])}catch(f){}}var h=(function(j,l){return j[l]===undefined?null:j[l]})(d,"time");if(h!=null){try{g.setTime(parseInt(h))}catch(f){throw new SAXException("Invalid value for long attribute time",f)}}g.setName((function(j,l){return j[l]===undefined?null:j[l]})(d,"name"))};a.prototype.createLevel=function(d,e){var k=(function(l,n){return l[n]===undefined?null:l[n]})(e,"id");var f=(function(l,n){return l[n]===undefined?null:l[n]})(e,"name");var g=this.parseFloat(e,"elevation");var h=this.parseFloat(e,"floorThickness");var c=this.parseFloat(e,"height");var j=k!=null?new Level(k,f,g,h,c):new Level(f,g,h,c);return this.resolveObject(j,d,e)};a.prototype.setLevelAttributes=function(f,c,e){this.setProperties(f);f.setBackgroundImage(this.backgroundImage);var d=this.parseOptionalInteger(e,"elevationIndex");if(d!=null){f.setElevationIndex(d)}f.setVisible(!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(e,"visible")));f.setViewable(!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(e,"viewable")))};a.prototype.createPieceOfFurniture=function(A,I){var D=(function(T,U){return T[U]===undefined?null:T[U]})(I,"id");var u=(function(T,U){return T[U]===undefined?null:T[U]})(I,"catalogId");var B=(function(T,U){return T[U]===undefined?null:T[U]})(I,"tags")!=null?(function(T,U){return T[U]===undefined?null:T[U]})(I,"tags").split(" "):null;var l=(function(T,U){return T[U]===undefined?null:T[U]})(I,"elevation")!=null?this.parseFloat(I,"elevation"):0;var f=(function(T,U){return T[U]===undefined?null:T[U]})(I,"dropOnTopElevation")!=null?this.parseFloat(I,"dropOnTopElevation"):1;var O=null;if((function(T,U){return T[U]===undefined?null:T[U]})(I,"modelRotation")!=null){var Q=(function(T,U){return T[U]===undefined?null:T[U]})(I,"modelRotation").split(" ",9);if(Q.length<9){throw new SAXException("Missing values for attribute modelRotation")}try{O=[[parseFloat(Q[0]),parseFloat(Q[1]),parseFloat(Q[2])],[parseFloat(Q[3]),parseFloat(Q[4]),parseFloat(Q[5])],[parseFloat(Q[6]),parseFloat(Q[7]),parseFloat(Q[8])]]}catch(J){throw new SAXException("Invalid value for attribute modelRotation",J)}}var r=(function(T,U){return T[U]===undefined?null:T[U]})(I,"name");var s=(function(T,U){return T[U]===undefined?null:T[U]})(I,"description");var N=(function(T,U){return T[U]===undefined?null:T[U]})(I,"information");var F=this.parseOptionalLong(I,"creationDate");var E=this.parseOptionalFloat(I,"grade");var p=this.parseContent((function(T,U){return T[U]===undefined?null:T[U]})(I,"icon"),u,false);var h=this.parseContent((function(T,U){return T[U]===undefined?null:T[U]})(I,"planIcon"),u,false);var e=this.parseContent((function(T,U){return T[U]===undefined?null:T[U]})(I,"model"),u,false);var c=this.parseFloat(I,"width");var m=this.parseFloat(I,"depth");var d=this.parseFloat(I,"height");var z=!("false"===(function(T,U){return T[U]===undefined?null:T[U]})(I,"movable"));var t="true"===(function(T,U){return T[U]===undefined?null:T[U]})(I,"backFaceShown");var S=this.parseOptionalLong(I,"modelSize");var x=(function(T,U){return T[U]===undefined?null:T[U]})(I,"creator");var G=!("false"===(function(T,U){return T[U]===undefined?null:T[U]})(I,"resizable"));var o=!("false"===(function(T,U){return T[U]===undefined?null:T[U]})(I,"deformable"));var k=!("false"===(function(T,U){return T[U]===undefined?null:T[U]})(I,"texturable"));var C=this.parseOptionalDecimal(I,"price");var g=this.parseOptionalDecimal(I,"valueAddedTaxPercentage");var M=(function(T,U){return T[U]===undefined?null:T[U]})(I,"currency");var v;if(("doorOrWindow"===A)||("true"===(function(T,U){return T[U]===undefined?null:T[U]})(I,"doorOrWindow"))){var R=(function(T,U){return T[U]===undefined?null:T[U]})(I,"wallThickness")!=null?this.parseFloat(I,"wallThickness"):1;var L=(function(T,U){return T[U]===undefined?null:T[U]})(I,"wallDistance")!=null?this.parseFloat(I,"wallDistance"):0;var y=(function(T,U){return T[U]===undefined?null:T[U]})(I,"cutOutShape");if(y==null&&!("doorOrWindow"===A)){y=PieceOfFurniture.DEFAULT_CUT_OUT_SHAPE}var w="true"===(function(T,U){return T[U]===undefined?null:T[U]})(I,"wallCutOutOnBothSides");var K=!("false"===(function(T,U){return T[U]===undefined?null:T[U]})(I,"widthDepthDeformable"));var P=new CatalogDoorOrWindow(u,r,s,N,B,F,E,p,h,e,c,m,d,l,f,z,y,R,L,w,K,this.sashes.slice(0),O,t,S,x,G,o,k,C,g,M);v=D!=null?new HomeDoorOrWindow(D,P):new HomeDoorOrWindow(P)}else{var H=(function(T,U){return T[U]===undefined?null:T[U]})(I,"staircaseCutOutShape");var q=!("false"===(function(T,U){return T[U]===undefined?null:T[U]})(I,"horizontallyRotatable"));if("light"===A){var n=new CatalogLight(u,r,s,N,B,F,E,p,h,e,c,m,d,l,f,z,this.lightSources.slice(0),H,O,t,S,x,G,o,k,q,C,g,M);v=D!=null?new HomeLight(D,n):new HomeLight(n)}else{var j=new CatalogPieceOfFurniture(u,r,s,N,B,F,E,p,h,e,c,m,d,l,f,z,H,O,t,S,x,G,o,k,q,C,g,M);v=D!=null?new HomePieceOfFurniture(D,j):new HomePieceOfFurniture(j)}}return this.resolveObject(v,A,I)};a.prototype.createFurnitureGroup=function(c,e,h){var k=(function(l,n){return l[n]===undefined?null:l[n]})(e,"id");var j=(function(l,n){return l[n]===undefined?null:l[n]})(e,"angle")!=null?this.parseFloat(e,"angle"):0;var d="true"===(function(l,n){return l[n]===undefined?null:l[n]})(e,"modelMirrored");var f=(function(l,n){return l[n]===undefined?null:l[n]})(e,"name");var g=k!=null?new HomeFurnitureGroup(k,h,j,d,f):new HomeFurnitureGroup(h,j,d,f);return this.resolveObject(g,c,e)};a.prototype.setPieceOfFurnitureAttributes=function(e,m,k){this.setProperties(e);e.setNameStyle((function(x,y){return x[y]===undefined?null:x[y]})((function(x){return x.length==0?null:x[x.length-1]})(this.textStyles),"nameStyle"));e.setNameVisible("true"===(function(x,y){return x[y]===undefined?null:x[y]})(k,"nameVisible"));var v=this.parseOptionalFloat(k,"nameAngle");if(v!=null){e.setNameAngle(v)}var t=this.parseOptionalFloat(k,"nameXOffset");if(t!=null){e.setNameXOffset(t)}var d=this.parseOptionalFloat(k,"nameYOffset");if(d!=null){e.setNameYOffset(d)}e.setVisible(!("false"===(function(x,y){return x[y]===undefined?null:x[y]})(k,"visible")));if(!(e!=null&&e instanceof HomeFurnitureGroup)){var o=this.parseOptionalFloat(k,"x");if(o!=null){e.setX(o)}var n=this.parseOptionalFloat(k,"y");if(n!=null){e.setY(n)}var w=this.parseOptionalFloat(k,"angle");if(w!=null){e.setAngle(w)}if(e.isHorizontallyRotatable()){var l=this.parseOptionalFloat(k,"pitch");if(l!=null){e.setPitch(l)}var A=this.parseOptionalFloat(k,"roll");if(A!=null){e.setRoll(A)}}var c=this.parseOptionalFloat(k,"widthInPlan");if(c!=null){e.setWidthInPlan(c)}var f=this.parseOptionalFloat(k,"depthInPlan");if(f!=null){e.setDepthInPlan(f)}var h=this.parseOptionalFloat(k,"heightInPlan");if(h!=null){e.setHeightInPlan(h)}if(this.home.getVersion()<5500||("false"===(function(x,y){return x[y]===undefined?null:x[y]})(k,"modelCenteredAtOrigin"))){e.setModelCenteredAtOrigin((function(x,y){return x[y]===undefined?null:x[y]})(k,"modelRotation")==null)}if(e.isResizable()){e.setModelMirrored("true"===(function(x,y){return x[y]===undefined?null:x[y]})(k,"modelMirrored"))}if(e.isTexturable()){if(this.materials.length>0){e.setModelMaterials(this.materials.slice(0))}var u=this.parseOptionalColor(k,"color");if(u!=null){e.setColor(u)}var q=(function(x,y){return x[y]===undefined?null:x[y]})(this.textures,a.UNIQUE_ATTRIBUTE);if(q!=null){e.setTexture(q)}var s=this.parseOptionalFloat(k,"shininess");if(s!=null){e.setShininess(s)}}if(e.isDeformable()){if(this.transformations.length>0){e.setModelTransformations(this.transformations.slice(0))}}if((e!=null&&e instanceof HomeLight)&&(function(x,y){return x[y]===undefined?null:x[y]})(k,"power")!=null){e.setPower(this.parseFloat(k,"power"))}else{if((e!=null&&e instanceof HomeDoorOrWindow)&&("doorOrWindow"===m)){var r=e;r.setBoundToWall(!("false"===(function(x,y){return x[y]===undefined?null:x[y]})(k,"boundToWall")));var j=this.parseOptionalFloat(k,"wallWidth");if(j!=null){r.setWallWidth(j)}var p=this.parseOptionalFloat(k,"wallLeft");if(p!=null){r.setWallLeft(p)}var z=this.parseOptionalFloat(k,"wallHeight");if(z!=null){r.setWallHeight(z)}var g=this.parseOptionalFloat(k,"wallTop");if(g!=null){r.setWallTop(g)}}}}else{e.setCatalogId((function(x,y){return x[y]===undefined?null:x[y]})(k,"catalogId"));e.setDescription((function(x,y){return x[y]===undefined?null:x[y]})(k,"description"));e.setInformation((function(x,y){return x[y]===undefined?null:x[y]})(k,"information"));e.setCreator((function(x,y){return x[y]===undefined?null:x[y]})(k,"creator"))}};a.prototype.createWall=function(l,e){var d=(function(n,o){return n[o]===undefined?null:n[o]})(e,"id");var f=this.parseFloat(e,"xStart");var k=this.parseFloat(e,"yStart");var c=this.parseFloat(e,"xEnd");var j=this.parseFloat(e,"yEnd");var h=this.parseFloat(e,"thickness");var g=d!=null?new Wall(d,f,k,c,j,h,0):new Wall(f,k,c,j,h,0);return this.resolveObject(g,l,e)};a.prototype.setWallAttributes=function(d,c,f){this.setProperties(d);d.setLeftSideBaseboard(this.leftSideBaseboard);d.setRightSideBaseboard(this.rightSideBaseboard);d.setHeight(this.parseOptionalFloat(f,"height"));d.setHeightAtEnd(this.parseOptionalFloat(f,"heightAtEnd"));d.setArcExtent(this.parseOptionalFloat(f,"arcExtent"));d.setTopColor(this.parseOptionalColor(f,"topColor"));d.setLeftSideColor(this.parseOptionalColor(f,"leftSideColor"));d.setLeftSideTexture((function(l,n){return l[n]===undefined?null:l[n]})(this.textures,"leftSideTexture"));var e=this.parseOptionalFloat(f,"leftSideShininess");if(e!=null){d.setLeftSideShininess(e)}d.setRightSideColor(this.parseOptionalColor(f,"rightSideColor"));d.setRightSideTexture((function(l,n){return l[n]===undefined?null:l[n]})(this.textures,"rightSideTexture"));var j=this.parseOptionalFloat(f,"rightSideShininess");if(j!=null){d.setRightSideShininess(j)}var h=(function(l,n){return l[n]===undefined?null:l[n]})(f,"pattern");if(h!=null){try{d.setPattern(this.preferences.getPatternsCatalog().getPattern$java_lang_String(h))}catch(g){}}};a.prototype.createRoom=function(c,d,e){var g=(function(h,j){return h[j]===undefined?null:h[j]})(d,"id");var f=g!=null?new Room(g,e):new Room(e);return this.resolveObject(f,c,d)};a.prototype.setRoomAttributes=function(c,n,f){this.setProperties(c);c.setNameStyle((function(o,p){return o[p]===undefined?null:o[p]})((function(o){return o.length==0?null:o[o.length-1]})(this.textStyles),"nameStyle"));c.setAreaStyle((function(o,p){return o[p]===undefined?null:o[p]})((function(o){return o.length==0?null:o[o.length-1]})(this.textStyles),"areaStyle"));c.setName((function(o,p){return o[p]===undefined?null:o[p]})(f,"name"));var e=this.parseOptionalFloat(f,"nameAngle");if(e!=null){c.setNameAngle(e)}var d=this.parseOptionalFloat(f,"nameXOffset");if(d!=null){c.setNameXOffset(d)}var k=this.parseOptionalFloat(f,"nameYOffset");if(k!=null){c.setNameYOffset(k)}c.setAreaVisible("true"===(function(o,p){return o[p]===undefined?null:o[p]})(f,"areaVisible"));var l=this.parseOptionalFloat(f,"areaAngle");if(l!=null){c.setAreaAngle(l)}var m=this.parseOptionalFloat(f,"areaXOffset");if(m!=null){c.setAreaXOffset(m)}var g=this.parseOptionalFloat(f,"areaYOffset");if(g!=null){c.setAreaYOffset(g)}c.setFloorVisible(!("false"===(function(o,p){return o[p]===undefined?null:o[p]})(f,"floorVisible")));c.setFloorColor(this.parseOptionalColor(f,"floorColor"));c.setFloorTexture((function(o,p){return o[p]===undefined?null:o[p]})(this.textures,"floorTexture"));var h=this.parseOptionalFloat(f,"floorShininess");if(h!=null){c.setFloorShininess(h)}c.setCeilingVisible(!("false"===(function(o,p){return o[p]===undefined?null:o[p]})(f,"ceilingVisible")));c.setCeilingColor(this.parseOptionalColor(f,"ceilingColor"));c.setCeilingTexture((function(o,p){return o[p]===undefined?null:o[p]})(this.textures,"ceilingTexture"));var j=this.parseOptionalFloat(f,"ceilingShininess");if(j!=null){c.setCeilingShininess(j)}};a.prototype.createPolyline=function(c,e,f){var g=(function(h,j){return h[j]===undefined?null:h[j]})(e,"id");var d=g!=null?new Polyline(g,f):new Polyline(f);return this.resolveObject(d,c,e)};a.prototype.setPolylineAttributes=function(o,t,g){this.setProperties(o);var n=this.parseOptionalFloat(g,"thickness");if(n!=null){o.setThickness(n)}var r=(function(u,v){return u[v]===undefined?null:u[v]})(g,"capStyle");if(r!=null){try{o.setCapStyle(Polyline.CapStyle[r])}catch(m){}}var j=(function(u,v){return u[v]===undefined?null:u[v]})(g,"joinStyle");if(j!=null){try{o.setJoinStyle(Polyline.JoinStyle[j])}catch(m){}}var s=(function(u,v){return u[v]===undefined?null:u[v]})(g,"dashStyle");if(s!=null){try{o.setDashStyle(Polyline.DashStyle[s])}catch(m){}}var c=(function(u,v){return u[v]===undefined?null:u[v]})(g,"dashPattern");if(c!=null){try{var p=c.split(" ");var l=(function(v){var u=[];while(v-->0){u.push(0)}return u})(p.length);for(var h=0;h<p.length;h++){l[h]=parseFloat(p[h])}o.setDashPattern(l)}catch(m){throw new SAXException("Invalid value for dash pattern",m)}}var f=this.parseOptionalFloat(g,"dashOffset");if(f!=null){o.setDashOffset(f)}var k=(function(u,v){return u[v]===undefined?null:u[v]})(g,"startArrowStyle");if(k!=null){try{o.setStartArrowStyle(Polyline.ArrowStyle[k])}catch(m){}}var d=(function(u,v){return u[v]===undefined?null:u[v]})(g,"endArrowStyle");if(d!=null){try{o.setEndArrowStyle(Polyline.ArrowStyle[d])}catch(m){}}var q=this.parseOptionalFloat(g,"elevation");if(q!=null){o.setVisibleIn3D(true);o.setElevation(q)}var e=this.parseOptionalColor(g,"color");if(e!=null){o.setColor(e)}o.setClosedPath("true"===(function(u,v){return u[v]===undefined?null:u[v]})(g,"closedPath"))};a.prototype.createDimensionLine=function(l,f){var d=(function(n,o){return n[o]===undefined?null:n[o]})(f,"id");var g=this.parseFloat(f,"xStart");var k=this.parseFloat(f,"yStart");var c=this.parseFloat(f,"xEnd");var j=this.parseFloat(f,"yEnd");var e=this.parseFloat(f,"offset");var h=d!=null?new DimensionLine(d,g,k,c,j,e):new DimensionLine(g,k,c,j,e);return this.resolveObject(h,l,f)};a.prototype.setDimensionLineAttributes=function(d,c,e){this.setProperties(d);d.setLengthStyle((function(f,g){return f[g]===undefined?null:f[g]})((function(f){return f.length==0?null:f[f.length-1]})(this.textStyles),"lengthStyle"))};a.prototype.createLabel=function(d,e,g){var j=(function(l,n){return l[n]===undefined?null:l[n]})(e,"id");var c=this.parseFloat(e,"x");var h=this.parseFloat(e,"y");var f=j!=null?new Label(j,g,c,h):new Label(g,c,h);return this.resolveObject(f,d,e)};a.prototype.setLabelAttributes=function(e,c,d){this.setProperties(e);e.setStyle((function(j,l){return j[l]===undefined?null:j[l]})((function(j){return j.length==0?null:j[j.length-1]})(this.textStyles),a.UNIQUE_ATTRIBUTE));var h=this.parseOptionalFloat(d,"angle");if(h!=null){e.setAngle(h)}var f=this.parseOptionalFloat(d,"elevation");if(f!=null){e.setElevation(f)}var g=this.parseOptionalFloat(d,"pitch");if(g!=null){e.setPitch(g)}e.setColor(this.parseOptionalColor(d,"color"));e.setOutlineColor(this.parseOptionalColor(d,"outlineColor"))};a.prototype.createBaseboard=function(c,d){var e=Baseboard.getInstance(this.parseFloat(d,"thickness"),this.parseFloat(d,"height"),this.parseOptionalColor(d,"color"),(function(f,g){return f[g]===undefined?null:f[g]})(this.textures,a.UNIQUE_ATTRIBUTE));return this.resolveObject(e,c,d)};a.prototype.createTextStyle=function(c,d){var h=TextStyle.Alignment.CENTER;var f=(function(j,l){return j[l]===undefined?null:j[l]})(d,"alignment");if(f!=null){try{h=TextStyle.Alignment[f]}catch(e){}}var g=new TextStyle((function(j,l){return j[l]===undefined?null:j[l]})(d,"fontName"),this.parseFloat(d,"fontSize"),"true"===(function(j,l){return j[l]===undefined?null:j[l]})(d,"bold"),"true"===(function(j,l){return j[l]===undefined?null:j[l]})(d,"italic"),h);return this.resolveObject(g,c,d)};a.prototype.createTexture=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(d,"catalogId");var e=new HomeTexture(new CatalogTexture(f,(function(g,h){return g[h]===undefined?null:g[h]})(d,"name"),this.parseContent((function(g,h){return g[h]===undefined?null:g[h]})(d,"image"),f,true),this.parseFloat(d,"width"),this.parseFloat(d,"height"),(function(g,h){return g[h]===undefined?null:g[h]})(d,"creator")),(function(g,h){return g[h]===undefined?null:g[h]})(d,"xOffset")!=null?this.parseFloat(d,"xOffset"):0,(function(g,h){return g[h]===undefined?null:g[h]})(d,"yOffset")!=null?this.parseFloat(d,"yOffset"):0,(function(g,h){return g[h]===undefined?null:g[h]})(d,"angle")!=null?this.parseFloat(d,"angle"):0,(function(g,h){return g[h]===undefined?null:g[h]})(d,"scale")!=null?this.parseFloat(d,"scale"):1,!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(d,"leftToRightOriented")));return this.resolveObject(e,c,d)};a.prototype.createMaterial=function(c,d){var e=new HomeMaterial((function(f,g){return f[g]===undefined?null:f[g]})(d,"name"),(function(f,g){return f[g]===undefined?null:f[g]})(d,"key"),this.parseOptionalColor(d,"color"),this.materialTexture,this.parseOptionalFloat(d,"shininess"));return this.resolveObject(e,c,d)};a.prototype.setProperties=function(d){var f=(function(j){var g=[];for(var h in j){g.push({k:h,v:j[h],getKey:function(){return this.k},getValue:function(){return this.v}})}return g})((function(g){return g.length==0?null:g[g.length-1]})(this.properties));for(var c=0;c<f.length;c++){var e=f[c];d.setProperty(e.getKey(),e.getValue())}};a.prototype.parseOptionalColor=function(d,e){var c=(function(g,h){return g[h]===undefined?null:g[h]})(d,e);if(c!=null){try{return(parseInt(c,16)|0)}catch(f){throw new SAXException("Invalid value for color attribute "+e,f)}}else{return null}};a.prototype.parseOptionalInteger=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(c,d);if(f!=null){try{return parseInt(f)}catch(e){throw new SAXException("Invalid value for integer attribute "+d,e)}}else{return null}};a.prototype.parseOptionalLong=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(c,d);if(f!=null){try{return parseInt(f)}catch(e){throw new SAXException("Invalid value for long attribute "+d,e)}}else{return null}};a.prototype.parseOptionalDecimal=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(c,d);if(f!=null){try{return new Big(f)}catch(e){throw new SAXException("Invalid value for decimal attribute "+d,e)}}else{return null}};a.prototype.parseOptionalFloat=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(c,d);if(f!=null){try{return parseFloat(f)}catch(e){throw new SAXException("Invalid value for float attribute "+d,e)}}else{return null}};a.prototype.parseFloat=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(c,d);if(f!=null){try{return parseFloat(f)}catch(e){throw new SAXException("Invalid value for float attribute "+d,e)}}else{throw new SAXException("Missing float attribute "+d)}};a.prototype.parseContent=function(c,e,d){if(c==null){return null}else{if(c.indexOf("://")>=0){return new URLContent(c)}else{return new HomeURLContent("jar:"+this["homeUrl"]+"!/"+c)}}};a.prototype.setHome=function(c){this.home=c;this.homeElementName=(function(d){return d.length==0?null:d[d.length-1]})(this.elements)};a.prototype.getHome=function(){return this.home};a.UNIQUE_ATTRIBUTE="@&unique&@";return a}(DefaultHandler));HomeXMLHandler.__class="com.eteks.sweethome3d.io.HomeXMLHandler";HomeXMLHandler.__interfaces=["org.xml.sax.ErrorHandler","org.xml.sax.DTDHandler","org.xml.sax.ContentHandler","org.xml.sax.EntityResolver"];(function(b){var a=(function(){function c(d,f,e){if(this.wall===undefined){this.wall=null}if(this.wallAtStartId===undefined){this.wallAtStartId=null}if(this.wallAtEndId===undefined){this.wallAtEndId=null}this.wall=d;this.wallAtStartId=f;this.wallAtEndId=e}c.prototype.getWall=function(){return this.wall};c.prototype.getWallAtStartId=function(){return this.wallAtStartId};c.prototype.getWallAtEndId=function(){return this.wallAtEndId};return c}());b.JoinedWall=a;a.__class="com.eteks.sweethome3d.io.HomeXMLHandler.JoinedWall"})(HomeXMLHandler||(HomeXMLHandler={}));var PatternsCatalog=(function(){function a(b){if(this.patterns===undefined){this.patterns=null}this.patterns=(b.slice(0))}a.prototype.getPatterns=function(){return this.patterns.slice(0)};a.prototype.getPatternsCount=function(){return this.patterns.length};a.prototype.getPattern$int=function(b){return this.patterns[b]};a.prototype.getPattern$java_lang_String=function(c){for(var b=0;b<this.patterns.length;b++){var d=this.patterns[b];if(c===d.getName()){return d}}throw new IllegalArgumentException("No pattern with name "+c)};a.prototype.getPattern=function(b){if(((typeof b==="string")||b===null)){return this.getPattern$java_lang_String(b)}else{if(((typeof b==="number")||b===null)){return this.getPattern$int(b)}else{throw new Error("invalid overload")}}};return a}());PatternsCatalog.__class="com.eteks.sweethome3d.model.PatternsCatalog";var HomePrint=(function(){function a(b,g,l,m,o,c,h,n,f,k,e,d,j){if(this.paperOrientation===undefined){this.paperOrientation=null}if(this.paperWidth===undefined){this.paperWidth=0}if(this.paperHeight===undefined){this.paperHeight=0}if(this.paperTopMargin===undefined){this.paperTopMargin=0}if(this.paperLeftMargin===undefined){this.paperLeftMargin=0}if(this.paperBottomMargin===undefined){this.paperBottomMargin=0}if(this.paperRightMargin===undefined){this.paperRightMargin=0}if(this.furniturePrinted===undefined){this.furniturePrinted=false}if(this.planPrinted===undefined){this.planPrinted=false}if(this.view3DPrinted===undefined){this.view3DPrinted=false}if(this.planScale===undefined){this.planScale=null}if(this.headerFormat===undefined){this.headerFormat=null}if(this.footerFormat===undefined){this.footerFormat=null}this.paperOrientation=b;this.paperWidth=g;this.paperHeight=l;this.paperTopMargin=m;this.paperLeftMargin=o;this.paperBottomMargin=c;this.paperRightMargin=h;this.furniturePrinted=n;this.planPrinted=f;this.view3DPrinted=k;this.planScale=e;this.headerFormat=d;this.footerFormat=j}a.prototype.getPaperOrientation=function(){return this.paperOrientation};a.prototype.getPaperBottomMargin=function(){return this.paperBottomMargin};a.prototype.getPaperHeight=function(){return this.paperHeight};a.prototype.getPaperLeftMargin=function(){return this.paperLeftMargin};a.prototype.getPaperRightMargin=function(){return this.paperRightMargin};a.prototype.getPaperTopMargin=function(){return this.paperTopMargin};a.prototype.getPaperWidth=function(){return this.paperWidth};a.prototype.isFurniturePrinted=function(){return this.furniturePrinted};a.prototype.isPlanPrinted=function(){return this.planPrinted};a.prototype.isView3DPrinted=function(){return this.view3DPrinted};a.prototype.getPlanScale=function(){return this.planScale};a.prototype.getHeaderFormat=function(){return this.headerFormat};a.prototype.getFooterFormat=function(){return this.footerFormat};return a}());HomePrint.__class="com.eteks.sweethome3d.model.HomePrint";(function(a){var b;(function(c){c[c.PORTRAIT=0]="PORTRAIT";c[c.LANDSCAPE=1]="LANDSCAPE";c[c.REVERSE_LANDSCAPE=2]="REVERSE_LANDSCAPE"})(b=a.PaperOrientation||(a.PaperOrientation={}))})(HomePrint||(HomePrint={}));var TexturesCategory=(function(){function a(b){if(this.name===undefined){this.name=null}if(this.textures===undefined){this.textures=null}this.name=b;this.textures=([])}a.COMPARATOR_$LI$=function(){if(a.COMPARATOR==null){a.COMPARATOR={compare:function(c,b){return c.toString().localeCompare(b.toString())},equals:function(c,b){return c.toString().localeCompare(b.toString())===0}}}return a.COMPARATOR};a.prototype.getName=function(){return this.name};a.prototype.getTextures=function(){return this.textures.slice(0)};a.prototype.getTexturesCount=function(){return this.textures.length};a.prototype.getTexture=function(b){return this.textures[b]};a.prototype.getIndexOfTexture=function(b){return this.textures.indexOf(b)};a.prototype.add=function(c){c.setCategory(this);var b=(function(e,h){var f=function(n,l){if(n.compareTo){return n.compareTo(l)}else{return n.localeCompare(l)}};var d=0;var k=e.length-1;while(d<=k){var g=(d+k)>>>1;var m=e[g];var j=f(m,h);if(j<0){d=g+1}else{if(j>0){k=g-1}else{return g}}}return -(d+1)})(this.textures,c);if(b<0){b=-b-1}this.textures.splice(b,0,c)};a.prototype["delete"]=function(b){var c=this.textures.indexOf(b);if(c===-1){throw new IllegalArgumentException(this.name+" doesn't contain texture "+b.getName())}this.textures=(this.textures.slice(0));this.textures.splice(c,1)[0]};a.prototype.equals=function(b){return(b!=null&&b instanceof a)&&a.COMPARATOR_$LI$().equals(this.name,b.name)};a.prototype.hashCode=function(){return(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this.name)};a.prototype.compareTo=function(b){return a.COMPARATOR_$LI$().compare(this.name,b.name)};return a}());TexturesCategory.__class="com.eteks.sweethome3d.model.TexturesCategory";var HomeRecorder;(function(b){var a;(function(c){c[c.DEFAULT=0]="DEFAULT";c[c.COMPRESSED=1]="COMPRESSED"})(a=b.Type||(b.Type={}))})(HomeRecorder||(HomeRecorder={}));var CatalogTexture=(function(){function a(u,C,s,w,r,l,x){if(((typeof u==="string")||u===null)&&((typeof C==="string")||C===null)&&((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||s===null)&&((typeof w==="number")||w===null)&&((typeof r==="number")||r===null)&&((typeof l==="string")||l===null)&&((typeof x==="boolean")||x===null)){var k=arguments;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=u;this.name=C;this.image=s;this.width=w;this.height=r;this.creator=l;this.modifiable=x}else{if(((typeof u==="string")||u===null)&&((typeof C==="string")||C===null)&&((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||s===null)&&((typeof w==="number")||w===null)&&((typeof r==="number")||r===null)&&((typeof l==="string")||l===null)&&x===undefined){var k=arguments;var f=arguments;var v=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=u;this.name=C;this.image=s;this.width=w;this.height=r;this.creator=l;this.modifiable=v;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof u==="string")||u===null)&&((C!=null&&(C.constructor!=null&&C.constructor.__interfaces!=null&&C.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||C===null)&&((typeof s==="number")||s===null)&&((typeof w==="number")||w===null)&&((typeof r==="boolean")||r===null)&&l===undefined&&x===undefined){var k=arguments;var z=k[0];var o=k[1];var p=k[2];var B=k[3];var t=k[4];var d=arguments;var g=null;var j=null;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=g;this.name=z;this.image=o;this.width=p;this.height=B;this.creator=j;this.modifiable=t;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof u==="string")||u===null)&&((C!=null&&(C.constructor!=null&&C.constructor.__interfaces!=null&&C.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||C===null)&&((typeof s==="number")||s===null)&&((typeof w==="number")||w===null)&&r===undefined&&l===undefined&&x===undefined){var k=arguments;var y=k[0];var m=k[1];var n=k[2];var A=k[3];var c=arguments;var e=null;var h=null;var b=arguments;var q=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=e;this.name=y;this.image=m;this.width=n;this.height=A;this.creator=h;this.modifiable=q;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{throw new Error("invalid overload")}}}}}a.__static_initialize=function(){if(!a.__static_initialized){a.__static_initialized=true;a.__static_initializer_0()}};a.EMPTY_CRITERIA_$LI$=function(){a.__static_initialize();if(a.EMPTY_CRITERIA==null){a.EMPTY_CRITERIA=[]}return a.EMPTY_CRITERIA};a.COMPARATOR_$LI$=function(){a.__static_initialize();return a.COMPARATOR};a.recentFilters_$LI$=function(){a.__static_initialize();return a.recentFilters};a.__static_initializer_0=function(){a.COMPARATOR={compare:function(c,b){return c.toString().localeCompare(b.toString())},equals:function(c,b){return c.toString().localeCompare(b.toString())===0}};a.COMPARATOR_$LI$();a.recentFilters=({})};a.prototype.getId=function(){return this.id};a.prototype.getName=function(){return this.name};a.prototype.getImage=function(){return this.image};a.prototype.getIcon=function(){return this.getImage()};a.prototype.getWidth=function(){return this.width};a.prototype.getHeight=function(){return this.height};a.prototype.getCreator=function(){return this.creator};a.prototype.isModifiable=function(){return this.modifiable};a.prototype.getCategory=function(){return this.category};a.prototype.setCategory=function(b){this.category=b};a.prototype.equals=function(b){return(function(d,c){return d&&d.equals?d.equals(c):d===c})(this,b)};a.prototype.hashCode=function(){return(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this)};a.prototype.compareTo=function(c){var b=a.COMPARATOR_$LI$().compare(this.name,c.name);if(b!==0){return b}else{return this.modifiable===c.modifiable?0:(this.modifiable?1:-1)}};a.prototype.matchesFilter=function(d){var e=this.getFilterCollationKeys(d);var f=0;if(e.length>0){var b=this.getTextureCollationKey();for(var c=0;c<e.length;c++){if(this.isSubCollationKey(b,e[c],0)){f++}else{break}}}return f===e.length};a.prototype.getFilterCollationKeys=function(d){if(d.length===0){return a.EMPTY_CRITERIA_$LI$()}var c=(function(h,j){return h[j]===undefined?null:h[j]})(a.recentFilters_$LI$(),d);if(c==null){var g=d.split("\\s|\\p{Punct}|\\|");var f=([]);for(var b=0;b<g.length;b++){var e=g[b];if(e.length>0){(f.push(a.COMPARATOR_$LI$().getCollationKey(e).toByteArray())>0)}}if(f.length===0){c=a.EMPTY_CRITERIA_$LI$()}else{c=f.slice(0)}(a.recentFilters_$LI$()[d]=c)}return c};a.prototype.getTextureCollationKey=function(){var c=this;if(this.filterCollationKey==null){var b={str:"",toString:function(){return this.str}};(function(d){d.str+=c.getName();return d})(b);(function(d){d.str+="|";return d})(b);if(this.getCategory()!=null){(function(d){d.str+=c.getCategory().getName();return d})(b);(function(d){d.str+="|";return d})(b)}if(this.getCreator()!=null){(function(d){d.str+=c.getCreator();return d})(b);(function(d){d.str+="|";return d})(b)}this.filterCollationKey=a.COMPARATOR_$LI$().getCollationKey(b.str).toByteArray()}return this.filterCollationKey};a.prototype.isSubCollationKey=function(e,h,g){for(var d=g,f=e.length-4,b=h.length-4;d<f&&d<f-b+1;d++){if(e[d]===h[0]){for(var c=1;c<b;c++){if(e[d+c]!==h[c]){return this.isSubCollationKey(e,h,d+1)}}return true}}return false};a.__static_initialized=false;return a}());CatalogTexture.__class="com.eteks.sweethome3d.model.CatalogTexture";CatalogTexture.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.TextureImage"];var Transformation=(function(){function a(c,b){if(this.name===undefined){this.name=null}if(this.matrix===undefined){this.matrix=null}this.name=c;this.matrix=b}a.prototype.getName=function(){return this.name};a.prototype.getMatrix=function(){return[[this.matrix[0][0],this.matrix[0][1],this.matrix[0][2],this.matrix[0][3]],[this.matrix[1][0],this.matrix[1][1],this.matrix[1][2],this.matrix[1][3]],[this.matrix[2][0],this.matrix[2][1],this.matrix[2][2],this.matrix[2][3]]]};a.prototype.equals=function(c){if(c!=null&&c instanceof a){var e=c;if(e.name===this.name){for(var d=0;d<this.matrix.length;d++){for(var b=0;b<this.matrix[d].length;b++){if(e.matrix[d][b]!==this.matrix[d][b]){return false}}}return true}}return false};a.prototype.hashCode=function(){return(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this.name)+(function(c){function b(g){if(g==null){return 0}var d=1;for(var e=0;e<g.length;e++){var f=1;if(Array.isArray(g[e])){f=b(g[e])}else{if(typeof g[e]=="number"){f=(g[e]*1000)|0}}d=31*d+f}return d}return b})(this.matrix)};return a}());Transformation.__class="com.eteks.sweethome3d.model.Transformation";var LightSource=(function(){function a(c,j,h,d,e){if(((typeof c==="number")||c===null)&&((typeof j==="number")||j===null)&&((typeof h==="number")||h===null)&&((typeof d==="number")||d===null)&&((typeof e==="number")||e===null)){var g=arguments;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.z===undefined){this.z=0}if(this.color===undefined){this.color=0}if(this.diameter===undefined){this.diameter=null}this.x=c;this.y=j;this.z=h;this.color=d;this.diameter=e}else{if(((typeof c==="number")||c===null)&&((typeof j==="number")||j===null)&&((typeof h==="number")||h===null)&&((typeof d==="number")||d===null)&&e===undefined){var g=arguments;var b=arguments;var f=null;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.z===undefined){this.z=0}if(this.color===undefined){this.color=0}if(this.diameter===undefined){this.diameter=null}this.x=c;this.y=j;this.z=h;this.color=d;this.diameter=f;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.z===undefined){this.z=0}if(this.color===undefined){this.color=0}if(this.diameter===undefined){this.diameter=null}}else{throw new Error("invalid overload")}}}a.prototype.getX=function(){return this.x};a.prototype.getY=function(){return this.y};a.prototype.getZ=function(){return this.z};a.prototype.getColor=function(){return this.color};a.prototype.getDiameter=function(){return this.diameter};return a}());LightSource.__class="com.eteks.sweethome3d.model.LightSource";var TextStyle=(function(){function a(y,j,C,r,v,w){if(((typeof y==="string")||y===null)&&((typeof j==="number")||j===null)&&((typeof C==="boolean")||C===null)&&((typeof r==="boolean")||r===null)&&((typeof v==="number")||v===null)&&((typeof w==="boolean")||w===null)){var u=arguments;if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}this.fontName=y;this.fontSize=j;this.bold=C;this.italic=r;this.alignment=v;if(w){(a.textStylesCache_$LI$().push(this)>0)}}else{if(((typeof y==="string")||y===null)&&((typeof j==="number")||j===null)&&((typeof C==="boolean")||C===null)&&((typeof r==="boolean")||r===null)&&((typeof v==="number")||v===null)&&w===undefined){var u=arguments;var f=arguments;var B=true;if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}this.fontName=y;this.fontSize=j;this.bold=C;this.italic=r;this.alignment=v;if(B){(a.textStylesCache_$LI$().push(this)>0)}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}}else{if(((typeof y==="string")||y===null)&&((typeof j==="number")||j===null)&&((typeof C==="boolean")||C===null)&&((typeof r==="boolean")||r===null)&&v===undefined&&w===undefined){var u=arguments;var d=arguments;var H=a.Alignment.CENTER;var b=arguments;var A=true;if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}this.fontName=y;this.fontSize=j;this.bold=C;this.italic=r;this.alignment=H;if(A){(a.textStylesCache_$LI$().push(this)>0)}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}}else{if(((typeof y==="number")||y===null)&&((typeof j==="boolean")||j===null)&&((typeof C==="boolean")||C===null)&&r===undefined&&v===undefined&&w===undefined){var u=arguments;var s=u[0];var k=u[1];var g=u[2];var t=arguments;var G=null;var q=arguments;var F=a.Alignment.CENTER;var p=arguments;var z=true;if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}this.fontName=G;this.fontSize=s;this.bold=k;this.italic=g;this.alignment=F;if(z){(a.textStylesCache_$LI$().push(this)>0)}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}}else{if(((typeof y==="number")||y===null)&&j===undefined&&C===undefined&&r===undefined&&v===undefined&&w===undefined){var u=arguments;var o=u[0];var n=arguments;var e=false;var c=false;var m=arguments;var E=null;var l=arguments;var D=a.Alignment.CENTER;var h=arguments;var x=true;if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}this.fontName=E;this.fontSize=o;this.bold=e;this.italic=c;this.alignment=D;if(x){(a.textStylesCache_$LI$().push(this)>0)}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}}else{throw new Error("invalid overload")}}}}}}a.textStylesCache_$LI$=function(){if(a.textStylesCache==null){a.textStylesCache=([])}return a.textStylesCache};a.prototype.getInstance=function(e,f,d,b,j){var h=new a(e,f,d,b,j,false);for(var c=a.textStylesCache_$LI$().length-1;c>=0;c--){var g=a.textStylesCache_$LI$()[c];if(g==null){a.textStylesCache_$LI$().splice(c,1)[0]}else{if(g.equals(h)){return h}}}(a.textStylesCache_$LI$().push(h)>0);return h};a.prototype.getFontName=function(){return this.fontName};a.prototype.getFontSize=function(){return this.fontSize};a.prototype.isBold=function(){return this.bold};a.prototype.isItalic=function(){return this.italic};a.prototype.getAlignment=function(){return this.alignment};a.prototype.deriveStyle$java_lang_String=function(b){if(this.getFontName()===b||(b!=null&&(b===this.getFontName()))){return this}else{return this.getInstance(b,this.getFontSize(),this.isBold(),this.isItalic(),this.getAlignment())}};a.prototype.deriveStyle=function(b){if(((typeof b==="string")||b===null)){return this.deriveStyle$java_lang_String(b)}else{if(((typeof b==="number")||b===null)){return this.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(b)}else{if(((typeof b==="number")||b===null)){return this.deriveStyle$float(b)}else{throw new Error("invalid overload")}}}};a.prototype.deriveStyle$float=function(b){if(this.getFontSize()===b){return this}else{return this.getInstance(this.getFontName(),b,this.isBold(),this.isItalic(),this.getAlignment())}};a.prototype.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment=function(b){if(this.getAlignment()===b){return this}else{return this.getInstance(this.getFontName(),this.getFontSize(),this.isBold(),this.isItalic(),b)}};a.prototype.deriveBoldStyle=function(b){if(this.isBold()===b){return this}else{return this.getInstance(this.getFontName(),this.getFontSize(),b,this.isItalic(),this.getAlignment())}};a.prototype.deriveItalicStyle=function(b){if(this.isItalic()===b){return this}else{return this.getInstance(this.getFontName(),this.getFontSize(),this.isBold(),b,this.getAlignment())}};a.prototype.equals=function(b){if(b!=null&&b instanceof a){var c=b;return(c.fontName===this.fontName||(c.fontName!=null&&(c.fontName===this.fontName)))&&c.fontSize===this.fontSize&&c.bold===this.bold&&c.italic===this.italic&&c.alignment===this.alignment}return false};a.prototype.hashCode=function(){var b=(function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.fontSize);if(this.fontName!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.fontName)}if(this.bold){b++}if(this.italic){b++}b+=0;return b};return a}());TextStyle.__class="com.eteks.sweethome3d.model.TextStyle";(function(a){var b;(function(c){c[c.LEFT=0]="LEFT";c[c.CENTER=1]="CENTER";c[c.RIGHT=2]="RIGHT"})(b=a.Alignment||(a.Alignment={}))})(TextStyle||(TextStyle={}));var HomeTexture=(function(){function a(s,w,y,r,A,x){if(((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||s===null)&&((typeof w==="number")||w===null)&&((typeof y==="number")||y===null)&&((typeof r==="number")||r===null)&&((typeof A==="number")||A===null)&&((typeof x==="boolean")||x===null)){var E=arguments;if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}this.name=s.getName();this.creator=s.getCreator();this.image=s.getImage();this.width=s.getWidth();this.height=s.getHeight();this.xOffset=w;this.yOffset=y;this.angle=r;this.scale=A;this.leftToRightOriented=x;if(s!=null&&s instanceof a){this.catalogId=s.getCatalogId()}else{if(s!=null&&s instanceof CatalogTexture){this.catalogId=s.getId()}else{this.catalogId=null}}}else{if(((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||s===null)&&((typeof w==="number")||w===null)&&((typeof y==="number")||y===null)&&((typeof r==="boolean")||r===null)&&A===undefined&&x===undefined){var E=arguments;var M=E[1];var L=E[2];var o=E[3];var v=arguments;var q=0;var D=0;if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}this.name=s.getName();this.creator=s.getCreator();this.image=s.getImage();this.width=s.getWidth();this.height=s.getHeight();this.xOffset=q;this.yOffset=D;this.angle=M;this.scale=L;this.leftToRightOriented=o;if(s!=null&&s instanceof a){this.catalogId=s.getCatalogId()}else{if(s!=null&&s instanceof CatalogTexture){this.catalogId=s.getId()}else{this.catalogId=null}}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}}else{if(((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||s===null)&&((typeof w==="number")||w===null)&&((typeof y==="boolean")||y===null)&&r===undefined&&A===undefined&&x===undefined){var E=arguments;var K=E[1];var m=E[2];var u=arguments;var J=1;var t=arguments;var p=0;var C=0;if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}this.name=s.getName();this.creator=s.getCreator();this.image=s.getImage();this.width=s.getWidth();this.height=s.getHeight();this.xOffset=p;this.yOffset=C;this.angle=K;this.scale=J;this.leftToRightOriented=m;if(s!=null&&s instanceof a){this.catalogId=s.getCatalogId()}else{if(s!=null&&s instanceof CatalogTexture){this.catalogId=s.getId()}else{this.catalogId=null}}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}}else{if(((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||s===null)&&((typeof w==="number")||w===null)&&y===undefined&&r===undefined&&A===undefined&&x===undefined){var E=arguments;var H=E[1];var h=arguments;var l=true;var g=arguments;var I=1;var f=arguments;var n=0;var B=0;if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}this.name=s.getName();this.creator=s.getCreator();this.image=s.getImage();this.width=s.getWidth();this.height=s.getHeight();this.xOffset=n;this.yOffset=B;this.angle=H;this.scale=I;this.leftToRightOriented=l;if(s!=null&&s instanceof a){this.catalogId=s.getCatalogId()}else{if(s!=null&&s instanceof CatalogTexture){this.catalogId=s.getId()}else{this.catalogId=null}}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}}else{if(((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||s===null)&&w===undefined&&y===undefined&&r===undefined&&A===undefined&&x===undefined){var E=arguments;var e=arguments;var F=0;var d=arguments;var j=true;var c=arguments;var G=1;var b=arguments;var k=0;var z=0;if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}this.name=s.getName();this.creator=s.getCreator();this.image=s.getImage();this.width=s.getWidth();this.height=s.getHeight();this.xOffset=k;this.yOffset=z;this.angle=F;this.scale=G;this.leftToRightOriented=j;if(s!=null&&s instanceof a){this.catalogId=s.getCatalogId()}else{if(s!=null&&s instanceof CatalogTexture){this.catalogId=s.getId()}else{this.catalogId=null}}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}}else{throw new Error("invalid overload")}}}}}}a.prototype.getCatalogId=function(){return this.catalogId};a.prototype.getName=function(){return this.name};a.prototype.getCreator=function(){return this.creator};a.prototype.getImage=function(){return this.image};a.prototype.getWidth=function(){return this.width};a.prototype.getHeight=function(){return this.height};a.prototype.getXOffset=function(){return this.xOffset};a.prototype.getYOffset=function(){return this.yOffset};a.prototype.getAngle=function(){return this.angle};a.prototype.getScale=function(){return this.scale};a.prototype.isLeftToRightOriented=function(){return this.leftToRightOriented};a.prototype.equals=function(c){if(c===this){return true}else{if(c!=null&&c instanceof a){var b=c;return(b.name===this.name||b.name!=null&&(b.name===this.name))&&(b.image===this.image||b.image!=null&&(function(e,d){if(e&&e.equals){return e.equals(d)}else{return e===d}})(b.image,this.image))&&b.width===this.width&&b.height===this.height&&b.xOffset===this.xOffset&&b.yOffset===this.yOffset&&b.leftToRightOriented===this.leftToRightOriented&&b.angle===this.angle&&b.scale===this.scale}else{return false}}};a.prototype.hashCode=function(){return(this.name!=null?(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this.name):0)+(this.image!=null?(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this.image):0)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.width)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.height)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.xOffset)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.yOffset)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.angle)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.scale)};return a}());HomeTexture.__class="com.eteks.sweethome3d.model.HomeTexture";HomeTexture.__interfaces=["com.eteks.sweethome3d.model.TextureImage"];var IllegalHomonymException=(function(){function a(b){if(((typeof b==="string")||b===null)){var c=arguments}else{if(b===undefined){var c=arguments}else{throw new Error("invalid overload")}}}return a}());IllegalHomonymException.__class="com.eteks.sweethome3d.model.IllegalHomonymException";var AspectRatio;(function(a){a[a.FREE_RATIO=0]="FREE_RATIO";a[a.VIEW_3D_RATIO=1]="VIEW_3D_RATIO";a[a.RATIO_4_3=2]="RATIO_4_3";a[a.RATIO_3_2=3]="RATIO_3_2";a[a.RATIO_16_9=4]="RATIO_16_9";a[a.RATIO_2_1=5]="RATIO_2_1";a[a.RATIO_24_10=6]="RATIO_24_10";a[a.SQUARE_RATIO=7]="SQUARE_RATIO"})(AspectRatio||(AspectRatio={}));var AspectRatio_$WRAPPER=(function(){function a(d,b,c){this._$ordinal=d;this._$name=b;if(this.value===undefined){this.value=null}this.value=c}a.prototype.getValue=function(){return this.value};a.prototype.name=function(){return this._$name};a.prototype.ordinal=function(){return this._$ordinal};a.prototype.compareTo=function(b){return this._$ordinal-(isNaN(b)?b._$ordinal:b)};return a}());AspectRatio.__class="com.eteks.sweethome3d.model.AspectRatio";AspectRatio["_$wrappers"]={0:new AspectRatio_$WRAPPER(0,"FREE_RATIO",null),1:new AspectRatio_$WRAPPER(1,"VIEW_3D_RATIO",null),2:new AspectRatio_$WRAPPER(2,"RATIO_4_3",4/3),3:new AspectRatio_$WRAPPER(3,"RATIO_3_2",1.5),4:new AspectRatio_$WRAPPER(4,"RATIO_16_9",16/9),5:new AspectRatio_$WRAPPER(5,"RATIO_2_1",2/1),6:new AspectRatio_$WRAPPER(6,"RATIO_24_10",2.4),7:new AspectRatio_$WRAPPER(7,"SQUARE_RATIO",1)};var Baseboard=(function(){function a(j,k,e,h,d){if(((typeof j==="number")||j===null)&&((typeof k==="number")||k===null)&&((typeof e==="number")||e===null)&&((h!=null&&h instanceof HomeTexture)||h===null)&&((typeof d==="boolean")||d===null)){var g=arguments;if(this.thickness===undefined){this.thickness=0}if(this.height===undefined){this.height=0}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}this.height=k;this.thickness=j;this.color=e;this.texture=h;if(d){(a.baseboardsCache_$LI$().push(this)>0)}}else{if(((typeof j==="number")||j===null)&&((typeof k==="number")||k===null)&&((typeof e==="number")||e===null)&&((h!=null&&h instanceof HomeTexture)||h===null)&&d===undefined){var g=arguments;var f=arguments;var l=f[1];var c=f[0];var b=true;if(this.thickness===undefined){this.thickness=0}if(this.height===undefined){this.height=0}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}this.height=c;this.thickness=l;this.color=e;this.texture=h;if(b){(a.baseboardsCache_$LI$().push(this)>0)}if(this.thickness===undefined){this.thickness=0}if(this.height===undefined){this.height=0}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}}else{throw new Error("invalid overload")}}}a.baseboardsCache_$LI$=function(){if(a.baseboardsCache==null){a.baseboardsCache=([])}return a.baseboardsCache};a.getInstance=function(e,b,c,g){var h=new a(e,b,c,g,false);for(var d=a.baseboardsCache_$LI$().length-1;d>=0;d--){var f=a.baseboardsCache_$LI$()[d];if(f==null){a.baseboardsCache_$LI$().splice(d,1)[0]}else{if(f.equals(h)){return h}}}(a.baseboardsCache_$LI$().push(h)>0);return h};a.prototype.getThickness=function(){return this.thickness};a.prototype.getHeight=function(){return this.height};a.prototype.getColor=function(){return this.color};a.prototype.getTexture=function(){return this.texture};a.prototype.equals=function(b){if(b!=null&&b instanceof a){var c=b;return c.thickness===this.thickness&&c.height===this.height&&(c.color===this.color||c.color!=null&&(c.color===this.color))&&(c.texture===this.texture||c.texture!=null&&c.texture.equals(this.texture))}return false};a.prototype.hashCode=function(){var b=(function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.thickness)+(function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.height);if(this.color!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.color)}if(this.texture!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.texture)}return b};return a}());Baseboard.__class="com.eteks.sweethome3d.model.Baseboard";var FurnitureCatalog=(function(){function a(){this.categories=([]);this.furnitureChangeSupport=(new CollectionChangeSupport(this))}a.prototype.getCategories=function(){return this.categories.slice(0)};a.prototype.getCategoriesCount=function(){return this.categories.length};a.prototype.getCategory=function(b){return this.categories[b]};a.prototype.addFurnitureListener=function(b){this.furnitureChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeFurnitureListener=function(b){this.furnitureChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.add=function(d,c){var b=(function(f,j){var g=function(o,l){if(o.compareTo){return o.compareTo(l)}else{return o.localeCompare(l)}};var e=0;var m=f.length-1;while(e<=m){var h=(e+m)>>>1;var n=f[h];var k=g(n,j);if(k<0){e=h+1}else{if(k>0){m=h-1}else{return h}}}return -(e+1)})(this.categories,d);if(b<0){d=new FurnitureCategory(d.getName());this.categories.splice(-b-1,0,d)}else{d=this.categories[b]}d.add(c);this.furnitureChangeSupport.fireCollectionChanged(c,d.getIndexOfPieceOfFurniture(c),CollectionEvent.Type.ADD)};a.prototype["delete"]=function(b){var d=b.getCategory();if(d!=null){var c=d.getIndexOfPieceOfFurniture(b);if(c>=0){d["delete"](b);if(d.getFurnitureCount()===0){this.categories=(this.categories.slice(0));(function(e){var f=e.indexOf(d);if(f>=0){e.splice(f,1);return true}else{return false}})(this.categories)}this.furnitureChangeSupport.fireCollectionChanged(b,c,CollectionEvent.Type.DELETE);return}}throw new IllegalArgumentException("catalog doesn't contain piece "+b.getName())};return a}());FurnitureCatalog.__class="com.eteks.sweethome3d.model.FurnitureCatalog";var HomeDescriptor=(function(){function a(b,d,c){if(this.name===undefined){this.name=null}if(this.content===undefined){this.content=null}if(this.icon===undefined){this.icon=null}this.name=b;this.content=d;this.icon=c}a.prototype.getName=function(){return this.name};a.prototype.getContent=function(){return this.content};a.prototype.getIcon=function(){return this.icon};return a}());HomeDescriptor.__class="com.eteks.sweethome3d.model.HomeDescriptor";var HomeApplication=(function(){function a(){this.homes=([]);this.homesChangeSupport=(new CollectionChangeSupport(this))}a.prototype.addHomesListener=function(b){this.homesChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeHomesListener=function(b){this.homesChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.createHome=function(){return new Home(this.getUserPreferences().getNewWallHeight())};a.prototype.getHomes=function(){return this.homes.slice(0)};a.prototype.addHome=function(b){this.homes=(this.homes.slice(0));(this.homes.push(b)>0);this.homesChangeSupport.fireCollectionChanged(b,this.homes.length-1,CollectionEvent.Type.ADD)};a.prototype.deleteHome=function(c){var b=this.homes.indexOf(c);if(b!==-1){this.homes=(this.homes.slice(0));this.homes.splice(b,1)[0];this.homesChangeSupport.fireCollectionChanged(c,b,CollectionEvent.Type.DELETE)}};a.prototype.getHomeRecorder$=function(){throw new Error("cannot invoke abstract overloaded method... check your argument(s) type(s)")};a.prototype.getHomeRecorder$com_eteks_sweethome3d_model_HomeRecorder_Type=function(b){return this.getHomeRecorder$()};a.prototype.getHomeRecorder=function(b){if(((typeof b==="number")||b===null)){return this.getHomeRecorder$com_eteks_sweethome3d_model_HomeRecorder_Type(b)}else{if(b===undefined){return this.getHomeRecorder$()}else{throw new Error("invalid overload")}}};a.prototype.getName=function(){return"Sweet Home 3D"};a.prototype.getVersion=function(){return""};a.prototype.getId=function(){return null};return a}());HomeApplication.__class="com.eteks.sweethome3d.model.HomeApplication";var BackgroundImage=(function(){function a(f,n,m,c,g,d,b,k,e){if(((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||f===null)&&((typeof n==="number")||n===null)&&((typeof m==="number")||m===null)&&((typeof c==="number")||c===null)&&((typeof g==="number")||g===null)&&((typeof d==="number")||d===null)&&((typeof b==="number")||b===null)&&((typeof k==="number")||k===null)&&((typeof e==="boolean")||e===null)){var j=arguments;if(this.image===undefined){this.image=null}if(this.scaleDistance===undefined){this.scaleDistance=0}if(this.scaleDistanceXStart===undefined){this.scaleDistanceXStart=0}if(this.scaleDistanceYStart===undefined){this.scaleDistanceYStart=0}if(this.scaleDistanceXEnd===undefined){this.scaleDistanceXEnd=0}if(this.scaleDistanceYEnd===undefined){this.scaleDistanceYEnd=0}if(this.xOrigin===undefined){this.xOrigin=0}if(this.yOrigin===undefined){this.yOrigin=0}if(this.invisible===undefined){this.invisible=false}this.image=f;this.scaleDistance=n;this.scaleDistanceXStart=m;this.scaleDistanceYStart=c;this.scaleDistanceXEnd=g;this.scaleDistanceYEnd=d;this.xOrigin=b;this.yOrigin=k;this.invisible=!e}else{if(((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||f===null)&&((typeof n==="number")||n===null)&&((typeof m==="number")||m===null)&&((typeof c==="number")||c===null)&&((typeof g==="number")||g===null)&&((typeof d==="number")||d===null)&&((typeof b==="number")||b===null)&&((typeof k==="number")||k===null)&&e===undefined){var j=arguments;var h=arguments;var l=true;if(this.image===undefined){this.image=null}if(this.scaleDistance===undefined){this.scaleDistance=0}if(this.scaleDistanceXStart===undefined){this.scaleDistanceXStart=0}if(this.scaleDistanceYStart===undefined){this.scaleDistanceYStart=0}if(this.scaleDistanceXEnd===undefined){this.scaleDistanceXEnd=0}if(this.scaleDistanceYEnd===undefined){this.scaleDistanceYEnd=0}if(this.xOrigin===undefined){this.xOrigin=0}if(this.yOrigin===undefined){this.yOrigin=0}if(this.invisible===undefined){this.invisible=false}this.image=f;this.scaleDistance=n;this.scaleDistanceXStart=m;this.scaleDistanceYStart=c;this.scaleDistanceXEnd=g;this.scaleDistanceYEnd=d;this.xOrigin=b;this.yOrigin=k;this.invisible=!l;if(this.image===undefined){this.image=null}if(this.scaleDistance===undefined){this.scaleDistance=0}if(this.scaleDistanceXStart===undefined){this.scaleDistanceXStart=0}if(this.scaleDistanceYStart===undefined){this.scaleDistanceYStart=0}if(this.scaleDistanceXEnd===undefined){this.scaleDistanceXEnd=0}if(this.scaleDistanceYEnd===undefined){this.scaleDistanceYEnd=0}if(this.xOrigin===undefined){this.xOrigin=0}if(this.yOrigin===undefined){this.yOrigin=0}if(this.invisible===undefined){this.invisible=false}}else{throw new Error("invalid overload")}}}a.prototype.getImage=function(){return this.image};a.prototype.getScaleDistance=function(){return this.scaleDistance};a.prototype.getScaleDistanceXStart=function(){return this.scaleDistanceXStart};a.prototype.getScaleDistanceYStart=function(){return this.scaleDistanceYStart};a.prototype.getScaleDistanceXEnd=function(){return this.scaleDistanceXEnd};a.prototype.getScaleDistanceYEnd=function(){return this.scaleDistanceYEnd};a.prototype.getScale=function(){return a.getScale(this.scaleDistance,this.scaleDistanceXStart,this.scaleDistanceYStart,this.scaleDistanceXEnd,this.scaleDistanceYEnd)};a.getScale=function(e,b,f,d,c){return(e/java.awt.geom.Point2D.distance(b,f,d,c))};a.prototype.getXOrigin=function(){return this.xOrigin};a.prototype.getYOrigin=function(){return this.yOrigin};a.prototype.isVisible=function(){return !this.invisible};return a}());BackgroundImage.__class="com.eteks.sweethome3d.model.BackgroundImage";var RecorderException=(function(b){__extends(a,b);function a(c,e){var f=this;if(((typeof c==="string")||c===null)&&((e!=null&&(e.__classes&&e.__classes.indexOf("java.lang.Throwable")>=0)||e!=null&&e instanceof Error)||e===null)){var d=arguments;f=b.call(this,c)||this;f.message=c}else{if(((typeof c==="string")||c===null)&&e===undefined){var d=arguments;f=b.call(this,c)||this;f.message=c}else{if(c===undefined&&e===undefined){var d=arguments;f=b.call(this)||this}else{throw new Error("invalid overload")}}}return f}return a}(Error));RecorderException.__class="com.eteks.sweethome3d.model.RecorderException";var HomeObject=(function(){function a(e){if(((typeof e==="string")||e===null)){var d=arguments;if(this.id===undefined){this.id=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(e==null){throw new IllegalArgumentException("ID must exist")}this.id=e}else{if(e===undefined){var d=arguments;var c=arguments;var b=a.createId(a.ID_DEFAULT_PREFIX);if(this.id===undefined){this.id=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(b==null){throw new IllegalArgumentException("ID must exist")}this.id=b;if(this.id===undefined){this.id=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}}else{throw new Error("invalid overload")}}}a.createId=function(b){return b+"-"+UUID.randomUUID()};a.prototype.addPropertyChangeListener=function(b,c){if(this.propertyChangeSupport==null){this.propertyChangeSupport=new PropertyChangeSupport(this)}if(c===undefined){this.propertyChangeSupport.addPropertyChangeListener(b)}else{this.propertyChangeSupport.addPropertyChangeListener(b,c)}};a.prototype.removePropertyChangeListener=function(b,c){if(this.propertyChangeSupport!=null){if(c===undefined){this.propertyChangeSupport.removePropertyChangeListener(b)}else{this.propertyChangeSupport.removePropertyChangeListener(b,c)}if(this.propertyChangeSupport.getPropertyChangeListeners().length===0){this.propertyChangeSupport=null}}};a.prototype.firePropertyChange=function(b,c,d){if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange(b,c,d)}};a.prototype.getId=function(){return this.id};a.prototype.getProperty=function(b){if(this.properties!=null){return(function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b)}else{return null}};a.prototype.setProperty=function(c,e){var f=this;var b=this.properties!=null?(function(g,h){return g[h]===undefined?null:g[h]})(this.properties,c):null;if(e==null){if(this.properties!=null&&b!=null){try{(function(h){var g=f.properties[c];delete f.properties[c];return g})(this.properties);if(Object.keys(this.properties).length===0){this.properties=null}}catch(d){this.properties=null}this.firePropertyChange(c,b,null)}}else{if(this.properties==null||(Object.keys(this.properties).length===1&&b!=null)){this.properties=(function(g){var h={};h[g]=e;return h})(c)}else{if(Object.keys(this.properties).length===1){this.properties=((function(j){var g={};for(var h in j){g[h]=j[h]}return g})(this.properties))}(this.properties[c]=e)}this.firePropertyChange(c,b,e)}};a.prototype.getPropertyNames=function(){if(this.properties!=null){return Object.keys(this.properties)}else{return[]}};a.prototype.duplicate=function(){var f=(function(g){if(g.clone!=undefined){return g.clone()}else{var h=Object.create(g);for(var c in g){if(g.hasOwnProperty(c)){h[c]=g[c]}}return h}})(this);var b=0;var e;while((b<this.id.length&&(function(g){return g.charCodeAt==null?g:g.charCodeAt(0)})((e=this.id.charAt(b).toLowerCase()))>="a".charCodeAt(0)&&(function(g){return g.charCodeAt==null?g:g.charCodeAt(0)})(e)<="z".charCodeAt(0))){b++}var d=b>=0?this.id.substring(0,b):a.ID_DEFAULT_PREFIX;f.id=a.createId(d);return f};a.prototype.clone=function(){var d=this;try{var c=(function(f){var g=Object.create(f);for(var e in f){if(f.hasOwnProperty(e)){g[e]=f[e]}}return g})(this);if(this.properties!=null){c.properties=Object.keys(c.properties).length===1?(function(e){var f={};f[e]=(function(g){var h=0;return{next:function(){return h<g.length?g[h++]:null},hasNext:function(){return h<g.length}}})((function(g){return Object.keys(g).map(function(h){return g[h]})})(d.properties)).next();return f})((function(e){var f=0;return{next:function(){return f<e.length?e[f++]:null},hasNext:function(){return f<e.length}}})(Object.keys(this.properties)).next()):((function(g){var e={};for(var f in g){e[f]=g[f]}return e})(this.properties))}c.propertyChangeSupport=null;return c}catch(b){throw new IllegalStateException("Super class isn't cloneable")}};a.ID_DEFAULT_PREFIX="object";return a}());HomeObject.__class="com.eteks.sweethome3d.model.HomeObject";HomeObject.__transients=["propertyChangeSupport"];var TexturesCatalog=(function(){function a(){this.categories=([]);this.texturesChangeSupport=(new CollectionChangeSupport(this))}a.prototype.getCategories=function(){return this.categories.slice(0)};a.prototype.getCategoriesCount=function(){return this.categories.length};a.prototype.getCategory=function(b){return this.categories[b]};a.prototype.addTexturesListener=function(b){this.texturesChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeTexturesListener=function(b){this.texturesChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.add=function(d,c){var b=(function(f,j){var g=function(o,l){if(o.compareTo){return o.compareTo(l)}else{return o.localeCompare(l)}};var e=0;var m=f.length-1;while(e<=m){var h=(e+m)>>>1;var n=f[h];var k=g(n,j);if(k<0){e=h+1}else{if(k>0){m=h-1}else{return h}}}return -(e+1)})(this.categories,d);if(b<0){d=new TexturesCategory(d.getName());this.categories.splice(-b-1,0,d)}else{d=this.categories[b]}d.add(c);this.texturesChangeSupport.fireCollectionChanged(c,d.getIndexOfTexture(c),CollectionEvent.Type.ADD)};a.prototype["delete"]=function(c){var b=c.getCategory();if(b!=null){var d=b.getIndexOfTexture(c);if(d>=0){b["delete"](c);if(b.getTexturesCount()===0){this.categories=(this.categories.slice(0));(function(e){var f=e.indexOf(b);if(f>=0){e.splice(f,1);return true}else{return false}})(this.categories)}this.texturesChangeSupport.fireCollectionChanged(c,d,CollectionEvent.Type.DELETE);return}}throw new IllegalArgumentException("catalog doesn't contain texture "+c.getName())};return a}());TexturesCatalog.__class="com.eteks.sweethome3d.model.TexturesCatalog";var CatalogPieceOfFurniture=(function(){function a(K,ae,R,M,y,aG,bE,l,at,bK,aR,b,bD,aQ,a7,bS,k,au,bB,S,x,aI,Z,bh,bg,c,A,am,j,bC,G,J,bs,aC){if(((typeof K==="string")||K===null)&&((typeof ae==="string")||ae===null)&&((typeof R==="string")||R===null)&&((typeof M==="string")||M===null)&&((y!=null&&y instanceof Array&&(y.length==0||y[0]==null||(typeof y[0]==="string")))||y===null)&&((typeof aG==="number")||aG===null)&&((typeof bE==="number")||bE===null)&&((l!=null&&(l.constructor!=null&&l.constructor.__interfaces!=null&&l.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||l===null)&&((at!=null&&(at.constructor!=null&&at.constructor.__interfaces!=null&&at.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||at===null)&&((bK!=null&&(bK.constructor!=null&&bK.constructor.__interfaces!=null&&bK.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||bK===null)&&((typeof aR==="number")||aR===null)&&((typeof b==="number")||b===null)&&((typeof bD==="number")||bD===null)&&((typeof aQ==="number")||aQ===null)&&((typeof a7==="number")||a7===null)&&((typeof bS==="boolean")||bS===null)&&((typeof k==="boolean")||k===null)&&((typeof au==="string")||au===null)&&((typeof bB==="number")||bB===null)&&((S!=null&&S instanceof Array&&(S.length==0||S[0]==null||S[0] instanceof Array))||S===null)&&((typeof x==="boolean")||x===null)&&((typeof aI==="number")||aI===null)&&((typeof Z==="string")||Z===null)&&((typeof bh==="boolean")||bh===null)&&((typeof bg==="boolean")||bg===null)&&((typeof c==="boolean")||c===null)&&((typeof A==="boolean")||A===null)&&((am!=null&&am instanceof Big)||am===null)&&((j!=null&&j instanceof Big)||j===null)&&((typeof bC==="string")||bC===null)&&((G!=null&&(G instanceof Object))||G===null)&&((typeof J==="number")||J===null)&&((typeof bs==="boolean")||bs===null)&&((typeof aC==="boolean")||aC===null)){var e=arguments;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=K;this.name=ae;this.description=R;this.information=M;this.tags=y;this.creationDate=aG;this.grade=bE;this.icon=l;this.planIcon=at;this.model=bK;this.width=aR;this.depth=b;this.height=bD;this.elevation=aQ;this.dropOnTopElevation=a7;this.movable=bS;this.doorOrWindow=k;this.color=bB;this.staircaseCutOutShape=au;this.creator=Z;this.horizontallyRotatable=A;this.price=am;this.valueAddedTaxPercentage=j;this.currency=bC;this.properties=G==null||Object.keys(G).length===0?{}:(Object.keys(G).length===1?(function(bT){var bU={};bU[bT]=(function(bV){var bW=0;return{next:function(){return bW<bV.length?bV[bW++]:null},hasNext:function(){return bW<bV.length}}})((function(bV){return Object.keys(bV).map(function(bW){return bV[bW]})})(G)).next();return bU})((function(bT){var bU=0;return{next:function(){return bU<bT.length?bT[bU++]:null},hasNext:function(){return bU<bT.length}}})(Object.keys(G)).next()):((function(bV){var bT={};for(var bU in bV){bT[bU]=bV[bU]}return bT})(G)));if(S==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(S)}this.backFaceShown=x;this.modelSize=aI;this.resizable=bh;this.deformable=bg;this.texturable=c;this.iconYaw=J;this.proportional=bs;this.modifiable=aC}else{if(((typeof K==="string")||K===null)&&((typeof ae==="string")||ae===null)&&((typeof R==="string")||R===null)&&((typeof M==="string")||M===null)&&((y!=null&&y instanceof Array&&(y.length==0||y[0]==null||(typeof y[0]==="string")))||y===null)&&((typeof aG==="number")||aG===null)&&((typeof bE==="number")||bE===null)&&((l!=null&&(l.constructor!=null&&l.constructor.__interfaces!=null&&l.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||l===null)&&((at!=null&&(at.constructor!=null&&at.constructor.__interfaces!=null&&at.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||at===null)&&((bK!=null&&(bK.constructor!=null&&bK.constructor.__interfaces!=null&&bK.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||bK===null)&&((typeof aR==="number")||aR===null)&&((typeof b==="number")||b===null)&&((typeof bD==="number")||bD===null)&&((typeof aQ==="number")||aQ===null)&&((typeof a7==="number")||a7===null)&&((typeof bS==="boolean")||bS===null)&&((typeof k==="string")||k===null)&&((au!=null&&au instanceof Array&&(au.length==0||au[0]==null||au[0] instanceof Array))||au===null)&&((typeof bB==="boolean")||bB===null)&&((typeof S==="number")||S===null)&&((typeof x==="string")||x===null)&&((typeof aI==="boolean")||aI===null)&&((typeof Z==="boolean")||Z===null)&&((typeof bh==="boolean")||bh===null)&&((typeof bg==="boolean")||bg===null)&&((c!=null&&c instanceof Big)||c===null)&&((A!=null&&A instanceof Big)||A===null)&&((typeof am==="string")||am===null)&&((j!=null&&(j instanceof Object))||j===null)&&bC===undefined&&G===undefined&&J===undefined&&bs===undefined&&aC===undefined){var e=arguments;var an=e[16];var bq=e[17];var aO=e[18];var bJ=e[19];var bf=e[20];var aX=e[21];var E=e[22];var a4=e[23];var bA=e[24];var aA=e[25];var ad=e[26];var a9=e[27];var ar=e[28];var bR=arguments;var Q=false;var v=null;var aa=Math.PI/8;var w=true;var bw=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=K;this.name=ae;this.description=R;this.information=M;this.tags=y;this.creationDate=aG;this.grade=bE;this.icon=l;this.planIcon=at;this.model=bK;this.width=aR;this.depth=b;this.height=bD;this.elevation=aQ;this.dropOnTopElevation=a7;this.movable=bS;this.doorOrWindow=Q;this.color=v;this.staircaseCutOutShape=an;this.creator=bf;this.horizontallyRotatable=bA;this.price=aA;this.valueAddedTaxPercentage=ad;this.currency=a9;this.properties=ar==null||Object.keys(ar).length===0?{}:(Object.keys(ar).length===1?(function(bT){var bU={};bU[bT]=(function(bV){var bW=0;return{next:function(){return bW<bV.length?bV[bW++]:null},hasNext:function(){return bW<bV.length}}})((function(bV){return Object.keys(bV).map(function(bW){return bV[bW]})})(ar)).next();return bU})((function(bT){var bU=0;return{next:function(){return bU<bT.length?bT[bU++]:null},hasNext:function(){return bU<bT.length}}})(Object.keys(ar)).next()):((function(bV){var bT={};for(var bU in bV){bT[bU]=bV[bU]}return bT})(ar)));if(bq==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(bq)}this.backFaceShown=aO;this.modelSize=bJ;this.resizable=aX;this.deformable=E;this.texturable=a4;this.iconYaw=aa;this.proportional=w;this.modifiable=bw;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof K==="string")||K===null)&&((typeof ae==="string")||ae===null)&&((typeof R==="string")||R===null)&&((typeof M==="string")||M===null)&&((y!=null&&y instanceof Array&&(y.length==0||y[0]==null||(typeof y[0]==="string")))||y===null)&&((typeof aG==="number")||aG===null)&&((typeof bE==="number")||bE===null)&&((l!=null&&(l.constructor!=null&&l.constructor.__interfaces!=null&&l.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||l===null)&&((at!=null&&(at.constructor!=null&&at.constructor.__interfaces!=null&&at.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||at===null)&&((bK!=null&&(bK.constructor!=null&&bK.constructor.__interfaces!=null&&bK.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||bK===null)&&((typeof aR==="number")||aR===null)&&((typeof b==="number")||b===null)&&((typeof bD==="number")||bD===null)&&((typeof aQ==="number")||aQ===null)&&((typeof a7==="number")||a7===null)&&((typeof bS==="boolean")||bS===null)&&((typeof k==="string")||k===null)&&((au!=null&&au instanceof Array&&(au.length==0||au[0]==null||au[0] instanceof Array))||au===null)&&((typeof bB==="boolean")||bB===null)&&((typeof S==="number")||S===null)&&((typeof x==="string")||x===null)&&((typeof aI==="boolean")||aI===null)&&((typeof Z==="boolean")||Z===null)&&((typeof bh==="boolean")||bh===null)&&((typeof bg==="boolean")||bg===null)&&((c!=null&&c instanceof Big)||c===null)&&((A!=null&&A instanceof Big)||A===null)&&((typeof am==="string")||am===null)&&j===undefined&&bC===undefined&&G===undefined&&J===undefined&&bs===undefined&&aC===undefined){var e=arguments;var al=e[16];var bp=e[17];var aL=e[18];var bI=e[19];var be=e[20];var aW=e[21];var D=e[22];var a3=e[23];var bz=e[24];var az=e[25];var ac=e[26];var a8=e[27];var bQ=arguments;var aq=null;var bP=arguments;var P=false;var t=null;var X=Math.PI/8;var u=true;var bv=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=K;this.name=ae;this.description=R;this.information=M;this.tags=y;this.creationDate=aG;this.grade=bE;this.icon=l;this.planIcon=at;this.model=bK;this.width=aR;this.depth=b;this.height=bD;this.elevation=aQ;this.dropOnTopElevation=a7;this.movable=bS;this.doorOrWindow=P;this.color=t;this.staircaseCutOutShape=al;this.creator=be;this.horizontallyRotatable=bz;this.price=az;this.valueAddedTaxPercentage=ac;this.currency=a8;this.properties=aq==null||Object.keys(aq).length===0?{}:(Object.keys(aq).length===1?(function(bT){var bU={};bU[bT]=(function(bV){var bW=0;return{next:function(){return bW<bV.length?bV[bW++]:null},hasNext:function(){return bW<bV.length}}})((function(bV){return Object.keys(bV).map(function(bW){return bV[bW]})})(aq)).next();return bU})((function(bT){var bU=0;return{next:function(){return bU<bT.length?bT[bU++]:null},hasNext:function(){return bU<bT.length}}})(Object.keys(aq)).next()):((function(bV){var bT={};for(var bU in bV){bT[bU]=bV[bU]}return bT})(aq)));if(bp==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(bp)}this.backFaceShown=aL;this.modelSize=bI;this.resizable=aW;this.deformable=D;this.texturable=a3;this.iconYaw=X;this.proportional=u;this.modifiable=bv;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof K==="string")||K===null)&&((typeof ae==="string")||ae===null)&&((typeof R==="string")||R===null)&&((typeof M==="string")||M===null)&&((y!=null&&y instanceof Array&&(y.length==0||y[0]==null||(typeof y[0]==="string")))||y===null)&&((typeof aG==="number")||aG===null)&&((typeof bE==="number")||bE===null)&&((l!=null&&(l.constructor!=null&&l.constructor.__interfaces!=null&&l.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||l===null)&&((at!=null&&(at.constructor!=null&&at.constructor.__interfaces!=null&&at.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||at===null)&&((bK!=null&&(bK.constructor!=null&&bK.constructor.__interfaces!=null&&bK.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||bK===null)&&((typeof aR==="number")||aR===null)&&((typeof b==="number")||b===null)&&((typeof bD==="number")||bD===null)&&((typeof aQ==="number")||aQ===null)&&((typeof a7==="number")||a7===null)&&((typeof bS==="boolean")||bS===null)&&((typeof k==="string")||k===null)&&((au!=null&&au instanceof Array&&(au.length==0||au[0]==null||au[0] instanceof Array))||au===null)&&((typeof bB==="boolean")||bB===null)&&((typeof S==="string")||S===null)&&((typeof x==="boolean")||x===null)&&((typeof aI==="boolean")||aI===null)&&((typeof Z==="boolean")||Z===null)&&((bh!=null&&bh instanceof Big)||bh===null)&&((bg!=null&&bg instanceof Big)||bg===null)&&((typeof c==="string")||c===null)&&A===undefined&&am===undefined&&j===undefined&&bC===undefined&&G===undefined&&J===undefined&&bs===undefined&&aC===undefined){var e=arguments;var ak=e[16];var bo=e[17];var aJ=e[18];var bd=e[19];var aV=e[20];var C=e[21];var a2=e[22];var ay=e[23];var ab=e[24];var a6=e[25];var bO=arguments;var bH=null;var by=true;var bN=arguments;var ap=null;var bM=arguments;var O=false;var q=null;var V=Math.PI/8;var r=true;var bu=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=K;this.name=ae;this.description=R;this.information=M;this.tags=y;this.creationDate=aG;this.grade=bE;this.icon=l;this.planIcon=at;this.model=bK;this.width=aR;this.depth=b;this.height=bD;this.elevation=aQ;this.dropOnTopElevation=a7;this.movable=bS;this.doorOrWindow=O;this.color=q;this.staircaseCutOutShape=ak;this.creator=bd;this.horizontallyRotatable=by;this.price=ay;this.valueAddedTaxPercentage=ab;this.currency=a6;this.properties=ap==null||Object.keys(ap).length===0?{}:(Object.keys(ap).length===1?(function(bT){var bU={};bU[bT]=(function(bV){var bW=0;return{next:function(){return bW<bV.length?bV[bW++]:null},hasNext:function(){return bW<bV.length}}})((function(bV){return Object.keys(bV).map(function(bW){return bV[bW]})})(ap)).next();return bU})((function(bT){var bU=0;return{next:function(){return bU<bT.length?bT[bU++]:null},hasNext:function(){return bU<bT.length}}})(Object.keys(ap)).next()):((function(bV){var bT={};for(var bU in bV){bT[bU]=bV[bU]}return bT})(ap)));if(bo==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(bo)}this.backFaceShown=aJ;this.modelSize=bH;this.resizable=aV;this.deformable=C;this.texturable=a2;this.iconYaw=V;this.proportional=r;this.modifiable=bu;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof K==="string")||K===null)&&((typeof ae==="string")||ae===null)&&((typeof R==="string")||R===null)&&((M!=null&&(M.constructor!=null&&M.constructor.__interfaces!=null&&M.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||M===null)&&((y!=null&&(y.constructor!=null&&y.constructor.__interfaces!=null&&y.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||y===null)&&((aG!=null&&(aG.constructor!=null&&aG.constructor.__interfaces!=null&&aG.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||aG===null)&&((typeof bE==="number")||bE===null)&&((typeof l==="number")||l===null)&&((typeof at==="number")||at===null)&&((typeof bK==="number")||bK===null)&&((typeof aR==="boolean")||aR===null)&&((b!=null&&b instanceof Array&&(b.length==0||b[0]==null||b[0] instanceof Array))||b===null)&&((typeof bD==="string")||bD===null)&&((typeof aQ==="boolean")||aQ===null)&&((a7!=null&&a7 instanceof Big)||a7===null)&&((bS!=null&&bS instanceof Big)||bS===null)&&k===undefined&&au===undefined&&bB===undefined&&S===undefined&&x===undefined&&aI===undefined&&Z===undefined&&bh===undefined&&bg===undefined&&c===undefined&&A===undefined&&am===undefined&&j===undefined&&bC===undefined&&G===undefined&&J===undefined&&bs===undefined&&aC===undefined){var e=arguments;var ai=e[3];var s=e[4];var h=e[5];var aF=e[6];var aP=e[7];var a1=e[8];var I=e[9];var bk=e[10];var bn=e[11];var bc=e[12];var aU=e[13];var ax=e[14];var Y=e[15];if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof K==="string")||K===null)&&((typeof ae==="string")||ae===null)&&((typeof R==="string")||R===null)&&((M!=null&&(M.constructor!=null&&M.constructor.__interfaces!=null&&M.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||M===null)&&((y!=null&&(y.constructor!=null&&y.constructor.__interfaces!=null&&y.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||y===null)&&((typeof aG==="number")||aG===null)&&((typeof bE==="number")||bE===null)&&((typeof l==="number")||l===null)&&((typeof at==="number")||at===null)&&((typeof bK==="boolean")||bK===null)&&((typeof aR==="boolean")||aR===null)&&((b!=null&&b instanceof Array&&(b.length==0||b[0]==null||b[0] instanceof Array))||b===null)&&((typeof bD==="string")||bD===null)&&((typeof aQ==="boolean")||aQ===null)&&((a7!=null&&a7 instanceof Big)||a7===null)&&((bS!=null&&bS instanceof Big)||bS===null)&&k===undefined&&au===undefined&&bB===undefined&&S===undefined&&x===undefined&&aI===undefined&&Z===undefined&&bh===undefined&&bg===undefined&&c===undefined&&A===undefined&&am===undefined&&j===undefined&&bC===undefined&&G===undefined&&J===undefined&&bs===undefined&&aC===undefined){var e=arguments;var ag=e[3];var g=e[4];var aE=e[5];var aN=e[6];var a0=e[7];var H=e[8];var bj=e[9];var N=e[10];var bm=e[11];var bb=e[12];var aT=e[13];var aw=e[14];var W=e[15];if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof K==="string")||K===null)&&((ae!=null&&(ae.constructor!=null&&ae.constructor.__interfaces!=null&&ae.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||ae===null)&&((R!=null&&(R.constructor!=null&&R.constructor.__interfaces!=null&&R.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||R===null)&&((typeof M==="number")||M===null)&&((typeof y==="number")||y===null)&&((typeof aG==="number")||aG===null)&&((typeof bE==="number")||bE===null)&&((typeof l==="boolean")||l===null)&&((typeof at==="string")||at===null)&&((typeof bK==="number")||bK===null)&&((aR!=null&&aR instanceof Array&&(aR.length==0||aR[0]==null||aR[0] instanceof Array))||aR===null)&&((typeof b==="boolean")||b===null)&&((typeof bD==="number")||bD===null)&&((typeof aQ==="string")||aQ===null)&&((typeof a7==="number")||a7===null)&&((typeof bS==="boolean")||bS===null)&&k===undefined&&au===undefined&&bB===undefined&&S===undefined&&x===undefined&&aI===undefined&&Z===undefined&&bh===undefined&&bg===undefined&&c===undefined&&A===undefined&&am===undefined&&j===undefined&&bC===undefined&&G===undefined&&J===undefined&&bs===undefined&&aC===undefined){var e=arguments;var ah=e[0];var af=e[1];var f=e[2];var aD=e[3];var aK=e[4];var aY=e[5];var F=e[6];var bi=e[7];var aj=e[8];var n=e[9];var bl=e[10];var aH=e[11];var bG=e[12];var ba=e[13];var T=e[14];var o=e[15];var bL=arguments;var d=null;var bF=null;var br=null;var aB=[];var aM=Date.now();var m=null;var p=null;var z=1;var L=false;var aS=true;var B=true;var aZ=true;var bx=true;var av=null;var U=null;var a5=null;var ao=null;var bt=true;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=d;this.name=ah;this.description=bF;this.information=br;this.tags=aB;this.creationDate=aM;this.grade=m;this.icon=af;this.planIcon=p;this.model=f;this.width=aD;this.depth=aK;this.height=aY;this.elevation=F;this.dropOnTopElevation=z;this.movable=bi;this.doorOrWindow=L;this.color=n;this.staircaseCutOutShape=aj;this.creator=ba;this.horizontallyRotatable=bx;this.price=av;this.valueAddedTaxPercentage=U;this.currency=a5;this.properties=ao==null||Object.keys(ao).length===0?{}:(Object.keys(ao).length===1?(function(bT){var bU={};bU[bT]=(function(bV){var bW=0;return{next:function(){return bW<bV.length?bV[bW++]:null},hasNext:function(){return bW<bV.length}}})((function(bV){return Object.keys(bV).map(function(bW){return bV[bW]})})(ao)).next();return bU})((function(bT){var bU=0;return{next:function(){return bU<bT.length?bT[bU++]:null},hasNext:function(){return bU<bT.length}}})(Object.keys(ao)).next()):((function(bV){var bT={};for(var bU in bV){bT[bU]=bV[bU]}return bT})(ao)));if(bl==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(bl)}this.backFaceShown=aH;this.modelSize=bG;this.resizable=aS;this.deformable=B;this.texturable=aZ;this.iconYaw=T;this.proportional=o;this.modifiable=bt;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{throw new Error("invalid overload")}}}}}}}}a.__static_initialize=function(){if(!a.__static_initialized){a.__static_initialized=true;a.__static_initializer_0()}};a.EMPTY_CRITERIA_$LI$=function(){a.__static_initialize();if(a.EMPTY_CRITERIA==null){a.EMPTY_CRITERIA=[]}return a.EMPTY_CRITERIA};a.COMPARATOR_$LI$=function(){a.__static_initialize();return a.COMPARATOR};a.recentFilters_$LI$=function(){a.__static_initialize();return a.recentFilters};a.__static_initializer_0=function(){a.COMPARATOR={compare:function(c,b){return c.toString().localeCompare(b.toString())},equals:function(c,b){return c.toString().localeCompare(b.toString())===0}};a.COMPARATOR_$LI$();a.recentFilters=({})};a.prototype.getId=function(){return this.id};a.prototype.getName=function(){return this.name};a.prototype.getDescription=function(){return this.description};a.prototype.getInformation=function(){return this.information};a.prototype.getTags=function(){return this.tags};a.prototype.getCreationDate=function(){return this.creationDate};a.prototype.getGrade=function(){return this.grade};a.prototype.getDepth=function(){return this.depth};a.prototype.getHeight=function(){return this.height};a.prototype.getWidth=function(){return this.width};a.prototype.getElevation=function(){return this.elevation};a.prototype.getDropOnTopElevation=function(){return this.dropOnTopElevation};a.prototype.isMovable=function(){return this.movable};a.prototype.isDoorOrWindow=function(){return this.doorOrWindow};a.prototype.getIcon=function(){return this.icon};a.prototype.getPlanIcon=function(){return this.planIcon};a.prototype.getModel=function(){return this.model};a.prototype.getModelSize=function(){return this.modelSize};a.prototype.getModelRotation=function(){return a.deepClone(this.modelRotation)};a.deepClone=function(b){return[[b[0][0],b[0][1],b[0][2]],[b[1][0],b[1][1],b[1][2]],[b[2][0],b[2][1],b[2][2]]]};a.prototype.getStaircaseCutOutShape=function(){return this.staircaseCutOutShape};a.prototype.getCreator=function(){return this.creator};a.prototype.isBackFaceShown=function(){return this.backFaceShown};a.prototype.getColor=function(){return this.color};a.prototype.getIconYaw=function(){return this.iconYaw};a.prototype.isProportional=function(){return this.proportional};a.prototype.isModifiable=function(){return this.modifiable};a.prototype.isResizable=function(){return this.resizable};a.prototype.isDeformable=function(){return this.deformable};a.prototype.isWidthDepthDeformable=function(){return this.isDeformable()};a.prototype.isTexturable=function(){return this.texturable};a.prototype.isHorizontallyRotatable=function(){return this.horizontallyRotatable};a.prototype.getPrice=function(){return this.price};a.prototype.getValueAddedTaxPercentage=function(){return this.valueAddedTaxPercentage};a.prototype.getCurrency=function(){return this.currency};a.prototype.getProperty=function(b){return(function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b)};a.prototype.getPropertyNames=function(){return Object.keys(this.properties)};a.prototype.getCategory=function(){return this.category};a.prototype.setCategory=function(b){this.category=b};a.prototype.equals=function(b){return(function(d,c){return d&&d.equals?d.equals(c):d===c})(this,b)};a.prototype.hashCode=function(){return(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this)};a.prototype.compareTo=function(c){var b=a.COMPARATOR_$LI$().compare(this.name,c.name);if(b!==0){return b}else{return this.modifiable===c.modifiable?0:(this.modifiable?1:-1)}};a.prototype.matchesFilter=function(d){var e=this.getFilterCollationKeys(d);var f=0;if(e.length>0){var b=this.getPieceOfFurnitureCollationKey();for(var c=0;c<e.length;c++){if(this.isSubCollationKey(b,e[c],0)){f++}else{break}}}return f===e.length};a.prototype.getFilterCollationKeys=function(d){if(d.length===0){return a.EMPTY_CRITERIA_$LI$()}var c=(function(h,j){return h[j]===undefined?null:h[j]})(a.recentFilters_$LI$(),d);if(c==null){var g=d.split("\\s|\\p{Punct}|\\|");var f=([]);for(var b=0;b<g.length;b++){var e=g[b];if(e.length>0){(f.push(a.COMPARATOR_$LI$().getCollationKey(e).toByteArray())>0)}}if(f.length===0){c=a.EMPTY_CRITERIA_$LI$()}else{c=f.slice(0)}(a.recentFilters_$LI$()[d]=c)}return c};a.prototype.getPieceOfFurnitureCollationKey=function(){if(this.filterCollationKey==null){var d={str:"",toString:function(){return this.str}};var e=this.getFilterCriteria();var b=function(f){var g=e[f];if(d.str.length!==0){(function(h){h.str+="|";return h})(d)}(function(h){h.str+=g;return h})(d)};for(var c=0;c<e.length;c++){b(c)}this.filterCollationKey=a.COMPARATOR_$LI$().getCollationKey(d.str).toByteArray()}return this.filterCollationKey};a.prototype.getFilterCriteria=function(){var e=([]);(e.push(this.getName())>0);if(this.getCategory()!=null){(e.push(this.getCategory().getName())>0)}if(this.getCreator()!=null){(e.push(this.getCreator())>0)}if(this.getDescription()!=null){(e.push(this.getDescription())>0)}var d=this.getTags();for(var c=0;c<d.length;c++){var b=d[c];(e.push(b)>0)}return e.slice(0)};a.prototype.isSubCollationKey=function(e,h,g){for(var d=g,f=e.length-4,b=h.length-4;d<f&&d<f-b+1;d++){if(e[d]===h[0]){for(var c=1;c<b;c++){if(e[d+c]!==h[c]){return this.isSubCollationKey(e,h,d+1)}}return true}}return false};a.prototype.clone=function(){try{var c=(function(e){var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f})(this);c.category=null;return c}catch(b){throw new IllegalStateException("Super class isn't cloneable")}};a.__static_initialized=false;return a}());CatalogPieceOfFurniture.__class="com.eteks.sweethome3d.model.CatalogPieceOfFurniture";CatalogPieceOfFurniture.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.PieceOfFurniture"];var CollectionChangeSupport=(function(){function a(b){if(this.source===undefined){this.source=null}if(this.collectionListeners===undefined){this.collectionListeners=null}this.source=b;this.collectionListeners=([])}a.prototype.addCollectionListener=function(b){(this.collectionListeners.push(b)>0)};a.prototype.removeCollectionListener=function(b){(function(c){var d=c.indexOf(b);if(d>=0){c.splice(d,1);return true}else{return false}})(this.collectionListeners)};a.prototype.fireCollectionChanged$java_lang_Object$com_eteks_sweethome3d_model_CollectionEvent_Type=function(c,b){this.fireCollectionChanged(c,-1,b)};a.prototype.fireCollectionChanged$java_lang_Object$int$com_eteks_sweethome3d_model_CollectionEvent_Type=function(f,c,d){if(!(this.collectionListeners.length==0)){var b=(new CollectionEvent(this.source,f,c,d));var e=this.collectionListeners.slice(0);for(var h=0;h<e.length;h++){var g=e[h];g(b)}}};a.prototype.fireCollectionChanged=function(d,b,c){if(((d!=null)||d===null)&&((typeof b==="number")||b===null)&&((typeof c==="number")||c===null)){return this.fireCollectionChanged$java_lang_Object$int$com_eteks_sweethome3d_model_CollectionEvent_Type(d,b,c)}else{if(((d!=null)||d===null)&&((typeof b==="number")||b===null)&&c===undefined){return this.fireCollectionChanged$java_lang_Object$com_eteks_sweethome3d_model_CollectionEvent_Type(d,b)}else{throw new Error("invalid overload")}}};return a}());CollectionChangeSupport.__class="com.eteks.sweethome3d.model.CollectionChangeSupport";var CollectionEvent=(function(a){__extends(b,a);function b(c,l,h,k){var f=this;if(((c!=null)||c===null)&&((l!=null)||l===null)&&((typeof h==="number")||h===null)&&((typeof k==="number")||k===null)){var g=arguments;f=a.call(this,c)||this;if(f.item===undefined){f.item=null}if(f.index===undefined){f.index=0}if(f.type===undefined){f.type=null}f.item=l;f.index=h;f.type=k}else{if(((c!=null)||c===null)&&((l!=null)||l===null)&&((typeof h==="number")||h===null)&&k===undefined){var g=arguments;var j=g[2];var d=arguments;var e=-1;f=a.call(this,c)||this;if(f.item===undefined){f.item=null}if(f.index===undefined){f.index=0}if(f.type===undefined){f.type=null}f.item=l;f.index=e;f.type=j;if(f.item===undefined){f.item=null}if(f.index===undefined){f.index=0}if(f.type===undefined){f.type=null}}else{throw new Error("invalid overload")}}return f}b.prototype.getItem=function(){return this.item};b.prototype.getIndex=function(){return this.index};b.prototype.getType=function(){return this.type};return b}(EventObject));CollectionEvent.__class="com.eteks.sweethome3d.model.CollectionEvent";(function(b){var a;(function(c){c[c.ADD=0]="ADD";c[c.DELETE=1]="DELETE"})(a=b.Type||(b.Type={}))})(CollectionEvent||(CollectionEvent={}));CollectionEvent.__transients=["source"];var SelectionEvent=(function(b){__extends(a,b);function a(c,e){var d=b.call(this,c)||this;if(d.selectedItems===undefined){d.selectedItems=null}d.selectedItems=e;return d}a.prototype.getSelectedItems=function(){return this.selectedItems};return a}(EventObject));SelectionEvent.__class="com.eteks.sweethome3d.model.SelectionEvent";SelectionEvent.__transients=["source"];var FurnitureCategory=(function(){function a(b){if(this.name===undefined){this.name=null}if(this.furniture===undefined){this.furniture=null}this.name=b;this.furniture=([])}a.COMPARATOR_$LI$=function(){if(a.COMPARATOR==null){a.COMPARATOR={compare:function(c,b){return c.toString().localeCompare(b.toString())},equals:function(c,b){return c.toString().localeCompare(b.toString())===0}}}return a.COMPARATOR};a.prototype.getName=function(){return this.name};a.prototype.getFurniture=function(){return this.furniture.slice(0)};a.prototype.getFurnitureCount=function(){return this.furniture.length};a.prototype.getPieceOfFurniture=function(b){return this.furniture[b]};a.prototype.getIndexOfPieceOfFurniture=function(b){return this.furniture.indexOf(b)};a.prototype.add=function(c){c.setCategory(this);var b=(function(e,h){var f=function(n,l){if(n.compareTo){return n.compareTo(l)}else{return n.localeCompare(l)}};var d=0;var k=e.length-1;while(d<=k){var g=(d+k)>>>1;var m=e[g];var j=f(m,h);if(j<0){d=g+1}else{if(j>0){k=g-1}else{return g}}}return -(d+1)})(this.furniture,c);if(b<0){b=-b-1}this.furniture.splice(b,0,c)};a.prototype["delete"]=function(b){var c=this.furniture.indexOf(b);if(c===-1){throw new IllegalArgumentException(this.name+" doesn't contain piece "+b.getName())}this.furniture=(this.furniture.slice(0));this.furniture.splice(c,1)[0]};a.prototype.equals=function(b){return(b!=null&&b instanceof a)&&a.COMPARATOR_$LI$().equals(this.name,b.name)};a.prototype.hashCode=function(){return(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this.name)};a.prototype.compareTo=function(b){return a.COMPARATOR_$LI$().compare(this.name,b.name)};return a}());FurnitureCategory.__class="com.eteks.sweethome3d.model.FurnitureCategory";var HomeMaterial=(function(){function a(c,k,e,j,m){if(((typeof c==="string")||c===null)&&((typeof k==="string")||k===null)&&((typeof e==="number")||e===null)&&((j!=null&&j instanceof HomeTexture)||j===null)&&((typeof m==="number")||m===null)){var g=arguments;if(this.name===undefined){this.name=null}if(this.key===undefined){this.key=null}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}if(this.shininess===undefined){this.shininess=null}this.name=c;this.key=k;this.color=e;this.texture=j;this.shininess=m}else{if(((typeof c==="string")||c===null)&&((typeof k==="number")||k===null)&&((e!=null&&e instanceof HomeTexture)||e===null)&&((typeof j==="number")||j===null)&&m===undefined){var g=arguments;var l=g[1];var h=g[2];var d=g[3];var b=arguments;var f=null;if(this.name===undefined){this.name=null}if(this.key===undefined){this.key=null}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}if(this.shininess===undefined){this.shininess=null}this.name=c;this.key=f;this.color=l;this.texture=h;this.shininess=d;if(this.name===undefined){this.name=null}if(this.key===undefined){this.key=null}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}if(this.shininess===undefined){this.shininess=null}}else{throw new Error("invalid overload")}}}a.prototype.getName=function(){return this.name};a.prototype.getKey=function(){return this.key};a.prototype.getColor=function(){return this.color};a.prototype.getTexture=function(){return this.texture};a.prototype.getShininess=function(){return this.shininess};a.prototype.equals=function(b){if(b!=null&&b instanceof a){var c=b;return(c.name===this.name||(c.name!=null&&(c.name===this.name)))&&(c.key===this.key||(c.key!=null&&(c.key===this.name)))&&(c.color===this.color||(c.color!=null&&(c.color===this.color)))&&(c.texture===this.texture||(c.texture!=null&&c.texture.equals(this.texture)))&&(c.shininess===this.shininess||(c.shininess!=null&&(c.shininess===this.shininess)))}return false};a.prototype.hashCode=function(){var b=0;if(this.name!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.name)}if(this.key!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.key)}if(this.color!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.color)}if(this.texture!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.texture)}if(this.shininess!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.shininess)}return b};return a}());HomeMaterial.__class="com.eteks.sweethome3d.model.HomeMaterial";var Sash=(function(){function a(f,c,e,d,b){if(this.xAxis===undefined){this.xAxis=0}if(this.yAxis===undefined){this.yAxis=0}if(this.width===undefined){this.width=0}if(this.startAngle===undefined){this.startAngle=0}if(this.endAngle===undefined){this.endAngle=0}this.xAxis=f;this.yAxis=c;this.width=e;this.startAngle=d;this.endAngle=b}a.prototype.getXAxis=function(){return this.xAxis};a.prototype.getYAxis=function(){return this.yAxis};a.prototype.getWidth=function(){return this.width};a.prototype.getStartAngle=function(){return this.startAngle};a.prototype.getEndAngle=function(){return this.endAngle};return a}());Sash.__class="com.eteks.sweethome3d.model.Sash";var PieceOfFurniture;(function(a){a.DEFAULT_CUT_OUT_SHAPE="M0,0 v1 h1 v-1 z";function b(){if(a.IDENTITY_ROTATION==null){a.IDENTITY_ROTATION=[[1,0,0],[0,1,0],[0,0,1]]}return a.IDENTITY_ROTATION}a.IDENTITY_ROTATION_$LI$=b})(PieceOfFurniture||(PieceOfFurniture={}));var HomeController3D=(function(){function a(f,c,b,e,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.home3DView===undefined){this.home3DView=null}if(this.topCameraState===undefined){this.topCameraState=null}if(this.observerCameraState===undefined){this.observerCameraState=null}if(this.cameraState===undefined){this.cameraState=null}this.home=f;this.preferences=c;this.viewFactory=b;this.contentManager=e;this.undoSupport=d;this.topCameraState=new a.TopCameraState(this,c);this.observerCameraState=new a.ObserverCameraState(this);this.setCameraState(f.getCamera()===f.getTopCamera()?this.topCameraState:this.observerCameraState);this.addModelListeners(f)}a.prototype.addModelListeners=function(e){e.addPropertyChangeListener("CAMERA",new a.HomeController3D$0(this,e));var c=new a.HomeController3D$1(this,e);var d=e.getSelectedLevel();if(d!=null){d.addPropertyChangeListener(c)}e.addPropertyChangeListener("SELECTED_LEVEL",new a.HomeController3D$2(this,e,c));var b=new a.HomeController3D$3(this,e);e.addPropertyChangeListener("SELECTED_LEVEL",b);e.getEnvironment().addPropertyChangeListener("ALL_LEVELS_VISIBLE",b)};a.prototype.getObserverCameraMinimumElevation=function(d){var c=d.getLevels();var b=c.length===0?10:10+c[0].getElevation();return b};a.prototype.getView=function(){if(this.home3DView==null){this.home3DView=this.viewFactory.createView3D(this.home,this.preferences,this)}return this.home3DView};a.prototype.viewFromTop=function(){this.home.setCamera(this.home.getTopCamera())};a.prototype.viewFromObserver=function(){this.home.setCamera(this.home.getObserverCamera())};a.prototype.storeCamera=function(c){var f=this.home.getCamera().duplicate();f.setName(c);var e=this.home.getStoredCameras();var b=([]);(function(j,h){return j.push.apply(j,h)})(b,e);for(var d=b.length-1;d>=0;d--){var g=b[d];if((c===g.getName())||(f.getX()===g.getX()&&f.getY()===g.getY()&&f.getZ()===g.getZ()&&f.getPitch()===g.getPitch()&&f.getYaw()===g.getYaw()&&f.getFieldOfView()===g.getFieldOfView()&&f.getTime()===g.getTime()&&f.getLens()===g.getLens())){b.splice(d,1)[0]}}b.splice(0,0,f);while((b.length>this.preferences.getStoredCamerasMaxCount())){b.splice(b.length-1,1)[0]}this.home.setStoredCameras(b)};a.prototype.goToCamera=function(c){if(c!=null&&c instanceof ObserverCamera){this.viewFromObserver()}else{this.viewFromTop()}this.cameraState.goToCamera(c);var b=(this.home.getStoredCameras().slice(0));(function(d){var e=d.indexOf(c);if(e>=0){d.splice(e,1);return true}else{return false}})(b);b.splice(0,0,c);this.home.setStoredCameras(b)};a.prototype.deleteCameras=function(e){var d=this.home.getStoredCameras();var c=([]);for(var b=0;b<d.length;b++){var f=d[b];if(!(e.indexOf((f))>=0)){(c.push(f)>0)}}this.home.setStoredCameras(c)};a.prototype.displayAllLevels=function(){this.home.getEnvironment().setAllLevelsVisible(true)};a.prototype.displaySelectedLevel=function(){this.home.getEnvironment().setAllLevelsVisible(false)};a.prototype.modifyAttributes=function(){new Home3DAttributesController(this.home,this.preferences,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())};a.prototype.setCameraState=function(b){if(this.cameraState!=null){this.cameraState.exit()}this.cameraState=b;this.cameraState.enter()};a.prototype.moveCamera=function(b){this.cameraState.moveCamera(b)};a.prototype.moveCameraSideways=function(b){this.cameraState.moveCameraSideways(b)};a.prototype.elevateCamera=function(b){this.cameraState.elevateCamera(b)};a.prototype.rotateCameraYaw=function(b){this.cameraState.rotateCameraYaw(b)};a.prototype.rotateCameraPitch=function(b){this.cameraState.rotateCameraPitch(b)};a.prototype.modifyFieldOfView=function(b){this.cameraState.modifyFieldOfView(b)};a.prototype.getObserverCameraState=function(){return this.observerCameraState};a.prototype.getTopCameraState=function(){return this.topCameraState};return a}());HomeController3D.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D";HomeController3D.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(g){var j=(function(){function k(){}k.prototype.enter=function(){};k.prototype.exit=function(){};k.prototype.moveCamera=function(l){};k.prototype.moveCameraSideways=function(l){};k.prototype.elevateCamera=function(l){};k.prototype.rotateCameraYaw=function(l){};k.prototype.rotateCameraPitch=function(l){};k.prototype.modifyFieldOfView=function(l){};k.prototype.goToCamera=function(l){};return k}());g.CameraControllerState=j;j.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.CameraControllerState";var h=(function(){function k(l){if(this.topCameraState===undefined){this.topCameraState=null}this.topCameraState=(l)}k.prototype.propertyChange=function(m){var n=this.topCameraState;var l=m.getSource();if(n==null){l.removePropertyChangeListener(m.getPropertyName(),this)}else{n.setAerialViewCenteredOnSelectionEnabled(l.isAerialViewCenteredOnSelectionEnabled())}};return k}());g.UserPreferencesChangeListener=h;h.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.UserPreferencesChangeListener";var f=(function(l){__extends(k,l);function k(n,m){var o=l.call(this)||this;o.__parent=n;o.MIN_WIDTH=100;o.MIN_DEPTH=o.MIN_WIDTH;o.MIN_HEIGHT=20;if(o.topCamera===undefined){o.topCamera=null}if(o.aerialViewBoundsLowerPoint===undefined){o.aerialViewBoundsLowerPoint=null}if(o.aerialViewBoundsUpperPoint===undefined){o.aerialViewBoundsUpperPoint=null}if(o.minDistanceToAerialViewCenter===undefined){o.minDistanceToAerialViewCenter=0}if(o.maxDistanceToAerialViewCenter===undefined){o.maxDistanceToAerialViewCenter=0}if(o.aerialViewCenteredOnSelectionEnabled===undefined){o.aerialViewCenteredOnSelectionEnabled=false}if(o.previousSelectionEmpty===undefined){o.previousSelectionEmpty=false}o.distanceToCenterWithSelection=-1;o.objectChangeListener=new k.TopCameraState$0(o);o.levelsListener=function(p){if(p.getType()===CollectionEvent.Type.ADD){p.getItem().addPropertyChangeListener(o.objectChangeListener)}else{if(p.getType()===CollectionEvent.Type.DELETE){p.getItem().removePropertyChangeListener(o.objectChangeListener)}}o.updateCameraFromHomeBounds(false,false)};o.wallsListener=function(p){if(p.getType()===CollectionEvent.Type.ADD){p.getItem().addPropertyChangeListener(o.objectChangeListener)}else{if(p.getType()===CollectionEvent.Type.DELETE){p.getItem().removePropertyChangeListener(o.objectChangeListener)}}o.updateCameraFromHomeBounds(false,false)};o.furnitureListener=function(p){if(p.getType()===CollectionEvent.Type.ADD){o.addPropertyChangeListener(p.getItem(),o.objectChangeListener);o.updateCameraFromHomeBounds(n.home.getFurniture().length===1&&(n.home.getWalls().length==0)&&(n.home.getRooms().length==0),false)}else{if(p.getType()===CollectionEvent.Type.DELETE){o.removePropertyChangeListener(p.getItem(),o.objectChangeListener);o.updateCameraFromHomeBounds(false,false)}}};o.roomsListener=function(p){if(p.getType()===CollectionEvent.Type.ADD){p.getItem().addPropertyChangeListener(o.objectChangeListener)}else{if(p.getType()===CollectionEvent.Type.DELETE){p.getItem().removePropertyChangeListener(o.objectChangeListener)}}o.updateCameraFromHomeBounds(false,false)};o.polylinesListener=function(p){if(p.getType()===CollectionEvent.Type.ADD){p.getItem().addPropertyChangeListener(o.objectChangeListener)}else{if(p.getType()===CollectionEvent.Type.DELETE){p.getItem().removePropertyChangeListener(o.objectChangeListener)}}o.updateCameraFromHomeBounds(false,false)};o.labelsListener=function(p){if(p.getType()===CollectionEvent.Type.ADD){p.getItem().addPropertyChangeListener(o.objectChangeListener)}else{if(p.getType()===CollectionEvent.Type.DELETE){p.getItem().removePropertyChangeListener(o.objectChangeListener)}}o.updateCameraFromHomeBounds(false,false)};o.selectionListener=new k.TopCameraState$1(o);if(o.userPreferencesChangeListener===undefined){o.userPreferencesChangeListener=null}o.userPreferencesChangeListener=new g.UserPreferencesChangeListener(o);return o}k.prototype.addPropertyChangeListener=function(n,o){if(n!=null&&n instanceof HomeFurnitureGroup){var q=n.getFurniture();for(var m=0;m<q.length;m++){var p=q[m];this.addPropertyChangeListener(p,o)}}else{n.addPropertyChangeListener(o)}};k.prototype.removePropertyChangeListener=function(n,o){if(n!=null&&n instanceof HomeFurnitureGroup){var q=n.getFurniture();for(var m=0;m<q.length;m++){var p=q[m];this.removePropertyChangeListener(p,o)}}else{n.removePropertyChangeListener(o)}};k.prototype.enter=function(){this.topCamera=this.__parent.home.getCamera();this.previousSelectionEmpty=(this.__parent.home.getSelectedItems().length==0);this.aerialViewCenteredOnSelectionEnabled=this.__parent.preferences.isAerialViewCenteredOnSelectionEnabled();this.updateCameraFromHomeBounds(false,false);var t=this.__parent.home.getLevels();for(var p=0;p<t.length;p++){var s=t[p];s.addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addLevelsListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.levelsListener)));var t=this.__parent.home.getWalls();for(var p=0;p<t.length;p++){var m=t[p];m.addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addWallsListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.wallsListener)));var t=this.__parent.home.getFurniture();for(var p=0;p<t.length;p++){var q=t[p];this.addPropertyChangeListener(q,this.objectChangeListener)}this.__parent.home.addFurnitureListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.furnitureListener)));var t=this.__parent.home.getRooms();for(var p=0;p<t.length;p++){var r=t[p];r.addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addRoomsListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.roomsListener)));var t=this.__parent.home.getPolylines();for(var p=0;p<t.length;p++){var n=t[p];n.addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addPolylinesListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.polylinesListener)));var t=this.__parent.home.getLabels();for(var p=0;p<t.length;p++){var o=t[p];o.addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addLabelsListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.labelsListener)));this.__parent.home.addSelectionListener(this.selectionListener);this.__parent.preferences.addPropertyChangeListener("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",this.userPreferencesChangeListener)};k.prototype.setAerialViewCenteredOnSelectionEnabled=function(m){this.aerialViewCenteredOnSelectionEnabled=m;this.updateCameraFromHomeBounds(false,false)};k.prototype.updateCameraFromHomeBounds=function(o,m){if(this.aerialViewBoundsLowerPoint==null){this.updateAerialViewBoundsFromHomeBounds(this.aerialViewCenteredOnSelectionEnabled)}var n;if(m&&this.__parent.preferences.isAerialViewCenteredOnSelectionEnabled()&&this.distanceToCenterWithSelection!==-1){n=this.distanceToCenterWithSelection}else{n=this.getCameraToAerialViewCenterDistance()}if(!(this.__parent.home.getSelectedItems().length==0)){this.distanceToCenterWithSelection=n}this.updateAerialViewBoundsFromHomeBounds(this.aerialViewCenteredOnSelectionEnabled);this.updateCameraIntervalToAerialViewCenter();this.placeCameraAt(n,o)};k.prototype.getCameraToAerialViewCenterDistance=function(){return Math.sqrt(Math.pow((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2-this.topCamera.getX(),2)+Math.pow((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-this.topCamera.getY(),2)+Math.pow((this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2-this.topCamera.getZ(),2))};k.prototype.updateAerialViewBoundsFromHomeBounds=function(u){this.aerialViewBoundsLowerPoint=this.aerialViewBoundsUpperPoint=null;var t=[];if(u){t=([]);var q=this.__parent.home.getSelectedItems();for(var p=0;p<q.length;p++){var E=q[p];if((E!=null&&(E.constructor!=null&&E.constructor.__interfaces!=null&&E.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))&&this.isItemAtVisibleLevel(E)&&(!(E!=null&&E instanceof HomePieceOfFurniture)||E.isVisible())&&(!(E!=null&&E instanceof Label)||E.getPitch()!=null)){(t.push(E)>0)}}}var s=t.length===0||!u;var w=false;var q=s?this.__parent.home.getWalls():Home.getWallsSubList(t);for(var p=0;p<q.length;p++){var C=q[p];if(this.isItemAtVisibleLevel(C)){w=true;var G=C.getLevel()!=null?C.getLevel().getElevation():0;var D=s?0:G;var v=C.getHeight();var A=void 0;if(v!=null){A=G+v}else{A=G+this.__parent.home.getWallHeight()}var y=C.getHeightAtEnd();if(y!=null){A=Math.max(A,G+y)}var F=C.getPoints$();for(var o=0;o<F.length;o++){var z=F[o];this.updateAerialViewBounds(z[0],z[1],D,A)}}}var q=s?this.__parent.home.getFurniture():Home.getFurnitureSubList(t);for(var p=0;p<q.length;p++){var m=q[p];if(m.isVisible()&&this.isItemAtVisibleLevel(m)){var D=void 0;var A=void 0;if(s){D=Math.max(0,m.getGroundElevation());A=Math.max(0,m.getGroundElevation()+m.getHeightInPlan())}else{D=m.getGroundElevation();A=m.getGroundElevation()+m.getHeightInPlan()}var F=m.getPoints();for(var o=0;o<F.length;o++){var z=F[o];this.updateAerialViewBounds(z[0],z[1],D,A)}}}var q=s?this.__parent.home.getRooms():Home.getRoomsSubList(t);for(var p=0;p<q.length;p++){var B=q[p];if(this.isItemAtVisibleLevel(B)){var D=0;var A=this.MIN_HEIGHT;var n=B.getLevel();if(n!=null){D=n.getElevation()-n.getFloorThickness();A=n.getElevation();if(s){D=Math.max(0,D);A=Math.max(this.MIN_HEIGHT,n.getElevation())}}var F=B.getPoints();for(var o=0;o<F.length;o++){var z=F[o];this.updateAerialViewBounds(z[0],z[1],D,A)}}}var q=s?this.__parent.home.getPolylines():Home.getPolylinesSubList(t);for(var p=0;p<q.length;p++){var x=q[p];if(x.isVisibleIn3D()&&this.isItemAtVisibleLevel(x)){var D=void 0;var A=void 0;if(s){D=Math.max(0,x.getGroundElevation());A=Math.max(this.MIN_HEIGHT,x.getGroundElevation())}else{D=A=x.getGroundElevation()}var F=x.getPoints();for(var o=0;o<F.length;o++){var z=F[o];this.updateAerialViewBounds(z[0],z[1],D,A)}}}var q=s?this.__parent.home.getLabels():Home.getLabelsSubList(t);for(var p=0;p<q.length;p++){var r=q[p];if(r.getPitch()!=null&&this.isItemAtVisibleLevel(r)){var D=void 0;var A=void 0;if(s){D=Math.max(0,r.getGroundElevation());A=Math.max(this.MIN_HEIGHT,r.getGroundElevation())}else{D=A=r.getGroundElevation()}var F=r.getPoints();for(var o=0;o<F.length;o++){var z=F[o];this.updateAerialViewBounds(z[0],z[1],D,A)}}}if(this.aerialViewBoundsLowerPoint==null){this.aerialViewBoundsLowerPoint=[0,0,0];this.aerialViewBoundsUpperPoint=[this.MIN_WIDTH,this.MIN_DEPTH,this.MIN_HEIGHT]}else{if(w&&s){if(this.MIN_WIDTH>this.aerialViewBoundsUpperPoint[0]-this.aerialViewBoundsLowerPoint[0]){this.aerialViewBoundsLowerPoint[0]=(this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2-this.MIN_WIDTH/2;this.aerialViewBoundsUpperPoint[0]=this.aerialViewBoundsLowerPoint[0]+this.MIN_WIDTH}if(this.MIN_DEPTH>this.aerialViewBoundsUpperPoint[1]-this.aerialViewBoundsLowerPoint[1]){this.aerialViewBoundsLowerPoint[1]=(this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-this.MIN_DEPTH/2;this.aerialViewBoundsUpperPoint[1]=this.aerialViewBoundsLowerPoint[1]+this.MIN_DEPTH}if(this.MIN_HEIGHT>this.aerialViewBoundsUpperPoint[2]-this.aerialViewBoundsLowerPoint[2]){this.aerialViewBoundsLowerPoint[2]=(this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2-this.MIN_HEIGHT/2;this.aerialViewBoundsUpperPoint[2]=this.aerialViewBoundsLowerPoint[2]+this.MIN_HEIGHT}}}};k.prototype.updateAerialViewBounds=function(m,p,o,n){if(this.aerialViewBoundsLowerPoint==null){this.aerialViewBoundsLowerPoint=[m,p,o];this.aerialViewBoundsUpperPoint=[m,p,n]}else{this.aerialViewBoundsLowerPoint[0]=Math.min(this.aerialViewBoundsLowerPoint[0],m);this.aerialViewBoundsUpperPoint[0]=Math.max(this.aerialViewBoundsUpperPoint[0],m);this.aerialViewBoundsLowerPoint[1]=Math.min(this.aerialViewBoundsLowerPoint[1],p);this.aerialViewBoundsUpperPoint[1]=Math.max(this.aerialViewBoundsUpperPoint[1],p);this.aerialViewBoundsLowerPoint[2]=Math.min(this.aerialViewBoundsLowerPoint[2],o);this.aerialViewBoundsUpperPoint[2]=Math.max(this.aerialViewBoundsUpperPoint[2],n)}};k.prototype.isItemAtVisibleLevel=function(m){return m.getLevel()==null||m.getLevel().isViewableAndVisible()};k.prototype.updateCameraIntervalToAerialViewCenter=function(){var n=this.aerialViewBoundsUpperPoint[0]-this.aerialViewBoundsLowerPoint[0];var p=this.aerialViewBoundsUpperPoint[1]-this.aerialViewBoundsLowerPoint[1];var m=this.aerialViewBoundsUpperPoint[2]-this.aerialViewBoundsLowerPoint[2];var o=Math.sqrt(n*n+p*p+m*m)/2;this.minDistanceToAerialViewCenter=o*1.05;this.maxDistanceToAerialViewCenter=Math.max(5*this.minDistanceToAerialViewCenter,5000)};k.prototype.moveCamera=function(n){n*=5;var m=this.getCameraToAerialViewCenterDistance()-n;this.placeCameraAt(m,false)};k.prototype.placeCameraAt=function(m,o){m=Math.max(m,this.minDistanceToAerialViewCenter);m=Math.min(m,this.maxDistanceToAerialViewCenter);if(o){m=Math.min(m,3*this.minDistanceToAerialViewCenter)}var n=m*Math.cos(this.topCamera.getPitch());this.topCamera.setX((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2+(Math.sin(this.topCamera.getYaw())*n));this.topCamera.setY((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-(Math.cos(this.topCamera.getYaw())*n));this.topCamera.setZ((this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2+Math.sin(this.topCamera.getPitch())*m)};k.prototype.rotateCameraYaw=function(o){var m=this.topCamera.getYaw()+o;var n=this.getCameraToAerialViewCenterDistance()*Math.cos(this.topCamera.getPitch());this.topCamera.setYaw(m);this.topCamera.setX((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2+(Math.sin(m)*n));this.topCamera.setY((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-(Math.cos(m)*n))};k.prototype.rotateCameraPitch=function(p){var o=this.topCamera.getPitch()+p;o=Math.max(o,0);o=Math.min(o,Math.PI/2);var m=this.getCameraToAerialViewCenterDistance();var n=m*Math.cos(o);this.topCamera.setPitch(o);this.topCamera.setX((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2+(Math.sin(this.topCamera.getYaw())*n));this.topCamera.setY((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-(Math.cos(this.topCamera.getYaw())*n));this.topCamera.setZ((this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2+(m*Math.sin(o)))};k.prototype.goToCamera=function(m){this.topCamera.setCamera(m);this.topCamera.setTime(m.getTime());this.topCamera.setLens(m.getLens());this.updateCameraFromHomeBounds(false,false)};k.prototype.exit=function(){this.topCamera=null;var t=this.__parent.home.getWalls();for(var p=0;p<t.length;p++){var m=t[p];m.removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeWallsListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.wallsListener)));var t=this.__parent.home.getFurniture();for(var p=0;p<t.length;p++){var q=t[p];this.removePropertyChangeListener(q,this.objectChangeListener)}this.__parent.home.removeFurnitureListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.furnitureListener)));var t=this.__parent.home.getRooms();for(var p=0;p<t.length;p++){var r=t[p];r.removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeRoomsListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.roomsListener)));var t=this.__parent.home.getPolylines();for(var p=0;p<t.length;p++){var n=t[p];n.removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removePolylinesListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.polylinesListener)));var t=this.__parent.home.getLabels();for(var p=0;p<t.length;p++){var o=t[p];o.removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeLabelsListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.labelsListener)));var t=this.__parent.home.getLevels();for(var p=0;p<t.length;p++){var s=t[p];s.removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeLevelsListener(((function(u){if(u==null||typeof u=="function"){return u}return function(v){return(u.collectionChanged?u.collectionChanged:u).call(u,v)}})(this.levelsListener)));this.__parent.home.removeSelectionListener(this.selectionListener);this.__parent.preferences.removePropertyChangeListener("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",this.userPreferencesChangeListener)};return k}(g.CameraControllerState));g.TopCameraState=f;f.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.TopCameraState";(function(k){var m=(function(){function n(o){this.__parent=o}n.prototype.propertyChange=function(o){this.__parent.updateCameraFromHomeBounds(false,false)};return n}());k.TopCameraState$0=m;var l=(function(){function n(o){this.__parent=o}n.prototype.selectionChanged=function(p){var o=(p.getSelectedItems().length==0);this.__parent.updateCameraFromHomeBounds(false,this.__parent.previousSelectionEmpty&&!o);this.__parent.previousSelectionEmpty=o};return n}());k.TopCameraState$1=l;l.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"]})(f=g.TopCameraState||(g.TopCameraState={}));var e=(function(l){__extends(k,l);function k(m){var n=l.call(this)||this;n.__parent=m;if(n.observerCamera===undefined){n.observerCamera=null}n.levelElevationChangeListener=new k.ObserverCameraState$0(n);n.levelsListener=function(o){if(o.getType()===CollectionEvent.Type.ADD){o.getItem().addPropertyChangeListener(n.levelElevationChangeListener)}else{if(o.getType()===CollectionEvent.Type.DELETE){o.getItem().removePropertyChangeListener(n.levelElevationChangeListener)}}n.updateCameraMinimumElevation()};return n}k.prototype.enter=function(){this.observerCamera=this.__parent.home.getCamera();var o=this.__parent.home.getLevels();for(var m=0;m<o.length;m++){var n=o[m];n.addPropertyChangeListener(this.levelElevationChangeListener)}this.__parent.home.addLevelsListener(((function(p){if(p==null||typeof p=="function"){return p}return function(q){return(p.collectionChanged?p.collectionChanged:p).call(p,q)}})(this.levelsListener)));if(this.__parent.preferences.isObserverCameraSelectedAtChange()){this.__parent.home.setSelectedItems([this.observerCamera].slice(0))}};k.prototype.moveCamera=function(m){this.observerCamera.setX(this.observerCamera.getX()-Math.sin(this.observerCamera.getYaw())*m);this.observerCamera.setY(this.observerCamera.getY()+Math.cos(this.observerCamera.getYaw())*m);if(this.__parent.preferences.isObserverCameraSelectedAtChange()){this.__parent.home.setSelectedItems([this.observerCamera].slice(0))}};k.prototype.moveCameraSideways=function(m){this.observerCamera.setX(this.observerCamera.getX()-Math.cos(this.observerCamera.getYaw())*m);this.observerCamera.setY(this.observerCamera.getY()-Math.sin(this.observerCamera.getYaw())*m);if(this.__parent.preferences.isObserverCameraSelectedAtChange()){this.__parent.home.setSelectedItems([this.observerCamera].slice(0))}};k.prototype.elevateCamera=function(n){var m=this.observerCamera.getZ()+n;m=Math.min(Math.max(m,this.getMinimumElevation()),this.__parent.preferences.getLengthUnit().getMaximumElevation());this.observerCamera.setZ(m);if(this.__parent.preferences.isObserverCameraSelectedAtChange()){this.__parent.home.setSelectedItems([this.observerCamera].slice(0))}};k.prototype.updateCameraMinimumElevation=function(){this.observerCamera.setZ(Math.max(this.observerCamera.getZ(),this.getMinimumElevation()))};k.prototype.getMinimumElevation=function(){var m=this.__parent.home.getLevels();if(m.length>0){return 10+m[0].getElevation()}else{return 10}};k.prototype.rotateCameraYaw=function(m){this.observerCamera.setYaw(this.observerCamera.getYaw()+m);if(this.__parent.preferences.isObserverCameraSelectedAtChange()){this.__parent.home.setSelectedItems([this.observerCamera].slice(0))}};k.prototype.rotateCameraPitch=function(n){var m=this.observerCamera.getPitch()+n;m=Math.min(Math.max(-Math.PI/2,m),Math.PI/2);this.observerCamera.setPitch(m);if(this.__parent.preferences.isObserverCameraSelectedAtChange()){this.__parent.home.setSelectedItems([this.observerCamera].slice(0))}};k.prototype.modifyFieldOfView=function(n){var m=this.observerCamera.getFieldOfView()+n;m=Math.min(Math.max((function(o){return o*Math.PI/180})(2),m),(function(o){return o*Math.PI/180})(120));this.observerCamera.setFieldOfView(m);if(this.__parent.preferences.isObserverCameraSelectedAtChange()){this.__parent.home.setSelectedItems([this.observerCamera].slice(0))}};k.prototype.goToCamera=function(m){this.observerCamera.setCamera(m);this.observerCamera.setTime(m.getTime());this.observerCamera.setLens(m.getLens())};k.prototype.exit=function(){var q=this;var p=this.__parent.home.getSelectedItems();if((p.indexOf((this.observerCamera))>=0)){p=(p.slice(0));(function(r){var s=r.indexOf(q.observerCamera);if(s>=0){r.splice(s,1);return true}else{return false}})(p);this.__parent.home.setSelectedItems(p)}var o=this.__parent.home.getLevels();for(var m=0;m<o.length;m++){var n=o[m];n.removePropertyChangeListener(this.levelElevationChangeListener)}this.__parent.home.removeLevelsListener(((function(r){if(r==null||typeof r=="function"){return r}return function(s){return(r.collectionChanged?r.collectionChanged:r).call(r,s)}})(this.levelsListener)));this.observerCamera=null};return k}(g.CameraControllerState));g.ObserverCameraState=e;e.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.ObserverCameraState";(function(k){var l=(function(){function m(n){this.__parent=n}m.prototype.propertyChange=function(n){if("ELEVATION"===n.getPropertyName()){this.__parent.updateCameraMinimumElevation()}};return m}());k.ObserverCameraState$0=l})(e=g.ObserverCameraState||(g.ObserverCameraState={}));var d=(function(){function k(l,m){this.home=m;this.__parent=l}k.prototype.propertyChange=function(l){this.__parent.setCameraState(this.home.getCamera()===this.home.getTopCamera()?this.__parent.topCameraState:this.__parent.observerCameraState)};return k}());g.HomeController3D$0=d;var c=(function(){function k(l,m){this.home=m;this.__parent=l}k.prototype.propertyChange=function(l){if(("ELEVATION"===l.getPropertyName())&&this.home.getEnvironment().isObserverCameraElevationAdjusted()){this.home.getObserverCamera().setZ(Math.max(this.__parent.getObserverCameraMinimumElevation(this.home),this.home.getObserverCamera().getZ()+l.getNewValue()-l.getOldValue()))}};return k}());g.HomeController3D$1=c;var b=(function(){function k(m,n,l){this.home=n;this.levelElevationChangeListener=l;this.__parent=m}k.prototype.propertyChange=function(m){var l=m.getOldValue();var n=this.home.getSelectedLevel();if(this.home.getEnvironment().isObserverCameraElevationAdjusted()){this.home.getObserverCamera().setZ(Math.max(this.__parent.getObserverCameraMinimumElevation(this.home),this.home.getObserverCamera().getZ()+(n==null?0:n.getElevation())-(l==null?0:l.getElevation())))}if(l!=null){l.removePropertyChangeListener(this.levelElevationChangeListener)}if(n!=null){n.addPropertyChangeListener(this.levelElevationChangeListener)}};return k}());g.HomeController3D$2=b;var a=(function(){function k(l,m){this.home=m;this.__parent=l}k.prototype.propertyChange=function(m){var o=this.home.getLevels();var n=this.home.getSelectedLevel();var p=true;for(var l=0;l<o.length;l++){o[l].setVisible(p);if(o[l]===n&&!this.home.getEnvironment().isAllLevelsVisible()){p=false}}};return k}());g.HomeController3D$3=a})(HomeController3D||(HomeController3D={}));var TransferableView;(function(a){var b=(function(){function c(d){if(this.__name===undefined){this.__name=null}this.__name=d}c.PLAN_IMAGE_$LI$=function(){if(c.PLAN_IMAGE==null){c.PLAN_IMAGE=new a.DataType("PLAN_IMAGE")}return c.PLAN_IMAGE};c.FURNITURE_LIST_$LI$=function(){if(c.FURNITURE_LIST==null){c.FURNITURE_LIST=new a.DataType("FURNITURE_LIST")}return c.FURNITURE_LIST};c.prototype.name=function(){return this.__name};c.prototype.toString=function(){return this.__name};return c}());a.DataType=b;b.__class="com.eteks.sweethome3d.viewcontroller.TransferableView.DataType"})(TransferableView||(TransferableView={}));var ModelMaterialsController=(function(){function a(e,c,b,d){if(this.title===undefined){this.title=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.materialsChoiceView===undefined){this.materialsChoiceView=null}if(this.textureController===undefined){this.textureController=null}if(this.model===undefined){this.model=null}if(this.modelCreator===undefined){this.modelCreator=null}if(this.modelWidth===undefined){this.modelWidth=0}if(this.modelDepth===undefined){this.modelDepth=0}if(this.modelHeight===undefined){this.modelHeight=0}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelTransformations===undefined){this.modelTransformations=null}if(this.backFaceShown===undefined){this.backFaceShown=false}if(this.materials===undefined){this.materials=null}this.title=e;this.preferences=c;this.viewFactory=b;this.contentManager=d;this.propertyChangeSupport=new PropertyChangeSupport(this)}a.prototype.getView=function(){if(this.materialsChoiceView==null){this.materialsChoiceView=this.viewFactory.createModelMaterialsView(this.preferences,this)}return this.materialsChoiceView};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.setModel=function(b){if(this.model!==b){var c=this.model;this.model=b;this.propertyChangeSupport.firePropertyChange("MODEL",c,b)}};a.prototype.getModel=function(){return this.model};a.prototype.setModelCreator=function(b){this.modelCreator=b};a.prototype.getModelCreator=function(){return this.modelCreator};a.prototype.setModelRotation=function(b){this.modelRotation=b};a.prototype.getModelRotation=function(){return this.modelRotation};a.prototype.setModelTransformations=function(b){this.modelTransformations=b};a.prototype.getModelTransformations=function(){return this.modelTransformations};a.prototype.setModelSize=function(c,d,b){this.modelWidth=c;this.modelDepth=d;this.modelHeight=b};a.prototype.getModelWidth=function(){return this.modelWidth};a.prototype.getModelDepth=function(){return this.modelDepth};a.prototype.getModelHeight=function(){return this.modelHeight};a.prototype.setBackFaceShown=function(b){this.backFaceShown=b};a.prototype.isBackFaceShown=function(){return this.backFaceShown};a.prototype.setMaterials=function(b){if(!(function(e,d){if(e==null&&d==null){return true}if(e==null||d==null){return false}if(e.length!=d.length){return false}for(var f=0;f<e.length;f++){if(e[f]!=d[f]){return false}}return true})(this.materials,b)){var c=this.materials;this.materials=b;this.propertyChangeSupport.firePropertyChange("MATERIALS",c,b)}};a.prototype.getMaterials=function(){return this.materials};a.prototype.getDialogTitle=function(){return this.title};a.prototype.getTextureController=function(){if(this.textureController==null){this.textureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"textureTitle"),this.preferences,this.viewFactory,this.contentManager)}return this.textureController};return a}());ModelMaterialsController.__class="com.eteks.sweethome3d.viewcontroller.ModelMaterialsController";ModelMaterialsController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];var WizardController=(function(){function a(c,b){if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.stepStatePropertyChangeListener===undefined){this.stepStatePropertyChangeListener=null}if(this.wizardView===undefined){this.wizardView=null}if(this.stepState===undefined){this.stepState=null}if(this.backStepEnabled===undefined){this.backStepEnabled=false}if(this.nextStepEnabled===undefined){this.nextStepEnabled=false}if(this.lastStep===undefined){this.lastStep=false}if(this.stepView===undefined){this.stepView=null}if(this.stepIcon===undefined){this.stepIcon=null}if(this.title===undefined){this.title=null}if(this.resizable===undefined){this.resizable=false}this.preferences=c;this.viewFactory=b;this.stepStatePropertyChangeListener=new a.WizardController$0(this);this.propertyChangeSupport=new PropertyChangeSupport(this)}a.prototype.getView=function(){if(this.wizardView==null){this.wizardView=this.viewFactory.createWizardView(this.preferences,this)}return this.wizardView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.setBackStepEnabled=function(b){if(b!==this.backStepEnabled){this.backStepEnabled=b;this.propertyChangeSupport.firePropertyChange("BACK_STEP_ENABLED",!b,b)}};a.prototype.isBackStepEnabled=function(){return this.backStepEnabled};a.prototype.setNextStepEnabled=function(b){if(b!==this.nextStepEnabled){this.nextStepEnabled=b;this.propertyChangeSupport.firePropertyChange("NEXT_STEP_ENABLED",!b,b)}};a.prototype.isNextStepEnabled=function(){return this.nextStepEnabled};a.prototype.setLastStep=function(b){if(b!==this.lastStep){this.lastStep=b;this.propertyChangeSupport.firePropertyChange("LAST_STEP",!b,b)}};a.prototype.isLastStep=function(){return this.lastStep};a.prototype.setStepView=function(c){if(c!==this.stepView){var b=this.stepView;this.stepView=c;this.propertyChangeSupport.firePropertyChange("STEP_VIEW",b,c)}};a.prototype.getStepView=function(){return this.stepView};a.prototype.setStepIcon=function(b){if(b!==this.stepIcon){var c=this.stepIcon;this.stepIcon=b;this.propertyChangeSupport.firePropertyChange("STEP_ICON",c,b)}};a.prototype.getStepIcon=function(){return this.stepIcon};a.prototype.setTitle=function(c){if(c!==this.title){var b=this.title;this.title=c;this.propertyChangeSupport.firePropertyChange("TITLE",b,c)}};a.prototype.getTitle=function(){return this.title};a.prototype.setResizable=function(b){if(b!==this.resizable){this.resizable=b;this.propertyChangeSupport.firePropertyChange("RESIZABLE",!b,b)}};a.prototype.isResizable=function(){return this.resizable};a.prototype.setStepState=function(b){if(this.stepState!=null){this.stepState.exit();this.stepState.removePropertyChangeListener(this.stepStatePropertyChangeListener)}this.stepState=b;this.setBackStepEnabled(!b.isFirstStep());this.setNextStepEnabled(b.isNextStepEnabled());this.setStepView(b.getView());this.setStepIcon(b.getIcon());this.setLastStep(b.isLastStep());this.stepState.addPropertyChangeListener(this.stepStatePropertyChangeListener);this.stepState.enter()};a.prototype.getStepState=function(){return this.stepState};a.prototype.goToNextStep=function(){this.stepState.goToNextStep()};a.prototype.goBackToPreviousStep=function(){this.stepState.goBackToPreviousStep()};return a}());WizardController.__class="com.eteks.sweethome3d.viewcontroller.WizardController";WizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(c){var a=(function(){function d(){if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.firstStep===undefined){this.firstStep=false}if(this.lastStep===undefined){this.lastStep=false}if(this.nextStepEnabled===undefined){this.nextStepEnabled=false}this.propertyChangeSupport=new PropertyChangeSupport(this)}d.prototype.addPropertyChangeListener=function(e){this.propertyChangeSupport.addPropertyChangeListener(e)};d.prototype.removePropertyChangeListener=function(e){this.propertyChangeSupport.removePropertyChangeListener(e)};d.prototype.enter=function(){};d.prototype.exit=function(){};d.prototype.getIcon=function(){return null};d.prototype.goBackToPreviousStep=function(){};d.prototype.goToNextStep=function(){};d.prototype.isFirstStep=function(){return this.firstStep};d.prototype.setFirstStep=function(e){if(e!==this.firstStep){this.firstStep=e;this.propertyChangeSupport.firePropertyChange("FIRST_STEP",!e,e)}};d.prototype.isLastStep=function(){return this.lastStep};d.prototype.setLastStep=function(e){if(e!==this.lastStep){this.lastStep=e;this.propertyChangeSupport.firePropertyChange("LAST_STEP",!e,e)}};d.prototype.isNextStepEnabled=function(){return this.nextStepEnabled};d.prototype.setNextStepEnabled=function(e){if(e!==this.nextStepEnabled){this.nextStepEnabled=e;this.propertyChangeSupport.firePropertyChange("NEXT_STEP_ENABLED",!e,e)}};return d}());c.WizardControllerStepState=a;a.__class="com.eteks.sweethome3d.viewcontroller.WizardController.WizardControllerStepState";var b=(function(){function d(e){this.__parent=e}d.prototype.propertyChange=function(e){switch((e.getPropertyName())){case"FIRST_STEP":this.__parent.setBackStepEnabled(!this.__parent.stepState.isFirstStep());break;case"LAST_STEP":this.__parent.setLastStep(this.__parent.stepState.isLastStep());break;case"NEXT_STEP_ENABLED":this.__parent.setNextStepEnabled(this.__parent.stepState.isNextStepEnabled());break}};return d}());c.WizardController$0=b})(WizardController||(WizardController={}));var BaseboardChoiceController=(function(){function a(c,b,d){if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.textureController===undefined){this.textureController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.view===undefined){this.view=null}if(this.visible===undefined){this.visible=null}if(this.thickness===undefined){this.thickness=null}if(this.height===undefined){this.height=null}if(this.maxHeight===undefined){this.maxHeight=null}if(this.color===undefined){this.color=null}if(this.paint===undefined){this.paint=null}this.preferences=c;this.viewFactory=b;this.contentManager=d;this.propertyChangeSupport=new PropertyChangeSupport(this)}a.prototype.getTextureController=function(){if(this.textureController==null){this.textureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"baseboardTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.textureController.addPropertyChangeListener("TEXTURE",new a.BaseboardChoiceController$0(this))}return this.textureController};a.prototype.getView=function(){if(this.view==null){this.view=this.viewFactory.createBaseboardChoiceView(this.preferences,this)}return this.view};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.getVisible=function(){return this.visible};a.prototype.setVisible=function(b){if(b!==this.visible){var c=this.visible;this.visible=b;this.propertyChangeSupport.firePropertyChange("VISIBLE",c,b)}};a.prototype.setThickness=function(c){if(c!==this.thickness){var b=this.thickness;this.thickness=c;this.propertyChangeSupport.firePropertyChange("THICKNESS",b,c)}};a.prototype.getThickness=function(){return this.thickness};a.prototype.setHeight=function(b){if(b!==this.height){var c=this.height;this.height=b;this.propertyChangeSupport.firePropertyChange("HEIGHT",c,b)}};a.prototype.getHeight=function(){return this.height};a.prototype.setMaxHeight=function(c){if(this.maxHeight==null||c!==this.maxHeight){var b=this.maxHeight;this.maxHeight=c;this.propertyChangeSupport.firePropertyChange("MAX_HEIGHT",b,c)}};a.prototype.getMaxHeight=function(){return this.maxHeight};a.prototype.setColor=function(c){if(c!==this.color){var b=this.color;this.color=c;this.propertyChangeSupport.firePropertyChange("COLOR",b,c);this.setPaint(a.BaseboardPaint.COLORED)}};a.prototype.getColor=function(){return this.color};a.prototype.setPaint=function(c){if(c!==this.paint){var b=this.paint;this.paint=c;this.propertyChangeSupport.firePropertyChange("PAINT",b,c)}};a.prototype.getPaint=function(){return this.paint};a.prototype.setBaseboard=function(b){if(b==null){this.setVisible(false);this.setThickness(null);this.setHeight(null);this.setColor(null);this.getTextureController().setTexture(null);this.setPaint(null)}else{this.setVisible(true);this.setThickness(b.getThickness());this.setHeight(b.getHeight());if(b.getTexture()!=null){this.setColor(null);this.getTextureController().setTexture(b.getTexture());this.setPaint(a.BaseboardPaint.TEXTURED)}else{if(b.getColor()!=null){this.getTextureController().setTexture(null);this.setColor(b.getColor())}else{this.setColor(null);this.getTextureController().setTexture(null);this.setPaint(a.BaseboardPaint.DEFAULT)}}}};return a}());BaseboardChoiceController.__class="com.eteks.sweethome3d.viewcontroller.BaseboardChoiceController";BaseboardChoiceController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(a){var c;(function(d){d[d.DEFAULT=0]="DEFAULT";d[d.COLORED=1]="COLORED";d[d.TEXTURED=2]="TEXTURED"})(c=a.BaseboardPaint||(a.BaseboardPaint={}));var b=(function(){function d(e){this.__parent=e}d.prototype.propertyChange=function(e){this.__parent.setPaint(a.BaseboardPaint.TEXTURED)};return d}());a.BaseboardChoiceController$0=b})(BaseboardChoiceController||(BaseboardChoiceController={}));var HomeView;(function(a){var d;(function(e){e[e.NEW_HOME=0]="NEW_HOME";e[e.NEW_HOME_FROM_EXAMPLE=1]="NEW_HOME_FROM_EXAMPLE";e[e.CLOSE=2]="CLOSE";e[e.OPEN=3]="OPEN";e[e.DELETE_RECENT_HOMES=4]="DELETE_RECENT_HOMES";e[e.SAVE=5]="SAVE";e[e.SAVE_AS=6]="SAVE_AS";e[e.SAVE_AND_COMPRESS=7]="SAVE_AND_COMPRESS";e[e.PAGE_SETUP=8]="PAGE_SETUP";e[e.PRINT_PREVIEW=9]="PRINT_PREVIEW";e[e.PRINT=10]="PRINT";e[e.PRINT_TO_PDF=11]="PRINT_TO_PDF";e[e.PREFERENCES=12]="PREFERENCES";e[e.EXIT=13]="EXIT";e[e.UNDO=14]="UNDO";e[e.REDO=15]="REDO";e[e.CUT=16]="CUT";e[e.COPY=17]="COPY";e[e.PASTE=18]="PASTE";e[e.PASTE_TO_GROUP=19]="PASTE_TO_GROUP";e[e.PASTE_STYLE=20]="PASTE_STYLE";e[e.DELETE=21]="DELETE";e[e.SELECT_ALL=22]="SELECT_ALL";e[e.SELECT_ALL_AT_ALL_LEVELS=23]="SELECT_ALL_AT_ALL_LEVELS";e[e.ADD_HOME_FURNITURE=24]="ADD_HOME_FURNITURE";e[e.ADD_FURNITURE_TO_GROUP=25]="ADD_FURNITURE_TO_GROUP";e[e.DELETE_HOME_FURNITURE=26]="DELETE_HOME_FURNITURE";e[e.MODIFY_FURNITURE=27]="MODIFY_FURNITURE";e[e.IMPORT_FURNITURE=28]="IMPORT_FURNITURE";e[e.IMPORT_FURNITURE_LIBRARY=29]="IMPORT_FURNITURE_LIBRARY";e[e.IMPORT_TEXTURE=30]="IMPORT_TEXTURE";e[e.IMPORT_TEXTURES_LIBRARY=31]="IMPORT_TEXTURES_LIBRARY";e[e.SORT_HOME_FURNITURE_BY_CATALOG_ID=32]="SORT_HOME_FURNITURE_BY_CATALOG_ID";e[e.SORT_HOME_FURNITURE_BY_NAME=33]="SORT_HOME_FURNITURE_BY_NAME";e[e.SORT_HOME_FURNITURE_BY_CREATOR=34]="SORT_HOME_FURNITURE_BY_CREATOR";e[e.SORT_HOME_FURNITURE_BY_WIDTH=35]="SORT_HOME_FURNITURE_BY_WIDTH";e[e.SORT_HOME_FURNITURE_BY_DEPTH=36]="SORT_HOME_FURNITURE_BY_DEPTH";e[e.SORT_HOME_FURNITURE_BY_HEIGHT=37]="SORT_HOME_FURNITURE_BY_HEIGHT";e[e.SORT_HOME_FURNITURE_BY_X=38]="SORT_HOME_FURNITURE_BY_X";e[e.SORT_HOME_FURNITURE_BY_Y=39]="SORT_HOME_FURNITURE_BY_Y";e[e.SORT_HOME_FURNITURE_BY_ELEVATION=40]="SORT_HOME_FURNITURE_BY_ELEVATION";e[e.SORT_HOME_FURNITURE_BY_ANGLE=41]="SORT_HOME_FURNITURE_BY_ANGLE";e[e.SORT_HOME_FURNITURE_BY_LEVEL=42]="SORT_HOME_FURNITURE_BY_LEVEL";e[e.SORT_HOME_FURNITURE_BY_MODEL_SIZE=43]="SORT_HOME_FURNITURE_BY_MODEL_SIZE";e[e.SORT_HOME_FURNITURE_BY_COLOR=44]="SORT_HOME_FURNITURE_BY_COLOR";e[e.SORT_HOME_FURNITURE_BY_TEXTURE=45]="SORT_HOME_FURNITURE_BY_TEXTURE";e[e.SORT_HOME_FURNITURE_BY_MOVABILITY=46]="SORT_HOME_FURNITURE_BY_MOVABILITY";e[e.SORT_HOME_FURNITURE_BY_TYPE=47]="SORT_HOME_FURNITURE_BY_TYPE";e[e.SORT_HOME_FURNITURE_BY_VISIBILITY=48]="SORT_HOME_FURNITURE_BY_VISIBILITY";e[e.SORT_HOME_FURNITURE_BY_PRICE=49]="SORT_HOME_FURNITURE_BY_PRICE";e[e.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE=50]="SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE";e[e.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX=51]="SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX";e[e.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED=52]="SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED";e[e.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER=53]="SORT_HOME_FURNITURE_BY_DESCENDING_ORDER";e[e.DISPLAY_HOME_FURNITURE_CATALOG_ID=54]="DISPLAY_HOME_FURNITURE_CATALOG_ID";e[e.DISPLAY_HOME_FURNITURE_NAME=55]="DISPLAY_HOME_FURNITURE_NAME";e[e.DISPLAY_HOME_FURNITURE_CREATOR=56]="DISPLAY_HOME_FURNITURE_CREATOR";e[e.DISPLAY_HOME_FURNITURE_WIDTH=57]="DISPLAY_HOME_FURNITURE_WIDTH";e[e.DISPLAY_HOME_FURNITURE_DEPTH=58]="DISPLAY_HOME_FURNITURE_DEPTH";e[e.DISPLAY_HOME_FURNITURE_HEIGHT=59]="DISPLAY_HOME_FURNITURE_HEIGHT";e[e.DISPLAY_HOME_FURNITURE_X=60]="DISPLAY_HOME_FURNITURE_X";e[e.DISPLAY_HOME_FURNITURE_Y=61]="DISPLAY_HOME_FURNITURE_Y";e[e.DISPLAY_HOME_FURNITURE_ELEVATION=62]="DISPLAY_HOME_FURNITURE_ELEVATION";e[e.DISPLAY_HOME_FURNITURE_ANGLE=63]="DISPLAY_HOME_FURNITURE_ANGLE";e[e.DISPLAY_HOME_FURNITURE_LEVEL=64]="DISPLAY_HOME_FURNITURE_LEVEL";e[e.DISPLAY_HOME_FURNITURE_MODEL_SIZE=65]="DISPLAY_HOME_FURNITURE_MODEL_SIZE";e[e.DISPLAY_HOME_FURNITURE_COLOR=66]="DISPLAY_HOME_FURNITURE_COLOR";e[e.DISPLAY_HOME_FURNITURE_TEXTURE=67]="DISPLAY_HOME_FURNITURE_TEXTURE";e[e.DISPLAY_HOME_FURNITURE_MOVABLE=68]="DISPLAY_HOME_FURNITURE_MOVABLE";e[e.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW=69]="DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW";e[e.DISPLAY_HOME_FURNITURE_VISIBLE=70]="DISPLAY_HOME_FURNITURE_VISIBLE";e[e.DISPLAY_HOME_FURNITURE_PRICE=71]="DISPLAY_HOME_FURNITURE_PRICE";e[e.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE=72]="DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE";e[e.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX=73]="DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX";e[e.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED=74]="DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED";e[e.ALIGN_FURNITURE_ON_TOP=75]="ALIGN_FURNITURE_ON_TOP";e[e.ALIGN_FURNITURE_ON_BOTTOM=76]="ALIGN_FURNITURE_ON_BOTTOM";e[e.ALIGN_FURNITURE_ON_LEFT=77]="ALIGN_FURNITURE_ON_LEFT";e[e.ALIGN_FURNITURE_ON_RIGHT=78]="ALIGN_FURNITURE_ON_RIGHT";e[e.ALIGN_FURNITURE_ON_FRONT_SIDE=79]="ALIGN_FURNITURE_ON_FRONT_SIDE";e[e.ALIGN_FURNITURE_ON_BACK_SIDE=80]="ALIGN_FURNITURE_ON_BACK_SIDE";e[e.ALIGN_FURNITURE_ON_LEFT_SIDE=81]="ALIGN_FURNITURE_ON_LEFT_SIDE";e[e.ALIGN_FURNITURE_ON_RIGHT_SIDE=82]="ALIGN_FURNITURE_ON_RIGHT_SIDE";e[e.ALIGN_FURNITURE_SIDE_BY_SIDE=83]="ALIGN_FURNITURE_SIDE_BY_SIDE";e[e.DISTRIBUTE_FURNITURE_HORIZONTALLY=84]="DISTRIBUTE_FURNITURE_HORIZONTALLY";e[e.DISTRIBUTE_FURNITURE_VERTICALLY=85]="DISTRIBUTE_FURNITURE_VERTICALLY";e[e.RESET_FURNITURE_ELEVATION=86]="RESET_FURNITURE_ELEVATION";e[e.GROUP_FURNITURE=87]="GROUP_FURNITURE";e[e.UNGROUP_FURNITURE=88]="UNGROUP_FURNITURE";e[e.EXPORT_TO_CSV=89]="EXPORT_TO_CSV";e[e.SELECT=90]="SELECT";e[e.PAN=91]="PAN";e[e.CREATE_WALLS=92]="CREATE_WALLS";e[e.CREATE_ROOMS=93]="CREATE_ROOMS";e[e.CREATE_DIMENSION_LINES=94]="CREATE_DIMENSION_LINES";e[e.CREATE_POLYLINES=95]="CREATE_POLYLINES";e[e.CREATE_LABELS=96]="CREATE_LABELS";e[e.DELETE_SELECTION=97]="DELETE_SELECTION";e[e.LOCK_BASE_PLAN=98]="LOCK_BASE_PLAN";e[e.UNLOCK_BASE_PLAN=99]="UNLOCK_BASE_PLAN";e[e.ENABLE_MAGNETISM=100]="ENABLE_MAGNETISM";e[e.DISABLE_MAGNETISM=101]="DISABLE_MAGNETISM";e[e.FLIP_HORIZONTALLY=102]="FLIP_HORIZONTALLY";e[e.FLIP_VERTICALLY=103]="FLIP_VERTICALLY";e[e.MODIFY_COMPASS=104]="MODIFY_COMPASS";e[e.MODIFY_WALL=105]="MODIFY_WALL";e[e.JOIN_WALLS=106]="JOIN_WALLS";e[e.REVERSE_WALL_DIRECTION=107]="REVERSE_WALL_DIRECTION";e[e.SPLIT_WALL=108]="SPLIT_WALL";e[e.MODIFY_ROOM=109]="MODIFY_ROOM";e[e.ADD_ROOM_POINT=110]="ADD_ROOM_POINT";e[e.DELETE_ROOM_POINT=111]="DELETE_ROOM_POINT";e[e.MODIFY_POLYLINE=112]="MODIFY_POLYLINE";e[e.MODIFY_LABEL=113]="MODIFY_LABEL";e[e.INCREASE_TEXT_SIZE=114]="INCREASE_TEXT_SIZE";e[e.DECREASE_TEXT_SIZE=115]="DECREASE_TEXT_SIZE";e[e.TOGGLE_BOLD_STYLE=116]="TOGGLE_BOLD_STYLE";e[e.TOGGLE_ITALIC_STYLE=117]="TOGGLE_ITALIC_STYLE";e[e.IMPORT_BACKGROUND_IMAGE=118]="IMPORT_BACKGROUND_IMAGE";e[e.MODIFY_BACKGROUND_IMAGE=119]="MODIFY_BACKGROUND_IMAGE";e[e.HIDE_BACKGROUND_IMAGE=120]="HIDE_BACKGROUND_IMAGE";e[e.SHOW_BACKGROUND_IMAGE=121]="SHOW_BACKGROUND_IMAGE";e[e.DELETE_BACKGROUND_IMAGE=122]="DELETE_BACKGROUND_IMAGE";e[e.ADD_LEVEL=123]="ADD_LEVEL";e[e.ADD_LEVEL_AT_SAME_ELEVATION=124]="ADD_LEVEL_AT_SAME_ELEVATION";e[e.MAKE_LEVEL_VIEWABLE=125]="MAKE_LEVEL_VIEWABLE";e[e.MAKE_LEVEL_UNVIEWABLE=126]="MAKE_LEVEL_UNVIEWABLE";e[e.MAKE_LEVEL_ONLY_VIEWABLE_ONE=127]="MAKE_LEVEL_ONLY_VIEWABLE_ONE";e[e.MAKE_ALL_LEVELS_VIEWABLE=128]="MAKE_ALL_LEVELS_VIEWABLE";e[e.MODIFY_LEVEL=129]="MODIFY_LEVEL";e[e.DELETE_LEVEL=130]="DELETE_LEVEL";e[e.ZOOM_OUT=131]="ZOOM_OUT";e[e.ZOOM_IN=132]="ZOOM_IN";e[e.EXPORT_TO_SVG=133]="EXPORT_TO_SVG";e[e.SELECT_OBJECT=134]="SELECT_OBJECT";e[e.TOGGLE_SELECTION=135]="TOGGLE_SELECTION";e[e.VIEW_FROM_TOP=136]="VIEW_FROM_TOP";e[e.VIEW_FROM_OBSERVER=137]="VIEW_FROM_OBSERVER";e[e.MODIFY_OBSERVER=138]="MODIFY_OBSERVER";e[e.STORE_POINT_OF_VIEW=139]="STORE_POINT_OF_VIEW";e[e.DELETE_POINTS_OF_VIEW=140]="DELETE_POINTS_OF_VIEW";e[e.CREATE_PHOTOS_AT_POINTS_OF_VIEW=141]="CREATE_PHOTOS_AT_POINTS_OF_VIEW";e[e.DETACH_3D_VIEW=142]="DETACH_3D_VIEW";e[e.ATTACH_3D_VIEW=143]="ATTACH_3D_VIEW";e[e.DISPLAY_ALL_LEVELS=144]="DISPLAY_ALL_LEVELS";e[e.DISPLAY_SELECTED_LEVEL=145]="DISPLAY_SELECTED_LEVEL";e[e.MODIFY_3D_ATTRIBUTES=146]="MODIFY_3D_ATTRIBUTES";e[e.CREATE_PHOTO=147]="CREATE_PHOTO";e[e.CREATE_VIDEO=148]="CREATE_VIDEO";e[e.EXPORT_TO_OBJ=149]="EXPORT_TO_OBJ";e[e.HELP=150]="HELP";e[e.ABOUT=151]="ABOUT"})(d=a.ActionType||(a.ActionType={}));var c;(function(e){e[e.SAVE=0]="SAVE";e[e.CANCEL=1]="CANCEL";e[e.DO_NOT_SAVE=2]="DO_NOT_SAVE"})(c=a.SaveAnswer||(a.SaveAnswer={}));var b;(function(e){e[e.REMOVE_DAMAGED_ITEMS=0]="REMOVE_DAMAGED_ITEMS";e[e.REPLACE_DAMAGED_ITEMS=1]="REPLACE_DAMAGED_ITEMS";e[e.DO_NOT_OPEN_HOME=2]="DO_NOT_OPEN_HOME"})(b=a.OpenDamagedHomeAnswer||(a.OpenDamagedHomeAnswer={}))})(HomeView||(HomeView={}));var FurnitureCatalogController=(function(){function a(d,c,h,j){if(((d!=null&&d instanceof FurnitureCatalog)||d===null)&&((c!=null&&c instanceof UserPreferences)||c===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||h===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||j===null)){var e=arguments;if(this.catalog===undefined){this.catalog=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.selectedFurniture===undefined){this.selectedFurniture=null}if(this.catalogView===undefined){this.catalogView=null}this.catalog=d;this.preferences=c;this.viewFactory=h;this.contentManager=j;this.selectionListeners=([]);this.selectedFurniture=[];this.catalog.addFurnitureListener((function(l){if(l==null||typeof l=="function"){return l}return function(m){return(l.collectionChanged?l.collectionChanged:l).call(l,m)}})(new a.FurnitureCatalogChangeListener(this)));if(c!=null){c.addPropertyChangeListener("FURNITURE_CATALOG_VIEWED_IN_TREE",new a.FurnitureCatalogViewChangeListener(this))}}else{if(((d!=null&&d instanceof FurnitureCatalog)||d===null)&&((c!=null&&(c.constructor!=null&&c.constructor.__interfaces!=null&&c.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||c===null)&&h===undefined&&j===undefined){var e=arguments;var g=e[1];var b=arguments;var f=null;var k=null;if(this.catalog===undefined){this.catalog=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.selectedFurniture===undefined){this.selectedFurniture=null}if(this.catalogView===undefined){this.catalogView=null}this.catalog=d;this.preferences=f;this.viewFactory=g;this.contentManager=k;this.selectionListeners=([]);this.selectedFurniture=[];this.catalog.addFurnitureListener((function(l){if(l==null||typeof l=="function"){return l}return function(m){return(l.collectionChanged?l.collectionChanged:l).call(l,m)}})(new a.FurnitureCatalogChangeListener(this)));if(f!=null){f.addPropertyChangeListener("FURNITURE_CATALOG_VIEWED_IN_TREE",new a.FurnitureCatalogViewChangeListener(this))}if(this.catalog===undefined){this.catalog=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.selectedFurniture===undefined){this.selectedFurniture=null}if(this.catalogView===undefined){this.catalogView=null}}else{throw new Error("invalid overload")}}}a.prototype.getView=function(){if(this.catalogView==null){this.catalogView=this.viewFactory.createFurnitureCatalogView(this.catalog,this.preferences,this)}return this.catalogView};a.prototype.addSelectionListener=function(b){(this.selectionListeners.push(b)>0)};a.prototype.removeSelectionListener=function(b){(function(c){var d=c.indexOf(b);if(d>=0){c.splice(d,1);return true}else{return false}})(this.selectionListeners)};a.prototype.getSelectedFurniture=function(){return this.selectedFurniture.slice(0)};a.prototype.setSelectedFurniture=function(c){this.selectedFurniture=(c.slice(0));if(!(this.selectionListeners.length==0)){var b=new SelectionEvent(this,this.getSelectedFurniture());var e=this.selectionListeners.slice(0);for(var d=0;d<e.length;d++){var f=e[d];f.selectionChanged(b)}}};a.prototype.deselectPieceOfFurniture=function(c){var b=this.selectedFurniture.indexOf(c);if(b!==-1){var d=(this.getSelectedFurniture().slice(0));d.splice(b,1)[0];this.setSelectedFurniture(d)}};a.prototype.modifySelectedFurniture=function(){if(this.preferences!=null){if(this.selectedFurniture.length>0){var b=this.selectedFurniture[0];if(b.isModifiable()){var c=new a.AddedFurnitureSelector(this);this.preferences.getFurnitureCatalog().addFurnitureListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(c)));new ImportedFurnitureWizardController(b,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView());c.selectAddedFurniture();this.preferences.getFurnitureCatalog().removeFurnitureListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(c)))}}}};a.prototype.importFurniture$=function(){if(this.preferences!=null){var b=new a.AddedFurnitureSelector(this);this.preferences.getFurnitureCatalog().addFurnitureListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)));new ImportedFurnitureWizardController(this.preferences,this.viewFactory,this.contentManager).displayView(this.getView());b.selectAddedFurniture();this.preferences.getFurnitureCatalog().removeFurnitureListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))}};a.prototype.importFurniture$java_lang_String=function(b){if(this.preferences!=null){new ImportedFurnitureWizardController(b,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())}};a.prototype.importFurniture=function(b){if(((typeof b==="string")||b===null)){return this.importFurniture$java_lang_String(b)}else{if(b===undefined){return this.importFurniture$()}else{throw new Error("invalid overload")}}};a.prototype.deleteSelection=function(){for(var b=0;b<this.selectedFurniture.length;b++){var c=this.selectedFurniture[b];if(c.isModifiable()){this.catalog["delete"](c)}}};a.prototype.dropFiles=function(b){var e=new a.AddedFurnitureSelector(this);this.preferences.getFurnitureCatalog().addFurnitureListener(((function(f){if(f==null||typeof f=="function"){return f}return function(g){return(f.collectionChanged?f.collectionChanged:f).call(f,g)}})(e)));for(var d=0;d<b.length;d++){var c=b[d];this.importFurniture$java_lang_String(c)}e.selectAddedFurniture();this.preferences.getFurnitureCatalog().removeFurnitureListener(((function(f){if(f==null||typeof f=="function"){return f}return function(g){return(f.collectionChanged?f.collectionChanged:f).call(f,g)}})(e)))};return a}());FurnitureCatalogController.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController";FurnitureCatalogController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(d){var b=(function(){function e(f){if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}this.furnitureCatalogController=(f)}e.prototype.collectionChanged=function(g){var f=this.furnitureCatalogController;if(f==null){g.getSource().removeFurnitureListener(((function(h){if(h==null||typeof h=="function"){return h}return function(j){return(h.collectionChanged?h.collectionChanged:h).call(h,j)}})(this)))}else{if(g.getType()===CollectionEvent.Type.DELETE){f.deselectPieceOfFurniture(g.getItem())}}};return e}());d.FurnitureCatalogChangeListener=b;b.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController.FurnitureCatalogChangeListener";b.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"];var a=(function(){function e(f){if(this.controller===undefined){this.controller=null}this.controller=(f)}e.prototype.propertyChange=function(g){var f=this.controller;if(f==null){(g.getSource()).removePropertyChangeListener("FURNITURE_CATALOG_VIEWED_IN_TREE",this)}else{f.catalogView=null}};return e}());d.FurnitureCatalogViewChangeListener=a;a.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController.FurnitureCatalogViewChangeListener";var c=(function(){function e(f){this.__parent=f;this.addedFurniture=([])}e.prototype.collectionChanged=function(f){if(f.getType()===CollectionEvent.Type.ADD){(this.addedFurniture.push(f.getItem())>0)}};e.prototype.selectAddedFurniture=function(){if(this.addedFurniture.length>0){this.__parent.setSelectedFurniture(this.addedFurniture)}};return e}());d.AddedFurnitureSelector=c;c.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController.AddedFurnitureSelector";c.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"]})(FurnitureCatalogController||(FurnitureCatalogController={}));var ObserverCameraController=(function(){function a(d,c,b){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.observerCameraView===undefined){this.observerCameraView=null}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.elevation===undefined){this.elevation=0}if(this.minimumElevation===undefined){this.minimumElevation=0}if(this.yawInDegrees===undefined){this.yawInDegrees=0}if(this.yaw===undefined){this.yaw=0}if(this.pitchInDegrees===undefined){this.pitchInDegrees=0}if(this.pitch===undefined){this.pitch=0}if(this.fieldOfViewInDegrees===undefined){this.fieldOfViewInDegrees=0}if(this.fieldOfView===undefined){this.fieldOfView=0}if(this.elevationAdjusted===undefined){this.elevationAdjusted=false}this.home=d;this.preferences=c;this.viewFactory=b;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getView=function(){if(this.observerCameraView==null){this.observerCameraView=this.viewFactory.createObserverCameraView(this.preferences,this)}return this.observerCameraView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var c=this.home.getObserverCamera();this.setX(c.getX());this.setY(c.getY());var d=this.home.getLevels();this.setMinimumElevation(d.length===0?10:10+d[0].getElevation());this.setElevation(c.getZ());this.setYaw(c.getYaw());this.setPitch(c.getPitch());this.setFieldOfView(c.getFieldOfView());var b=this.home.getEnvironment();this.setElevationAdjusted(b.isObserverCameraElevationAdjusted())};a.prototype.setX=function(b){if(b!==this.x){var c=this.x;this.x=b;this.propertyChangeSupport.firePropertyChange("X",c,b)}};a.prototype.getX=function(){return this.x};a.prototype.setY=function(c){if(c!==this.y){var b=this.y;this.y=c;this.propertyChangeSupport.firePropertyChange("Y",b,c)}};a.prototype.getY=function(){return this.y};a.prototype.setElevation=function(b){if(b!==this.elevation){var c=this.elevation;this.elevation=b;this.propertyChangeSupport.firePropertyChange("ELEVATION",c,b)}};a.prototype.getElevation=function(){return this.elevation};a.prototype.setMinimumElevation=function(c){if(c!==this.minimumElevation){var b=this.minimumElevation;this.minimumElevation=c;this.propertyChangeSupport.firePropertyChange("MINIMUM_ELEVATION",b,c)}};a.prototype.getMinimumElevation=function(){return this.minimumElevation};a.prototype.isElevationAdjusted=function(){return this.elevationAdjusted};a.prototype.setElevationAdjusted=function(c){if(this.elevationAdjusted!==c){this.elevationAdjusted=c;this.propertyChangeSupport.firePropertyChange("OBSERVER_CAMERA_ELEVATION_ADJUSTED",!c,c);var b=this.home.getSelectedLevel();if(b!=null){if(c){this.setElevation(this.getElevation()-b.getElevation())}else{this.setElevation(this.getElevation()+b.getElevation())}}}};a.prototype.isObserverCameraElevationAdjustedEditable=function(){return this.home.getLevels().length>1};a.prototype.setYawInDegrees=function(d,c){if(c===void 0){c=true}if(d!==this.yawInDegrees){var b=this.yawInDegrees;this.yawInDegrees=d;this.propertyChangeSupport.firePropertyChange("YAW_IN_DEGREES",b,d);if(c){this.setYaw((function(e){return e*Math.PI/180})(d),false)}}};a.prototype.getYawInDegrees=function(){return this.yawInDegrees};a.prototype.setYaw=function(d,c){if(c===void 0){c=true}if(d!==this.yaw){var b=this.yaw;this.yaw=d;this.propertyChangeSupport.firePropertyChange("YAW",b,d);if(c){this.setYawInDegrees((Math.round((function(e){return e*180/Math.PI})(d))|0),false)}}};a.prototype.getYaw=function(){return this.yaw};a.prototype.setPitchInDegrees=function(d,b){if(b===void 0){b=true}if(d!==this.pitchInDegrees){var c=this.pitchInDegrees;this.pitchInDegrees=d;this.propertyChangeSupport.firePropertyChange("PITCH_IN_DEGREES",c,d);if(b){this.setPitch((function(e){return e*Math.PI/180})(d),false)}}};a.prototype.getPitchInDegrees=function(){return this.pitchInDegrees};a.prototype.setPitch=function(d,c){if(c===void 0){c=true}if(d!==this.pitch){var b=this.pitch;this.pitch=d;this.propertyChangeSupport.firePropertyChange("PITCH",b,d);if(c){this.setPitchInDegrees(((Math.round((function(e){return e*180/Math.PI})(d)))|0),false)}}};a.prototype.getPitch=function(){return this.pitch};a.prototype.setFieldOfViewInDegrees=function(c,d){if(d===void 0){d=true}if(c!==this.fieldOfViewInDegrees){var b=this.fieldOfViewInDegrees;this.fieldOfViewInDegrees=c;this.propertyChangeSupport.firePropertyChange("FIELD_OF_VIEW_IN_DEGREES",b,c);if(d){this.setFieldOfView((function(e){return e*Math.PI/180})(c),false)}}};a.prototype.getFieldOfViewInDegrees=function(){return this.fieldOfViewInDegrees};a.prototype.setFieldOfView=function(c,b){if(b===void 0){b=true}if(c!==this.fieldOfView){var d=this.fieldOfView;this.fieldOfView=c;this.propertyChangeSupport.firePropertyChange("FIELD_OF_VIEW",d,c);if(b){this.setFieldOfViewInDegrees(((Math.round((function(e){return e*180/Math.PI})(c)))|0),false)}}};a.prototype.getFieldOfView=function(){return this.fieldOfView};a.prototype.modifyObserverCamera=function(){var k=this.getX();var j=this.getY();var h=this.getElevation();var b=this.isElevationAdjusted();var l=this.home.getSelectedLevel();if(b&&l!=null){h+=l.getElevation();var m=this.home.getLevels();h=Math.max(h,m.length===0?10:10+m[0].getElevation())}var e=this.getYaw();var c=this.getPitch();var f=this.getFieldOfView();var d=this.home.getObserverCamera();d.setX(k);d.setY(j);d.setZ(h);d.setYaw(e);d.setPitch(c);d.setFieldOfView(f);var g=this.home.getEnvironment();g.setObserverCameraElevationAdjusted(b)};return a}());ObserverCameraController.__class="com.eteks.sweethome3d.viewcontroller.ObserverCameraController";ObserverCameraController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];var View;(function(b){var a;(function(c){c[c.MOUSE=0]="MOUSE";c[c.TOUCH=1]="TOUCH"})(a=b.PointerType||(b.PointerType={}))})(View||(View={}));var UserPreferencesController=(function(){function a(d,b,g,e){if(((d!=null&&d instanceof UserPreferences)||d===null)&&((b!=null&&(b.constructor!=null&&b.constructor.__interfaces!=null&&b.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||b===null)&&((g!=null&&(g.constructor!=null&&g.constructor.__interfaces!=null&&g.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||g===null)&&((e!=null&&e instanceof HomeController)||e===null)){var f=arguments;if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.homeController===undefined){this.homeController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.userPreferencesView===undefined){this.userPreferencesView=null}if(this.language===undefined){this.language=null}if(this.unit===undefined){this.unit=null}if(this.currency===undefined){this.currency=null}if(this.valueAddedTaxEnabled===undefined){this.valueAddedTaxEnabled=false}if(this.furnitureCatalogViewedInTree===undefined){this.furnitureCatalogViewedInTree=false}if(this.navigationPanelVisible===undefined){this.navigationPanelVisible=false}if(this.aerialViewCenteredOnSelectionEnabled===undefined){this.aerialViewCenteredOnSelectionEnabled=false}if(this.observerCameraSelectedAtChange===undefined){this.observerCameraSelectedAtChange=false}if(this.magnetismEnabled===undefined){this.magnetismEnabled=false}if(this.rulersVisible===undefined){this.rulersVisible=false}if(this.gridVisible===undefined){this.gridVisible=false}if(this.defaultFontName===undefined){this.defaultFontName=null}if(this.furnitureViewedFromTop===undefined){this.furnitureViewedFromTop=false}if(this.furnitureModelIconSize===undefined){this.furnitureModelIconSize=0}if(this.roomFloorColoredOrTextured===undefined){this.roomFloorColoredOrTextured=false}if(this.wallPattern===undefined){this.wallPattern=null}if(this.newWallPattern===undefined){this.newWallPattern=null}if(this.newWallThickness===undefined){this.newWallThickness=0}if(this.newWallHeight===undefined){this.newWallHeight=0}if(this.newFloorThickness===undefined){this.newFloorThickness=0}if(this.checkUpdatesEnabled===undefined){this.checkUpdatesEnabled=false}if(this.autoSaveDelayForRecovery===undefined){this.autoSaveDelayForRecovery=0}if(this.autoSaveForRecoveryEnabled===undefined){this.autoSaveForRecoveryEnabled=false}this.preferences=d;this.viewFactory=b;this.homeController=e;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}else{if(((d!=null&&d instanceof UserPreferences)||d===null)&&((b!=null&&(b.constructor!=null&&b.constructor.__interfaces!=null&&b.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||b===null)&&((g!=null&&(g.constructor!=null&&g.constructor.__interfaces!=null&&g.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||g===null)&&e===undefined){var f=arguments;var h=arguments;var c=null;if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.homeController===undefined){this.homeController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.userPreferencesView===undefined){this.userPreferencesView=null}if(this.language===undefined){this.language=null}if(this.unit===undefined){this.unit=null}if(this.currency===undefined){this.currency=null}if(this.valueAddedTaxEnabled===undefined){this.valueAddedTaxEnabled=false}if(this.furnitureCatalogViewedInTree===undefined){this.furnitureCatalogViewedInTree=false}if(this.navigationPanelVisible===undefined){this.navigationPanelVisible=false}if(this.aerialViewCenteredOnSelectionEnabled===undefined){this.aerialViewCenteredOnSelectionEnabled=false}if(this.observerCameraSelectedAtChange===undefined){this.observerCameraSelectedAtChange=false}if(this.magnetismEnabled===undefined){this.magnetismEnabled=false}if(this.rulersVisible===undefined){this.rulersVisible=false}if(this.gridVisible===undefined){this.gridVisible=false}if(this.defaultFontName===undefined){this.defaultFontName=null}if(this.furnitureViewedFromTop===undefined){this.furnitureViewedFromTop=false}if(this.furnitureModelIconSize===undefined){this.furnitureModelIconSize=0}if(this.roomFloorColoredOrTextured===undefined){this.roomFloorColoredOrTextured=false}if(this.wallPattern===undefined){this.wallPattern=null}if(this.newWallPattern===undefined){this.newWallPattern=null}if(this.newWallThickness===undefined){this.newWallThickness=0}if(this.newWallHeight===undefined){this.newWallHeight=0}if(this.newFloorThickness===undefined){this.newFloorThickness=0}if(this.checkUpdatesEnabled===undefined){this.checkUpdatesEnabled=false}if(this.autoSaveDelayForRecovery===undefined){this.autoSaveDelayForRecovery=0}if(this.autoSaveForRecoveryEnabled===undefined){this.autoSaveForRecoveryEnabled=false}this.preferences=d;this.viewFactory=b;this.homeController=c;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties();this.preferences=d;this.viewFactory=b;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}else{throw new Error("invalid overload")}}}a.prototype.getView=function(){if(this.userPreferencesView==null){this.userPreferencesView=this.viewFactory.createUserPreferencesView(this.preferences,this)}return this.userPreferencesView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){this.setLanguage(this.preferences.getLanguage());this.setUnit(this.preferences.getLengthUnit());this.setCurrency(this.preferences.getCurrency());this.setValueAddedTaxEnabled(this.preferences.isValueAddedTaxEnabled());this.setFurnitureCatalogViewedInTree(this.preferences.isFurnitureCatalogViewedInTree());this.setNavigationPanelVisible(this.preferences.isNavigationPanelVisible());this.setAerialViewCenteredOnSelectionEnabled(this.preferences.isAerialViewCenteredOnSelectionEnabled());this.setObserverCameraSelectedAtChange(this.preferences.isObserverCameraSelectedAtChange());this.setMagnetismEnabled(this.preferences.isMagnetismEnabled());this.setRulersVisible(this.preferences.isRulersVisible());this.setGridVisible(this.preferences.isGridVisible());this.setDefaultFontName(this.preferences.getDefaultFontName());this.setFurnitureViewedFromTop(this.preferences.isFurnitureViewedFromTop());this.setFurnitureModelIconSize(this.preferences.getFurnitureModelIconSize());this.setRoomFloorColoredOrTextured(this.preferences.isRoomFloorColoredOrTextured());this.setWallPattern(this.preferences.getWallPattern());this.setNewWallPattern(this.preferences.getNewWallPattern());var c=this.getUnit().getMinimumLength();var b=this.getUnit().getMaximumLength();this.setNewWallThickness(Math.min(Math.max(c,this.preferences.getNewWallThickness()),b/10));this.setNewWallHeight(Math.min(Math.max(c,this.preferences.getNewWallHeight()),b));this.setNewFloorThickness(Math.min(Math.max(c,this.preferences.getNewFloorThickness()),b/10));this.setCheckUpdatesEnabled(this.preferences.isCheckUpdatesEnabled());this.setAutoSaveDelayForRecovery(this.preferences.getAutoSaveDelayForRecovery());this.setAutoSaveForRecoveryEnabled(this.preferences.getAutoSaveDelayForRecovery()>0)};a.prototype.isPropertyEditable=function(b){switch((b)){case"LANGUAGE":return this.preferences.isLanguageEditable();default:return true}};a.prototype.setLanguage=function(c){if(c!==this.language){var b=this.language;this.language=c;this.propertyChangeSupport.firePropertyChange("LANGUAGE",b,c)}};a.prototype.getLanguage=function(){return this.language};a.prototype.setUnit=function(b){if(b!==this.unit){var c=this.unit;this.unit=b;this.propertyChangeSupport.firePropertyChange("UNIT",c,b)}};a.prototype.getUnit=function(){return this.unit};a.prototype.setCurrency=function(b){if(b!==this.currency){var c=this.currency;this.currency=b;this.propertyChangeSupport.firePropertyChange("CURRENCY",c,b);if(b==null){this.setValueAddedTaxEnabled(false)}}};a.prototype.getCurrency=function(){return this.currency};a.prototype.setValueAddedTaxEnabled=function(b){if(this.valueAddedTaxEnabled!==b){this.valueAddedTaxEnabled=b;this.propertyChangeSupport.firePropertyChange("VALUE_ADDED_TAX_ENABLED",!b,b)}};a.prototype.isValueAddedTaxEnabled=function(){return this.valueAddedTaxEnabled};a.prototype.setFurnitureCatalogViewedInTree=function(b){if(this.furnitureCatalogViewedInTree!==b){this.furnitureCatalogViewedInTree=b;this.propertyChangeSupport.firePropertyChange("FURNITURE_CATALOG_VIEWED_IN_TREE",!b,b)}};a.prototype.isFurnitureCatalogViewedInTree=function(){return this.furnitureCatalogViewedInTree};a.prototype.setNavigationPanelVisible=function(b){if(this.navigationPanelVisible!==b){this.navigationPanelVisible=b;this.propertyChangeSupport.firePropertyChange("NAVIGATION_PANEL_VISIBLE",!b,b)}};a.prototype.isNavigationPanelVisible=function(){return this.navigationPanelVisible};a.prototype.setAerialViewCenteredOnSelectionEnabled=function(b){if(b!==this.aerialViewCenteredOnSelectionEnabled){this.aerialViewCenteredOnSelectionEnabled=b;this.propertyChangeSupport.firePropertyChange("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",!b,b)}};a.prototype.isAerialViewCenteredOnSelectionEnabled=function(){return this.aerialViewCenteredOnSelectionEnabled};a.prototype.setObserverCameraSelectedAtChange=function(b){if(b!==this.observerCameraSelectedAtChange){this.observerCameraSelectedAtChange=b;this.propertyChangeSupport.firePropertyChange("OBSERVER_CAMERA_SELECTED_AT_CHANGE",!b,b)}};a.prototype.isObserverCameraSelectedAtChange=function(){return this.observerCameraSelectedAtChange};a.prototype.setMagnetismEnabled=function(b){if(b!==this.magnetismEnabled){this.magnetismEnabled=b;this.propertyChangeSupport.firePropertyChange("MAGNETISM_ENABLED",!b,b)}};a.prototype.isMagnetismEnabled=function(){return this.magnetismEnabled};a.prototype.setRulersVisible=function(b){if(b!==this.rulersVisible){this.rulersVisible=b;this.propertyChangeSupport.firePropertyChange("RULERS_VISIBLE",!b,b)}};a.prototype.isRulersVisible=function(){return this.rulersVisible};a.prototype.setGridVisible=function(b){if(b!==this.gridVisible){this.gridVisible=b;this.propertyChangeSupport.firePropertyChange("GRID_VISIBLE",!b,b)}};a.prototype.isGridVisible=function(){return this.gridVisible};a.prototype.setDefaultFontName=function(c){if(c!==this.defaultFontName&&(c==null||!(c===this.defaultFontName))){var b=this.defaultFontName;this.defaultFontName=c;this.propertyChangeSupport.firePropertyChange("DEFAULT_FONT_NAME",b,c)}};a.prototype.getDefaultFontName=function(){return this.defaultFontName};a.prototype.setFurnitureViewedFromTop=function(b){if(this.furnitureViewedFromTop!==b){this.furnitureViewedFromTop=b;this.propertyChangeSupport.firePropertyChange("FURNITURE_VIEWED_FROM_TOP",!b,b)}};a.prototype.isFurnitureViewedFromTop=function(){return this.furnitureViewedFromTop};a.prototype.setFurnitureModelIconSize=function(b){if(b!==this.furnitureModelIconSize){var c=this.furnitureModelIconSize;this.furnitureModelIconSize=b;this.propertyChangeSupport.firePropertyChange("FURNITURE_MODEL_ICON_SIZE",c,b)}};a.prototype.getFurnitureModelIconSize=function(){return this.furnitureModelIconSize};a.prototype.setRoomFloorColoredOrTextured=function(b){if(this.roomFloorColoredOrTextured!==b){this.roomFloorColoredOrTextured=b;this.propertyChangeSupport.firePropertyChange("ROOM_FLOOR_COLORED_OR_TEXTURED",!b,b)}};a.prototype.isRoomFloorColoredOrTextured=function(){return this.roomFloorColoredOrTextured};a.prototype.setWallPattern=function(b){if(this.wallPattern!==b){var c=this.wallPattern;this.wallPattern=b;this.propertyChangeSupport.firePropertyChange("WALL_PATTERN",c,b)}};a.prototype.getWallPattern=function(){return this.wallPattern};a.prototype.setNewWallPattern=function(b){if(this.newWallPattern!==b){var c=this.newWallPattern;this.newWallPattern=b;this.propertyChangeSupport.firePropertyChange("NEW_WALL_PATTERN",c,b)}};a.prototype.getNewWallPattern=function(){return this.newWallPattern};a.prototype.setNewWallThickness=function(b){if(b!==this.newWallThickness){var c=this.newWallThickness;this.newWallThickness=b;this.propertyChangeSupport.firePropertyChange("NEW_WALL_THICKNESS",c,b)}};a.prototype.getNewWallThickness=function(){return this.newWallThickness};a.prototype.setNewWallHeight=function(c){if(c!==this.newWallHeight){var b=this.newWallHeight;this.newWallHeight=c;this.propertyChangeSupport.firePropertyChange("NEW_WALL_HEIGHT",b,c)}};a.prototype.getNewWallHeight=function(){return this.newWallHeight};a.prototype.setNewFloorThickness=function(b){if(b!==this.newFloorThickness){var c=this.newFloorThickness;this.newFloorThickness=b;this.propertyChangeSupport.firePropertyChange("NEW_FLOOR_THICKNESS",c,b)}};a.prototype.getNewFloorThickness=function(){return this.newFloorThickness};a.prototype.setCheckUpdatesEnabled=function(b){if(b!==this.checkUpdatesEnabled){this.checkUpdatesEnabled=b;this.propertyChangeSupport.firePropertyChange("CHECK_UPDATES_ENABLED",!b,b)}};a.prototype.isCheckUpdatesEnabled=function(){return this.checkUpdatesEnabled};a.prototype.setAutoSaveDelayForRecovery=function(c){if(c!==this.autoSaveDelayForRecovery){var b=this.autoSaveDelayForRecovery;this.autoSaveDelayForRecovery=c;this.propertyChangeSupport.firePropertyChange("AUTO_SAVE_DELAY_FOR_RECOVERY",b,c)}};a.prototype.getAutoSaveDelayForRecovery=function(){return this.autoSaveDelayForRecovery};a.prototype.setAutoSaveForRecoveryEnabled=function(b){if(b!==this.autoSaveForRecoveryEnabled){this.autoSaveForRecoveryEnabled=b;this.propertyChangeSupport.firePropertyChange("AUTO_SAVE_FOR_RECOVERY_ENABLED",!b,b)}};a.prototype.isAutoSaveForRecoveryEnabled=function(){return this.autoSaveForRecoveryEnabled};a.prototype.resetDisplayedActionTips=function(){this.preferences.resetIgnoredActionTips()};a.prototype.modifyUserPreferences=function(){this.preferences.setLanguage(this.getLanguage());this.preferences.setUnit(this.getUnit());this.preferences.setCurrency(this.getCurrency());this.preferences.setValueAddedTaxEnabled(this.isValueAddedTaxEnabled());this.preferences.setFurnitureCatalogViewedInTree(this.isFurnitureCatalogViewedInTree());this.preferences.setNavigationPanelVisible(this.isNavigationPanelVisible());this.preferences.setAerialViewCenteredOnSelectionEnabled(this.isAerialViewCenteredOnSelectionEnabled());this.preferences.setObserverCameraSelectedAtChange(this.isObserverCameraSelectedAtChange());this.preferences.setMagnetismEnabled(this.isMagnetismEnabled());this.preferences.setRulersVisible(this.isRulersVisible());this.preferences.setGridVisible(this.isGridVisible());this.preferences.setDefaultFontName(this.getDefaultFontName());this.preferences.setFurnitureViewedFromTop(this.isFurnitureViewedFromTop());this.preferences.setFurnitureModelIconSize(this.getFurnitureModelIconSize());this.preferences.setFloorColoredOrTextured(this.isRoomFloorColoredOrTextured());this.preferences.setWallPattern(this.getWallPattern());this.preferences.setNewWallPattern(this.getNewWallPattern());this.preferences.setNewWallThickness(this.getNewWallThickness());this.preferences.setNewWallHeight(this.getNewWallHeight());this.preferences.setNewFloorThickness(this.getNewFloorThickness());this.preferences.setCheckUpdatesEnabled(this.isCheckUpdatesEnabled());this.preferences.setAutoSaveDelayForRecovery(this.isAutoSaveForRecoveryEnabled()?this.getAutoSaveDelayForRecovery():0)};return a}());UserPreferencesController.__class="com.eteks.sweethome3d.viewcontroller.UserPreferencesController";UserPreferencesController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];var VideoController=(function(){function a(e,c,b,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.videoView===undefined){this.videoView=null}if(this.aspectRatio===undefined){this.aspectRatio=null}if(this.frameRate===undefined){this.frameRate=0}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.quality===undefined){this.quality=0}if(this.speed===undefined){this.speed=0}if(this.cameraPath===undefined){this.cameraPath=null}if(this.time===undefined){this.time=0}if(this.ceilingLightColor===undefined){this.ceilingLightColor=0}this.home=e;this.preferences=c;this.viewFactory=b;this.contentManager=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties();e.getEnvironment().addPropertyChangeListener("CEILING_LIGHT_COLOR",new a.HomeEnvironmentChangeListener(this))}a.prototype.getView=function(){if(this.videoView==null){this.videoView=this.viewFactory.createVideoView(this.home,this.preferences,this)}return this.videoView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.getContentManager=function(){return this.contentManager};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var b=this.home.getEnvironment();this.setFrameRate(b.getVideoFrameRate());this.setWidth(b.getVideoWidth(),false);this.setHeight(b.getVideoHeight(),false);this.setAspectRatio(b.getVideoAspectRatio());this.setQuality(b.getVideoQuality());this.setSpeed(b.getVideoSpeed());var c=b.getVideoCameraPath();this.setCameraPath(c);this.setTime((c.length==0)?this.home.getCamera().getTime():c[0].getTime());this.setCeilingLightColor(b.getCeillingLightColor())};a.prototype.setAspectRatio=function(b){if(this.aspectRatio!==b){var c=this.aspectRatio;this.aspectRatio=b;this.propertyChangeSupport.firePropertyChange("ASPECT_RATIO",c,b);this.home.getEnvironment().setVideoAspectRatio(this.aspectRatio);this.setHeight(Math.round(this.width/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}};a.prototype.getAspectRatio=function(){return this.aspectRatio};a.prototype.setFrameRate=function(b){if(this.frameRate!==b){var c=this.frameRate;this.frameRate=b;this.propertyChangeSupport.firePropertyChange("QUALITY",c,b);this.home.getEnvironment().setVideoFrameRate(this.frameRate)}};a.prototype.getFrameRate=function(){return this.frameRate};a.prototype.setWidth=function(c,d){if(d===void 0){d=true}if(this.width!==c){var b=this.width;this.width=c;this.propertyChangeSupport.firePropertyChange("WIDTH",b,c);if(d){this.setHeight(Math.round(c/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}this.home.getEnvironment().setVideoWidth(this.width)}};a.prototype.getWidth=function(){return this.width};a.prototype.setHeight=function(b,d){if(d===void 0){d=true}if(this.height!==b){var c=this.height;this.height=b;this.propertyChangeSupport.firePropertyChange("HEIGHT",c,b);if(d){this.setWidth(Math.round(b*{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}}};a.prototype.getHeight=function(){return this.height};a.prototype.setQuality=function(c){if(this.quality!==c){var b=this.quality;this.quality=Math.min(c,this.getQualityLevelCount()-1);this.propertyChangeSupport.firePropertyChange("QUALITY",b,c);this.home.getEnvironment().setVideoQuality(this.quality)}};a.prototype.getQuality=function(){return this.quality};a.prototype.setSpeed=function(c){if(this.speed!==c){var b=this.speed;this.speed=c;this.propertyChangeSupport.firePropertyChange("SPEED",b,c);this.home.getEnvironment().setVideoSpeed(this.speed)}};a.prototype.getSpeed=function(){return this.speed};a.prototype.getQualityLevelCount=function(){return 4};a.prototype.getCameraPath=function(){return this.cameraPath};a.prototype.setCameraPath=function(b){if(this.cameraPath!==b){var c=this.cameraPath;this.cameraPath=b;this.propertyChangeSupport.firePropertyChange("CAMERA_PATH",c,b);this.home.getEnvironment().setVideoCameraPath(this.cameraPath)}};a.prototype.setTime=function(b){if(this.time!==b){var c=this.time;this.time=b;this.propertyChangeSupport.firePropertyChange("TIME",c,b);this.home.getCamera().setTime(b)}};a.prototype.getTime=function(){return this.time};a.prototype.setCeilingLightColor=function(b){if(this.ceilingLightColor!==b){var c=this.ceilingLightColor;this.ceilingLightColor=b;this.propertyChangeSupport.firePropertyChange("CEILING_LIGHT_COLOR",c,b);this.home.getEnvironment().setCeillingLightColor(b)}};a.prototype.getCeilingLightColor=function(){return this.ceilingLightColor};a.prototype.setVisualProperty=function(c,b){this.home.setVisualProperty(c,b)};a.prototype.setHomeProperty=function(c,b){this.home.setProperty(c,b)};return a}());VideoController.__class="com.eteks.sweethome3d.viewcontroller.VideoController";VideoController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(b){var a=(function(){function c(d){if(this.videoController===undefined){this.videoController=null}this.videoController=(d)}c.prototype.propertyChange=function(e){var d=this.videoController;if(d==null){e.getSource().removePropertyChangeListener("CEILING_LIGHT_COLOR",this)}else{d.updateProperties()}};return c}());b.HomeEnvironmentChangeListener=a;a.__class="com.eteks.sweethome3d.viewcontroller.VideoController.HomeEnvironmentChangeListener"})(VideoController||(VideoController={}));var LocalizedUndoableEdit=(function(a){__extends(b,a);function b(d,e,c){var f=a.call(this)||this;if(f.preferences===undefined){f.preferences=null}if(f.controllerClass===undefined){f.controllerClass=null}if(f.presentationNameKey===undefined){f.presentationNameKey=null}f.preferences=d;f.controllerClass=e;f.presentationNameKey=c;return f}b.prototype.getPresentationName=function(){return this.preferences.getLocalizedString(this.controllerClass,this.presentationNameKey)};return b}(javax.swing.undo.AbstractUndoableEdit));LocalizedUndoableEdit.__class="com.eteks.sweethome3d.viewcontroller.LocalizedUndoableEdit";LocalizedUndoableEdit.__interfaces=["javax.swing.undo.UndoableEdit"];var ContentManager;(function(a){var b;(function(c){c[c.SWEET_HOME_3D=0]="SWEET_HOME_3D";c[c.MODEL=1]="MODEL";c[c.IMAGE=2]="IMAGE";c[c.CSV=3]="CSV";c[c.SVG=4]="SVG";c[c.OBJ=5]="OBJ";c[c.PNG=6]="PNG";c[c.JPEG=7]="JPEG";c[c.MOV=8]="MOV";c[c.PDF=9]="PDF";c[c.LANGUAGE_LIBRARY=10]="LANGUAGE_LIBRARY";c[c.TEXTURES_LIBRARY=11]="TEXTURES_LIBRARY";c[c.FURNITURE_LIBRARY=12]="FURNITURE_LIBRARY";c[c.PLUGIN=13]="PLUGIN";c[c.PHOTOS_DIRECTORY=14]="PHOTOS_DIRECTORY";c[c.USER_DEFINED=15]="USER_DEFINED"})(b=a.ContentType||(a.ContentType={}))})(ContentManager||(ContentManager={}));var PlanView;(function(a){var b;(function(c){c[c.SELECTION=0]="SELECTION";c[c.PANNING=1]="PANNING";c[c.DRAW=2]="DRAW";c[c.ROTATION=3]="ROTATION";c[c.ELEVATION=4]="ELEVATION";c[c.HEIGHT=5]="HEIGHT";c[c.POWER=6]="POWER";c[c.RESIZE=7]="RESIZE";c[c.DUPLICATION=8]="DUPLICATION";c[c.MOVE=9]="MOVE"})(b=a.CursorType||(a.CursorType={}))})(PlanView||(PlanView={}));var TextureChoiceController=(function(){function a(l,g,d,j,k){if(((typeof l==="string")||l===null)&&((typeof g==="boolean")||g===null)&&((d!=null&&d instanceof UserPreferences)||d===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||j===null)&&((k!=null&&(k.constructor!=null&&k.constructor.__interfaces!=null&&k.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||k===null)){var f=arguments;if(this.title===undefined){this.title=null}if(this.rotationSupported===undefined){this.rotationSupported=false}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureChoiceView===undefined){this.textureChoiceView=null}if(this.texture===undefined){this.texture=null}this.title=l;this.rotationSupported=g;this.preferences=d;this.viewFactory=j;this.contentManager=k;this.propertyChangeSupport=new PropertyChangeSupport(this)}else{if(((typeof l==="string")||l===null)&&((g!=null&&g instanceof UserPreferences)||g===null)&&((d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||d===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||j===null)&&k===undefined){var f=arguments;var e=f[1];var h=f[2];var m=f[3];var b=arguments;var c=true;if(this.title===undefined){this.title=null}if(this.rotationSupported===undefined){this.rotationSupported=false}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureChoiceView===undefined){this.textureChoiceView=null}if(this.texture===undefined){this.texture=null}this.title=l;this.rotationSupported=c;this.preferences=e;this.viewFactory=h;this.contentManager=m;this.propertyChangeSupport=new PropertyChangeSupport(this);if(this.title===undefined){this.title=null}if(this.rotationSupported===undefined){this.rotationSupported=false}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureChoiceView===undefined){this.textureChoiceView=null}if(this.texture===undefined){this.texture=null}}else{throw new Error("invalid overload")}}}a.prototype.getView=function(){if(this.textureChoiceView==null){this.textureChoiceView=this.viewFactory.createTextureChoiceView(this.preferences,this)}return this.textureChoiceView};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.setTexture=function(c){if(this.texture!==c&&(c==null||!c.equals(this.texture))){var b=this.texture;this.texture=c;this.propertyChangeSupport.firePropertyChange("TEXTURE",b,c)}};a.prototype.getTexture=function(){return this.texture};a.prototype.getDialogTitle=function(){return this.title};a.prototype.isRotationSupported=function(){return this.rotationSupported};a.prototype.importTexture$=function(){new ImportedTextureWizardController(this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())};a.prototype.importTexture$java_lang_String=function(b){new ImportedTextureWizardController(b,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())};a.prototype.importTexture=function(b){if(((typeof b==="string")||b===null)){return this.importTexture$java_lang_String(b)}else{if(b===undefined){return this.importTexture$()}else{throw new Error("invalid overload")}}};a.prototype.modifyTexture=function(b){new ImportedTextureWizardController(b,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())};a.prototype.deleteTexture=function(b){if(this.getView().confirmDeleteSelectedCatalogTexture()){this.preferences.getTexturesCatalog()["delete"](b)}};a.prototype.addRecentTexture=function(e){var d=(this.preferences.getRecentTextures().slice(0));for(var b=0;b<d.length;b++){var c=d[b];if((function(g,f){if(g&&g.equals){return g.equals(f)}else{return g===f}})(c.getImage(),e.getImage())){if(b===0){return}else{d.splice(b,1)[0];break}}}d.splice(0,0,e);while((d.length>a.MAX_RECENT_TEXTURES)){d.splice(d.length-1,1)[0]}this.preferences.setRecentTextures(d)};a.MAX_RECENT_TEXTURES=15;return a}());TextureChoiceController.__class="com.eteks.sweethome3d.viewcontroller.TextureChoiceController";TextureChoiceController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];var ExportableView;(function(b){var a=(function(){function c(d){if(this.__name===undefined){this.__name=null}this.__name=d}c.SVG_$LI$=function(){if(c.SVG==null){c.SVG=new b.FormatType("SVG")}return c.SVG};c.CSV_$LI$=function(){if(c.CSV==null){c.CSV=new b.FormatType("CSV")}return c.CSV};c.prototype.name=function(){return this.__name};c.prototype.toString=function(){return this.__name};return c}());b.FormatType=a;a.__class="com.eteks.sweethome3d.viewcontroller.ExportableView.FormatType"})(ExportableView||(ExportableView={}));var AbstractPhotoController=(function(){function a(e,b,f,d){if(this.home===undefined){this.home=null}if(this.view3D===undefined){this.view3D=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.aspectRatio===undefined){this.aspectRatio=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.quality===undefined){this.quality=0}if(this.view3DAspectRatio===undefined){this.view3DAspectRatio=0}if(this.ceilingLightColor===undefined){this.ceilingLightColor=0}this.home=e;this.view3D=f;this.contentManager=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.view3DAspectRatio=1;var c=new a.EnvironmentChangeListener(this);e.getEnvironment().addPropertyChangeListener("PHOTO_WIDTH",c);e.getEnvironment().addPropertyChangeListener("PHOTO_HEIGHT",c);e.getEnvironment().addPropertyChangeListener("PHOTO_ASPECT_RATIO",c);e.getEnvironment().addPropertyChangeListener("PHOTO_QUALITY",c);e.getEnvironment().addPropertyChangeListener("CEILING_LIGHT_COLOR",c);this.updateProperties()}a.prototype.getContentManager=function(){return this.contentManager};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var b=this.home.getEnvironment();this.setAspectRatio(b.getPhotoAspectRatio());this.setWidth(b.getPhotoWidth(),false);this.setHeight(b.getPhotoHeight(),false);this.setQuality(b.getPhotoQuality());this.setCeilingLightColor(b.getCeillingLightColor())};a.prototype.setAspectRatio=function(b){if(this.aspectRatio!==b){var c=this.aspectRatio;this.aspectRatio=b;this.propertyChangeSupport.firePropertyChange("ASPECT_RATIO",c,b);this.home.getEnvironment().setPhotoAspectRatio(this.aspectRatio);if(this.aspectRatio===AspectRatio.VIEW_3D_RATIO){if(this.view3DAspectRatio!==Infinity){this.setHeight(Math.round(this.width/this.view3DAspectRatio),false)}}else{if({FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]!=null){this.setHeight(Math.round(this.width/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}}}};a.prototype.getAspectRatio=function(){return this.aspectRatio};a.prototype.setWidth=function(c,d){if(d===void 0){d=true}if(this.width!==c){var b=this.width;this.width=c;this.propertyChangeSupport.firePropertyChange("WIDTH",b,c);if(d){if(this.aspectRatio===AspectRatio.VIEW_3D_RATIO){if(this.view3DAspectRatio!==Infinity){this.setHeight(Math.round(c/this.view3DAspectRatio),false)}}else{if({FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]!=null){this.setHeight(Math.round(c/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}}}this.home.getEnvironment().setPhotoWidth(this.width)}};a.prototype.getWidth=function(){return this.width};a.prototype.setHeight=function(b,d){if(d===void 0){d=true}if(this.height!==b){var c=this.height;this.height=b;this.propertyChangeSupport.firePropertyChange("HEIGHT",c,b);if(d){if(this.aspectRatio===AspectRatio.VIEW_3D_RATIO){if(this.view3DAspectRatio!==Infinity){this.setWidth(Math.round(b*this.view3DAspectRatio),false)}}else{if({FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]!=null){this.setWidth(Math.round(b*{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}}}this.home.getEnvironment().setPhotoHeight(this.height)}};a.prototype.getHeight=function(){return this.height};a.prototype.setQuality=function(c){if(this.quality!==c){var b=this.quality;this.quality=Math.min(c,this.getQualityLevelCount()-1);this.propertyChangeSupport.firePropertyChange("QUALITY",b,c);this.home.getEnvironment().setPhotoQuality(this.quality)}};a.prototype.getQuality=function(){return this.quality};a.prototype.getQualityLevelCount=function(){return 4};a.prototype.setCeilingLightColor=function(b){if(this.ceilingLightColor!==b){var c=this.ceilingLightColor;this.ceilingLightColor=b;this.propertyChangeSupport.firePropertyChange("CEILING_LIGHT_COLOR",c,b);this.home.getEnvironment().setCeillingLightColor(b)}};a.prototype.getCeilingLightColor=function(){return this.ceilingLightColor};a.prototype.set3DViewAspectRatio=function(c){if(this.view3DAspectRatio!==c){var b=this.view3DAspectRatio;this.view3DAspectRatio=c;this.propertyChangeSupport.firePropertyChange("ASPECT_RATIO",b,c);if(this.aspectRatio===AspectRatio.VIEW_3D_RATIO&&this.view3DAspectRatio!==Infinity){this.setHeight(Math.round(this.width/this.view3DAspectRatio),false)}}};a.prototype.get3DViewAspectRatio=function(){return this.view3DAspectRatio};a.prototype.get3DView=function(){return this.view3D};a.prototype.setVisualProperty=function(c,b){this.home.setVisualProperty(c,b)};a.prototype.setHomeProperty=function(c,b){this.home.setProperty(c,b)};return a}());AbstractPhotoController.__class="com.eteks.sweethome3d.viewcontroller.AbstractPhotoController";AbstractPhotoController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(b){var a=(function(){function c(d){if(this.photoController===undefined){this.photoController=null}this.photoController=(d)}c.prototype.propertyChange=function(e){var d=this.photoController;if(d==null){e.getSource().removePropertyChangeListener("PHOTO_WIDTH",this);e.getSource().removePropertyChangeListener("PHOTO_HEIGHT",this);e.getSource().removePropertyChangeListener("PHOTO_ASPECT_RATIO",this);e.getSource().removePropertyChangeListener("PHOTO_QUALITY",this);e.getSource().removePropertyChangeListener("CEILING_LIGHT_COLOR",this)}else{if("PHOTO_WIDTH"===e.getPropertyName()){d.setWidth(e.getNewValue(),false)}else{if("PHOTO_HEIGHT"===e.getPropertyName()){d.setHeight(e.getNewValue(),false)}else{if("PHOTO_ASPECT_RATIO"===e.getPropertyName()){d.setAspectRatio(e.getNewValue())}else{if("PHOTO_QUALITY"===e.getPropertyName()){d.setQuality(e.getNewValue())}else{if("CEILING_LIGHT_COLOR"===e.getPropertyName()){d.setCeilingLightColor(e.getNewValue())}}}}}}};return c}());b.EnvironmentChangeListener=a;a.__class="com.eteks.sweethome3d.viewcontroller.AbstractPhotoController.EnvironmentChangeListener"})(AbstractPhotoController||(AbstractPhotoController={}));var InterruptedRecorderException=(function(a){__extends(b,a);function b(c){var e=this;if(((typeof c==="string")||c===null)){var d=arguments;e=a.call(this,c)||this}else{if(c===undefined){var d=arguments;e=a.call(this)||this}else{throw new Error("invalid overload")}}return e}return b}(RecorderException));InterruptedRecorderException.__class="com.eteks.sweethome3d.model.InterruptedRecorderException";var NotEnoughSpaceRecorderException=(function(b){__extends(a,b);function a(c,d){var e=b.call(this,c)||this;Object.setPrototypeOf(e,a.prototype);if(e.missingSpace===undefined){e.missingSpace=0}e.missingSpace=d;return e}a.prototype.getMissingSpace=function(){return this.missingSpace};return a}(RecorderException));NotEnoughSpaceRecorderException.__class="com.eteks.sweethome3d.model.NotEnoughSpaceRecorderException";var DamagedHomeRecorderException=(function(b){__extends(a,b);function a(g,e,c){var f=this;if(((g!=null&&g instanceof Home)||g===null)&&((e!=null&&(e instanceof Array))||e===null)&&((typeof c==="string")||c===null)){var d=arguments;f=b.call(this,c)||this;if(f.damagedHome===undefined){f.damagedHome=null}if(f.invalidContent===undefined){f.invalidContent=null}f.damagedHome=g;f.invalidContent=e}else{if(((g!=null&&g instanceof Home)||g===null)&&((e!=null&&(e instanceof Array))||e===null)&&c===undefined){var d=arguments;f=b.call(this)||this;if(f.damagedHome===undefined){f.damagedHome=null}if(f.invalidContent===undefined){f.invalidContent=null}f.damagedHome=g;f.invalidContent=e}else{throw new Error("invalid overload")}}return f}a.prototype.getDamagedHome=function(){return this.damagedHome};a.prototype.getInvalidContent=function(){return this.invalidContent};return a}(RecorderException));DamagedHomeRecorderException.__class="com.eteks.sweethome3d.model.DamagedHomeRecorderException";var Room=(function(b){__extends(a,b);function a(j,d){var h=this;if(((typeof j==="string")||j===null)&&((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||d[0] instanceof Array))||d===null)){var g=arguments;h=b.call(this,j)||this;if(h.name===undefined){h.name=null}if(h.nameXOffset===undefined){h.nameXOffset=0}if(h.nameYOffset===undefined){h.nameYOffset=0}if(h.nameStyle===undefined){h.nameStyle=null}if(h.nameAngle===undefined){h.nameAngle=0}if(h.points===undefined){h.points=null}if(h.areaVisible===undefined){h.areaVisible=false}if(h.areaXOffset===undefined){h.areaXOffset=0}if(h.areaYOffset===undefined){h.areaYOffset=0}if(h.areaStyle===undefined){h.areaStyle=null}if(h.areaAngle===undefined){h.areaAngle=0}if(h.floorVisible===undefined){h.floorVisible=false}if(h.floorColor===undefined){h.floorColor=null}if(h.floorTexture===undefined){h.floorTexture=null}if(h.floorShininess===undefined){h.floorShininess=0}if(h.ceilingVisible===undefined){h.ceilingVisible=false}if(h.ceilingColor===undefined){h.ceilingColor=null}if(h.ceilingTexture===undefined){h.ceilingTexture=null}if(h.ceilingShininess===undefined){h.ceilingShininess=0}if(h.level===undefined){h.level=null}if(h.shapeCache===undefined){h.shapeCache=null}if(h.areaCache===undefined){h.areaCache=null}if(d.length<=1){throw new IllegalStateException("Room points must containt at least two points")}h.points=h.deepCopy(d);h.areaVisible=true;h.nameYOffset=-40;h.floorVisible=true;h.ceilingVisible=true}else{if(((j!=null&&j instanceof Array&&(j.length==0||j[0]==null||j[0] instanceof Array))||j===null)&&d===undefined){var g=arguments;var f=g[0];var e=arguments;var c=HomeObject.createId("room");h=b.call(this,c)||this;if(h.name===undefined){h.name=null}if(h.nameXOffset===undefined){h.nameXOffset=0}if(h.nameYOffset===undefined){h.nameYOffset=0}if(h.nameStyle===undefined){h.nameStyle=null}if(h.nameAngle===undefined){h.nameAngle=0}if(h.points===undefined){h.points=null}if(h.areaVisible===undefined){h.areaVisible=false}if(h.areaXOffset===undefined){h.areaXOffset=0}if(h.areaYOffset===undefined){h.areaYOffset=0}if(h.areaStyle===undefined){h.areaStyle=null}if(h.areaAngle===undefined){h.areaAngle=0}if(h.floorVisible===undefined){h.floorVisible=false}if(h.floorColor===undefined){h.floorColor=null}if(h.floorTexture===undefined){h.floorTexture=null}if(h.floorShininess===undefined){h.floorShininess=0}if(h.ceilingVisible===undefined){h.ceilingVisible=false}if(h.ceilingColor===undefined){h.ceilingColor=null}if(h.ceilingTexture===undefined){h.ceilingTexture=null}if(h.ceilingShininess===undefined){h.ceilingShininess=0}if(h.level===undefined){h.level=null}if(h.shapeCache===undefined){h.shapeCache=null}if(h.areaCache===undefined){h.areaCache=null}if(f.length<=1){throw new IllegalStateException("Room points must containt at least two points")}h.points=h.deepCopy(f);h.areaVisible=true;h.nameYOffset=-40;h.floorVisible=true;h.ceilingVisible=true;if(h.name===undefined){h.name=null}if(h.nameXOffset===undefined){h.nameXOffset=0}if(h.nameYOffset===undefined){h.nameYOffset=0}if(h.nameStyle===undefined){h.nameStyle=null}if(h.nameAngle===undefined){h.nameAngle=0}if(h.points===undefined){h.points=null}if(h.areaVisible===undefined){h.areaVisible=false}if(h.areaXOffset===undefined){h.areaXOffset=0}if(h.areaYOffset===undefined){h.areaYOffset=0}if(h.areaStyle===undefined){h.areaStyle=null}if(h.areaAngle===undefined){h.areaAngle=0}if(h.floorVisible===undefined){h.floorVisible=false}if(h.floorColor===undefined){h.floorColor=null}if(h.floorTexture===undefined){h.floorTexture=null}if(h.floorShininess===undefined){h.floorShininess=0}if(h.ceilingVisible===undefined){h.ceilingVisible=false}if(h.ceilingColor===undefined){h.ceilingColor=null}if(h.ceilingTexture===undefined){h.ceilingTexture=null}if(h.ceilingShininess===undefined){h.ceilingShininess=0}if(h.level===undefined){h.level=null}if(h.shapeCache===undefined){h.shapeCache=null}if(h.areaCache===undefined){h.areaCache=null}}else{throw new Error("invalid overload")}}return h}a.TWICE_PI_$LI$=function(){if(a.TWICE_PI==null){a.TWICE_PI=2*Math.PI}return a.TWICE_PI};a.prototype.getName=function(){return this.name};a.prototype.setName=function(c){if(c!==this.name&&(c==null||!(c===this.name))){var d=this.name;this.name=c;this.firePropertyChange("NAME",d,c)}};a.prototype.getNameXOffset=function(){return this.nameXOffset};a.prototype.setNameXOffset=function(c){if(c!==this.nameXOffset){var d=this.nameXOffset;this.nameXOffset=c;this.firePropertyChange("NAME_X_OFFSET",d,c)}};a.prototype.getNameYOffset=function(){return this.nameYOffset};a.prototype.setNameYOffset=function(c){if(c!==this.nameYOffset){var d=this.nameYOffset;this.nameYOffset=c;this.firePropertyChange("NAME_Y_OFFSET",d,c)}};a.prototype.getNameStyle=function(){return this.nameStyle};a.prototype.setNameStyle=function(d){if(d!==this.nameStyle){var c=this.nameStyle;this.nameStyle=d;this.firePropertyChange("NAME_STYLE",c,d)}};a.prototype.getNameAngle=function(){return this.nameAngle};a.prototype.setNameAngle=function(c){c=((c%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(c!==this.nameAngle){var d=this.nameAngle;this.nameAngle=c;this.firePropertyChange("NAME_ANGLE",d,c)}};a.prototype.getPoints=function(){return this.deepCopy(this.points)};a.prototype.getPointCount=function(){return this.points.length};a.prototype.deepCopy=function(e){var c=(function(g){var f=[];while(g-->0){f.push(null)}return f})(e.length);for(var d=0;d<e.length;d++){c[d]=e[d].slice(0)}return c};a.prototype.setPoints=function(c){if(!(JSON.stringify(this.points)===JSON.stringify(c))){this.updatePoints(c)}};a.prototype.updatePoints=function(d){var c=this.points;this.points=this.deepCopy(d);this.shapeCache=null;this.areaCache=null;this.firePropertyChange("POINTS",c,d)};a.prototype.addPoint$float$float=function(c,d){this.addPoint$float$float$int(c,d,this.points.length)};a.prototype.addPoint$float$float$int=function(c,g,d){if(d<0||d>this.points.length){throw Object.defineProperty(new Error("Invalid index "+d),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}var f=(function(j){var h=[];while(j-->0){h.push(null)}return h})(this.points.length+1);(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(this.points,0,f,0,d);f[d]=[c,g];(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(this.points,d,f,d+1,this.points.length-d);var e=this.points;this.points=f;this.shapeCache=null;this.areaCache=null;this.firePropertyChange("POINTS",e,this.deepCopy(this.points))};a.prototype.addPoint=function(c,e,d){if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&((typeof d==="number")||d===null)){return this.addPoint$float$float$int(c,e,d)}else{if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&d===undefined){return this.addPoint$float$float(c,e)}else{throw new Error("invalid overload")}}};a.prototype.setPoint=function(c,f,d){if(d<0||d>=this.points.length){throw Object.defineProperty(new Error("Invalid index "+d),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}if(this.points[d][0]!==c||this.points[d][1]!==f){var e=this.points;this.points=this.deepCopy(this.points);this.points[d][0]=c;this.points[d][1]=f;this.shapeCache=null;this.areaCache=null;this.firePropertyChange("POINTS",e,this.deepCopy(this.points))}};a.prototype.removePoint=function(c){if(c<0||c>=this.points.length){throw Object.defineProperty(new Error("Invalid index "+c),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}else{if(this.points.length<=1){throw new IllegalStateException("Room points must containt at least one point")}}var e=(function(g){var f=[];while(g-->0){f.push(null)}return f})(this.points.length-1);(function(k,j,m,l,h){if(k!==m||l>=j+h){while(--h>=0){m[l++]=k[j++]}}else{var g=k.slice(j,j+h);for(var f=0;f<h;f++){m[l++]=g[f]}}})(this.points,0,e,0,c);(function(k,j,m,l,h){if(k!==m||l>=j+h){while(--h>=0){m[l++]=k[j++]}}else{var g=k.slice(j,j+h);for(var f=0;f<h;f++){m[l++]=g[f]}}})(this.points,c+1,e,c,this.points.length-c-1);var d=this.points;this.points=e;this.shapeCache=null;this.areaCache=null;this.firePropertyChange("POINTS",d,this.deepCopy(this.points))};a.prototype.isAreaVisible=function(){return this.areaVisible};a.prototype.setAreaVisible=function(c){if(c!==this.areaVisible){this.areaVisible=c;this.firePropertyChange("AREA_VISIBLE",!c,c)}};a.prototype.getAreaXOffset=function(){return this.areaXOffset};a.prototype.setAreaXOffset=function(c){if(c!==this.areaXOffset){var d=this.areaXOffset;this.areaXOffset=c;this.firePropertyChange("AREA_X_OFFSET",d,c)}};a.prototype.getAreaYOffset=function(){return this.areaYOffset};a.prototype.setAreaYOffset=function(c){if(c!==this.areaYOffset){var d=this.areaYOffset;this.areaYOffset=c;this.firePropertyChange("AREA_Y_OFFSET",d,c)}};a.prototype.getAreaStyle=function(){return this.areaStyle};a.prototype.setAreaStyle=function(d){if(d!==this.areaStyle){var c=this.areaStyle;this.areaStyle=d;this.firePropertyChange("AREA_STYLE",c,d)}};a.prototype.getAreaAngle=function(){return this.areaAngle};a.prototype.setAreaAngle=function(d){d=((d%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(d!==this.areaAngle){var c=this.areaAngle;this.areaAngle=d;this.firePropertyChange("AREA_ANGLE",c,d)}};a.prototype.getXCenter=function(){var c=this.points[0][0];var e=this.points[0][0];for(var d=1;d<this.points.length;d++){c=Math.min(c,this.points[d][0]);e=Math.max(e,this.points[d][0])}return(c+e)/2};a.prototype.getYCenter=function(){var c=this.points[0][1];var e=this.points[0][1];for(var d=1;d<this.points.length;d++){c=Math.min(c,this.points[d][1]);e=Math.max(e,this.points[d][1])}return(c+e)/2};a.prototype.getFloorColor=function(){return this.floorColor};a.prototype.setFloorColor=function(c){if(c!==this.floorColor&&(c==null||!(c===this.floorColor))){var d=this.floorColor;this.floorColor=c;this.firePropertyChange("FLOOR_COLOR",d,c)}};a.prototype.getFloorTexture=function(){return this.floorTexture};a.prototype.setFloorTexture=function(c){if(c!==this.floorTexture&&(c==null||!c.equals(this.floorTexture))){var d=this.floorTexture;this.floorTexture=c;this.firePropertyChange("FLOOR_TEXTURE",d,c)}};a.prototype.isFloorVisible=function(){return this.floorVisible};a.prototype.setFloorVisible=function(c){if(c!==this.floorVisible){this.floorVisible=c;this.firePropertyChange("FLOOR_VISIBLE",!c,c)}};a.prototype.getFloorShininess=function(){return this.floorShininess};a.prototype.setFloorShininess=function(d){if(d!==this.floorShininess){var c=this.floorShininess;this.floorShininess=d;this.firePropertyChange("FLOOR_SHININESS",c,d)}};a.prototype.getCeilingColor=function(){return this.ceilingColor};a.prototype.setCeilingColor=function(c){if(c!==this.ceilingColor&&(c==null||!(c===this.ceilingColor))){var d=this.ceilingColor;this.ceilingColor=c;this.firePropertyChange("CEILING_COLOR",d,c)}};a.prototype.getCeilingTexture=function(){return this.ceilingTexture};a.prototype.setCeilingTexture=function(c){if(c!==this.ceilingTexture&&(c==null||!c.equals(this.ceilingTexture))){var d=this.ceilingTexture;this.ceilingTexture=c;this.firePropertyChange("CEILING_TEXTURE",d,c)}};a.prototype.isCeilingVisible=function(){return this.ceilingVisible};a.prototype.setCeilingVisible=function(c){if(c!==this.ceilingVisible){this.ceilingVisible=c;this.firePropertyChange("CEILING_VISIBLE",!c,c)}};a.prototype.getCeilingShininess=function(){return this.ceilingShininess};a.prototype.setCeilingShininess=function(d){if(d!==this.ceilingShininess){var c=this.ceilingShininess;this.ceilingShininess=d;this.firePropertyChange("CEILING_SHININESS",c,d)}};a.prototype.getLevel=function(){return this.level};a.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};a.prototype.isAtLevel=function(c){return this.level===c||this.level!=null&&c!=null&&this.level.getElevation()===c.getElevation()&&this.level.getElevationIndex()<c.getElevationIndex()};a.prototype.getArea=function(){if(this.areaCache==null){var d=new java.awt.geom.Area(this.getShape());if(d.isSingular()){this.areaCache=Math.abs(this.getSignedArea(this.getPoints()))}else{var h=0;var g=([]);for(var f=d.getPathIterator(null);!f.isDone();){var e=[0,0];switch((f.currentSegment(e))){case java.awt.geom.PathIterator.SEG_MOVETO:(g.push(e)>0);break;case java.awt.geom.PathIterator.SEG_LINETO:(g.push(e)>0);break;case java.awt.geom.PathIterator.SEG_CLOSE:var c=g.slice(0);h+=this.getSignedArea(c);(g.length=0);break}f.next()}this.areaCache=h}}return this.areaCache};a.prototype.getSignedArea=function(e){var d=0;for(var c=1;c<e.length;c++){d+=e[c][0]*e[c-1][1];d-=e[c][1]*e[c-1][0]}d+=e[0][0]*e[e.length-1][1];d-=e[0][1]*e[e.length-1][0];return d/2};a.prototype.isClockwise=function(){return this.getSignedArea(this.getPoints())<0};a.prototype.isSingular=function(){return new java.awt.geom.Area(this.getShape()).isSingular()};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape().intersects(d)};a.prototype.containsPoint=function(c,e,d){return this.containsShapeAtWithMargin(this.getShape(),c,e,d)};a.prototype.getPointIndexAt=function(c,f,e){for(var d=0;d<this.points.length;d++){if(Math.abs(c-this.points[d][0])<=e&&Math.abs(f-this.points[d][1])<=e){return d}}return -1};a.prototype.isNameCenterPointAt=function(c,e,d){return Math.abs(c-this.getXCenter()-this.getNameXOffset())<=d&&Math.abs(e-this.getYCenter()-this.getNameYOffset())<=d};a.prototype.isAreaCenterPointAt=function(c,e,d){return Math.abs(c-this.getXCenter()-this.getAreaXOffset())<=d&&Math.abs(e-this.getYCenter()-this.getAreaYOffset())<=d};a.prototype.containsShapeAtWithMargin=function(d,c,f,e){if(e===0){return d.contains(c,f)}else{return d.intersects(c-e,f-e,2*e,2*e)}};a.prototype.getShape=function(){if(this.shapeCache==null){var d=new java.awt.geom.GeneralPath();d.moveTo(this.points[0][0],this.points[0][1]);for(var c=1;c<this.points.length;c++){d.lineTo(this.points[c][0],this.points[c][1])}d.closePath();this.shapeCache=d}return this.shapeCache};a.prototype.move=function(d,c){if(d!==0||c!==0){var f=this.getPoints();for(var e=0;e<f.length;e++){f[e][0]+=d;f[e][1]+=c}this.updatePoints(f)}};a.prototype.clone=function(){var d=this;var c=(function(g){if(b.prototype.clone!=undefined){return b.prototype.clone.call(d)}else{var e=Object.create(g);for(var f in g){if(g.hasOwnProperty(f)){e[f]=g[f]}}return e}})(this);c.level=null;return c};return a}(HomeObject));Room.__class="com.eteks.sweethome3d.model.Room";Room.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"];Room.__transients=["shapeCache","areaCache","propertyChangeSupport"];var Label=(function(a){__extends(b,a);function b(d,k,j,h){var f=this;if(((typeof d==="string")||d===null)&&((typeof k==="string")||k===null)&&((typeof j==="number")||j===null)&&((typeof h==="number")||h===null)){var g=arguments;f=a.call(this,d)||this;if(f.text===undefined){f.text=null}if(f.x===undefined){f.x=0}if(f.y===undefined){f.y=0}if(f.style===undefined){f.style=null}if(f.color===undefined){f.color=null}if(f.outlineColor===undefined){f.outlineColor=null}if(f.angle===undefined){f.angle=0}if(f.pitch===undefined){f.pitch=null}if(f.elevation===undefined){f.elevation=0}if(f.level===undefined){f.level=null}f.text=k;f.x=j;f.y=h}else{if(((typeof d==="string")||d===null)&&((typeof k==="number")||k===null)&&((typeof j==="number")||j===null)&&h===undefined){var g=arguments;var e=g[0];var l=g[1];var c=g[2];var n=arguments;var m=HomeObject.createId("label");f=a.call(this,m)||this;if(f.text===undefined){f.text=null}if(f.x===undefined){f.x=0}if(f.y===undefined){f.y=0}if(f.style===undefined){f.style=null}if(f.color===undefined){f.color=null}if(f.outlineColor===undefined){f.outlineColor=null}if(f.angle===undefined){f.angle=0}if(f.pitch===undefined){f.pitch=null}if(f.elevation===undefined){f.elevation=0}if(f.level===undefined){f.level=null}f.text=e;f.x=l;f.y=c;if(f.text===undefined){f.text=null}if(f.x===undefined){f.x=0}if(f.y===undefined){f.y=0}if(f.style===undefined){f.style=null}if(f.color===undefined){f.color=null}if(f.outlineColor===undefined){f.outlineColor=null}if(f.angle===undefined){f.angle=0}if(f.pitch===undefined){f.pitch=null}if(f.elevation===undefined){f.elevation=0}if(f.level===undefined){f.level=null}}else{throw new Error("invalid overload")}}return f}b.TWICE_PI_$LI$=function(){if(b.TWICE_PI==null){b.TWICE_PI=2*Math.PI}return b.TWICE_PI};b.prototype.getText=function(){return this.text};b.prototype.setText=function(d){if(d!==this.text&&(d==null||!(d===this.text))){var c=this.text;this.text=d;this.firePropertyChange("TEXT",c,d)}};b.prototype.getX=function(){return this.x};b.prototype.setX=function(c){if(c!==this.x){var d=this.x;this.x=c;this.firePropertyChange("X",d,c)}};b.prototype.getY=function(){return this.y};b.prototype.setY=function(d){if(d!==this.y){var c=this.y;this.y=d;this.firePropertyChange("Y",c,d)}};b.prototype.getGroundElevation=function(){if(this.level!=null){return this.elevation+this.level.getElevation()}else{return this.elevation}};b.prototype.getElevation=function(){return this.elevation};b.prototype.setElevation=function(d){if(d!==this.elevation){var c=this.elevation;this.elevation=d;this.firePropertyChange("ELEVATION",c,d)}};b.prototype.getStyle=function(){return this.style};b.prototype.setStyle=function(d){if(d!==this.style){var c=this.style;this.style=d;this.firePropertyChange("STYLE",c,d)}};b.prototype.getColor=function(){return this.color};b.prototype.setColor=function(c){if(c!==this.color){var d=this.color;this.color=c;this.firePropertyChange("COLOR",d,c)}};b.prototype.getOutlineColor=function(){return this.outlineColor};b.prototype.setOutlineColor=function(c){if(c!==this.outlineColor){var d=this.outlineColor;this.outlineColor=c;this.firePropertyChange("OUTLINE_COLOR",d,c)}};b.prototype.getAngle=function(){return this.angle};b.prototype.setAngle=function(d){d=((d%b.TWICE_PI_$LI$()+b.TWICE_PI_$LI$())%b.TWICE_PI_$LI$());if(d!==this.angle){var c=this.angle;this.angle=d;this.firePropertyChange("ANGLE",c,d)}};b.prototype.getPitch=function(){return this.pitch};b.prototype.setPitch=function(d){if(d!=null){d=((d%b.TWICE_PI_$LI$()+b.TWICE_PI_$LI$())%b.TWICE_PI_$LI$())}if(d!==this.pitch&&(d==null||!(d===this.pitch))){var c=this.pitch;this.pitch=d;this.firePropertyChange("PITCH",c,d)}};b.prototype.getLevel=function(){return this.level};b.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};b.prototype.isAtLevel=function(c){return this.level===c||this.level!=null&&c!=null&&this.level.getElevation()===c.getElevation()&&this.level.getElevationIndex()<c.getElevationIndex()};b.prototype.getPoints=function(){return[[this.x,this.y]]};b.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return d.contains(this.x,this.y)};b.prototype.containsPoint=function(c,e,d){return Math.abs(c-this.x)<=d&&Math.abs(e-this.y)<=d};b.prototype.move=function(d,c){this.setX(this.getX()+d);this.setY(this.getY()+c)};b.prototype.clone=function(){var d=this;var c=(function(g){if(a.prototype.clone!=undefined){return a.prototype.clone.call(d)}else{var e=Object.create(g);for(var f in g){if(g.hasOwnProperty(f)){e[f]=g[f]}}return e}})(this);c.level=null;return c};return b}(HomeObject));Label.__class="com.eteks.sweethome3d.model.Label";Label.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"];Label.__transients=["propertyChangeSupport"];var HomeEnvironment=(function(a){__extends(b,a);function b(J,s,t,c,q,F,K){var h=this;if(((typeof J==="string")||J===null)&&((typeof s==="number")||s===null)&&((t!=null&&t instanceof HomeTexture)||t===null)&&((typeof c==="number")||c===null)&&((q!=null&&q instanceof HomeTexture)||q===null)&&((typeof F==="number")||F===null)&&((typeof K==="number")||K===null)){var P=arguments;h=a.call(this,J)||this;if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}h.observerCameraElevationAdjusted=true;h.groundColor=s;h.groundTexture=t;h.skyColor=c;h.skyTexture=q;h.lightColor=F;h.ceilingLightColor=13684944;h.wallsAlpha=K;h.drawingMode=b.DrawingMode.FILL;h.photoWidth=400;h.photoHeight=300;h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO;h.videoWidth=320;h.videoAspectRatio=AspectRatio.RATIO_4_3;h.videoSpeed=2400/3600;h.videoFrameRate=25;h.cameraPath=[]}else{if(((typeof J==="number")||J===null)&&((s!=null&&s instanceof HomeTexture)||s===null)&&((typeof t==="number")||t===null)&&((c!=null&&c instanceof HomeTexture)||c===null)&&((typeof q==="number")||q===null)&&((typeof F==="number")||F===null)&&K===undefined){var P=arguments;var O=P[0];var o=P[1];var I=P[2];var r=P[3];var D=P[4];var g=P[5];var z=arguments;var S=HomeObject.createId("environment");h=a.call(this,S)||this;if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}h.observerCameraElevationAdjusted=true;h.groundColor=O;h.groundTexture=o;h.skyColor=I;h.skyTexture=r;h.lightColor=D;h.ceilingLightColor=13684944;h.wallsAlpha=g;h.drawingMode=b.DrawingMode.FILL;h.photoWidth=400;h.photoHeight=300;h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO;h.videoWidth=320;h.videoAspectRatio=AspectRatio.RATIO_4_3;h.videoSpeed=2400/3600;h.videoFrameRate=25;h.cameraPath=[];if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}}else{if(((typeof J==="number")||J===null)&&((s!=null&&s instanceof HomeTexture)||s===null)&&((typeof t==="number")||t===null)&&((typeof c==="number")||c===null)&&((typeof q==="number")||q===null)&&F===undefined&&K===undefined){var P=arguments;var N=P[0];var m=P[1];var H=P[2];var C=P[3];var f=P[4];var y=arguments;var p=null;var x=arguments;var R=HomeObject.createId("environment");h=a.call(this,R)||this;if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}h.observerCameraElevationAdjusted=true;h.groundColor=N;h.groundTexture=m;h.skyColor=H;h.skyTexture=p;h.lightColor=C;h.ceilingLightColor=13684944;h.wallsAlpha=f;h.drawingMode=b.DrawingMode.FILL;h.photoWidth=400;h.photoHeight=300;h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO;h.videoWidth=320;h.videoAspectRatio=AspectRatio.RATIO_4_3;h.videoSpeed=2400/3600;h.videoFrameRate=25;h.cameraPath=[];if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}}else{if(((typeof J==="string")||J===null)&&s===undefined&&t===undefined&&c===undefined&&q===undefined&&F===undefined&&K===undefined){var P=arguments;var w=arguments;var M=11053224;var l=null;var G=13427964;var n=null;var B=13684944;var e=0;h=a.call(this,J)||this;if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}h.observerCameraElevationAdjusted=true;h.groundColor=M;h.groundTexture=l;h.skyColor=G;h.skyTexture=n;h.lightColor=B;h.ceilingLightColor=13684944;h.wallsAlpha=e;h.drawingMode=b.DrawingMode.FILL;h.photoWidth=400;h.photoHeight=300;h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO;h.videoWidth=320;h.videoAspectRatio=AspectRatio.RATIO_4_3;h.videoSpeed=2400/3600;h.videoFrameRate=25;h.cameraPath=[];if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}}else{if(J===undefined&&s===undefined&&t===undefined&&c===undefined&&q===undefined&&F===undefined&&K===undefined){var P=arguments;var v=arguments;var Q=HomeObject.createId("environment");var u=arguments;var L=11053224;var j=null;var E=13427964;var k=null;var A=13684944;var d=0;h=a.call(this,Q)||this;if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}h.observerCameraElevationAdjusted=true;h.groundColor=L;h.groundTexture=j;h.skyColor=E;h.skyTexture=k;h.lightColor=A;h.ceilingLightColor=13684944;h.wallsAlpha=d;h.drawingMode=b.DrawingMode.FILL;h.photoWidth=400;h.photoHeight=300;h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO;h.videoWidth=320;h.videoAspectRatio=AspectRatio.RATIO_4_3;h.videoSpeed=2400/3600;h.videoFrameRate=25;h.cameraPath=[];if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}}else{throw new Error("invalid overload")}}}}}return h}b.prototype.isObserverCameraElevationAdjusted=function(){return this.observerCameraElevationAdjusted};b.prototype.setObserverCameraElevationAdjusted=function(c){if(this.observerCameraElevationAdjusted!==c){this.observerCameraElevationAdjusted=c;this.firePropertyChange("OBSERVER_CAMERA_ELEVATION_ADJUSTED",!c,c)}};b.prototype.getGroundColor=function(){return this.groundColor};b.prototype.setGroundColor=function(c){if(c!==this.groundColor){var d=this.groundColor;this.groundColor=c;this.firePropertyChange("GROUND_COLOR",d,c)}};b.prototype.getGroundTexture=function(){return this.groundTexture};b.prototype.setGroundTexture=function(d){if(d!==this.groundTexture){var c=this.groundTexture;this.groundTexture=d;this.firePropertyChange("GROUND_TEXTURE",c,d)}};b.prototype.isBackgroundImageVisibleOnGround3D=function(){return this.backgroundImageVisibleOnGround3D};b.prototype.setBackgroundImageVisibleOnGround3D=function(c){if(this.backgroundImageVisibleOnGround3D!==c){this.backgroundImageVisibleOnGround3D=c;this.firePropertyChange("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",!c,c)}};b.prototype.getSkyColor=function(){return this.skyColor};b.prototype.setSkyColor=function(d){if(d!==this.skyColor){var c=this.skyColor;this.skyColor=d;this.firePropertyChange("SKY_COLOR",c,d)}};b.prototype.getSkyTexture=function(){return this.skyTexture};b.prototype.setSkyTexture=function(c){if(c!==this.skyTexture){var d=this.skyTexture;this.skyTexture=c;this.firePropertyChange("SKY_TEXTURE",d,c)}};b.prototype.getLightColor=function(){return this.lightColor};b.prototype.setLightColor=function(c){if(c!==this.lightColor){var d=this.lightColor;this.lightColor=c;this.firePropertyChange("LIGHT_COLOR",d,c)}};b.prototype.getCeillingLightColor=function(){return this.ceilingLightColor};b.prototype.setCeillingLightColor=function(c){if(c!==this.ceilingLightColor){var d=this.ceilingLightColor;this.ceilingLightColor=c;this.firePropertyChange("CEILING_LIGHT_COLOR",d,c)}};b.prototype.getWallsAlpha=function(){return this.wallsAlpha};b.prototype.setWallsAlpha=function(d){if(d!==this.wallsAlpha){var c=this.wallsAlpha;this.wallsAlpha=d;this.firePropertyChange("WALLS_ALPHA",c,d)}};b.prototype.getDrawingMode=function(){return this.drawingMode};b.prototype.setDrawingMode=function(c){if(c!==this.drawingMode){var d=this.drawingMode;this.drawingMode=c;this.firePropertyChange("DRAWING_MODE",d,c)}};b.prototype.getSubpartSizeUnderLight=function(){return this.subpartSizeUnderLight};b.prototype.setSubpartSizeUnderLight=function(c){if(c!==this.subpartSizeUnderLight){var d=this.subpartSizeUnderLight;this.subpartSizeUnderLight=c;this.firePropertyChange("SUBPART_SIZE_UNDER_LIGHT",d,c)}};b.prototype.isAllLevelsVisible=function(){return this.allLevelsVisible};b.prototype.setAllLevelsVisible=function(c){if(c!==this.allLevelsVisible){this.allLevelsVisible=c;this.firePropertyChange("ALL_LEVELS_VISIBLE",!c,c)}};b.prototype.getPhotoWidth=function(){return this.photoWidth};b.prototype.setPhotoWidth=function(d){if(this.photoWidth!==d){var c=this.photoWidth;this.photoWidth=d;this.firePropertyChange("PHOTO_WIDTH",c,d)}};b.prototype.getPhotoHeight=function(){return this.photoHeight};b.prototype.setPhotoHeight=function(c){if(this.photoHeight!==c){var d=this.photoHeight;this.photoHeight=c;this.firePropertyChange("PHOTO_HEIGHT",d,c)}};b.prototype.getPhotoAspectRatio=function(){return this.photoAspectRatio};b.prototype.setPhotoAspectRatio=function(c){if(this.photoAspectRatio!==c){var d=this.photoAspectRatio;this.photoAspectRatio=c;this.photoAspectRatioName=AspectRatio[this.photoAspectRatio];this.firePropertyChange("PHOTO_ASPECT_RATIO",d,c)}};b.prototype.getPhotoQuality=function(){return this.photoQuality};b.prototype.setPhotoQuality=function(c){if(this.photoQuality!==c){var d=this.photoQuality;this.photoQuality=c;this.firePropertyChange("PHOTO_QUALITY",d,c)}};b.prototype.getVideoWidth=function(){return this.videoWidth};b.prototype.setVideoWidth=function(d){if(this.videoWidth!==d){var c=this.videoWidth;this.videoWidth=d;this.firePropertyChange("VIDEO_WIDTH",c,d)}};b.prototype.getVideoHeight=function(){return Math.round(this.getVideoWidth()/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.getVideoAspectRatio()])};b.prototype.getVideoAspectRatio=function(){return this.videoAspectRatio};b.prototype.setVideoAspectRatio=function(d){if(this.videoAspectRatio!==d){if({FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[d]==null){throw new IllegalArgumentException("Unsupported aspect ratio "+d)}var c=this.videoAspectRatio;this.videoAspectRatio=d;this.videoAspectRatioName=AspectRatio[this.videoAspectRatio];this.firePropertyChange("VIDEO_ASPECT_RATIO",c,d)}};b.prototype.getVideoQuality=function(){return this.videoQuality};b.prototype.setVideoQuality=function(c){if(this.videoQuality!==c){var d=this.videoQuality;this.videoQuality=c;this.firePropertyChange("VIDEO_QUALITY",d,c)}};b.prototype.getVideoSpeed=function(){return this.videoSpeed};b.prototype.setVideoSpeed=function(c){if(this.videoSpeed!==c){var d=this.videoSpeed;this.videoSpeed=c;this.firePropertyChange("VIDEO_SPEED",d,c)}};b.prototype.getVideoFrameRate=function(){return this.videoFrameRate};b.prototype.setVideoFrameRate=function(d){if(this.videoFrameRate!==d){var c=this.videoFrameRate;this.videoFrameRate=d;this.firePropertyChange("VIDEO_FRAME_RATE",c,d)}};b.prototype.getVideoCameraPath=function(){return this.cameraPath.slice(0)};b.prototype.setVideoCameraPath=function(c){if(this.cameraPath!==c){var d=this.cameraPath;if(c!=null){this.cameraPath=(c.slice(0))}else{this.cameraPath=[]}this.firePropertyChange("VIDEO_CAMERA_PATH",d,c)}};b.prototype.clone=function(){var f=this;var e=(function(j){if(a.prototype.clone!=undefined){return a.prototype.clone.call(f)}else{var g=Object.create(j);for(var h in j){if(j.hasOwnProperty(h)){g[h]=j[h]}}return g}})(this);e.cameraPath=([]);for(var c=0;c<this.cameraPath.length;c++){var d=this.cameraPath[c];(e.cameraPath.push((function(j){if(j.clone!=undefined){return j.clone()}else{var g=Object.create(j);for(var h in j){if(j.hasOwnProperty(h)){g[h]=j[h]}}return g}})(d))>0)}return e};return b}(HomeObject));HomeEnvironment.__class="com.eteks.sweethome3d.model.HomeEnvironment";(function(a){var b;(function(c){c[c.FILL=0]="FILL";c[c.OUTLINE=1]="OUTLINE";c[c.FILL_AND_OUTLINE=2]="FILL_AND_OUTLINE"})(b=a.DrawingMode||(a.DrawingMode={}))})(HomeEnvironment||(HomeEnvironment={}));HomeEnvironment.__transients=["photoAspectRatio","videoAspectRatio","propertyChangeSupport"];var HomePieceOfFurniture=(function(b){__extends(a,b);function a(k,e){var j=this;if(((typeof k==="string")||k===null)&&((e!=null&&(e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.PieceOfFurniture")>=0))||e===null)){var g=arguments;j=b.call(this,k)||this;if(j.catalogId===undefined){j.catalogId=null}if(j.name===undefined){j.name=null}if(j.nameVisible===undefined){j.nameVisible=false}if(j.nameXOffset===undefined){j.nameXOffset=0}if(j.nameYOffset===undefined){j.nameYOffset=0}if(j.nameStyle===undefined){j.nameStyle=null}if(j.nameAngle===undefined){j.nameAngle=0}if(j.description===undefined){j.description=null}if(j.information===undefined){j.information=null}if(j.icon===undefined){j.icon=null}if(j.planIcon===undefined){j.planIcon=null}if(j.model===undefined){j.model=null}if(j.modelSize===undefined){j.modelSize=null}if(j.width===undefined){j.width=0}if(j.widthInPlan===undefined){j.widthInPlan=0}if(j.depth===undefined){j.depth=0}if(j.depthInPlan===undefined){j.depthInPlan=0}if(j.height===undefined){j.height=0}if(j.heightInPlan===undefined){j.heightInPlan=0}if(j.elevation===undefined){j.elevation=0}if(j.dropOnTopElevation===undefined){j.dropOnTopElevation=0}if(j.movable===undefined){j.movable=false}if(j.doorOrWindow===undefined){j.doorOrWindow=false}if(j.modelMaterials===undefined){j.modelMaterials=null}if(j.color===undefined){j.color=null}if(j.texture===undefined){j.texture=null}if(j.shininess===undefined){j.shininess=null}if(j.modelRotation===undefined){j.modelRotation=null}if(j.modelCenteredAtOrigin===undefined){j.modelCenteredAtOrigin=false}if(j.modelTransformations===undefined){j.modelTransformations=null}if(j.staircaseCutOutShape===undefined){j.staircaseCutOutShape=null}if(j.creator===undefined){j.creator=null}if(j.backFaceShown===undefined){j.backFaceShown=false}if(j.resizable===undefined){j.resizable=false}if(j.deformable===undefined){j.deformable=false}if(j.texturable===undefined){j.texturable=false}if(j.horizontallyRotatable===undefined){j.horizontallyRotatable=false}if(j.price===undefined){j.price=null}if(j.valueAddedTaxPercentage===undefined){j.valueAddedTaxPercentage=null}if(j.currency===undefined){j.currency=null}if(j.visible===undefined){j.visible=false}if(j.x===undefined){j.x=0}if(j.y===undefined){j.y=0}if(j.angle===undefined){j.angle=0}if(j.pitch===undefined){j.pitch=0}if(j.roll===undefined){j.roll=0}if(j.modelMirrored===undefined){j.modelMirrored=false}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}j.name=e.getName();j.description=e.getDescription();j.information=e.getInformation();j.icon=e.getIcon();j.planIcon=e.getPlanIcon();j.model=e.getModel();j.modelSize=e.getModelSize();j.width=e.getWidth();j.depth=e.getDepth();j.height=e.getHeight();j.elevation=e.getElevation();j.dropOnTopElevation=e.getDropOnTopElevation();j.movable=e.isMovable();j.doorOrWindow=e.isDoorOrWindow();j.color=e.getColor();j.modelRotation=e.getModelRotation();j.staircaseCutOutShape=e.getStaircaseCutOutShape();j.creator=e.getCreator();j.backFaceShown=e.isBackFaceShown();j.resizable=e.isResizable();j.deformable=e.isDeformable();j.texturable=e.isTexturable();j.horizontallyRotatable=e.isHorizontallyRotatable();j.price=e.getPrice();j.valueAddedTaxPercentage=e.getValueAddedTaxPercentage();j.currency=e.getCurrency();if(e!=null&&e instanceof a){var f=e;j.catalogId=f.getCatalogId();j.nameVisible=f.isNameVisible();j.nameXOffset=f.getNameXOffset();j.nameYOffset=f.getNameYOffset();j.nameAngle=f.getNameAngle();j.nameStyle=f.getNameStyle();j.visible=f.isVisible();j.widthInPlan=f.getWidthInPlan();j.depthInPlan=f.getDepthInPlan();j.heightInPlan=f.getHeightInPlan();j.modelCenteredAtOrigin=f.isModelCenteredAtOrigin();j.modelTransformations=f.getModelTransformations();j.angle=f.getAngle();j.pitch=f.getPitch();j.roll=f.getRoll();j.x=f.getX();j.y=f.getY();j.modelMirrored=f.isModelMirrored();j.texture=f.getTexture();j.shininess=f.getShininess();j.modelMaterials=f.getModelMaterials()}else{if(e!=null&&e instanceof CatalogPieceOfFurniture){j.catalogId=e.getId()}j.visible=true;j.widthInPlan=j.width;j.depthInPlan=j.depth;j.heightInPlan=j.height;j.modelCenteredAtOrigin=true;j.x=j.width/2;j.y=j.depth/2}}else{if(((k!=null&&(k.constructor!=null&&k.constructor.__interfaces!=null&&k.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.PieceOfFurniture")>=0))||k===null)&&e===undefined){var g=arguments;var d=g[0];var c=arguments;var h=HomeObject.createId("pieceOfFurniture");j=b.call(this,h)||this;if(j.catalogId===undefined){j.catalogId=null}if(j.name===undefined){j.name=null}if(j.nameVisible===undefined){j.nameVisible=false}if(j.nameXOffset===undefined){j.nameXOffset=0}if(j.nameYOffset===undefined){j.nameYOffset=0}if(j.nameStyle===undefined){j.nameStyle=null}if(j.nameAngle===undefined){j.nameAngle=0}if(j.description===undefined){j.description=null}if(j.information===undefined){j.information=null}if(j.icon===undefined){j.icon=null}if(j.planIcon===undefined){j.planIcon=null}if(j.model===undefined){j.model=null}if(j.modelSize===undefined){j.modelSize=null}if(j.width===undefined){j.width=0}if(j.widthInPlan===undefined){j.widthInPlan=0}if(j.depth===undefined){j.depth=0}if(j.depthInPlan===undefined){j.depthInPlan=0}if(j.height===undefined){j.height=0}if(j.heightInPlan===undefined){j.heightInPlan=0}if(j.elevation===undefined){j.elevation=0}if(j.dropOnTopElevation===undefined){j.dropOnTopElevation=0}if(j.movable===undefined){j.movable=false}if(j.doorOrWindow===undefined){j.doorOrWindow=false}if(j.modelMaterials===undefined){j.modelMaterials=null}if(j.color===undefined){j.color=null}if(j.texture===undefined){j.texture=null}if(j.shininess===undefined){j.shininess=null}if(j.modelRotation===undefined){j.modelRotation=null}if(j.modelCenteredAtOrigin===undefined){j.modelCenteredAtOrigin=false}if(j.modelTransformations===undefined){j.modelTransformations=null}if(j.staircaseCutOutShape===undefined){j.staircaseCutOutShape=null}if(j.creator===undefined){j.creator=null}if(j.backFaceShown===undefined){j.backFaceShown=false}if(j.resizable===undefined){j.resizable=false}if(j.deformable===undefined){j.deformable=false}if(j.texturable===undefined){j.texturable=false}if(j.horizontallyRotatable===undefined){j.horizontallyRotatable=false}if(j.price===undefined){j.price=null}if(j.valueAddedTaxPercentage===undefined){j.valueAddedTaxPercentage=null}if(j.currency===undefined){j.currency=null}if(j.visible===undefined){j.visible=false}if(j.x===undefined){j.x=0}if(j.y===undefined){j.y=0}if(j.angle===undefined){j.angle=0}if(j.pitch===undefined){j.pitch=0}if(j.roll===undefined){j.roll=0}if(j.modelMirrored===undefined){j.modelMirrored=false}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}j.name=d.getName();j.description=d.getDescription();j.information=d.getInformation();j.icon=d.getIcon();j.planIcon=d.getPlanIcon();j.model=d.getModel();j.modelSize=d.getModelSize();j.width=d.getWidth();j.depth=d.getDepth();j.height=d.getHeight();j.elevation=d.getElevation();j.dropOnTopElevation=d.getDropOnTopElevation();j.movable=d.isMovable();j.doorOrWindow=d.isDoorOrWindow();j.color=d.getColor();j.modelRotation=d.getModelRotation();j.staircaseCutOutShape=d.getStaircaseCutOutShape();j.creator=d.getCreator();j.backFaceShown=d.isBackFaceShown();j.resizable=d.isResizable();j.deformable=d.isDeformable();j.texturable=d.isTexturable();j.horizontallyRotatable=d.isHorizontallyRotatable();j.price=d.getPrice();j.valueAddedTaxPercentage=d.getValueAddedTaxPercentage();j.currency=d.getCurrency();if(d!=null&&d instanceof a){var f=d;j.catalogId=f.getCatalogId();j.nameVisible=f.isNameVisible();j.nameXOffset=f.getNameXOffset();j.nameYOffset=f.getNameYOffset();j.nameAngle=f.getNameAngle();j.nameStyle=f.getNameStyle();j.visible=f.isVisible();j.widthInPlan=f.getWidthInPlan();j.depthInPlan=f.getDepthInPlan();j.heightInPlan=f.getHeightInPlan();j.modelCenteredAtOrigin=f.isModelCenteredAtOrigin();j.modelTransformations=f.getModelTransformations();j.angle=f.getAngle();j.pitch=f.getPitch();j.roll=f.getRoll();j.x=f.getX();j.y=f.getY();j.modelMirrored=f.isModelMirrored();j.texture=f.getTexture();j.shininess=f.getShininess();j.modelMaterials=f.getModelMaterials()}else{if(d!=null&&d instanceof CatalogPieceOfFurniture){j.catalogId=d.getId()}j.visible=true;j.widthInPlan=j.width;j.depthInPlan=j.depth;j.heightInPlan=j.height;j.modelCenteredAtOrigin=true;j.x=j.width/2;j.y=j.depth/2}if(j.catalogId===undefined){j.catalogId=null}if(j.name===undefined){j.name=null}if(j.nameVisible===undefined){j.nameVisible=false}if(j.nameXOffset===undefined){j.nameXOffset=0}if(j.nameYOffset===undefined){j.nameYOffset=0}if(j.nameStyle===undefined){j.nameStyle=null}if(j.nameAngle===undefined){j.nameAngle=0}if(j.description===undefined){j.description=null}if(j.information===undefined){j.information=null}if(j.icon===undefined){j.icon=null}if(j.planIcon===undefined){j.planIcon=null}if(j.model===undefined){j.model=null}if(j.modelSize===undefined){j.modelSize=null}if(j.width===undefined){j.width=0}if(j.widthInPlan===undefined){j.widthInPlan=0}if(j.depth===undefined){j.depth=0}if(j.depthInPlan===undefined){j.depthInPlan=0}if(j.height===undefined){j.height=0}if(j.heightInPlan===undefined){j.heightInPlan=0}if(j.elevation===undefined){j.elevation=0}if(j.dropOnTopElevation===undefined){j.dropOnTopElevation=0}if(j.movable===undefined){j.movable=false}if(j.doorOrWindow===undefined){j.doorOrWindow=false}if(j.modelMaterials===undefined){j.modelMaterials=null}if(j.color===undefined){j.color=null}if(j.texture===undefined){j.texture=null}if(j.shininess===undefined){j.shininess=null}if(j.modelRotation===undefined){j.modelRotation=null}if(j.modelCenteredAtOrigin===undefined){j.modelCenteredAtOrigin=false}if(j.modelTransformations===undefined){j.modelTransformations=null}if(j.staircaseCutOutShape===undefined){j.staircaseCutOutShape=null}if(j.creator===undefined){j.creator=null}if(j.backFaceShown===undefined){j.backFaceShown=false}if(j.resizable===undefined){j.resizable=false}if(j.deformable===undefined){j.deformable=false}if(j.texturable===undefined){j.texturable=false}if(j.horizontallyRotatable===undefined){j.horizontallyRotatable=false}if(j.price===undefined){j.price=null}if(j.valueAddedTaxPercentage===undefined){j.valueAddedTaxPercentage=null}if(j.currency===undefined){j.currency=null}if(j.visible===undefined){j.visible=false}if(j.x===undefined){j.x=0}if(j.y===undefined){j.y=0}if(j.angle===undefined){j.angle=0}if(j.pitch===undefined){j.pitch=0}if(j.roll===undefined){j.roll=0}if(j.modelMirrored===undefined){j.modelMirrored=false}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}}else{throw new Error("invalid overload")}}return j}a.__static_initialize=function(){if(!a.__static_initialized){a.__static_initialized=true;a.__static_initializer_0()}};a.TWICE_PI_$LI$=function(){a.__static_initialize();if(a.TWICE_PI==null){a.TWICE_PI=2*Math.PI}return a.TWICE_PI};a.STRAIGHT_WALL_ANGLE_MARGIN_$LI$=function(){a.__static_initialize();if(a.STRAIGHT_WALL_ANGLE_MARGIN==null){a.STRAIGHT_WALL_ANGLE_MARGIN=(function(c){return c*Math.PI/180})(1)}return a.STRAIGHT_WALL_ANGLE_MARGIN};a.ROUND_WALL_ANGLE_MARGIN_$LI$=function(){a.__static_initialize();if(a.ROUND_WALL_ANGLE_MARGIN==null){a.ROUND_WALL_ANGLE_MARGIN=(function(c){return c*Math.PI/180})(10)}return a.ROUND_WALL_ANGLE_MARGIN};a.SORTABLE_PROPERTY_COMPARATORS_$LI$=function(){a.__static_initialize();return a.SORTABLE_PROPERTY_COMPARATORS};a.__static_initializer_0=function(){var c={compare:function(e,d){return e.toString().localeCompare(d.toString())},equals:function(e,d){return e.toString().localeCompare(d.toString())===0}};a.SORTABLE_PROPERTY_COMPARATORS=({});(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"CATALOG_ID",new a.HomePieceOfFurniture$0(c));(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"NAME",new a.HomePieceOfFurniture$1(c));(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"WIDTH",new a.HomePieceOfFurniture$2());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"HEIGHT",new a.HomePieceOfFurniture$3());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"DEPTH",new a.HomePieceOfFurniture$4());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"MOVABLE",new a.HomePieceOfFurniture$5());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"DOOR_OR_WINDOW",new a.HomePieceOfFurniture$6());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"COLOR",new a.HomePieceOfFurniture$7());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"TEXTURE",new a.HomePieceOfFurniture$8(c));(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"VISIBLE",new a.HomePieceOfFurniture$9());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"X",new a.HomePieceOfFurniture$10());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"Y",new a.HomePieceOfFurniture$11());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"ELEVATION",new a.HomePieceOfFurniture$12());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"ANGLE",new a.HomePieceOfFurniture$13());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"MODEL_SIZE",new a.HomePieceOfFurniture$14());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"CREATOR",new a.HomePieceOfFurniture$15(c));(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"LEVEL",new a.HomePieceOfFurniture$16());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"PRICE",new a.HomePieceOfFurniture$17());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"VALUE_ADDED_TAX_PERCENTAGE",new a.HomePieceOfFurniture$18());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"VALUE_ADDED_TAX",new a.HomePieceOfFurniture$19());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"PRICE_VALUE_ADDED_TAX_INCLUDED",new a.HomePieceOfFurniture$20())};a.compare$float$float=function(d,c){return(d-c)};a.compare$boolean$boolean=function(d,c){return d===c?0:(d?-1:1)};a.compare$java_math_BigDecimal$java_math_BigDecimal=function(d,c){if(d===c){return 0}else{if(d==null){return -1}else{if(c==null){return 1}else{return d.cmp(c)}}}};a.compare=function(d,c){if(((d!=null&&d instanceof Big)||d===null)&&((c!=null&&c instanceof Big)||c===null)){return a.compare$java_math_BigDecimal$java_math_BigDecimal(d,c)}else{if(((d!=null&&d instanceof Level)||d===null)&&((c!=null&&c instanceof Level)||c===null)){return a.compare$com_eteks_sweethome3d_model_Level$com_eteks_sweethome3d_model_Level(d,c)}else{if(((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)){return a.compare$float$float(d,c)}else{if(((typeof d==="boolean")||d===null)&&((typeof c==="boolean")||c===null)){return a.compare$boolean$boolean(d,c)}else{throw new Error("invalid overload")}}}}};a.compare$com_eteks_sweethome3d_model_Level$com_eteks_sweethome3d_model_Level=function(d,c){if(d===c){return 0}else{if(d==null){return -1}else{if(c==null){return 1}else{return(d.getElevation()-c.getElevation())}}}};a.getComparableModelSize=function(g){if(g!=null&&g instanceof HomeFurnitureGroup){var f=null;var h=g.getFurniture();for(var e=0;e<h.length;e++){var c=h[e];var d=a.getComparableModelSize(c);if(d!=null&&(f==null||f<d)){f=d}}return f}else{return g.modelSize}};a.prototype.getCatalogId=function(){return this.catalogId};a.prototype.setCatalogId=function(d){if(d!==this.catalogId&&(d==null||!(d===this.catalogId))){var c=this.catalogId;this.catalogId=d;this.firePropertyChange("CATALOG_ID",c,d)}};a.prototype.getName=function(){return this.name};a.prototype.setName=function(c){if(c!==this.name&&(c==null||!(c===this.name))){var d=this.name;this.name=c;this.firePropertyChange("NAME",d,c)}};a.prototype.isNameVisible=function(){return this.nameVisible};a.prototype.setNameVisible=function(c){if(c!==this.nameVisible){this.nameVisible=c;this.firePropertyChange("NAME_VISIBLE",!c,c)}};a.prototype.getNameXOffset=function(){return this.nameXOffset};a.prototype.setNameXOffset=function(c){if(c!==this.nameXOffset){var d=this.nameXOffset;this.nameXOffset=c;this.firePropertyChange("NAME_X_OFFSET",d,c)}};a.prototype.getNameYOffset=function(){return this.nameYOffset};a.prototype.setNameYOffset=function(c){if(c!==this.nameYOffset){var d=this.nameYOffset;this.nameYOffset=c;this.firePropertyChange("NAME_Y_OFFSET",d,c)}};a.prototype.getNameStyle=function(){return this.nameStyle};a.prototype.setNameStyle=function(d){if(d!==this.nameStyle){var c=this.nameStyle;this.nameStyle=d;this.firePropertyChange("NAME_STYLE",c,d)}};a.prototype.getNameAngle=function(){return this.nameAngle};a.prototype.setNameAngle=function(c){c=((c%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(c!==this.nameAngle){var d=this.nameAngle;this.nameAngle=c;this.firePropertyChange("NAME_ANGLE",d,c)}};a.prototype.getDescription=function(){return this.description};a.prototype.setDescription=function(c){if(c!==this.description&&(c==null||!(c===this.description))){var d=this.description;this.description=c;this.firePropertyChange("DESCRIPTION",d,c)}};a.prototype.getInformation=function(){return this.information};a.prototype.setInformation=function(c){if(c!==this.information&&(c==null||!(c===this.information))){var d=this.information;this.information=c;this.firePropertyChange("INFORMATION",d,c)}};a.prototype.getDepth=function(){return this.depth};a.prototype.setDepth=function(d){if(this.isResizable()){if(d!==this.depth){var c=this.depth;this.depth=d;this.shapeCache=null;this.firePropertyChange("DEPTH",c,d)}}else{throw new IllegalStateException("Piece isn't resizable")}};a.prototype.getDepthInPlan=function(){return this.depthInPlan};a.prototype.setDepthInPlan=function(c){if(c!==this.depthInPlan){var d=this.depthInPlan;this.depthInPlan=c;this.shapeCache=null;this.firePropertyChange("DEPTH_IN_PLAN",d,c)}};a.prototype.getHeight=function(){return this.height};a.prototype.setHeight=function(c){if(this.isResizable()){if(c!==this.height){var d=this.height;this.height=c;this.firePropertyChange("HEIGHT",d,c)}}else{throw new IllegalStateException("Piece isn't resizable")}};a.prototype.getHeightInPlan=function(){return this.heightInPlan};a.prototype.setHeightInPlan=function(c){if(c!==this.heightInPlan){var d=this.heightInPlan;this.heightInPlan=c;this.firePropertyChange("HEIGHT_IN_PLAN",d,c)}};a.prototype.getWidth=function(){return this.width};a.prototype.setWidth=function(d){if(this.isResizable()){if(d!==this.width){var c=this.width;this.width=d;this.shapeCache=null;this.firePropertyChange("WIDTH",c,d)}}else{throw new IllegalStateException("Piece isn't resizable")}};a.prototype.getWidthInPlan=function(){return this.widthInPlan};a.prototype.setWidthInPlan=function(d){if(d!==this.widthInPlan){var c=this.widthInPlan;this.widthInPlan=d;this.shapeCache=null;this.firePropertyChange("WIDTH_IN_PLAN",c,d)}};a.prototype.scale=function(c){this.setWidth(this.getWidth()*c);this.setDepth(this.getDepth()*c);this.setHeight(this.getHeight()*c)};a.prototype.getElevation=function(){return this.elevation};a.prototype.getDropOnTopElevation=function(){return this.dropOnTopElevation};a.prototype.getGroundElevation=function(){if(this.level!=null){return this.elevation+this.level.getElevation()}else{return this.elevation}};a.prototype.setElevation=function(d){if(d!==this.elevation){var c=this.elevation;this.elevation=d;this.firePropertyChange("ELEVATION",c,d)}};a.prototype.isMovable=function(){return this.movable};a.prototype.setMovable=function(c){if(c!==this.movable){this.movable=c;this.firePropertyChange("MOVABLE",!c,c)}};a.prototype.isDoorOrWindow=function(){return this.doorOrWindow};a.prototype.getIcon=function(){return this.icon};a.prototype.setIcon=function(c){if(c!==this.icon&&(c==null||!(function(f,e){if(f&&f.equals){return f.equals(e)}else{return f===e}})(c,this.icon))){var d=this.icon;this.icon=c;this.firePropertyChange("ICON",d,c)}};a.prototype.getPlanIcon=function(){return this.planIcon};a.prototype.setPlanIcon=function(c){if(c!==this.planIcon&&(c==null||!(function(f,e){if(f&&f.equals){return f.equals(e)}else{return f===e}})(c,this.planIcon))){var d=this.planIcon;this.planIcon=c;this.firePropertyChange("PLAN_ICON",d,c)}};a.prototype.getModel=function(){return this.model};a.prototype.setModel=function(c){if(c!==this.model&&(c==null||!(function(f,e){if(f&&f.equals){return f.equals(e)}else{return f===e}})(c,this.model))){var d=this.model;this.model=c;this.firePropertyChange("MODEL",d,c)}};a.prototype.getModelSize=function(){return this.modelSize};a.prototype.setModelSize=function(c){this.modelSize=c};a.prototype.getModelMaterials=function(){if(this.modelMaterials!=null){return this.modelMaterials.slice(0)}else{return null}};a.prototype.setModelMaterials=function(d){if(this.isTexturable()){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.modelMaterials)){var c=this.modelMaterials;this.modelMaterials=d!=null?d.slice(0):null;this.firePropertyChange("MODEL_MATERIALS",c,d)}}else{throw new IllegalStateException("Piece isn't texturable")}};a.prototype.getColor=function(){return this.color};a.prototype.setColor=function(c){if(this.isTexturable()){if(c!==this.color&&(c==null||!(c===this.color))){var d=this.color;this.color=c;this.firePropertyChange("COLOR",d,c)}}else{throw new IllegalStateException("Piece isn't texturable")}};a.prototype.getTexture=function(){return this.texture};a.prototype.setTexture=function(d){if(this.isTexturable()){if(d!==this.texture&&(d==null||!d.equals(this.texture))){var c=this.texture;this.texture=d;this.firePropertyChange("TEXTURE",c,d)}}else{throw new IllegalStateException("Piece isn't texturable")}};a.prototype.getShininess=function(){return this.shininess};a.prototype.setShininess=function(d){if(this.isTexturable()){if(d!==this.shininess&&(d==null||!(d===this.shininess))){var c=this.shininess;this.shininess=d;this.firePropertyChange("SHININESS",c,d)}}else{throw new IllegalStateException("Piece isn't texturable")}};a.prototype.isResizable=function(){return this.resizable};a.prototype.isDeformable=function(){return this.deformable};a.prototype.isWidthDepthDeformable=function(){return this.isDeformable()};a.prototype.isTexturable=function(){return this.texturable};a.prototype.isHorizontallyRotatable=function(){return this.horizontallyRotatable};a.prototype.getPrice=function(){return this.price};a.prototype.setPrice=function(d){if(d!==this.price&&(d==null||!((this.price)!=null?d.eq(this.price):(d===(this.price))))){var c=this.price;this.price=d;this.firePropertyChange("PRICE",c,d)}};a.prototype.getValueAddedTaxPercentage=function(){return this.valueAddedTaxPercentage};a.prototype.setValueAddedTaxPercentage=function(d){if(d!==this.valueAddedTaxPercentage&&(d==null||!((this.valueAddedTaxPercentage)!=null?d.eq(this.valueAddedTaxPercentage):(d===(this.valueAddedTaxPercentage))))){var c=this.valueAddedTaxPercentage;this.valueAddedTaxPercentage=d;this.firePropertyChange("VALUE_ADDED_TAX_PERCENTAGE",c,d)}};a.prototype.getValueAddedTax=function(){if(this.price!=null&&this.valueAddedTaxPercentage!=null){return this.price.times(this.valueAddedTaxPercentage).round(2)}else{return null}};a.prototype.getPriceValueAddedTaxIncluded=function(){if(this.price!=null&&this.valueAddedTaxPercentage!=null){return this.price.plus(this.getValueAddedTax())}else{return this.price}};a.prototype.getCurrency=function(){return this.currency};a.prototype.setCurrency=function(c){if(c!==this.currency&&(c==null||!(c===this.currency))){var d=this.currency;this.currency=c;this.firePropertyChange("CURRENCY",d,c)}};a.prototype.isVisible=function(){return this.visible};a.prototype.setVisible=function(c){if(c!==this.visible){this.visible=c;this.firePropertyChange("VISIBLE",!c,c)}};a.prototype.getX=function(){return this.x};a.prototype.setX=function(c){if(c!==this.x){var d=this.x;this.x=c;this.shapeCache=null;this.firePropertyChange("X",d,c)}};a.prototype.getY=function(){return this.y};a.prototype.setY=function(d){if(d!==this.y){var c=this.y;this.y=d;this.shapeCache=null;this.firePropertyChange("Y",c,d)}};a.prototype.getAngle=function(){return this.angle};a.prototype.setAngle=function(d){d=((d%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(d!==this.angle){var c=this.angle;this.angle=d;this.shapeCache=null;this.firePropertyChange("ANGLE",c,d)}};a.prototype.getPitch=function(){return this.pitch};a.prototype.setPitch=function(d){if(this.isHorizontallyRotatable()){d=((d%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(d!==this.pitch){var c=this.pitch;this.pitch=d;this.shapeCache=null;this.firePropertyChange("PITCH",c,d)}}else{throw new IllegalStateException("Piece can't be rotated around an horizontal axis")}};a.prototype.getRoll=function(){return this.roll};a.prototype.setRoll=function(c){if(this.isHorizontallyRotatable()){c=((c%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(c!==this.roll){var d=this.roll;this.roll=c;this.shapeCache=null;this.firePropertyChange("ROLL",d,c)}}else{throw new IllegalStateException("Piece can't be rotated around an horizontal axis")}};a.prototype.isHorizontallyRotated=function(){return this.roll!==0||this.pitch!==0};a.prototype.getModelRotation=function(){return CatalogPieceOfFurniture.deepClone(this.modelRotation)};a.prototype.setModelRotation=function(c){if(!(JSON.stringify(c)===JSON.stringify(this.modelRotation))){var d=CatalogPieceOfFurniture.deepClone(this.modelRotation);this.modelRotation=CatalogPieceOfFurniture.deepClone(c);this.firePropertyChange("MODEL_ROTATION",d,c)}};a.prototype.isModelMirrored=function(){return this.modelMirrored};a.prototype.setModelMirrored=function(c){if(this.isResizable()){if(c!==this.modelMirrored){this.modelMirrored=c;this.firePropertyChange("MODEL_MIRRORED",!c,c)}}else{throw new IllegalStateException("Piece isn't resizable")}};a.prototype.isModelCenteredAtOrigin=function(){return this.modelCenteredAtOrigin};a.prototype.setModelCenteredAtOrigin=function(c){this.modelCenteredAtOrigin=c};a.prototype.isBackFaceShown=function(){return this.backFaceShown};a.prototype.setBackFaceShown=function(c){if(c!==this.backFaceShown){this.backFaceShown=c;this.firePropertyChange("BACK_FACE_SHOWN",!c,c)}};a.prototype.getModelTransformations=function(){if(this.modelTransformations!=null){return this.modelTransformations.slice(0)}else{return null}};a.prototype.setModelTransformations=function(d){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.modelTransformations)){var c=this.modelTransformations;this.modelTransformations=d!=null&&d.length>0?d.slice(0):null;this.firePropertyChange("MODEL_MATERIALS",c,d)}};a.prototype.getStaircaseCutOutShape=function(){return this.staircaseCutOutShape};a.prototype.setStaircaseCutOutShape=function(d){if(d!==this.staircaseCutOutShape&&(d==null||!(d===this.staircaseCutOutShape))){var c=this.staircaseCutOutShape;this.staircaseCutOutShape=d;this.firePropertyChange("STAIRCASE_CUT_OUT_SHAPE",c,d)}};a.prototype.getCreator=function(){return this.creator};a.prototype.setCreator=function(d){if(d!==this.creator&&(d==null||!(d===this.creator))){var c=this.creator;this.creator=d;this.firePropertyChange("CREATOR",c,d)}};a.prototype.getLevel=function(){return this.level};a.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};a.prototype.isAtLevel=function(e){if(this.level===e){return true}else{if(this.level!=null&&e!=null){var c=this.level.getElevation();var d=e.getElevation();return c===d&&this.level.getElevationIndex()<e.getElevationIndex()||c<d&&this.isTopAtLevel(e)}else{return false}}};a.prototype.isTopAtLevel=function(d){var c=this.level.getElevation()+this.elevation+this.heightInPlan;if(this.staircaseCutOutShape!=null){return c>=d.getElevation()}else{return c>d.getElevation()}};a.prototype.getPoints=function(){var c=(function(g){var f=function(j){if(j.length===0){return 0}else{var k=[];for(var h=0;h<j[0];h++){k.push(f(j.slice(1)))}return k}};return f(g)})([4,2]);var e=this.getShape().getPathIterator(null);for(var d=0;d<c.length;d++){e.currentSegment(c[d]);e.next()}return c};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape().intersects(d)};a.prototype.containsPoint=function(c,e,d){if(d===0){return this.getShape().contains(c,e)}else{return this.getShape().intersects(c-d,e-d,2*d,2*d)}};a.prototype.isPointAt=function(d,h,f){var g=this.getPoints();for(var e=0;e<g.length;e++){var c=g[e];if(Math.abs(d-c[0])<=f&&Math.abs(h-c[1])<=f){return true}}return false};a.prototype.isTopLeftPointAt=function(d,g,f){var e=this.getPoints();var c=java.awt.geom.Point2D.distanceSq(d,g,e[0][0],e[0][1]);return c<=f*f&&c<java.awt.geom.Point2D.distanceSq(d,g,e[1][0],e[1][1])&&c<java.awt.geom.Point2D.distanceSq(d,g,e[3][0],e[3][1])};a.prototype.isTopRightPointAt=function(c,g,f){var d=this.getPoints();var e=java.awt.geom.Point2D.distanceSq(c,g,d[1][0],d[1][1]);return e<=f*f&&e<java.awt.geom.Point2D.distanceSq(c,g,d[0][0],d[0][1])&&e<java.awt.geom.Point2D.distanceSq(c,g,d[2][0],d[2][1])};a.prototype.isBottomLeftPointAt=function(c,g,f){var e=this.getPoints();var d=java.awt.geom.Point2D.distanceSq(c,g,e[3][0],e[3][1]);return d<=f*f&&d<java.awt.geom.Point2D.distanceSq(c,g,e[0][0],e[0][1])&&d<java.awt.geom.Point2D.distanceSq(c,g,e[2][0],e[2][1])};a.prototype.isBottomRightPointAt=function(c,g,f){var d=this.getPoints();var e=java.awt.geom.Point2D.distanceSq(c,g,d[2][0],d[2][1]);return e<=f*f&&e<java.awt.geom.Point2D.distanceSq(c,g,d[1][0],d[1][1])&&e<java.awt.geom.Point2D.distanceSq(c,g,d[3][0],d[3][1])};a.prototype.isNameCenterPointAt=function(c,e,d){return Math.abs(c-this.getX()-this.getNameXOffset())<=d&&Math.abs(e-this.getY()-this.getNameYOffset())<=d};a.prototype.isParallelToWall=function(d){if(d.getArcExtent()==null){var c=d.getYEnd()-d.getYStart();var e=d.getXEnd()-d.getXStart();if(e===0&&c===0){return false}else{var h=Math.atan2(c,e);var f=Math.abs(h-this.getAngle())%Math.PI;return f<=a.STRAIGHT_WALL_ANGLE_MARGIN_$LI$()||(Math.PI-f)<=a.STRAIGHT_WALL_ANGLE_MARGIN_$LI$()}}else{var g=Math.PI/2+Math.atan2(d.getYArcCircleCenter()-this.getY(),d.getXArcCircleCenter()-this.getX());var f=Math.abs(g-this.getAngle())%Math.PI;return f<=a.ROUND_WALL_ANGLE_MARGIN_$LI$()||(Math.PI-f)<=a.ROUND_WALL_ANGLE_MARGIN_$LI$()}};a.prototype.getShape=function(){if(this.shapeCache==null){var c=new java.awt.geom.Rectangle2D.Float(this.getX()-this.getWidthInPlan()/2,this.getY()-this.getDepthInPlan()/2,this.getWidthInPlan(),this.getDepthInPlan());var d=java.awt.geom.AffineTransform.getRotateInstance(this.getAngle(),this.getX(),this.getY());var f=c.getPathIterator(d);var e=new java.awt.geom.GeneralPath();e.append(f,false);this.shapeCache=e}return this.shapeCache};a.prototype.move=function(d,c){this.setX(this.getX()+d);this.setY(this.getY()+c)};a.prototype.clone=function(){var d=this;var c=(function(g){if(b.prototype.clone!=undefined){return b.prototype.clone.call(d)}else{var e=Object.create(g);for(var f in g){if(g.hasOwnProperty(f)){e[f]=g[f]}}return e}})(this);c.level=null;return c};a.getFurnitureComparator=function(c){return((function(d){if(d==null||typeof d=="function"){return d}return function(f,e){return(d.compare?d.compare:d).call(d,f,e)}})((function(d,e){if(d.entries==null){d.entries=[]}for(var f=0;f<d.entries.length;f++){if(d.entries[f].key==null&&e==null||d.entries[f].key.equals!=null&&d.entries[f].key.equals(e)||d.entries[f].key===e){return d.entries[f].value}}return null})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),c)))};a.__static_initialized=false;return a}(HomeObject));HomePieceOfFurniture.__class="com.eteks.sweethome3d.model.HomePieceOfFurniture";HomePieceOfFurniture.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable"];(function(n){var m=(function(){function x(y){this.collator=y}x.prototype.compare=function(z,y){if(z.catalogId===y.catalogId){return 0}else{if(z.catalogId==null){return -1}else{if(y.catalogId==null){return 1}else{return this.collator.compare(z.catalogId,y.catalogId)}}}};return x}());n.HomePieceOfFurniture$0=m;var l=(function(){function x(y){this.collator=y}x.prototype.compare=function(z,y){if(z.name===y.name){return 0}else{if(z.name==null){return -1}else{if(y.name==null){return 1}else{return this.collator.compare(z.name,y.name)}}}};return x}());n.HomePieceOfFurniture$1=l;var k=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$float$float(z.width,y.width)};return x}());n.HomePieceOfFurniture$2=k;var j=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$float$float(z.height,y.height)};return x}());n.HomePieceOfFurniture$3=j;var h=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$float$float(z.depth,y.depth)};return x}());n.HomePieceOfFurniture$4=h;var g=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$boolean$boolean(z.movable,y.movable)};return x}());n.HomePieceOfFurniture$5=g;var f=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$boolean$boolean(z.doorOrWindow,y.doorOrWindow)};return x}());n.HomePieceOfFurniture$6=f;var e=(function(){function x(){}x.prototype.compare=function(z,y){if(z.color===y.color){return 0}else{if(z.color==null){return -1}else{if(y.color==null){return 1}else{return z.color-y.color}}}};return x}());n.HomePieceOfFurniture$7=e;var c=(function(){function x(y){this.collator=y}x.prototype.compare=function(z,y){if(z.texture===y.texture){return 0}else{if(z.texture==null){return -1}else{if(y.texture==null){return 1}else{return this.collator.compare(z.texture.getName(),y.texture.getName())}}}};return x}());n.HomePieceOfFurniture$8=c;var a=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$boolean$boolean(z.visible,y.visible)};return x}());n.HomePieceOfFurniture$9=a;var d=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$float$float(z.x,y.x)};return x}());n.HomePieceOfFurniture$10=d;var b=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$float$float(z.y,y.y)};return x}());n.HomePieceOfFurniture$11=b;var w=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$float$float(z.elevation,y.elevation)};return x}());n.HomePieceOfFurniture$12=w;var v=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$float$float(z.angle,y.angle)};return x}());n.HomePieceOfFurniture$13=v;var u=(function(){function x(){}x.prototype.compare=function(B,A){var z=n.getComparableModelSize(B);var y=n.getComparableModelSize(A);if(z===y){return 0}else{if(z==null){return -1}else{if(y==null){return 1}else{return z<y?-1:(z===y?0:1)}}}};return x}());n.HomePieceOfFurniture$14=u;var t=(function(){function x(y){this.collator=y}x.prototype.compare=function(z,y){if(z.creator===y.creator){return 0}else{if(z.creator==null){return -1}else{if(y.creator==null){return 1}else{return this.collator.compare(z.creator,y.creator)}}}};return x}());n.HomePieceOfFurniture$15=t;var s=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$com_eteks_sweethome3d_model_Level$com_eteks_sweethome3d_model_Level(z.getLevel(),y.getLevel())};return x}());n.HomePieceOfFurniture$16=s;var r=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$java_math_BigDecimal$java_math_BigDecimal(z.price,y.price)};return x}());n.HomePieceOfFurniture$17=r;var q=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$java_math_BigDecimal$java_math_BigDecimal(z.valueAddedTaxPercentage,y.valueAddedTaxPercentage)};return x}());n.HomePieceOfFurniture$18=q;var p=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$java_math_BigDecimal$java_math_BigDecimal(z.getValueAddedTax(),y.getValueAddedTax())};return x}());n.HomePieceOfFurniture$19=p;var o=(function(){function x(){}x.prototype.compare=function(z,y){return n.compare$java_math_BigDecimal$java_math_BigDecimal(z.getPriceValueAddedTaxIncluded(),y.getPriceValueAddedTaxIncluded())};return x}());n.HomePieceOfFurniture$20=o})(HomePieceOfFurniture||(HomePieceOfFurniture={}));HomePieceOfFurniture.__transients=["shapeCache","propertyChangeSupport"];var Compass=(function(b){__extends(a,b);function a(d,l,k,n){var g=this;if(((typeof d==="string")||d===null)&&((typeof l==="number")||l===null)&&((typeof k==="number")||k===null)&&((typeof n==="number")||n===null)){var h=arguments;g=b.call(this,d)||this;if(g.x===undefined){g.x=0}if(g.y===undefined){g.y=0}if(g.diameter===undefined){g.diameter=0}if(g.visible===undefined){g.visible=false}if(g.northDirection===undefined){g.northDirection=0}if(g.latitude===undefined){g.latitude=0}if(g.longitude===undefined){g.longitude=0}if(g.timeZone===undefined){g.timeZone=null}if(g.pointsCache===undefined){g.pointsCache=null}if(g.dateCache===undefined){g.dateCache=null}if(g.sunElevationCache===undefined){g.sunElevationCache=0}if(g.sunAzimuthCache===undefined){g.sunAzimuthCache=0}g.x=l;g.y=k;g.diameter=n;g.visible=true;g.timeZone="UTC";g.initGeographicPoint()}else{if(((typeof d==="number")||d===null)&&((typeof l==="number")||l===null)&&((typeof k==="number")||k===null)&&n===undefined){var h=arguments;var m=h[0];var c=h[1];var f=h[2];var j=arguments;var e=HomeObject.createId("compass");g=b.call(this,e)||this;if(g.x===undefined){g.x=0}if(g.y===undefined){g.y=0}if(g.diameter===undefined){g.diameter=0}if(g.visible===undefined){g.visible=false}if(g.northDirection===undefined){g.northDirection=0}if(g.latitude===undefined){g.latitude=0}if(g.longitude===undefined){g.longitude=0}if(g.timeZone===undefined){g.timeZone=null}if(g.pointsCache===undefined){g.pointsCache=null}if(g.dateCache===undefined){g.dateCache=null}if(g.sunElevationCache===undefined){g.sunElevationCache=0}if(g.sunAzimuthCache===undefined){g.sunAzimuthCache=0}g.x=m;g.y=c;g.diameter=f;g.visible=true;g.timeZone="UTC";g.initGeographicPoint();if(g.x===undefined){g.x=0}if(g.y===undefined){g.y=0}if(g.diameter===undefined){g.diameter=0}if(g.visible===undefined){g.visible=false}if(g.northDirection===undefined){g.northDirection=0}if(g.latitude===undefined){g.latitude=0}if(g.longitude===undefined){g.longitude=0}if(g.timeZone===undefined){g.timeZone=null}if(g.pointsCache===undefined){g.pointsCache=null}if(g.dateCache===undefined){g.dateCache=null}if(g.sunElevationCache===undefined){g.sunElevationCache=0}if(g.sunAzimuthCache===undefined){g.sunAzimuthCache=0}}else{throw new Error("invalid overload")}}return g}a.prototype.getX=function(){return this.x};a.prototype.setX=function(c){if(c!==this.x){var d=this.x;this.x=c;this.pointsCache=null;this.firePropertyChange("X",d,c)}};a.prototype.getY=function(){return this.y};a.prototype.setY=function(d){if(d!==this.y){var c=this.y;this.y=d;this.pointsCache=null;this.firePropertyChange("Y",c,d)}};a.prototype.getDiameter=function(){return this.diameter};a.prototype.setDiameter=function(c){if(c!==this.diameter){var d=this.diameter;this.diameter=c;this.pointsCache=null;this.firePropertyChange("DIAMETER",d,c)}};a.prototype.isVisible=function(){return this.visible};a.prototype.setVisible=function(c){if(c!==this.visible){this.visible=c;this.firePropertyChange("VISIBLE",!c,c)}};a.prototype.getNorthDirection=function(){return this.northDirection};a.prototype.setNorthDirection=function(d){if(d!==this.northDirection){var c=this.northDirection;this.northDirection=d;this.pointsCache=null;this.firePropertyChange("NORTH_DIRECTION",c,d)}};a.prototype.getLatitude=function(){return this.latitude};a.prototype.setLatitude=function(d){if(d!==this.latitude){var c=this.latitude;this.latitude=d;this.dateCache=null;this.firePropertyChange("LATITUDE",c,d)}};a.prototype.getLongitude=function(){return this.longitude};a.prototype.setLongitude=function(d){if(d!==this.longitude){var c=this.longitude;this.longitude=d;this.dateCache=null;this.firePropertyChange("LONGITUDE",c,d)}};a.prototype.getTimeZone=function(){return this.timeZone};a.prototype.setTimeZone=function(c){if(!(this.timeZone===c)){if(c==null){throw new IllegalArgumentException("Time zone ID can't be null")}var d=this.timeZone;this.timeZone=c;this.dateCache=null;this.firePropertyChange("TIME_ZONE",d,c)}};a.prototype.getPoints=function(){if(this.pointsCache==null){var c=new java.awt.geom.Rectangle2D.Float(this.getX()-this.getDiameter()/2,this.getY()-this.getDiameter()/2,this.getDiameter(),this.getDiameter());var e=java.awt.geom.AffineTransform.getRotateInstance(this.getNorthDirection(),this.getX(),this.getY());this.pointsCache=(function(h){var g=function(k){if(k.length===0){return 0}else{var l=[];for(var j=0;j<k[0];j++){l.push(g(k.slice(1)))}return l}};return g(h)})([4,2]);var f=c.getPathIterator(e);for(var d=0;d<this.pointsCache.length;d++){f.currentSegment(this.pointsCache[d]);f.next()}}return[this.pointsCache[0].slice(0),this.pointsCache[1].slice(0),this.pointsCache[2].slice(0),this.pointsCache[3].slice(0)]};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return new java.awt.geom.Ellipse2D.Float(this.getX()-this.getDiameter()/2,this.getY()-this.getDiameter()/2,this.getDiameter(),this.getDiameter()).intersects(d)};a.prototype.containsPoint=function(c,f,e){var d=new java.awt.geom.Ellipse2D.Float(this.getX()-this.getDiameter()/2,this.getY()-this.getDiameter()/2,this.getDiameter(),this.getDiameter());if(e===0){return d.contains(c,f)}else{return d.intersects(c-e,f-e,2*e,2*e)}};a.prototype.move=function(d,c){this.setX(this.getX()+d);this.setY(this.getY()+c)};a.prototype.clone=function(){var c=this;return(function(e){if(b.prototype.clone!=undefined){return b.prototype.clone.call(c)}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(this)};a.prototype.computeJulianDay=function(j,h,l,f,e,c,n,g){var o=l+f/24+e/1440+c/86400;if(h===1||h===2){j-=1;h+=12}var m=(j/100|0);var k=2-m+(m/4|0);var d=((365.25*(j+4716))|0)+(((30.6001*(h+1)))|0)+o+k-1524.5;d-=(n+g)/24;d-=2451545;return d};a.prototype.toSiderealTime=function(c){var d=c/36525;var e=(24110.54841+(8640184.812866*d)+(0.093104*Math.pow(d,2))-(0.0000062*Math.pow(d,3)))/3600;return((e/24)-((e/24)|0))*24};a.prototype.initGeographicPoint=function(){var z;if(a.timeZoneGeographicPointsReference!=null){z=a.timeZoneGeographicPointsReference}else{z=null}if(z==null){z=({});var g=new a.GeographicPoint(-13.833333,-171.73334);(z["Etc/GMT+11"]=g);(z["Pacific/Apia"]=g);(z["Pacific/Midway"]=new a.GeographicPoint(28.2,-177.35));(z["Pacific/Niue"]=new a.GeographicPoint(-19.055,-169.92));(z["Pacific/Pago_Pago"]=new a.GeographicPoint(-14.278055,-170.7025));(z["Pacific/Samoa"]=g);(z["US/Samoa"]=g);(z["America/Adak"]=new a.GeographicPoint(51.88,-176.65805));(z["America/Atka"]=new a.GeographicPoint(52.19611,-174.20056));var B=new a.GeographicPoint(21.306944,-157.85834);(z["Etc/GMT+10"]=B);(z["Pacific/Fakaofo"]=new a.GeographicPoint(-9.3653,-171.215));(z["Pacific/Honolulu"]=B);(z["Pacific/Johnston"]=new a.GeographicPoint(16.75,-169.517));(z["Pacific/Rarotonga"]=new a.GeographicPoint(-21.233,-159.783));(z["Pacific/Tahiti"]=new a.GeographicPoint(-17.533333,-149.56667));(z["SystemV/HST10"]=B);(z["US/Aleutian"]=new a.GeographicPoint(54.817,164.033));(z["US/Hawaii"]=B);(z["Pacific/Marquesas"]=new a.GeographicPoint(-9.45,-139.38));var s=new a.GeographicPoint(61.218056,-149.90028);(z["America/Anchorage"]=s);(z["America/Juneau"]=new a.GeographicPoint(58.301945,-134.41972));(z["America/Nome"]=new a.GeographicPoint(64.501114,-165.40639));(z["America/Yakutat"]=new a.GeographicPoint(59.546944,-139.72722));(z["Etc/GMT+9"]=s);(z["Pacific/Gambier"]=new a.GeographicPoint(-23.1178,-134.97));(z["SystemV/YST9"]=s);(z["SystemV/YST9YDT"]=s);(z["US/Alaska"]=s);(z["America/Dawson"]=new a.GeographicPoint(64.066666,-139.41667));(z["America/Ensenada"]=new a.GeographicPoint(31.866667,-116.61667));var f=new a.GeographicPoint(34.052223,-118.242775);(z["America/Los_Angeles"]=f);(z["America/Santa_Isabel"]=new a.GeographicPoint(28.383333,-113.35));(z["America/Tijuana"]=new a.GeographicPoint(32.533333,-117.01667));(z["America/Vancouver"]=new a.GeographicPoint(49.25,-123.13333));(z["America/Whitehorse"]=new a.GeographicPoint(60.716667,-135.05));(z["Canada/Pacific"]=new a.GeographicPoint(49.25,-123.13333));(z["Canada/Yukon"]=new a.GeographicPoint(60.716667,-135.05));(z["Etc/GMT+8"]=f);(z["Mexico/BajaNorte"]=new a.GeographicPoint(32.533333,-117.01667));(z["Pacific/Pitcairn"]=new a.GeographicPoint(-25.0667,-130.1));(z["SystemV/PST8"]=f);(z["SystemV/PST8PDT"]=f);(z["US/Pacific"]=f);(z["US/Pacific-New"]=f);(z["America/Boise"]=new a.GeographicPoint(43.61361,-116.2025));(z["America/Cambridge_Bay"]=new a.GeographicPoint(69.11667,-105.03333));(z["America/Chihuahua"]=new a.GeographicPoint(28.633333,-106.083336));(z["America/Dawson_Creek"]=new a.GeographicPoint(55.766666,-120.23333));var l=new a.GeographicPoint(39.739166,-104.98417);(z["America/Denver"]=l);(z["America/Edmonton"]=new a.GeographicPoint(53.55,-113.5));(z["America/Hermosillo"]=new a.GeographicPoint(29.066668,-110.96667));(z["America/Inuvik"]=new a.GeographicPoint(68.35,-133.7));(z["America/Mazatlan"]=new a.GeographicPoint(23.216667,-106.416664));(z["America/Ojinaga"]=new a.GeographicPoint(29.566668,-104.416664));(z["America/Phoenix"]=new a.GeographicPoint(33.448334,-112.07333));(z["America/Shiprock"]=new a.GeographicPoint(36.785557,-108.686386));(z["America/Yellowknife"]=new a.GeographicPoint(62.45,-114.35));(z["Canada/Mountain"]=new a.GeographicPoint(53.55,-113.5));(z["Etc/GMT+7"]=l);(z["Mexico/BajaSur"]=new a.GeographicPoint(32.567,-116.633));(z["SystemV/MST7"]=l);(z["SystemV/MST7MDT"]=l);(z["US/Arizona"]=new a.GeographicPoint(33.448334,-112.07333));(z["US/Mountain"]=l);(z["America/Belize"]=new a.GeographicPoint(17.483334,-88.183334));(z["America/Cancun"]=new a.GeographicPoint(21.166668,-86.833336));var x=new a.GeographicPoint(41.85,-87.65);(z["America/Chicago"]=x);(z["America/Costa_Rica"]=new a.GeographicPoint(9.933333,-84.083336));(z["America/El_Salvador"]=new a.GeographicPoint(13.7086115,-89.20306));(z["America/Guatemala"]=new a.GeographicPoint(14.621111,-90.52695));(z["America/Knox_IN"]=new a.GeographicPoint(41.295834,-86.625));(z["America/Managua"]=new a.GeographicPoint(12.150833,-86.26833));(z["America/Matamoros"]=new a.GeographicPoint(25.883333,-97.5));(z["America/Menominee"]=new a.GeographicPoint(45.107777,-87.61417));(z["America/Merida"]=new a.GeographicPoint(20.966667,-89.61667));(z["America/Mexico_City"]=new a.GeographicPoint(19.434168,-99.13861));(z["America/Monterrey"]=new a.GeographicPoint(25.666668,-100.316666));(z["America/Rainy_River"]=new a.GeographicPoint(48.716667,-94.566666));(z["America/Rankin_Inlet"]=new a.GeographicPoint(62.816666,-92.083336));(z["America/Regina"]=new a.GeographicPoint(50.45,-104.61667));(z["America/Swift_Current"]=new a.GeographicPoint(50.283333,-107.76667));(z["America/Tegucigalpa"]=new a.GeographicPoint(14.1,-87.21667));(z["America/Winnipeg"]=new a.GeographicPoint(49.88333,-97.166664));(z["Canada/Central"]=new a.GeographicPoint(50.45,-104.61667));(z["Canada/East-Saskatchewan"]=new a.GeographicPoint(51.216667,-102.46667));(z["Canada/Saskatchewan"]=new a.GeographicPoint(50.45,-104.61667));(z["Chile/EasterIsland"]=new a.GeographicPoint(-27.15,-109.425));(z["Etc/GMT+6"]=x);(z["Mexico/General"]=new a.GeographicPoint(19.434168,-99.13861));(z["Pacific/Easter"]=new a.GeographicPoint(-27.15,-109.425));(z["Pacific/Galapagos"]=new a.GeographicPoint(-0.667,-90.55));(z["SystemV/CST6"]=x);(z["SystemV/CST6CDT"]=x);(z["US/Central"]=x);(z["US/Indiana-Starke"]=new a.GeographicPoint(41.295834,-86.625));(z["America/Atikokan"]=new a.GeographicPoint(48.75,-91.61667));(z["America/Bogota"]=new a.GeographicPoint(4.6,-74.083336));(z["America/Cayman"]=new a.GeographicPoint(19.3,-81.38333));(z["America/Coral_Harbour"]=new a.GeographicPoint(64.13333,-83.166664));(z["America/Detroit"]=new a.GeographicPoint(42.33139,-83.04583));(z["America/Fort_Wayne"]=new a.GeographicPoint(41.130554,-85.12889));(z["America/Grand_Turk"]=new a.GeographicPoint(21.466667,-71.13333));(z["America/Guayaquil"]=new a.GeographicPoint(-2.1666667,-79.9));(z["America/Havana"]=new a.GeographicPoint(23.131945,-82.36417));(z["America/Indianapolis"]=new a.GeographicPoint(39.768333,-86.15806));(z["America/Iqaluit"]=new a.GeographicPoint(63.733334,-68.5));(z["America/Jamaica"]=new a.GeographicPoint(18,-76.8));(z["America/Lima"]=new a.GeographicPoint(-12.05,-77.05));(z["America/Louisville"]=new a.GeographicPoint(38.254166,-85.759445));(z["America/Montreal"]=new a.GeographicPoint(45.5,-73.583336));(z["America/Nassau"]=new a.GeographicPoint(25.083334,-77.35));var p=new a.GeographicPoint(40.71417,-74.006386);(z["America/New_York"]=p);(z["America/Nipigon"]=new a.GeographicPoint(49.016666,-88.25));(z["America/Panama"]=new a.GeographicPoint(8.966667,-79.53333));(z["America/Pangnirtung"]=new a.GeographicPoint(66.13333,-65.75));(z["America/Port-au-Prince"]=new a.GeographicPoint(18.539167,-72.335));(z["America/Resolute"]=new a.GeographicPoint(74.683334,-94.9));(z["America/Thunder_Bay"]=new a.GeographicPoint(48.4,-89.23333));(z["America/Toronto"]=new a.GeographicPoint(43.666668,-79.416664));(z["Canada/Eastern"]=new a.GeographicPoint(43.666668,-79.416664));(z["Etc/GMT+5"]=p);(z["SystemV/EST5"]=p);(z["SystemV/EST5EDT"]=p);(z["US/East-Indiana"]=new a.GeographicPoint(36.8381,-84.85));(z["US/Eastern"]=p);(z["US/Michigan"]=new a.GeographicPoint(42.33139,-83.04583));(z["America/Caracas"]=new a.GeographicPoint(10.5,-66.916664));(z["America/Anguilla"]=new a.GeographicPoint(18.216667,-63.05));(z["America/Antigua"]=new a.GeographicPoint(17.116667,-61.85));(z["America/Aruba"]=new a.GeographicPoint(10.541111,-72.9175));(z["America/Asuncion"]=new a.GeographicPoint(-25.266666,-57.666668));(z["America/Barbados"]=new a.GeographicPoint(13.1,-59.616665));(z["America/Blanc-Sablon"]=new a.GeographicPoint(51.433334,-57.11667));(z["America/Boa_Vista"]=new a.GeographicPoint(2.8166666,-60.666668));(z["America/Campo_Grande"]=new a.GeographicPoint(-20.45,-54.616665));(z["America/Cuiaba"]=new a.GeographicPoint(-15.583333,-56.083332));(z["America/Curacao"]=new a.GeographicPoint(12.1167,-68.933));(z["America/Dominica"]=new a.GeographicPoint(15.3,-61.4));(z["America/Eirunepe"]=new a.GeographicPoint(-6.6666665,-69.86667));(z["America/Glace_Bay"]=new a.GeographicPoint(46.2,-59.966667));(z["America/Goose_Bay"]=new a.GeographicPoint(53.333332,-60.416668));(z["America/Grenada"]=new a.GeographicPoint(12.05,-61.75));(z["America/Guadeloupe"]=new a.GeographicPoint(16.233334,-61.516666));(z["America/Guyana"]=new a.GeographicPoint(6.8,-58.166668));(z["America/Halifax"]=new a.GeographicPoint(44.65,-63.6));(z["America/La_Paz"]=new a.GeographicPoint(-16.5,-68.15));(z["America/Manaus"]=new a.GeographicPoint(-3.1133332,-60.025276));(z["America/Marigot"]=new a.GeographicPoint(18.073,63.0844));(z["America/Martinique"]=new a.GeographicPoint(14.6,-61.083332));(z["America/Moncton"]=new a.GeographicPoint(46.083332,-64.76667));(z["America/Montserrat"]=new a.GeographicPoint(16.7,-62.216667));(z["America/Port_of_Spain"]=new a.GeographicPoint(10.65,-61.516666));(z["America/Porto_Acre"]=new a.GeographicPoint(-9.587778,-67.53555));(z["America/Porto_Velho"]=new a.GeographicPoint(-8.766666,-63.9));(z["America/Puerto_Rico"]=new a.GeographicPoint(18.467,66.117));(z["America/Rio_Branco"]=new a.GeographicPoint(-9.966667,-67.8));var m=new a.GeographicPoint(-33.45,-70.666664);(z["America/Santiago"]=m);(z["America/Santo_Domingo"]=new a.GeographicPoint(18.466667,-69.9));(z["America/St_Barthelemy"]=new a.GeographicPoint(17.8978,-62.851));(z["America/St_Kitts"]=new a.GeographicPoint(17.3,-62.733));(z["America/St_Lucia"]=new a.GeographicPoint(14.0167,-60.9833));(z["America/St_Thomas"]=new a.GeographicPoint(18.3333,-64.9167));(z["America/St_Vincent"]=new a.GeographicPoint(13.1667,-61.2333));(z["America/Thule"]=new a.GeographicPoint(-54.27667,-36.511665));(z["America/Tortola"]=new a.GeographicPoint(18.416666,-64.61667));(z["America/Virgin"]=new a.GeographicPoint(18.34389,-64.931114));(z["Antarctica/Palmer"]=new a.GeographicPoint(-64.25,-62.833));(z["Atlantic/Bermuda"]=new a.GeographicPoint(32.294167,-64.78389));(z["Atlantic/Stanley"]=new a.GeographicPoint(-51.7,-57.85));(z["Brazil/Acre"]=new a.GeographicPoint(-10.883333,-45.083332));(z["Brazil/West"]=new a.GeographicPoint(-10.883333,-45.083332));(z["Canada/Atlantic"]=new a.GeographicPoint(44.65,-63.6));(z["Chile/Continental"]=m);(z["Etc/GMT+4"]=m);(z["SystemV/AST4"]=new a.GeographicPoint(44.65,-63.6));(z["SystemV/AST4ADT"]=new a.GeographicPoint(44.65,-63.6));(z["America/St_Johns"]=new a.GeographicPoint(47.5675,-52.7072));(z["Canada/Newfoundland"]=new a.GeographicPoint(47.5675,-52.7072));(z["America/Araguaina"]=new a.GeographicPoint(-7.16,-48.0575));(z["America/Bahia"]=new a.GeographicPoint(-12.983334,-38.516666));(z["America/Belem"]=new a.GeographicPoint(-1.45,-48.483334));(z["America/Buenos_Aires"]=new a.GeographicPoint(-34.5875,-58.6725));(z["America/Catamarca"]=new a.GeographicPoint(-28.466667,-65.78333));(z["America/Cayenne"]=new a.GeographicPoint(4.9333334,-52.333332));(z["America/Cordoba"]=new a.GeographicPoint(-31.4,-64.183334));(z["America/Fortaleza"]=new a.GeographicPoint(-3.7166667,-38.5));(z["America/Godthab"]=new a.GeographicPoint(64.183334,-51.75));(z["America/Jujuy"]=new a.GeographicPoint(-24.183332,-65.3));(z["America/Maceio"]=new a.GeographicPoint(-9.666667,-35.716667));(z["America/Mendoza"]=new a.GeographicPoint(-32.883335,-68.816666));(z["America/Miquelon"]=new a.GeographicPoint(47.0975,-56.38139));(z["America/Montevideo"]=new a.GeographicPoint(-34.858055,-56.170834));(z["America/Paramaribo"]=new a.GeographicPoint(5.8333335,-55.166668));(z["America/Recife"]=new a.GeographicPoint(-8.05,-34.9));(z["America/Rosario"]=new a.GeographicPoint(-32.95111,-60.66639));(z["America/Santarem"]=new a.GeographicPoint(-2.4333334,-54.7));var y=new a.GeographicPoint(-23.533333,-46.616665);(z["America/Sao_Paulo"]=y);(z["Antarctica/Rothera"]=new a.GeographicPoint(67.567,68.133));(z["Brazil/East"]=y);(z["Etc/GMT+3"]=y);(z["America/Noronha"]=new a.GeographicPoint(3.85,25.417));var D=new a.GeographicPoint(54.25,36.75);(z["Atlantic/South_Georgia"]=D);(z["Brazil/DeNoronha"]=new a.GeographicPoint(3.85,25.417));(z["Etc/GMT+2"]=D);(z["America/Scoresbysund"]=new a.GeographicPoint(70.48333,-21.966667));var v=new a.GeographicPoint(37.483334,-2.5666666);(z["Atlantic/Azores"]=v);(z["Atlantic/Cape_Verde"]=new a.GeographicPoint(14.916667,-23.516666));(z["Etc/GMT+1"]=v);(z["Africa/Abidjan"]=new a.GeographicPoint(5.341111,-4.028056));(z["Africa/Accra"]=new a.GeographicPoint(5.55,-0.2166667));(z["Africa/Bamako"]=new a.GeographicPoint(12.65,-8));(z["Africa/Banjul"]=new a.GeographicPoint(13.453055,-16.5775));(z["Africa/Bissau"]=new a.GeographicPoint(11.85,-15.583333));(z["Africa/Casablanca"]=new a.GeographicPoint(33.593056,-7.616389));(z["Africa/Conakry"]=new a.GeographicPoint(9.509167,-13.712222));(z["Africa/Dakar"]=new a.GeographicPoint(14.670834,-17.438055));(z["Africa/El_Aaiun"]=new a.GeographicPoint(27.15361,-13.203333));(z["Africa/Freetown"]=new a.GeographicPoint(8.49,-13.234167));(z["Africa/Lome"]=new a.GeographicPoint(6.131944,1.2227778));(z["Africa/Monrovia"]=new a.GeographicPoint(6.3105555,-10.804722));(z["Africa/Nouakchott"]=new a.GeographicPoint(18.08639,-15.975278));(z["Africa/Ouagadougou"]=new a.GeographicPoint(12.370277,-1.5247222));(z["Africa/Sao_Tome"]=new a.GeographicPoint(0.3333333,6.733333));(z["Africa/Timbuktu"]=new a.GeographicPoint(16.766666,-3.0166667));(z["America/Danmarkshavn"]=new a.GeographicPoint(76.767,18.667));(z["Atlantic/Canary"]=new a.GeographicPoint(28.45,-16.233334));(z["Atlantic/Faeroe"]=new a.GeographicPoint(62.016666,-6.766667));(z["Atlantic/Faroe"]=new a.GeographicPoint(62.016666,-6.766667));(z["Atlantic/Madeira"]=new a.GeographicPoint(32.633335,-16.9));(z["Atlantic/Reykjavik"]=new a.GeographicPoint(64.15,-21.95));(z["Atlantic/St_Helena"]=new a.GeographicPoint(-15.933333,-5.7166667));var r=new a.GeographicPoint(51.466667,0);(z["Etc/GMT"]=r);(z["Etc/GMT+0"]=r);(z["Etc/GMT-0"]=r);(z["Etc/GMT0"]=r);(z["Etc/Greenwich"]=r);(z["Etc/UCT"]=r);(z["Etc/UTC"]=r);(z["Etc/Universal"]=r);(z["Etc/Zulu"]=r);(z["Europe/Belfast"]=new a.GeographicPoint(54.583332,-5.933333));(z["Europe/Dublin"]=new a.GeographicPoint(53.333057,-6.248889));(z["Europe/Guernsey"]=new a.GeographicPoint(49.45,-2.533));(z["Europe/Isle_of_Man"]=new a.GeographicPoint(54.14521,-4.48172));(z["Europe/Jersey"]=new a.GeographicPoint(49.2,-2.117));(z["Europe/Lisbon"]=new a.GeographicPoint(38.716667,-9.133333));(z["Europe/London"]=new a.GeographicPoint(51.5,-0.116667));(z["Africa/Algiers"]=new a.GeographicPoint(36.763054,3.0505557));(z["Africa/Bangui"]=new a.GeographicPoint(4.366667,18.583334));(z["Africa/Brazzaville"]=new a.GeographicPoint(-4.2591667,15.284722));(z["Africa/Ceuta"]=new a.GeographicPoint(35.890278,-5.3075));(z["Africa/Douala"]=new a.GeographicPoint(4.0502777,9.7));(z["Africa/Kinshasa"]=new a.GeographicPoint(-4.3,15.3));(z["Africa/Lagos"]=new a.GeographicPoint(6.4530554,3.3958333));(z["Africa/Libreville"]=new a.GeographicPoint(0.3833333,9.45));(z["Africa/Luanda"]=new a.GeographicPoint(-8.838333,13.234445));(z["Africa/Malabo"]=new a.GeographicPoint(3.75,8.783333));(z["Africa/Ndjamena"]=new a.GeographicPoint(12.113055,15.049167));(z["Africa/Niamey"]=new a.GeographicPoint(13.516666,2.1166668));(z["Africa/Porto-Novo"]=new a.GeographicPoint(6.483333,2.6166668));(z["Africa/Tunis"]=new a.GeographicPoint(36.802776,10.179722));(z["Africa/Windhoek"]=new a.GeographicPoint(-22.57,17.08361));(z["Arctic/Longyearbyen"]=new a.GeographicPoint(78.21667,15.633333));(z["Atlantic/Jan_Mayen"]=new a.GeographicPoint(71,-8.333));var C=new a.GeographicPoint(48.86667,2.333333);(z["Etc/GMT-1"]=C);(z["Europe/Amsterdam"]=new a.GeographicPoint(52.35,4.9166665));(z["Europe/Andorra"]=new a.GeographicPoint(42.5,1.5166667));(z["Europe/Belgrade"]=new a.GeographicPoint(44.81861,20.468056));(z["Europe/Berlin"]=new a.GeographicPoint(52.516666,13.4));(z["Europe/Bratislava"]=new a.GeographicPoint(48.15,17.116667));(z["Europe/Brussels"]=new a.GeographicPoint(50.833332,4.333333));(z["Europe/Budapest"]=new a.GeographicPoint(47.5,19.083334));(z["Europe/Copenhagen"]=new a.GeographicPoint(55.666668,12.583333));(z["Europe/Gibraltar"]=new a.GeographicPoint(36.133335,-5.35));(z["Europe/Ljubljana"]=new a.GeographicPoint(46.05528,14.514444));(z["Europe/Luxembourg"]=new a.GeographicPoint(49.611668,6.13));(z["Europe/Madrid"]=new a.GeographicPoint(40.4,-3.6833334));(z["Europe/Malta"]=new a.GeographicPoint(35.899723,14.514722));(z["Europe/Monaco"]=new a.GeographicPoint(43.733334,7.4166665));(z["Europe/Oslo"]=new a.GeographicPoint(59.916668,10.75));(z["Europe/Paris"]=C);(z["Europe/Podgorica"]=new a.GeographicPoint(42.441113,19.26361));(z["Europe/Prague"]=new a.GeographicPoint(50.083332,14.466667));(z["Europe/Rome"]=new a.GeographicPoint(41.9,12.483334));(z["Europe/San_Marino"]=new a.GeographicPoint(43.933334,12.45));(z["Europe/Sarajevo"]=new a.GeographicPoint(43.85,18.383333));(z["Europe/Skopje"]=new a.GeographicPoint(42,21.433332));(z["Europe/Stockholm"]=new a.GeographicPoint(59.333332,18.05));(z["Europe/Tirane"]=new a.GeographicPoint(41.3275,19.81889));(z["Europe/Vaduz"]=new a.GeographicPoint(47.133335,9.516666));(z["Europe/Vatican"]=new a.GeographicPoint(41.9,12.45));(z["Europe/Vienna"]=new a.GeographicPoint(48.2,16.366667));(z["Europe/Warsaw"]=new a.GeographicPoint(52.25,21));(z["Europe/Zagreb"]=new a.GeographicPoint(45.8,16));(z["Europe/Zurich"]=new a.GeographicPoint(47.366665,8.55));(z["Africa/Blantyre"]=new a.GeographicPoint(-15.783333,35));(z["Africa/Bujumbura"]=new a.GeographicPoint(-3.376111,29.36));(z["Africa/Cairo"]=new a.GeographicPoint(30.05,31.25));(z["Africa/Gaborone"]=new a.GeographicPoint(-24.646389,25.911945));(z["Africa/Harare"]=new a.GeographicPoint(-17.817778,31.044722));(z["Africa/Johannesburg"]=new a.GeographicPoint(-26.2,28.083334));(z["Africa/Kigali"]=new a.GeographicPoint(-1.9536111,30.060556));(z["Africa/Lubumbashi"]=new a.GeographicPoint(-11.666667,27.466667));(z["Africa/Lusaka"]=new a.GeographicPoint(-15.416667,28.283333));(z["Africa/Maputo"]=new a.GeographicPoint(-25.965279,32.58917));(z["Africa/Maseru"]=new a.GeographicPoint(-29.316668,27.483334));(z["Africa/Mbabane"]=new a.GeographicPoint(-26.316668,31.133333));(z["Africa/Tripoli"]=new a.GeographicPoint(32.8925,13.18));(z["Asia/Amman"]=new a.GeographicPoint(31.95,35.933334));(z["Asia/Beirut"]=new a.GeographicPoint(33.871944,35.509724));(z["Asia/Damascus"]=new a.GeographicPoint(33.5,36.3));(z["Asia/Gaza"]=new a.GeographicPoint(31.5,34.466667));(z["Asia/Istanbul"]=new a.GeographicPoint(41.018612,28.964722));(z["Asia/Jerusalem"]=new a.GeographicPoint(31.78,35.23));(z["Asia/Nicosia"]=new a.GeographicPoint(35.166668,33.366665));(z["Asia/Tel_Aviv"]=new a.GeographicPoint(32.066666,34.766666));var A=new a.GeographicPoint(37.983334,23.733334);(z["Etc/GMT-2"]=A);(z["Europe/Athens"]=new a.GeographicPoint(37.983334,23.733334));(z["Europe/Bucharest"]=new a.GeographicPoint(44.433334,26.1));(z["Europe/Chisinau"]=new a.GeographicPoint(47.005554,28.8575));(z["Europe/Helsinki"]=new a.GeographicPoint(60.175556,24.934166));(z["Europe/Istanbul"]=new a.GeographicPoint(41.018612,28.964722));(z["Europe/Kaliningrad"]=new a.GeographicPoint(54.71,20.5));(z["Europe/Kiev"]=new a.GeographicPoint(50.433334,30.516666));(z["Europe/Mariehamn"]=new a.GeographicPoint(60.1,19.95));(z["Europe/Minsk"]=new a.GeographicPoint(53.9,27.566668));(z["Europe/Nicosia"]=new a.GeographicPoint(35.166668,33.366665));(z["Europe/Riga"]=new a.GeographicPoint(56.95,24.1));(z["Europe/Simferopol"]=new a.GeographicPoint(44.95,34.1));(z["Europe/Sofia"]=new a.GeographicPoint(42.683334,23.316668));(z["Europe/Tallinn"]=new a.GeographicPoint(59.433887,24.728056));(z["Europe/Tiraspol"]=new a.GeographicPoint(46.84028,29.643333));(z["Europe/Uzhgorod"]=new a.GeographicPoint(48.616665,22.3));(z["Europe/Vilnius"]=new a.GeographicPoint(54.683334,25.316668));(z["Europe/Zaporozhye"]=new a.GeographicPoint(47.833,35.1667));(z["Africa/Addis_Ababa"]=new a.GeographicPoint(9.033333,38.7));(z["Africa/Asmara"]=new a.GeographicPoint(15.333333,38.933334));(z["Africa/Asmera"]=new a.GeographicPoint(15.333333,38.933334));(z["Africa/Dar_es_Salaam"]=new a.GeographicPoint(-6.8,39.283333));(z["Africa/Djibouti"]=new a.GeographicPoint(11.595,43.148056));(z["Africa/Kampala"]=new a.GeographicPoint(0.3155556,32.565556));(z["Africa/Khartoum"]=new a.GeographicPoint(15.588056,32.53417));(z["Africa/Mogadishu"]=new a.GeographicPoint(2.0666666,45.366665));(z["Africa/Nairobi"]=new a.GeographicPoint(-1.2833333,36.816666));(z["Antarctica/Syowa"]=new a.GeographicPoint(-69,39.5833));(z["Asia/Aden"]=new a.GeographicPoint(12.779445,45.036667));(z["Asia/Baghdad"]=new a.GeographicPoint(33.33861,44.39389));(z["Asia/Bahrain"]=new a.GeographicPoint(26.23611,50.583057));(z["Asia/Kuwait"]=new a.GeographicPoint(29.369722,47.978333));(z["Asia/Qatar"]=new a.GeographicPoint(25.286667,51.533333));(z["Asia/Riyadh"]=new a.GeographicPoint(24.640833,46.772778));var E=new a.GeographicPoint(55.752224,37.615555);(z["Etc/GMT-3"]=E);(z["Europe/Moscow"]=E);(z["Europe/Volgograd"]=new a.GeographicPoint(48.80472,44.585835));(z["Indian/Antananarivo"]=new a.GeographicPoint(-18.916666,47.516666));(z["Indian/Comoro"]=new a.GeographicPoint(-11.704166,43.240276));(z["Indian/Mayotte"]=new a.GeographicPoint(-12.779445,45.227222));(z["Asia/Riyadh87"]=new a.GeographicPoint(24.640833,46.772778));(z["Asia/Riyadh88"]=new a.GeographicPoint(24.640833,46.772778));(z["Asia/Riyadh89"]=new a.GeographicPoint(24.640833,46.772778));(z["Mideast/Riyadh87"]=new a.GeographicPoint(24.640833,46.772778));(z["Mideast/Riyadh88"]=new a.GeographicPoint(24.640833,46.772778));(z["Mideast/Riyadh89"]=new a.GeographicPoint(24.640833,46.772778));(z["Asia/Tehran"]=new a.GeographicPoint(35.671944,51.424446));(z["Asia/Baku"]=new a.GeographicPoint(40.39528,49.88222));var k=new a.GeographicPoint(25.252222,55.28);(z["Asia/Dubai"]=k);(z["Asia/Muscat"]=new a.GeographicPoint(23.613333,58.593334));(z["Asia/Tbilisi"]=new a.GeographicPoint(41.725,44.790833));(z["Asia/Yerevan"]=new a.GeographicPoint(40.18111,44.51361));(z["Etc/GMT-4"]=k);(z["Europe/Samara"]=new a.GeographicPoint(53.2,50.15));(z["Indian/Mahe"]=new a.GeographicPoint(-4.616667,55.45));(z["Indian/Mauritius"]=new a.GeographicPoint(-20.161945,57.49889));(z["Indian/Reunion"]=new a.GeographicPoint(-20.866667,55.466667));(z["Asia/Kabul"]=new a.GeographicPoint(34.516666,69.183334));(z["Antarctica/Davis"]=new a.GeographicPoint(-68.5764,77.9689));(z["Antarctica/Mawson"]=new a.GeographicPoint(-53.104,73.514));(z["Asia/Aqtau"]=new a.GeographicPoint(43.65,51.2));(z["Asia/Aqtobe"]=new a.GeographicPoint(50.298054,57.18139));(z["Asia/Ashgabat"]=new a.GeographicPoint(37.95,58.383335));(z["Asia/Ashkhabad"]=new a.GeographicPoint(37.95,58.383335));(z["Asia/Dushanbe"]=new a.GeographicPoint(38.56,68.77389));(z["Asia/Karachi"]=new a.GeographicPoint(24.866667,67.05));(z["Asia/Oral"]=new a.GeographicPoint(51.233334,51.366665));(z["Asia/Samarkand"]=new a.GeographicPoint(39.654167,66.959724));(z["Asia/Tashkent"]=new a.GeographicPoint(41.316666,69.25));(z["Asia/Yekaterinburg"]=new a.GeographicPoint(56.85,60.6));var d=new a.GeographicPoint(22.569721,88.36972);(z["Etc/GMT-5"]=d);(z["Indian/Kerguelen"]=new a.GeographicPoint(-49.25,69.583));(z["Indian/Maldives"]=new a.GeographicPoint(4.1666665,73.5));(z["Asia/Calcutta"]=d);(z["Asia/Colombo"]=new a.GeographicPoint(6.9319444,79.84778));(z["Asia/Kolkata"]=d);(z["Asia/Kathmandu"]=new a.GeographicPoint(27.716667,85.316666));(z["Asia/Katmandu"]=new a.GeographicPoint(27.716667,85.316666));(z["Antarctica/Vostok"]=new a.GeographicPoint(-78.4644,106.8372));(z["Asia/Almaty"]=new a.GeographicPoint(43.25,76.95));(z["Asia/Bishkek"]=new a.GeographicPoint(42.873055,74.60028));var t=new a.GeographicPoint(23.723055,90.40861);(z["Asia/Dacca"]=t);(z["Asia/Dhaka"]=t);(z["Asia/Novokuznetsk"]=new a.GeographicPoint(53.75,87.1));(z["Asia/Novosibirsk"]=new a.GeographicPoint(55.04111,82.93444));(z["Asia/Omsk"]=new a.GeographicPoint(55,73.4));(z["Asia/Qyzylorda"]=new a.GeographicPoint(44.85278,65.50916));(z["Asia/Thimbu"]=new a.GeographicPoint(27.483334,89.6));(z["Asia/Thimphu"]=new a.GeographicPoint(27.483334,89.6));(z["Etc/GMT-6"]=t);(z["Indian/Chagos"]=new a.GeographicPoint(-6,71.5));(z["Asia/Rangoon"]=new a.GeographicPoint(16.783333,96.166664));(z["Indian/Cocos"]=new a.GeographicPoint(-12.1167,96.9));var q=new a.GeographicPoint(13.75,100.51667);(z["Asia/Bangkok"]=q);(z["Asia/Ho_Chi_Minh"]=new a.GeographicPoint(10.75,106.666664));(z["Asia/Hovd"]=new a.GeographicPoint(48.016666,91.63333));(z["Asia/Jakarta"]=new a.GeographicPoint(-6.174444,106.829445));(z["Asia/Krasnoyarsk"]=new a.GeographicPoint(56.009724,92.791664));(z["Asia/Phnom_Penh"]=new a.GeographicPoint(11.55,104.916664));(z["Asia/Pontianak"]=new a.GeographicPoint(-0.0333333,109.333336));(z["Asia/Saigon"]=new a.GeographicPoint(10.75,106.666664));(z["Asia/Vientiane"]=new a.GeographicPoint(17.966667,102.6));(z["Etc/GMT-7"]=q);(z["Indian/Christmas"]=new a.GeographicPoint(-10.416667,105.71667));(z["Asia/Brunei"]=new a.GeographicPoint(4.883333,114.933334));(z["Asia/Choibalsan"]=new a.GeographicPoint(48.066666,114.5));(z["Asia/Chongqing"]=new a.GeographicPoint(29.562778,106.55278));(z["Asia/Chungking"]=new a.GeographicPoint(29.562778,106.55278));(z["Asia/Harbin"]=new a.GeographicPoint(45.75,126.65));(z["Asia/Hong_Kong"]=new a.GeographicPoint(22.283333,114.15));(z["Asia/Irkutsk"]=new a.GeographicPoint(52.266666,104.333336));(z["Asia/Kashgar"]=new a.GeographicPoint(39.391388,76.04));(z["Asia/Kuala_Lumpur"]=new a.GeographicPoint(3.1666667,101.7));(z["Asia/Kuching"]=new a.GeographicPoint(1.55,110.333336));(z["Asia/Macao"]=new a.GeographicPoint(22.2,113.55));(z["Asia/Macau"]=new a.GeographicPoint(22.2,113.55));(z["Asia/Makassar"]=new a.GeographicPoint(2.45,99.78333));(z["Asia/Manila"]=new a.GeographicPoint(14.604167,120.98222));var u=new a.GeographicPoint(31.005,121.40861);(z["Asia/Shanghai"]=u);(z["Asia/Singapore"]=new a.GeographicPoint(1.2930557,103.855835));(z["Asia/Taipei"]=new a.GeographicPoint(25.039167,121.525));(z["Asia/Ujung_Pandang"]=new a.GeographicPoint(-5.1305556,119.406944));(z["Asia/Ulaanbaatar"]=new a.GeographicPoint(47.916668,106.916664));(z["Asia/Ulan_Bator"]=new a.GeographicPoint(47.916668,106.916664));(z["Asia/Urumqi"]=new a.GeographicPoint(43.8,87.583336));(z["Australia/Perth"]=new a.GeographicPoint(-31.933332,115.833336));(z["Australia/West"]=new a.GeographicPoint(-31.933332,115.833336));(z["Etc/GMT-8"]=u);(z["Australia/Eucla"]=new a.GeographicPoint(-31.716667,128.86667));(z["Asia/Dili"]=new a.GeographicPoint(-8.55,125.5833));(z["Asia/Jayapura"]=new a.GeographicPoint(-2.5333333,140.7));(z["Asia/Pyongyang"]=new a.GeographicPoint(39.019444,125.75472));(z["Asia/Seoul"]=new a.GeographicPoint(37.566387,126.999725));var j=new a.GeographicPoint(35.685,139.75139);(z["Asia/Tokyo"]=j);(z["Asia/Yakutsk"]=new a.GeographicPoint(62.03389,129.73306));(z["Etc/GMT-9"]=j);(z["Pacific/Palau"]=new a.GeographicPoint(7.5,134.6241));(z["Australia/Adelaide"]=new a.GeographicPoint(-34.933334,138.6));(z["Australia/Broken_Hill"]=new a.GeographicPoint(-31.95,141.43333));(z["Australia/Darwin"]=new a.GeographicPoint(-12.466667,130.83333));(z["Australia/North"]=new a.GeographicPoint(-12.466667,130.83333));(z["Australia/South"]=new a.GeographicPoint(-34.933334,138.6));(z["Australia/Yancowinna"]=new a.GeographicPoint(-31.7581,141.7178));(z["Antarctica/DumontDUrville"]=new a.GeographicPoint(-66.66277,140.0014));(z["Asia/Sakhalin"]=new a.GeographicPoint(51,143));(z["Asia/Vladivostok"]=new a.GeographicPoint(43.133335,131.9));(z["Australia/ACT"]=new a.GeographicPoint(-35.283333,149.21666));(z["Australia/Brisbane"]=new a.GeographicPoint(-27.5,153.01666));(z["Australia/Canberra"]=new a.GeographicPoint(-35.283333,149.21666));(z["Australia/Currie"]=new a.GeographicPoint(-39.933334,143.86667));(z["Australia/Hobart"]=new a.GeographicPoint(-42.916668,147.33333));(z["Australia/Lindeman"]=new a.GeographicPoint(-20.45,149.0333));(z["Australia/Melbourne"]=new a.GeographicPoint(-37.816666,144.96666));var o=new a.GeographicPoint(-33.88333,151.21666);(z["Australia/NSW"]=o);(z["Australia/Queensland"]=new a.GeographicPoint(-27.5,153.01666));(z["Australia/Sydney"]=o);(z["Australia/Tasmania"]=new a.GeographicPoint(-42.916668,147.33333));(z["Australia/Victoria"]=new a.GeographicPoint(-37.816666,144.96666));(z["Etc/GMT-10"]=o);(z["Pacific/Guam"]=new a.GeographicPoint(13.467,144.75));(z["Pacific/Port_Moresby"]=new a.GeographicPoint(-9.464723,147.1925));(z["Pacific/Saipan"]=new a.GeographicPoint(15.1833,145.75));(z["Pacific/Truk"]=new a.GeographicPoint(7.4167,151.7833));(z["Pacific/Yap"]=new a.GeographicPoint(9.514444,138.12917));(z["Australia/LHI"]=new a.GeographicPoint(-31.55,159.083));(z["Australia/Lord_Howe"]=new a.GeographicPoint(-31.55,159.083));(z["Antarctica/Casey"]=new a.GeographicPoint(-66.2833,110.5333));(z["Asia/Magadan"]=new a.GeographicPoint(59.566666,150.8));var c=new a.GeographicPoint(-22.266666,166.45);(z["Etc/GMT-11"]=c);(z["Pacific/Efate"]=new a.GeographicPoint(-17.667,168.417));(z["Pacific/Guadalcanal"]=new a.GeographicPoint(-9.617,160.183));(z["Pacific/Kosrae"]=new a.GeographicPoint(5.317,162.983));(z["Pacific/Noumea"]=c);(z["Pacific/Ponape"]=new a.GeographicPoint(6.963889,158.20833));(z["Pacific/Norfolk"]=new a.GeographicPoint(-29.05,167.95));(z["Antarctica/McMurdo"]=new a.GeographicPoint(-77.85,166.667));(z["Antarctica/South_Pole"]=new a.GeographicPoint(-90,0));(z["Asia/Anadyr"]=new a.GeographicPoint(64.75,177.48334));(z["Asia/Kamchatka"]=new a.GeographicPoint(57,160));var e=new a.GeographicPoint(-36.86667,174.76666);(z["Etc/GMT-12"]=e);(z["Pacific/Auckland"]=e);(z["Pacific/Fiji"]=new a.GeographicPoint(-18.133333,178.41667));(z["Pacific/Funafuti"]=new a.GeographicPoint(-8.516666,179.21666));(z["Pacific/Kwajalein"]=new a.GeographicPoint(9.1939,167.4597));(z["Pacific/Majuro"]=new a.GeographicPoint(7.1,171.38333));(z["Pacific/Nauru"]=new a.GeographicPoint(-0.5322,166.9328));(z["Pacific/Tarawa"]=new a.GeographicPoint(1.4167,173.0333));(z["Pacific/Wake"]=new a.GeographicPoint(19.2833,166.6));(z["Pacific/Wallis"]=new a.GeographicPoint(-13.273,-176.205));(z["Pacific/Chatham"]=new a.GeographicPoint(-43.883,-176.517));var n=new a.GeographicPoint(-3.133,-171.0833);(z["Etc/GMT-13"]=n);(z["Pacific/Enderbury"]=n);(z["Pacific/Tongatapu"]=new a.GeographicPoint(-21.2114,-175.153));var h=new a.GeographicPoint(1.883,-157.4);(z["Etc/GMT-14"]=h);(z["Pacific/Kiritimati"]=h);(z.MIT=g);(z.HST=B);(z.PST=f);(z.PST8PDT=f);(z.MST=l);(z.MST7MDT=l);(z.Navajo=new a.GeographicPoint(35.6728,-109.0622));(z.PNT=new a.GeographicPoint(33.448334,-112.07333));(z["America/Indiana/Knox"]=new a.GeographicPoint(41.295834,-86.625));(z["America/Indiana/Tell_City"]=new a.GeographicPoint(37.953,-86.7614));(z["America/North_Dakota/Center"]=new a.GeographicPoint(47.115,-101.3003));(z["America/North_Dakota/New_Salem"]=new a.GeographicPoint(46.843,101.4119));(z.CST=x);(z.CST6CDT=x);(z["America/Indiana/Indianapolis"]=new a.GeographicPoint(39.768333,-86.15806));(z["America/Indiana/Marengo"]=new a.GeographicPoint(36.3706,-86.3433));(z["America/Indiana/Petersburg"]=new a.GeographicPoint(38.4917,-87.2803));(z["America/Indiana/Vevay"]=new a.GeographicPoint(38.7458,-85.0711));(z["America/Indiana/Vincennes"]=new a.GeographicPoint(38.6783,-87.5164));(z["America/Indiana/Winamac"]=new a.GeographicPoint(41.0525,-86.6044));(z["America/Kentucky/Louisville"]=new a.GeographicPoint(38.2542,-85.7603));(z["America/Kentucky/Monticello"]=new a.GeographicPoint(36.8381,-84.85));(z.Cuba=new a.GeographicPoint(23.131945,-82.36417));(z.EST=p);(z.EST5EDT=p);(z.IET=p);(z.AST=new a.GeographicPoint(44.65,-63.6));(z.Jamaica=new a.GeographicPoint(18,-76.8));(z["America/Argentina/San_Luis"]=new a.GeographicPoint(-33.3,-66.333));(z.PRT=new a.GeographicPoint(18.467,66.117));(z.CNT=new a.GeographicPoint(47.5675,-52.7072));(z.AGT=new a.GeographicPoint(-34.5875,-58.6725));(z["America/Argentina/Buenos_Aires"]=new a.GeographicPoint(-34.5875,-58.6725));(z["America/Argentina/Catamarca"]=new a.GeographicPoint(-28.466667,-65.78333));(z["America/Argentina/ComodRivadavia"]=new a.GeographicPoint(-42.7578,-65.0297));(z["America/Argentina/Cordoba"]=new a.GeographicPoint(-31.4,-64.183334));(z["America/Argentina/Jujuy"]=new a.GeographicPoint(-24.183332,-65.3));(z["America/Argentina/La_Rioja"]=new a.GeographicPoint(-29.4144,-66.8552));(z["America/Argentina/Mendoza"]=new a.GeographicPoint(-32.883335,-68.816666));(z["America/Argentina/Rio_Gallegos"]=new a.GeographicPoint(-51.625,-69.2286));(z["America/Argentina/Salta"]=new a.GeographicPoint(-24.783333,-65.416664));(z["America/Argentina/San_Juan"]=new a.GeographicPoint(-31.5333,-68.5167));(z["America/Argentina/Tucuman"]=new a.GeographicPoint(-26.8167,65.2167));(z["America/Argentina/Ushuaia"]=new a.GeographicPoint(-54.6,-68.3));(z.BET=y);(z.Eire=new a.GeographicPoint(53.333057,-6.248889));(z.GB=r);(z["GB-Eire"]=new a.GeographicPoint(53.333057,-6.248889));(z.GMT=r);(z.GMT0=r);(z.Greenwich=r);(z.Iceland=new a.GeographicPoint(64.1333,-21.9333));(z.Portugal=new a.GeographicPoint(38.716667,-9.133333));(z.UCT=r);(z.UTC=r);(z.Universal=r);(z.WET=r);(z.Zulu=r);(z.CET=C);(z.ECT=C);(z.MET=new a.GeographicPoint(35.671944,51.424446));(z.Poland=new a.GeographicPoint(52.25,21));(z.ART=new a.GeographicPoint(-34.5875,-58.6725));(z.CAT=new a.GeographicPoint(-1.9536111,30.060556));(z.EET=new a.GeographicPoint(37.983334,23.733334));(z.Egypt=new a.GeographicPoint(30.05,31.25));(z.Israel=new a.GeographicPoint(32.066666,34.766666));(z.Libya=new a.GeographicPoint(32.8925,13.18));(z.Turkey=new a.GeographicPoint(41.018612,28.964722));(z.EAT=new a.GeographicPoint(-1.2833333,36.816666));(z["W-SU"]=E);(z.Iran=new a.GeographicPoint(35.671944,51.424446));(z.NET=new a.GeographicPoint(40.18111,44.51361));(z.PLT=new a.GeographicPoint(24.866667,67.05));(z.IST=d);(z.BST=t);(z.VST=q);(z.CTT=u);(z.Hongkong=new a.GeographicPoint(22.283333,114.15));(z.PRC=u);(z.Singapore=new a.GeographicPoint(1.2930557,103.855835));(z.JST=j);(z.Japan=j);(z.ROK=new a.GeographicPoint(37.566387,126.999725));(z.ACT=new a.GeographicPoint(-35.283333,149.21666));(z.AET=o);(z.SST=new a.GeographicPoint(-28.4667,159.8167));(z.Kwajalein=new a.GeographicPoint(9.1939,167.4597));(z.NST=e);(z.NZ=e);(z["NZ-CHAT"]=new a.GeographicPoint(-43.883,-176.517));a.timeZoneGeographicPointsReference=(z)}var w=(function(F,G){return F[G]===undefined?null:F[G]})(z,"UTC");if(w==null){w=(function(F,G){return F[G]===undefined?null:F[G]})(z,"Etc/GMT")}this.latitude=(function(F){return F*Math.PI/180})(w.getLatitudeInDegrees());this.longitude=(function(F){return F*Math.PI/180})(w.getLongitudeInDegrees())};a.timeZoneGeographicPointsReference=null;return a}(HomeObject));Compass.__class="com.eteks.sweethome3d.model.Compass";Compass.__interfaces=["com.eteks.sweethome3d.model.Selectable"];(function(a){var b=(function(){function c(d,e){if(this.latitudeInDegrees===undefined){this.latitudeInDegrees=0}if(this.longitudeInDegrees===undefined){this.longitudeInDegrees=0}this.latitudeInDegrees=d;this.longitudeInDegrees=e}c.prototype.getLatitudeInDegrees=function(){return this.latitudeInDegrees};c.prototype.getLongitudeInDegrees=function(){return this.longitudeInDegrees};return c}());a.GeographicPoint=b;b.__class="com.eteks.sweethome3d.model.Compass.GeographicPoint"})(Compass||(Compass={}));Compass.__transients=["pointsCache","dateCache","sunElevationCache","sunAzimuthCache","propertyChangeSupport"];var Wall=(function(a){__extends(b,a);function b(G,t,H,v,I,z,d,p){var j=this;if(((typeof G==="string")||G===null)&&((typeof t==="number")||t===null)&&((typeof H==="number")||H===null)&&((typeof v==="number")||v===null)&&((typeof I==="number")||I===null)&&((typeof z==="number")||z===null)&&((typeof d==="number")||d===null)&&((p!=null&&(p.constructor!=null&&p.constructor.__interfaces!=null&&p.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||p===null)){var P=arguments;j=a.call(this,G)||this;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true;j.xStart=t;j.yStart=H;j.xEnd=v;j.yEnd=I;j.thickness=z;j.height=d;j.pattern=p}else{if(((typeof G==="string")||G===null)&&((typeof t==="number")||t===null)&&((typeof H==="number")||H===null)&&((typeof v==="number")||v===null)&&((typeof I==="number")||I===null)&&((typeof z==="number")||z===null)&&((typeof d==="number")||d===null)&&p===undefined){var P=arguments;var s=arguments;var y=null;j=a.call(this,G)||this;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true;j.xStart=t;j.yStart=H;j.xEnd=v;j.yEnd=I;j.thickness=z;j.height=d;j.pattern=y;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true}else{if(((typeof G==="number")||G===null)&&((typeof t==="number")||t===null)&&((typeof H==="number")||H===null)&&((typeof v==="number")||v===null)&&((typeof I==="number")||I===null)&&((typeof z==="number")||z===null)&&((d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||d===null)&&p===undefined){var P=arguments;var M=P[0];var S=P[1];var k=P[2];var F=P[3];var C=P[4];var f=P[5];var x=P[6];var r=arguments;var O=HomeObject.createId("wall");j=a.call(this,O)||this;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true;j.xStart=M;j.yStart=S;j.xEnd=k;j.yEnd=F;j.thickness=C;j.height=f;j.pattern=x;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true}else{if(((typeof G==="number")||G===null)&&((typeof t==="number")||t===null)&&((typeof H==="number")||H===null)&&((typeof v==="number")||v===null)&&((typeof I==="number")||I===null)&&((typeof z==="number")||z===null)&&d===undefined&&p===undefined){var P=arguments;var K=P[0];var R=P[1];var h=P[2];var E=P[3];var B=P[4];var e=P[5];var q=arguments;var w=null;var o=arguments;var N=HomeObject.createId("wall");j=a.call(this,N)||this;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true;j.xStart=K;j.yStart=R;j.xEnd=h;j.yEnd=E;j.thickness=B;j.height=e;j.pattern=w;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true}else{if(((typeof G==="number")||G===null)&&((typeof t==="number")||t===null)&&((typeof H==="number")||H===null)&&((typeof v==="number")||v===null)&&((typeof I==="number")||I===null)&&z===undefined&&d===undefined&&p===undefined){var P=arguments;var J=P[0];var Q=P[1];var g=P[2];var D=P[3];var A=P[4];var n=arguments;var c=0;var m=arguments;var u=null;var l=arguments;var L=HomeObject.createId("wall");j=a.call(this,L)||this;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true;j.xStart=J;j.yStart=Q;j.xEnd=g;j.yEnd=D;j.thickness=A;j.height=c;j.pattern=u;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true;if(j.xStart===undefined){j.xStart=0}if(j.yStart===undefined){j.yStart=0}if(j.xEnd===undefined){j.xEnd=0}if(j.yEnd===undefined){j.yEnd=0}if(j.arcExtent===undefined){j.arcExtent=null}if(j.wallAtStart===undefined){j.wallAtStart=null}if(j.wallAtEnd===undefined){j.wallAtEnd=null}if(j.thickness===undefined){j.thickness=0}if(j.height===undefined){j.height=null}if(j.heightAtEnd===undefined){j.heightAtEnd=null}if(j.leftSideColor===undefined){j.leftSideColor=null}if(j.leftSideTexture===undefined){j.leftSideTexture=null}if(j.leftSideShininess===undefined){j.leftSideShininess=0}if(j.leftSideBaseboard===undefined){j.leftSideBaseboard=null}if(j.rightSideColor===undefined){j.rightSideColor=null}if(j.rightSideTexture===undefined){j.rightSideTexture=null}if(j.rightSideShininess===undefined){j.rightSideShininess=0}if(j.rightSideBaseboard===undefined){j.rightSideBaseboard=null}if(j.pattern===undefined){j.pattern=null}if(j.topColor===undefined){j.topColor=null}if(j.level===undefined){j.level=null}if(j.shapeCache===undefined){j.shapeCache=null}if(j.arcCircleCenterCache===undefined){j.arcCircleCenterCache=null}if(j.pointsCache===undefined){j.pointsCache=null}if(j.pointsIncludingBaseboardsCache===undefined){j.pointsIncludingBaseboardsCache=null}j.symmetric=true}else{throw new Error("invalid overload")}}}}}return j}b.prototype.getXStart=function(){return this.xStart};b.prototype.setXStart=function(d){if(d!==this.xStart){var c=this.xStart;this.xStart=d;this.clearPointsCache();this.arcCircleCenterCache=null;this.firePropertyChange("X_START",c,d)}};b.prototype.getYStart=function(){return this.yStart};b.prototype.setYStart=function(d){if(d!==this.yStart){var c=this.yStart;this.yStart=d;this.clearPointsCache();this.arcCircleCenterCache=null;this.firePropertyChange("Y_START",c,d)}};b.prototype.getXEnd=function(){return this.xEnd};b.prototype.setXEnd=function(c){if(c!==this.xEnd){var d=this.xEnd;this.xEnd=c;this.clearPointsCache();this.arcCircleCenterCache=null;this.firePropertyChange("X_END",d,c)}};b.prototype.getYEnd=function(){return this.yEnd};b.prototype.setYEnd=function(c){if(c!==this.yEnd){var d=this.yEnd;this.yEnd=c;this.clearPointsCache();this.arcCircleCenterCache=null;this.firePropertyChange("Y_END",d,c)}};b.prototype.getLength=function(){if(this.arcExtent==null||this.arcExtent===0){return java.awt.geom.Point2D.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)}else{var d=this.getArcCircleCenter();var c=java.awt.geom.Point2D.distance(this.xStart,this.yStart,d[0],d[1]);return Math.abs(this.arcExtent)*c}};b.prototype.getStartPointToEndPointDistance=function(){return java.awt.geom.Point2D.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)};b.prototype.setArcExtent=function(d){if(d!==this.arcExtent&&(d==null||!(d===this.arcExtent))){var c=this.arcExtent;this.arcExtent=d;this.clearPointsCache();this.arcCircleCenterCache=null;this.firePropertyChange("ARC_EXTENT",c,d)}};b.prototype.getArcExtent=function(){return this.arcExtent};b.prototype.getXArcCircleCenter=function(){if(this.arcExtent==null){return(this.xStart+this.xEnd)/2}else{return this.getArcCircleCenter()[0]}};b.prototype.getYArcCircleCenter=function(){if(this.arcExtent==null){return(this.yStart+this.yEnd)/2}else{return this.getArcCircleCenter()[1]}};b.prototype.getArcCircleCenter=function(){if(this.arcCircleCenterCache==null){var f=java.awt.geom.Point2D.distance(this.xStart,this.yStart,this.xEnd,this.yEnd);var e=Math.abs(this.arcExtent)>Math.PI?-(Math.PI+this.arcExtent)/2:(Math.PI-this.arcExtent)/2;var d=-(Math.tan(e)*f/2);var g=(this.xStart+this.xEnd)/2;var c=(this.yStart+this.yEnd)/2;var h=Math.atan2(this.xStart-this.xEnd,this.yEnd-this.yStart);this.arcCircleCenterCache=[(g+d*Math.cos(h)),(c+d*Math.sin(h))]}return this.arcCircleCenterCache};b.prototype.getWallAtStart=function(){return this.wallAtStart};b.prototype.setWallAtStart=function(d,c){if(c===void 0){c=true}if(d!==this.wallAtStart){var e=this.wallAtStart;this.wallAtStart=d;this.clearPointsCache();this.firePropertyChange("WALL_AT_START",e,d);if(c){this.detachJoinedWall(e)}}};b.prototype.getWallAtEnd=function(){return this.wallAtEnd};b.prototype.setWallAtEnd=function(e,d){if(d===void 0){d=true}if(e!==this.wallAtEnd){var c=this.wallAtEnd;this.wallAtEnd=e;this.clearPointsCache();this.firePropertyChange("WALL_AT_END",c,e);if(d){this.detachJoinedWall(c)}}};b.prototype.detachJoinedWall=function(c){if(c!=null){if(c.getWallAtStart()===this){c.setWallAtStart(null,false)}else{if(c.getWallAtEnd()===this){c.setWallAtEnd(null,false)}}}};b.prototype.getThickness=function(){return this.thickness};b.prototype.setThickness=function(d){if(d!==this.thickness){var c=this.thickness;this.thickness=d;this.clearPointsCache();this.firePropertyChange("THICKNESS",c,d)}};b.prototype.getHeight=function(){return this.height};b.prototype.setHeight=function(c){if(c!==this.height&&(c==null||!(c===this.height))){var d=this.height;this.height=c;this.firePropertyChange("HEIGHT",d,c)}};b.prototype.getHeightAtEnd=function(){return this.heightAtEnd};b.prototype.setHeightAtEnd=function(c){if(c!==this.heightAtEnd&&(c==null||!(c===this.heightAtEnd))){var d=this.heightAtEnd;this.heightAtEnd=c;this.firePropertyChange("HEIGHT_AT_END",d,c)}};b.prototype.isTrapezoidal=function(){return this.height!=null&&this.heightAtEnd!=null&&!(this.height===this.heightAtEnd)};b.prototype.getLeftSideColor=function(){return this.leftSideColor};b.prototype.setLeftSideColor=function(c){if(c!==this.leftSideColor&&(c==null||!(c===this.leftSideColor))){var d=this.leftSideColor;this.leftSideColor=c;this.firePropertyChange("LEFT_SIDE_COLOR",d,c)}};b.prototype.getRightSideColor=function(){return this.rightSideColor};b.prototype.setRightSideColor=function(c){if(c!==this.rightSideColor&&(c==null||!(c===this.rightSideColor))){var d=this.rightSideColor;this.rightSideColor=c;this.firePropertyChange("RIGHT_SIDE_COLOR",d,c)}};b.prototype.getLeftSideTexture=function(){return this.leftSideTexture};b.prototype.setLeftSideTexture=function(d){if(d!==this.leftSideTexture&&(d==null||!d.equals(this.leftSideTexture))){var c=this.leftSideTexture;this.leftSideTexture=d;this.firePropertyChange("LEFT_SIDE_TEXTURE",c,d)}};b.prototype.getRightSideTexture=function(){return this.rightSideTexture};b.prototype.setRightSideTexture=function(c){if(c!==this.rightSideTexture&&(c==null||!c.equals(this.rightSideTexture))){var d=this.rightSideTexture;this.rightSideTexture=c;this.firePropertyChange("RIGHT_SIDE_TEXTURE",d,c)}};b.prototype.getLeftSideShininess=function(){return this.leftSideShininess};b.prototype.setLeftSideShininess=function(c){if(c!==this.leftSideShininess){var d=this.leftSideShininess;this.leftSideShininess=c;this.firePropertyChange("LEFT_SIDE_SHININESS",d,c)}};b.prototype.getRightSideShininess=function(){return this.rightSideShininess};b.prototype.setRightSideShininess=function(d){if(d!==this.rightSideShininess){var c=this.rightSideShininess;this.rightSideShininess=d;this.firePropertyChange("RIGHT_SIDE_SHININESS",c,d)}};b.prototype.getLeftSideBaseboard=function(){return this.leftSideBaseboard};b.prototype.setLeftSideBaseboard=function(d){if(d!==this.leftSideBaseboard&&(d==null||!d.equals(this.leftSideBaseboard))){var c=this.leftSideBaseboard;this.leftSideBaseboard=d;this.clearPointsCache();this.firePropertyChange("LEFT_SIDE_BASEBOARD",c,d)}};b.prototype.getRightSideBaseboard=function(){return this.rightSideBaseboard};b.prototype.setRightSideBaseboard=function(c){if(c!==this.rightSideBaseboard&&(c==null||!c.equals(this.rightSideBaseboard))){var d=this.rightSideBaseboard;this.rightSideBaseboard=c;this.clearPointsCache();this.firePropertyChange("RIGHT_SIDE_BASEBOARD",d,c)}};b.prototype.getPattern=function(){return this.pattern};b.prototype.setPattern=function(d){if(this.pattern!==d){var c=this.pattern;this.pattern=d;this.firePropertyChange("PATTERN",c,d)}};b.prototype.getTopColor=function(){return this.topColor};b.prototype.setTopColor=function(c){if(this.topColor!==c&&(c==null||!(c===this.topColor))){var d=this.topColor;this.topColor=c;this.firePropertyChange("TOP_COLOR",d,c)}};b.prototype.getLevel=function(){return this.level};b.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};b.prototype.isAtLevel=function(e){if(this.level===e){return true}else{if(this.level!=null&&e!=null){var c=this.level.getElevation();var d=e.getElevation();return c===d&&this.level.getElevationIndex()<e.getElevationIndex()||c<d&&c+this.getWallMaximumHeight()>d}else{return false}}};b.prototype.getWallMaximumHeight=function(){if(this.height==null){return 0}else{if(this.isTrapezoidal()){return Math.max(this.height,this.heightAtEnd)}else{return this.height}}};b.prototype.clearPointsCache=function(){this.shapeCache=null;this.pointsCache=null;this.pointsIncludingBaseboardsCache=null;if(this.wallAtStart!=null){this.wallAtStart.pointsCache=null;this.wallAtStart.pointsIncludingBaseboardsCache=null}if(this.wallAtEnd!=null){this.wallAtEnd.pointsCache=null;this.wallAtEnd.pointsIncludingBaseboardsCache=null}};b.prototype.getPoints$=function(){return this.getPoints$boolean(false)};b.prototype.getPoints$boolean=function(c){if(c&&(this.leftSideBaseboard!=null||this.rightSideBaseboard!=null)){if(this.pointsIncludingBaseboardsCache==null){this.pointsIncludingBaseboardsCache=this.getShapePoints(true)}return this.clonePoints(this.pointsIncludingBaseboardsCache)}else{if(this.pointsCache==null){this.pointsCache=this.getShapePoints(false)}return this.clonePoints(this.pointsCache)}};b.prototype.getPoints=function(c){if(((typeof c==="boolean")||c===null)){return this.getPoints$boolean(c)}else{if(c===undefined){return this.getPoints$()}else{throw new Error("invalid overload")}}};b.prototype.clonePoints=function(d){var e=(function(g){var f=[];while(g-->0){f.push(null)}return f})(d.length);for(var c=0;c<d.length;c++){e[c]=d[c].slice(0)}return e};b.prototype.getShapePoints=function(n){var A=0.01;var c=this.getUnjoinedShapePoints(n);var x=0;var j=c.length-1;var u=(c.length/2|0)-1;var p=(c.length/2|0);var v=2*this.thickness;if(this.wallAtStart!=null){var z=this.wallAtStart.getUnjoinedShapePoints(n);var w=0;var t=z.length-1;var g=(z.length/2|0)-1;var h=(z.length/2|0);var o=this.wallAtStart.getWallAtEnd()===this&&(this.wallAtStart.getWallAtStart()!==this||(this.wallAtStart.xEnd===this.xStart&&this.wallAtStart.yEnd===this.yStart));var y=this.wallAtStart.getWallAtStart()===this&&(this.wallAtStart.getWallAtEnd()!==this||(this.wallAtStart.xStart===this.xStart&&this.wallAtStart.yStart===this.yStart));var l=n?this.wallAtStart.pointsIncludingBaseboardsCache:this.wallAtStart.pointsCache;if(o){this.computeIntersection(c[x],c[x+1],z[g],z[g-1],v);this.computeIntersection(c[j],c[j-1],z[h],z[h+1],v);if(l!=null){if(Math.abs(c[x][0]-l[g][0])<A&&Math.abs(c[x][1]-l[g][1])<A){c[x]=l[g]}if(Math.abs(c[j][0]-l[h][0])<A&&Math.abs(c[j][1]-l[h][1])<A){c[j]=l[h]}}}else{if(y){this.computeIntersection(c[x],c[x+1],z[t],z[t-1],v);this.computeIntersection(c[j],c[j-1],z[w],z[w+1],v);if(l!=null){if(Math.abs(c[x][0]-l[t][0])<A&&Math.abs(c[x][1]-l[t][1])<A){c[x]=l[t]}if(l!=null&&Math.abs(c[j][0]-l[w][0])<A&&Math.abs(c[j][1]-l[w][1])<A){c[j]=l[w]}}}}}if(this.wallAtEnd!=null){var d=this.wallAtEnd.getUnjoinedShapePoints(n);var m=0;var r=d.length-1;var s=(d.length/2|0)-1;var k=(d.length/2|0);var q=this.wallAtEnd.getWallAtStart()===this&&(this.wallAtEnd.getWallAtEnd()!==this||(this.wallAtEnd.xStart===this.xEnd&&this.wallAtEnd.yStart===this.yEnd));var f=this.wallAtEnd.getWallAtEnd()===this&&(this.wallAtEnd.getWallAtStart()!==this||(this.wallAtEnd.xEnd===this.xEnd&&this.wallAtEnd.yEnd===this.yEnd));var e=n?this.wallAtEnd.pointsIncludingBaseboardsCache:this.wallAtEnd.pointsCache;if(q){this.computeIntersection(c[u],c[u-1],d[m],d[m+1],v);this.computeIntersection(c[p],c[p+1],d[r],d[r-1],v);if(e!=null){if(Math.abs(c[u][0]-e[m][0])<A&&Math.abs(c[u][1]-e[m][1])<A){c[u]=e[m]}if(Math.abs(c[p][0]-e[r][0])<A&&Math.abs(c[p][1]-e[r][1])<A){c[p]=e[r]}}}else{if(f){this.computeIntersection(c[u],c[u-1],d[k],d[k+1],v);this.computeIntersection(c[p],c[p+1],d[s],d[s-1],v);if(e!=null){if(Math.abs(c[u][0]-e[k][0])<A&&Math.abs(c[u][1]-e[k][1])<A){c[u]=e[k]}if(Math.abs(c[p][0]-e[s][0])<A&&Math.abs(c[p][1]-e[s][1])<A){c[p]=e[s]}}}}}return c};b.prototype.getUnjoinedShapePoints=function(k){if(this.arcExtent!=null&&this.arcExtent!==0&&java.awt.geom.Point2D.distanceSq(this.xStart,this.yStart,this.xEnd,this.yEnd)>1e-10){var h=this.getArcCircleCenter();var u=Math.atan2(h[1]-this.yStart,h[0]-this.xStart);u+=2*Math.atan2(this.yStart-this.yEnd,this.xEnd-this.xStart);var t=java.awt.geom.Point2D.distance(h[0],h[1],this.xStart,this.yStart);var e=t+this.thickness/2;var p=Math.max(0,t-this.thickness/2);var s=e*Math.abs(this.arcExtent);var q=this.arcExtent/Math.sqrt(s);var g=((this.arcExtent/q)|0);if(k){if(q>0){if(this.leftSideBaseboard!=null){e+=this.leftSideBaseboard.getThickness()}if(this.rightSideBaseboard!=null){p-=this.rightSideBaseboard.getThickness()}}else{if(this.leftSideBaseboard!=null){p-=this.leftSideBaseboard.getThickness()}if(this.rightSideBaseboard!=null){e+=this.rightSideBaseboard.getThickness()}}}var c=([]);if(this.symmetric){if(Math.abs(this.arcExtent-g*q)>0.000001){q=this.arcExtent/++g}for(var v=0;v<=g;v++){this.computeRoundWallShapePoint(c,u+this.arcExtent-v*q,v,q,h,e,p)}}else{var v=0;for(var w=this.arcExtent;q>0?w>=q*0.1:w<=-q*0.1;w-=q,v++){this.computeRoundWallShapePoint(c,u+w,v,q,h,e,p)}this.computeRoundWallShapePoint(c,u,v,q,h,e,p)}return c.slice(0)}else{var w=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var d=Math.sin(w);var f=Math.cos(w);var n=this.thickness/2;if(k&&this.leftSideBaseboard!=null){n+=this.leftSideBaseboard.getThickness()}var l=d*n;var j=f*n;var r=this.thickness/2;if(k&&this.rightSideBaseboard!=null){r+=this.rightSideBaseboard.getThickness()}var o=d*r;var m=f*r;return[[this.xStart+l,this.yStart-j],[this.xEnd+l,this.yEnd-j],[this.xEnd-o,this.yEnd+m],[this.xStart-o,this.yStart+m]]}};b.prototype.computeRoundWallShapePoint=function(n,e,g,d,l,c,h){var m=Math.cos(e);var k=Math.sin(e);var f=[(l[0]+h*m),(l[1]-h*k)];var j=[(l[0]+c*m),(l[1]-c*k)];if(d>0){n.splice(g,0,f);n.splice(n.length-1-g,0,j)}else{n.splice(g,0,j);n.splice(n.length-1-g,0,f)}};b.prototype.computeIntersection=function(l,j,h,g,c){var o=(j[1]-l[1])/(j[0]-l[0]);var n=(g[1]-h[1])/(g[0]-h[0]);if(o!==n){var m=l[0];var k=l[1];if(Math.abs(o)>4000){if(Math.abs(n)<4000){m=l[0];var e=g[1]-n*g[0];k=n*m+e}}else{if(Math.abs(n)>4000){if(Math.abs(o)<4000){m=h[0];var f=j[1]-o*j[0];k=o*m+f}}else{var d=(function(p){if(p>0){return 1}else{if(p<0){return -1}else{return 0}}})(o)===(function(p){if(p>0){return 1}else{if(p<0){return -1}else{return 0}}})(n);if(Math.abs(o-n)>0.00001&&(!d||(Math.abs(o)>Math.abs(n)?o/n:n/o)>1.004)){var f=j[1]-o*j[0];var e=g[1]-n*g[0];m=(e-f)/(o-n);k=o*m+f}}}if(java.awt.geom.Point2D.distanceSq(m,k,l[0],l[1])<c*c){l[0]=m;l[1]=k}}};b.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape(false).intersects(d)};b.prototype.containsPoint$float$float$float=function(c,e,d){return this.containsPoint$float$float$boolean$float(c,e,false,d)};b.prototype.containsPoint$float$float$boolean$float=function(c,f,e,d){return this.containsShapeAtWithMargin(this.getShape(e),c,f,d)};b.prototype.containsPoint=function(c,f,e,d){if(((typeof c==="number")||c===null)&&((typeof f==="number")||f===null)&&((typeof e==="boolean")||e===null)&&((typeof d==="number")||d===null)){return this.containsPoint$float$float$boolean$float(c,f,e,d)}else{if(((typeof c==="number")||c===null)&&((typeof f==="number")||f===null)&&((typeof e==="number")||e===null)&&d===undefined){return this.containsPoint$float$float$float(c,f,e)}else{throw new Error("invalid overload")}}};b.prototype.isMiddlePointAt=function(c,j,h){var g=this.getPoints$();var f=(g.length/4|0);var e=g.length-1-f;var d=g.length%4===0?new java.awt.geom.Line2D.Float((g[f-1][0]+g[f][0])/2,(g[f-1][1]+g[f][1])/2,(g[e][0]+g[e+1][0])/2,(g[e][1]+g[e+1][1])/2):new java.awt.geom.Line2D.Float(g[f][0],g[f][1],g[e][0],g[e][1]);return this.containsShapeAtWithMargin(d,c,j,h)};b.prototype.containsWallStartAt=function(c,g,e){var d=this.getPoints$();var f=new java.awt.geom.Line2D.Float(d[0][0],d[0][1],d[d.length-1][0],d[d.length-1][1]);return this.containsShapeAtWithMargin(f,c,g,e)};b.prototype.containsWallEndAt=function(c,g,f){var d=this.getPoints$();var e=new java.awt.geom.Line2D.Float(d[(d.length/2|0)-1][0],d[(d.length/2|0)-1][1],d[(d.length/2|0)][0],d[(d.length/2|0)][1]);return this.containsShapeAtWithMargin(e,c,g,f)};b.prototype.containsShapeAtWithMargin=function(d,c,f,e){if(e===0){return d.contains(c,f)}else{return d.intersects(c-e,f-e,2*e,2*e)}};b.prototype.getShape=function(f){if(this.shapeCache==null){var c=this.getPoints$boolean(f);var e=new java.awt.geom.GeneralPath();e.moveTo(c[0][0],c[0][1]);for(var d=1;d<c.length;d++){e.lineTo(c[d][0],c[d][1])}e.closePath();this.shapeCache=e}return this.shapeCache};b.prototype.move=function(d,c){this.setXStart(this.getXStart()+d);this.setYStart(this.getYStart()+c);this.setXEnd(this.getXEnd()+d);this.setYEnd(this.getYEnd()+c)};b.duplicate=function(e){var f=([]);for(var d=0;d<e.length;d++){var c=e[d];(f.push(c.duplicate())>0)}b.updateBoundWalls(f,e);return f};b.clone=function(e){var f=([]);for(var d=0;d<e.length;d++){var c=e[d];(f.push((function(h){if(h.clone!=undefined){return h.clone()}else{var j=Object.create(h);for(var g in h){if(h.hasOwnProperty(g)){j[g]=h[g]}}return j}})(c))>0)}b.updateBoundWalls(f,e);return f};b.updateBoundWalls=function(g,d){for(var e=0;e<d.length;e++){var c=d[e];var f=d.indexOf(c.getWallAtStart());if(f!==-1){g[e].setWallAtStart(g[f])}var h=d.indexOf(c.getWallAtEnd());if(h!==-1){g[e].setWallAtEnd(g[h])}}};b.prototype.clone=function(){var d=this;var c=(function(f){if(a.prototype.clone!=undefined){return a.prototype.clone.call(d)}else{var g=Object.create(f);for(var e in f){if(f.hasOwnProperty(e)){g[e]=f[e]}}return g}})(this);c.wallAtStart=null;c.wallAtEnd=null;c.level=null;c.shapeCache=null;c.pointsCache=null;c.pointsIncludingBaseboardsCache=null;return c};return b}(HomeObject));Wall.__class="com.eteks.sweethome3d.model.Wall";Wall.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"];Wall.__transients=["shapeCache","arcCircleCenterCache","pointsCache","pointsIncludingBaseboardsCache","propertyChangeSupport"];var DimensionLine=(function(b){__extends(a,b);function a(e,m,r,d,p,h){var k=this;if(((typeof e==="string")||e===null)&&((typeof m==="number")||m===null)&&((typeof r==="number")||r===null)&&((typeof d==="number")||d===null)&&((typeof p==="number")||p===null)&&((typeof h==="number")||h===null)){var l=arguments;k=b.call(this,e)||this;if(k.xStart===undefined){k.xStart=0}if(k.yStart===undefined){k.yStart=0}if(k.xEnd===undefined){k.xEnd=0}if(k.yEnd===undefined){k.yEnd=0}if(k.offset===undefined){k.offset=0}if(k.lengthStyle===undefined){k.lengthStyle=null}if(k.level===undefined){k.level=null}if(k.shapeCache===undefined){k.shapeCache=null}k.xStart=m;k.yStart=r;k.xEnd=d;k.yEnd=p;k.offset=h}else{if(((typeof e==="number")||e===null)&&((typeof m==="number")||m===null)&&((typeof r==="number")||r===null)&&((typeof d==="number")||d===null)&&((typeof p==="number")||p===null)&&h===undefined){var l=arguments;var q=l[0];var n=l[1];var j=l[2];var o=l[3];var g=l[4];var f=arguments;var c=HomeObject.createId("dimensionLine");k=b.call(this,c)||this;if(k.xStart===undefined){k.xStart=0}if(k.yStart===undefined){k.yStart=0}if(k.xEnd===undefined){k.xEnd=0}if(k.yEnd===undefined){k.yEnd=0}if(k.offset===undefined){k.offset=0}if(k.lengthStyle===undefined){k.lengthStyle=null}if(k.level===undefined){k.level=null}if(k.shapeCache===undefined){k.shapeCache=null}k.xStart=q;k.yStart=n;k.xEnd=j;k.yEnd=o;k.offset=g;if(k.xStart===undefined){k.xStart=0}if(k.yStart===undefined){k.yStart=0}if(k.xEnd===undefined){k.xEnd=0}if(k.yEnd===undefined){k.yEnd=0}if(k.offset===undefined){k.offset=0}if(k.lengthStyle===undefined){k.lengthStyle=null}if(k.level===undefined){k.level=null}if(k.shapeCache===undefined){k.shapeCache=null}}else{throw new Error("invalid overload")}}return k}a.prototype.getXStart=function(){return this.xStart};a.prototype.setXStart=function(d){if(d!==this.xStart){var c=this.xStart;this.xStart=d;this.shapeCache=null;this.firePropertyChange("X_START",c,d)}};a.prototype.getYStart=function(){return this.yStart};a.prototype.setYStart=function(d){if(d!==this.yStart){var c=this.yStart;this.yStart=d;this.shapeCache=null;this.firePropertyChange("Y_START",c,d)}};a.prototype.getXEnd=function(){return this.xEnd};a.prototype.setXEnd=function(c){if(c!==this.xEnd){var d=this.xEnd;this.xEnd=c;this.shapeCache=null;this.firePropertyChange("X_END",d,c)}};a.prototype.getYEnd=function(){return this.yEnd};a.prototype.setYEnd=function(c){if(c!==this.yEnd){var d=this.yEnd;this.yEnd=c;this.shapeCache=null;this.firePropertyChange("Y_END",d,c)}};a.prototype.getOffset=function(){return this.offset};a.prototype.setOffset=function(d){if(d!==this.offset){var c=this.offset;this.offset=d;this.shapeCache=null;this.firePropertyChange("OFFSET",c,d)}};a.prototype.getLength=function(){return java.awt.geom.Point2D.distance(this.getXStart(),this.getYStart(),this.getXEnd(),this.getYEnd())};a.prototype.getLengthStyle=function(){return this.lengthStyle};a.prototype.setLengthStyle=function(c){if(c!==this.lengthStyle){var d=this.lengthStyle;this.lengthStyle=c;this.firePropertyChange("LENGTH_STYLE",d,c)}};a.prototype.getLevel=function(){return this.level};a.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};a.prototype.isAtLevel=function(c){return this.level===c||this.level!=null&&c!=null&&this.level.getElevation()===c.getElevation()&&this.level.getElevationIndex()<c.getElevationIndex()};a.prototype.getPoints=function(){var e=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var d=-Math.sin(e)*this.offset;var c=Math.cos(e)*this.offset;return[[this.xStart,this.yStart],[this.xStart+d,this.yStart+c],[this.xEnd+d,this.yEnd+c],[this.xEnd,this.yEnd]]};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape().intersects(d)};a.prototype.containsPoint=function(c,e,d){return this.containsShapeAtWithMargin(this.getShape(),c,e,d)};a.prototype.isMiddlePointAt=function(c,k,g){var h=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var e=-Math.sin(h)*this.offset;var d=Math.cos(h)*this.offset;var j=(this.xStart+this.xEnd)/2+e;var f=(this.yStart+this.yEnd)/2+d;return Math.abs(c-j)<=g&&Math.abs(k-f)<=g};a.prototype.containsStartExtensionLinetAt=function(c,g,e){var f=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var d=new java.awt.geom.Line2D.Float(this.xStart,this.yStart,this.xStart+-Math.sin(f)*this.offset,this.yStart+Math.cos(f)*this.offset);return this.containsShapeAtWithMargin(d,c,g,e)};a.prototype.containsEndExtensionLineAt=function(d,g,e){var f=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var c=new java.awt.geom.Line2D.Float(this.xEnd,this.yEnd,this.xEnd+-Math.sin(f)*this.offset,this.yEnd+Math.cos(f)*this.offset);return this.containsShapeAtWithMargin(c,d,g,e)};a.prototype.containsShapeAtWithMargin=function(d,c,f,e){if(e===0){return d.contains(c,f)}else{return d.intersects(c-e,f-e,2*e,2*e)}};a.prototype.getShape=function(){if(this.shapeCache==null){var f=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var d=-Math.sin(f)*this.offset;var c=Math.cos(f)*this.offset;var e=new java.awt.geom.GeneralPath();e.append(new java.awt.geom.Line2D.Float(this.xStart+d,this.yStart+c,this.xEnd+d,this.yEnd+c),false);e.append(new java.awt.geom.Line2D.Float(this.xStart,this.yStart,this.xStart+d,this.yStart+c),false);e.append(new java.awt.geom.Line2D.Float(this.xEnd,this.yEnd,this.xEnd+d,this.yEnd+c),false);this.shapeCache=e}return this.shapeCache};a.prototype.move=function(d,c){this.setXStart(this.getXStart()+d);this.setYStart(this.getYStart()+c);this.setXEnd(this.getXEnd()+d);this.setYEnd(this.getYEnd()+c)};a.prototype.clone=function(){var d=this;var c=(function(g){if(b.prototype.clone!=undefined){return b.prototype.clone.call(d)}else{var f=Object.create(g);for(var e in g){if(g.hasOwnProperty(e)){f[e]=g[e]}}return f}})(this);c.level=null;return c};return a}(HomeObject));DimensionLine.__class="com.eteks.sweethome3d.model.DimensionLine";DimensionLine.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"];DimensionLine.__transients=["shapeCache","propertyChangeSupport"];var Camera=(function(b){__extends(a,b);function a(t,q,n,k,o,l,J,h,N){var w=this;if(((typeof t==="string")||t===null)&&((typeof q==="number")||q===null)&&((typeof n==="number")||n===null)&&((typeof k==="number")||k===null)&&((typeof o==="number")||o===null)&&((typeof l==="number")||l===null)&&((typeof J==="number")||J===null)&&((typeof h==="number")||h===null)&&((typeof N==="number")||N===null)){var g=arguments;w=b.call(this,t)||this;if(w.name===undefined){w.name=null}if(w.x===undefined){w.x=0}if(w.y===undefined){w.y=0}if(w.z===undefined){w.z=0}if(w.yaw===undefined){w.yaw=0}if(w.pitch===undefined){w.pitch=0}if(w.fieldOfView===undefined){w.fieldOfView=0}if(w.time===undefined){w.time=0}if(w.lens===undefined){w.lens=null}if(w.lensName===undefined){w.lensName=null}w.x=q;w.y=n;w.z=k;w.yaw=o;w.pitch=l;w.fieldOfView=J;w.time=h;w.lens=N}else{if(((typeof t==="number")||t===null)&&((typeof q==="number")||q===null)&&((typeof n==="number")||n===null)&&((typeof k==="number")||k===null)&&((typeof o==="number")||o===null)&&((typeof l==="number")||l===null)&&((typeof J==="number")||J===null)&&((typeof h==="number")||h===null)&&N===undefined){var g=arguments;var u=g[0];var d=g[1];var F=g[2];var f=g[3];var E=g[4];var v=g[5];var p=g[6];var I=g[7];var O=arguments;var D=HomeObject.createId("camera");w=b.call(this,D)||this;if(w.name===undefined){w.name=null}if(w.x===undefined){w.x=0}if(w.y===undefined){w.y=0}if(w.z===undefined){w.z=0}if(w.yaw===undefined){w.yaw=0}if(w.pitch===undefined){w.pitch=0}if(w.fieldOfView===undefined){w.fieldOfView=0}if(w.time===undefined){w.time=0}if(w.lens===undefined){w.lens=null}if(w.lensName===undefined){w.lensName=null}w.x=u;w.y=d;w.z=F;w.yaw=f;w.pitch=E;w.fieldOfView=v;w.time=p;w.lens=I;if(w.name===undefined){w.name=null}if(w.x===undefined){w.x=0}if(w.y===undefined){w.y=0}if(w.z===undefined){w.z=0}if(w.yaw===undefined){w.yaw=0}if(w.pitch===undefined){w.pitch=0}if(w.fieldOfView===undefined){w.fieldOfView=0}if(w.time===undefined){w.time=0}if(w.lens===undefined){w.lens=null}if(w.lensName===undefined){w.lensName=null}}else{if(((typeof t==="string")||t===null)&&((typeof q==="number")||q===null)&&((typeof n==="number")||n===null)&&((typeof k==="number")||k===null)&&((typeof o==="number")||o===null)&&((typeof l==="number")||l===null)&&((typeof J==="number")||J===null)&&h===undefined&&N===undefined){var g=arguments;var M=arguments;var m=a.midday();var H=a.Lens.PINHOLE;w=b.call(this,t)||this;if(w.name===undefined){w.name=null}if(w.x===undefined){w.x=0}if(w.y===undefined){w.y=0}if(w.z===undefined){w.z=0}if(w.yaw===undefined){w.yaw=0}if(w.pitch===undefined){w.pitch=0}if(w.fieldOfView===undefined){w.fieldOfView=0}if(w.time===undefined){w.time=0}if(w.lens===undefined){w.lens=null}if(w.lensName===undefined){w.lensName=null}w.x=q;w.y=n;w.z=k;w.yaw=o;w.pitch=l;w.fieldOfView=J;w.time=m;w.lens=H;if(w.name===undefined){w.name=null}if(w.x===undefined){w.x=0}if(w.y===undefined){w.y=0}if(w.z===undefined){w.z=0}if(w.yaw===undefined){w.yaw=0}if(w.pitch===undefined){w.pitch=0}if(w.fieldOfView===undefined){w.fieldOfView=0}if(w.time===undefined){w.time=0}if(w.lens===undefined){w.lens=null}if(w.lensName===undefined){w.lensName=null}}else{if(((typeof t==="number")||t===null)&&((typeof q==="number")||q===null)&&((typeof n==="number")||n===null)&&((typeof k==="number")||k===null)&&((typeof o==="number")||o===null)&&((typeof l==="number")||l===null)&&J===undefined&&h===undefined&&N===undefined){var g=arguments;var s=g[0];var c=g[1];var C=g[2];var e=g[3];var B=g[4];var r=g[5];var L=arguments;var j=a.midday();var G=a.Lens.PINHOLE;var K=arguments;var A=HomeObject.createId("camera");w=b.call(this,A)||this;if(w.name===undefined){w.name=null}if(w.x===undefined){w.x=0}if(w.y===undefined){w.y=0}if(w.z===undefined){w.z=0}if(w.yaw===undefined){w.yaw=0}if(w.pitch===undefined){w.pitch=0}if(w.fieldOfView===undefined){w.fieldOfView=0}if(w.time===undefined){w.time=0}if(w.lens===undefined){w.lens=null}if(w.lensName===undefined){w.lensName=null}w.x=s;w.y=c;w.z=C;w.yaw=e;w.pitch=B;w.fieldOfView=r;w.time=j;w.lens=G;if(w.name===undefined){w.name=null}if(w.x===undefined){w.x=0}if(w.y===undefined){w.y=0}if(w.z===undefined){w.z=0}if(w.yaw===undefined){w.yaw=0}if(w.pitch===undefined){w.pitch=0}if(w.fieldOfView===undefined){w.fieldOfView=0}if(w.time===undefined){w.time=0}if(w.lens===undefined){w.lens=null}if(w.lensName===undefined){w.lensName=null}if(w.name===undefined){w.name=null}if(w.x===undefined){w.x=0}if(w.y===undefined){w.y=0}if(w.z===undefined){w.z=0}if(w.yaw===undefined){w.yaw=0}if(w.pitch===undefined){w.pitch=0}if(w.fieldOfView===undefined){w.fieldOfView=0}if(w.time===undefined){w.time=0}if(w.lens===undefined){w.lens=null}if(w.lensName===undefined){w.lensName=null}}else{throw new Error("invalid overload")}}}}return w}a.midday=function(){var c=new Date();(function(f,e){return f.UTC?f.setUTCHours(e):f.setHours(e)})(c,12);(function(f,e){return f.UTC?f.setUTCMinutes(e):f.setMinutes(e)})(c,0);(function(f,e){return f.UTC?f.setUTCSeconds(e):f.setSeconds(e)})(c,0);(function(f,e){return f.UTC?f.setUTCMilliseconds(e):f.setMilliseconds(e)})(c,0);return c.getTime()};a.prototype.getName=function(){return this.name};a.prototype.setName=function(c){if(c!==this.name&&(c==null||!(c===this.name))){var d=this.name;this.name=c;this.firePropertyChange("NAME",d,c)}};a.prototype.getYaw=function(){return this.yaw};a.prototype.setYaw=function(d){if(d!==this.yaw){var c=this.yaw;this.yaw=d;this.firePropertyChange("YAW",c,d)}};a.prototype.getPitch=function(){return this.pitch};a.prototype.setPitch=function(d){if(d!==this.pitch){var c=this.pitch;this.pitch=d;this.firePropertyChange("PITCH",c,d)}};a.prototype.getFieldOfView=function(){return this.fieldOfView};a.prototype.setFieldOfView=function(c){if(c!==this.fieldOfView){var d=this.fieldOfView;this.fieldOfView=c;this.firePropertyChange("FIELD_OF_VIEW",d,c)}};a.prototype.getX=function(){return this.x};a.prototype.setX=function(c){if(c!==this.x){var d=this.x;this.x=c;this.firePropertyChange("X",d,c)}};a.prototype.getY=function(){return this.y};a.prototype.setY=function(d){if(d!==this.y){var c=this.y;this.y=d;this.firePropertyChange("Y",c,d)}};a.prototype.getZ=function(){return this.z};a.prototype.setZ=function(d){if(d!==this.z){var c=this.z;this.z=d;this.firePropertyChange("Z",c,d)}};a.prototype.getTime=function(){return this.time};a.prototype.setTime=function(c){if(this.time!==c){var d=this.time;this.time=c;this.firePropertyChange("TIME",d,c)}};a.convertTimeToTimeZone=function(d,e){var f=new Date();f.setTime(d);var c=new Date();(function(h,g){return h.UTC?h.setUTCFullYear(g):h.setFullYear(g)})(c,(function(g){return g.UTC?g.getUTCFullYear():g.getFullYear()})(f));(function(h,g){return h.UTC?h.setUTCMonth(g):h.setMonth(g)})(c,(function(g){return g.UTC?g.getUTCMonth():g.getMonth()})(f));(function(h,g){return h.UTC?h.setUTCDate(g):h.setDate(g)})(c,(function(g){return g.UTC?g.getUTCDate():g.getDate()})(f));(function(h,g){return h.UTC?h.setUTCHours(g):h.setHours(g)})(c,(function(g){return g.UTC?g.getUTCHours():g.getHours()})(f));(function(h,g){return h.UTC?h.setUTCMinutes(g):h.setMinutes(g)})(c,(function(g){return g.UTC?g.getUTCMinutes():g.getMinutes()})(f));(function(h,g){return h.UTC?h.setUTCSeconds(g):h.setSeconds(g)})(c,(function(g){return g.UTC?g.getUTCSeconds():g.getSeconds()})(f));(function(h,g){return h.UTC?h.setUTCMilliseconds(g):h.setMilliseconds(g)})(c,(function(g){return g.UTC?g.getUTCMilliseconds():g.getMilliseconds()})(f));return c.getTime()};a.prototype.getLens=function(){return this.lens};a.prototype.setLens=function(c){if(c!==this.lens){var d=this.lens;this.lens=c;this.lensName=a.Lens[this.lens];this.firePropertyChange("LENS",d,c)}};a.prototype.setCamera=function(c){this.setX(c.getX());this.setY(c.getY());this.setZ(c.getZ());this.setYaw(c.getYaw());this.setPitch(c.getPitch());this.setFieldOfView(c.getFieldOfView())};a.prototype.clone=function(){var c=this;return(function(e){if(b.prototype.clone!=undefined){return b.prototype.clone.call(c)}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(this)};return a}(HomeObject));Camera.__class="com.eteks.sweethome3d.model.Camera";(function(b){var a;(function(c){c[c.PINHOLE=0]="PINHOLE";c[c.NORMAL=1]="NORMAL";c[c.FISHEYE=2]="FISHEYE";c[c.SPHERICAL=3]="SPHERICAL"})(a=b.Lens||(b.Lens={}))})(Camera||(Camera={}));Camera.__transients=["lens","propertyChangeSupport"];var Level=(function(b){__extends(a,b);function a(d,c,m,g,n){var j=this;if(((typeof d==="string")||d===null)&&((typeof c==="string")||c===null)&&((typeof m==="number")||m===null)&&((typeof g==="number")||g===null)&&((typeof n==="number")||n===null)){var k=arguments;j=b.call(this,d)||this;if(j.name===undefined){j.name=null}if(j.elevation===undefined){j.elevation=0}if(j.floorThickness===undefined){j.floorThickness=0}if(j.height===undefined){j.height=0}if(j.backgroundImage===undefined){j.backgroundImage=null}if(j.visible===undefined){j.visible=false}if(j.viewable===undefined){j.viewable=false}if(j.elevationIndex===undefined){j.elevationIndex=0}j.name=c;j.elevation=m;j.floorThickness=g;j.height=n;j.visible=true;j.viewable=true;j.elevationIndex=-1}else{if(((typeof d==="string")||d===null)&&((typeof c==="number")||c===null)&&((typeof m==="number")||m===null)&&((typeof g==="number")||g===null)&&n===undefined){var k=arguments;var h=k[0];var f=k[1];var p=k[2];var l=k[3];var e=arguments;var o=HomeObject.createId("level");j=b.call(this,o)||this;if(j.name===undefined){j.name=null}if(j.elevation===undefined){j.elevation=0}if(j.floorThickness===undefined){j.floorThickness=0}if(j.height===undefined){j.height=0}if(j.backgroundImage===undefined){j.backgroundImage=null}if(j.visible===undefined){j.visible=false}if(j.viewable===undefined){j.viewable=false}if(j.elevationIndex===undefined){j.elevationIndex=0}j.name=h;j.elevation=f;j.floorThickness=p;j.height=l;j.visible=true;j.viewable=true;j.elevationIndex=-1;if(j.name===undefined){j.name=null}if(j.elevation===undefined){j.elevation=0}if(j.floorThickness===undefined){j.floorThickness=0}if(j.height===undefined){j.height=0}if(j.backgroundImage===undefined){j.backgroundImage=null}if(j.visible===undefined){j.visible=false}if(j.viewable===undefined){j.viewable=false}if(j.elevationIndex===undefined){j.elevationIndex=0}}else{throw new Error("invalid overload")}}return j}a.prototype.getName=function(){return this.name};a.prototype.setName=function(c){if(c!==this.name&&(c==null||!(c===this.name))){var d=this.name;this.name=c;this.firePropertyChange("NAME",d,c)}};a.prototype.getElevation=function(){return this.elevation};a.prototype.setElevation=function(d){if(d!==this.elevation){var c=this.elevation;this.elevation=d;this.firePropertyChange("ELEVATION",c,d)}};a.prototype.getFloorThickness=function(){return this.floorThickness};a.prototype.setFloorThickness=function(d){if(d!==this.floorThickness){var c=this.floorThickness;this.floorThickness=d;this.firePropertyChange("FLOOR_THICKNESS",c,d)}};a.prototype.getHeight=function(){return this.height};a.prototype.setHeight=function(c){if(c!==this.height){var d=this.height;this.height=c;this.firePropertyChange("HEIGHT",d,c)}};a.prototype.getBackgroundImage=function(){return this.backgroundImage};a.prototype.setBackgroundImage=function(d){if(d!==this.backgroundImage){var c=this.backgroundImage;this.backgroundImage=d;this.firePropertyChange("BACKGROUND_IMAGE",c,d)}};a.prototype.isVisible=function(){return this.visible};a.prototype.setVisible=function(c){if(c!==this.visible){this.visible=c;this.firePropertyChange("VISIBLE",!c,c)}};a.prototype.isViewable=function(){return this.viewable};a.prototype.setViewable=function(c){if(c!==this.viewable){this.viewable=c;this.firePropertyChange("VIEWABLE",!c,c)}};a.prototype.isViewableAndVisible=function(){return this.viewable&&this.visible};a.prototype.getElevationIndex=function(){return this.elevationIndex};a.prototype.setElevationIndex=function(c){if(c!==this.elevationIndex){var d=this.elevationIndex;this.elevationIndex=c;this.firePropertyChange("ELEVATION_INDEX",d,c)}};a.prototype.clone=function(){var c=this;return(function(e){if(b.prototype.clone!=undefined){return b.prototype.clone.call(c)}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(this)};return a}(HomeObject));Level.__class="com.eteks.sweethome3d.model.Level";Level.__transients=["propertyChangeSupport"];var Polyline=(function(b){__extends(a,b);function a(L,P,q,r,u,W,K,p,c,ak,J){var k=this;if(((typeof L==="string")||L===null)&&((P!=null&&P instanceof Array&&(P.length==0||P[0]==null||P[0] instanceof Array))||P===null)&&((typeof q==="number")||q===null)&&((typeof r==="number")||r===null)&&((typeof u==="number")||u===null)&&((typeof W==="number")||W===null)&&((typeof K==="number")||K===null)&&((typeof p==="number")||p===null)&&((typeof c==="number")||c===null)&&((typeof ak==="boolean")||ak===null)&&((typeof J==="number")||J===null)){var ag=arguments;k=b.call(this,L)||this;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}k.points=k.deepCopy(P);k.thickness=q;k.capStyle=r;k.joinStyle=u;k.dashStyle=W;k.dashOffset=K;k.startArrowStyle=p;k.endArrowStyle=c;k.closedPath=ak;k.color=J}else{if(((L!=null&&L instanceof Array&&(L.length==0||L[0]==null||L[0] instanceof Array))||L===null)&&((typeof P==="number")||P===null)&&((typeof q==="number")||q===null)&&((typeof r==="number")||r===null)&&((typeof u==="number")||u===null)&&((typeof W==="number")||W===null)&&((typeof K==="number")||K===null)&&((typeof p==="number")||p===null)&&((typeof c==="boolean")||c===null)&&((typeof ak==="number")||ak===null)&&J===undefined){var ag=arguments;var aj=ag[0];var y=ag[1];var U=ag[2];var Y=ag[3];var e=ag[4];var I=ag[5];var j=ag[6];var o=ag[7];var D=ag[8];var ab=ag[9];var af=arguments;var Q=HomeObject.createId("polyline");k=b.call(this,Q)||this;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}k.points=k.deepCopy(aj);k.thickness=y;k.capStyle=U;k.joinStyle=Y;k.dashStyle=e;k.dashOffset=I;k.startArrowStyle=j;k.endArrowStyle=o;k.closedPath=D;k.color=ab;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}}else{if(((L!=null&&L instanceof Array&&(L.length==0||L[0]==null||L[0] instanceof Array))||L===null)&&((typeof P==="number")||P===null)&&((typeof q==="number")||q===null)&&((typeof r==="number")||r===null)&&((typeof u==="number")||u===null)&&((typeof W==="number")||W===null)&&((typeof K==="number")||K===null)&&((typeof p==="boolean")||p===null)&&((typeof c==="number")||c===null)&&ak===undefined&&J===undefined){var ag=arguments;var ai=ag[0];var v=ag[1];var S=ag[2];var V=ag[3];var d=ag[4];var h=ag[5];var n=ag[6];var B=ag[7];var Z=ag[8];var ae=arguments;var G=0;var ad=arguments;var A=HomeObject.createId("polyline");k=b.call(this,A)||this;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}k.points=k.deepCopy(ai);k.thickness=v;k.capStyle=S;k.joinStyle=V;k.dashStyle=d;k.dashOffset=G;k.startArrowStyle=h;k.endArrowStyle=n;k.closedPath=B;k.color=Z;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}}else{if(((typeof L==="string")||L===null)&&((P!=null&&P instanceof Array&&(P.length==0||P[0]==null||P[0] instanceof Array))||P===null)&&q===undefined&&r===undefined&&u===undefined&&W===undefined&&K===undefined&&p===undefined&&c===undefined&&ak===undefined&&J===undefined){var ag=arguments;var ac=arguments;var t=1;var O=a.CapStyle.BUTT;var R=a.JoinStyle.MITER;var am=a.DashStyle.SOLID;var E=0;var g=a.ArrowStyle.NONE;var m=a.ArrowStyle.NONE;var z=false;var X=-16777216;k=b.call(this,L)||this;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}k.points=k.deepCopy(P);k.thickness=t;k.capStyle=O;k.joinStyle=R;k.dashStyle=am;k.dashOffset=E;k.startArrowStyle=g;k.endArrowStyle=m;k.closedPath=z;k.color=X;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}}else{if(((L!=null&&L instanceof Array&&(L.length==0||L[0]==null||L[0] instanceof Array))||L===null)&&P===undefined&&q===undefined&&r===undefined&&u===undefined&&W===undefined&&K===undefined&&p===undefined&&c===undefined&&ak===undefined&&J===undefined){var ag=arguments;var ah=ag[0];var aa=arguments;var s=1;var M=a.CapStyle.BUTT;var N=a.JoinStyle.MITER;var al=a.DashStyle.SOLID;var f=a.ArrowStyle.NONE;var l=a.ArrowStyle.NONE;var x=false;var T=-16777216;var H=arguments;var C=0;var F=arguments;var w=HomeObject.createId("polyline");k=b.call(this,w)||this;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}k.points=k.deepCopy(ah);k.thickness=s;k.capStyle=M;k.joinStyle=N;k.dashStyle=al;k.dashOffset=C;k.startArrowStyle=f;k.endArrowStyle=l;k.closedPath=x;k.color=T;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}}else{throw new Error("invalid overload")}}}}}return k}a.prototype.getPoints=function(){return this.deepCopy(this.points)};a.prototype.getPointCount=function(){return this.points.length};a.prototype.deepCopy=function(e){var c=(function(g){var f=[];while(g-->0){f.push(null)}return f})(e.length);for(var d=0;d<e.length;d++){c[d]=e[d].slice(0)}return c};a.prototype.setPoints=function(c){if(!(JSON.stringify(this.points)===JSON.stringify(c))){this.updatePoints(c)}};a.prototype.updatePoints=function(d){var c=this.points;this.points=this.deepCopy(d);this.polylinePathCache=null;this.shapeCache=null;this.firePropertyChange("POINTS",c,d)};a.prototype.addPoint$float$float=function(c,d){this.addPoint$float$float$int(c,d,this.points.length)};a.prototype.addPoint$float$float$int=function(c,g,d){if(d<0||d>this.points.length){throw Object.defineProperty(new Error("Invalid index "+d),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}var f=(function(j){var h=[];while(j-->0){h.push(null)}return h})(this.points.length+1);(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(this.points,0,f,0,d);f[d]=[c,g];(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(this.points,d,f,d+1,this.points.length-d);var e=this.points;this.points=f;this.polylinePathCache=null;this.shapeCache=null;this.firePropertyChange("POINTS",e,this.deepCopy(this.points))};a.prototype.addPoint=function(c,e,d){if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&((typeof d==="number")||d===null)){return this.addPoint$float$float$int(c,e,d)}else{if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&d===undefined){return this.addPoint$float$float(c,e)}else{throw new Error("invalid overload")}}};a.prototype.setPoint=function(c,f,d){if(d<0||d>=this.points.length){throw Object.defineProperty(new Error("Invalid index "+d),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}if(this.points[d][0]!==c||this.points[d][1]!==f){var e=this.points;this.points=this.deepCopy(this.points);this.points[d][0]=c;this.points[d][1]=f;this.polylinePathCache=null;this.shapeCache=null;this.firePropertyChange("POINTS",e,this.deepCopy(this.points))}};a.prototype.removePoint=function(c){if(c<0||c>=this.points.length){throw Object.defineProperty(new Error("Invalid index "+c),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}var e=(function(g){var f=[];while(g-->0){f.push(null)}return f})(this.points.length-1);(function(k,j,m,l,h){if(k!==m||l>=j+h){while(--h>=0){m[l++]=k[j++]}}else{var g=k.slice(j,j+h);for(var f=0;f<h;f++){m[l++]=g[f]}}})(this.points,0,e,0,c);(function(k,j,m,l,h){if(k!==m||l>=j+h){while(--h>=0){m[l++]=k[j++]}}else{var g=k.slice(j,j+h);for(var f=0;f<h;f++){m[l++]=g[f]}}})(this.points,c+1,e,c,this.points.length-c-1);var d=this.points;this.points=e;this.polylinePathCache=null;this.shapeCache=null;this.firePropertyChange("POINTS",d,this.deepCopy(this.points))};a.prototype.getThickness=function(){return this.thickness};a.prototype.setThickness=function(d){if(d!==this.thickness){var c=this.thickness;this.thickness=d;this.firePropertyChange("THICKNESS",c,d)}};a.prototype.getCapStyle=function(){return this.capStyle};a.prototype.setCapStyle=function(d){if(d!==this.capStyle){var c=this.capStyle;this.capStyle=d;this.capStyleName=a.CapStyle[this.capStyle];this.firePropertyChange("CAP_STYLE",c,d)}};a.prototype.getJoinStyle=function(){return this.joinStyle};a.prototype.setJoinStyle=function(d){if(d!==this.joinStyle){var c=this.joinStyle;this.joinStyle=d;this.joinStyleName=a.JoinStyle[this.joinStyle];this.polylinePathCache=null;this.shapeCache=null;this.firePropertyChange("JOIN_STYLE",c,d)}};a.prototype.getDashStyle=function(){return this.dashStyle};a.prototype.setDashStyle=function(e){if(e!==this.dashStyle){var c=this.getDashPattern();var d=this.dashStyle;this.dashStyle=e;this.dashStyleName=a.DashStyle[this.dashStyle];if(e!==a.DashStyle.CUSTOMIZED){this.dashPattern=null}this.firePropertyChange("DASH_PATTERN",c,this.getDashPattern());this.firePropertyChange("DASH_STYLE",d,e)}};a.prototype.getDashPattern=function(){var c=null;if(this.dashStyle!==a.DashStyle.CUSTOMIZED){return a.DashStyle["_$wrappers"][this.dashStyle].getDashPattern()}else{if(this.dashPattern!=null){c=this.dashPattern.slice(0)}}return c};a.prototype.setDashPattern=function(c){var h=function(){var j=[];for(var k in a.DashStyle){if(!isNaN(k)){j.push(parseInt(k,10))}}return j}();for(var e=0;e<h.length;e++){var g=h[e];if(this.dashStyle!==a.DashStyle.CUSTOMIZED){if((function(k,j){if(k==null&&j==null){return true}if(k==null||j==null){return false}if(k.length!=j.length){return false}for(var l=0;l<k.length;l++){if(k[l]!=j[l]){return false}}return true})(c,a.DashStyle["_$wrappers"][g].getDashPattern())){this.setDashStyle(g);return}}}if(!(function(k,j){if(k==null&&j==null){return true}if(k==null||j==null){return false}if(k.length!=j.length){return false}for(var l=0;l<k.length;l++){if(k[l]!=j[l]){return false}}return true})(c,this.dashPattern)){var d=this.getDashPattern();this.dashPattern=c.slice(0);this.firePropertyChange("DASH_PATTERN",d,c);var f=this.dashStyle;this.dashStyle=a.DashStyle.CUSTOMIZED;this.dashStyleName=a.DashStyle[this.dashStyle];this.firePropertyChange("DASH_STYLE",f,a.DashStyle.CUSTOMIZED)}};a.prototype.getDashOffset=function(){return this.dashOffset};a.prototype.setDashOffset=function(d){if(d!==this.dashOffset){var c=this.dashOffset;this.dashOffset=d;this.firePropertyChange("DASH_OFFSET",c,d)}};a.prototype.getStartArrowStyle=function(){return this.startArrowStyle};a.prototype.setStartArrowStyle=function(d){if(d!==this.startArrowStyle){var c=this.startArrowStyle;this.startArrowStyle=d;this.startArrowStyleName=a.ArrowStyle[this.startArrowStyle];this.firePropertyChange("START_ARROW_STYLE",c,d)}};a.prototype.getEndArrowStyle=function(){return this.endArrowStyle};a.prototype.setEndArrowStyle=function(c){if(c!==this.endArrowStyle){var d=this.endArrowStyle;this.endArrowStyle=c;this.endArrowStyleName=a.ArrowStyle[this.endArrowStyle];this.firePropertyChange("END_ARROW_STYLE",d,c)}};a.prototype.isClosedPath=function(){return this.closedPath};a.prototype.setClosedPath=function(c){if(c!==this.closedPath){this.closedPath=c;this.firePropertyChange("CLOSED_PATH",!c,c)}};a.prototype.getColor=function(){return this.color};a.prototype.setColor=function(c){if(c!==this.color){var d=this.color;this.color=c;this.firePropertyChange("COLOR",d,c)}};a.prototype.getGroundElevation=function(){var c=this.getElevation();if(this.level!=null){return c+this.level.getElevation()}else{return c}};a.prototype.getElevation=function(){return this.elevation!=null?this.elevation:0};a.prototype.setElevation=function(d){if(this.elevation!=null&&d!==this.elevation){var c=this.elevation;this.elevation=d;this.firePropertyChange("ELEVATION",c,d)}};a.prototype.isVisibleIn3D=function(){return this.elevation!=null};a.prototype.setVisibleIn3D=function(c){if((c)!==((this.elevation!=null))){this.elevation=c?0:null;this.firePropertyChange("VISIBLE_IN_3D",!c,c)}};a.prototype.getLevel=function(){return this.level};a.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};a.prototype.isAtLevel=function(c){return this.level===c||this.level!=null&&c!=null&&this.level.getElevation()===c.getElevation()&&this.level.getElevationIndex()<c.getElevationIndex()};a.prototype.getLength=function(){var g=[0,0];var e=[0,0];var c=[0,0];var f=0;for(var d=this.getPolylinePath().getPathIterator(null,0.1);!d.isDone();d.next()){switch((d.currentSegment(c))){case java.awt.geom.PathIterator.SEG_CLOSE:f+=java.awt.geom.Point2D.distance(g[0],g[1],e[0],e[1]);break;case java.awt.geom.PathIterator.SEG_MOVETO:(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(c,0,g,0,2);(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(c,0,e,0,2);break;case java.awt.geom.PathIterator.SEG_LINETO:f+=java.awt.geom.Point2D.distance(e[0],e[1],c[0],c[1]);(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(c,0,e,0,2);break}}return f};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape().intersects(d)};a.prototype.containsPoint=function(c,e,d){return this.containsShapeAtWithMargin(this.getShape(),c,e,d)};a.prototype.getPointIndexAt=function(c,f,e){for(var d=0;d<this.points.length;d++){if(Math.abs(c-this.points[d][0])<=e&&Math.abs(f-this.points[d][1])<=e){return d}}return -1};a.prototype.containsShapeAtWithMargin=function(d,c,f,e){if(e===0){return d.contains(c,f)}else{return d.intersects(c-e,f-e,2*e,2*e)}};a.prototype.getPolylinePath=function(){if(this.polylinePathCache==null){var j=new java.awt.geom.GeneralPath();if(this.joinStyle===a.JoinStyle.CURVED){for(var g=0,c=this.closedPath?this.points.length:this.points.length-1;g<c;g++){var h=new java.awt.geom.CubicCurve2D.Float();var e=this.points[g===0?this.points.length-1:g-1];var m=this.points[g];var k=this.points[g===this.points.length-1?0:g+1];var l=[k[0]-e[0],k[1]-e[1]];var d=this.points[(g+2)%this.points.length];var f=[m[0]-d[0],m[1]-d[1]];h.setCurve(m[0],m[1],m[0]+(g!==0||this.closedPath?l[0]/3.625:0),m[1]+(g!==0||this.closedPath?l[1]/3.625:0),k[0]+(g!==this.points.length-2||this.closedPath?f[0]/3.625:0),k[1]+(g!==this.points.length-2||this.closedPath?f[1]/3.625:0),k[0],k[1]);j.append(h,true)}}else{j.moveTo(this.points[0][0],this.points[0][1]);for(var g=1;g<this.points.length;g++){j.lineTo(this.points[g][0],this.points[g][1])}if(this.closedPath){j.closePath()}}this.polylinePathCache=j}return this.polylinePathCache};a.prototype.getShape=function(){if(this.shapeCache==null){this.shapeCache=new java.awt["BasicStroke"](this.thickness).createStrokedShape(this.getPolylinePath())}return this.shapeCache};a.prototype.move=function(d,c){if(d!==0||c!==0){var f=this.getPoints();for(var e=0;e<f.length;e++){f[e][0]+=d;f[e][1]+=c}this.updatePoints(f)}};a.prototype.clone=function(){var d=this;var c=(function(g){if(b.prototype.clone!=undefined){return b.prototype.clone.call(d)}else{var f=Object.create(g);for(var e in g){if(g.hasOwnProperty(e)){f[e]=g[e]}}return f}})(this);c.level=null;return c};return a}(HomeObject));Polyline.__class="com.eteks.sweethome3d.model.Polyline";Polyline.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"];(function(b){var c;(function(g){g[g.BUTT=0]="BUTT";g[g.SQUARE=1]="SQUARE";g[g.ROUND=2]="ROUND"})(c=b.CapStyle||(b.CapStyle={}));var e;(function(g){g[g.BEVEL=0]="BEVEL";g[g.MITER=1]="MITER";g[g.ROUND=2]="ROUND";g[g.CURVED=3]="CURVED"})(e=b.JoinStyle||(b.JoinStyle={}));var f;(function(g){g[g.NONE=0]="NONE";g[g.DELTA=1]="DELTA";g[g.OPEN=2]="OPEN";g[g.DISC=3]="DISC"})(f=b.ArrowStyle||(b.ArrowStyle={}));var d;(function(g){g[g.SOLID=0]="SOLID";g[g.DOT=1]="DOT";g[g.DASH=2]="DASH";g[g.DASH_DOT=3]="DASH_DOT";g[g.DASH_DOT_DOT=4]="DASH_DOT_DOT";g[g.CUSTOMIZED=5]="CUSTOMIZED"})(d=b.DashStyle||(b.DashStyle={}));var a=(function(){function g(j,h){this._$ordinal=j;this._$name=h}g.prototype.getDashPattern=function(){switch((this._$ordinal)){case b.DashStyle.SOLID:return[1,0];case b.DashStyle.DOT:return[1,1];case b.DashStyle.DASH:return[4,2];case b.DashStyle.DASH_DOT:return[8,2,2,2];case b.DashStyle.DASH_DOT_DOT:return[8,2,2,2,2,2];default:return null}};g.prototype.name=function(){return this._$name};g.prototype.ordinal=function(){return this._$ordinal};g.prototype.compareTo=function(h){return this._$ordinal-(isNaN(h)?h._$ordinal:h)};return g}());b.DashStyle_$WRAPPER=a;d.__class="com.eteks.sweethome3d.model.Polyline.DashStyle";d["_$wrappers"]={0:new a(0,"SOLID"),1:new a(1,"DOT"),2:new a(2,"DASH"),3:new a(3,"DASH_DOT"),4:new a(4,"DASH_DOT_DOT"),5:new a(5,"CUSTOMIZED")}})(Polyline||(Polyline={}));Polyline.__transients=["capStyle","joinStyle","dashStyle","startArrowStyle","endArrowStyle","polylinePathCache","shapeCache","propertyChangeSupport"];var CatalogDoorOrWindow=(function(b){__extends(a,b);function a(W,x,y,ao,O,Y,X,u,m,h,c,r,f,q,j,I,H,au,al,F,ai,ak,aq,z,av,G,aa,t,p,T,l,an,d){var k=this;if(((typeof W==="string")||W===null)&&((typeof x==="string")||x===null)&&((typeof y==="string")||y===null)&&((typeof ao==="string")||ao===null)&&((O!=null&&O instanceof Array&&(O.length==0||O[0]==null||(typeof O[0]==="string")))||O===null)&&((typeof Y==="number")||Y===null)&&((typeof X==="number")||X===null)&&((u!=null&&(u.constructor!=null&&u.constructor.__interfaces!=null&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||u===null)&&((m!=null&&(m.constructor!=null&&m.constructor.__interfaces!=null&&m.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||m===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||h===null)&&((typeof c==="number")||c===null)&&((typeof r==="number")||r===null)&&((typeof f==="number")||f===null)&&((typeof q==="number")||q===null)&&((typeof j==="number")||j===null)&&((typeof I==="boolean")||I===null)&&((typeof H==="string")||H===null)&&((typeof au==="number")||au===null)&&((typeof al==="number")||al===null)&&((typeof F==="boolean")||F===null)&&((typeof ai==="boolean")||ai===null)&&((ak!=null&&ak instanceof Array&&(ak.length==0||ak[0]==null||(ak[0]!=null&&ak[0] instanceof Sash)))||ak===null)&&((aq!=null&&aq instanceof Array&&(aq.length==0||aq[0]==null||aq[0] instanceof Array))||aq===null)&&((typeof z==="boolean")||z===null)&&((typeof av==="number")||av===null)&&((typeof G==="string")||G===null)&&((typeof aa==="boolean")||aa===null)&&((typeof t==="boolean")||t===null)&&((typeof p==="boolean")||p===null)&&((T!=null&&T instanceof Big)||T===null)&&((l!=null&&l instanceof Big)||l===null)&&((typeof an==="string")||an===null)&&((d!=null&&(d instanceof Object))||d===null)){var am=arguments;k=b.call(this,W,x,y,ao,O,Y,X,u,m,h,c,r,f,q,j,I,null,aq,z,av,G,aa,t,p,false,T,l,an,d)||this;if(k.wallThickness===undefined){k.wallThickness=0}if(k.wallDistance===undefined){k.wallDistance=0}if(k.wallCutOutOnBothSides===undefined){k.wallCutOutOnBothSides=false}if(k.widthDepthDeformable===undefined){k.widthDepthDeformable=false}if(k.sashes===undefined){k.sashes=null}if(k.cutOutShape===undefined){k.cutOutShape=null}k.cutOutShape=H;k.wallThickness=au;k.wallDistance=al;k.wallCutOutOnBothSides=F;k.widthDepthDeformable=ai;k.sashes=ak}else{if(((typeof W==="string")||W===null)&&((typeof x==="string")||x===null)&&((typeof y==="string")||y===null)&&((typeof ao==="string")||ao===null)&&((O!=null&&O instanceof Array&&(O.length==0||O[0]==null||(typeof O[0]==="string")))||O===null)&&((typeof Y==="number")||Y===null)&&((typeof X==="number")||X===null)&&((u!=null&&(u.constructor!=null&&u.constructor.__interfaces!=null&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||u===null)&&((m!=null&&(m.constructor!=null&&m.constructor.__interfaces!=null&&m.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||m===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||h===null)&&((typeof c==="number")||c===null)&&((typeof r==="number")||r===null)&&((typeof f==="number")||f===null)&&((typeof q==="number")||q===null)&&((typeof j==="number")||j===null)&&((typeof I==="boolean")||I===null)&&((typeof H==="string")||H===null)&&((typeof au==="number")||au===null)&&((typeof al==="number")||al===null)&&((typeof F==="boolean")||F===null)&&((typeof ai==="boolean")||ai===null)&&((ak!=null&&ak instanceof Array&&(ak.length==0||ak[0]==null||(ak[0]!=null&&ak[0] instanceof Sash)))||ak===null)&&((aq!=null&&aq instanceof Array&&(aq.length==0||aq[0]==null||aq[0] instanceof Array))||aq===null)&&((typeof z==="boolean")||z===null)&&((typeof av==="number")||av===null)&&((typeof G==="string")||G===null)&&((typeof aa==="boolean")||aa===null)&&((typeof t==="boolean")||t===null)&&((typeof p==="boolean")||p===null)&&((T!=null&&T instanceof Big)||T===null)&&((l!=null&&l instanceof Big)||l===null)&&((typeof an==="string")||an===null)&&d===undefined){var am=arguments;var M=arguments;var aj=null;k=b.call(this,W,x,y,ao,O,Y,X,u,m,h,c,r,f,q,j,I,null,aq,z,av,G,aa,t,p,false,T,l,an,aj)||this;if(k.wallThickness===undefined){k.wallThickness=0}if(k.wallDistance===undefined){k.wallDistance=0}if(k.wallCutOutOnBothSides===undefined){k.wallCutOutOnBothSides=false}if(k.widthDepthDeformable===undefined){k.widthDepthDeformable=false}if(k.sashes===undefined){k.sashes=null}if(k.cutOutShape===undefined){k.cutOutShape=null}k.cutOutShape=H;k.wallThickness=au;k.wallDistance=al;k.wallCutOutOnBothSides=F;k.widthDepthDeformable=ai;k.sashes=ak;if(k.wallThickness===undefined){k.wallThickness=0}if(k.wallDistance===undefined){k.wallDistance=0}if(k.wallCutOutOnBothSides===undefined){k.wallCutOutOnBothSides=false}if(k.widthDepthDeformable===undefined){k.widthDepthDeformable=false}if(k.sashes===undefined){k.sashes=null}if(k.cutOutShape===undefined){k.cutOutShape=null}}else{if(((typeof W==="string")||W===null)&&((x!=null&&(x.constructor!=null&&x.constructor.__interfaces!=null&&x.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||x===null)&&((y!=null&&(y.constructor!=null&&y.constructor.__interfaces!=null&&y.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||y===null)&&((typeof ao==="number")||ao===null)&&((typeof O==="number")||O===null)&&((typeof Y==="number")||Y===null)&&((typeof X==="number")||X===null)&&((typeof u==="boolean")||u===null)&&((typeof m==="number")||m===null)&&((typeof h==="number")||h===null)&&((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||(c[0]!=null&&c[0] instanceof Sash)))||c===null)&&((typeof r==="number")||r===null)&&((f!=null&&f instanceof Array&&(f.length==0||f[0]==null||f[0] instanceof Array))||f===null)&&((typeof q==="boolean")||q===null)&&((typeof j==="number")||j===null)&&((typeof I==="string")||I===null)&&((typeof H==="number")||H===null)&&((typeof au==="boolean")||au===null)&&al===undefined&&F===undefined&&ai===undefined&&ak===undefined&&aq===undefined&&z===undefined&&av===undefined&&G===undefined&&aa===undefined&&t===undefined&&p===undefined&&T===undefined&&l===undefined&&an===undefined&&d===undefined){var am=arguments;var Z=am[0];var E=am[1];var S=am[2];var o=am[3];var ag=am[4];var w=am[5];var L=am[6];var ah=am[7];var at=am[8];var V=am[9];var af=am[10];var N=am[11];var B=am[12];var Q=am[13];var D=am[14];var J=am[15];var ap=am[16];var e=am[17];k=b.call(this,Z,E,S,o,ag,w,L,ah,null,N,B,Q,D,J,ap,e)||this;if(k.wallThickness===undefined){k.wallThickness=0}if(k.wallDistance===undefined){k.wallDistance=0}if(k.wallCutOutOnBothSides===undefined){k.wallCutOutOnBothSides=false}if(k.widthDepthDeformable===undefined){k.widthDepthDeformable=false}if(k.sashes===undefined){k.sashes=null}if(k.cutOutShape===undefined){k.cutOutShape=null}k.wallThickness=at;k.wallDistance=V;k.wallCutOutOnBothSides=true;k.widthDepthDeformable=true;k.sashes=af.length>0?af.slice(0):af;k.cutOutShape=null}else{if(((typeof W==="string")||W===null)&&((typeof x==="string")||x===null)&&((typeof y==="string")||y===null)&&((ao!=null&&(ao.constructor!=null&&ao.constructor.__interfaces!=null&&ao.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||ao===null)&&((O!=null&&(O.constructor!=null&&O.constructor.__interfaces!=null&&O.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||O===null)&&((typeof Y==="number")||Y===null)&&((typeof X==="number")||X===null)&&((typeof u==="number")||u===null)&&((typeof m==="number")||m===null)&&((typeof h==="boolean")||h===null)&&((typeof c==="number")||c===null)&&((typeof r==="number")||r===null)&&((f!=null&&f instanceof Array&&(f.length==0||f[0]==null||(f[0]!=null&&f[0] instanceof Sash)))||f===null)&&((q!=null&&q instanceof Array&&(q.length==0||q[0]==null||q[0] instanceof Array))||q===null)&&((typeof j==="string")||j===null)&&((typeof I==="boolean")||I===null)&&((H!=null&&H instanceof Big)||H===null)&&((au!=null&&au instanceof Big)||au===null)&&al===undefined&&F===undefined&&ai===undefined&&ak===undefined&&aq===undefined&&z===undefined&&av===undefined&&G===undefined&&aa===undefined&&t===undefined&&p===undefined&&T===undefined&&l===undefined&&an===undefined&&d===undefined){var am=arguments;var C=am[3];var R=am[4];var n=am[5];var ad=am[6];var v=am[7];var K=am[8];var ae=am[9];var ar=am[10];var U=am[11];var ac=am[12];var A=am[13];var g=am[14];var P=am[15];var ab=am[16];var s=am[17];if(k.wallThickness===undefined){k.wallThickness=0}if(k.wallDistance===undefined){k.wallDistance=0}if(k.wallCutOutOnBothSides===undefined){k.wallCutOutOnBothSides=false}if(k.widthDepthDeformable===undefined){k.widthDepthDeformable=false}if(k.sashes===undefined){k.sashes=null}if(k.cutOutShape===undefined){k.cutOutShape=null}}else{throw new Error("invalid overload")}}}}return k}a.prototype.getWallThickness=function(){return this.wallThickness};a.prototype.getWallDistance=function(){return this.wallDistance};a.prototype.isWallCutOutOnBothSides=function(){return this.wallCutOutOnBothSides};a.prototype.isWidthDepthDeformable=function(){return this.widthDepthDeformable};a.prototype.getSashes=function(){if(this.sashes.length===0){return this.sashes}else{return this.sashes.slice(0)}};a.prototype.getCutOutShape=function(){return this.cutOutShape};a.prototype.isDoorOrWindow=function(){return true};a.prototype.isHorizontallyRotatable=function(){return false};return a}(CatalogPieceOfFurniture));CatalogDoorOrWindow.__class="com.eteks.sweethome3d.model.CatalogDoorOrWindow";CatalogDoorOrWindow.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.DoorOrWindow","com.eteks.sweethome3d.model.PieceOfFurniture"];var CatalogLight=(function(b){__extends(a,b);function a(v,K,A,G,t,d,c,F,m,h,w,J,u,x,B,f,I,s,e,E,g,q,l,C,H,D,z,r,j,p){var y=this;if(((typeof v==="string")||v===null)&&((typeof K==="string")||K===null)&&((typeof A==="string")||A===null)&&((typeof G==="string")||G===null)&&((t!=null&&t instanceof Array&&(t.length==0||t[0]==null||(typeof t[0]==="string")))||t===null)&&((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)&&((F!=null&&(F.constructor!=null&&F.constructor.__interfaces!=null&&F.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||F===null)&&((m!=null&&(m.constructor!=null&&m.constructor.__interfaces!=null&&m.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||m===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||h===null)&&((typeof w==="number")||w===null)&&((typeof J==="number")||J===null)&&((typeof u==="number")||u===null)&&((typeof x==="number")||x===null)&&((typeof B==="number")||B===null)&&((typeof f==="boolean")||f===null)&&((I!=null&&I instanceof Array&&(I.length==0||I[0]==null||(I[0]!=null&&I[0] instanceof LightSource)))||I===null)&&((typeof s==="string")||s===null)&&((e!=null&&e instanceof Array&&(e.length==0||e[0]==null||e[0] instanceof Array))||e===null)&&((typeof E==="boolean")||E===null)&&((typeof g==="number")||g===null)&&((typeof q==="string")||q===null)&&((typeof l==="boolean")||l===null)&&((typeof C==="boolean")||C===null)&&((typeof H==="boolean")||H===null)&&((typeof D==="boolean")||D===null)&&((z!=null&&z instanceof Big)||z===null)&&((r!=null&&r instanceof Big)||r===null)&&((typeof j==="string")||j===null)&&((p!=null&&(p instanceof Object))||p===null)){var o=arguments;y=b.call(this,v,K,A,G,t,d,c,F,m,h,w,J,u,x,B,f,s,e,E,g,q,l,C,H,D,z,r,j,p)||this;if(y.lightSources===undefined){y.lightSources=null}y.lightSources=I.length>0?I.slice(0):I}else{if(((typeof v==="string")||v===null)&&((typeof K==="string")||K===null)&&((typeof A==="string")||A===null)&&((typeof G==="string")||G===null)&&((t!=null&&t instanceof Array&&(t.length==0||t[0]==null||(typeof t[0]==="string")))||t===null)&&((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)&&((F!=null&&(F.constructor!=null&&F.constructor.__interfaces!=null&&F.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||F===null)&&((m!=null&&(m.constructor!=null&&m.constructor.__interfaces!=null&&m.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||m===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||h===null)&&((typeof w==="number")||w===null)&&((typeof J==="number")||J===null)&&((typeof u==="number")||u===null)&&((typeof x==="number")||x===null)&&((typeof B==="number")||B===null)&&((typeof f==="boolean")||f===null)&&((I!=null&&I instanceof Array&&(I.length==0||I[0]==null||(I[0]!=null&&I[0] instanceof LightSource)))||I===null)&&((typeof s==="string")||s===null)&&((e!=null&&e instanceof Array&&(e.length==0||e[0]==null||e[0] instanceof Array))||e===null)&&((typeof E==="boolean")||E===null)&&((typeof g==="number")||g===null)&&((typeof q==="string")||q===null)&&((typeof l==="boolean")||l===null)&&((typeof C==="boolean")||C===null)&&((typeof H==="boolean")||H===null)&&((typeof D==="boolean")||D===null)&&((z!=null&&z instanceof Big)||z===null)&&((r!=null&&r instanceof Big)||r===null)&&((typeof j==="string")||j===null)&&p===undefined){var o=arguments;var k=arguments;var n=null;y=b.call(this,v,K,A,G,t,d,c,F,m,h,w,J,u,x,B,f,s,e,E,g,q,l,C,H,D,z,r,j,n)||this;if(y.lightSources===undefined){y.lightSources=null}y.lightSources=I.length>0?I.slice(0):I;if(y.lightSources===undefined){y.lightSources=null}}else{throw new Error("invalid overload")}}return y}a.prototype.getLightSources=function(){if(this.lightSources.length===0){return this.lightSources}else{return this.lightSources.slice(0)}};return a}(CatalogPieceOfFurniture));CatalogLight.__class="com.eteks.sweethome3d.model.CatalogLight";CatalogLight.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Light"];var ImportedTextureWizardController=(function(b){__extends(a,b);function a(t,x,r,A,z){var y=this;if(((t!=null&&t instanceof CatalogTexture)||t===null)&&((typeof x==="string")||x===null)&&((r!=null&&r instanceof UserPreferences)||r===null)&&((A!=null&&(A.constructor!=null&&A.constructor.__interfaces!=null&&A.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||A===null)&&((z!=null&&(z.constructor!=null&&z.constructor.__interfaces!=null&&z.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||z===null)){var p=arguments;y=b.call(this,r,A)||this;if(y.texture===undefined){y.texture=null}if(y.textureName===undefined){y.textureName=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(y.contentManager===undefined){y.contentManager=null}if(y.textureImageStepState===undefined){y.textureImageStepState=null}if(y.textureAttributesStepState===undefined){y.textureAttributesStepState=null}if(y.stepsView===undefined){y.stepsView=null}if(y.step===undefined){y.step=null}if(y.image===undefined){y.image=null}if(y.name===undefined){y.name=null}if(y.category===undefined){y.category=null}if(y.creator===undefined){y.creator=null}if(y.width===undefined){y.width=0}if(y.height===undefined){y.height=0}y.texture=t;y.textureName=x;y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=r;y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=A;y.contentManager=z;y.setTitle(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(a,t==null?"importTextureWizard.title":"modifyTextureWizard.title"));y.textureImageStepState=new a.TextureImageStepState(y);y.textureAttributesStepState=new a.TextureAttributesStepState(y);y.setStepState(y.textureImageStepState)}else{if(((typeof t==="string")||t===null)&&((x!=null&&x instanceof UserPreferences)||x===null)&&((r!=null&&(r.constructor!=null&&r.constructor.__interfaces!=null&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||r===null)&&((A!=null&&(A.constructor!=null&&A.constructor.__interfaces!=null&&A.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||A===null)&&z===undefined){var p=arguments;var k=p[0];var e=p[1];var o=p[2];var w=p[3];var n=arguments;var u=null;y=b.call(this,e,o)||this;if(y.texture===undefined){y.texture=null}if(y.textureName===undefined){y.textureName=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(y.contentManager===undefined){y.contentManager=null}if(y.textureImageStepState===undefined){y.textureImageStepState=null}if(y.textureAttributesStepState===undefined){y.textureAttributesStepState=null}if(y.stepsView===undefined){y.stepsView=null}if(y.step===undefined){y.step=null}if(y.image===undefined){y.image=null}if(y.name===undefined){y.name=null}if(y.category===undefined){y.category=null}if(y.creator===undefined){y.creator=null}if(y.width===undefined){y.width=0}if(y.height===undefined){y.height=0}y.texture=u;y.textureName=k;y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=e;y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=o;y.contentManager=w;y.setTitle(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(a,u==null?"importTextureWizard.title":"modifyTextureWizard.title"));y.textureImageStepState=new a.TextureImageStepState(y);y.textureAttributesStepState=new a.TextureAttributesStepState(y);y.setStepState(y.textureImageStepState);if(y.texture===undefined){y.texture=null}if(y.textureName===undefined){y.textureName=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(y.contentManager===undefined){y.contentManager=null}if(y.textureImageStepState===undefined){y.textureImageStepState=null}if(y.textureAttributesStepState===undefined){y.textureAttributesStepState=null}if(y.stepsView===undefined){y.stepsView=null}if(y.step===undefined){y.step=null}if(y.image===undefined){y.image=null}if(y.name===undefined){y.name=null}if(y.category===undefined){y.category=null}if(y.creator===undefined){y.creator=null}if(y.width===undefined){y.width=0}if(y.height===undefined){y.height=0}}else{if(((t!=null&&t instanceof CatalogTexture)||t===null)&&((x!=null&&x instanceof UserPreferences)||x===null)&&((r!=null&&(r.constructor!=null&&r.constructor.__interfaces!=null&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||r===null)&&((A!=null&&(A.constructor!=null&&A.constructor.__interfaces!=null&&A.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||A===null)&&z===undefined){var p=arguments;var d=p[1];var m=p[2];var v=p[3];var l=arguments;var g=null;y=b.call(this,d,m)||this;if(y.texture===undefined){y.texture=null}if(y.textureName===undefined){y.textureName=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(y.contentManager===undefined){y.contentManager=null}if(y.textureImageStepState===undefined){y.textureImageStepState=null}if(y.textureAttributesStepState===undefined){y.textureAttributesStepState=null}if(y.stepsView===undefined){y.stepsView=null}if(y.step===undefined){y.step=null}if(y.image===undefined){y.image=null}if(y.name===undefined){y.name=null}if(y.category===undefined){y.category=null}if(y.creator===undefined){y.creator=null}if(y.width===undefined){y.width=0}if(y.height===undefined){y.height=0}y.texture=t;y.textureName=g;y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=d;y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=m;y.contentManager=v;y.setTitle(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(a,t==null?"importTextureWizard.title":"modifyTextureWizard.title"));y.textureImageStepState=new a.TextureImageStepState(y);y.textureAttributesStepState=new a.TextureAttributesStepState(y);y.setStepState(y.textureImageStepState);if(y.texture===undefined){y.texture=null}if(y.textureName===undefined){y.textureName=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(y.contentManager===undefined){y.contentManager=null}if(y.textureImageStepState===undefined){y.textureImageStepState=null}if(y.textureAttributesStepState===undefined){y.textureAttributesStepState=null}if(y.stepsView===undefined){y.stepsView=null}if(y.step===undefined){y.step=null}if(y.image===undefined){y.image=null}if(y.name===undefined){y.name=null}if(y.category===undefined){y.category=null}if(y.creator===undefined){y.creator=null}if(y.width===undefined){y.width=0}if(y.height===undefined){y.height=0}}else{if(((t!=null&&t instanceof UserPreferences)||t===null)&&((x!=null&&(x.constructor!=null&&x.constructor.__interfaces!=null&&x.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||x===null)&&((r!=null&&(r.constructor!=null&&r.constructor.__interfaces!=null&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||r===null)&&A===undefined&&z===undefined){var p=arguments;var c=p[0];var j=p[1];var s=p[2];var h=arguments;var q=null;var f=null;y=b.call(this,c,j)||this;if(y.texture===undefined){y.texture=null}if(y.textureName===undefined){y.textureName=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(y.contentManager===undefined){y.contentManager=null}if(y.textureImageStepState===undefined){y.textureImageStepState=null}if(y.textureAttributesStepState===undefined){y.textureAttributesStepState=null}if(y.stepsView===undefined){y.stepsView=null}if(y.step===undefined){y.step=null}if(y.image===undefined){y.image=null}if(y.name===undefined){y.name=null}if(y.category===undefined){y.category=null}if(y.creator===undefined){y.creator=null}if(y.width===undefined){y.width=0}if(y.height===undefined){y.height=0}y.texture=q;y.textureName=f;y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=c;y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=j;y.contentManager=s;y.setTitle(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(a,q==null?"importTextureWizard.title":"modifyTextureWizard.title"));y.textureImageStepState=new a.TextureImageStepState(y);y.textureAttributesStepState=new a.TextureAttributesStepState(y);y.setStepState(y.textureImageStepState);if(y.texture===undefined){y.texture=null}if(y.textureName===undefined){y.textureName=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){y.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(y.contentManager===undefined){y.contentManager=null}if(y.textureImageStepState===undefined){y.textureImageStepState=null}if(y.textureAttributesStepState===undefined){y.textureAttributesStepState=null}if(y.stepsView===undefined){y.stepsView=null}if(y.step===undefined){y.step=null}if(y.image===undefined){y.image=null}if(y.name===undefined){y.name=null}if(y.category===undefined){y.category=null}if(y.creator===undefined){y.creator=null}if(y.width===undefined){y.width=0}if(y.height===undefined){y.height=0}}else{throw new Error("invalid overload")}}}}return y}a.prototype.finish=function(){var d=new CatalogTexture(null,this.getName(),this.getImage(),this.getWidth(),this.getHeight(),this.getCreator(),true);var c=this.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getTexturesCatalog();if(this.texture!=null){c["delete"](this.texture)}c.add(this.category,d)};a.prototype.getContentManager=function(){return this.contentManager};a.prototype.getStepState=function(){return b.prototype.getStepState.call(this)};a.prototype.getTextureImageStepState=function(){return this.textureImageStepState};a.prototype.getTextureAttributesStepState=function(){return this.textureAttributesStepState};a.prototype.getStepsView=function(){if(this.stepsView==null){this.stepsView=this.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory.createImportedTextureWizardStepsView(this.texture,this.textureName,this.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences,this)}return this.stepsView};a.prototype.setStep=function(c){if(c!==this.step){var d=this.step;this.step=c;this.propertyChangeSupport.firePropertyChange("STEP",d,c)}};a.prototype.getStep=function(){return this.step};a.prototype.setImage=function(d){if(d!==this.image){var c=this.image;this.image=d;this.propertyChangeSupport.firePropertyChange("IMAGE",c,d)}};a.prototype.getImage=function(){return this.image};a.prototype.getName=function(){return this.name};a.prototype.setName=function(c){if(c!==this.name){var d=this.name;this.name=c;if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange("NAME",d,c)}}};a.prototype.getCategory=function(){return this.category};a.prototype.setCategory=function(d){if(d!==this.category){var c=this.category;this.category=d;this.propertyChangeSupport.firePropertyChange("CATEGORY",c,d)}};a.prototype.getCreator=function(){return this.creator};a.prototype.setCreator=function(d){if(d!==this.creator){var c=this.creator;this.creator=d;if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange("CREATOR",c,d)}}};a.prototype.getWidth=function(){return this.width};a.prototype.setWidth=function(d){if(d!==this.width){var c=this.width;this.width=d;this.propertyChangeSupport.firePropertyChange("WIDTH",c,d)}};a.prototype.getHeight=function(){return this.height};a.prototype.setHeight=function(c){if(c!==this.height){var d=this.height;this.height=c;this.propertyChangeSupport.firePropertyChange("HEIGHT",d,c)}};a.prototype.isTextureNameValid=function(){return this.name!=null&&this.name.length>0&&this.category!=null};return a}(WizardController));ImportedTextureWizardController.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController";ImportedTextureWizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(d){var b;(function(f){f[f.IMAGE=0]="IMAGE";f[f.ATTRIBUTES=1]="ATTRIBUTES"})(b=d.Step||(d.Step={}));var e=(function(f){__extends(g,f);function g(h){var j=f.call(this)||this;j.__parent=h;j.icon="resources/importedTextureWizard.png";return j}g.prototype.enter=function(){this.__parent.setStep(this.getStep())};g.prototype.getView=function(){return this.__parent.getStepsView()};g.prototype.getIcon=function(){return this.icon};return g}(WizardController.WizardControllerStepState));d.ImportedTextureWizardStepState=e;e.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController.ImportedTextureWizardStepState";var a=(function(g){__extends(f,g);function f(h){var j=g.call(this,h)||this;j.__parent=h;h.addPropertyChangeListener("IMAGE",new f.TextureImageStepState$0(j));return j}f.prototype.enter=function(){g.prototype.enter.call(this);this.setFirstStep(true);this.setNextStepEnabled(this.__parent.getImage()!=null)};f.prototype.getStep=function(){return d.Step.IMAGE};f.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getTextureAttributesStepState())};return f}(d.ImportedTextureWizardStepState));d.TextureImageStepState=a;a.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController.TextureImageStepState";(function(g){var f=(function(){function h(j){this.__parent=j}h.prototype.propertyChange=function(j){this.__parent.setNextStepEnabled(this.__parent.__parent.getImage()!=null)};return h}());g.TextureImageStepState$0=f})(a=d.TextureImageStepState||(d.TextureImageStepState={}));var c=(function(g){__extends(f,g);function f(h){var j=g.call(this,h)||this;j.__parent=h;if(j.widthChangeListener===undefined){j.widthChangeListener=null}if(j.heightChangeListener===undefined){j.heightChangeListener=null}if(j.nameAndCategoryChangeListener===undefined){j.nameAndCategoryChangeListener=null}j.widthChangeListener=new f.TextureAttributesStepState$0(j);j.heightChangeListener=new f.TextureAttributesStepState$1(j);j.nameAndCategoryChangeListener=new f.TextureAttributesStepState$2(j);return j}f.prototype.enter=function(){g.prototype.enter.call(this);this.setLastStep(true);this.__parent.addPropertyChangeListener("WIDTH",this.widthChangeListener);this.__parent.addPropertyChangeListener("HEIGHT",this.heightChangeListener);this.__parent.addPropertyChangeListener("NAME",this.nameAndCategoryChangeListener);this.__parent.addPropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener);this.setNextStepEnabled(this.__parent.isTextureNameValid())};f.prototype.getStep=function(){return d.Step.ATTRIBUTES};f.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getTextureImageStepState())};f.prototype.exit=function(){this.__parent.removePropertyChangeListener("WIDTH",this.widthChangeListener);this.__parent.removePropertyChangeListener("HEIGHT",this.heightChangeListener);this.__parent.removePropertyChangeListener("NAME",this.nameAndCategoryChangeListener);this.__parent.removePropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener)};return f}(d.ImportedTextureWizardStepState));d.TextureAttributesStepState=c;c.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController.TextureAttributesStepState";(function(f){var j=(function(){function k(l){this.__parent=l}k.prototype.propertyChange=function(m){this.__parent.__parent.removePropertyChangeListener("HEIGHT",this.__parent.heightChangeListener);var l=m.getNewValue()/m.getOldValue();this.__parent.__parent.setHeight(this.__parent.__parent.getHeight()*l);this.__parent.__parent.addPropertyChangeListener("HEIGHT",this.__parent.heightChangeListener)};return k}());f.TextureAttributesStepState$0=j;var h=(function(){function k(l){this.__parent=l}k.prototype.propertyChange=function(m){this.__parent.__parent.removePropertyChangeListener("WIDTH",this.__parent.widthChangeListener);var l=m.getNewValue()/m.getOldValue();this.__parent.__parent.setWidth(this.__parent.__parent.getWidth()*l);this.__parent.__parent.addPropertyChangeListener("WIDTH",this.__parent.widthChangeListener)};return k}());f.TextureAttributesStepState$1=h;var g=(function(){function k(l){this.__parent=l}k.prototype.propertyChange=function(l){this.__parent.setNextStepEnabled(this.__parent.__parent.isTextureNameValid())};return k}());f.TextureAttributesStepState$2=g})(c=d.TextureAttributesStepState||(d.TextureAttributesStepState={}))})(ImportedTextureWizardController||(ImportedTextureWizardController={}));var BackgroundImageWizardController=(function(b){__extends(a,b);function a(j,f,h,k,c){var g=b.call(this,f,h)||this;if(g.home===undefined){g.home=null}if(g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences===undefined){g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences=null}if(g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory===undefined){g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory=null}if(g.contentManager===undefined){g.contentManager=null}if(g.undoSupport===undefined){g.undoSupport=null}if(g.imageChoiceStepState===undefined){g.imageChoiceStepState=null}if(g.imageScaleStepState===undefined){g.imageScaleStepState=null}if(g.imageOriginStepState===undefined){g.imageOriginStepState=null}if(g.stepsView===undefined){g.stepsView=null}if(g.step===undefined){g.step=null}if(g.referenceBackgroundImage===undefined){g.referenceBackgroundImage=null}if(g.image===undefined){g.image=null}if(g.scaleDistance===undefined){g.scaleDistance=null}if(g.scaleDistanceXStart===undefined){g.scaleDistanceXStart=0}if(g.scaleDistanceYStart===undefined){g.scaleDistanceYStart=0}if(g.scaleDistanceXEnd===undefined){g.scaleDistanceXEnd=0}if(g.scaleDistanceYEnd===undefined){g.scaleDistanceYEnd=0}if(g.xOrigin===undefined){g.xOrigin=0}if(g.yOrigin===undefined){g.yOrigin=0}g.home=j;g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences=f;g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory=h;g.contentManager=k;g.undoSupport=c;g.setTitle(f.getLocalizedString(a,"wizard.title"));g.setResizable(true);g.imageChoiceStepState=new a.ImageChoiceStepState(g);g.imageScaleStepState=new a.ImageScaleStepState(g);g.imageOriginStepState=new a.ImageOriginStepState(g);g.setStepState(g.imageChoiceStepState);var l=g.home.getSelectedLevel();if(l!=null){var m=g.home.getLevels();var d=m.indexOf(l);for(var e=d-1;e>=0&&g.referenceBackgroundImage==null;e--){g.referenceBackgroundImage=m[e].getBackgroundImage()}for(var e=d+1;e<m.length&&g.referenceBackgroundImage==null;e++){g.referenceBackgroundImage=m[e].getBackgroundImage()}}return g}a.prototype.finish=function(){var e=this.home.getSelectedLevel();var d=e!=null?e.getBackgroundImage():this.home.getBackgroundImage();var g=this.getScaleDistancePoints();var f=new BackgroundImage(this.getImage(),this.getScaleDistance(),g[0][0],g[0][1],g[1][0],g[1][1],this.getXOrigin(),this.getYOrigin());if(e!=null){e.setBackgroundImage(f)}else{this.home.setBackgroundImage(f)}var c=d==null;this.undoSupport.postEdit(new a.BackgroundImageUndoableEdit(this.home,this.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences,e,d,f,c))};a.prototype.getContentManager=function(){return this.contentManager};a.prototype.getStepState=function(){return b.prototype.getStepState.call(this)};a.prototype.getImageChoiceStepState=function(){return this.imageChoiceStepState};a.prototype.getImageOriginStepState=function(){return this.imageOriginStepState};a.prototype.getImageScaleStepState=function(){return this.imageScaleStepState};a.prototype.getStepsView=function(){if(this.stepsView==null){var c=this.home.getSelectedLevel()!=null?this.home.getSelectedLevel().getBackgroundImage():this.home.getBackgroundImage();this.stepsView=this.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory.createBackgroundImageWizardStepsView(c,this.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences,this)}return this.stepsView};a.prototype.setStep=function(c){if(c!==this.step){var d=this.step;this.step=c;this.propertyChangeSupport.firePropertyChange("STEP",d,c)}};a.prototype.getStep=function(){return this.step};a.prototype.getReferenceBackgroundImage=function(){return this.referenceBackgroundImage};a.prototype.setImage=function(d){if(d!==this.image){var c=this.image;this.image=d;this.propertyChangeSupport.firePropertyChange("IMAGE",c,d)}};a.prototype.getImage=function(){return this.image};a.prototype.setScaleDistance=function(d){if(d!==this.scaleDistance){var c=this.scaleDistance;this.scaleDistance=d;this.propertyChangeSupport.firePropertyChange("SCALE_DISTANCE",c,d)}};a.prototype.getScaleDistance=function(){return this.scaleDistance};a.prototype.setScaleDistancePoints=function(c,g,e,d){if(c!==this.scaleDistanceXStart||g!==this.scaleDistanceYStart||e!==this.scaleDistanceXEnd||d!==this.scaleDistanceYEnd){var f=[[this.scaleDistanceXStart,this.scaleDistanceYStart],[this.scaleDistanceXEnd,this.scaleDistanceYEnd]];this.scaleDistanceXStart=c;this.scaleDistanceYStart=g;this.scaleDistanceXEnd=e;this.scaleDistanceYEnd=d;this.propertyChangeSupport.firePropertyChange("SCALE_DISTANCE_POINTS",f,[[c,g],[e,d]])}};a.prototype.getScaleDistancePoints=function(){return[[this.scaleDistanceXStart,this.scaleDistanceYStart],[this.scaleDistanceXEnd,this.scaleDistanceYEnd]]};a.prototype.setOrigin=function(e,c){if(e!==this.xOrigin){var d=this.xOrigin;this.xOrigin=e;this.propertyChangeSupport.firePropertyChange("X_ORIGIN",d,e)}if(c!==this.yOrigin){var f=this.yOrigin;this.yOrigin=c;this.propertyChangeSupport.firePropertyChange("Y_ORIGIN",f,c)}};a.prototype.getXOrigin=function(){return this.xOrigin};a.prototype.getYOrigin=function(){return this.yOrigin};return a}(WizardController));BackgroundImageWizardController.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController";BackgroundImageWizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(b){var d;(function(h){h[h.CHOICE=0]="CHOICE";h[h.SCALE=1]="SCALE";h[h.ORIGIN=2]="ORIGIN"})(d=b.Step||(b.Step={}));var f=(function(h){__extends(j,h);function j(o,l,q,m,n,k){var p=h.call(this,l,b,k?"undoImportBackgroundImageName":"undoModifyBackgroundImageName")||this;if(p.home===undefined){p.home=null}if(p.level===undefined){p.level=null}if(p.oldImage===undefined){p.oldImage=null}if(p.image===undefined){p.image=null}p.home=o;p.level=q;p.oldImage=m;p.image=n;return p}j.prototype.undo=function(){h.prototype.undo.call(this);this.home.setSelectedLevel(this.level);if(this.level!=null){this.level.setBackgroundImage(this.oldImage)}else{this.home.setBackgroundImage(this.oldImage)}};j.prototype.redo=function(){h.prototype.redo.call(this);this.home.setSelectedLevel(this.level);if(this.level!=null){this.level.setBackgroundImage(this.image)}else{this.home.setBackgroundImage(this.image)}};return j}(LocalizedUndoableEdit));b.BackgroundImageUndoableEdit=f;f.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.BackgroundImageUndoableEdit";f.__interfaces=["javax.swing.undo.UndoableEdit"];var e=(function(j){__extends(h,j);function h(k){var l=j.call(this)||this;l.__parent=k;l.icon="resources/backgroundImageWizard.png";return l}h.prototype.enter=function(){this.__parent.setStep(this.getStep())};h.prototype.getView=function(){return this.__parent.getStepsView()};h.prototype.getIcon=function(){return this.icon};return h}(WizardController.WizardControllerStepState));b.BackgroundImageWizardStepState=e;e.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.BackgroundImageWizardStepState";var a=(function(j){__extends(h,j);function h(k){var l=j.call(this,k)||this;l.__parent=k;k.addPropertyChangeListener("IMAGE",new h.ImageChoiceStepState$0(l));return l}h.prototype.enter=function(){j.prototype.enter.call(this);this.setFirstStep(true);this.setNextStepEnabled(this.__parent.getImage()!=null)};h.prototype.getStep=function(){return b.Step.CHOICE};h.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getImageScaleStepState())};return h}(b.BackgroundImageWizardStepState));b.ImageChoiceStepState=a;a.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.ImageChoiceStepState";(function(h){var j=(function(){function k(l){this.__parent=l}k.prototype.propertyChange=function(l){this.__parent.setNextStepEnabled(this.__parent.__parent.getImage()!=null)};return k}());h.ImageChoiceStepState$0=j})(a=b.ImageChoiceStepState||(b.ImageChoiceStepState={}));var c=(function(j){__extends(h,j);function h(k){var l=j.call(this,k)||this;l.__parent=k;k.addPropertyChangeListener("SCALE_DISTANCE",new h.ImageScaleStepState$0(l));return l}h.prototype.enter=function(){j.prototype.enter.call(this);this.setNextStepEnabled(this.__parent.getScaleDistance()!=null)};h.prototype.getStep=function(){return b.Step.SCALE};h.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getImageChoiceStepState())};h.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getImageOriginStepState())};return h}(b.BackgroundImageWizardStepState));b.ImageScaleStepState=c;c.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.ImageScaleStepState";(function(h){var j=(function(){function k(l){this.__parent=l}k.prototype.propertyChange=function(l){this.__parent.setNextStepEnabled(this.__parent.__parent.getScaleDistance()!=null)};return k}());h.ImageScaleStepState$0=j})(c=b.ImageScaleStepState||(b.ImageScaleStepState={}));var g=(function(h){__extends(j,h);function j(k){var l=h.call(this,k)||this;l.__parent=k;return l}j.prototype.enter=function(){h.prototype.enter.call(this);this.setLastStep(true);this.setNextStepEnabled(true)};j.prototype.getStep=function(){return b.Step.ORIGIN};j.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getImageScaleStepState())};return j}(b.BackgroundImageWizardStepState));b.ImageOriginStepState=g;g.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.ImageOriginStepState"})(BackgroundImageWizardController||(BackgroundImageWizardController={}));var RoomController=(function(){function a(f,c,b,e,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.floorTextureController===undefined){this.floorTextureController=null}if(this.ceilingTextureController===undefined){this.ceilingTextureController=null}if(this.wallSidesTextureController===undefined){this.wallSidesTextureController=null}if(this.wallSidesBaseboardController===undefined){this.wallSidesBaseboardController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.roomView===undefined){this.roomView=null}if(this.name===undefined){this.name=null}if(this.areaVisible===undefined){this.areaVisible=null}if(this.floorVisible===undefined){this.floorVisible=null}if(this.floorColor===undefined){this.floorColor=null}if(this.floorPaint===undefined){this.floorPaint=null}if(this.floorShininess===undefined){this.floorShininess=null}if(this.ceilingVisible===undefined){this.ceilingVisible=null}if(this.ceilingColor===undefined){this.ceilingColor=null}if(this.ceilingPaint===undefined){this.ceilingPaint=null}if(this.ceilingShininess===undefined){this.ceilingShininess=null}if(this.wallSidesEditable===undefined){this.wallSidesEditable=false}if(this.splitSurroundingWalls===undefined){this.splitSurroundingWalls=false}if(this.splitSurroundingWallsNeeded===undefined){this.splitSurroundingWallsNeeded=false}if(this.wallSidesColor===undefined){this.wallSidesColor=null}if(this.wallSidesPaint===undefined){this.wallSidesPaint=null}if(this.wallSidesShininess===undefined){this.wallSidesShininess=null}this.home=f;this.preferences=c;this.viewFactory=b;this.contentManager=e;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getFloorTextureController=function(){if(this.floorTextureController==null){this.floorTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"floorTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.floorTextureController.addPropertyChangeListener("TEXTURE",new a.RoomController$0(this))}return this.floorTextureController};a.prototype.getCeilingTextureController=function(){if(this.ceilingTextureController==null){this.ceilingTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"ceilingTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.ceilingTextureController.addPropertyChangeListener("TEXTURE",new a.RoomController$1(this))}return this.ceilingTextureController};a.prototype.getWallSidesTextureController=function(){if(this.wallSidesTextureController==null){this.wallSidesTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"wallSidesTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.wallSidesTextureController.addPropertyChangeListener("TEXTURE",new a.RoomController$2(this))}return this.wallSidesTextureController};a.prototype.getWallSidesBaseboardController=function(){if(this.wallSidesBaseboardController==null){this.wallSidesBaseboardController=new BaseboardChoiceController(this.preferences,this.viewFactory,this.contentManager)}return this.wallSidesBaseboardController};a.prototype.getView=function(){if(this.roomView==null){this.roomView=this.viewFactory.createRoomView(this.preferences,this)}return this.roomView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.isPropertyEditable=function(b){switch((b)){case"SPLIT_SURROUNDING_WALLS":case"WALL_SIDES_COLOR":case"WALL_SIDES_PAINT":case"WALL_SIDES_SHININESS":case"WALL_SIDES_BASEBOARD":return this.wallSidesEditable;default:return true}};a.prototype.updateProperties=function(){var A=Home.getRoomsSubList(this.home.getSelectedItems());if((A.length==0)){this.setAreaVisible(null);this.setFloorColor(null);this.getFloorTextureController().setTexture(null);this.setFloorPaint(null);this.setFloorShininess(null);this.setCeilingColor(null);this.getCeilingTextureController().setTexture(null);this.setCeilingPaint(null);this.setCeilingShininess(null)}else{var F=A[0];var w=F.getName();if(w!=null){for(var y=1;y<A.length;y++){if(!(w===A[y].getName())){w=null;break}}}this.setName(w);var u=F.isAreaVisible();for(var y=1;y<A.length;y++){if(u!==A[y].isAreaVisible()){u=null;break}}this.setAreaVisible(u);var x=F.isFloorVisible();for(var y=1;y<A.length;y++){if(x!==A[y].isFloorVisible()){x=null;break}}this.setFloorVisible(x);var p=F.getFloorColor();if(p!=null){for(var y=1;y<A.length;y++){if(!(p===A[y].getFloorColor())){p=null;break}}}this.setFloorColor(p);var d=F.getFloorTexture();if(d!=null){for(var y=1;y<A.length;y++){if(!d.equals(A[y].getFloorTexture())){d=null;break}}}this.getFloorTextureController().setTexture(d);var r=true;for(var y=0;y<A.length;y++){var E=A[y];if(E.getFloorColor()!=null||E.getFloorTexture()!=null){r=false;break}}if(p!=null){this.setFloorPaint(a.RoomPaint.COLORED)}else{if(d!=null){this.setFloorPaint(a.RoomPaint.TEXTURED)}else{if(r){this.setFloorPaint(a.RoomPaint.DEFAULT)}else{this.setFloorPaint(null)}}}var v=F.getFloorShininess();for(var y=1;y<A.length;y++){if(!(v===A[y].getFloorShininess())){v=null;break}}this.setFloorShininess(v);var o=F.isCeilingVisible();for(var y=1;y<A.length;y++){if(o!==A[y].isCeilingVisible()){o=null;break}}this.setCeilingVisible(o);var z=F.getCeilingColor();if(z!=null){for(var y=1;y<A.length;y++){if(!(z===A[y].getCeilingColor())){z=null;break}}}this.setCeilingColor(z);var B=F.getCeilingTexture();if(B!=null){for(var y=1;y<A.length;y++){if(!B.equals(A[y].getCeilingTexture())){B=null;break}}}this.getCeilingTextureController().setTexture(B);r=true;for(var y=0;y<A.length;y++){var E=A[y];if(E.getCeilingColor()!=null||E.getCeilingTexture()!=null){r=false;break}}if(z!=null){this.setCeilingPaint(a.RoomPaint.COLORED)}else{if(B!=null){this.setCeilingPaint(a.RoomPaint.TEXTURED)}else{if(r){this.setCeilingPaint(a.RoomPaint.DEFAULT)}else{this.setCeilingPaint(null)}}}var c=F.getCeilingShininess();for(var y=1;y<A.length;y++){if(!(c===A[y].getCeilingShininess())){c=null;break}}this.setCeilingShininess(c)}var t=this.getRoomsWallSides(A,null);if((t.length==0)){this.wallSidesEditable=this.splitSurroundingWallsNeeded=this.splitSurroundingWalls=false;this.setWallSidesColor(null);this.setWallSidesPaint(null);this.setWallSidesShininess(null);this.getWallSidesBaseboardController().setVisible(null);this.getWallSidesBaseboardController().setThickness(null);this.getWallSidesBaseboardController().setHeight(null);this.getWallSidesBaseboardController().setColor(null);this.getWallSidesBaseboardController().getTextureController().setTexture(null);this.getWallSidesBaseboardController().setPaint(null)}else{this.wallSidesEditable=true;this.splitSurroundingWallsNeeded=this.splitWalls(t,null,null,null);this.splitSurroundingWalls=false;var f=t[0];var e=f.getSide()===a.WallSide.LEFT_SIDE?f.getWall().getLeftSideColor():f.getWall().getRightSideColor();if(e!=null){for(var y=1;y<t.length;y++){var l=t[y];if(!(e===(l.getSide()===a.WallSide.LEFT_SIDE?l.getWall().getLeftSideColor():l.getWall().getRightSideColor()))){e=null;break}}}this.setWallSidesColor(e);var b=f.getSide()===a.WallSide.LEFT_SIDE?f.getWall().getLeftSideTexture():f.getWall().getRightSideTexture();if(b!=null){for(var y=1;y<t.length;y++){var l=t[y];if(!b.equals(l.getSide()===a.WallSide.LEFT_SIDE?l.getWall().getLeftSideTexture():l.getWall().getRightSideTexture())){b=null;break}}}this.getWallSidesTextureController().setTexture(b);var r=true;for(var y=0;y<t.length;y++){var l=t[y];if((l.getSide()===a.WallSide.LEFT_SIDE?l.getWall().getLeftSideColor():l.getWall().getRightSideColor())!=null||(l.getSide()===a.WallSide.LEFT_SIDE?l.getWall().getLeftSideTexture():l.getWall().getRightSideTexture())!=null){r=false;break}}if(e!=null){this.setWallSidesPaint(a.RoomPaint.COLORED)}else{if(b!=null){this.setWallSidesPaint(a.RoomPaint.TEXTURED)}else{if(r){this.setWallSidesPaint(a.RoomPaint.DEFAULT)}else{this.setWallSidesPaint(null)}}}var n=f.getSide()===a.WallSide.LEFT_SIDE?f.getWall().getLeftSideShininess():f.getWall().getRightSideShininess();if(n!=null){for(var y=1;y<t.length;y++){var l=t[y];if(!(n===(l.getSide()===a.WallSide.LEFT_SIDE?l.getWall().getLeftSideShininess():l.getWall().getRightSideShininess()))){n=null;break}}}this.setWallSidesShininess(n);var q=f.getSide()===a.WallSide.LEFT_SIDE?f.getWall().getLeftSideBaseboard():f.getWall().getRightSideBaseboard();var C=q!=null;for(var y=1;y<t.length;y++){var l=t[y];if(C!==(l.getSide()===a.WallSide.LEFT_SIDE?l.getWall().getLeftSideBaseboard()!=null:l.getWall().getRightSideBaseboard()!=null)){C=null;break}}this.getWallSidesBaseboardController().setVisible(C);var g=q!=null?q.getThickness():this.preferences.getNewWallBaseboardThickness();for(var y=1;y<t.length;y++){var l=t[y];var k=l.getSide()===a.WallSide.LEFT_SIDE?l.getWall().getLeftSideBaseboard():l.getWall().getRightSideBaseboard();if(!(g===(k!=null?k.getThickness():this.preferences.getNewWallBaseboardThickness()))){g=null;break}}this.getWallSidesBaseboardController().setThickness(g);var s=q!=null?q.getHeight():this.preferences.getNewWallBaseboardHeight();for(var y=1;y<t.length;y++){var l=t[y];var k=l.getSide()===a.WallSide.LEFT_SIDE?l.getWall().getLeftSideBaseboard():l.getWall().getRightSideBaseboard();if(!(s===(k!=null?k.getHeight():this.preferences.getNewWallBaseboardHeight()))){s=null;break}}this.getWallSidesBaseboardController().setHeight(s);var j=f.getWall().isTrapezoidal()?Math.max(f.getWall().getHeight(),f.getWall().getHeightAtEnd()):f.getWall().getHeight();for(var y=1;y<t.length;y++){var D=t[y].getWall();j=Math.max(j,D.isTrapezoidal()?Math.max(D.getHeight(),D.getHeightAtEnd()):D.getHeight())}this.getWallSidesBaseboardController().setMaxHeight(j);var m=q!=null?q.getColor():null;if(m!=null){for(var y=1;y<t.length;y++){var l=t[y];var k=l.getSide()===a.WallSide.LEFT_SIDE?l.getWall().getLeftSideBaseboard():l.getWall().getRightSideBaseboard();if(k==null||!(m===k.getColor())){m=null;break}}}this.getWallSidesBaseboardController().setColor(m);var h=q!=null?q.getTexture():null;if(h!=null){for(var y=1;y<t.length;y++){var l=t[y];var k=l.getSide()===a.WallSide.LEFT_SIDE?l.getWall().getLeftSideBaseboard():l.getWall().getRightSideBaseboard();if(k==null||!h.equals(k.getTexture())){h=null;break}}}this.getWallSidesBaseboardController().getTextureController().setTexture(h);r=true;for(var y=0;y<t.length;y++){var l=t[y];var k=l.getSide()===a.WallSide.LEFT_SIDE?l.getWall().getLeftSideBaseboard():l.getWall().getRightSideBaseboard();if(k!=null&&(k.getColor()!=null||k.getTexture()!=null)){r=false;break}}if(m!=null){this.getWallSidesBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.COLORED)}else{if(h!=null){this.getWallSidesBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.TEXTURED)}else{if(r){this.getWallSidesBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.DEFAULT)}else{this.getWallSidesBaseboardController().setPaint(null)}}}}};a.prototype.getRoomsWallSides=function(e,d){var k=([]);for(var f=0;f<e.length;f++){var b=e[f];var j=new java.awt.geom.Area(this.getPath(b.getPoints(),true));if(d!=null){for(var h=0;h<d.length;h++){var c=d[h];if(this.isRoomItersectingWallSide(c.getWall().getPoints$(),c.getSide(),j)){(k.push(c)>0)}}}else{var g=this.home.getWalls();for(var h=0;h<g.length;h++){var l=g[h];if((l.getLevel()==null||l.getLevel().isViewable())&&l.isAtLevel(this.home.getSelectedLevel())){var m=l.getPoints$();if(this.isRoomItersectingWallSide(m,a.WallSide.LEFT_SIDE,j)){(k.push(new a.WallSide(l,a.WallSide.LEFT_SIDE))>0)}if(this.isRoomItersectingWallSide(m,a.WallSide.RIGHT_SIDE,j)){(k.push(new a.WallSide(l,a.WallSide.RIGHT_SIDE))>0)}}}}}return k};a.prototype.isRoomItersectingWallSide=function(b,d,e){var c=this.getWallSideArea(b,d);var g=this.getSurface(c);c.intersect(e);if(!c.isEmpty()){var f=this.getSurface(c);if(f>g*0.02){return true}}return false};a.prototype.getWallSideArea=function(b,c){var e=2;if(b.length===4){if(c===a.WallSide.LEFT_SIDE){return new java.awt.geom.Area(this.getPath(new Wall(b[0][0],b[0][1],b[1][0],b[1][1],e,0).getPoints$(),true))}else{return new java.awt.geom.Area(this.getPath(new Wall(b[2][0],b[2][1],b[3][0],b[3][1],e,0).getPoints$(),true))}}else{var g=(function(k){var j=[];while(k-->0){j.push(null)}return j})((b.length/2|0));(function(n,m,p,o,l){if(n!==p||o>=m+l){while(--l>=0){p[o++]=n[m++]}}else{var k=n.slice(m,m+l);for(var j=0;j<l;j++){p[o++]=k[j]}}})(b,c===a.WallSide.LEFT_SIDE?0:g.length,g,0,g.length);var f=(function(k){var j=[];while(k-->0){j.push(null)}return j})(g.length-1);for(var d=0;d<f.length;d++){f[d]=new Wall(g[d][0],g[d][1],g[d+1][0],g[d+1][1],e,0);if(d>0){f[d].setWallAtStart(f[d-1]);f[d-1].setWallAtEnd(f[d])}}g=(function(k){var j=[];while(k-->0){j.push(null)}return j})(b.length);var h=null;for(var d=0;d<f.length;d++){h=f[d].getPoints$();g[d]=h[0];g[g.length-d-1]=h[3]}g[(g.length/2|0)-1]=h[1];g[(g.length/2|0)]=h[2];return new java.awt.geom.Area(this.getPath(g,true))}};a.prototype.getPath=function(d,c){var e=new java.awt.geom.GeneralPath();e.moveTo(d[0][0],d[0][1]);for(var b=1;b<d.length;b++){e.lineTo(d[b][0],d[b][1])}if(c){e.closePath()}return e};a.prototype.getSurface=function(g){var b=0;var f=([]);for(var e=g.getPathIterator(null);!e.isDone();){var d=[0,0];switch((e.currentSegment(d))){case java.awt.geom.PathIterator.SEG_MOVETO:(f.push(d)>0);break;case java.awt.geom.PathIterator.SEG_LINETO:(f.push(d)>0);break;case java.awt.geom.PathIterator.SEG_CLOSE:var c=f.slice(0);b+=Math.abs(this.getSignedSurface(c));(f.length=0);break}e.next()}return b};a.prototype.getSignedSurface=function(d){var c=0;for(var b=1;b<d.length;b++){c+=d[b][0]*d[b-1][1];c-=d[b][1]*d[b-1][0]}c+=d[0][0]*d[d.length-1][1];c-=d[0][1]*d[d.length-1][0];return c/2};a.prototype.setName=function(b){if(b!==this.name){var c=this.name;this.name=b;this.propertyChangeSupport.firePropertyChange("NAME",c,b)}};a.prototype.getName=function(){return this.name};a.prototype.setAreaVisible=function(b){if(b!==this.areaVisible){var c=this.areaVisible;this.areaVisible=b;this.propertyChangeSupport.firePropertyChange("AREA_VISIBLE",c,b)}};a.prototype.getAreaVisible=function(){return this.areaVisible};a.prototype.setFloorVisible=function(c){if(c!==this.floorVisible){var b=this.floorVisible;this.floorVisible=c;this.propertyChangeSupport.firePropertyChange("FLOOR_VISIBLE",b,c)}};a.prototype.getFloorVisible=function(){return this.floorVisible};a.prototype.setFloorColor=function(b){if(b!==this.floorColor){var c=this.floorColor;this.floorColor=b;this.propertyChangeSupport.firePropertyChange("FLOOR_COLOR",c,b);this.setFloorPaint(a.RoomPaint.COLORED)}};a.prototype.getFloorColor=function(){return this.floorColor};a.prototype.setFloorPaint=function(b){if(b!==this.floorPaint){var c=this.floorPaint;this.floorPaint=b;this.propertyChangeSupport.firePropertyChange("FLOOR_PAINT",c,b)}};a.prototype.getFloorPaint=function(){return this.floorPaint};a.prototype.setFloorShininess=function(c){if(c!==this.floorShininess){var b=this.floorShininess;this.floorShininess=c;this.propertyChangeSupport.firePropertyChange("FLOOR_SHININESS",b,c)}};a.prototype.getFloorShininess=function(){return this.floorShininess};a.prototype.setCeilingVisible=function(b){if(b!==this.ceilingVisible){var c=this.ceilingVisible;this.ceilingVisible=b;this.propertyChangeSupport.firePropertyChange("CEILING_VISIBLE",c,b)}};a.prototype.getCeilingVisible=function(){return this.ceilingVisible};a.prototype.setCeilingColor=function(b){if(b!==this.ceilingColor){var c=this.ceilingColor;this.ceilingColor=b;this.propertyChangeSupport.firePropertyChange("CEILING_COLOR",c,b);this.setCeilingPaint(a.RoomPaint.COLORED)}};a.prototype.getCeilingColor=function(){return this.ceilingColor};a.prototype.setCeilingPaint=function(b){if(b!==this.ceilingPaint){var c=this.ceilingPaint;this.ceilingPaint=b;this.propertyChangeSupport.firePropertyChange("CEILING_PAINT",c,b)}};a.prototype.getCeilingPaint=function(){return this.ceilingPaint};a.prototype.setCeilingShininess=function(c){if(c!==this.ceilingShininess){var b=this.ceilingShininess;this.ceilingShininess=c;this.propertyChangeSupport.firePropertyChange("CEILING_SHININESS",b,c)}};a.prototype.getCeilingShininess=function(){return this.ceilingShininess};a.prototype.isSplitSurroundingWalls=function(){return this.splitSurroundingWalls};a.prototype.setSplitSurroundingWalls=function(b){if(b!==this.splitSurroundingWalls){this.splitSurroundingWalls=b;this.propertyChangeSupport.firePropertyChange("SPLIT_SURROUNDING_WALLS",!b,b)}};a.prototype.isSplitSurroundingWallsNeeded=function(){return this.splitSurroundingWallsNeeded};a.prototype.setWallSidesColor=function(b){if(b!==this.wallSidesColor){var c=this.wallSidesColor;this.wallSidesColor=b;this.propertyChangeSupport.firePropertyChange("WALL_SIDES_COLOR",c,b);this.setWallSidesPaint(a.RoomPaint.COLORED)}};a.prototype.getWallSidesColor=function(){return this.wallSidesColor};a.prototype.setWallSidesPaint=function(c){if(c!==this.wallSidesPaint){var b=this.wallSidesPaint;this.wallSidesPaint=c;this.propertyChangeSupport.firePropertyChange("WALL_SIDES_PAINT",b,c)}};a.prototype.getWallSidesPaint=function(){return this.wallSidesPaint};a.prototype.setWallSidesShininess=function(b){if(b!==this.wallSidesShininess){var c=this.wallSidesShininess;this.wallSidesShininess=b;this.propertyChangeSupport.firePropertyChange("WALL_SIDES_SHININESS",c,b)}};a.prototype.getWallSidesShininess=function(){return this.wallSidesShininess};a.prototype.modifyRooms=function(){var E=this.home.getSelectedItems();var C=Home.getRoomsSubList(E);if(!(C.length==0)){var u=this.getName();var s=this.getAreaVisible();var x=this.getFloorVisible();var k=this.getFloorPaint();var o=k===a.RoomPaint.COLORED?this.getFloorColor():null;var e=k===a.RoomPaint.TEXTURED?this.getFloorTextureController().getTexture():null;var t=this.getFloorShininess();var n=this.getCeilingVisible();var w=this.getCeilingPaint();var B=w===a.RoomPaint.COLORED?this.getCeilingColor():null;var D=w===a.RoomPaint.TEXTURED?this.getCeilingTextureController().getTexture():null;var c=this.getCeilingShininess();var d=this.getWallSidesPaint();var f=d===a.RoomPaint.COLORED?this.getWallSidesColor():null;var b=d===a.RoomPaint.TEXTURED?this.getWallSidesTextureController().getTexture():null;var m=this.getWallSidesShininess();var F=this.getWallSidesBaseboardController().getVisible();var g=this.getWallSidesBaseboardController().getThickness();var q=this.getWallSidesBaseboardController().getHeight();var j=this.getWallSidesBaseboardController().getPaint();var l=j===BaseboardChoiceController.BaseboardPaint.COLORED?this.getWallSidesBaseboardController().getColor():null;var h=j===BaseboardChoiceController.BaseboardPaint.TEXTURED?this.getWallSidesBaseboardController().getTextureController().getTexture():null;var A=this.getRoomsWallSides(C,null);var p=(function(I){var H=[];while(I-->0){H.push(null)}return H})(C.length);for(var z=0;z<p.length;z++){p[z]=new a.ModifiedRoom(C[z])}var y=([]);var r=([]);var v=(E.slice(0));if(this.splitSurroundingWalls){if(this.splitWalls(A,y,r,v)){this.home.setSelectedItems(v);A=this.getRoomsWallSides(C,A)}}var G=(function(I){var H=[];while(I-->0){H.push(null)}return H})(A.length);for(var z=0;z<G.length;z++){G[z]=new a.ModifiedWallSide(A[z])}a.doModifyRoomsAndWallSides(this.home,p,u,s,x,k,o,e,t,n,w,B,D,c,G,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),d,f,b,m,F,g,q,j,l,h,null,null);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.RoomsAndWallSidesModificationUndoableEdit(this.home,this.preferences,E.slice(0),v.slice(0),p,u,s,x,k,o,e,t,n,w,B,D,c,G,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),d,f,b,m,F,g,q,j,l,h,y.slice(0),r.slice(0)))}if(u!=null){this.preferences.addAutoCompletionString("RoomName",u)}}};a.prototype.splitWalls=function(m,l,n,g){var f=null;var j=([]);var o;var b=function(){o=null;var H=null;var B=null;var s=null;for(var D=0;D<m.length&&o==null;D++){var y=m[D];var F=y.getWall();var C=F.getArcExtent();if(C==null||C===0){var q=new java.awt.geom.Area(p.getPath(F.getPoints$(),true));for(var v=0;v<m.length;v++){var t=m[v];var x=t.getWall();if(F!==x){var I=new java.awt.geom.Area(p.getPath(x.getPoints$(),true));I.intersect(q);if(!I.isEmpty()&&I.isSingular()){var A=p.computeIntersection(F.getXStart(),F.getYStart(),F.getXEnd(),F.getYEnd(),x.getXStart(),x.getYStart(),x.getXEnd(),x.getYEnd());if(A!=null){H=F.duplicate();B=F.duplicate();H.setLevel(F.getLevel());B.setLevel(F.getLevel());H.setXEnd(A[0]);H.setYEnd(A[1]);B.setXStart(A[0]);B.setYStart(A[1]);if(H.getLength()>x.getThickness()/2&&B.getLength()>x.getThickness()/2){if(l==null){return{value:true}}if(f==null){f=({});for(var u=0;u<m.length;u++){var r=m[u];if(!(function(K,L){if(K.entries==null){K.entries=[]}for(var M=0;M<K.entries.length;M++){if(K.entries[M].key==null&&L==null||K.entries[M].key.equals!=null&&K.entries[M].key.equals(L)||K.entries[M].key===L){return true}}return false})(f,r.getWall())){(function(K,M,L){if(K.entries==null){K.entries=[]}for(var N=0;N<K.entries.length;N++){if(K.entries[N].key==null&&M==null||K.entries[N].key.equals!=null&&K.entries[N].key.equals(M)||K.entries[N].key===M){K.entries[N].value=L;return}}K.entries.push({key:M,value:L,getKey:function(){return this.key},getValue:function(){return this.value}})})(f,r.getWall(),new a.ModifiedWall(r.getWall()))}}}s=(function(K,L){if(K.entries==null){K.entries=[]}for(var M=0;M<K.entries.length;M++){if(K.entries[M].key==null&&L==null||K.entries[M].key.equals!=null&&K.entries[M].key.equals(L)||K.entries[M].key===L){return K.entries[M].value}}return null})(f,F);var G=F.getWallAtStart();if(G!=null){H.setWallAtStart(G);if(G.getWallAtEnd()===F){G.setWallAtEnd(H)}else{G.setWallAtStart(H)}}var w=F.getWallAtEnd();if(w!=null){B.setWallAtEnd(w);if(w.getWallAtEnd()===F){w.setWallAtEnd(B)}else{w.setWallAtStart(B)}}H.setWallAtEnd(B);B.setWallAtStart(H);if(F.getHeightAtEnd()!=null){var z=F.getHeight()+(F.getHeightAtEnd()-F.getHeight())*java.awt.geom.Point2D.distance(F.getXStart(),F.getYStart(),A[0],A[1])/F.getLength();H.setHeightAtEnd(z);B.setHeight(z)}o=y;break}}}}}}}if(o!=null){(j.push(H)>0);(j.push(B)>0);var E=o.getWall();if((p.home.getWalls().indexOf((E))>=0)){(l.push(s)>0)}else{for(var D=j.length-1;D>=0;D--){if(j[D]===E){j.splice(D,1)[0];break}}}if((function(K){var L=K.indexOf(E);if(L>=0){K.splice(L,1);return true}else{return false}})(g)){(g.push(H)>0);(g.push(B)>0)}(function(K){var L=K.indexOf(o);if(L>=0){K.splice(L,1);return true}else{return false}})(m);(m.push(new a.WallSide(H,o.getSide()))>0);(m.push(new a.WallSide(B,o.getSide()))>0);var J=([]);for(var D=m.length-1;D>=0;D--){var y=m[D];if(y.getWall()===E){m.splice(D,1)[0];(J.push(new a.WallSide(H,y.getSide()))>0);(J.push(new a.WallSide(B,y.getSide()))>0)}}(function(L,K){return L.push.apply(L,K)})(m,J)}};var p=this;do{var c=b();if(typeof c==="object"){return c.value}}while((o!=null));if(l==null){return false}else{for(var h=0;h<j.length;h++){var e=j[h];var k=new a.ModifiedWall(e);(n.push(k)>0);this.home.addWall(e);e.setLevel(k.getLevel())}for(var h=0;h<l.length;h++){var d=l[h];this.home.deleteWall(d.getWall())}return !(l.length==0)}};a.prototype.computeIntersection=function(k,e,j,d,h,c,g,b){var f=PlanController.computeIntersection$float$float$float$float$float$float$float$float(k,e,j,d,h,c,g,b);if(java.awt.geom.Line2D.ptSegDistSq(k,e,j,d,f[0],f[1])<1e-7&&(Math.abs(k-f[0])>0.0001||Math.abs(e-f[1])>0.0001)&&(Math.abs(j-f[0])>0.0001||Math.abs(d-f[1])>0.0001)){return f}else{return null}};a.doModifyRoomsAndWallSides=function(k,D,o,d,H,B,q,C,x,L,w,l,I,G,z,p,e,j,K,J,P,O,f,h,E,r,M,s,u){if(s!=null){for(var A=0;A<u.length;A++){var N=u[A];N.resetJoinedWalls();k.addWall(N.getWall());N.getWall().setLevel(N.getLevel())}for(var A=0;A<s.length;A++){var F=s[A];k.deleteWall(F.getWall())}}for(var A=0;A<D.length;A++){var g=D[A];var v=g.getRoom();if(o!=null){v.setName(o)}if(d!=null){v.setAreaVisible(d)}if(H!=null){v.setFloorVisible(H)}if(B!=null){switch((B)){case a.RoomPaint.DEFAULT:v.setFloorColor(null);v.setFloorTexture(null);break;case a.RoomPaint.COLORED:v.setFloorColor(q);v.setFloorTexture(null);break;case a.RoomPaint.TEXTURED:v.setFloorColor(null);v.setFloorTexture(C);break}}if(x!=null){v.setFloorShininess(x)}if(L!=null){v.setCeilingVisible(L)}if(w!=null){switch((w)){case a.RoomPaint.DEFAULT:v.setCeilingColor(null);v.setCeilingTexture(null);break;case a.RoomPaint.COLORED:v.setCeilingColor(l);v.setCeilingTexture(null);break;case a.RoomPaint.TEXTURED:v.setCeilingColor(null);v.setCeilingTexture(I);break}}if(G!=null){v.setCeilingShininess(G)}}for(var A=0;A<z.length;A++){var b=z[A];var R=b.getWallSide();var m=R.getWall();if(R.getSide()===a.WallSide.LEFT_SIDE){if(j!=null){switch((j)){case a.RoomPaint.DEFAULT:m.setLeftSideColor(null);m.setLeftSideTexture(null);break;case a.RoomPaint.COLORED:m.setLeftSideColor(K);m.setLeftSideTexture(null);break;case a.RoomPaint.TEXTURED:m.setLeftSideColor(null);m.setLeftSideTexture(J);break}}if(P!=null){m.setLeftSideShininess(P)}}else{if(j!=null){switch((j)){case a.RoomPaint.DEFAULT:m.setRightSideColor(null);m.setRightSideTexture(null);break;case a.RoomPaint.COLORED:m.setRightSideColor(K);m.setRightSideTexture(null);break;case a.RoomPaint.TEXTURED:m.setRightSideColor(null);m.setRightSideTexture(J);break}}if(P!=null){m.setRightSideShininess(P)}}if(O===false){if(R.getSide()===a.WallSide.LEFT_SIDE){m.setLeftSideBaseboard(null)}else{m.setRightSideBaseboard(null)}}else{var c=R.getSide()===a.WallSide.LEFT_SIDE?m.getLeftSideBaseboard():m.getRightSideBaseboard();if(O===true||c!=null){var t=c!=null?c.getThickness():p;var y=c!=null?c.getHeight():e;var Q=c!=null?c.getColor():null;var n=c!=null?c.getTexture():null;if(E!=null){switch((E)){case BaseboardChoiceController.BaseboardPaint.DEFAULT:Q=null;n=null;break;case BaseboardChoiceController.BaseboardPaint.COLORED:if(r!=null){Q=r}n=null;break;case BaseboardChoiceController.BaseboardPaint.TEXTURED:Q=null;if(M!=null){n=M}break}}c=Baseboard.getInstance(f!=null?f:t,h!=null?h:y,Q,n);if(R.getSide()===a.WallSide.LEFT_SIDE){m.setLeftSideBaseboard(c)}else{m.setRightSideBaseboard(c)}}}}};a.undoModifyRoomsAndWallSides=function(h,d,l,j,k){for(var g=0;g<d.length;g++){var c=d[g];c.reset()}for(var g=0;g<l.length;g++){var b=l[g];b.reset()}for(var g=0;g<k.length;g++){var f=k[g];h.deleteWall(f.getWall())}for(var g=0;g<j.length;g++){var e=j[g];e.resetJoinedWalls();h.addWall(e.getWall());e.getWall().setLevel(e.getLevel())}};return a}());RoomController.__class="com.eteks.sweethome3d.viewcontroller.RoomController";RoomController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(c){var f;(function(l){l[l.DEFAULT=0]="DEFAULT";l[l.COLORED=1]="COLORED";l[l.TEXTURED=2]="TEXTURED"})(f=c.RoomPaint||(c.RoomPaint={}));var a=(function(l){__extends(m,l);function m(R,D,P,I,E,T,G,L,w,A,r,H,z,J,N,O,p,S,B,q,o,s,n,y,Q,t,C,v,x,u,M,F){var K=l.call(this,D,c,"undoModifyRoomsName")||this;if(K.home===undefined){K.home=null}if(K.oldSelection===undefined){K.oldSelection=null}if(K.newSelection===undefined){K.newSelection=null}if(K.modifiedRooms===undefined){K.modifiedRooms=null}if(K.name===undefined){K.name=null}if(K.areaVisible===undefined){K.areaVisible=null}if(K.floorVisible===undefined){K.floorVisible=null}if(K.floorPaint===undefined){K.floorPaint=null}if(K.floorColor===undefined){K.floorColor=null}if(K.floorTexture===undefined){K.floorTexture=null}if(K.floorShininess===undefined){K.floorShininess=null}if(K.ceilingVisible===undefined){K.ceilingVisible=null}if(K.ceilingPaint===undefined){K.ceilingPaint=null}if(K.ceilingColor===undefined){K.ceilingColor=null}if(K.ceilingTexture===undefined){K.ceilingTexture=null}if(K.ceilingShininess===undefined){K.ceilingShininess=null}if(K.modifiedWallSides===undefined){K.modifiedWallSides=null}if(K.newWallBaseboardHeight===undefined){K.newWallBaseboardHeight=0}if(K.newWallBaseboardThickness===undefined){K.newWallBaseboardThickness=0}if(K.wallSidesPaint===undefined){K.wallSidesPaint=null}if(K.wallSidesColor===undefined){K.wallSidesColor=null}if(K.wallSidesTexture===undefined){K.wallSidesTexture=null}if(K.wallSidesShininess===undefined){K.wallSidesShininess=null}if(K.wallSidesBaseboardVisible===undefined){K.wallSidesBaseboardVisible=null}if(K.wallSidesBaseboardThickness===undefined){K.wallSidesBaseboardThickness=null}if(K.wallSidesBaseboardHeight===undefined){K.wallSidesBaseboardHeight=null}if(K.wallSidesBaseboardPaint===undefined){K.wallSidesBaseboardPaint=null}if(K.wallSidesBaseboardColor===undefined){K.wallSidesBaseboardColor=null}if(K.wallSidesBaseboardTexture===undefined){K.wallSidesBaseboardTexture=null}if(K.deletedWalls===undefined){K.deletedWalls=null}if(K.addedWalls===undefined){K.addedWalls=null}K.home=R;K.oldSelection=P;K.newSelection=I;K.modifiedRooms=E;K.name=T;K.areaVisible=G;K.floorVisible=L;K.floorPaint=w;K.floorColor=A;K.floorTexture=r;K.floorShininess=H;K.ceilingVisible=z;K.ceilingPaint=J;K.ceilingColor=N;K.ceilingTexture=O;K.ceilingShininess=p;K.modifiedWallSides=S;K.newWallBaseboardThickness=B;K.newWallBaseboardHeight=q;K.wallSidesPaint=o;K.wallSidesColor=s;K.wallSidesTexture=n;K.wallSidesShininess=y;K.wallSidesBaseboardVisible=Q;K.wallSidesBaseboardThickness=t;K.wallSidesBaseboardHeight=C;K.wallSidesBaseboardPaint=v;K.wallSidesBaseboardColor=x;K.wallSidesBaseboardTexture=u;K.deletedWalls=M;K.addedWalls=F;return K}m.prototype.undo=function(){l.prototype.undo.call(this);c.undoModifyRoomsAndWallSides(this.home,this.modifiedRooms,this.modifiedWallSides,this.deletedWalls,this.addedWalls);this.home.setSelectedItems(this.oldSelection.slice(0))};m.prototype.redo=function(){l.prototype.redo.call(this);c.doModifyRoomsAndWallSides(this.home,this.modifiedRooms,this.name,this.areaVisible,this.floorVisible,this.floorPaint,this.floorColor,this.floorTexture,this.floorShininess,this.ceilingVisible,this.ceilingPaint,this.ceilingColor,this.ceilingTexture,this.ceilingShininess,this.modifiedWallSides,this.newWallBaseboardThickness,this.newWallBaseboardHeight,this.wallSidesPaint,this.wallSidesColor,this.wallSidesTexture,this.wallSidesShininess,this.wallSidesBaseboardVisible,this.wallSidesBaseboardThickness,this.wallSidesBaseboardHeight,this.wallSidesBaseboardPaint,this.wallSidesBaseboardColor,this.wallSidesBaseboardTexture,this.deletedWalls,this.addedWalls);this.home.setSelectedItems(this.newSelection.slice(0))};return m}(LocalizedUndoableEdit));c.RoomsAndWallSidesModificationUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.RoomController.RoomsAndWallSidesModificationUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"];var k=(function(){function l(m){if(this.room===undefined){this.room=null}if(this.name===undefined){this.name=null}if(this.areaVisible===undefined){this.areaVisible=false}if(this.floorVisible===undefined){this.floorVisible=false}if(this.floorColor===undefined){this.floorColor=null}if(this.floorTexture===undefined){this.floorTexture=null}if(this.floorShininess===undefined){this.floorShininess=0}if(this.ceilingVisible===undefined){this.ceilingVisible=false}if(this.ceilingColor===undefined){this.ceilingColor=null}if(this.ceilingTexture===undefined){this.ceilingTexture=null}if(this.ceilingShininess===undefined){this.ceilingShininess=0}this.room=m;this.name=m.getName();this.areaVisible=m.isAreaVisible();this.floorVisible=m.isFloorVisible();this.floorColor=m.getFloorColor();this.floorTexture=m.getFloorTexture();this.floorShininess=m.getFloorShininess();this.ceilingVisible=m.isCeilingVisible();this.ceilingColor=m.getCeilingColor();this.ceilingTexture=m.getCeilingTexture();this.ceilingShininess=m.getCeilingShininess()}l.prototype.getRoom=function(){return this.room};l.prototype.reset=function(){this.room.setName(this.name);this.room.setAreaVisible(this.areaVisible);this.room.setFloorVisible(this.floorVisible);this.room.setFloorColor(this.floorColor);this.room.setFloorTexture(this.floorTexture);this.room.setFloorShininess(this.floorShininess);this.room.setCeilingVisible(this.ceilingVisible);this.room.setCeilingColor(this.ceilingColor);this.room.setCeilingTexture(this.ceilingTexture);this.room.setCeilingShininess(this.ceilingShininess)};return l}());c.ModifiedRoom=k;k.__class="com.eteks.sweethome3d.viewcontroller.RoomController.ModifiedRoom";var j=(function(){function l(m,n){if(this.wall===undefined){this.wall=null}if(this.side===undefined){this.side=0}if(this.wallAtStart===undefined){this.wallAtStart=null}if(this.wallAtEnd===undefined){this.wallAtEnd=null}if(this.joinedAtEndOfWallAtStart===undefined){this.joinedAtEndOfWallAtStart=false}if(this.joinedAtStartOfWallAtEnd===undefined){this.joinedAtStartOfWallAtEnd=false}this.wall=m;this.side=n;this.wallAtStart=m.getWallAtStart();this.joinedAtEndOfWallAtStart=this.wallAtStart!=null&&this.wallAtStart.getWallAtEnd()===m;this.wallAtEnd=m.getWallAtEnd();this.joinedAtStartOfWallAtEnd=this.wallAtEnd!=null&&this.wallAtEnd.getWallAtStart()===m}l.prototype.getWall=function(){return this.wall};l.prototype.getSide=function(){return this.side};l.prototype.getWallAtStart=function(){return this.wallAtStart};l.prototype.getWallAtEnd=function(){return this.wallAtEnd};l.prototype.isJoinedAtEndOfWallAtStart=function(){return this.joinedAtEndOfWallAtStart};l.prototype.isJoinedAtStartOfWallAtEnd=function(){return this.joinedAtStartOfWallAtEnd};l.LEFT_SIDE=0;l.RIGHT_SIDE=1;return l}());c.WallSide=j;j.__class="com.eteks.sweethome3d.viewcontroller.RoomController.WallSide";var g=(function(){function l(m){if(this.wall===undefined){this.wall=null}if(this.level===undefined){this.level=null}if(this.wallAtStart===undefined){this.wallAtStart=null}if(this.wallAtEnd===undefined){this.wallAtEnd=null}if(this.joinedAtEndOfWallAtStart===undefined){this.joinedAtEndOfWallAtStart=false}if(this.joinedAtStartOfWallAtEnd===undefined){this.joinedAtStartOfWallAtEnd=false}this.wall=m;this.level=m.getLevel();this.wallAtStart=m.getWallAtStart();this.joinedAtEndOfWallAtStart=this.wallAtStart!=null&&this.wallAtStart.getWallAtEnd()===m;this.wallAtEnd=m.getWallAtEnd();this.joinedAtStartOfWallAtEnd=this.wallAtEnd!=null&&this.wallAtEnd.getWallAtStart()===m}l.prototype.getWall=function(){return this.wall};l.prototype.getLevel=function(){return this.level};l.prototype.resetJoinedWalls=function(){if(this.wallAtStart!=null){this.wall.setWallAtStart(this.wallAtStart);if(this.joinedAtEndOfWallAtStart){this.wallAtStart.setWallAtEnd(this.wall)}else{this.wallAtStart.setWallAtStart(this.wall)}}if(this.wallAtEnd!=null){this.wall.setWallAtEnd(this.wallAtEnd);if(this.joinedAtStartOfWallAtEnd){this.wallAtEnd.setWallAtStart(this.wall)}else{this.wallAtEnd.setWallAtEnd(this.wall)}}};return l}());c.ModifiedWall=g;g.__class="com.eteks.sweethome3d.viewcontroller.RoomController.ModifiedWall";var h=(function(){function l(n){if(this.wallSide===undefined){this.wallSide=null}if(this.wallColor===undefined){this.wallColor=null}if(this.wallTexture===undefined){this.wallTexture=null}if(this.wallShininess===undefined){this.wallShininess=null}if(this.wallBaseboard===undefined){this.wallBaseboard=null}this.wallSide=n;var m=n.getWall();if(n.getSide()===c.WallSide.LEFT_SIDE){this.wallColor=m.getLeftSideColor();this.wallTexture=m.getLeftSideTexture();this.wallShininess=m.getLeftSideShininess();this.wallBaseboard=m.getLeftSideBaseboard()}else{this.wallColor=m.getRightSideColor();this.wallTexture=m.getRightSideTexture();this.wallShininess=m.getRightSideShininess();this.wallBaseboard=m.getRightSideBaseboard()}}l.prototype.getWallSide=function(){return this.wallSide};l.prototype.reset=function(){var m=this.wallSide.getWall();if(this.wallSide.getSide()===c.WallSide.LEFT_SIDE){m.setLeftSideColor(this.wallColor);m.setLeftSideTexture(this.wallTexture);m.setLeftSideShininess(this.wallShininess);m.setLeftSideBaseboard(this.wallBaseboard)}else{m.setRightSideColor(this.wallColor);m.setRightSideTexture(this.wallTexture);m.setRightSideShininess(this.wallShininess);m.setRightSideBaseboard(this.wallBaseboard)}var n=this.wallSide.getWallAtStart();if(n!=null){m.setWallAtStart(n);if(this.wallSide.isJoinedAtEndOfWallAtStart()){n.setWallAtEnd(m)}else{n.setWallAtStart(m)}}var o=this.wallSide.getWallAtEnd();if(o!=null){m.setWallAtEnd(o);if(this.wallSide.isJoinedAtStartOfWallAtEnd()){o.setWallAtStart(m)}else{o.setWallAtEnd(m)}}};return l}());c.ModifiedWallSide=h;h.__class="com.eteks.sweethome3d.viewcontroller.RoomController.ModifiedWallSide";var e=(function(){function l(m){this.__parent=m}l.prototype.propertyChange=function(m){this.__parent.setFloorPaint(c.RoomPaint.TEXTURED)};return l}());c.RoomController$0=e;var d=(function(){function l(m){this.__parent=m}l.prototype.propertyChange=function(m){this.__parent.setCeilingPaint(c.RoomPaint.TEXTURED)};return l}());c.RoomController$1=d;var b=(function(){function l(m){this.__parent=m}l.prototype.propertyChange=function(m){this.__parent.setWallSidesPaint(c.RoomPaint.TEXTURED)};return l}());c.RoomController$2=b})(RoomController||(RoomController={}));var CompassController=(function(){function a(e,c,b,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.compassView===undefined){this.compassView=null}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.diameter===undefined){this.diameter=0}if(this.visible===undefined){this.visible=false}if(this.northDirectionInDegrees===undefined){this.northDirectionInDegrees=0}if(this.latitudeInDegrees===undefined){this.latitudeInDegrees=0}if(this.longitudeInDegrees===undefined){this.longitudeInDegrees=0}if(this.timeZone===undefined){this.timeZone=null}this.home=e;this.preferences=c;this.viewFactory=b;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getView=function(){if(this.compassView==null){this.compassView=this.viewFactory.createCompassView(this.preferences,this)}return this.compassView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var b=this.home.getCompass();this.setX(b.getX());this.setY(b.getY());this.setDiameter(b.getDiameter());this.setVisible(b.isVisible());this.setNorthDirectionInDegrees((function(c){return c*180/Math.PI})(b.getNorthDirection()));this.setLatitudeInDegrees((function(c){return c*180/Math.PI})(b.getLatitude()));this.setLongitudeInDegrees((function(c){return c*180/Math.PI})(b.getLongitude()));this.setTimeZone(b.getTimeZone())};a.prototype.getX=function(){return this.x};a.prototype.setX=function(b){if(b!==this.x){var c=this.x;this.x=b;this.propertyChangeSupport.firePropertyChange("X",c,b)}};a.prototype.getY=function(){return this.y};a.prototype.setY=function(c){if(c!==this.y){var b=this.y;this.y=c;this.propertyChangeSupport.firePropertyChange("Y",b,c)}};a.prototype.getDiameter=function(){return this.diameter};a.prototype.setDiameter=function(b){if(b!==this.diameter){var c=this.diameter;this.diameter=b;this.propertyChangeSupport.firePropertyChange("DIAMETER",c,b)}};a.prototype.isVisible=function(){return this.visible};a.prototype.setVisible=function(b){if(b!==this.visible){this.visible=b;this.propertyChangeSupport.firePropertyChange("VISIBLE",!b,b)}};a.prototype.getNorthDirectionInDegrees=function(){return this.northDirectionInDegrees};a.prototype.setNorthDirectionInDegrees=function(b){if(b!==this.northDirectionInDegrees){var c=this.northDirectionInDegrees;this.northDirectionInDegrees=b;this.propertyChangeSupport.firePropertyChange("NORTH_DIRECTION_IN_DEGREES",c,b)}};a.prototype.getLatitudeInDegrees=function(){return this.latitudeInDegrees};a.prototype.setLatitudeInDegrees=function(c){if(c!==this.latitudeInDegrees){var b=this.latitudeInDegrees;this.latitudeInDegrees=c;this.propertyChangeSupport.firePropertyChange("LATITUDE_IN_DEGREES",b,c)}};a.prototype.getLongitudeInDegrees=function(){return this.longitudeInDegrees};a.prototype.setLongitudeInDegrees=function(c){if(c!==this.longitudeInDegrees){var b=this.longitudeInDegrees;this.longitudeInDegrees=c;this.propertyChangeSupport.firePropertyChange("LONGITUDE_IN_DEGREES",b,c)}};a.prototype.getTimeZone=function(){return this.timeZone};a.prototype.setTimeZone=function(b){if(!(b===this.timeZone)){var c=this.timeZone;this.timeZone=b;this.propertyChangeSupport.firePropertyChange("TIME_ZONE",c,b)}};a.prototype.modifyCompass=function(){var h=this.getX();var f=this.getY();var k=this.getDiameter();var d=this.isVisible();var e=(function(l){return l*Math.PI/180})(this.getNorthDirectionInDegrees());var g=(function(l){return l*Math.PI/180})(this.getLatitudeInDegrees());var b=(function(l){return l*Math.PI/180})(this.getLongitudeInDegrees());var j=this.getTimeZone();var c=new a.CompassUndoableEdit(this.home.getCompass(),this.preferences,h,f,k,d,e,g,b,j);a.doModifyCompass(this.home.getCompass(),h,f,k,d,e,g,b,j);this.undoSupport.postEdit(c)};a.doModifyCompass=function(c,h,f,k,d,e,g,b,j){c.setX(h);c.setY(f);c.setDiameter(k);c.setVisible(d);c.setNorthDirection(e);c.setLatitude(g);c.setLongitude(b);c.setTimeZone(j)};return a}());CompassController.__class="com.eteks.sweethome3d.viewcontroller.CompassController";CompassController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(b){var a=(function(c){__extends(d,c);function d(f,j,e,o,p,g,h,k,n,m){var l=c.call(this,j,b,"undoModifyCompassName")||this;if(l.compass===undefined){l.compass=null}if(l.oldX===undefined){l.oldX=0}if(l.oldY===undefined){l.oldY=0}if(l.oldDiameter===undefined){l.oldDiameter=0}if(l.oldNorthDirection===undefined){l.oldNorthDirection=0}if(l.oldLatitude===undefined){l.oldLatitude=0}if(l.oldLongitude===undefined){l.oldLongitude=0}if(l.oldTimeZone===undefined){l.oldTimeZone=null}if(l.oldVisible===undefined){l.oldVisible=false}if(l.newX===undefined){l.newX=0}if(l.newY===undefined){l.newY=0}if(l.newDiameter===undefined){l.newDiameter=0}if(l.newNorthDirection===undefined){l.newNorthDirection=0}if(l.newLatitude===undefined){l.newLatitude=0}if(l.newLongitude===undefined){l.newLongitude=0}if(l.newTimeZone===undefined){l.newTimeZone=null}if(l.newVisible===undefined){l.newVisible=false}l.compass=f;l.oldX=f.getX();l.oldY=f.getY();l.oldDiameter=f.getDiameter();l.oldVisible=f.isVisible();l.oldNorthDirection=f.getNorthDirection();l.oldLatitude=f.getLatitude();l.oldLongitude=f.getLongitude();l.oldTimeZone=f.getTimeZone();l.newX=e;l.newY=o;l.newDiameter=p;l.newVisible=g;l.newNorthDirection=h;l.newLatitude=k;l.newLongitude=n;l.newTimeZone=m;return l}d.prototype.undo=function(){c.prototype.undo.call(this);b.doModifyCompass(this.compass,this.oldX,this.oldY,this.oldDiameter,this.oldVisible,this.oldNorthDirection,this.oldLatitude,this.oldLongitude,this.oldTimeZone)};d.prototype.redo=function(){c.prototype.redo.call(this);b.doModifyCompass(this.compass,this.newX,this.newY,this.newDiameter,this.newVisible,this.newNorthDirection,this.newLatitude,this.newLongitude,this.newTimeZone)};return d}(LocalizedUndoableEdit));b.CompassUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.CompassController.CompassUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"]})(CompassController||(CompassController={}));var PolylineController=(function(){function a(f,c,b,e,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.polylineView===undefined){this.polylineView=null}if(this.thickness===undefined){this.thickness=null}if(this.capStyleEditable===undefined){this.capStyleEditable=false}if(this.capStyle===undefined){this.capStyle=null}if(this.joinStyle===undefined){this.joinStyle=null}if(this.joinStyleEditable===undefined){this.joinStyleEditable=false}if(this.dashStyle===undefined){this.dashStyle=null}if(this.dashPattern===undefined){this.dashPattern=null}if(this.dashOffset===undefined){this.dashOffset=null}if(this.arrowsStyleEditable===undefined){this.arrowsStyleEditable=false}if(this.startArrowStyle===undefined){this.startArrowStyle=null}if(this.endArrowStyle===undefined){this.endArrowStyle=null}if(this.color===undefined){this.color=null}if(this.elevation===undefined){this.elevation=null}if(this.elevationEnabled===undefined){this.elevationEnabled=null}this.home=f;this.preferences=c;this.viewFactory=b;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getView=function(){if(this.polylineView==null){this.polylineView=this.viewFactory.createPolylineView(this.preferences,this)}return this.polylineView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var m=Home.getPolylinesSubList(this.home.getSelectedItems());if((m.length==0)){this.setThickness(null);this.capStyleEditable=false;this.setCapStyle(null);this.joinStyleEditable=false;this.setJoinStyle(null);this.setDashStyle(null);this.dashPattern=null;this.setDashOffset(null);this.arrowsStyleEditable=false;this.setStartArrowStyle(null);this.setEndArrowStyle(null);this.setColor(null);this.elevationEnabled=false}else{var d=m[0];var l=d.getThickness();for(var h=1;h<m.length;h++){if(l!==m[h].getThickness()){l=null;break}}this.setThickness(l);this.capStyleEditable=false;for(var h=0;h<m.length;h++){if(!m[h].isClosedPath()){this.capStyleEditable=true;break}}if(this.capStyleEditable){var o=d.getCapStyle();if(o!=null){for(var h=1;h<m.length;h++){if(o!==m[h].getCapStyle()){o=null;break}}}this.setCapStyle(o)}else{this.setCapStyle(null)}this.joinStyleEditable=false;for(var h=0;h<m.length;h++){if(m[h].getPointCount()>2){this.joinStyleEditable=true;break}}if(this.joinStyleEditable){var g=d.getJoinStyle();if(g!=null){for(var h=1;h<m.length;h++){if(g!==m[h].getJoinStyle()){g=null;break}}}this.setJoinStyle(g)}else{this.setJoinStyle(null)}var b=d.getDashPattern();if(b!=null){for(var h=1;h<m.length;h++){if(!(function(r,q){if(r==null&&q==null){return true}if(r==null||q==null){return false}if(r.length!=q.length){return false}for(var s=0;s<r.length;s++){if(r[s]!=q[s]){return false}}return true})(b,m[h].getDashPattern())){b=null;break}}}this.setDashPattern(b);if(b!=null){var p=d.getDashStyle();if(p!=null){for(var h=1;h<m.length;h++){if(p!==m[h].getDashStyle()){p=null;break}}}if(p===Polyline.DashStyle.CUSTOMIZED){}this.setDashStyle(p)}else{this.setDashStyle(null)}var f=d.getDashOffset();for(var h=1;h<m.length;h++){if(f!==m[h].getDashOffset()){f=null;break}}this.setDashOffset(f);this.arrowsStyleEditable=this.capStyleEditable;if(this.arrowsStyleEditable){var j=d.getStartArrowStyle();if(j!=null){for(var h=1;h<m.length;h++){if(j!==m[h].getStartArrowStyle()){j=null;break}}}this.setStartArrowStyle(j);var c=d.getEndArrowStyle();if(c!=null){for(var h=1;h<m.length;h++){if(c!==m[h].getEndArrowStyle()){c=null;break}}}this.setEndArrowStyle(c)}else{this.setStartArrowStyle(null);this.setEndArrowStyle(null)}var e=d.getColor();if(e!=null){for(var h=1;h<m.length;h++){if(e!==m[h].getColor()){e=null;break}}}this.setColor(e);var n=d.getElevation();for(var h=1;h<m.length;h++){if(n!==m[h].getElevation()){n=null;break}}this.setElevation(n);var k=d.isVisibleIn3D();for(var h=1;h<m.length;h++){if(!(k===m[h].isVisibleIn3D())){k=null;break}}this.elevationEnabled=k}};a.prototype.setThickness=function(c){if(c!==this.thickness){var b=this.thickness;this.thickness=c;this.propertyChangeSupport.firePropertyChange("THICKNESS",b,c)}};a.prototype.getThickness=function(){return this.thickness};a.prototype.setCapStyle=function(c){if(c!==this.capStyle){var b=this.capStyle;this.capStyle=c;this.propertyChangeSupport.firePropertyChange("CAP_STYLE",b,c)}};a.prototype.getCapStyle=function(){return this.capStyle};a.prototype.isCapStyleEditable=function(){return this.capStyleEditable};a.prototype.setJoinStyle=function(c){if(c!==this.joinStyle){var b=this.joinStyle;this.joinStyle=c;this.propertyChangeSupport.firePropertyChange("JOIN_STYLE",b,c)}};a.prototype.getJoinStyle=function(){return this.joinStyle};a.prototype.isJoinStyleEditable=function(){return this.joinStyleEditable};a.prototype.setDashStyle=function(c){if(c!==this.dashStyle){var b=this.dashStyle;this.dashStyle=c;this.propertyChangeSupport.firePropertyChange("DASH_STYLE",b,c)}};a.prototype.getDashStyle=function(){return this.dashStyle};a.prototype.setDashPattern=function(b){if(!(function(e,d){if(e==null&&d==null){return true}if(e==null||d==null){return false}if(e.length!=d.length){return false}for(var f=0;f<e.length;f++){if(e[f]!=d[f]){return false}}return true})(b,this.dashPattern)){var c=this.dashPattern;this.dashPattern=b;this.propertyChangeSupport.firePropertyChange("DASH_PATTERN",c,b)}};a.prototype.getDashPattern=function(){return this.dashPattern};a.prototype.setDashOffset=function(c){if(c!==this.dashOffset){var b=this.dashOffset;this.dashOffset=c;this.propertyChangeSupport.firePropertyChange("DASH_OFFSET",b,c)}};a.prototype.getDashOffset=function(){return this.dashOffset};a.prototype.setStartArrowStyle=function(c){if(c!==this.startArrowStyle){var b=this.startArrowStyle;this.startArrowStyle=c;this.propertyChangeSupport.firePropertyChange("START_ARROW_STYLE",b,c)}};a.prototype.getStartArrowStyle=function(){return this.startArrowStyle};a.prototype.setEndArrowStyle=function(b){if(b!==this.endArrowStyle){var c=this.endArrowStyle;this.endArrowStyle=b;this.propertyChangeSupport.firePropertyChange("END_ARROW_STYLE",c,b)}};a.prototype.getEndArrowStyle=function(){return this.endArrowStyle};a.prototype.isArrowsStyleEditable=function(){return this.arrowsStyleEditable};a.prototype.setColor=function(b){if(b!==this.color){var c=this.color;this.color=b;this.propertyChangeSupport.firePropertyChange("COLOR",c,b)}};a.prototype.getColor=function(){return this.color};a.prototype.setElevation=function(c){if(c!==this.elevation){var b=this.elevation;this.elevation=c;this.propertyChangeSupport.firePropertyChange("ELEVATION",b,c)}this.elevationEnabled=c!=null};a.prototype.getElevation=function(){return this.elevation};a.prototype.isElevationEnabled=function(){return this.elevationEnabled};a.prototype.modifyPolylines=function(){var b=this.home.getSelectedItems();var o=Home.getPolylinesSubList(b);if(!(o.length==0)){var n=this.getThickness();var q=this.getCapStyle();var k=this.getJoinStyle();var r=this.getDashStyle();var c=this.getDashPattern();var h=this.getDashOffset();var l=this.getStartArrowStyle();var d=this.getEndArrowStyle();var g=this.getColor();var p=this.getElevation();var m=this.isElevationEnabled();var f=(function(u){var t=[];while(u-->0){t.push(null)}return t})(o.length);for(var j=0;j<f.length;j++){f[j]=new a.ModifiedPolyline(o[j])}a.doModifyPolylines(f,n,q,k,r,c,h,l,d,g,p,m);if(this.undoSupport!=null){var e=new a.PolylinesModificationUndoableEdit(this.home,this.preferences,b.slice(0),f,n,q,k,r,c,h,l,d,g,p,m);this.undoSupport.postEdit(e)}}};a.doModifyPolylines=function(f,n,p,g,q,b,e,h,c,d,o,j){for(var k=0;k<f.length;k++){var m=f[k];var l=m.getPolyline();if(n!=null){l.setThickness(n)}if(p!=null){l.setCapStyle(p)}if(g!=null){l.setJoinStyle(g)}if(q!=null){l.setDashStyle(q)}if(q===Polyline.DashStyle.CUSTOMIZED&&b!=null){l.setDashPattern(b)}if(e!=null){l.setDashOffset(l.getDashStyle()!==Polyline.DashStyle.SOLID?e:0)}if(h!=null){l.setStartArrowStyle(h)}if(c!=null){l.setEndArrowStyle(c)}if(d!=null){l.setColor(d)}if(j!=null){if(false===j){l.setVisibleIn3D(false)}else{if(o!=null){l.setVisibleIn3D(true);l.setElevation(o)}}}}};a.undoModifyPolylines=function(d){for(var b=0;b<d.length;b++){var c=d[b];c.reset()}};return a}());PolylineController.__class="com.eteks.sweethome3d.viewcontroller.PolylineController";PolylineController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(b){var a=(function(e){__extends(d,e);function d(r,o,f,l,s,u,m,v,g,k,n,h,j,t,p){var q=e.call(this,o,b,"undoModifyPolylinesName")||this;if(q.home===undefined){q.home=null}if(q.oldSelection===undefined){q.oldSelection=null}if(q.modifiedPolylines===undefined){q.modifiedPolylines=null}if(q.thickness===undefined){q.thickness=null}if(q.capStyle===undefined){q.capStyle=null}if(q.joinStyle===undefined){q.joinStyle=null}if(q.dashStyle===undefined){q.dashStyle=null}if(q.dashPattern===undefined){q.dashPattern=null}if(q.dashOffset===undefined){q.dashOffset=null}if(q.startArrowStyle===undefined){q.startArrowStyle=null}if(q.endArrowStyle===undefined){q.endArrowStyle=null}if(q.color===undefined){q.color=null}if(q.elevation===undefined){q.elevation=null}if(q.elevationEnabled===undefined){q.elevationEnabled=null}q.home=r;q.oldSelection=f;q.modifiedPolylines=l;q.thickness=s;q.capStyle=u;q.joinStyle=m;q.dashStyle=v;q.dashPattern=g;q.dashOffset=k;q.startArrowStyle=n;q.endArrowStyle=h;q.color=j;q.elevation=t;q.elevationEnabled=p;return q}d.prototype.undo=function(){e.prototype.undo.call(this);b.undoModifyPolylines(this.modifiedPolylines);this.home.setSelectedItems(this.oldSelection.slice(0))};d.prototype.redo=function(){e.prototype.redo.call(this);b.doModifyPolylines(this.modifiedPolylines,this.thickness,this.capStyle,this.joinStyle,this.dashStyle,this.dashPattern,this.dashOffset,this.startArrowStyle,this.endArrowStyle,this.color,this.elevation,this.elevationEnabled);this.home.setSelectedItems(this.oldSelection.slice(0))};return d}(LocalizedUndoableEdit));b.PolylinesModificationUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.PolylineController.PolylinesModificationUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"];var c=(function(){function d(e){if(this.polyline===undefined){this.polyline=null}if(this.thickness===undefined){this.thickness=0}if(this.capStyle===undefined){this.capStyle=null}if(this.joinStyle===undefined){this.joinStyle=null}if(this.dashPattern===undefined){this.dashPattern=null}if(this.dashOffset===undefined){this.dashOffset=null}if(this.startArrowStyle===undefined){this.startArrowStyle=null}if(this.endArrowStyle===undefined){this.endArrowStyle=null}if(this.color===undefined){this.color=0}if(this.visibleIn3D===undefined){this.visibleIn3D=false}if(this.elevation===undefined){this.elevation=0}this.polyline=e;this.thickness=e.getThickness();this.capStyle=e.getCapStyle();this.joinStyle=e.getJoinStyle();this.dashPattern=e.getDashPattern();this.dashOffset=e.getDashOffset();this.startArrowStyle=e.getStartArrowStyle();this.endArrowStyle=e.getEndArrowStyle();this.color=e.getColor();this.visibleIn3D=e.isVisibleIn3D();this.elevation=e.getElevation()}d.prototype.getPolyline=function(){return this.polyline};d.prototype.reset=function(){this.polyline.setThickness(this.thickness);this.polyline.setCapStyle(this.capStyle);this.polyline.setJoinStyle(this.joinStyle);this.polyline.setDashPattern(this.dashPattern);this.polyline.setDashOffset(this.dashOffset);this.polyline.setStartArrowStyle(this.startArrowStyle);this.polyline.setEndArrowStyle(this.endArrowStyle);this.polyline.setColor(this.color);this.polyline.setVisibleIn3D(this.visibleIn3D);this.polyline.setElevation(this.elevation)};return d}());b.ModifiedPolyline=c;c.__class="com.eteks.sweethome3d.viewcontroller.PolylineController.ModifiedPolyline"})(PolylineController||(PolylineController={}));var HomeFurnitureController=(function(){function a(h,d,f,j,c){if(((h!=null&&h instanceof Home)||h===null)&&((d!=null&&d instanceof UserPreferences)||d===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||f===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||j===null)&&((c!=null&&c instanceof javax.swing.undo.UndoableEditSupport)||c===null)){var e=arguments;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureController===undefined){this.textureController=null}if(this.modelMaterialsController===undefined){this.modelMaterialsController=null}if(this.homeFurnitureView===undefined){this.homeFurnitureView=null}if(this.icon===undefined){this.icon=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.priceEditable===undefined){this.priceEditable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentageEditable===undefined){this.valueAddedTaxPercentageEditable=false}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.nameVisible===undefined){this.nameVisible=null}if(this.x===undefined){this.x=null}if(this.y===undefined){this.y=null}if(this.elevation===undefined){this.elevation=null}if(this.angleInDegrees===undefined){this.angleInDegrees=null}if(this.angle===undefined){this.angle=null}if(this.rollAndPitchEditable===undefined){this.rollAndPitchEditable=false}if(this.roll===undefined){this.roll=null}if(this.pitch===undefined){this.pitch=null}if(this.horizontalAxis===undefined){this.horizontalAxis=null}if(this.width===undefined){this.width=null}if(this.proportionalWidth===undefined){this.proportionalWidth=null}if(this.depth===undefined){this.depth=null}if(this.proportionalDepth===undefined){this.proportionalDepth=null}if(this.height===undefined){this.height=null}if(this.proportionalHeight===undefined){this.proportionalHeight=null}if(this.proportional===undefined){this.proportional=false}if(this.modelTransformations===undefined){this.modelTransformations=null}if(this.color===undefined){this.color=null}if(this.paint===undefined){this.paint=null}if(this.shininess===undefined){this.shininess=null}if(this.visible===undefined){this.visible=null}if(this.modelMirrored===undefined){this.modelMirrored=null}if(this.basePlanItem===undefined){this.basePlanItem=null}if(this.basePlanItemEnabled===undefined){this.basePlanItemEnabled=false}if(this.lightPowerEditable===undefined){this.lightPowerEditable=false}if(this.lightPower===undefined){this.lightPower=null}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.widthDepthDeformable===undefined){this.widthDepthDeformable=false}if(this.texturable===undefined){this.texturable=false}if(this.visibleEditable===undefined){this.visibleEditable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.wallThickness===undefined){this.wallThickness=0}if(this.wallDistance===undefined){this.wallDistance=0}if(this.wallWidth===undefined){this.wallWidth=0}if(this.wallLeft===undefined){this.wallLeft=0}if(this.wallHeight===undefined){this.wallHeight=0}if(this.wallTop===undefined){this.wallTop=0}if(this.sashes===undefined){this.sashes=null}this.home=h;this.preferences=d;this.viewFactory=f;this.contentManager=j;this.undoSupport=c;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}else{if(((h!=null&&h instanceof Home)||h===null)&&((d!=null&&d instanceof UserPreferences)||d===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||f===null)&&((j!=null&&j instanceof javax.swing.undo.UndoableEditSupport)||j===null)&&c===undefined){var e=arguments;var b=e[3];var k=arguments;var g=null;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureController===undefined){this.textureController=null}if(this.modelMaterialsController===undefined){this.modelMaterialsController=null}if(this.homeFurnitureView===undefined){this.homeFurnitureView=null}if(this.icon===undefined){this.icon=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.priceEditable===undefined){this.priceEditable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentageEditable===undefined){this.valueAddedTaxPercentageEditable=false}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.nameVisible===undefined){this.nameVisible=null}if(this.x===undefined){this.x=null}if(this.y===undefined){this.y=null}if(this.elevation===undefined){this.elevation=null}if(this.angleInDegrees===undefined){this.angleInDegrees=null}if(this.angle===undefined){this.angle=null}if(this.rollAndPitchEditable===undefined){this.rollAndPitchEditable=false}if(this.roll===undefined){this.roll=null}if(this.pitch===undefined){this.pitch=null}if(this.horizontalAxis===undefined){this.horizontalAxis=null}if(this.width===undefined){this.width=null}if(this.proportionalWidth===undefined){this.proportionalWidth=null}if(this.depth===undefined){this.depth=null}if(this.proportionalDepth===undefined){this.proportionalDepth=null}if(this.height===undefined){this.height=null}if(this.proportionalHeight===undefined){this.proportionalHeight=null}if(this.proportional===undefined){this.proportional=false}if(this.modelTransformations===undefined){this.modelTransformations=null}if(this.color===undefined){this.color=null}if(this.paint===undefined){this.paint=null}if(this.shininess===undefined){this.shininess=null}if(this.visible===undefined){this.visible=null}if(this.modelMirrored===undefined){this.modelMirrored=null}if(this.basePlanItem===undefined){this.basePlanItem=null}if(this.basePlanItemEnabled===undefined){this.basePlanItemEnabled=false}if(this.lightPowerEditable===undefined){this.lightPowerEditable=false}if(this.lightPower===undefined){this.lightPower=null}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.widthDepthDeformable===undefined){this.widthDepthDeformable=false}if(this.texturable===undefined){this.texturable=false}if(this.visibleEditable===undefined){this.visibleEditable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.wallThickness===undefined){this.wallThickness=0}if(this.wallDistance===undefined){this.wallDistance=0}if(this.wallWidth===undefined){this.wallWidth=0}if(this.wallLeft===undefined){this.wallLeft=0}if(this.wallHeight===undefined){this.wallHeight=0}if(this.wallTop===undefined){this.wallTop=0}if(this.sashes===undefined){this.sashes=null}this.home=h;this.preferences=d;this.viewFactory=f;this.contentManager=g;this.undoSupport=b;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties();if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureController===undefined){this.textureController=null}if(this.modelMaterialsController===undefined){this.modelMaterialsController=null}if(this.homeFurnitureView===undefined){this.homeFurnitureView=null}if(this.icon===undefined){this.icon=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.priceEditable===undefined){this.priceEditable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentageEditable===undefined){this.valueAddedTaxPercentageEditable=false}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.nameVisible===undefined){this.nameVisible=null}if(this.x===undefined){this.x=null}if(this.y===undefined){this.y=null}if(this.elevation===undefined){this.elevation=null}if(this.angleInDegrees===undefined){this.angleInDegrees=null}if(this.angle===undefined){this.angle=null}if(this.rollAndPitchEditable===undefined){this.rollAndPitchEditable=false}if(this.roll===undefined){this.roll=null}if(this.pitch===undefined){this.pitch=null}if(this.horizontalAxis===undefined){this.horizontalAxis=null}if(this.width===undefined){this.width=null}if(this.proportionalWidth===undefined){this.proportionalWidth=null}if(this.depth===undefined){this.depth=null}if(this.proportionalDepth===undefined){this.proportionalDepth=null}if(this.height===undefined){this.height=null}if(this.proportionalHeight===undefined){this.proportionalHeight=null}if(this.proportional===undefined){this.proportional=false}if(this.modelTransformations===undefined){this.modelTransformations=null}if(this.color===undefined){this.color=null}if(this.paint===undefined){this.paint=null}if(this.shininess===undefined){this.shininess=null}if(this.visible===undefined){this.visible=null}if(this.modelMirrored===undefined){this.modelMirrored=null}if(this.basePlanItem===undefined){this.basePlanItem=null}if(this.basePlanItemEnabled===undefined){this.basePlanItemEnabled=false}if(this.lightPowerEditable===undefined){this.lightPowerEditable=false}if(this.lightPower===undefined){this.lightPower=null}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.widthDepthDeformable===undefined){this.widthDepthDeformable=false}if(this.texturable===undefined){this.texturable=false}if(this.visibleEditable===undefined){this.visibleEditable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.wallThickness===undefined){this.wallThickness=0}if(this.wallDistance===undefined){this.wallDistance=0}if(this.wallWidth===undefined){this.wallWidth=0}if(this.wallLeft===undefined){this.wallLeft=0}if(this.wallHeight===undefined){this.wallHeight=0}if(this.wallTop===undefined){this.wallTop=0}if(this.sashes===undefined){this.sashes=null}}else{throw new Error("invalid overload")}}}a.prototype.getTextureController=function(){if(this.textureController==null){this.textureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"textureTitle"),this.preferences,this.viewFactory,this.contentManager);this.textureController.addPropertyChangeListener("TEXTURE",new a.HomeFurnitureController$0(this))}return this.textureController};a.prototype.getModelMaterialsController=function(){if(this.modelMaterialsController==null){this.modelMaterialsController=new ModelMaterialsController(this.preferences.getLocalizedString(a,"modelMaterialsTitle"),this.preferences,this.viewFactory,this.contentManager);this.modelMaterialsController.addPropertyChangeListener("MATERIALS",new a.HomeFurnitureController$1(this));var b=new a.HomeFurnitureController$2(this);this.addPropertyChangeListener("WIDTH",b);this.addPropertyChangeListener("DEPTH",b);this.addPropertyChangeListener("HEIGHT",b);this.addPropertyChangeListener("MODEL_TRANSFORMATIONS",new a.HomeFurnitureController$3(this))}return this.modelMaterialsController};a.prototype.getView=function(){if(this.homeFurnitureView==null){this.homeFurnitureView=this.viewFactory.createHomeFurnitureView(this.preferences,this)}return this.homeFurnitureView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var z=Home.getFurnitureSubList(this.home.getSelectedItems());var w=this.getTextureController();var K=this.getModelMaterialsController();if((z.length==0)){this.setIcon(null);this.setName(null);this.setNameVisible(null);this.setDescription(null);this.setPrice(null,false);this.priceEditable=false;this.setValueAddedTaxPercentage(null);this.valueAddedTaxPercentageEditable=false;this.setX(null);this.setY(null);this.setElevation(null);this.basePlanItemEnabled=false;this.setAngleInDegrees(null);this.setRoll(null);this.setPitch(null);this.setHorizontalAxis(null);this.rollAndPitchEditable=false;this.setWidth$java_lang_Float$boolean$boolean$boolean(null,true,false,false);this.setDepth$java_lang_Float$boolean$boolean$boolean(null,true,false,false);this.setHeight$java_lang_Float$boolean$boolean(null,true,false);this.setColor(null);if(w!=null){w.setTexture(null)}if(K!=null){K.setMaterials(null);K.setModel(null);K.setModelCreator(null)}this.setPaint(null);this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(null);this.doorOrWindow=false;this.wallThickness=1;this.wallDistance=0;this.wallWidth=1;this.wallLeft=0;this.wallHeight=1;this.wallTop=0;this.sashes=[];this.setShininess(null);this.visibleEditable=false;this.setVisible(null);this.setModelMirrored(null);this.lightPowerEditable=false;this.setLightPower(null);this.setResizable(true);this.setDeformable(true);this.setTexturable(true);this.setProportional(false)}else{var l=z[0];var u=l.getIcon();if(u!=null){for(var W=1;W<z.length;W++){if(!(function(y,x){if(y&&y.equals){return y.equals(x)}else{return y===x}})(u,z[W].getIcon())){u=null;break}}}this.setIcon(u);var Q=l.getName();if(Q!=null){for(var W=1;W<z.length;W++){if(!(Q===z[W].getName())){Q=null;break}}}this.setName(Q);var Y=l.isNameVisible();for(var W=1;W<z.length;W++){if(Y!==z[W].isNameVisible()){Y=null;break}}this.setNameVisible(Y);var A=l.getDescription();if(A!=null){for(var W=1;W<z.length;W++){if(!(A===z[W].getDescription())){A=null;break}}}this.setDescription(A);var P=this.preferences.getCurrency()!=null;if(P){for(var W=0;W<z.length;W++){if(z[W]!=null&&z[W] instanceof HomeFurnitureGroup){P=false;break}}}this.priceEditable=P;if(P){var N=l.getPrice();if(N!=null){for(var W=1;W<z.length;W++){if(!((z[W].getPrice())!=null?N.eq(z[W].getPrice()):(N===(z[W].getPrice())))){N=null;break}}}this.setPrice(N,false);this.valueAddedTaxPercentageEditable=this.preferences.isValueAddedTaxEnabled();var j=l.getValueAddedTaxPercentage();if(j!=null){for(var W=1;W<z.length;W++){if(!((z[W].getValueAddedTaxPercentage())!=null?j.eq(z[W].getValueAddedTaxPercentage()):(j===(z[W].getValueAddedTaxPercentage())))){j=null;break}}}this.setValueAddedTaxPercentage(j)}else{this.setPrice(null,false);this.setValueAddedTaxPercentage(null);this.valueAddedTaxPercentageEditable=false}var T=l.getX();for(var W=1;W<z.length;W++){if(T!==z[W].getX()){T=null;break}}this.setX(T);var S=l.getY();for(var W=1;W<z.length;W++){if(S!==z[W].getY()){S=null;break}}this.setY(S);var q=l.getElevation();for(var W=1;W<z.length;W++){if(q!==z[W].getElevation()){q=null;break}}this.setElevation(q);var B=!l.isDoorOrWindow();for(var W=1;!B&&W<z.length;W++){if(!z[W].isDoorOrWindow()){B=true}}this.basePlanItemEnabled=B;var aa=!l.isMovable();for(var W=1;W<z.length;W++){if(aa!==!z[W].isMovable()){aa=null;break}}this.setBasePlanItem(aa);var D=l.getAngle();for(var W=1;W<z.length;W++){if(D!==z[W].getAngle()){D=null;break}}this.setAngle(D);var Z=true;for(var W=0;Z&&W<z.length;W++){var F=z[W];Z=F.isHorizontallyRotatable()&&F.getStaircaseCutOutShape()==null}this.rollAndPitchEditable=Z;if(this.rollAndPitchEditable){var L=l.getRoll();for(var W=1;W<z.length;W++){if(L!==z[W].getRoll()){L=null;break}}this.setRoll(L);var O=l.getPitch();for(var W=1;W<z.length;W++){if(O!==z[W].getPitch()){O=null;break}}this.setPitch(O);if(L==null&&O==null||(L!=null&&L!==0&&O!=null&&O!==0)||(L!=null&&L===0&&O!=null&&O===0)){this.setHorizontalAxis(null)}else{if(L==null&&O!=null&&O===0||L!=null&&L!==0){this.setHorizontalAxis(a.FurnitureHorizontalAxis.ROLL)}else{this.setHorizontalAxis(a.FurnitureHorizontalAxis.PITCH)}}}else{this.setRoll(null);this.setPitch(null);this.setHorizontalAxis(null)}var b=l.getWidth();for(var W=1;W<z.length;W++){if(b!==z[W].getWidth()){b=null;break}}this.setWidth$java_lang_Float$boolean$boolean$boolean(b,true,false,false);var r=l.getDepth();for(var W=1;W<z.length;W++){if(r!==z[W].getDepth()){r=null;break}}this.setDepth$java_lang_Float$boolean$boolean$boolean(r,true,false,false);var c=l.getHeight();for(var W=1;W<z.length;W++){if(c!==z[W].getHeight()){c=null;break}}this.setHeight$java_lang_Float$boolean$boolean(c,true,false);var g=this.getFurnitureWithoutGroups(z);var f=g[0];var J=f.getColor();if(J!=null){for(var W=1;W<g.length;W++){if(!(J===g[W].getColor())){J=null;break}}}this.setColor(J);var E=f.getTexture();if(E!=null){for(var W=1;W<g.length;W++){if(!E.equals(g[W].getTexture())){E=null;break}}}if(w!=null){w.setTexture(E)}var U=f.getModelMaterials();var d=f.getModel();var G=f.getCreator();if(d!=null){for(var W=1;W<g.length;W++){var F=g[W];if(!(function(y,x){if(y==null&&x==null){return true}if(y==null||x==null){return false}if(y.length!=x.length){return false}for(var ab=0;ab<y.length;ab++){if(y[ab]!=x[ab]){return false}}return true})(U,F.getModelMaterials())||d!==F.getModel()){U=null;d=null;G=null;break}}}if(K!=null){K.setMaterials(U);K.setModel(d);K.setModelCreator(G);K.setModelSize(f.getWidth(),f.getDepth(),f.getHeight());K.setModelRotation(f.getModelRotation());K.setModelTransformations(f.getModelTransformations());K.setBackFaceShown(f.isBackFaceShown())}var V=true;for(var W=0;W<g.length;W++){var F=g[W];if(F.getColor()!=null||F.getTexture()!=null||F.getModelMaterials()!=null){V=false;break}}if(J!=null){this.setPaint(a.FurniturePaint.COLORED)}else{if(E!=null){this.setPaint(a.FurniturePaint.TEXTURED)}else{if(U!=null){this.setPaint(a.FurniturePaint.MODEL_MATERIALS)}else{if(V){this.setPaint(a.FurniturePaint.DEFAULT)}else{this.setPaint(null)}}}}var t=l.getModelTransformations();if(z.length!==1){t=null}else{if(t==null){t=[]}if(l!=null&&l instanceof HomeDoorOrWindow){var m=l;this.doorOrWindow=true;this.wallThickness=m.getWallThickness();this.wallDistance=m.getWallDistance();this.wallWidth=m.getWallWidth();this.wallLeft=m.getWallLeft();this.wallHeight=m.getWallHeight();this.wallTop=m.getWallTop();this.sashes=m.getSashes()}}this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(t);var v=f.getShininess();var p=v==null?a.FurnitureShininess.DEFAULT:(v===0?a.FurnitureShininess.MATT:a.FurnitureShininess.SHINY);for(var W=1;W<g.length;W++){var F=g[W];if(v!==F.getShininess()||(v!=null&&!(v===F.getShininess()))){p=null;break}}this.setShininess(p);var H=true;var C=this.home.getFurniture();for(var M=0;M<z.length;M++){var F=z[M];if(!(C.indexOf((F))>=0)){H=false;break}}this.visibleEditable=H;if(H){var I=l.isVisible();for(var W=1;W<z.length;W++){if(I!==z[W].isVisible()){I=null;break}}this.setVisible(I)}else{this.setVisible(null)}var n=l.isModelMirrored();for(var W=1;W<z.length;W++){if(n!==z[W].isModelMirrored()){n=null;break}}this.setModelMirrored(n);var X=(l!=null&&l instanceof HomeLight);for(var W=1;X&&W<z.length;W++){X=(z[W]!=null&&z[W] instanceof HomeLight)}this.lightPowerEditable=X;if(X){var e=l.getPower();for(var W=1;W<z.length;W++){if(e!==z[W].getPower()){e=null;break}}this.setLightPower(e)}else{this.setLightPower(null)}var R=l.isResizable();for(var W=1;W<z.length;W++){if(R!==z[W].isResizable()){R=null;break}}this.setResizable(R!=null&&R);var s=true;for(var W=0;s&&W<z.length;W++){var F=z[W];if(F!=null&&F instanceof HomeFurnitureGroup){var k=F.getAllFurniture();for(var M=0;M<k.length;M++){var h=k[M];if(!h.isDeformable()||h.isHorizontallyRotated()||h.getModelTransformations()!=null){s=false;break}}}else{s=F.isDeformable()&&F.getModelTransformations()==null}}this.setDeformable(s);if(!this.isDeformable()){this.setProportional(true)}this.widthDepthDeformable=true;for(var W=0;this.widthDepthDeformable&&W<z.length;W++){var F=z[W];this.widthDepthDeformable=F.isWidthDepthDeformable()}var o=l.isTexturable();for(var W=1;W<z.length;W++){if(o!==z[W].isTexturable()){o=null;break}}this.setTexturable(o==null||o)}};a.prototype.getFurnitureWithoutGroups=function(e){var d=([]);for(var b=0;b<e.length;b++){var c=e[b];if(c!=null&&c instanceof HomeFurnitureGroup){(function(g,f){return g.push.apply(g,f)})(d,this.getFurnitureWithoutGroups(c.getFurniture()))}else{(d.push(c)>0)}}return d};a.prototype.isPropertyEditable=function(b){switch((b)){case"DESCRIPTION":return false;case"PRICE":return this.isPriceEditable();case"VALUE_ADDED_TAX_PERCENTAGE":return this.isValueAddedTaxPercentageEditable();case"ROLL":case"PITCH":return this.isRollAndPitchEditable();case"MODEL_TRANSFORMATIONS":return this.getModelTransformations()!=null;case"LIGHT_POWER":return this.isLightPowerEditable();case"VISIBLE":return this.visibleEditable;default:return true}};a.prototype.setIcon=function(b){if(b!==this.icon){var c=this.icon;this.icon=b;this.propertyChangeSupport.firePropertyChange("ICON",c,b)}};a.prototype.getIcon=function(){return this.icon};a.prototype.setName=function(b){if(b!==this.name){var c=this.name;this.name=b;this.propertyChangeSupport.firePropertyChange("NAME",c,b)}};a.prototype.getName=function(){return this.name};a.prototype.setNameVisible=function(b){if(b!==this.nameVisible){var c=this.nameVisible;this.nameVisible=b;this.propertyChangeSupport.firePropertyChange("NAME_VISIBLE",c,b)}};a.prototype.getNameVisible=function(){return this.nameVisible};a.prototype.setDescription=function(b){if(b!==this.description){var c=this.description;this.description=b;this.propertyChangeSupport.firePropertyChange("DESCRIPTION",c,b)}};a.prototype.getDescription=function(){return this.description};a.prototype.setPrice=function(c,d){if(d===void 0){d=true}if(c!==this.price&&(c==null||!((this.price)!=null?c.eq(this.price):(c===(this.price))))){var b=this.price;this.price=c;this.propertyChangeSupport.firePropertyChange("PRICE",b,c);if(d){if(c!=null&&this.isValueAddedTaxPercentageEditable()&&this.getValueAddedTaxPercentage()==null&&Home.getFurnitureSubList(this.home.getSelectedItems()).length===1){this.setValueAddedTaxPercentage(this.preferences.getDefaultValueAddedTaxPercentage())}}}};a.prototype.getPrice=function(){return this.price};a.prototype.isPriceEditable=function(){return this.priceEditable};a.prototype.setValueAddedTaxPercentage=function(c){if(c!==this.valueAddedTaxPercentage&&(c==null||!((this.valueAddedTaxPercentage)!=null?c.eq(this.valueAddedTaxPercentage):(c===(this.valueAddedTaxPercentage))))){var b=this.valueAddedTaxPercentage;this.valueAddedTaxPercentage=c;this.propertyChangeSupport.firePropertyChange("VALUE_ADDED_TAX_PERCENTAGE",b,c)}};a.prototype.getValueAddedTaxPercentage=function(){return this.valueAddedTaxPercentage};a.prototype.isValueAddedTaxPercentageEditable=function(){return this.valueAddedTaxPercentageEditable};a.prototype.setX=function(b){if(b!==this.x){var c=this.x;this.x=b;this.propertyChangeSupport.firePropertyChange("X",c,b)}};a.prototype.getX=function(){return this.x};a.prototype.setY=function(c){if(c!==this.y){var b=this.y;this.y=c;this.propertyChangeSupport.firePropertyChange("Y",b,c)}};a.prototype.getY=function(){return this.y};a.prototype.setElevation=function(c){if(c!==this.elevation){var b=this.elevation;this.elevation=c;this.propertyChangeSupport.firePropertyChange("ELEVATION",b,c)}};a.prototype.getElevation=function(){return this.elevation};a.prototype.setAngleInDegrees=function(c,b){if(b===void 0){b=true}if(c!==this.angleInDegrees){var d=this.angleInDegrees;this.angleInDegrees=c;this.propertyChangeSupport.firePropertyChange("ANGLE_IN_DEGREES",d,c);if(b){if(this.angleInDegrees==null){this.setAngle(null,false)}else{this.setAngle(new Number((function(e){return e*Math.PI/180})(this.angleInDegrees)).valueOf(),false)}}}};a.prototype.getAngleInDegrees=function(){return this.angleInDegrees};a.prototype.setAngle=function(d,b){if(b===void 0){b=true}if(d!==this.angle){var c=this.angle;this.angle=d;this.propertyChangeSupport.firePropertyChange("ANGLE",c,d);if(b){if(d==null){this.setAngleInDegrees(null,false)}else{this.setAngleInDegrees(((Math.round((function(e){return e*180/Math.PI})(d))+360)|0)%360,false)}}}};a.prototype.getAngle=function(){return this.angle};a.prototype.isRollAndPitchEditable=function(){return this.rollAndPitchEditable};a.prototype.setRoll=function(b){if(b!==this.roll){var c=this.roll;this.roll=b;this.propertyChangeSupport.firePropertyChange("ROLL",c,b)}};a.prototype.getRoll=function(){return this.roll};a.prototype.setPitch=function(c){if(c!==this.pitch){var b=this.pitch;this.pitch=c;this.propertyChangeSupport.firePropertyChange("PITCH",b,c)}};a.prototype.getPitch=function(){return this.pitch};a.prototype.setHorizontalAxis=function(b){if(b!==this.horizontalAxis){var c=this.horizontalAxis;this.horizontalAxis=b;this.propertyChangeSupport.firePropertyChange("HORIZONTAL_AXIS",c,b)}};a.prototype.getHorizontalAxis=function(){return this.horizontalAxis};a.prototype.isBasePlanItemEnabled=function(){return this.basePlanItemEnabled};a.prototype.isBasePlanItemEditable=function(){return this.basePlanItemEnabled};a.prototype.setBasePlanItem=function(b){if(b!==this.basePlanItem){var c=this.basePlanItem;this.basePlanItem=b;this.propertyChangeSupport.firePropertyChange("BASE_PLAN_ITEM",c,b)}};a.prototype.getBasePlanItem=function(){return this.basePlanItem};a.prototype.setWidth$java_lang_Float=function(b){this.setWidth$java_lang_Float$boolean$boolean$boolean(b,false,this.isProportional()||!this.widthDepthDeformable,this.isProportional())};a.prototype.setWidth$java_lang_Float$boolean$boolean$boolean=function(f,h,c,g){var d=f!=null?Math.max(f,0.001):null;if(d===f||d!=null&&(d===f)||!h){this.proportionalWidth=f}if(d==null&&this.width!=null||d!=null&&!(d===this.width)){var b=this.width;this.width=d;this.propertyChangeSupport.firePropertyChange("WIDTH",b,d);if(b!=null&&d!=null){var e=d/b;if(c&&this.proportionalDepth!=null){this.setDepth$java_lang_Float$boolean$boolean$boolean(this.proportionalDepth*e,true,false,false)}if(g&&this.proportionalHeight!=null){this.setHeight$java_lang_Float$boolean$boolean(this.proportionalHeight*e,true,false)}}else{if(c){this.setDepth$java_lang_Float$boolean$boolean$boolean(null,false,false,false)}if(g){this.setHeight$java_lang_Float$boolean$boolean(null,false,false)}}}};a.prototype.setWidth=function(c,e,b,d){if(((typeof c==="number")||c===null)&&((typeof e==="boolean")||e===null)&&((typeof b==="boolean")||b===null)&&((typeof d==="boolean")||d===null)){return this.setWidth$java_lang_Float$boolean$boolean$boolean(c,e,b,d)}else{if(((typeof c==="number")||c===null)&&e===undefined&&b===undefined&&d===undefined){return this.setWidth$java_lang_Float(c)}else{throw new Error("invalid overload")}}};a.prototype.getWidth=function(){return this.width};a.prototype.setDepth$java_lang_Float=function(b){this.setDepth$java_lang_Float$boolean$boolean$boolean(b,false,this.isProportional()||!this.widthDepthDeformable,this.isProportional())};a.prototype.setDepth$java_lang_Float$boolean$boolean$boolean=function(f,e,h,g){var d=f!=null?Math.max(f,0.001):null;if(d===f||d!=null&&(d===f)||!e){this.proportionalDepth=f}if(d==null&&this.depth!=null||d!=null&&!(d===this.depth)){var c=this.depth;this.depth=d;this.propertyChangeSupport.firePropertyChange("DEPTH",c,d);if(c!=null&&d!=null){var b=d/c;if(h&&this.proportionalWidth!=null){this.setWidth$java_lang_Float$boolean$boolean$boolean(this.proportionalWidth*b,true,false,false)}if(g&&this.proportionalHeight!=null){this.setHeight$java_lang_Float$boolean$boolean(this.proportionalHeight*b,true,false)}}else{if(h){this.setWidth$java_lang_Float$boolean$boolean$boolean(null,false,false,false)}if(g){this.setHeight$java_lang_Float$boolean$boolean(null,false,false)}}}};a.prototype.setDepth=function(c,b,e,d){if(((typeof c==="number")||c===null)&&((typeof b==="boolean")||b===null)&&((typeof e==="boolean")||e===null)&&((typeof d==="boolean")||d===null)){return this.setDepth$java_lang_Float$boolean$boolean$boolean(c,b,e,d)}else{if(((typeof c==="number")||c===null)&&b===undefined&&e===undefined&&d===undefined){return this.setDepth$java_lang_Float(c)}else{throw new Error("invalid overload")}}};a.prototype.getDepth=function(){return this.depth};a.prototype.setHeight$java_lang_Float=function(b){this.setHeight$java_lang_Float$boolean$boolean(b,false,this.isProportional())};a.prototype.setHeight$java_lang_Float$boolean$boolean=function(b,c,e){var f=b!=null?Math.max(b,0.001):null;if(f===b||f!=null&&(f===b)||!c){this.proportionalHeight=b}if(f==null&&this.height!=null||f!=null&&!(f===this.height)){var g=this.height;this.height=f;this.propertyChangeSupport.firePropertyChange("HEIGHT",g,f);if(e){if(g!=null&&f!=null){var d=f/g;if(this.proportionalWidth!=null){this.setWidth$java_lang_Float$boolean$boolean$boolean(this.proportionalWidth*d,true,false,false)}if(this.proportionalDepth!=null){this.setDepth$java_lang_Float$boolean$boolean$boolean(this.proportionalDepth*d,true,false,false)}}else{this.setWidth$java_lang_Float$boolean$boolean$boolean(null,false,false,false);this.setDepth$java_lang_Float$boolean$boolean$boolean(null,false,false,false)}}}};a.prototype.setHeight=function(b,c,d){if(((typeof b==="number")||b===null)&&((typeof c==="boolean")||c===null)&&((typeof d==="boolean")||d===null)){return this.setHeight$java_lang_Float$boolean$boolean(b,c,d)}else{if(((typeof b==="number")||b===null)&&c===undefined&&d===undefined){return this.setHeight$java_lang_Float(b)}else{throw new Error("invalid overload")}}};a.prototype.getHeight=function(){return this.height};a.prototype.setProportional=function(b){if(b!==this.proportional){var c=this.proportional;this.proportional=b;this.propertyChangeSupport.firePropertyChange("PROPORTIONAL",c,b)}};a.prototype.isProportional=function(){return this.proportional};a.prototype.setColor=function(b){if(b!==this.color){var c=this.color;this.color=b;this.propertyChangeSupport.firePropertyChange("COLOR",c,b)}};a.prototype.getColor=function(){return this.color};a.prototype.setPaint=function(c){if(c!==this.paint){var b=this.paint;this.paint=c;this.propertyChangeSupport.firePropertyChange("PAINT",b,c)}};a.prototype.getPaint=function(){return this.paint};a.prototype.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A=function(c){if(!(function(e,d){if(e==null&&d==null){return true}if(e==null||d==null){return false}if(e.length!=d.length){return false}for(var f=0;f<e.length;f++){if(e[f]!=d[f]){return false}}return true})(c,this.modelTransformations)){var b=this.modelTransformations;this.modelTransformations=c;this.propertyChangeSupport.firePropertyChange("MODEL_TRANSFORMATIONS",b,c);this.setDeformable(c==null||c.length===0);this.setProportional(c!=null&&c.length>0)}};a.prototype.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A$float$float$float$float$float$float=function(d,o,n,u,s,L,q){if(this.doorOrWindow){var D=this.getX();var w=this.getY();var B=this.getElevation();var m=this.getWidth();var C=this.getDepth();var e=this.getHeight();var G=-this.getAngle();var f=(D*Math.cos(G)-w*Math.sin(G));var I=(o*Math.cos(G)-n*Math.sin(G));var c=this.wallLeft*m;var k=this.wallWidth*m;var v=f-m/2+c;var t=v-I+s/2;var A=(D*Math.sin(G)+w*Math.cos(G));var F=(o*Math.sin(G)+n*Math.cos(G));var K=this.wallDistance*C;var J=this.wallThickness*C;var r=A-C/2+K;var j=r-F+L/2;var g=this.wallTop*e;var H=this.wallHeight*e;var h=g+u+q-(B+e);var p=this.sashes;for(var E=0;E<p.length;E++){var z=p[E];var l=z.getXAxis()*m;l+=t-c;var b=z.getYAxis()*C;b+=j-K;p[E]=new Sash(l/s,b/L,z.getWidth()*m/s,z.getStartAngle(),z.getEndAngle())}this.wallThickness=J/L;this.wallDistance=j/L;this.wallWidth=k/s;this.wallLeft=t/s;this.wallHeight=H/q;this.wallTop=h/q;this.sashes=p}this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(d);this.setX(o);this.setY(n);this.setWidth$java_lang_Float$boolean$boolean$boolean(s,false,false,false);this.setDepth$java_lang_Float$boolean$boolean$boolean(L,false,false,false);this.setHeight$java_lang_Float$boolean$boolean(q,false,false)};a.prototype.setModelTransformations=function(d,c,h,f,e,g,b){if(((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||(d[0]!=null&&d[0] instanceof Transformation)))||d===null)&&((typeof c==="number")||c===null)&&((typeof h==="number")||h===null)&&((typeof f==="number")||f===null)&&((typeof e==="number")||e===null)&&((typeof g==="number")||g===null)&&((typeof b==="number")||b===null)){return this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A$float$float$float$float$float$float(d,c,h,f,e,g,b)}else{if(((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||(d[0]!=null&&d[0] instanceof Transformation)))||d===null)&&c===undefined&&h===undefined&&f===undefined&&e===undefined&&g===undefined&&b===undefined){return this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(d)}else{throw new Error("invalid overload")}}};a.prototype.getModelTransformations=function(){return this.modelTransformations};a.prototype.setShininess=function(c){if(c!==this.shininess){var b=this.shininess;this.shininess=c;this.propertyChangeSupport.firePropertyChange("SHININESS",b,c)}};a.prototype.getShininess=function(){return this.shininess};a.prototype.setVisible=function(c){if(c!==this.visible){var b=this.visible;this.visible=c;this.propertyChangeSupport.firePropertyChange("VISIBLE",b,c)}};a.prototype.getVisible=function(){return this.visible};a.prototype.setModelMirrored=function(c){if(c!==this.modelMirrored){var b=this.modelMirrored;this.modelMirrored=c;this.propertyChangeSupport.firePropertyChange("MODEL_MIRRORED",b,c)}};a.prototype.getModelMirrored=function(){return this.modelMirrored};a.prototype.isLightPowerEditable=function(){return this.lightPowerEditable};a.prototype.getLightPower=function(){return this.lightPower};a.prototype.setLightPower=function(b){if(b!==this.lightPower){var c=this.lightPower;this.lightPower=b;this.propertyChangeSupport.firePropertyChange("LIGHT_POWER",c,b)}};a.prototype.setResizable=function(c){if(c!==this.resizable){var b=this.resizable;this.resizable=c;this.propertyChangeSupport.firePropertyChange("RESIZABLE",b,c)}};a.prototype.isResizable=function(){return this.resizable};a.prototype.setDeformable=function(b){if(b!==this.deformable){var c=this.deformable;this.deformable=b;this.propertyChangeSupport.firePropertyChange("DEFORMABLE",c,b)}};a.prototype.isDeformable=function(){return this.deformable};a.prototype.setTexturable=function(b){if(b!==this.texturable){var c=this.texturable;this.texturable=b;this.propertyChangeSupport.firePropertyChange("TEXTURABLE",c,b)}};a.prototype.isTexturable=function(){return this.texturable};a.prototype.modifyFurniture=function(){var u=this.home.getSelectedItems();var q=Home.getFurnitureSubList(u);if(!(q.length==0)){var G=this.getName();var O=this.getNameVisible();var r=this.getDescription();var D=this.getPrice();var F=q.length===1&&D==null;var g=this.getValueAddedTaxPercentage();var m=q.length===1&&g==null;var L=this.preferences.getCurrency();var J=this.getX();var H=this.getY();var k=this.getElevation();var s=this.getAngle();var C=this.getRoll();var E=this.getPitch();var p=this.getHorizontalAxis();var P=this.getBasePlanItem();var b=this.getWidth();var l=this.getDepth();var d=this.getHeight();var c=this.isProportional()&&(b==null||l==null||d==null);var N=this.getPaint();var A=N===a.FurniturePaint.COLORED?this.getColor():null;var o=this.getTextureController();var v=void 0;if(o!=null&&N===a.FurniturePaint.TEXTURED){v=o.getTexture()}else{v=null}var B=this.getModelMaterialsController();var K=void 0;if(B!=null&&N===a.FurniturePaint.MODEL_MATERIALS){K=B.getMaterials()}else{K=null}var n=this.getModelTransformations();var e=this.getShininess()===a.FurnitureShininess.DEFAULT;var j=this.getShininess()===a.FurnitureShininess.SHINY?new Number(0.5).valueOf():(this.getShininess()===a.FurnitureShininess.MATT?new Number(0).valueOf():null);var z=this.getVisible();var h=this.getModelMirrored();var f=this.getLightPower();var w=(function(y){var x=[];while(y-->0){x.push(null)}return x})(q.length);for(var M=0;M<w.length;M++){var t=q[M];if(t!=null&&t instanceof HomeLight){w[M]=new a.ModifiedLight(t)}else{if(t!=null&&t instanceof HomeDoorOrWindow){w[M]=new a.ModifiedDoorOrWindow(t)}else{if(t!=null&&t instanceof HomeFurnitureGroup){w[M]=new a.ModifiedFurnitureGroup(t)}else{w[M]=new a.ModifiedPieceOfFurniture(t)}}}}a.doModifyFurniture(w,G,O,r,D,F,g,m,L,J,H,k,s,C,E,p,P,b,l,d,c,n,this.wallThickness,this.wallDistance,this.wallWidth,this.wallLeft,this.wallHeight,this.wallTop,this.sashes,N,A,v,K,e,j,z,h,f);if(this.undoSupport!=null){var I=this.home.getSelectedItems();this.undoSupport.postEdit(new a.FurnitureModificationUndoableEdit(this.home,this.preferences,u.slice(0),I.slice(0),w,G,O,r,D,F,g,m,L,J,H,k,s,C,E,p,P,b,l,d,c,n,this.wallThickness,this.wallDistance,this.wallWidth,this.wallLeft,this.wallHeight,this.wallTop,this.sashes,N,A,v,K,e,j,z,h,f))}if(G!=null){this.preferences.addAutoCompletionString("HomePieceOfFurnitureName",G)}if(r!=null){this.preferences.addAutoCompletionString("HomePieceOfFurnitureDescription",r)}if(g!=null){this.preferences.setDefaultValueAddedTaxPercentage(g)}}};a.doModifyFurniture=function(B,s,V,t,H,K,j,I,T,N,M,m,w,F,J,r,X,b,n,e,d,p,W,S,f,O,q,c,R,U,E,A,P,h,l,C,k,g){for(var G=0;G<B.length;G++){var v=B[G];var z=v.getPieceOfFurniture();if(s!=null){z.setName(s)}if(V!=null){z.setNameVisible(V)}if(t!=null){z.setDescription(t)}if(!(z!=null&&z instanceof HomeFurnitureGroup)){if(H!=null||K){if(H!==z.getPrice()&&(H==null||!((z.getPrice())!=null?H.eq(z.getPrice()):(H===(z.getPrice()))))){z.setCurrency(H!=null?T:null)}if(H!=null){try{H=H.round((["JPY","VND"].indexOf(T)>=0?0:2))}catch(Q){}}z.setPrice(H)}if(j!=null||I){z.setValueAddedTaxPercentage(j)}}if(N!=null){z.setX(N)}if(M!=null){z.setY(M)}if(m!=null){z.setElevation(m)}if(w!=null){z.setAngle(w)}if(r!=null){switch((r)){case a.FurnitureHorizontalAxis.ROLL:if(F!=null){z.setRoll(F);z.setPitch(0)}break;case a.FurnitureHorizontalAxis.PITCH:if(J!=null){z.setPitch(J);z.setRoll(0)}break}}if(X!=null&&!z.isDoorOrWindow()){z.setMovable(!X)}if(z.isResizable()){var u=z.getWidth();var D=z.getDepth();var o=!d&&z.isDeformable();if(o){if(b!=null){z.setWidth(b)}else{if(n!=null&&!z.isWidthDepthDeformable()){z.setWidth(z.getWidth()*n/D)}}if(n!=null){z.setDepth(n)}else{if(b!=null&&!z.isWidthDepthDeformable()){z.setDepth(z.getDepth()*b/u)}}if(e!=null){z.setHeight(e)}}else{if(b!=null){z.scale(b/z.getWidth())}else{if(n!=null){z.scale(n/z.getDepth())}else{if(e!=null){z.scale(e/z.getHeight())}}}}if(k!=null){z.setModelMirrored(k)}if((z!=null&&z instanceof HomeDoorOrWindow)&&B.length===1&&!(JSON.stringify(z.getModelTransformations())===JSON.stringify(p!=null&&p.length>0?p:null))){var L=z;L.setWallThickness(W);L.setWallDistance(S);L.setWallWidth(f);L.setWallLeft(O);L.setWallHeight(q);L.setWallTop(c);L.setSashes(R)}}if(z.isTexturable()){if(U!=null){switch((U)){case a.FurniturePaint.DEFAULT:z.setColor(null);z.setTexture(null);z.setModelMaterials(null);break;case a.FurniturePaint.COLORED:z.setColor(E);z.setTexture(null);z.setModelMaterials(null);break;case a.FurniturePaint.TEXTURED:z.setColor(null);z.setTexture(A);z.setModelMaterials(null);break;case a.FurniturePaint.MODEL_MATERIALS:z.setColor(null);z.setTexture(null);z.setModelMaterials(P);break}}if(h){z.setShininess(null)}else{if(l!=null){z.setShininess(l)}}}if(p!=null){z.setModelTransformations(p.length>0?p:null)}if(C!=null){z.setVisible(C)}if(g!=null){z.setPower(g)}}};a.undoModifyFurniture=function(b){for(var d=0;d<b.length;d++){var c=b[d];c.reset()}};return a}());HomeFurnitureController.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController";HomeFurnitureController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(l){var j;(function(o){o[o.DEFAULT=0]="DEFAULT";o[o.COLORED=1]="COLORED";o[o.TEXTURED=2]="TEXTURED";o[o.MODEL_MATERIALS=3]="MODEL_MATERIALS"})(j=l.FurniturePaint||(l.FurniturePaint={}));var n;(function(o){o[o.DEFAULT=0]="DEFAULT";o[o.MATT=1]="MATT";o[o.SHINY=2]="SHINY"})(n=l.FurnitureShininess||(l.FurnitureShininess={}));var k;(function(o){o[o.ROLL=0]="ROLL";o[o.PITCH=1]="PITCH"})(k=l.FurnitureHorizontalAxis||(l.FurnitureHorizontalAxis={}));var g=(function(o){__extends(p,o);function p(F,S,O,Z,P,J,ai,K,U,X,A,V,af,aa,Y,D,L,T,W,I,ak,q,E,t,s,G,aj,ae,u,ab,H,r,ad,ah,R,N,ac,w,C,Q,B,v){var z=o.call(this,S,l,"undoModifyFurnitureName")||this;if(z.home===undefined){z.home=null}if(z.modifiedFurniture===undefined){z.modifiedFurniture=null}if(z.oldSelection===undefined){z.oldSelection=null}if(z.newSelection===undefined){z.newSelection=null}if(z.name===undefined){z.name=null}if(z.nameVisible===undefined){z.nameVisible=null}if(z.description===undefined){z.description=null}if(z.price===undefined){z.price=null}if(z.removePrice===undefined){z.removePrice=false}if(z.currency===undefined){z.currency=null}if(z.valueAddedTaxPercentage===undefined){z.valueAddedTaxPercentage=null}if(z.removeValueAddedTaxPercentage===undefined){z.removeValueAddedTaxPercentage=false}if(z.x===undefined){z.x=null}if(z.y===undefined){z.y=null}if(z.elevation===undefined){z.elevation=null}if(z.angle===undefined){z.angle=null}if(z.roll===undefined){z.roll=null}if(z.pitch===undefined){z.pitch=null}if(z.horizontalAxis===undefined){z.horizontalAxis=null}if(z.basePlanItem===undefined){z.basePlanItem=null}if(z.width===undefined){z.width=null}if(z.depth===undefined){z.depth=null}if(z.height===undefined){z.height=null}if(z.proportional===undefined){z.proportional=false}if(z.modelTransformations===undefined){z.modelTransformations=null}if(z.paint===undefined){z.paint=null}if(z.color===undefined){z.color=null}if(z.texture===undefined){z.texture=null}if(z.modelMaterials===undefined){z.modelMaterials=null}if(z.defaultShininess===undefined){z.defaultShininess=false}if(z.shininess===undefined){z.shininess=null}if(z.visible===undefined){z.visible=null}if(z.modelMirrored===undefined){z.modelMirrored=null}if(z.lightPower===undefined){z.lightPower=null}if(z.wallThickness===undefined){z.wallThickness=0}if(z.wallDistance===undefined){z.wallDistance=0}if(z.wallWidth===undefined){z.wallWidth=0}if(z.wallLeft===undefined){z.wallLeft=0}if(z.wallHeight===undefined){z.wallHeight=0}if(z.wallTop===undefined){z.wallTop=0}if(z.sashes===undefined){z.sashes=null}if(z.widthsInPlan===undefined){z.widthsInPlan=null}if(z.depthsInPlan===undefined){z.depthsInPlan=null}if(z.heightsInPlan===undefined){z.heightsInPlan=null}z.home=F;z.oldSelection=O;z.newSelection=Z;z.modifiedFurniture=P;z.name=J;z.nameVisible=ai;z.description=K;z.price=U;z.removePrice=X;z.valueAddedTaxPercentage=A;z.removeValueAddedTaxPercentage=V;z.currency=af;z.x=aa;z.y=Y;z.elevation=D;z.angle=L;z.roll=T;z.pitch=W;z.horizontalAxis=I;z.basePlanItem=ak;z.width=q;z.depth=E;z.height=t;z.proportional=s;z.modelTransformations=G;z.wallThickness=aj;z.wallDistance=ae;z.wallWidth=u;z.wallLeft=ab;z.wallHeight=H;z.wallTop=r;z.sashes=ad;z.paint=ah;z.color=R;z.texture=N;z.modelMaterials=ac;z.defaultShininess=w;z.shininess=C;z.visible=Q;z.modelMirrored=B;z.lightPower=v;z.widthsInPlan=(function(y){var x=[];while(y-->0){x.push(0)}return x})(P.length);z.depthsInPlan=(function(y){var x=[];while(y-->0){x.push(0)}return x})(P.length);z.heightsInPlan=(function(y){var x=[];while(y-->0){x.push(0)}return x})(P.length);for(var ag=0;ag<P.length;ag++){var M=P[ag].getPieceOfFurniture();z.widthsInPlan[ag]=M.getWidthInPlan();z.depthsInPlan[ag]=M.getDepthInPlan();z.heightsInPlan[ag]=M.getHeightInPlan()}return z}p.prototype.undo=function(){o.prototype.undo.call(this);l.undoModifyFurniture(this.modifiedFurniture);this.home.setSelectedItems(this.oldSelection.slice(0))};p.prototype.redo=function(){o.prototype.redo.call(this);l.doModifyFurniture(this.modifiedFurniture,this.name,this.nameVisible,this.description,this.price,this.removePrice,this.valueAddedTaxPercentage,this.removeValueAddedTaxPercentage,this.currency,this.x,this.y,this.elevation,this.angle,this.roll,this.pitch,this.horizontalAxis,this.basePlanItem,this.width,this.depth,this.height,this.proportional,this.modelTransformations,this.wallThickness,this.wallDistance,this.wallWidth,this.wallLeft,this.wallHeight,this.wallTop,this.sashes,this.paint,this.color,this.texture,this.modelMaterials,this.defaultShininess,this.shininess,this.visible,this.modelMirrored,this.lightPower);for(var q=0;q<this.modifiedFurniture.length;q++){var r=this.modifiedFurniture[q].getPieceOfFurniture();r.setWidthInPlan(this.widthsInPlan[q]);r.setDepthInPlan(this.depthsInPlan[q]);r.setHeightInPlan(this.heightsInPlan[q])}this.home.setSelectedItems(this.newSelection.slice(0))};return p}(LocalizedUndoableEdit));l.FurnitureModificationUndoableEdit=g;g.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.FurnitureModificationUndoableEdit";g.__interfaces=["javax.swing.undo.UndoableEdit"];var f=(function(){function o(p){if(this.piece===undefined){this.piece=null}if(this.name===undefined){this.name=null}if(this.nameVisible===undefined){this.nameVisible=false}if(this.description===undefined){this.description=null}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.elevation===undefined){this.elevation=0}if(this.angle===undefined){this.angle=0}if(this.roll===undefined){this.roll=0}if(this.pitch===undefined){this.pitch=0}if(this.movable===undefined){this.movable=false}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.widthInPlan===undefined){this.widthInPlan=0}if(this.depthInPlan===undefined){this.depthInPlan=0}if(this.heightInPlan===undefined){this.heightInPlan=0}if(this.modelTransformations===undefined){this.modelTransformations=null}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}if(this.modelMaterials===undefined){this.modelMaterials=null}if(this.shininess===undefined){this.shininess=null}if(this.visible===undefined){this.visible=false}if(this.modelMirrored===undefined){this.modelMirrored=false}this.piece=p;this.name=p.getName();this.nameVisible=p.isNameVisible();this.description=p.getDescription();this.price=p.getPrice();this.valueAddedTaxPercentage=p.getValueAddedTaxPercentage();this.currency=p.getCurrency();this.x=p.getX();this.y=p.getY();this.elevation=p.getElevation();this.angle=p.getAngle();this.roll=p.getRoll();this.pitch=p.getPitch();this.movable=p.isMovable();this.width=p.getWidth();this.depth=p.getDepth();this.height=p.getHeight();this.widthInPlan=p.getWidthInPlan();this.depthInPlan=p.getDepthInPlan();this.heightInPlan=p.getHeightInPlan();this.modelTransformations=p.getModelTransformations();this.color=p.getColor();this.texture=p.getTexture();this.modelMaterials=p.getModelMaterials();this.shininess=p.getShininess();this.visible=p.isVisible();this.modelMirrored=p.isModelMirrored()}o.prototype.getPieceOfFurniture=function(){return this.piece};o.prototype.reset=function(){this.piece.setName(this.name);this.piece.setNameVisible(this.nameVisible);this.piece.setDescription(this.description);if(!(this.piece!=null&&this.piece instanceof HomeFurnitureGroup)){this.piece.setPrice(this.price);this.piece.setValueAddedTaxPercentage(this.valueAddedTaxPercentage);this.piece.setCurrency(this.currency)}this.piece.setX(this.x);this.piece.setY(this.y);this.piece.setElevation(this.elevation);this.piece.setAngle(this.angle);if(this.piece.isHorizontallyRotatable()){this.piece.setRoll(this.roll);this.piece.setPitch(this.pitch)}this.piece.setMovable(this.movable);if(this.piece.isResizable()){this.piece.setWidth(this.width);this.piece.setDepth(this.depth);this.piece.setHeight(this.height);this.piece.setModelMirrored(this.modelMirrored)}this.piece.setWidthInPlan(this.widthInPlan);this.piece.setDepthInPlan(this.depthInPlan);this.piece.setHeightInPlan(this.heightInPlan);this.piece.setModelTransformations(this.modelTransformations);if(this.piece.isTexturable()){this.piece.setColor(this.color);this.piece.setTexture(this.texture);this.piece.setModelMaterials(this.modelMaterials);this.piece.setShininess(this.shininess)}this.piece.setVisible(this.visible)};return o}());l.ModifiedPieceOfFurniture=f;f.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedPieceOfFurniture";var h=(function(p){__extends(o,p);function o(q){var r=p.call(this,q)||this;if(r.boundToWall===undefined){r.boundToWall=false}if(r.wallThickness===undefined){r.wallThickness=0}if(r.wallDistance===undefined){r.wallDistance=0}if(r.wallWidth===undefined){r.wallWidth=0}if(r.wallLeft===undefined){r.wallLeft=0}if(r.wallHeight===undefined){r.wallHeight=0}if(r.wallTop===undefined){r.wallTop=0}if(r.sashes===undefined){r.sashes=null}r.boundToWall=q.isBoundToWall();r.wallThickness=q.getWallThickness();r.wallDistance=q.getWallDistance();r.wallWidth=q.getWallWidth();r.wallLeft=q.getWallLeft();r.wallHeight=q.getWallHeight();r.wallTop=q.getWallTop();r.sashes=q.getSashes();return r}o.prototype.reset=function(){p.prototype.reset.call(this);var q=this.getPieceOfFurniture();q.setBoundToWall(this.boundToWall);q.setWallThickness(this.wallThickness);q.setWallDistance(this.wallDistance);q.setWallWidth(this.wallWidth);q.setWallLeft(this.wallLeft);q.setWallHeight(this.wallHeight);q.setWallTop(this.wallTop);q.setSashes(this.sashes)};return o}(l.ModifiedPieceOfFurniture));l.ModifiedDoorOrWindow=h;h.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedDoorOrWindow";var e=(function(p){__extends(o,p);function o(q){var r=p.call(this,q)||this;if(r.power===undefined){r.power=0}r.power=q.getPower();return r}o.prototype.reset=function(){p.prototype.reset.call(this);this.getPieceOfFurniture().setPower(this.power)};return o}(l.ModifiedPieceOfFurniture));l.ModifiedLight=e;e.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedLight";var m=(function(p){__extends(o,p);function o(s){var u=p.call(this,s)||this;if(u.groupFurnitureX===undefined){u.groupFurnitureX=null}if(u.groupFurnitureY===undefined){u.groupFurnitureY=null}if(u.groupFurnitureWidth===undefined){u.groupFurnitureWidth=null}if(u.groupFurnitureDepth===undefined){u.groupFurnitureDepth=null}if(u.groupFurnitureColor===undefined){u.groupFurnitureColor=null}if(u.groupFurnitureTexture===undefined){u.groupFurnitureTexture=null}if(u.groupFurnitureModelMaterials===undefined){u.groupFurnitureModelMaterials=null}if(u.groupFurnitureShininess===undefined){u.groupFurnitureShininess=null}var q=u.getGroupFurniture(s);u.groupFurnitureX=(function(w){var v=[];while(w-->0){v.push(0)}return v})(q.length);u.groupFurnitureY=(function(w){var v=[];while(w-->0){v.push(0)}return v})(q.length);u.groupFurnitureWidth=(function(w){var v=[];while(w-->0){v.push(0)}return v})(q.length);u.groupFurnitureDepth=(function(w){var v=[];while(w-->0){v.push(0)}return v})(q.length);u.groupFurnitureColor=(function(w){var v=[];while(w-->0){v.push(null)}return v})(q.length);u.groupFurnitureTexture=(function(w){var v=[];while(w-->0){v.push(null)}return v})(q.length);u.groupFurnitureShininess=(function(w){var v=[];while(w-->0){v.push(null)}return v})(q.length);u.groupFurnitureModelMaterials=(function(w){var v=[];while(w-->0){v.push(null)}return v})(q.length);for(var r=0;r<q.length;r++){var t=q[r];u.groupFurnitureX[r]=t.getX();u.groupFurnitureY[r]=t.getY();u.groupFurnitureWidth[r]=t.getWidth();u.groupFurnitureDepth[r]=t.getDepth();u.groupFurnitureColor[r]=t.getColor();u.groupFurnitureTexture[r]=t.getTexture();u.groupFurnitureShininess[r]=t.getShininess();u.groupFurnitureModelMaterials[r]=t.getModelMaterials()}return u}o.prototype.reset=function(){p.prototype.reset.call(this);var s=this.getPieceOfFurniture();var q=this.getGroupFurniture(s);for(var r=0;r<q.length;r++){var t=q[r];if(s.isResizable()){t.setX(this.groupFurnitureX[r]);t.setY(this.groupFurnitureY[r]);t.setWidth(this.groupFurnitureWidth[r]);t.setDepth(this.groupFurnitureDepth[r])}if(s.isTexturable()&&!(t!=null&&t instanceof HomeFurnitureGroup)){t.setColor(this.groupFurnitureColor[r]);t.setTexture(this.groupFurnitureTexture[r]);t.setModelMaterials(this.groupFurnitureModelMaterials[r]);t.setShininess(this.groupFurnitureShininess[r])}}};o.prototype.getGroupFurniture=function(r){var t=([]);var u=r.getFurniture();for(var q=0;q<u.length;q++){var s=u[q];(t.push(s)>0);if(s!=null&&s instanceof HomeFurnitureGroup){(function(w,v){return w.push.apply(w,v)})(t,this.getGroupFurniture(s))}}return t};return o}(l.ModifiedPieceOfFurniture));l.ModifiedFurnitureGroup=m;m.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedFurnitureGroup";var d=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(p){this.__parent.setPaint(l.FurniturePaint.TEXTURED)};return o}());l.HomeFurnitureController$0=d;var c=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(p){this.__parent.setPaint(l.FurniturePaint.MODEL_MATERIALS)};return o}());l.HomeFurnitureController$1=c;var b=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(p){if(this.__parent.getWidth()!=null&&this.__parent.getDepth()!=null&&this.__parent.getHeight()!=null){this.__parent.modelMaterialsController.setModelSize(this.__parent.getWidth(),this.__parent.getDepth(),this.__parent.getHeight())}};return o}());l.HomeFurnitureController$2=b;var a=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(p){if(this.__parent.getModelTransformations()!=null){this.__parent.modelMaterialsController.setModelTransformations(this.__parent.getModelTransformations())}};return o}());l.HomeFurnitureController$3=a})(HomeFurnitureController||(HomeFurnitureController={}));var HomeController=(function(){function a(u,l,p,v,t){if(((u!=null&&u instanceof Home)||u===null)&&((l!=null&&l instanceof HomeApplication)||l===null)&&((p!=null&&p instanceof UserPreferences)||p===null)&&((v!=null&&(v.constructor!=null&&v.constructor.__interfaces!=null&&v.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||v===null)&&((t!=null&&(t.constructor!=null&&t.constructor.__interfaces!=null&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||t===null)){var k=arguments;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}this.home=u;this.preferences=p;this.viewFactory=v;this.contentManager=t;this.application=l;this.undoSupport=new a.HomeController$0(this);this.undoManager=new javax.swing.undo.UndoManager();this.undoSupport.addUndoableEditListener(this.undoManager);if(u.getName()!=null){var q=(this.preferences.getRecentHomes().slice(0));(function(B){var C=B.indexOf(u.getName());if(C>=0){B.splice(C,1);return true}else{return false}})(q);q.splice(0,0,u.getName());this.updateUserPreferencesRecentHomes(q)}}else{if(((u!=null&&u instanceof Home)||u===null)&&((l!=null&&l instanceof HomeApplication)||l===null)&&((p!=null&&(p.constructor!=null&&p.constructor.__interfaces!=null&&p.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||p===null)&&((v!=null&&(v.constructor!=null&&v.constructor.__interfaces!=null&&v.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||v===null)&&t===undefined){var k=arguments;var h=k[2];var o=k[3];var f=arguments;var A=f[1].getUserPreferences();if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}this.home=u;this.preferences=A;this.viewFactory=h;this.contentManager=o;this.application=l;this.undoSupport=new a.HomeController$0(this);this.undoManager=new javax.swing.undo.UndoManager();this.undoSupport.addUndoableEditListener(this.undoManager);if(u.getName()!=null){var q=(this.preferences.getRecentHomes().slice(0));(function(B){var C=B.indexOf(u.getName());if(C>=0){B.splice(C,1);return true}else{return false}})(q);q.splice(0,0,u.getName());this.updateUserPreferencesRecentHomes(q)}if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}}else{if(((u!=null&&u instanceof Home)||u===null)&&((l!=null&&l instanceof UserPreferences)||l===null)&&((p!=null&&(p.constructor!=null&&p.constructor.__interfaces!=null&&p.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||p===null)&&((v!=null&&(v.constructor!=null&&v.constructor.__interfaces!=null&&v.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||v===null)&&t===undefined){var k=arguments;var z=k[1];var g=k[2];var n=k[3];var d=arguments;var y=null;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}this.home=u;this.preferences=z;this.viewFactory=g;this.contentManager=n;this.application=y;this.undoSupport=new a.HomeController$0(this);this.undoManager=new javax.swing.undo.UndoManager();this.undoSupport.addUndoableEditListener(this.undoManager);if(u.getName()!=null){var q=(this.preferences.getRecentHomes().slice(0));(function(B){var C=B.indexOf(u.getName());if(C>=0){B.splice(C,1);return true}else{return false}})(q);q.splice(0,0,u.getName());this.updateUserPreferencesRecentHomes(q)}if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}}else{if(((u!=null&&u instanceof Home)||u===null)&&((l!=null&&l instanceof HomeApplication)||l===null)&&((p!=null&&(p.constructor!=null&&p.constructor.__interfaces!=null&&p.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||p===null)&&v===undefined&&t===undefined){var k=arguments;var e=k[2];var s=arguments;var x=s[1].getUserPreferences();var m=null;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}this.home=u;this.preferences=x;this.viewFactory=e;this.contentManager=m;this.application=l;this.undoSupport=new a.HomeController$0(this);this.undoManager=new javax.swing.undo.UndoManager();this.undoSupport.addUndoableEditListener(this.undoManager);if(u.getName()!=null){var q=(this.preferences.getRecentHomes().slice(0));(function(B){var C=B.indexOf(u.getName());if(C>=0){B.splice(C,1);return true}else{return false}})(q);q.splice(0,0,u.getName());this.updateUserPreferencesRecentHomes(q)}if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}}else{if(((u!=null&&u instanceof Home)||u===null)&&((l!=null&&l instanceof UserPreferences)||l===null)&&((p!=null&&(p.constructor!=null&&p.constructor.__interfaces!=null&&p.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||p===null)&&v===undefined&&t===undefined){var k=arguments;var j=k[1];var c=k[2];var r=arguments;var w=null;var b=null;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}this.home=u;this.preferences=j;this.viewFactory=c;this.contentManager=b;this.application=w;this.undoSupport=new a.HomeController$0(this);this.undoManager=new javax.swing.undo.UndoManager();this.undoSupport.addUndoableEditListener(this.undoManager);if(u.getName()!=null){var q=(this.preferences.getRecentHomes().slice(0));(function(B){var C=B.indexOf(u.getName());if(C>=0){B.splice(C,1);return true}else{return false}})(q);q.splice(0,0,u.getName());this.updateUserPreferencesRecentHomes(q)}if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}}else{throw new Error("invalid overload")}}}}}}a.prototype.enableDefaultActions=function(c){var e=this.application!=null;c.setEnabled(HomeView.ActionType.NEW_HOME,e);c.setEnabled(HomeView.ActionType.NEW_HOME_FROM_EXAMPLE,e);c.setEnabled(HomeView.ActionType.OPEN,e);c.setEnabled(HomeView.ActionType.DELETE_RECENT_HOMES,e&&!(this.preferences.getRecentHomes().length==0));c.setEnabled(HomeView.ActionType.CLOSE,e);c.setEnabled(HomeView.ActionType.SAVE,e);c.setEnabled(HomeView.ActionType.SAVE_AS,e);c.setEnabled(HomeView.ActionType.SAVE_AND_COMPRESS,e);c.setEnabled(HomeView.ActionType.PAGE_SETUP,true);c.setEnabled(HomeView.ActionType.PRINT_PREVIEW,true);c.setEnabled(HomeView.ActionType.PRINT,true);c.setEnabled(HomeView.ActionType.PRINT_TO_PDF,true);c.setEnabled(HomeView.ActionType.PREFERENCES,true);c.setEnabled(HomeView.ActionType.EXIT,e);c.setEnabled(HomeView.ActionType.IMPORT_FURNITURE,true);c.setEnabled(HomeView.ActionType.IMPORT_FURNITURE_LIBRARY,true);c.setEnabled(HomeView.ActionType.IMPORT_TEXTURE,true);c.setEnabled(HomeView.ActionType.IMPORT_TEXTURES_LIBRARY,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_CATALOG_ID,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_NAME,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_CREATOR,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_WIDTH,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_HEIGHT,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_DEPTH,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_X,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_Y,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_ELEVATION,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_ANGLE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_LEVEL,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_MODEL_SIZE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_COLOR,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_TEXTURE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_MOVABILITY,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_TYPE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VISIBILITY,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER,this.home.getFurnitureSortedProperty()!=null);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_CATALOG_ID,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_NAME,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_CREATOR,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_WIDTH,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_DEPTH,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_HEIGHT,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_X,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_Y,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_ELEVATION,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_ANGLE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_LEVEL,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_MODEL_SIZE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_COLOR,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_TEXTURE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_MOVABLE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VISIBLE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED,true);c.setEnabled(HomeView.ActionType.EXPORT_TO_CSV,true);c.setEnabled(HomeView.ActionType.SELECT,true);c.setEnabled(HomeView.ActionType.PAN,true);c.setEnabled(HomeView.ActionType.LOCK_BASE_PLAN,true);c.setEnabled(HomeView.ActionType.UNLOCK_BASE_PLAN,true);c.setEnabled(HomeView.ActionType.ENABLE_MAGNETISM,true);c.setEnabled(HomeView.ActionType.DISABLE_MAGNETISM,true);c.setEnabled(HomeView.ActionType.MODIFY_COMPASS,true);var d=this.home.getSelectedLevel();this.enableBackgroungImageActions(c,d!=null?d.getBackgroundImage():this.home.getBackgroundImage());this.enableLevelActions(c);c.setEnabled(HomeView.ActionType.ZOOM_IN,true);c.setEnabled(HomeView.ActionType.ZOOM_OUT,true);c.setEnabled(HomeView.ActionType.EXPORT_TO_SVG,true);c.setEnabled(HomeView.ActionType.VIEW_FROM_TOP,true);c.setEnabled(HomeView.ActionType.VIEW_FROM_OBSERVER,true);c.setEnabled(HomeView.ActionType.MODIFY_OBSERVER,this.home.getCamera()===this.home.getObserverCamera());c.setEnabled(HomeView.ActionType.STORE_POINT_OF_VIEW,true);var b=(this.home.getStoredCameras().length==0);c.setEnabled(HomeView.ActionType.DELETE_POINTS_OF_VIEW,!b);c.setEnabled(HomeView.ActionType.CREATE_PHOTOS_AT_POINTS_OF_VIEW,!b);c.setEnabled(HomeView.ActionType.DETACH_3D_VIEW,true);c.setEnabled(HomeView.ActionType.ATTACH_3D_VIEW,true);c.setEnabled(HomeView.ActionType.VIEW_FROM_OBSERVER,true);c.setEnabled(HomeView.ActionType.MODIFY_3D_ATTRIBUTES,true);c.setEnabled(HomeView.ActionType.CREATE_PHOTO,true);c.setEnabled(HomeView.ActionType.CREATE_VIDEO,true);c.setEnabled(HomeView.ActionType.EXPORT_TO_OBJ,true);c.setEnabled(HomeView.ActionType.HELP,true);c.setEnabled(HomeView.ActionType.ABOUT,true);this.enableCreationToolsActions(c);c.setTransferEnabled(true)};a.prototype.enableLevelActions=function(b){var f=this.getPlanController().isModificationState();b.setEnabled(HomeView.ActionType.ADD_LEVEL,!f);b.setEnabled(HomeView.ActionType.ADD_LEVEL_AT_SAME_ELEVATION,!f);var e=this.home.getLevels();var d=this.home.getSelectedLevel();var c=e.length>1&&d!=null;b.setEnabled(HomeView.ActionType.SELECT_ALL_AT_ALL_LEVELS,!f&&e.length>1);b.setEnabled(HomeView.ActionType.MAKE_LEVEL_VIEWABLE,!f&&c);b.setEnabled(HomeView.ActionType.MAKE_LEVEL_UNVIEWABLE,!f&&c);b.setEnabled(HomeView.ActionType.MAKE_LEVEL_ONLY_VIEWABLE_ONE,c);b.setEnabled(HomeView.ActionType.MAKE_ALL_LEVELS_VIEWABLE,e.length>1);b.setEnabled(HomeView.ActionType.MODIFY_LEVEL,c);b.setEnabled(HomeView.ActionType.DELETE_LEVEL,!f&&c);b.setEnabled(HomeView.ActionType.DISPLAY_ALL_LEVELS,e.length>1);b.setEnabled(HomeView.ActionType.DISPLAY_SELECTED_LEVEL,e.length>1)};a.prototype.enableCreationToolsActions=function(b){var d=this.home.getSelectedLevel();var c=d==null||d.isViewable();b.setEnabled(HomeView.ActionType.CREATE_WALLS,c);b.setEnabled(HomeView.ActionType.CREATE_ROOMS,c);b.setEnabled(HomeView.ActionType.CREATE_POLYLINES,c);b.setEnabled(HomeView.ActionType.CREATE_DIMENSION_LINES,c);b.setEnabled(HomeView.ActionType.CREATE_LABELS,c)};a.prototype.getView=function(){var b=this;if(this.homeView==null){this.homeView=this.viewFactory.createHomeView(this.home,this.preferences,this);this.enableDefaultActions(this.homeView);this.addListeners();if(this.home.getName()!=null&&this.home.getVersion()>Home.CURRENT_VERSION){this.homeView.invokeLater(function(){var c=b.preferences.getLocalizedString(a,"moreRecentVersionHome",b.home.getName());b.getView().showMessage(c)})}}return this.homeView};a.prototype.getContentManager=function(){return this.contentManager};a.prototype.getFurnitureCatalogController=function(){if(this.furnitureCatalogController==null){this.furnitureCatalogController=new FurnitureCatalogController(this.preferences.getFurnitureCatalog(),this.preferences,this.viewFactory,this.contentManager)}return this.furnitureCatalogController};a.prototype.getFurnitureController=function(){if(this.furnitureController==null){this.furnitureController=new FurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport())}return this.furnitureController};a.prototype.getPlanController=function(){if(this.planController==null){this.planController=new PlanController(this.home,this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport())}return this.planController};a.prototype.getHomeController3D=function(){if(this.homeController3D==null){this.homeController3D=new HomeController3D(this.home,this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport())}return this.homeController3D};a.prototype.getUndoableEditSupport=function(){return this.undoSupport};a.prototype.addListeners=function(){this.preferences.getFurnitureCatalog().addFurnitureListener((function(b){if(b==null||typeof b=="function"){return b}return function(c){return(b.collectionChanged?b.collectionChanged:b).call(b,c)}})(new a.FurnitureCatalogChangeListener(this)));this.preferences.getTexturesCatalog().addTexturesListener((function(b){if(b==null||typeof b=="function"){return b}return function(c){return(b.collectionChanged?b.collectionChanged:b).call(b,c)}})(new a.TexturesCatalogChangeListener(this)));this.preferences.addPropertyChangeListener(new a.UserPreferencesPropertiesChangeListener(this));this.addCatalogSelectionListener();this.addHomeBackgroundImageListener();this.addNotUndoableModificationListeners();this.addHomeSelectionListener();this.addFurnitureSortListener();this.addUndoSupportListener();this.addHomeItemsListener();this.addLevelListeners();this.addStoredCamerasListener();this.addPlanControllerListeners();this.addLanguageListener()};a.prototype.addCatalogSelectionListener=function(){this.getFurnitureCatalogController().addSelectionListener(new a.HomeController$1(this))};a.prototype.addLanguageListener=function(){this.preferences.addPropertyChangeListener("LANGUAGE",new a.LanguageChangeListener(this))};a.prototype.addHomeSelectionListener=function(){if(this.home!=null){this.home.addSelectionListener(new a.HomeController$2(this))}};a.prototype.addFurnitureSortListener=function(){if(this.home!=null){this.home.addPropertyChangeListener("FURNITURE_SORTED_PROPERTY",new a.HomeController$3(this))}};a.prototype.addHomeBackgroundImageListener=function(){if(this.home!=null){this.home.addPropertyChangeListener("BACKGROUND_IMAGE",new a.HomeController$4(this))}};a.prototype.enableBackgroungImageActions=function(c,e){var d=this.home.getSelectedLevel();var b=e!=null&&(d==null||d.isViewable());this.getView().setEnabled(HomeView.ActionType.IMPORT_BACKGROUND_IMAGE,!b);this.getView().setEnabled(HomeView.ActionType.MODIFY_BACKGROUND_IMAGE,b);this.getView().setEnabled(HomeView.ActionType.HIDE_BACKGROUND_IMAGE,b&&e.isVisible());this.getView().setEnabled(HomeView.ActionType.SHOW_BACKGROUND_IMAGE,b&&!e.isVisible());this.getView().setEnabled(HomeView.ActionType.DELETE_BACKGROUND_IMAGE,b)};a.prototype.addNotUndoableModificationListeners=function(){if(this.home!=null){var b=new a.HomeController$5(this);this.home.addPropertyChangeListener("STORED_CAMERAS",b);this.home.getEnvironment().addPropertyChangeListener("OBSERVER_CAMERA_ELEVATION_ADJUSTED",b);this.home.getEnvironment().addPropertyChangeListener("VIDEO_WIDTH",b);this.home.getEnvironment().addPropertyChangeListener("VIDEO_ASPECT_RATIO",b);this.home.getEnvironment().addPropertyChangeListener("VIDEO_FRAME_RATE",b);this.home.getEnvironment().addPropertyChangeListener("VIDEO_QUALITY",b);this.home.getEnvironment().addPropertyChangeListener("VIDEO_CAMERA_PATH",b);this.home.getEnvironment().addPropertyChangeListener("CEILING_LIGHT_COLOR",b);this.home.getEnvironment().addPropertyChangeListener("PHOTO_QUALITY",b);this.home.getEnvironment().addPropertyChangeListener("PHOTO_ASPECT_RATIO",b);var d=new a.HomeController$6(this,b);this.home.getEnvironment().addPropertyChangeListener("PHOTO_WIDTH",d);this.home.getEnvironment().addPropertyChangeListener("PHOTO_HEIGHT",d);var c=new a.HomeController$7(this,b);this.home.getObserverCamera().addPropertyChangeListener(c);this.home.getTopCamera().addPropertyChangeListener(c)}};a.prototype.enableActionsBoundToSelection=function(){var k=this.getPlanController().isModificationState();var b=this.getFurnitureCatalogController().getSelectedFurniture();var E=!(b.length==0);var j=b.length===1&&b[0].isModifiable();var v=this.home.getSelectedItems();var B=false;var g=false;var q=false;var R=false;var p=false;var e=false;var x=false;var c=false;var w=v.length===1&&(v[0]!=null&&v[0] instanceof HomeFurnitureGroup);var F=false;var u=false;var A=false;var C=false;var N=false;var h=false;var y=false;var L=false;var Q=false;var I=false;var J=false;var m=this.getFurnitureController();if(!k){for(var D=0;D<v.length;D++){var z=v[D];if(this.getPlanController().isItemDeletable(z)){B=true;break}}var n=Home.getFurnitureSubList(v);g=!(n.length==0);for(var D=0;D<n.length;D++){var t=n[D];if(m.isPieceOfFurnitureDeletable(t)){q=true;break}}for(var D=0;D<n.length;D++){var t=n[D];if(t!=null&&t instanceof HomeFurnitureGroup){F=true;break}}var M=0;for(var D=0;D<n.length;D++){var t=n[D];if(m.isPieceOfFurnitureMovable(t)){p=true;M++;if(M>=2){e=true}if(M>=3){c=true;break}}}if(e){x=true;var G=this.home.getFurniture();for(var D=0;D<n.length;D++){var t=n[D];if(!m.isPieceOfFurnitureMovable(t)||!(G.indexOf((t))>=0)){x=false;break}}}var o=Home.getWallsSubList(v);u=!(o.length==0);A=o.length===1;if(o.length>=2){var r=[null,null,null];for(var D=0;D<o.length;D++){var l=o[D];if((l.getArcExtent()==null||l.getArcExtent()===0)&&(l.getWallAtStart()==null||l.getWallAtEnd()==null)){for(var O=0;O<r.length;O++){if(r[O]==null){r[O]=l;break}}if(r[2]!=null){break}}}C=r[2]==null&&r[0]!=null&&(r[1]==null&&!(o.indexOf((r[0].getWallAtStart()))>=0)&&!(o.indexOf((r[0].getWallAtEnd()))>=0)||r[0].getWallAtEnd()!==r[1]&&r[0].getWallAtStart()!==r[1])}var H=Home.getRoomsSubList(v);N=!(H.length==0);y=v.length===1&&H.length===1;L=y&&H[0].getPointCount()>=4;var K=!(Home.getDimensionLinesSubList(v).length==0);h=!(Home.getPolylinesSubList(v).length==0);Q=!(Home.getLabelsSubList(v).length==0);J=(v.indexOf((this.home.getCompass()))>=0);R=g||u||N||K||h||Q||J;I=g||N||K||Q}var d=this.getView();if(this.focusedView===this.getFurnitureCatalogController().getView()){d.setEnabled(HomeView.ActionType.COPY,!k&&E);d.setEnabled(HomeView.ActionType.CUT,false);d.setEnabled(HomeView.ActionType.DELETE,false);for(var D=0;D<b.length;D++){var t=b[D];if(t.isModifiable()){d.setEnabled(HomeView.ActionType.DELETE,true);break}}}else{if(this.focusedView===m.getView()){d.setEnabled(HomeView.ActionType.COPY,g);d.setEnabled(HomeView.ActionType.CUT,q);d.setEnabled(HomeView.ActionType.DELETE,q)}else{if(this.focusedView===this.getPlanController().getView()){d.setEnabled(HomeView.ActionType.COPY,R);d.setEnabled(HomeView.ActionType.CUT,B);d.setEnabled(HomeView.ActionType.DELETE,B)}else{d.setEnabled(HomeView.ActionType.COPY,false);d.setEnabled(HomeView.ActionType.CUT,false);d.setEnabled(HomeView.ActionType.DELETE,false)}}}this.enablePasteToGroupAction();this.enablePasteStyleAction();var f=this.home.getSelectedLevel();var s=f==null||f.isViewable();d.setEnabled(HomeView.ActionType.ADD_HOME_FURNITURE,E&&s);d.setEnabled(HomeView.ActionType.ADD_FURNITURE_TO_GROUP,E&&s&&w);d.setEnabled(HomeView.ActionType.DELETE_HOME_FURNITURE,q);d.setEnabled(HomeView.ActionType.DELETE_SELECTION,(E&&this.focusedView===this.getFurnitureCatalogController().getView())||(B&&(this.focusedView===m.getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView())));d.setEnabled(HomeView.ActionType.MODIFY_FURNITURE,(j&&this.focusedView===this.getFurnitureCatalogController().getView())||(g&&(this.focusedView===m.getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView())));d.setEnabled(HomeView.ActionType.MODIFY_WALL,u);d.setEnabled(HomeView.ActionType.FLIP_HORIZONTALLY,R);d.setEnabled(HomeView.ActionType.FLIP_VERTICALLY,R);d.setEnabled(HomeView.ActionType.JOIN_WALLS,C);d.setEnabled(HomeView.ActionType.REVERSE_WALL_DIRECTION,u);d.setEnabled(HomeView.ActionType.SPLIT_WALL,A);d.setEnabled(HomeView.ActionType.MODIFY_ROOM,N);d.setEnabled(HomeView.ActionType.MODIFY_POLYLINE,h);d.setEnabled(HomeView.ActionType.MODIFY_LABEL,Q);d.setEnabled(HomeView.ActionType.TOGGLE_BOLD_STYLE,I);d.setEnabled(HomeView.ActionType.TOGGLE_ITALIC_STYLE,I);d.setEnabled(HomeView.ActionType.INCREASE_TEXT_SIZE,I);d.setEnabled(HomeView.ActionType.DECREASE_TEXT_SIZE,I);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_TOP,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_BOTTOM,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_LEFT,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_RIGHT,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_FRONT_SIDE,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_BACK_SIDE,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_LEFT_SIDE,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_RIGHT_SIDE,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_SIDE_BY_SIDE,e);d.setEnabled(HomeView.ActionType.DISTRIBUTE_FURNITURE_HORIZONTALLY,c);d.setEnabled(HomeView.ActionType.DISTRIBUTE_FURNITURE_VERTICALLY,c);d.setEnabled(HomeView.ActionType.RESET_FURNITURE_ELEVATION,p);d.setEnabled(HomeView.ActionType.GROUP_FURNITURE,x);d.setEnabled(HomeView.ActionType.UNGROUP_FURNITURE,F);var P=this.getPlanController()!=null&&this.getPlanController().getMode()===PlanController.Mode.SELECTION_$LI$();d.setEnabled(HomeView.ActionType.ADD_ROOM_POINT,y&&P);d.setEnabled(HomeView.ActionType.DELETE_ROOM_POINT,L&&P)};a.prototype.enablePasteAction=function(){var b=this.getView();var c=false;if(this.focusedView===this.getFurnitureController().getView()||this.focusedView===this.getPlanController().getView()){var d=this.home.getSelectedLevel();c=(d==null||d.isViewable())&&!this.getPlanController().isModificationState()&&!b.isClipboardEmpty()}b.setEnabled(HomeView.ActionType.PASTE,c);this.enablePasteToGroupAction();this.enablePasteStyleAction()};a.prototype.enablePasteToGroupAction=function(){var b=this.getView();var e=false;if(this.focusedView===this.getFurnitureController().getView()||this.focusedView===this.getPlanController().getView()){var g=this.home.getSelectedLevel();if((g==null||g.isViewable())&&!this.getPlanController().isModificationState()){var h=this.home.getSelectedItems();if(h.length===1&&(h[0]!=null&&h[0] instanceof HomeFurnitureGroup)){var c=b.getClipboardItems();if(c!=null){e=true;for(var d=0;d<c.length;d++){var f=c[d];if(!(f!=null&&f instanceof HomePieceOfFurniture)){e=false;break}}}}}}b.setEnabled(HomeView.ActionType.PASTE_TO_GROUP,e)};a.prototype.enablePasteStyleAction=function(){var b=this.getView();var f=false;if((this.focusedView===this.getFurnitureController().getView()||this.focusedView===this.getPlanController().getView())&&!this.getPlanController().isModificationState()){var c=b.getClipboardItems();if(c!=null&&c.length===1){var g=c[0];var h=this.home.getSelectedItems();for(var d=0;d<h.length;d++){var e=h[d];if((e!=null&&e instanceof HomePieceOfFurniture)&&(g!=null&&g instanceof HomePieceOfFurniture)||(e!=null&&e instanceof Wall)&&(g!=null&&g instanceof Wall)||(e!=null&&e instanceof Room)&&(g!=null&&g instanceof Room)||(e!=null&&e instanceof Polyline)&&(g!=null&&g instanceof Polyline)||(e!=null&&e instanceof Label)&&(g!=null&&g instanceof Label)){f=true;break}}}}b.setEnabled(HomeView.ActionType.PASTE_STYLE,f)};a.prototype.enableSelectAllAction=function(){var b=this.getView();var d=this.getPlanController().isModificationState();if(this.focusedView===this.getFurnitureController().getView()){b.setEnabled(HomeView.ActionType.SELECT_ALL,!d&&this.home.getFurniture().length>0)}else{if(this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()){var c=!this.home.isEmpty()||this.home.getCompass().isVisible();b.setEnabled(HomeView.ActionType.SELECT_ALL,!d&&c)}else{b.setEnabled(HomeView.ActionType.SELECT_ALL,false)}}};a.prototype.enableZoomActions=function(){var c=this.getPlanController();var d=c.getScale();var b=this.getView();b.setEnabled(HomeView.ActionType.ZOOM_IN,d<c.getMaximumScale());b.setEnabled(HomeView.ActionType.ZOOM_OUT,d>c.getMinimumScale())};a.prototype.addUndoSupportListener=function(){this.getUndoableEditSupport().addUndoableEditListener(new a.HomeController$8(this));this.home.addPropertyChangeListener("MODIFIED",new a.HomeController$9(this))};a.prototype.addHomeItemsListener=function(){var c=this;var b=function(d){if(d.getType()===CollectionEvent.Type.ADD||d.getType()===CollectionEvent.Type.DELETE){c.enableSelectAllAction()}};this.home.addFurnitureListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.addWallsListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.addRoomsListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.addPolylinesListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.addDimensionLinesListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.addLabelsListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.getCompass().addPropertyChangeListener(new a.HomeController$10(this));this.home.addPropertyChangeListener("CAMERA",new a.HomeController$11(this))};a.prototype.addLevelListeners=function(){var g=this;var b=new a.HomeController$12(this);this.home.addPropertyChangeListener("SELECTED_LEVEL",b);var c=new a.HomeController$13(this);var f=this.home.getLevels();for(var d=0;d<f.length;d++){var e=f[d];e.addPropertyChangeListener(c)}this.home.addLevelsListener(function(h){switch((h.getType())){case CollectionEvent.Type.ADD:g.home.setSelectedLevel(h.getItem());h.getItem().addPropertyChangeListener(c);break;case CollectionEvent.Type.DELETE:b.propertyChange(null);h.getItem().removePropertyChangeListener(c);break}})};a.prototype.addStoredCamerasListener=function(){this.home.addPropertyChangeListener("STORED_CAMERAS",new a.HomeController$14(this))};a.prototype.addPlanControllerListeners=function(){this.getPlanController().addPropertyChangeListener("MODIFICATION_STATE",new a.HomeController$15(this));this.getPlanController().addPropertyChangeListener("MODE",new a.HomeController$16(this));this.getPlanController().addPropertyChangeListener("SCALE",new a.HomeController$17(this))};a.prototype.addHomeFurniture=function(){this.addFurniture(null)};a.prototype.addFurnitureToGroup=function(){this.addFurniture(this.home.getSelectedItems()[0])};a.prototype.addFurniture=function(f){this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$());var c=this.getFurnitureCatalogController().getSelectedFurniture();if(!(c.length==0)){var b=([]);for(var d=0;d<c.length;d++){var e=c[d];(b.push(this.getFurnitureController().createHomePieceOfFurniture(e))>0)}if(f!=null){this.getFurnitureController().addFurnitureToGroup(b,f)}else{this.getFurnitureController().addFurniture$java_util_List(b)}this.adjustFurnitureSizeAndElevation(b,false)}};a.prototype.modifySelectedFurniture=function(){if(this.focusedView===this.getFurnitureCatalogController().getView()){this.getFurnitureCatalogController().modifySelectedFurniture()}else{if(this.focusedView===this.getFurnitureController().getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()){this.getFurnitureController().modifySelectedFurniture()}}};a.prototype.importLanguageLibrary$=function(){var b=this;this.getView().invokeLater(function(){var c=b.getView().showImportLanguageLibraryDialog();if(c!=null){b.importLanguageLibrary$java_lang_String(c)}})};a.prototype.importLanguageLibrary$java_lang_String=function(c){try{if(!this.preferences.languageLibraryExists(c)||this.getView().confirmReplaceLanguageLibrary(c)){this.preferences.addLanguageLibrary(c)}}catch(b){var d=this.preferences.getLocalizedString(a,"importLanguageLibraryError",c);this.getView().showError(d)}};a.prototype.importLanguageLibrary=function(b){if(((typeof b==="string")||b===null)){return this.importLanguageLibrary$java_lang_String(b)}else{if(b===undefined){return this.importLanguageLibrary$()}else{throw new Error("invalid overload")}}};a.prototype.importFurniture=function(){this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$());if(this.focusedView===this.getFurnitureCatalogController().getView()){this.getFurnitureCatalogController().importFurniture$()}else{this.getFurnitureController().importFurniture$()}};a.prototype.importFurnitureLibrary$=function(){var b=this;this.getView().invokeLater(function(){var c=b.getView().showImportFurnitureLibraryDialog();if(c!=null){b.importFurnitureLibrary$java_lang_String(c)}})};a.prototype.importFurnitureLibrary$java_lang_String=function(c){try{if(!this.preferences.furnitureLibraryExists(c)||this.getView().confirmReplaceFurnitureLibrary(c)){this.preferences.addFurnitureLibrary(c);this.getView().showMessage(this.preferences.getLocalizedString(a,"importedFurnitureLibraryMessage",this.contentManager!=null?this.contentManager.getPresentationName(c,ContentManager.ContentType.FURNITURE_LIBRARY):c))}}catch(b){var d=this.preferences.getLocalizedString(a,"importFurnitureLibraryError",c);this.getView().showError(d)}};a.prototype.importFurnitureLibrary=function(b){if(((typeof b==="string")||b===null)){return this.importFurnitureLibrary$java_lang_String(b)}else{if(b===undefined){return this.importFurnitureLibrary$()}else{throw new Error("invalid overload")}}};a.prototype.importTexture=function(){new ImportedTextureWizardController(this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())};a.prototype.importTexturesLibrary$=function(){var b=this;this.getView().invokeLater(function(){var c=b.getView().showImportTexturesLibraryDialog();if(c!=null){b.importTexturesLibrary$java_lang_String(c)}})};a.prototype.importTexturesLibrary$java_lang_String=function(d){try{if(!this.preferences.texturesLibraryExists(d)||this.getView().confirmReplaceTexturesLibrary(d)){this.preferences.addTexturesLibrary(d);this.getView().showMessage(this.preferences.getLocalizedString(a,"importedTexturesLibraryMessage",this.contentManager!=null?this.contentManager.getPresentationName(d,ContentManager.ContentType.TEXTURES_LIBRARY):d))}}catch(b){var c=this.preferences.getLocalizedString(a,"importTexturesLibraryError",d);this.getView().showError(c)}};a.prototype.importTexturesLibrary=function(b){if(((typeof b==="string")||b===null)){return this.importTexturesLibrary$java_lang_String(b)}else{if(b===undefined){return this.importTexturesLibrary$()}else{throw new Error("invalid overload")}}};a.prototype.undo=function(){this.undoManager.undo();var b=this.getView();var c=this.undoManager.canUndo();b.setEnabled(HomeView.ActionType.UNDO,c);b.setEnabled(HomeView.ActionType.REDO,true);if(c){b.setUndoRedoName(this.undoManager.getUndoPresentationName(),this.undoManager.getRedoPresentationName())}else{b.setUndoRedoName(null,this.undoManager.getRedoPresentationName())}this.saveUndoLevel--;this.home.setModified(this.saveUndoLevel!==0||this.notUndoableModifications)};a.prototype.redo=function(){this.undoManager.redo();var b=this.getView();var c=this.undoManager.canRedo();b.setEnabled(HomeView.ActionType.UNDO,true);b.setEnabled(HomeView.ActionType.REDO,c);if(c){b.setUndoRedoName(this.undoManager.getUndoPresentationName(),this.undoManager.getRedoPresentationName())}else{b.setUndoRedoName(this.undoManager.getUndoPresentationName(),null)}this.saveUndoLevel++;this.home.setModified(this.saveUndoLevel!==0||this.notUndoableModifications)};a.prototype.cut=function(b){var c=this.getUndoableEditSupport();c.beginUpdate();this.getPlanController().deleteItems(b);c.postEdit(new LocalizedUndoableEdit(this.preferences,a,"undoCutName"));c.endUpdate()};a.prototype.paste=function(g){var d=this.home.getSelectedItems();var k=0;if(g.length===d.length){k=20;for(var e=0;e<g.length;e++){var h=g[e];var j=h.getPoints();var b=false;for(var f=0;f<d.length;f++){var c=d[f];if((JSON.stringify(j)===JSON.stringify(c.getPoints()))){b=true;break}}if(!b){k=0;break}}}this.addPastedItems(g,null,k,k,null,"undoPasteName")};a.prototype.drop$java_util_List$float$float=function(d,c,b){this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float(d,null,c,b)};a.prototype.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float=function(d,e,c,b){this.addPastedItems(d,e,c,b,null,"undoDropName")};a.prototype.drop=function(d,e,c,b){if(((d!=null&&(d instanceof Array))||d===null)&&((e!=null&&(e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View")>=0))||e===null)&&((typeof c==="number")||c===null)&&((typeof b==="number")||b===null)){return this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float(d,e,c,b)}else{if(((d!=null&&(d instanceof Array))||d===null)&&((e!=null&&(e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View")>=0))||e===null)&&((c!=null&&(c.constructor!=null&&c.constructor.__interfaces!=null&&c.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Selectable")>=0))||c===null)&&b===undefined){return this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$com_eteks_sweethome3d_model_Selectable(d,e,c)}else{if(((d!=null&&(d instanceof Array))||d===null)&&((typeof e==="number")||e===null)&&((typeof c==="number")||c===null)&&b===undefined){return this.drop$java_util_List$float$float(d,e,c)}else{throw new Error("invalid overload")}}}};a.prototype.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$com_eteks_sweethome3d_model_Selectable=function(b,d,c){this.addPastedItems(b,d,0,0,c,"undoDropName")};a.prototype.addPastedItems=function(g,f,k,j,d,h){if(g.length>1||(g.length===1&&!(g[0]!=null&&g[0] instanceof Compass))){var e=Home.getSubList(g,Compass);if(e.length!==0){g=(g.slice(0));(function(m,p){var l=false;for(var o=0;o<p.length;o++){var n=m.indexOf(p[o]);if(n>=0){m.splice(n,1);l=true}}return l})(g,e)}this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$());var b=this.getUndoableEditSupport();b.beginUpdate();if(f!=null&&f===this.getFurnitureController().getView()){this.getFurnitureController().addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(Home.getFurnitureSubList(g),d)}else{this.getPlanController().addItems(g)}var c=Home.getFurnitureSubList(g);this.adjustFurnitureSizeAndElevation(c,k===0&&j===0&&f==null);this.getPlanController().moveItems(g,k,j);if(f===this.getPlanController().getView()){if(this.preferences.isMagnetismEnabled()&&g.length===1&&c.length===1){this.getPlanController().adjustMagnetizedPieceOfFurniture(g[0],k,j)}}b.postEdit(new LocalizedUndoableEdit(this.preferences,a,h));b.endUpdate()}};a.prototype.adjustFurnitureSizeAndElevation=function(e,b){if(this.preferences.isMagnetismEnabled()){for(var c=0;c<e.length;c++){var d=e[c];if(!(d!=null&&d instanceof HomeFurnitureGroup)&&d.isResizable()){d.setWidth(this.preferences.getLengthUnit().getMagnetizedLength(d.getWidth(),0.1));if(!(d!=null&&d instanceof HomeDoorOrWindow)||!b){d.setDepth(this.preferences.getLengthUnit().getMagnetizedLength(d.getDepth(),0.1))}d.setHeight(this.preferences.getLengthUnit().getMagnetizedLength(d.getHeight(),0.1))}d.setElevation(this.preferences.getLengthUnit().getMagnetizedLength(d.getElevation(),0.1))}}};a.prototype.dropFiles=function(d,c,b){this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$());var g=([]);var j=function(k){(g.push(k.getItem())>0)};this.home.addFurnitureListener(((function(k){if(k==null||typeof k=="function"){return k}return function(l){return(k.collectionChanged?k.collectionChanged:k).call(k,l)}})(j)));var h=this.getUndoableEditSupport();h.beginUpdate();for(var f=0;f<d.length;f++){var e=d[f];this.getFurnitureController().importFurniture$java_lang_String(e)}this.home.removeFurnitureListener(((function(k){if(k==null||typeof k=="function"){return k}return function(l){return(k.collectionChanged?k.collectionChanged:k).call(k,l)}})(j)));if(g.length>0){this.getPlanController().moveItems(g,c,b);this.home.setSelectedItems(g);h.postEdit(new a.DroppingEndUndoableEdit(this.home,this.preferences,g.slice(0)))}h.endUpdate()};a.prototype.pasteToGroup=function(){var c=this.getUndoableEditSupport();c.beginUpdate();var b=Home.getFurnitureSubList(this.getView().getClipboardItems());this.getFurnitureController().addFurnitureToGroup(b,this.home.getSelectedItems()[0]);this.adjustFurnitureSizeAndElevation(b,true);c.postEdit(new LocalizedUndoableEdit(this.preferences,a,"undoPasteToGroupName"));c.endUpdate()};a.prototype.pasteStyle=function(){var d=this.getUndoableEditSupport();d.beginUpdate();var n=this.getView().getClipboardItems()[0];var j=this.home.getSelectedItems();if(n!=null&&n instanceof HomePieceOfFurniture){var b=n;var c=new HomeFurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,d);var r=b.getModelMaterials();if(r!=null){c.getModelMaterialsController().setMaterials(b.getModelMaterials());c.setPaint(HomeFurnitureController.FurniturePaint.MODEL_MATERIALS)}else{if(b.getTexture()!=null){c.getTextureController().setTexture(b.getTexture());c.setPaint(HomeFurnitureController.FurniturePaint.TEXTURED)}else{if(b.getColor()!=null){c.setColor(b.getColor());c.setPaint(HomeFurnitureController.FurniturePaint.COLORED)}else{c.setPaint(HomeFurnitureController.FurniturePaint.DEFAULT)}}}var q=b.getShininess();c.setShininess(q==null?HomeFurnitureController.FurnitureShininess.DEFAULT:(q===0?HomeFurnitureController.FurnitureShininess.MATT:HomeFurnitureController.FurnitureShininess.SHINY));c.modifyFurniture()}else{if(n!=null&&n instanceof Wall){var l=n;var k=new WallController(this.home,this.preferences,this.viewFactory,this.contentManager,d);if(l.getLeftSideColor()!=null){k.setLeftSideColor(l.getLeftSideColor());k.setLeftSidePaint(WallController.WallPaint.COLORED)}else{if(l.getLeftSideTexture()!=null){k.getLeftSideTextureController().setTexture(l.getLeftSideTexture());k.setLeftSidePaint(WallController.WallPaint.TEXTURED)}else{k.setLeftSidePaint(WallController.WallPaint.DEFAULT)}}k.setLeftSideShininess(l.getLeftSideShininess());k.getLeftSideBaseboardController().setBaseboard(l.getLeftSideBaseboard());if(l.getRightSideColor()!=null){k.setRightSideColor(l.getRightSideColor());k.setRightSidePaint(WallController.WallPaint.COLORED)}else{if(l.getRightSideTexture()!=null){k.getRightSideTextureController().setTexture(l.getRightSideTexture());k.setRightSidePaint(WallController.WallPaint.TEXTURED)}else{k.setRightSidePaint(WallController.WallPaint.DEFAULT)}}k.setRightSideShininess(l.getRightSideShininess());k.getRightSideBaseboardController().setBaseboard(l.getRightSideBaseboard());k.setPattern(l.getPattern());k.setTopColor(l.getTopColor());k.setTopPaint(l.getTopColor()!=null?WallController.WallPaint.COLORED:WallController.WallPaint.DEFAULT);k.modifyWalls()}else{if(n!=null&&n instanceof Room){var p=n;var f=new RoomController(this.home,this.preferences,this.viewFactory,this.contentManager,d);if(p.getFloorColor()!=null){f.setFloorColor(p.getFloorColor());f.setFloorPaint(RoomController.RoomPaint.COLORED)}else{if(p.getFloorTexture()!=null){f.getFloorTextureController().setTexture(p.getFloorTexture());f.setFloorPaint(RoomController.RoomPaint.TEXTURED)}else{f.setFloorPaint(RoomController.RoomPaint.DEFAULT)}}f.setFloorShininess(p.getFloorShininess());if(p.getCeilingColor()!=null){f.setCeilingColor(p.getCeilingColor());f.setCeilingPaint(RoomController.RoomPaint.COLORED)}else{if(p.getCeilingTexture()!=null){f.getCeilingTextureController().setTexture(p.getCeilingTexture());f.setCeilingPaint(RoomController.RoomPaint.TEXTURED)}else{f.setCeilingPaint(RoomController.RoomPaint.DEFAULT)}}f.setCeilingShininess(p.getCeilingShininess());f.modifyRooms()}else{if(n!=null&&n instanceof Polyline){var h=n;var g=new PolylineController(this.home,this.preferences,this.viewFactory,this.contentManager,d);g.setThickness(h.getThickness());g.setJoinStyle(h.getJoinStyle());g.setCapStyle(h.getCapStyle());g.setStartArrowStyle(h.getStartArrowStyle());g.setEndArrowStyle(h.getEndArrowStyle());g.setDashStyle(h.getDashStyle());g.setDashPattern(h.getDashPattern());g.setDashOffset(h.getDashOffset());g.setColor(h.getColor());g.modifyPolylines()}else{if(n!=null&&n instanceof Label){var o=n;var e=new LabelController(this.home,this.preferences,this.viewFactory,d);e.setColor(o.getColor());var m=o.getStyle();if(m!=null){e.setAlignment(m.getAlignment());e.setFontName(m.getFontName());e.setFontSize(m.getFontSize())}else{e.setAlignment(null);e.setFontName(null);e.setFontSize(this.preferences.getDefaultTextStyle(Label).getFontSize())}e.modifyLabels()}}}}}d.postEdit(new a.PastingStyleEndUndoableEdit(this.home,this.preferences,j.slice(0)));d.endUpdate()};a.prototype.createTransferData=function(b){var e=[];for(var g=1;g<arguments.length;g++){e[g-1]=arguments[g]}var f=([]);for(var d=0;d<e.length;d++){if(this.childControllers==null){this.childControllers=([]);(this.childControllers.push(this.getFurnitureCatalogController())>0);(this.childControllers.push(this.getFurnitureController())>0);(this.childControllers.push(this.getPlanController())>0);(this.childControllers.push(this.getHomeController3D())>0)}for(var c=0;c<this.childControllers.length;c++){var h=this.childControllers[c];if(h.getView()!=null&&(h.getView().constructor!=null&&h.getView().constructor.__interfaces!=null&&h.getView().constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.TransferableView")>=0)){(f.push(h.getView().createTransferData(e[d]))>0)}}}b.dataReady(f.slice(0))};a.prototype["delete"]=function(){if(this.focusedView===this.getFurnitureCatalogController().getView()){if(this.getView().confirmDeleteCatalogSelection()){this.getFurnitureCatalogController().deleteSelection()}}else{if(this.focusedView===this.getFurnitureController().getView()){this.getFurnitureController().deleteSelection()}else{if(this.focusedView===this.getPlanController().getView()){this.getPlanController().deleteSelection()}}}};a.prototype.focusedViewChanged=function(b){this.focusedView=b;this.enableActionsBoundToSelection();this.enablePasteAction();this.enablePasteToGroupAction();this.enablePasteStyleAction();this.enableSelectAllAction()};a.prototype.selectAll=function(){if(this.focusedView===this.getFurnitureController().getView()){this.getFurnitureController().selectAll()}else{if(this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()){this.getPlanController().selectAll()}}};a.prototype.newHome=function(){var b;if(this.application!=null){b=this.application.createHome()}else{b=new Home(this.preferences.getNewWallHeight())}this.application.addHome(b)};a.prototype.newHomeFromExample=function(){};a.prototype.getCatalogFurnitureNames=function(b){var d=({});var j=b.getCategories();for(var c=0;c<j.length;c++){var f=j[c];var g=f.getFurniture();for(var h=0;h<g.length;h++){var e=g[h];if(e.getId()!=null){(d[e.getId()]=e.getName())}}}return d};a.prototype.renameToCatalogName=function(d,c,h){if(d!=null&&d instanceof HomeFurnitureGroup){d.setName(h);var g=d.getFurniture();for(var b=0;b<g.length;b++){var e=g[b];this.renameToCatalogName(e,c,h)}}else{var f=d.getCatalogId();if(f!=null){d.setName((function(j,l){return j[l]===undefined?null:j[l]})(c,f))}}};a.prototype.open=function(){};a.prototype.addHomeToApplication=function(b){var c=this;this.getView().invokeLater(function(){c.application.addHome(b)})};a.prototype.updateUserPreferencesRecentHomes=function(d){if(this.application!=null){for(var c=d.length-1;c>=0;c--){try{if(!null){d.splice(c,1)[0]}}catch(b){}}this.preferences.setRecentHomes(d)}};a.prototype.getRecentHomes=function(){if(this.application!=null){var e=([]);var f=this.preferences.getRecentHomes();for(var c=0;c<f.length;c++){var b=f[c];try{if(null){(e.push(b)>0);if(e.length===this.preferences.getRecentHomesMaxCount()){break}}}catch(d){}}this.getView().setEnabled(HomeView.ActionType.DELETE_RECENT_HOMES,!(e.length==0));return e.slice(0)}else{return([])}};a.prototype.getVersion=function(){if(this.application!=null){var d=this.application.getVersion();try{var c="JS";if(c!=null){d+=" "+c}}catch(b){}return d}else{return""}};a.prototype.deleteRecentHomes=function(){this.updateUserPreferencesRecentHomes(([]));this.getView().setEnabled(HomeView.ActionType.DELETE_RECENT_HOMES,false)};a.prototype.close=function(){};a.prototype.save=function(){};a.prototype.saveAs=function(){};a.prototype.saveAndCompress=function(){};a.prototype.saveAsAndCompress=function(){};a.prototype.updateSavedHome=function(b,d,c){var e=this;this.getView().invokeLater(function(){e.home.setName(b);e.home.setModified(false);e.home.setRecovered(false);e.home.setRepaired(false);e.home.setVersion(d);var g=(e.preferences.getRecentHomes().slice(0));var f=g.indexOf(b);if(f>=0){g.splice(f,1)[0]}g.splice(0,0,b);e.updateUserPreferencesRecentHomes(g);if(c!=null){(function(h){return(typeof h==="function")?h():h.run()})(c)}})};a.prototype.exportToCSV=function(){};a.prototype.exportToSVG=function(){};a.prototype.exportToOBJ=function(){};a.prototype.createPhotos=function(){};a.prototype.createPhoto=function(){};a.prototype.createVideo=function(){};a.prototype.setupPage=function(){};a.prototype.previewPrint=function(){};a.prototype.print=function(){};a.prototype.printToPDF=function(){};a.prototype.exit=function(){var d=this.application.getHomes();for(var b=0;b<d.length;b++){var c=d[b];if(c.isModified()||c.isRecovered()||c.isRepaired()){if(this.getView().confirmExit()){break}else{return}}}var d=this.application.getHomes();for(var b=0;b<d.length;b++){var c=d[b];c.setRecovered(false);this.application.deleteHome(c)}};a.prototype.editPreferences=function(){new UserPreferencesController(this.preferences,this.viewFactory,this.contentManager,this).displayView(this.getView())};a.prototype.enableMagnetism=function(){this.preferences.setMagnetismEnabled(true)};a.prototype.disableMagnetism=function(){this.preferences.setMagnetismEnabled(false)};a.prototype.setMode=function(c){var d=this;if(this.getPlanController().getMode()!==c){var b;if(c===PlanController.Mode.WALL_CREATION_$LI$()){b=HomeView.ActionType[HomeView.ActionType.CREATE_WALLS]}else{if(c===PlanController.Mode.ROOM_CREATION_$LI$()){b=HomeView.ActionType[HomeView.ActionType.CREATE_ROOMS]}else{if(c===PlanController.Mode.POLYLINE_CREATION_$LI$()){b=HomeView.ActionType[HomeView.ActionType.CREATE_POLYLINES]}else{if(c===PlanController.Mode.DIMENSION_LINE_CREATION_$LI$()){b=HomeView.ActionType[HomeView.ActionType.CREATE_DIMENSION_LINES]}else{if(c===PlanController.Mode.LABEL_CREATION_$LI$()){b=HomeView.ActionType[HomeView.ActionType.CREATE_LABELS]}else{b=null}}}}}if(b!=null&&!this.preferences.isActionTipIgnored(b)){this.getView().invokeLater(function(){if(d.getView().showActionTipMessage(b)){d.preferences.setActionTipIgnored(b)}})}this.getPlanController().setMode(c)}};a.prototype.importBackgroundImage=function(){new BackgroundImageWizardController(this.home,this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport()).displayView(this.getView())};a.prototype.modifyBackgroundImage=function(){this.importBackgroundImage()};a.prototype.hideBackgroundImage=function(){this.toggleBackgroundImageVisibility("undoHideBackgroundImageName")};a.prototype.showBackgroundImage=function(){this.toggleBackgroundImageVisibility("undoShowBackgroundImageName")};a.prototype.toggleBackgroundImageVisibility=function(b){var c=this.home.getSelectedLevel();a.doToggleBackgroundImageVisibility(this.home);this.getUndoableEditSupport().postEdit(new a.BackgroundImageVisibilityTogglingUndoableEdit(this.home,this.preferences,b,c))};a.doToggleBackgroundImageVisibility=function(c){var b=c.getSelectedLevel()!=null?c.getSelectedLevel().getBackgroundImage():c.getBackgroundImage();b=new BackgroundImage(b.getImage(),b.getScaleDistance(),b.getScaleDistanceXStart(),b.getScaleDistanceYStart(),b.getScaleDistanceXEnd(),b.getScaleDistanceYEnd(),b.getXOrigin(),b.getYOrigin(),!b.isVisible());if(c.getSelectedLevel()!=null){c.getSelectedLevel().setBackgroundImage(b)}else{c.setBackgroundImage(b)}};a.prototype.deleteBackgroundImage=function(){var c=this.home.getSelectedLevel();var b;if(c!=null){b=c.getBackgroundImage();c.setBackgroundImage(null)}else{b=this.home.getBackgroundImage();this.home.setBackgroundImage(null)}this.getUndoableEditSupport().postEdit(new a.BackgroundImageDeletionUndoableEdit(this.home,this.preferences,c,b))};a.prototype.zoomOut=function(){var b=this.getPlanController();var c=b.getScale()/1.5;b.setScale(c);b.getView().makeSelectionVisible()};a.prototype.zoomIn=function(){var b=this.getPlanController();var c=b.getScale()*1.5;b.setScale(c);b.getView().makeSelectionVisible()};a.prototype.storeCamera=function(){var c=new Date().toLocaleDateString(this.preferences.getLanguage().replace("_","-"));var b=this.getView().showStoreCameraDialog(c);if(b!=null){this.getHomeController3D().storeCamera(b)}};a.prototype.deleteCameras=function(){var b=this.getView().showDeletedCamerasDialog();if(b!=null){this.getHomeController3D().deleteCameras(b)}};a.prototype.detachView=function(b){if(b!=null){this.getView().detachView(b);this.notUndoableModifications=true;this.home.setModified(true)}};a.prototype.attachView=function(b){if(b!=null){this.getView().attachView(b);this.notUndoableModifications=true;this.home.setModified(true)}};a.prototype.help=function(){};a.prototype.about=function(){this.getView().showAboutDialog()};a.prototype.setVisualProperty=function(c,b){this.home.setVisualProperty(c,b)};a.prototype.setHomeProperty=function(c,b){this.home.setProperty(c,b)};a.helpController=null;return a}());HomeController.__class="com.eteks.sweethome3d.viewcontroller.HomeController";HomeController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(C){var c=(function(){function D(){}D.writingPreferences_$LI$=function(){if(D.writingPreferences==null){D.writingPreferences=([])}return D.writingPreferences};D.prototype.writePreferences=function(E){if(!(D.writingPreferences_$LI$().indexOf((E.preferences))>=0)){(function(F,G){if(F.indexOf(G)==-1){F.push(G);return true}else{return false}})(D.writingPreferences_$LI$(),E.preferences);E.getView().invokeLater(function(){try{E.preferences.write();(function(G){var H=G.indexOf(E.preferences);if(H>=0){G.splice(H,1);return true}else{return false}})(D.writingPreferences_$LI$())}catch(F){E.getView().showError(E.preferences.getLocalizedString(C,"savePreferencesError"))}})}};return D}());C.UserPreferencesChangeListener=c;c.__class="com.eteks.sweethome3d.viewcontroller.HomeController.UserPreferencesChangeListener";var B=(function(){function D(E){if(this.homeController===undefined){this.homeController=null}this.homeController=(E)}D.prototype.propertyChange=function(F){var E=this.homeController;if(E==null){(F.getSource()).removePropertyChangeListener("LANGUAGE",this)}else{E.getView().setUndoRedoName(E.undoManager.canUndo()?E.undoManager.getUndoPresentationName():null,E.undoManager.canRedo()?E.undoManager.getRedoPresentationName():null)}};return D}());C.LanguageChangeListener=B;B.__class="com.eteks.sweethome3d.viewcontroller.HomeController.LanguageChangeListener";var y=(function(D){__extends(E,D);function E(H,F,G){var I=D.call(this,F,C,"undoDropName")||this;if(I.home===undefined){I.home=null}if(I.importedFurniture===undefined){I.importedFurniture=null}I.home=H;I.importedFurniture=G;return I}E.prototype.redo=function(){D.prototype.redo.call(this);this.home.setSelectedItems(this.importedFurniture.slice(0))};return E}(LocalizedUndoableEdit));C.DroppingEndUndoableEdit=y;y.__class="com.eteks.sweethome3d.viewcontroller.HomeController.DroppingEndUndoableEdit";y.__interfaces=["javax.swing.undo.UndoableEdit"];var z=(function(E){__extends(D,E);function D(G,F,I){var H=E.call(this,F,C,"undoPasteStyleName")||this;if(H.home===undefined){H.home=null}if(H.selectedItems===undefined){H.selectedItems=null}H.home=G;H.selectedItems=I;return H}D.prototype.redo=function(){E.prototype.redo.call(this);this.home.setSelectedItems(this.selectedItems.slice(0))};return D}(LocalizedUndoableEdit));C.PastingStyleEndUndoableEdit=z;z.__class="com.eteks.sweethome3d.viewcontroller.HomeController.PastingStyleEndUndoableEdit";z.__interfaces=["javax.swing.undo.UndoableEdit"];var n=(function(E){__extends(D,E);function D(I,F,G,H){var J=E.call(this,F,C,G)||this;if(J.home===undefined){J.home=null}if(J.selectedLevel===undefined){J.selectedLevel=null}J.home=I;J.selectedLevel=H;return J}D.prototype.undo=function(){E.prototype.undo.call(this);this.home.setSelectedLevel(this.selectedLevel);C.doToggleBackgroundImageVisibility(this.home)};D.prototype.redo=function(){E.prototype.redo.call(this);this.home.setSelectedLevel(this.selectedLevel);C.doToggleBackgroundImageVisibility(this.home)};return D}(LocalizedUndoableEdit));C.BackgroundImageVisibilityTogglingUndoableEdit=n;n.__class="com.eteks.sweethome3d.viewcontroller.HomeController.BackgroundImageVisibilityTogglingUndoableEdit";n.__interfaces=["javax.swing.undo.UndoableEdit"];var x=(function(D){__extends(E,D);function E(I,F,H,G){var J=D.call(this,F,C,"undoDeleteBackgroundImageName")||this;if(J.home===undefined){J.home=null}if(J.selectedLevel===undefined){J.selectedLevel=null}if(J.oldImage===undefined){J.oldImage=null}J.home=I;J.oldImage=G;J.selectedLevel=H;return J}E.prototype.undo=function(){D.prototype.undo.call(this);this.home.setSelectedLevel(this.selectedLevel);if(this.selectedLevel!=null){this.selectedLevel.setBackgroundImage(this.oldImage)}else{this.home.setBackgroundImage(this.oldImage)}};E.prototype.redo=function(){D.prototype.redo.call(this);this.home.setSelectedLevel(this.selectedLevel);if(this.selectedLevel!=null){this.selectedLevel.setBackgroundImage(null)}else{this.home.setBackgroundImage(null)}};return E}(LocalizedUndoableEdit));C.BackgroundImageDeletionUndoableEdit=x;x.__class="com.eteks.sweethome3d.viewcontroller.HomeController.BackgroundImageDeletionUndoableEdit";x.__interfaces=["javax.swing.undo.UndoableEdit"];var A=(function(E){__extends(D,E);function D(F){var G=E.call(this)||this;if(G.homeController===undefined){G.homeController=null}G.homeController=(F);return G}D.prototype.collectionChanged=function(G){var F=this.homeController;if(F==null){G.getSource().removeFurnitureListener(((function(H){if(H==null||typeof H=="function"){return H}return function(I){return(H.collectionChanged?H.collectionChanged:H).call(H,I)}})(this)))}else{this.writePreferences(F)}};return D}(C.UserPreferencesChangeListener));C.FurnitureCatalogChangeListener=A;A.__class="com.eteks.sweethome3d.viewcontroller.HomeController.FurnitureCatalogChangeListener";A.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"];var j=(function(E){__extends(D,E);function D(F){var G=E.call(this)||this;if(G.homeController===undefined){G.homeController=null}G.homeController=(F);return G}D.prototype.collectionChanged=function(G){var F=this.homeController;if(F==null){G.getSource().removeTexturesListener(((function(H){if(H==null||typeof H=="function"){return H}return function(I){return(H.collectionChanged?H.collectionChanged:H).call(H,I)}})(this)))}else{this.writePreferences(F)}};return D}(C.UserPreferencesChangeListener));C.TexturesCatalogChangeListener=j;j.__class="com.eteks.sweethome3d.viewcontroller.HomeController.TexturesCatalogChangeListener";j.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"];var w=(function(E){__extends(D,E);function D(F){var G=E.call(this)||this;if(G.homeController===undefined){G.homeController=null}G.homeController=(F);return G}D.prototype.propertyChange=function(G){var F=this.homeController;if(F==null){(G.getSource()).removePropertyChangeListener(G.getPropertyName(),this)}else{this.writePreferences(F)}};return D}(C.UserPreferencesChangeListener));C.UserPreferencesPropertiesChangeListener=w;w.__class="com.eteks.sweethome3d.viewcontroller.HomeController.UserPreferencesPropertiesChangeListener";var m=(function(D){__extends(E,D);function E(F){var G=D.call(this)||this;G.__parent=F;return G}E.prototype._postEdit=function(F){if(!(F!=null&&F instanceof javax.swing.undo.CompoundEdit)||F.isSignificant()){D.prototype._postEdit.call(this,F)}};return E}(javax.swing.undo.UndoableEditSupport));C.HomeController$0=m;var l=(function(){function D(E){this.__parent=E}D.prototype.selectionChanged=function(E){this.__parent.enableActionsBoundToSelection()};return D}());C.HomeController$1=l;l.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var k=(function(){function D(E){this.__parent=E}D.prototype.selectionChanged=function(E){this.__parent.enableActionsBoundToSelection()};return D}());C.HomeController$2=k;k.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var h=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(E){this.__parent.getView().setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER,E.getNewValue()!=null)};return D}());C.HomeController$3=h;var g=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(E){this.__parent.enableBackgroungImageActions(this.__parent.getView(),E.getNewValue())};return D}());C.HomeController$4=g;var f=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(E){this.__parent.notUndoableModifications=true;this.__parent.home.setModified(true)};return D}());C.HomeController$5=f;var e=(function(){function D(F,E){this.notUndoableModificationListener=E;this.__parent=F}D.prototype.propertyChange=function(E){if(this.__parent.home.getEnvironment().getPhotoAspectRatio()!==AspectRatio.VIEW_3D_RATIO){this.notUndoableModificationListener.propertyChange(E)}};return D}());C.HomeController$6=e;var d=(function(){function D(F,E){this.notUndoableModificationListener=E;this.__parent=F}D.prototype.propertyChange=function(E){if((E.getPropertyName()==="TIME")||(E.getPropertyName()==="LENS")){this.notUndoableModificationListener.propertyChange(E)}};return D}());C.HomeController$7=d;var b=(function(){function D(E){this.__parent=E}D.prototype.undoableEditHappened=function(F){var E=this.__parent.getView();E.setEnabled(HomeView.ActionType.UNDO,!this.__parent.getPlanController().isModificationState());E.setEnabled(HomeView.ActionType.REDO,false);E.setUndoRedoName(F.getEdit().getUndoPresentationName(),null);this.__parent.saveUndoLevel++;this.__parent.home.setModified(true)};return D}());C.HomeController$8=b;b.__interfaces=["javax.swing.event.UndoableEditListener"];var a=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(E){if(!this.__parent.home.isModified()){this.__parent.saveUndoLevel=0;this.__parent.notUndoableModifications=false}};return D}());C.HomeController$9=a;var v=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(E){if("VISIBLE"===E.getPropertyName()){this.__parent.enableSelectAllAction()}};return D}());C.HomeController$10=v;var u=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(E){this.__parent.getView().setEnabled(HomeView.ActionType.MODIFY_OBSERVER,this.__parent.home.getCamera()===this.__parent.home.getObserverCamera())};return D}());C.HomeController$11=u;var t=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(I){var J=this.__parent.home.getSelectedLevel();if(!this.__parent.home.isAllLevelsSelection()){var G=([]);var K=this.__parent.home.getSelectedItems();for(var F=0;F<K.length;F++){var H=K[F];if(!(H!=null&&(H.constructor!=null&&H.constructor.__interfaces!=null&&H.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))||H.isAtLevel(J)){(G.push(H)>0)}}this.__parent.home.setSelectedItems(G)}var E=this.__parent.getView();this.__parent.enableCreationToolsActions(E);this.__parent.enableBackgroungImageActions(E,J==null?this.__parent.home.getBackgroundImage():J.getBackgroundImage());this.__parent.enableLevelActions(E)};return D}());C.HomeController$12=t;var s=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(E){if("BACKGROUND_IMAGE"===E.getPropertyName()){this.__parent.enableBackgroungImageActions(this.__parent.getView(),E.getNewValue())}else{if("VIEWABLE"===E.getPropertyName()){this.__parent.enableCreationToolsActions(this.__parent.getView());if(!E.getNewValue()){var F=this.__parent.getPlanController().getMode();if(F!==PlanController.Mode.SELECTION_$LI$()&&F!==PlanController.Mode.PANNING_$LI$()){this.__parent.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$())}}}}};return D}());C.HomeController$13=s;var r=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(F){var E=(this.__parent.home.getStoredCameras().length==0);this.__parent.getView().setEnabled(HomeView.ActionType.DELETE_POINTS_OF_VIEW,!E);this.__parent.getView().setEnabled(HomeView.ActionType.CREATE_PHOTOS_AT_POINTS_OF_VIEW,!E)};return D}());C.HomeController$14=r;var q=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(F){this.__parent.enableActionsBoundToSelection();this.__parent.enableSelectAllAction();var E=this.__parent.getView();this.__parent.enableLevelActions(E);var G=this.__parent.getPlanController().isModificationState();if(G){E.setEnabled(HomeView.ActionType.PASTE,false);E.setEnabled(HomeView.ActionType.UNDO,false);E.setEnabled(HomeView.ActionType.REDO,false)}else{this.__parent.enablePasteAction();E.setEnabled(HomeView.ActionType.UNDO,this.__parent.undoManager.canUndo());E.setEnabled(HomeView.ActionType.REDO,this.__parent.undoManager.canRedo())}E.setEnabled(HomeView.ActionType.LOCK_BASE_PLAN,!G);E.setEnabled(HomeView.ActionType.UNLOCK_BASE_PLAN,!G)};return D}());C.HomeController$15=q;var p=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(E){this.__parent.enableActionsBoundToSelection()};return D}());C.HomeController$16=p;var o=(function(){function D(E){this.__parent=E}D.prototype.propertyChange=function(E){this.__parent.enableZoomActions()};return D}());C.HomeController$17=o})(HomeController||(HomeController={}));var Home3DAttributesController=(function(){function a(f,c,b,e,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.groundTextureController===undefined){this.groundTextureController=null}if(this.skyTextureController===undefined){this.skyTextureController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.home3DAttributesView===undefined){this.home3DAttributesView=null}if(this.groundColor===undefined){this.groundColor=0}if(this.groundPaint===undefined){this.groundPaint=null}if(this.backgroundImageVisibleOnGround3D===undefined){this.backgroundImageVisibleOnGround3D=false}if(this.skyColor===undefined){this.skyColor=0}if(this.skyPaint===undefined){this.skyPaint=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}this.home=f;this.preferences=c;this.viewFactory=b;this.contentManager=e;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getGroundTextureController=function(){if(this.groundTextureController==null){this.groundTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"groundTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.groundTextureController.addPropertyChangeListener("TEXTURE",new a.Home3DAttributesController$0(this))}return this.groundTextureController};a.prototype.getSkyTextureController=function(){if(this.skyTextureController==null){this.skyTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"skyTextureTitle"),false,this.preferences,this.viewFactory,this.contentManager);this.skyTextureController.addPropertyChangeListener("TEXTURE",new a.Home3DAttributesController$1(this))}return this.skyTextureController};a.prototype.getView=function(){if(this.home3DAttributesView==null){this.home3DAttributesView=this.viewFactory.createHome3DAttributesView(this.preferences,this)}return this.home3DAttributesView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var c=this.home.getEnvironment();this.setGroundColor(c.getGroundColor());var d=c.getGroundTexture();this.getGroundTextureController().setTexture(d);if(d!=null){this.setGroundPaint(a.EnvironmentPaint.TEXTURED)}else{this.setGroundPaint(a.EnvironmentPaint.COLORED)}this.setBackgroundImageVisibleOnGround3D(c.isBackgroundImageVisibleOnGround3D());this.setSkyColor(c.getSkyColor());var b=c.getSkyTexture();this.getSkyTextureController().setTexture(b);if(b!=null){this.setSkyPaint(a.EnvironmentPaint.TEXTURED)}else{this.setSkyPaint(a.EnvironmentPaint.COLORED)}this.setLightColor(c.getLightColor());this.setWallsAlpha(c.getWallsAlpha())};a.prototype.setGroundColor=function(b){if(b!==this.groundColor){var c=this.groundColor;this.groundColor=b;this.propertyChangeSupport.firePropertyChange("GROUND_COLOR",c,b);this.setGroundPaint(a.EnvironmentPaint.COLORED)}};a.prototype.getGroundColor=function(){return this.groundColor};a.prototype.setGroundPaint=function(b){if(b!==this.groundPaint){var c=this.groundPaint;this.groundPaint=b;this.propertyChangeSupport.firePropertyChange("GROUND_PAINT",c,b)}};a.prototype.getGroundPaint=function(){return this.groundPaint};a.prototype.isBackgroundImageVisibleOnGround3D=function(){return this.backgroundImageVisibleOnGround3D};a.prototype.setBackgroundImageVisibleOnGround3D=function(b){if(this.backgroundImageVisibleOnGround3D!==b){this.backgroundImageVisibleOnGround3D=b;this.propertyChangeSupport.firePropertyChange("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",!b,b)}};a.prototype.setSkyColor=function(c){if(c!==this.skyColor){var b=this.skyColor;this.skyColor=c;this.propertyChangeSupport.firePropertyChange("SKY_COLOR",b,c)}};a.prototype.getSkyColor=function(){return this.skyColor};a.prototype.setSkyPaint=function(b){if(b!==this.skyPaint){var c=this.skyPaint;this.skyPaint=b;this.propertyChangeSupport.firePropertyChange("SKY_PAINT",c,b)}};a.prototype.getSkyPaint=function(){return this.skyPaint};a.prototype.setLightColor=function(b){if(b!==this.lightColor){var c=this.lightColor;this.lightColor=b;this.propertyChangeSupport.firePropertyChange("LIGHT_COLOR",c,b)}};a.prototype.getLightColor=function(){return this.lightColor};a.prototype.setWallsAlpha=function(c){if(c!==this.wallsAlpha){var b=this.wallsAlpha;this.wallsAlpha=c;this.propertyChangeSupport.firePropertyChange("WALLS_ALPHA",b,c)}};a.prototype.getWallsAlpha=function(){return this.wallsAlpha};a.prototype.modify3DAttributes=function(){var f=this.getGroundColor();var e=this.getGroundPaint()===a.EnvironmentPaint.TEXTURED?this.getGroundTextureController().getTexture():null;var c=this.isBackgroundImageVisibleOnGround3D();var m=this.getSkyColor();var q=this.getSkyPaint()===a.EnvironmentPaint.TEXTURED?this.getSkyTextureController().getTexture():null;var g=this.getLightColor();var j=this.getWallsAlpha();var l=this.home.getEnvironment();var d=l.getGroundColor();var p=l.isBackgroundImageVisibleOnGround3D();var k=l.getGroundTexture();var b=l.getSkyColor();var h=l.getSkyTexture();var o=l.getLightColor();var n=l.getWallsAlpha();a.doModify3DAttributes(this.home,f,e,c,m,q,g,j);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.Home3DAttributesModificationUndoableEdit(this.home,this.preferences,d,k,p,b,h,o,n,f,e,c,m,q,g,j))}};a.doModify3DAttributes=function(h,d,c,b,j,k,e,f){var g=h.getEnvironment();g.setGroundColor(d);g.setGroundTexture(c);g.setBackgroundImageVisibleOnGround3D(b);g.setSkyColor(j);g.setSkyTexture(k);g.setLightColor(e);g.setWallsAlpha(f)};return a}());Home3DAttributesController.__class="com.eteks.sweethome3d.viewcontroller.Home3DAttributesController";Home3DAttributesController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(d){var b;(function(f){f[f.COLORED=0]="COLORED";f[f.TEXTURED=1]="TEXTURED"})(b=d.EnvironmentPaint||(d.EnvironmentPaint={}));var a=(function(g){__extends(f,g);function f(t,o,k,s,y,j,q,w,v,m,l,h,u,x,n,p){var r=g.call(this,o,d,"undoModify3DAttributesName")||this;if(r.home===undefined){r.home=null}if(r.oldGroundColor===undefined){r.oldGroundColor=0}if(r.oldGroundTexture===undefined){r.oldGroundTexture=null}if(r.oldBackgroundImageVisibleOnGround3D===undefined){r.oldBackgroundImageVisibleOnGround3D=false}if(r.oldSkyColor===undefined){r.oldSkyColor=0}if(r.oldSkyTexture===undefined){r.oldSkyTexture=null}if(r.oldLightColor===undefined){r.oldLightColor=0}if(r.oldWallsAlpha===undefined){r.oldWallsAlpha=0}if(r.groundColor===undefined){r.groundColor=0}if(r.groundTexture===undefined){r.groundTexture=null}if(r.backgroundImageVisibleOnGround3D===undefined){r.backgroundImageVisibleOnGround3D=false}if(r.skyColor===undefined){r.skyColor=0}if(r.skyTexture===undefined){r.skyTexture=null}if(r.lightColor===undefined){r.lightColor=0}if(r.wallsAlpha===undefined){r.wallsAlpha=0}r.home=t;r.oldGroundColor=k;r.oldGroundTexture=s;r.oldBackgroundImageVisibleOnGround3D=y;r.oldSkyColor=j;r.oldSkyTexture=q;r.oldLightColor=w;r.oldWallsAlpha=v;r.groundColor=m;r.groundTexture=l;r.backgroundImageVisibleOnGround3D=h;r.skyColor=u;r.skyTexture=x;r.lightColor=n;r.wallsAlpha=p;return r}f.prototype.undo=function(){g.prototype.undo.call(this);d.doModify3DAttributes(this.home,this.oldGroundColor,this.oldGroundTexture,this.oldBackgroundImageVisibleOnGround3D,this.oldSkyColor,this.oldSkyTexture,this.oldLightColor,this.oldWallsAlpha)};f.prototype.redo=function(){g.prototype.redo.call(this);d.doModify3DAttributes(this.home,this.groundColor,this.groundTexture,this.backgroundImageVisibleOnGround3D,this.skyColor,this.skyTexture,this.lightColor,this.wallsAlpha)};return f}(LocalizedUndoableEdit));d.Home3DAttributesModificationUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.Home3DAttributesController.Home3DAttributesModificationUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"];var e=(function(){function f(g){this.__parent=g}f.prototype.propertyChange=function(g){this.__parent.setGroundPaint(d.EnvironmentPaint.TEXTURED)};return f}());d.Home3DAttributesController$0=e;var c=(function(){function f(g){this.__parent=g}f.prototype.propertyChange=function(g){this.__parent.setSkyPaint(d.EnvironmentPaint.TEXTURED)};return f}());d.Home3DAttributesController$1=c})(Home3DAttributesController||(Home3DAttributesController={}));var ImportedFurnitureWizardController=(function(a){__extends(b,a);function b(u,H,k,N,F,j,T,ad){var h=this;if(((u!=null&&u instanceof Home)||u===null)&&((H!=null&&H instanceof CatalogPieceOfFurniture)||H===null)&&((typeof k==="string")||k===null)&&((N!=null&&N instanceof UserPreferences)||N===null)&&((F!=null&&F instanceof FurnitureController)||F===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||j===null)&&((T!=null&&(T.constructor!=null&&T.constructor.__interfaces!=null&&T.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||T===null)&&((ad!=null&&ad instanceof javax.swing.undo.UndoableEditSupport)||ad===null)){var ac=arguments;h=a.call(this,N,j)||this;if(h.home===undefined){h.home=null}if(h.piece===undefined){h.piece=null}if(h.modelName===undefined){h.modelName=null}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(h.furnitureController===undefined){h.furnitureController=null}if(h.contentManager===undefined){h.contentManager=null}if(h.undoSupport===undefined){h.undoSupport=null}if(h.furnitureModelStepState===undefined){h.furnitureModelStepState=null}if(h.furnitureOrientationStepState===undefined){h.furnitureOrientationStepState=null}if(h.furnitureAttributesStepState===undefined){h.furnitureAttributesStepState=null}if(h.furnitureIconStepState===undefined){h.furnitureIconStepState=null}if(h.stepsView===undefined){h.stepsView=null}if(h.step===undefined){h.step=null}if(h.name===undefined){h.name=null}if(h.creator===undefined){h.creator=null}if(h.model===undefined){h.model=null}if(h.width===undefined){h.width=0}if(h.proportionalWidth===undefined){h.proportionalWidth=0}if(h.depth===undefined){h.depth=0}if(h.proportionalDepth===undefined){h.proportionalDepth=0}if(h.height===undefined){h.height=0}if(h.proportionalHeight===undefined){h.proportionalHeight=0}if(h.elevation===undefined){h.elevation=0}if(h.movable===undefined){h.movable=false}if(h.doorOrWindow===undefined){h.doorOrWindow=false}if(h.staircaseCutOutShape===undefined){h.staircaseCutOutShape=null}if(h.color===undefined){h.color=null}if(h.category===undefined){h.category=null}if(h.backFaceShown===undefined){h.backFaceShown=false}if(h.modelSize===undefined){h.modelSize=0}if(h.modelRotation===undefined){h.modelRotation=null}if(h.iconYaw===undefined){h.iconYaw=0}if(h.proportional===undefined){h.proportional=false}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}h.home=u;h.piece=H;h.modelName=k;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=N;h.furnitureController=F;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=j;h.undoSupport=ad;h.contentManager=T;h.setTitle(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,H==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));h.furnitureModelStepState=new b.FurnitureModelStepState(h);h.furnitureOrientationStepState=new b.FurnitureOrientationStepState(h);h.furnitureAttributesStepState=new b.FurnitureAttributesStepState(h);h.furnitureIconStepState=new b.FurnitureIconStepState(h);h.setStepState(h.furnitureModelStepState)}else{if(((u!=null&&u instanceof Home)||u===null)&&((typeof H==="string")||H===null)&&((k!=null&&k instanceof UserPreferences)||k===null)&&((N!=null&&N instanceof FurnitureController)||N===null)&&((F!=null&&(F.constructor!=null&&F.constructor.__interfaces!=null&&F.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||F===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||j===null)&&((T!=null&&T instanceof javax.swing.undo.UndoableEditSupport)||T===null)&&ad===undefined){var ac=arguments;var S=ac[1];var M=ac[2];var Z=ac[3];var y=ac[4];var G=ac[5];var g=ac[6];var s=arguments;var B=null;h=a.call(this,M,y)||this;if(h.home===undefined){h.home=null}if(h.piece===undefined){h.piece=null}if(h.modelName===undefined){h.modelName=null}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(h.furnitureController===undefined){h.furnitureController=null}if(h.contentManager===undefined){h.contentManager=null}if(h.undoSupport===undefined){h.undoSupport=null}if(h.furnitureModelStepState===undefined){h.furnitureModelStepState=null}if(h.furnitureOrientationStepState===undefined){h.furnitureOrientationStepState=null}if(h.furnitureAttributesStepState===undefined){h.furnitureAttributesStepState=null}if(h.furnitureIconStepState===undefined){h.furnitureIconStepState=null}if(h.stepsView===undefined){h.stepsView=null}if(h.step===undefined){h.step=null}if(h.name===undefined){h.name=null}if(h.creator===undefined){h.creator=null}if(h.model===undefined){h.model=null}if(h.width===undefined){h.width=0}if(h.proportionalWidth===undefined){h.proportionalWidth=0}if(h.depth===undefined){h.depth=0}if(h.proportionalDepth===undefined){h.proportionalDepth=0}if(h.height===undefined){h.height=0}if(h.proportionalHeight===undefined){h.proportionalHeight=0}if(h.elevation===undefined){h.elevation=0}if(h.movable===undefined){h.movable=false}if(h.doorOrWindow===undefined){h.doorOrWindow=false}if(h.staircaseCutOutShape===undefined){h.staircaseCutOutShape=null}if(h.color===undefined){h.color=null}if(h.category===undefined){h.category=null}if(h.backFaceShown===undefined){h.backFaceShown=false}if(h.modelSize===undefined){h.modelSize=0}if(h.modelRotation===undefined){h.modelRotation=null}if(h.iconYaw===undefined){h.iconYaw=0}if(h.proportional===undefined){h.proportional=false}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}h.home=u;h.piece=B;h.modelName=S;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=M;h.furnitureController=Z;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=y;h.undoSupport=g;h.contentManager=G;h.setTitle(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,B==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));h.furnitureModelStepState=new b.FurnitureModelStepState(h);h.furnitureOrientationStepState=new b.FurnitureOrientationStepState(h);h.furnitureAttributesStepState=new b.FurnitureAttributesStepState(h);h.furnitureIconStepState=new b.FurnitureIconStepState(h);h.setStepState(h.furnitureModelStepState);if(h.home===undefined){h.home=null}if(h.piece===undefined){h.piece=null}if(h.modelName===undefined){h.modelName=null}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(h.furnitureController===undefined){h.furnitureController=null}if(h.contentManager===undefined){h.contentManager=null}if(h.undoSupport===undefined){h.undoSupport=null}if(h.furnitureModelStepState===undefined){h.furnitureModelStepState=null}if(h.furnitureOrientationStepState===undefined){h.furnitureOrientationStepState=null}if(h.furnitureAttributesStepState===undefined){h.furnitureAttributesStepState=null}if(h.furnitureIconStepState===undefined){h.furnitureIconStepState=null}if(h.stepsView===undefined){h.stepsView=null}if(h.step===undefined){h.step=null}if(h.name===undefined){h.name=null}if(h.creator===undefined){h.creator=null}if(h.model===undefined){h.model=null}if(h.width===undefined){h.width=0}if(h.proportionalWidth===undefined){h.proportionalWidth=0}if(h.depth===undefined){h.depth=0}if(h.proportionalDepth===undefined){h.proportionalDepth=0}if(h.height===undefined){h.height=0}if(h.proportionalHeight===undefined){h.proportionalHeight=0}if(h.elevation===undefined){h.elevation=0}if(h.movable===undefined){h.movable=false}if(h.doorOrWindow===undefined){h.doorOrWindow=false}if(h.staircaseCutOutShape===undefined){h.staircaseCutOutShape=null}if(h.color===undefined){h.color=null}if(h.category===undefined){h.category=null}if(h.backFaceShown===undefined){h.backFaceShown=false}if(h.modelSize===undefined){h.modelSize=0}if(h.modelRotation===undefined){h.modelRotation=null}if(h.iconYaw===undefined){h.iconYaw=0}if(h.proportional===undefined){h.proportional=false}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}}else{if(((u!=null&&u instanceof Home)||u===null)&&((H!=null&&H instanceof UserPreferences)||H===null)&&((k!=null&&k instanceof FurnitureController)||k===null)&&((N!=null&&(N.constructor!=null&&N.constructor.__interfaces!=null&&N.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||N===null)&&((F!=null&&(F.constructor!=null&&F.constructor.__interfaces!=null&&F.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||F===null)&&((j!=null&&j instanceof javax.swing.undo.UndoableEditSupport)||j===null)&&T===undefined&&ad===undefined){var ac=arguments;var L=ac[1];var X=ac[2];var w=ac[3];var E=ac[4];var f=ac[5];var p=arguments;var z=null;var R=null;h=a.call(this,L,w)||this;if(h.home===undefined){h.home=null}if(h.piece===undefined){h.piece=null}if(h.modelName===undefined){h.modelName=null}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(h.furnitureController===undefined){h.furnitureController=null}if(h.contentManager===undefined){h.contentManager=null}if(h.undoSupport===undefined){h.undoSupport=null}if(h.furnitureModelStepState===undefined){h.furnitureModelStepState=null}if(h.furnitureOrientationStepState===undefined){h.furnitureOrientationStepState=null}if(h.furnitureAttributesStepState===undefined){h.furnitureAttributesStepState=null}if(h.furnitureIconStepState===undefined){h.furnitureIconStepState=null}if(h.stepsView===undefined){h.stepsView=null}if(h.step===undefined){h.step=null}if(h.name===undefined){h.name=null}if(h.creator===undefined){h.creator=null}if(h.model===undefined){h.model=null}if(h.width===undefined){h.width=0}if(h.proportionalWidth===undefined){h.proportionalWidth=0}if(h.depth===undefined){h.depth=0}if(h.proportionalDepth===undefined){h.proportionalDepth=0}if(h.height===undefined){h.height=0}if(h.proportionalHeight===undefined){h.proportionalHeight=0}if(h.elevation===undefined){h.elevation=0}if(h.movable===undefined){h.movable=false}if(h.doorOrWindow===undefined){h.doorOrWindow=false}if(h.staircaseCutOutShape===undefined){h.staircaseCutOutShape=null}if(h.color===undefined){h.color=null}if(h.category===undefined){h.category=null}if(h.backFaceShown===undefined){h.backFaceShown=false}if(h.modelSize===undefined){h.modelSize=0}if(h.modelRotation===undefined){h.modelRotation=null}if(h.iconYaw===undefined){h.iconYaw=0}if(h.proportional===undefined){h.proportional=false}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}h.home=u;h.piece=z;h.modelName=R;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=L;h.furnitureController=X;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=w;h.undoSupport=f;h.contentManager=E;h.setTitle(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,z==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));h.furnitureModelStepState=new b.FurnitureModelStepState(h);h.furnitureOrientationStepState=new b.FurnitureOrientationStepState(h);h.furnitureAttributesStepState=new b.FurnitureAttributesStepState(h);h.furnitureIconStepState=new b.FurnitureIconStepState(h);h.setStepState(h.furnitureModelStepState);if(h.home===undefined){h.home=null}if(h.piece===undefined){h.piece=null}if(h.modelName===undefined){h.modelName=null}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(h.furnitureController===undefined){h.furnitureController=null}if(h.contentManager===undefined){h.contentManager=null}if(h.undoSupport===undefined){h.undoSupport=null}if(h.furnitureModelStepState===undefined){h.furnitureModelStepState=null}if(h.furnitureOrientationStepState===undefined){h.furnitureOrientationStepState=null}if(h.furnitureAttributesStepState===undefined){h.furnitureAttributesStepState=null}if(h.furnitureIconStepState===undefined){h.furnitureIconStepState=null}if(h.stepsView===undefined){h.stepsView=null}if(h.step===undefined){h.step=null}if(h.name===undefined){h.name=null}if(h.creator===undefined){h.creator=null}if(h.model===undefined){h.model=null}if(h.width===undefined){h.width=0}if(h.proportionalWidth===undefined){h.proportionalWidth=0}if(h.depth===undefined){h.depth=0}if(h.proportionalDepth===undefined){h.proportionalDepth=0}if(h.height===undefined){h.height=0}if(h.proportionalHeight===undefined){h.proportionalHeight=0}if(h.elevation===undefined){h.elevation=0}if(h.movable===undefined){h.movable=false}if(h.doorOrWindow===undefined){h.doorOrWindow=false}if(h.staircaseCutOutShape===undefined){h.staircaseCutOutShape=null}if(h.color===undefined){h.color=null}if(h.category===undefined){h.category=null}if(h.backFaceShown===undefined){h.backFaceShown=false}if(h.modelSize===undefined){h.modelSize=0}if(h.modelRotation===undefined){h.modelRotation=null}if(h.iconYaw===undefined){h.iconYaw=0}if(h.proportional===undefined){h.proportional=false}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}}else{if(((typeof u==="string")||u===null)&&((H!=null&&H instanceof UserPreferences)||H===null)&&((k!=null&&(k.constructor!=null&&k.constructor.__interfaces!=null&&k.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||k===null)&&((N!=null&&(N.constructor!=null&&N.constructor.__interfaces!=null&&N.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||N===null)&&F===undefined&&j===undefined&&T===undefined&&ad===undefined){var ac=arguments;var Q=ac[0];var K=ac[1];var v=ac[2];var D=ac[3];var n=arguments;var ab=null;var x=null;var W=null;var e=null;h=a.call(this,K,v)||this;if(h.home===undefined){h.home=null}if(h.piece===undefined){h.piece=null}if(h.modelName===undefined){h.modelName=null}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(h.furnitureController===undefined){h.furnitureController=null}if(h.contentManager===undefined){h.contentManager=null}if(h.undoSupport===undefined){h.undoSupport=null}if(h.furnitureModelStepState===undefined){h.furnitureModelStepState=null}if(h.furnitureOrientationStepState===undefined){h.furnitureOrientationStepState=null}if(h.furnitureAttributesStepState===undefined){h.furnitureAttributesStepState=null}if(h.furnitureIconStepState===undefined){h.furnitureIconStepState=null}if(h.stepsView===undefined){h.stepsView=null}if(h.step===undefined){h.step=null}if(h.name===undefined){h.name=null}if(h.creator===undefined){h.creator=null}if(h.model===undefined){h.model=null}if(h.width===undefined){h.width=0}if(h.proportionalWidth===undefined){h.proportionalWidth=0}if(h.depth===undefined){h.depth=0}if(h.proportionalDepth===undefined){h.proportionalDepth=0}if(h.height===undefined){h.height=0}if(h.proportionalHeight===undefined){h.proportionalHeight=0}if(h.elevation===undefined){h.elevation=0}if(h.movable===undefined){h.movable=false}if(h.doorOrWindow===undefined){h.doorOrWindow=false}if(h.staircaseCutOutShape===undefined){h.staircaseCutOutShape=null}if(h.color===undefined){h.color=null}if(h.category===undefined){h.category=null}if(h.backFaceShown===undefined){h.backFaceShown=false}if(h.modelSize===undefined){h.modelSize=0}if(h.modelRotation===undefined){h.modelRotation=null}if(h.iconYaw===undefined){h.iconYaw=0}if(h.proportional===undefined){h.proportional=false}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}h.home=ab;h.piece=x;h.modelName=Q;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=K;h.furnitureController=W;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=v;h.undoSupport=e;h.contentManager=D;h.setTitle(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,x==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));h.furnitureModelStepState=new b.FurnitureModelStepState(h);h.furnitureOrientationStepState=new b.FurnitureOrientationStepState(h);h.furnitureAttributesStepState=new b.FurnitureAttributesStepState(h);h.furnitureIconStepState=new b.FurnitureIconStepState(h);h.setStepState(h.furnitureModelStepState);if(h.home===undefined){h.home=null}if(h.piece===undefined){h.piece=null}if(h.modelName===undefined){h.modelName=null}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(h.furnitureController===undefined){h.furnitureController=null}if(h.contentManager===undefined){h.contentManager=null}if(h.undoSupport===undefined){h.undoSupport=null}if(h.furnitureModelStepState===undefined){h.furnitureModelStepState=null}if(h.furnitureOrientationStepState===undefined){h.furnitureOrientationStepState=null}if(h.furnitureAttributesStepState===undefined){h.furnitureAttributesStepState=null}if(h.furnitureIconStepState===undefined){h.furnitureIconStepState=null}if(h.stepsView===undefined){h.stepsView=null}if(h.step===undefined){h.step=null}if(h.name===undefined){h.name=null}if(h.creator===undefined){h.creator=null}if(h.model===undefined){h.model=null}if(h.width===undefined){h.width=0}if(h.proportionalWidth===undefined){h.proportionalWidth=0}if(h.depth===undefined){h.depth=0}if(h.proportionalDepth===undefined){h.proportionalDepth=0}if(h.height===undefined){h.height=0}if(h.proportionalHeight===undefined){h.proportionalHeight=0}if(h.elevation===undefined){h.elevation=0}if(h.movable===undefined){h.movable=false}if(h.doorOrWindow===undefined){h.doorOrWindow=false}if(h.staircaseCutOutShape===undefined){h.staircaseCutOutShape=null}if(h.color===undefined){h.color=null}if(h.category===undefined){h.category=null}if(h.backFaceShown===undefined){h.backFaceShown=false}if(h.modelSize===undefined){h.modelSize=0}if(h.modelRotation===undefined){h.modelRotation=null}if(h.iconYaw===undefined){h.iconYaw=0}if(h.proportional===undefined){h.proportional=false}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}}else{if(((u!=null&&u instanceof CatalogPieceOfFurniture)||u===null)&&((H!=null&&H instanceof UserPreferences)||H===null)&&((k!=null&&(k.constructor!=null&&k.constructor.__interfaces!=null&&k.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||k===null)&&((N!=null&&(N.constructor!=null&&N.constructor.__interfaces!=null&&N.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||N===null)&&F===undefined&&j===undefined&&T===undefined&&ad===undefined){var ac=arguments;var t=ac[0];var J=ac[1];var r=ac[2];var C=ac[3];var m=arguments;var aa=null;var P=null;var V=null;var d=null;h=a.call(this,J,r)||this;if(h.home===undefined){h.home=null}if(h.piece===undefined){h.piece=null}if(h.modelName===undefined){h.modelName=null}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(h.furnitureController===undefined){h.furnitureController=null}if(h.contentManager===undefined){h.contentManager=null}if(h.undoSupport===undefined){h.undoSupport=null}if(h.furnitureModelStepState===undefined){h.furnitureModelStepState=null}if(h.furnitureOrientationStepState===undefined){h.furnitureOrientationStepState=null}if(h.furnitureAttributesStepState===undefined){h.furnitureAttributesStepState=null}if(h.furnitureIconStepState===undefined){h.furnitureIconStepState=null}if(h.stepsView===undefined){h.stepsView=null}if(h.step===undefined){h.step=null}if(h.name===undefined){h.name=null}if(h.creator===undefined){h.creator=null}if(h.model===undefined){h.model=null}if(h.width===undefined){h.width=0}if(h.proportionalWidth===undefined){h.proportionalWidth=0}if(h.depth===undefined){h.depth=0}if(h.proportionalDepth===undefined){h.proportionalDepth=0}if(h.height===undefined){h.height=0}if(h.proportionalHeight===undefined){h.proportionalHeight=0}if(h.elevation===undefined){h.elevation=0}if(h.movable===undefined){h.movable=false}if(h.doorOrWindow===undefined){h.doorOrWindow=false}if(h.staircaseCutOutShape===undefined){h.staircaseCutOutShape=null}if(h.color===undefined){h.color=null}if(h.category===undefined){h.category=null}if(h.backFaceShown===undefined){h.backFaceShown=false}if(h.modelSize===undefined){h.modelSize=0}if(h.modelRotation===undefined){h.modelRotation=null}if(h.iconYaw===undefined){h.iconYaw=0}if(h.proportional===undefined){h.proportional=false}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}h.home=aa;h.piece=t;h.modelName=P;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=J;h.furnitureController=V;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=r;h.undoSupport=d;h.contentManager=C;h.setTitle(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,t==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));h.furnitureModelStepState=new b.FurnitureModelStepState(h);h.furnitureOrientationStepState=new b.FurnitureOrientationStepState(h);h.furnitureAttributesStepState=new b.FurnitureAttributesStepState(h);h.furnitureIconStepState=new b.FurnitureIconStepState(h);h.setStepState(h.furnitureModelStepState);if(h.home===undefined){h.home=null}if(h.piece===undefined){h.piece=null}if(h.modelName===undefined){h.modelName=null}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(h.furnitureController===undefined){h.furnitureController=null}if(h.contentManager===undefined){h.contentManager=null}if(h.undoSupport===undefined){h.undoSupport=null}if(h.furnitureModelStepState===undefined){h.furnitureModelStepState=null}if(h.furnitureOrientationStepState===undefined){h.furnitureOrientationStepState=null}if(h.furnitureAttributesStepState===undefined){h.furnitureAttributesStepState=null}if(h.furnitureIconStepState===undefined){h.furnitureIconStepState=null}if(h.stepsView===undefined){h.stepsView=null}if(h.step===undefined){h.step=null}if(h.name===undefined){h.name=null}if(h.creator===undefined){h.creator=null}if(h.model===undefined){h.model=null}if(h.width===undefined){h.width=0}if(h.proportionalWidth===undefined){h.proportionalWidth=0}if(h.depth===undefined){h.depth=0}if(h.proportionalDepth===undefined){h.proportionalDepth=0}if(h.height===undefined){h.height=0}if(h.proportionalHeight===undefined){h.proportionalHeight=0}if(h.elevation===undefined){h.elevation=0}if(h.movable===undefined){h.movable=false}if(h.doorOrWindow===undefined){h.doorOrWindow=false}if(h.staircaseCutOutShape===undefined){h.staircaseCutOutShape=null}if(h.color===undefined){h.color=null}if(h.category===undefined){h.category=null}if(h.backFaceShown===undefined){h.backFaceShown=false}if(h.modelSize===undefined){h.modelSize=0}if(h.modelRotation===undefined){h.modelRotation=null}if(h.iconYaw===undefined){h.iconYaw=0}if(h.proportional===undefined){h.proportional=false}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}}else{if(((u!=null&&u instanceof UserPreferences)||u===null)&&((H!=null&&(H.constructor!=null&&H.constructor.__interfaces!=null&&H.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||H===null)&&((k!=null&&(k.constructor!=null&&k.constructor.__interfaces!=null&&k.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||k===null)&&N===undefined&&F===undefined&&j===undefined&&T===undefined&&ad===undefined){var ac=arguments;var I=ac[0];var o=ac[1];var A=ac[2];var l=arguments;var Y=null;var q=null;var O=null;var U=null;var c=null;h=a.call(this,I,o)||this;if(h.home===undefined){h.home=null}if(h.piece===undefined){h.piece=null}if(h.modelName===undefined){h.modelName=null}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(h.furnitureController===undefined){h.furnitureController=null}if(h.contentManager===undefined){h.contentManager=null}if(h.undoSupport===undefined){h.undoSupport=null}if(h.furnitureModelStepState===undefined){h.furnitureModelStepState=null}if(h.furnitureOrientationStepState===undefined){h.furnitureOrientationStepState=null}if(h.furnitureAttributesStepState===undefined){h.furnitureAttributesStepState=null}if(h.furnitureIconStepState===undefined){h.furnitureIconStepState=null}if(h.stepsView===undefined){h.stepsView=null}if(h.step===undefined){h.step=null}if(h.name===undefined){h.name=null}if(h.creator===undefined){h.creator=null}if(h.model===undefined){h.model=null}if(h.width===undefined){h.width=0}if(h.proportionalWidth===undefined){h.proportionalWidth=0}if(h.depth===undefined){h.depth=0}if(h.proportionalDepth===undefined){h.proportionalDepth=0}if(h.height===undefined){h.height=0}if(h.proportionalHeight===undefined){h.proportionalHeight=0}if(h.elevation===undefined){h.elevation=0}if(h.movable===undefined){h.movable=false}if(h.doorOrWindow===undefined){h.doorOrWindow=false}if(h.staircaseCutOutShape===undefined){h.staircaseCutOutShape=null}if(h.color===undefined){h.color=null}if(h.category===undefined){h.category=null}if(h.backFaceShown===undefined){h.backFaceShown=false}if(h.modelSize===undefined){h.modelSize=0}if(h.modelRotation===undefined){h.modelRotation=null}if(h.iconYaw===undefined){h.iconYaw=0}if(h.proportional===undefined){h.proportional=false}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}h.home=Y;h.piece=q;h.modelName=O;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=I;h.furnitureController=U;h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=o;h.undoSupport=c;h.contentManager=A;h.setTitle(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,q==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));h.furnitureModelStepState=new b.FurnitureModelStepState(h);h.furnitureOrientationStepState=new b.FurnitureOrientationStepState(h);h.furnitureAttributesStepState=new b.FurnitureAttributesStepState(h);h.furnitureIconStepState=new b.FurnitureIconStepState(h);h.setStepState(h.furnitureModelStepState);if(h.home===undefined){h.home=null}if(h.piece===undefined){h.piece=null}if(h.modelName===undefined){h.modelName=null}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(h.furnitureController===undefined){h.furnitureController=null}if(h.contentManager===undefined){h.contentManager=null}if(h.undoSupport===undefined){h.undoSupport=null}if(h.furnitureModelStepState===undefined){h.furnitureModelStepState=null}if(h.furnitureOrientationStepState===undefined){h.furnitureOrientationStepState=null}if(h.furnitureAttributesStepState===undefined){h.furnitureAttributesStepState=null}if(h.furnitureIconStepState===undefined){h.furnitureIconStepState=null}if(h.stepsView===undefined){h.stepsView=null}if(h.step===undefined){h.step=null}if(h.name===undefined){h.name=null}if(h.creator===undefined){h.creator=null}if(h.model===undefined){h.model=null}if(h.width===undefined){h.width=0}if(h.proportionalWidth===undefined){h.proportionalWidth=0}if(h.depth===undefined){h.depth=0}if(h.proportionalDepth===undefined){h.proportionalDepth=0}if(h.height===undefined){h.height=0}if(h.proportionalHeight===undefined){h.proportionalHeight=0}if(h.elevation===undefined){h.elevation=0}if(h.movable===undefined){h.movable=false}if(h.doorOrWindow===undefined){h.doorOrWindow=false}if(h.staircaseCutOutShape===undefined){h.staircaseCutOutShape=null}if(h.color===undefined){h.color=null}if(h.category===undefined){h.category=null}if(h.backFaceShown===undefined){h.backFaceShown=false}if(h.modelSize===undefined){h.modelSize=0}if(h.modelRotation===undefined){h.modelRotation=null}if(h.iconYaw===undefined){h.iconYaw=0}if(h.proportional===undefined){h.proportional=false}if(h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){h.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}}else{throw new Error("invalid overload")}}}}}}return h}b.prototype.finish=function(){var d;if(this.isDoorOrWindow()){d=new CatalogDoorOrWindow(this.getName(),this.getIcon(),this.getModel(),this.getWidth(),this.getDepth(),this.getHeight(),this.getElevation(),this.isMovable(),1,0,[],this.getColor(),this.getModelRotation(),this.isBackFaceShown(),this.getModelSize(),this.getCreator(),this.getIconYaw(),this.isProportional())}else{d=new CatalogPieceOfFurniture(this.getName(),this.getIcon(),this.getModel(),this.getWidth(),this.getDepth(),this.getHeight(),this.getElevation(),this.isMovable(),this.getStaircaseCutOutShape(),this.getColor(),this.getModelRotation(),this.isBackFaceShown(),this.getModelSize(),this.getCreator(),this.getIconYaw(),this.isProportional())}if(this.home!=null){this.addPieceOfFurniture(this.furnitureController.createHomePieceOfFurniture(d))}var c=this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getFurnitureCatalog();if(this.piece!=null){c["delete"](this.piece)}if(this.category!=null){c.add(this.category,d)}};b.prototype.addPieceOfFurniture=function(g){var c=this.home.isBasePlanLocked();var f=this.home.isAllLevelsSelection();var d=this.home.getSelectedItems();var h=this.home.getFurniture().length;this.home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(g,h);this.home.setSelectedItems([g]);if(!g.isMovable()&&c){this.home.setBasePlanLocked(false)}this.home.setAllLevelsSelection(false);if(this.undoSupport!=null){var e=new b.PieceOfFurnitureImportationUndoableEdit(this.home,this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences,d.slice(0),c,f,g,h);this.undoSupport.postEdit(e)}};b.prototype.getContentManager=function(){return this.contentManager};b.prototype.getStepState=function(){return a.prototype.getStepState.call(this)};b.prototype.getFurnitureModelStepState=function(){return this.furnitureModelStepState};b.prototype.getFurnitureOrientationStepState=function(){return this.furnitureOrientationStepState};b.prototype.getFurnitureAttributesStepState=function(){return this.furnitureAttributesStepState};b.prototype.getFurnitureIconStepState=function(){return this.furnitureIconStepState};b.prototype.getStepsView=function(){if(this.stepsView==null){this.stepsView=this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory.createImportedFurnitureWizardStepsView(this.piece,this.modelName,this.home!=null,this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences,this)}return this.stepsView};b.prototype.setStep=function(c){if(c!==this.step){var d=this.step;this.step=c;this.propertyChangeSupport.firePropertyChange("STEP",d,c)}};b.prototype.getStep=function(){return this.step};b.prototype.getModel=function(){return this.model};b.prototype.setModel=function(c){if(c!==this.model){var d=this.model;this.model=c;this.propertyChangeSupport.firePropertyChange("MODEL",d,c)}};b.prototype.isBackFaceShown=function(){return this.backFaceShown};b.prototype.setBackFaceShown=function(c){if(c!==this.backFaceShown){this.backFaceShown=c;this.propertyChangeSupport.firePropertyChange("BACK_FACE_SHOWN",!c,c)}};b.prototype.getModelSize=function(){return this.modelSize};b.prototype.setModelSize=function(c){if(c!==this.modelSize){var d=this.modelSize;this.modelSize=c;this.propertyChangeSupport.firePropertyChange("MODEL_SIZE",d,c)}};b.prototype.getModelRotation=function(){return this.modelRotation};b.prototype.setModelRotation=function(c){if(c!==this.modelRotation){var d=this.modelRotation;this.modelRotation=c;this.propertyChangeSupport.firePropertyChange("MODEL_ROTATION",d,c)}};b.prototype.getName=function(){return this.name};b.prototype.setName=function(c){if(c!==this.name){var d=this.name;this.name=c;if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange("NAME",d,c)}}};b.prototype.getCreator=function(){return this.creator};b.prototype.setCreator=function(d){if(d!==this.creator){var c=this.creator;this.creator=d;if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange("CREATOR",c,d)}}};b.prototype.getWidth=function(){return this.width};b.prototype.setWidth$float=function(c){this.setWidth$float$boolean(c,false)};b.prototype.setWidth$float$boolean=function(e,f){var d=Math.max(e,0.001);if(d===e||!f){this.proportionalWidth=e}if(d!==this.width){var c=this.width;this.width=d;this.propertyChangeSupport.firePropertyChange("WIDTH",c,d)}};b.prototype.setWidth=function(c,d){if(((typeof c==="number")||c===null)&&((typeof d==="boolean")||d===null)){return this.setWidth$float$boolean(c,d)}else{if(((typeof c==="number")||c===null)&&d===undefined){return this.setWidth$float(c)}else{throw new Error("invalid overload")}}};b.prototype.getDepth=function(){return this.depth};b.prototype.setDepth$float=function(c){this.setDepth$float$boolean(c,false)};b.prototype.setDepth$float$boolean=function(f,e){var d=Math.max(f,0.001);if(d===f||!e){this.proportionalDepth=f}if(d!==this.depth){var c=this.depth;this.depth=d;this.propertyChangeSupport.firePropertyChange("DEPTH",c,d)}};b.prototype.setDepth=function(d,c){if(((typeof d==="number")||d===null)&&((typeof c==="boolean")||c===null)){return this.setDepth$float$boolean(d,c)}else{if(((typeof d==="number")||d===null)&&c===undefined){return this.setDepth$float(d)}else{throw new Error("invalid overload")}}};b.prototype.getHeight=function(){return this.height};b.prototype.setHeight$float=function(c){this.setHeight$float$boolean(c,false)};b.prototype.setHeight$float$boolean=function(c,d){var e=Math.max(c,0.001);if(e===c||!d){this.proportionalHeight=c}if(e!==this.height){var f=this.height;this.height=e;this.propertyChangeSupport.firePropertyChange("HEIGHT",f,e)}};b.prototype.setHeight=function(c,d){if(((typeof c==="number")||c===null)&&((typeof d==="boolean")||d===null)){return this.setHeight$float$boolean(c,d)}else{if(((typeof c==="number")||c===null)&&d===undefined){return this.setHeight$float(c)}else{throw new Error("invalid overload")}}};b.prototype.getElevation=function(){return this.elevation};b.prototype.setElevation=function(d){if(d!==this.elevation){var c=this.elevation;this.elevation=d;this.propertyChangeSupport.firePropertyChange("ELEVATION",c,d)}};b.prototype.isMovable=function(){return this.movable};b.prototype.setMovable=function(c){if(c!==this.movable){this.movable=c;this.propertyChangeSupport.firePropertyChange("MOVABLE",!c,c)}};b.prototype.isDoorOrWindow=function(){return this.doorOrWindow};b.prototype.setDoorOrWindow=function(c){if(c!==this.doorOrWindow){this.doorOrWindow=c;this.propertyChangeSupport.firePropertyChange("DOOR_OR_WINDOW",!c,c);if(c){this.setStaircaseCutOutShape(null);this.setMovable(false)}}};b.prototype.getStaircaseCutOutShape=function(){return this.staircaseCutOutShape};b.prototype.setStaircaseCutOutShape=function(d){if(d!==this.staircaseCutOutShape){var c=this.staircaseCutOutShape;this.staircaseCutOutShape=d;if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange("STAIRCASE_CUT_OUT_SHAPE",c,d)}if(this.staircaseCutOutShape!=null){this.setDoorOrWindow(false);this.setMovable(false)}}};b.prototype.getColor=function(){return this.color};b.prototype.setColor=function(c){if(c!==this.color){var d=this.color;this.color=c;this.propertyChangeSupport.firePropertyChange("COLOR",d,c)}};b.prototype.getCategory=function(){return this.category};b.prototype.setCategory=function(d){if(d!==this.category){var c=this.category;this.category=d;this.propertyChangeSupport.firePropertyChange("CATEGORY",c,d)}};b.prototype.getIcon=function(){return this.getStepsView().getIcon()};b.prototype.getIconYaw=function(){return this.iconYaw};b.prototype.setIconYaw=function(c){if(c!==this.iconYaw){var d=this.iconYaw;this.iconYaw=c;this.propertyChangeSupport.firePropertyChange("ICON_YAW",d,c)}};b.prototype.isProportional=function(){return this.proportional};b.prototype.setProportional=function(c){if(c!==this.proportional){this.proportional=c;this.propertyChangeSupport.firePropertyChange("PROPORTIONAL",!c,c)}};b.prototype.isPieceOfFurnitureNameValid=function(){return this.name!=null&&this.name.length>0};return b}(WizardController));ImportedFurnitureWizardController.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController";ImportedFurnitureWizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(h){var c;(function(j){j[j.MODEL=0]="MODEL";j[j.ROTATION=1]="ROTATION";j[j.ATTRIBUTES=2]="ATTRIBUTES";j[j.ICON=3]="ICON"})(c=h.Step||(h.Step={}));var f=(function(j){__extends(k,j);function k(r,m,l,p,q,n,o){var s=j.call(this,m,h,"undoImportFurnitureName")||this;if(s.home===undefined){s.home=null}if(s.oldSelection===undefined){s.oldSelection=null}if(s.oldBasePlanLocked===undefined){s.oldBasePlanLocked=false}if(s.oldAllLevelsSelection===undefined){s.oldAllLevelsSelection=false}if(s.piece===undefined){s.piece=null}if(s.pieceIndex===undefined){s.pieceIndex=0}s.home=r;s.oldSelection=l;s.oldBasePlanLocked=p;s.oldAllLevelsSelection=q;s.piece=n;s.pieceIndex=o;return s}k.prototype.undo=function(){j.prototype.undo.call(this);this.home.deletePieceOfFurniture(this.piece);this.home.setSelectedItems(this.oldSelection.slice(0));this.home.setAllLevelsSelection(this.oldAllLevelsSelection);this.home.setBasePlanLocked(this.oldBasePlanLocked)};k.prototype.redo=function(){j.prototype.redo.call(this);this.home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(this.piece,this.pieceIndex);this.home.setSelectedItems([this.piece]);if(!this.piece.isMovable()&&this.oldBasePlanLocked){this.home.setBasePlanLocked(false)}this.home.setAllLevelsSelection(false)};return k}(LocalizedUndoableEdit));h.PieceOfFurnitureImportationUndoableEdit=f;f.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.PieceOfFurnitureImportationUndoableEdit";f.__interfaces=["javax.swing.undo.UndoableEdit"];var d=(function(k){__extends(j,k);function j(l){var m=k.call(this)||this;m.__parent=l;m.icon="resources/importedFurnitureWizard.png";return m}j.prototype.enter=function(){this.__parent.setStep(this.getStep())};j.prototype.getView=function(){return this.__parent.getStepsView()};j.prototype.getIcon=function(){return this.icon};return j}(WizardController.WizardControllerStepState));h.ImportedFurnitureWizardStepState=d;d.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.ImportedFurnitureWizardStepState";var g=(function(j){__extends(k,j);function k(l){var m=j.call(this,l)||this;m.__parent=l;m.modelChangeListener=new k.FurnitureModelStepState$0(m);return m}k.prototype.enter=function(){j.prototype.enter.call(this);this.setFirstStep(true);this.setNextStepEnabled(this.__parent.getModel()!=null);this.__parent.addPropertyChangeListener("MODEL",this.modelChangeListener)};k.prototype.getStep=function(){return h.Step.MODEL};k.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getFurnitureOrientationStepState())};k.prototype.exit=function(){this.__parent.removePropertyChangeListener("MODEL",this.modelChangeListener)};return k}(h.ImportedFurnitureWizardStepState));h.FurnitureModelStepState=g;g.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureModelStepState";(function(k){var j=(function(){function l(m){this.__parent=m}l.prototype.propertyChange=function(m){this.__parent.setNextStepEnabled(this.__parent.__parent.getModel()!=null)};return l}());k.FurnitureModelStepState$0=j})(g=h.FurnitureModelStepState||(h.FurnitureModelStepState={}));var b=(function(k){__extends(j,k);function j(l){var m=k.call(this,l)||this;m.__parent=l;return m}j.prototype.enter=function(){k.prototype.enter.call(this);this.setNextStepEnabled(true)};j.prototype.getStep=function(){return h.Step.ROTATION};j.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getFurnitureModelStepState())};j.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getFurnitureAttributesStepState())};return j}(h.ImportedFurnitureWizardStepState));h.FurnitureOrientationStepState=b;b.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureOrientationStepState";var e=(function(j){__extends(k,j);function k(l){var m=j.call(this,l)||this;m.__parent=l;m.widthChangeListener=new k.FurnitureAttributesStepState$0(m);m.depthChangeListener=new k.FurnitureAttributesStepState$1(m);m.heightChangeListener=new k.FurnitureAttributesStepState$2(m);m.nameAndCategoryChangeListener=new k.FurnitureAttributesStepState$3(m);return m}k.prototype.enter=function(){j.prototype.enter.call(this);this.__parent.addPropertyChangeListener("WIDTH",this.widthChangeListener);this.__parent.addPropertyChangeListener("DEPTH",this.depthChangeListener);this.__parent.addPropertyChangeListener("HEIGHT",this.heightChangeListener);this.__parent.addPropertyChangeListener("NAME",this.nameAndCategoryChangeListener);this.__parent.addPropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener);this.checkPieceOfFurnitureNameInCategory()};k.prototype.checkPieceOfFurnitureNameInCategory=function(){this.setNextStepEnabled(this.__parent.isPieceOfFurnitureNameValid())};k.prototype.getStep=function(){return h.Step.ATTRIBUTES};k.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getFurnitureOrientationStepState())};k.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getFurnitureIconStepState())};k.prototype.exit=function(){this.__parent.removePropertyChangeListener("WIDTH",this.widthChangeListener);this.__parent.removePropertyChangeListener("DEPTH",this.depthChangeListener);this.__parent.removePropertyChangeListener("HEIGHT",this.heightChangeListener);this.__parent.removePropertyChangeListener("NAME",this.nameAndCategoryChangeListener);this.__parent.removePropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener)};return k}(h.ImportedFurnitureWizardStepState));h.FurnitureAttributesStepState=e;e.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureAttributesStepState";(function(m){var l=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(q){if(this.__parent.__parent.isProportional()){this.__parent.__parent.removePropertyChangeListener("DEPTH",this.__parent.depthChangeListener);this.__parent.__parent.removePropertyChangeListener("HEIGHT",this.__parent.heightChangeListener);var p=q.getNewValue()/q.getOldValue();this.__parent.__parent.setDepth(this.__parent.__parent.proportionalDepth*p,true);this.__parent.__parent.setHeight(this.__parent.__parent.proportionalHeight*p,true);this.__parent.__parent.addPropertyChangeListener("DEPTH",this.__parent.depthChangeListener);this.__parent.__parent.addPropertyChangeListener("HEIGHT",this.__parent.heightChangeListener)}};return o}());m.FurnitureAttributesStepState$0=l;var k=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(q){if(this.__parent.__parent.isProportional()){this.__parent.__parent.removePropertyChangeListener("WIDTH",this.__parent.widthChangeListener);this.__parent.__parent.removePropertyChangeListener("HEIGHT",this.__parent.heightChangeListener);var p=q.getNewValue()/q.getOldValue();this.__parent.__parent.setWidth(this.__parent.__parent.proportionalWidth*p,true);this.__parent.__parent.setHeight(this.__parent.__parent.proportionalHeight*p,true);this.__parent.__parent.addPropertyChangeListener("WIDTH",this.__parent.widthChangeListener);this.__parent.__parent.addPropertyChangeListener("HEIGHT",this.__parent.heightChangeListener)}};return o}());m.FurnitureAttributesStepState$1=k;var j=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(q){if(this.__parent.__parent.isProportional()){this.__parent.__parent.removePropertyChangeListener("WIDTH",this.__parent.widthChangeListener);this.__parent.__parent.removePropertyChangeListener("DEPTH",this.__parent.depthChangeListener);var p=q.getNewValue()/q.getOldValue();this.__parent.__parent.setWidth(this.__parent.__parent.proportionalWidth*p,true);this.__parent.__parent.setDepth(this.__parent.__parent.proportionalDepth*p,true);this.__parent.__parent.addPropertyChangeListener("WIDTH",this.__parent.widthChangeListener);this.__parent.__parent.addPropertyChangeListener("DEPTH",this.__parent.depthChangeListener)}};return o}());m.FurnitureAttributesStepState$2=j;var n=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(p){this.__parent.checkPieceOfFurnitureNameInCategory()};return o}());m.FurnitureAttributesStepState$3=n})(e=h.FurnitureAttributesStepState||(h.FurnitureAttributesStepState={}));var a=(function(k){__extends(j,k);function j(l){var m=k.call(this,l)||this;m.__parent=l;return m}j.prototype.enter=function(){k.prototype.enter.call(this);this.setLastStep(true);this.setNextStepEnabled(true)};j.prototype.getStep=function(){return h.Step.ICON};j.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getFurnitureAttributesStepState())};return j}(h.ImportedFurnitureWizardStepState));h.FurnitureIconStepState=a;a.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureIconStepState"})(ImportedFurnitureWizardController||(ImportedFurnitureWizardController={}));var PageSetupController=(function(){function a(e,c,b,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.pageSetupView===undefined){this.pageSetupView=null}if(this.print===undefined){this.print=null}this.home=e;this.preferences=c;this.viewFactory=b;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.setPrint(e.getPrint())}a.prototype.getView=function(){if(this.pageSetupView==null){this.pageSetupView=this.viewFactory.createPageSetupView(this.preferences,this)}return this.pageSetupView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.setPrint=function(b){if(b!==this.print){var c=this.print;this.print=b;this.propertyChangeSupport.firePropertyChange("PRINT",c,b)}};a.prototype.getPrint=function(){return this.print};a.prototype.modifyPageSetup=function(){var b=this.home.getPrint();var d=this.getPrint();this.home.setPrint(d);var c=new a.HomePrintModificationUndoableEdit(this.home,this.preferences,b,d);this.undoSupport.postEdit(c)};return a}());PageSetupController.__class="com.eteks.sweethome3d.viewcontroller.PageSetupController";PageSetupController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(a){var b=(function(d){__extends(c,d);function c(h,f,e,g){var j=d.call(this,f,a,"undoPageSetupName")||this;if(j.home===undefined){j.home=null}if(j.oldHomePrint===undefined){j.oldHomePrint=null}if(j.homePrint===undefined){j.homePrint=null}j.home=h;j.oldHomePrint=e;j.homePrint=g;return j}c.prototype.undo=function(){d.prototype.undo.call(this);this.home.setPrint(this.oldHomePrint)};c.prototype.redo=function(){d.prototype.redo.call(this);this.home.setPrint(this.homePrint)};return c}(LocalizedUndoableEdit));a.HomePrintModificationUndoableEdit=b;b.__class="com.eteks.sweethome3d.viewcontroller.PageSetupController.HomePrintModificationUndoableEdit";b.__interfaces=["javax.swing.undo.UndoableEdit"]})(PageSetupController||(PageSetupController={}));var LevelController=(function(){function a(e,c,b,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.homeLevelView===undefined){this.homeLevelView=null}if(this.name===undefined){this.name=null}if(this.viewable===undefined){this.viewable=null}if(this.elevation===undefined){this.elevation=null}if(this.elevationIndex===undefined){this.elevationIndex=null}if(this.floorThickness===undefined){this.floorThickness=null}if(this.height===undefined){this.height=null}if(this.levels===undefined){this.levels=null}if(this.selectedLevelIndex===undefined){this.selectedLevelIndex=null}this.home=e;this.preferences=c;this.viewFactory=b;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getView=function(){if(this.homeLevelView==null){this.homeLevelView=this.viewFactory.createLevelView(this.preferences,this)}return this.homeLevelView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var b=this.home.getSelectedLevel();this.setLevels(this.clone((function(d,c){if(d.length>=c.length){d.length=0;d.push.apply(d,c);return d}else{return c.slice(0)}})([],this.home.getLevels())));if(b==null){this.setSelectedLevelIndex(null);this.setName(null);this.setViewable(true);this.setElevation(null,false);this.setFloorThickness(null);this.setHeight(null);this.setElevationIndex(null,false)}else{this.setSelectedLevelIndex(this.home.getLevels().indexOf(b));this.setName(b.getName());this.setViewable(b.isViewable());this.setElevation(b.getElevation(),false);this.setFloorThickness(b.getFloorThickness());this.setHeight(b.getHeight());this.setElevationIndex(b.getElevationIndex(),false)}};a.prototype.clone=function(c){for(var b=0;b<c.length;b++){c[b]=(function(e){if(e.clone!=undefined){return e.clone()}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(c[b])}return c};a.prototype.isPropertyEditable=function(b){return true};a.prototype.setName=function(b){if(b!==this.name){var c=this.name;this.name=b;this.propertyChangeSupport.firePropertyChange("NAME",c,b);if(this.selectedLevelIndex!=null){this.levels[this.selectedLevelIndex].setName(b);this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels)}}};a.prototype.getName=function(){return this.name};a.prototype.setViewable=function(b){if(b!==this.viewable){var c=b;this.viewable=b;this.propertyChangeSupport.firePropertyChange("VIEWABLE",c,b);if(b!=null&&this.selectedLevelIndex!=null){this.levels[this.selectedLevelIndex].setViewable(b);this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels)}}};a.prototype.getViewable=function(){return this.viewable};a.prototype.setElevation=function(e,d){if(d===void 0){d=true}if(e!==this.elevation){var c=this.elevation;this.elevation=e;this.propertyChangeSupport.firePropertyChange("ELEVATION",c,e);if(d&&e!=null&&this.selectedLevelIndex!=null){var b=a.updateLevelElevation(this.levels[this.selectedLevelIndex],e,this.levels.slice(0));this.setElevationIndex(b,false);this.updateLevels()}}};a.updateLevelElevation=function(h,e,f){var g=f.length;var c=0;for(var d=0;d<f.length;d++){var b=f[d];if(b===h){g=d}else{if(b.getElevation()===e){c=b.getElevationIndex()+1}else{if(d>g&&b.getElevation()===h.getElevation()){b.setElevationIndex(b.getElevationIndex()-1)}}}}h.setElevation(e);h.setElevationIndex(c);return c};a.prototype.getElevation=function(){return this.elevation};a.prototype.setElevationIndex=function(b,c){if(c===void 0){c=true}if(b!==this.elevationIndex){var d=this.elevationIndex;this.elevationIndex=b;this.propertyChangeSupport.firePropertyChange("ELEVATION_INDEX",d,b);if(c&&b!=null&&this.selectedLevelIndex!=null){a.updateLevelElevationIndex(this.levels[this.selectedLevelIndex],b,this.levels.slice(0));this.updateLevels()}}};a.updateLevelElevationIndex=function(g,c,f){var d=(function(h){if(h>0){return 1}else{if(h<0){return -1}else{return 0}}})(c-g.getElevationIndex());for(var e=0;e<f.length;e++){var b=f[e];if(b!==g&&b.getElevation()===g.getElevation()&&(function(h){if(h>0){return 1}else{if(h<0){return -1}else{return 0}}})(b.getElevationIndex()-g.getElevationIndex())===d&&(function(h){if(h>0){return 1}else{if(h<0){return -1}else{return 0}}})(b.getElevationIndex()-c)!==d){b.setElevationIndex(b.getElevationIndex()-(d|0))}else{if(b.getElevation()>g.getElevation()){break}}}g.setElevationIndex(c)};a.prototype.updateLevels=function(){var f=new Home();var e=this.levels[this.selectedLevelIndex];for(var c=0;c<this.levels.length;c++){var b=this.levels[c];f.addLevel(b)}var d=f.getLevels();this.setLevels(d.slice(0));this.setSelectedLevelIndex(d.indexOf(e))};a.prototype.getElevationIndex=function(){return this.elevationIndex};a.prototype.setFloorThickness=function(c){if(c!==this.floorThickness){var b=this.floorThickness;this.floorThickness=c;this.propertyChangeSupport.firePropertyChange("FLOOR_THICKNESS",b,c);if(c!=null&&this.selectedLevelIndex!=null){this.levels[this.selectedLevelIndex].setFloorThickness(c);this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels)}}};a.prototype.getFloorThickness=function(){return this.floorThickness};a.prototype.setHeight=function(b){if(b!==this.height){var c=this.height;this.height=b;this.propertyChangeSupport.firePropertyChange("HEIGHT",c,b);if(b!=null&&this.selectedLevelIndex!=null){this.levels[this.selectedLevelIndex].setHeight(b);this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels)}}};a.prototype.getHeight=function(){return this.height};a.prototype.setLevels=function(c){if(c!==this.levels){var b=this.levels;this.levels=c;this.propertyChangeSupport.firePropertyChange("LEVELS",b,c)}};a.prototype.getLevels=function(){return this.levels.slice(0)};a.prototype.setSelectedLevelIndex=function(c){if(c!==this.selectedLevelIndex){var b=this.selectedLevelIndex;this.selectedLevelIndex=c;this.propertyChangeSupport.firePropertyChange("SELECT_LEVEL_INDEX",b,c)}};a.prototype.getSelectedLevelIndex=function(){return this.selectedLevelIndex};a.prototype.modifyLevels=function(){var h=this.home.getSelectedLevel();if(h!=null){var c=this.home.getSelectedItems();var b=this.getName();var e=this.getViewable();var j=this.getElevation();var f=this.getFloorThickness();var k=this.getHeight();var g=this.getElevationIndex();var l=new a.ModifiedLevel(h);a.doModifyLevel(this.home,l,b,e,j,f,k,g);if(this.undoSupport!=null){var d=new a.LevelModificationUndoableEdit(this.home,this.preferences,c.slice(0),l,b,e,j,f,k,g);this.undoSupport.postEdit(d)}if(b!=null){this.preferences.addAutoCompletionString("LevelName",b)}}};a.doModifyLevel=function(l,q,c,f,o,g,p,j){var b=q.getLevel();if(c!=null){b.setName(c)}if(f!=null){var e=l.getSelectedItems();b.setViewable(f);l.setSelectedItems(a.getViewableSublist(e))}if(o!=null&&o!==b.getElevation()){a.updateLevelElevation(b,o,l.getLevels())}if(j!=null){a.updateLevelElevationIndex(b,j,l.getLevels())}if(!l.getEnvironment().isAllLevelsVisible()){var m=l.getSelectedLevel();var d=true;var k=l.getLevels();for(var h=0;h<k.length;h++){var n=k[h];n.setVisible(d);if(n===m){d=false}}}if(g!=null){b.setFloorThickness(g)}if(p!=null){b.setHeight(p)}};a.getViewableSublist=function(b){var e=([]);for(var c=0;c<b.length;c++){var d=b[c];if(!(d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))||d.getLevel().isViewable()){(e.push(d)>0)}}return e};a.undoModifyLevel=function(c,b){b.reset();var d=b.getLevel();if(b.getElevation()!==d.getElevation()){a.updateLevelElevation(d,b.getElevation(),c.getLevels())}if(b.getElevationIndex()!==d.getElevationIndex()){a.updateLevelElevationIndex(d,b.getElevationIndex(),c.getLevels())}};return a}());LevelController.__class="com.eteks.sweethome3d.viewcontroller.LevelController";LevelController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(a){var c=(function(e){__extends(d,e);function d(n,k,f,q,g,h,p,j,o,m){var l=e.call(this,k,a,"undoModifyLevelName")||this;if(l.home===undefined){l.home=null}if(l.oldSelection===undefined){l.oldSelection=null}if(l.modifiedLevel===undefined){l.modifiedLevel=null}if(l.name===undefined){l.name=null}if(l.viewable===undefined){l.viewable=null}if(l.elevation===undefined){l.elevation=null}if(l.floorThickness===undefined){l.floorThickness=null}if(l.height===undefined){l.height=null}if(l.elevationIndex===undefined){l.elevationIndex=null}l.home=n;l.oldSelection=f;l.modifiedLevel=q;l.name=g;l.viewable=h;l.elevation=p;l.floorThickness=j;l.height=o;l.elevationIndex=m;return l}d.prototype.undo=function(){e.prototype.undo.call(this);a.undoModifyLevel(this.home,this.modifiedLevel);this.home.setSelectedLevel(this.modifiedLevel.getLevel());this.home.setSelectedItems(this.oldSelection.slice(0))};d.prototype.redo=function(){e.prototype.redo.call(this);this.home.setSelectedLevel(this.modifiedLevel.getLevel());a.doModifyLevel(this.home,this.modifiedLevel,this.name,this.viewable,this.elevation,this.floorThickness,this.height,this.elevationIndex)};return d}(LocalizedUndoableEdit));a.LevelModificationUndoableEdit=c;c.__class="com.eteks.sweethome3d.viewcontroller.LevelController.LevelModificationUndoableEdit";c.__interfaces=["javax.swing.undo.UndoableEdit"];var b=(function(){function d(e){if(this.level===undefined){this.level=null}if(this.name===undefined){this.name=null}if(this.viewable===undefined){this.viewable=false}if(this.elevation===undefined){this.elevation=0}if(this.floorThickness===undefined){this.floorThickness=0}if(this.height===undefined){this.height=0}if(this.elevationIndex===undefined){this.elevationIndex=0}this.level=e;this.name=e.getName();this.viewable=e.isViewable();this.elevation=e.getElevation();this.floorThickness=e.getFloorThickness();this.height=e.getHeight();this.elevationIndex=e.getElevationIndex()}d.prototype.getLevel=function(){return this.level};d.prototype.getElevation=function(){return this.elevation};d.prototype.getElevationIndex=function(){return this.elevationIndex};d.prototype.reset=function(){this.level.setName(this.name);this.level.setViewable(this.viewable);this.level.setFloorThickness(this.floorThickness);this.level.setHeight(this.height)};return d}());a.ModifiedLevel=b;b.__class="com.eteks.sweethome3d.viewcontroller.LevelController.ModifiedLevel"})(LevelController||(LevelController={}));var WallController=(function(){function a(f,c,b,e,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.leftSideTextureController===undefined){this.leftSideTextureController=null}if(this.leftSideBaseboardController===undefined){this.leftSideBaseboardController=null}if(this.rightSideTextureController===undefined){this.rightSideTextureController=null}if(this.rightSideBaseboardController===undefined){this.rightSideBaseboardController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.wallView===undefined){this.wallView=null}if(this.editablePoints===undefined){this.editablePoints=false}if(this.xStart===undefined){this.xStart=null}if(this.yStart===undefined){this.yStart=null}if(this.xEnd===undefined){this.xEnd=null}if(this.yEnd===undefined){this.yEnd=null}if(this.length===undefined){this.length=null}if(this.distanceToEndPoint===undefined){this.distanceToEndPoint=null}if(this.leftSideColor===undefined){this.leftSideColor=null}if(this.leftSidePaint===undefined){this.leftSidePaint=null}if(this.leftSideShininess===undefined){this.leftSideShininess=null}if(this.rightSideColor===undefined){this.rightSideColor=null}if(this.rightSidePaint===undefined){this.rightSidePaint=null}if(this.rightSideShininess===undefined){this.rightSideShininess=null}if(this.pattern===undefined){this.pattern=null}if(this.topColor===undefined){this.topColor=null}if(this.topPaint===undefined){this.topPaint=null}if(this.shape===undefined){this.shape=null}if(this.rectangularWallHeight===undefined){this.rectangularWallHeight=null}if(this.slopingWallHeightAtStart===undefined){this.slopingWallHeightAtStart=null}if(this.sloppingWallHeightAtEnd===undefined){this.sloppingWallHeightAtEnd=null}if(this.thickness===undefined){this.thickness=null}if(this.arcExtentInDegrees===undefined){this.arcExtentInDegrees=null}this.home=f;this.preferences=c;this.viewFactory=b;this.contentManager=e;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getLeftSideTextureController=function(){if(this.leftSideTextureController==null){this.leftSideTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"leftSideTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.leftSideTextureController.addPropertyChangeListener("TEXTURE",new a.WallController$0(this))}return this.leftSideTextureController};a.prototype.getLeftSideBaseboardController=function(){if(this.leftSideBaseboardController==null){this.leftSideBaseboardController=new BaseboardChoiceController(this.preferences,this.viewFactory,this.contentManager)}return this.leftSideBaseboardController};a.prototype.getRightSideTextureController=function(){if(this.rightSideTextureController==null){this.rightSideTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"rightSideTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.rightSideTextureController.addPropertyChangeListener("TEXTURE",new a.WallController$1(this))}return this.rightSideTextureController};a.prototype.getRightSideBaseboardController=function(){if(this.rightSideBaseboardController==null){this.rightSideBaseboardController=new BaseboardChoiceController(this.preferences,this.viewFactory,this.contentManager)}return this.rightSideBaseboardController};a.prototype.getView=function(){if(this.wallView==null){this.wallView=this.viewFactory.createWallView(this.preferences,this)}return this.wallView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var v=Home.getWallsSubList(this.home.getSelectedItems());if((v.length==0)){this.setXStart(null);this.setYStart(null);this.setXEnd(null);this.setYEnd(null);this.setEditablePoints(false);this.setLeftSideColor(null);this.getLeftSideTextureController().setTexture(null);this.setLeftSidePaint(null);this.setLeftSideShininess(null);this.getLeftSideBaseboardController().setVisible(null);this.getLeftSideBaseboardController().setThickness(null);this.getLeftSideBaseboardController().setHeight(null);this.getLeftSideBaseboardController().setColor(null);this.getLeftSideBaseboardController().getTextureController().setTexture(null);this.getLeftSideBaseboardController().setPaint(null);this.setRightSideColor(null);this.getRightSideTextureController().setTexture(null);this.setRightSidePaint(null);this.setRightSideShininess(null);this.getRightSideBaseboardController().setVisible(null);this.getRightSideBaseboardController().setThickness(null);this.getRightSideBaseboardController().setHeight(null);this.getRightSideBaseboardController().setColor(null);this.getRightSideBaseboardController().getTextureController().setTexture(null);this.getRightSideBaseboardController().setPaint(null);this.setPattern(null);this.setTopColor(null);this.setTopPaint(null);this.setRectangularWallHeight(null);this.setSlopingWallHeightAtStart(null);this.setSlopingWallHeightAtEnd(null);this.setShape(null);this.setThickness(null);this.setArcExtentInDegrees(null)}else{var G=v[0];var K=v.length>1;this.setEditablePoints(!K);var o=G.getXStart();for(var P=1;P<v.length;P++){if(!(o===v[P].getXStart())){o=null;break}}this.setXStart(o);var H=G.getYStart();for(var P=1;P<v.length;P++){if(!(H===v[P].getYStart())){H=null;break}}this.setYStart(H);var w=G.getXEnd();for(var P=1;P<v.length;P++){if(!(w===v[P].getXEnd())){w=null;break}}this.setXEnd(w);var J=G.getYEnd();for(var P=1;P<v.length;P++){if(!(J===v[P].getYEnd())){J=null;break}}this.setYEnd(J);var c=G.getLeftSideColor();if(c!=null){for(var P=1;P<v.length;P++){if(!(c===v[P].getLeftSideColor())){c=null;break}}}this.setLeftSideColor(c);var C=G.getLeftSideTexture();if(C!=null){for(var P=1;P<v.length;P++){if(!C.equals(v[P].getLeftSideTexture())){C=null;break}}}this.getLeftSideTextureController().setTexture(C);var O=true;for(var P=0;P<v.length;P++){var r=v[P];if(r.getLeftSideColor()!=null||r.getLeftSideTexture()!=null){O=false;break}}if(c!=null){this.setLeftSidePaint(a.WallPaint.COLORED)}else{if(C!=null){this.setLeftSidePaint(a.WallPaint.TEXTURED)}else{if(O){this.setLeftSidePaint(a.WallPaint.DEFAULT)}else{this.setLeftSidePaint(null)}}}var g=G.getLeftSideShininess();for(var P=1;P<v.length;P++){if(!(g===v[P].getLeftSideShininess())){g=null;break}}this.setLeftSideShininess(g);var F=G.getLeftSideBaseboard()!=null;for(var P=1;P<v.length;P++){if(F!==(v[P].getLeftSideBaseboard()!=null)){F=null;break}}this.getLeftSideBaseboardController().setVisible(F);var s=G.getLeftSideBaseboard();var E=s!=null?s.getThickness():this.preferences.getNewWallBaseboardThickness();for(var P=1;P<v.length;P++){var d=v[P].getLeftSideBaseboard();if(!(E===(d!=null?d.getThickness():this.preferences.getNewWallBaseboardThickness()))){E=null;break}}this.getLeftSideBaseboardController().setThickness(E);var z=s!=null?s.getHeight():this.preferences.getNewWallBaseboardHeight();for(var P=1;P<v.length;P++){var d=v[P].getLeftSideBaseboard();if(!(z===(d!=null?d.getHeight():this.preferences.getNewWallBaseboardHeight()))){z=null;break}}this.getLeftSideBaseboardController().setHeight(z);var M=s!=null?s.getColor():null;if(M!=null){for(var P=1;P<v.length;P++){var d=v[P].getLeftSideBaseboard();if(d==null||!(M===d.getColor())){M=null;break}}}this.getLeftSideBaseboardController().setColor(M);var D=s!=null?s.getTexture():null;if(D!=null){for(var P=1;P<v.length;P++){var d=v[P].getLeftSideBaseboard();if(d==null||!D.equals(d.getTexture())){D=null;break}}}this.getLeftSideBaseboardController().getTextureController().setTexture(D);O=true;for(var P=0;P<v.length;P++){var d=v[P].getLeftSideBaseboard();if(d!=null&&(d.getColor()!=null||d.getTexture()!=null)){O=false;break}}if(M!=null){this.getLeftSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.COLORED)}else{if(D!=null){this.getLeftSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.TEXTURED)}else{if(O){this.getLeftSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.DEFAULT)}else{this.getLeftSideBaseboardController().setPaint(null)}}}var b=G.getRightSideColor();if(b!=null){for(var P=1;P<v.length;P++){if(!(b===v[P].getRightSideColor())){b=null;break}}}this.setRightSideColor(b);var m=G.getRightSideTexture();if(m!=null){for(var P=1;P<v.length;P++){if(!m.equals(v[P].getRightSideTexture())){m=null;break}}}this.getRightSideTextureController().setTexture(m);O=true;for(var P=0;P<v.length;P++){var r=v[P];if(r.getRightSideColor()!=null||r.getRightSideTexture()!=null){O=false;break}}if(b!=null){this.setRightSidePaint(a.WallPaint.COLORED)}else{if(m!=null){this.setRightSidePaint(a.WallPaint.TEXTURED)}else{if(O){this.setRightSidePaint(a.WallPaint.DEFAULT)}else{this.setRightSidePaint(null)}}}var N=G.getRightSideShininess();for(var P=1;P<v.length;P++){if(!(N===v[P].getRightSideShininess())){N=null;break}}this.setRightSideShininess(N);var q=G.getRightSideBaseboard()!=null;for(var P=1;P<v.length;P++){if(q!==(v[P].getRightSideBaseboard()!=null)){q=null;break}}this.getRightSideBaseboardController().setVisible(q);var I=G.getRightSideBaseboard();var j=I!=null?I.getThickness():this.preferences.getNewWallBaseboardThickness();for(var P=1;P<v.length;P++){var d=v[P].getRightSideBaseboard();if(!(j===(d!=null?d.getThickness():this.preferences.getNewWallBaseboardThickness()))){j=null;break}}this.getRightSideBaseboardController().setThickness(j);var k=I!=null?I.getHeight():this.preferences.getNewWallBaseboardHeight();for(var P=1;P<v.length;P++){var d=v[P].getRightSideBaseboard();if(!(k===(d!=null?d.getHeight():this.preferences.getNewWallBaseboardHeight()))){k=null;break}}this.getRightSideBaseboardController().setHeight(k);var y=I!=null?I.getColor():null;if(y!=null){for(var P=1;P<v.length;P++){var d=v[P].getRightSideBaseboard();if(d==null||!(y===d.getColor())){y=null;break}}}this.getRightSideBaseboardController().setColor(y);var l=I!=null?I.getTexture():null;if(l!=null){for(var P=1;P<v.length;P++){var d=v[P].getRightSideBaseboard();if(d==null||!l.equals(d.getTexture())){l=null;break}}}this.getRightSideBaseboardController().getTextureController().setTexture(l);O=true;for(var P=0;P<v.length;P++){var d=v[P].getRightSideBaseboard();if(d!=null&&(d.getColor()!=null||d.getTexture()!=null)){O=false;break}}if(y!=null){this.getRightSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.COLORED)}else{if(l!=null){this.getRightSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.TEXTURED)}else{if(O){this.getRightSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.DEFAULT)}else{this.getRightSideBaseboardController().setPaint(null)}}}var n=G.getPattern();if(n==null){n=this.preferences.getWallPattern()}for(var P=1;P<v.length;P++){var h=v[P].getPattern();if(h==null){h=this.preferences.getWallPattern()}if(!(function(R,Q){if(R&&R.equals){return R.equals(Q)}else{return R===Q}})(n,h)){n=null;break}}this.setPattern(n);var A=G.getTopColor();var B=void 0;if(A!=null){B=false;for(var P=1;P<v.length;P++){if(!(A===v[P].getTopColor())){A=null;break}}}else{B=true;for(var P=1;P<v.length;P++){if(v[P].getTopColor()!=null){B=false;break}}}this.setTopColor(A);if(B){this.setTopPaint(a.WallPaint.DEFAULT)}else{if(A!=null){this.setTopPaint(a.WallPaint.COLORED)}else{this.setTopPaint(null)}}var e=G.getHeight();if(e==null&&G.getHeight()==null){e=this.home.getWallHeight()}for(var P=1;P<v.length;P++){var r=v[P];var t=r.getHeight()==null?this.home.getWallHeight():r.getHeight();if(e!==t){e=null;break}}this.setRectangularWallHeight(e);this.setSlopingWallHeightAtStart(e);var p=G.getHeightAtEnd();if(p!=null){for(var P=1;P<v.length;P++){if(!(p===v[P].getHeightAtEnd())){p=null;break}}}this.setSlopingWallHeightAtEnd(p==null&&v.length===1?e:p);var u=!G.isTrapezoidal();var L=G.isTrapezoidal();for(var P=1;P<v.length;P++){if(!v[P].isTrapezoidal()){L=false}else{u=false}}if(u){this.setShape(a.WallShape.RECTANGULAR_WALL)}else{if(L){this.setShape(a.WallShape.SLOPING_WALL)}else{this.setShape(null)}}var x=G.getThickness();for(var P=1;P<v.length;P++){if(x!==v[P].getThickness()){x=null;break}}this.setThickness(x);var f=G.getArcExtent();if(f!=null){for(var P=1;P<v.length;P++){if(!(f===v[P].getArcExtent())){f=null;break}}}if(f!=null){this.setArcExtentInDegrees((function(Q){return Q*180/Math.PI})(f))}else{this.setArcExtentInDegrees(v.length===1?new Number(0).valueOf():null)}}};a.prototype.setXStart=function(c){if(c!==this.xStart){var b=this.xStart;this.xStart=c;this.propertyChangeSupport.firePropertyChange("X_START",b,c);this.updateLength();this.updateDistanceToEndPoint()}};a.prototype.getXStart=function(){return this.xStart};a.prototype.setYStart=function(c){if(c!==this.yStart){var b=this.yStart;this.yStart=c;this.propertyChangeSupport.firePropertyChange("Y_START",b,c);this.updateLength();this.updateDistanceToEndPoint()}};a.prototype.getYStart=function(){return this.yStart};a.prototype.setXEnd=function(b){if(b!==this.xEnd){var c=this.xEnd;this.xEnd=b;this.propertyChangeSupport.firePropertyChange("X_END",c,b);this.updateLength();this.updateDistanceToEndPoint()}};a.prototype.getXEnd=function(){return this.xEnd};a.prototype.setYEnd=function(b){if(b!==this.yEnd){var c=this.yEnd;this.yEnd=b;this.propertyChangeSupport.firePropertyChange("Y_END",c,b);this.updateLength();this.updateDistanceToEndPoint()}};a.prototype.getYEnd=function(){return this.yEnd};a.prototype.updateLength=function(){var g=this.getXStart();var d=this.getYStart();var c=this.getXEnd();var f=this.getYEnd();if(g!=null&&d!=null&&c!=null&&f!=null){var b=new Wall(g,d,c,f,0,0);var e=this.getArcExtentInDegrees();if(e!=null){b.setArcExtent((function(h){return h*Math.PI/180})(e))}this.setLength(b.getLength(),false)}else{this.setLength(null,false)}};a.prototype.getLength=function(){return this.length};a.prototype.setLength=function(e,c){if(c===void 0){c=true}if(e!==this.length){var d=this.length;this.length=e;this.propertyChangeSupport.firePropertyChange("LENGTH",d,e);if(c){var j=this.getXStart();var f=this.getYStart();var b=this.getXEnd();var h=this.getYEnd();if(j!=null&&f!=null&&b!=null&&h!=null&&e!=null){if(this.getArcExtentInDegrees()!=null&&this.getArcExtentInDegrees()===0){var g=Math.atan2(f-h,b-j);this.setXEnd((j+e*Math.cos(g)));this.setYEnd((f-e*Math.sin(g)))}else{throw new UnsupportedOperationException("Computing end point of a round wall from its length not supported")}}else{this.setXEnd(null);this.setYEnd(null)}}}};a.prototype.updateDistanceToEndPoint=function(){var e=this.getXStart();var c=this.getYStart();var b=this.getXEnd();var d=this.getYEnd();if(e!=null&&c!=null&&b!=null&&d!=null){this.setDistanceToEndPoint(java.awt.geom.Point2D.distance(e,c,b,d),false)}else{this.setDistanceToEndPoint(null,false)}};a.prototype.setDistanceToEndPoint=function(e,c){if(c===void 0){c=true}if(e!==this.distanceToEndPoint){var d=this.distanceToEndPoint;this.distanceToEndPoint=e;this.propertyChangeSupport.firePropertyChange("DISTANCE_TO_END_POINT",d,e);if(c){var j=this.getXStart();var f=this.getYStart();var b=this.getXEnd();var h=this.getYEnd();if(j!=null&&f!=null&&b!=null&&h!=null&&e!=null){var g=Math.atan2(f-h,b-j);this.setXEnd((j+e*Math.cos(g)));this.setYEnd((f-e*Math.sin(g)))}else{this.setXEnd(null);this.setYEnd(null)}}}};a.prototype.getDistanceToEndPoint=function(){return this.distanceToEndPoint};a.prototype.setEditablePoints=function(b){if(b!==this.editablePoints){this.editablePoints=b;this.propertyChangeSupport.firePropertyChange("EDITABLE_POINTS",!b,b)}};a.prototype.isEditablePoints=function(){return this.editablePoints};a.prototype.setLeftSideColor=function(b){if(b!==this.leftSideColor){var c=this.leftSideColor;this.leftSideColor=b;this.propertyChangeSupport.firePropertyChange("LEFT_SIDE_COLOR",c,b);this.setLeftSidePaint(a.WallPaint.COLORED)}};a.prototype.getLeftSideColor=function(){return this.leftSideColor};a.prototype.setLeftSidePaint=function(c){if(c!==this.leftSidePaint){var b=this.leftSidePaint;this.leftSidePaint=c;this.propertyChangeSupport.firePropertyChange("LEFT_SIDE_PAINT",b,c)}};a.prototype.getLeftSidePaint=function(){return this.leftSidePaint};a.prototype.setLeftSideShininess=function(b){if(b!==this.leftSideShininess){var c=this.leftSideShininess;this.leftSideShininess=b;this.propertyChangeSupport.firePropertyChange("LEFT_SIDE_SHININESS",c,b)}};a.prototype.getLeftSideShininess=function(){return this.leftSideShininess};a.prototype.setRightSideColor=function(c){if(c!==this.rightSideColor){var b=this.rightSideColor;this.rightSideColor=c;this.propertyChangeSupport.firePropertyChange("RIGHT_SIDE_COLOR",b,c);this.setRightSidePaint(a.WallPaint.COLORED)}};a.prototype.getRightSideColor=function(){return this.rightSideColor};a.prototype.setRightSidePaint=function(b){if(b!==this.rightSidePaint){var c=this.rightSidePaint;this.rightSidePaint=b;this.propertyChangeSupport.firePropertyChange("RIGHT_SIDE_PAINT",c,b)}};a.prototype.getRightSidePaint=function(){return this.rightSidePaint};a.prototype.setRightSideShininess=function(c){if(c!==this.rightSideShininess){var b=this.rightSideShininess;this.rightSideShininess=c;this.propertyChangeSupport.firePropertyChange("RIGHT_SIDE_SHININESS",b,c)}};a.prototype.getRightSideShininess=function(){return this.rightSideShininess};a.prototype.setPattern=function(c){if(this.pattern!==c){var b=this.pattern;this.pattern=c;this.propertyChangeSupport.firePropertyChange("PATTERN",b,c)}};a.prototype.getPattern=function(){return this.pattern};a.prototype.setTopColor=function(b){if(b!==this.topColor){var c=this.topColor;this.topColor=b;this.propertyChangeSupport.firePropertyChange("TOP_COLOR",c,b)}};a.prototype.getTopColor=function(){return this.topColor};a.prototype.setTopPaint=function(c){if(c!==this.topPaint){var b=this.topPaint;this.topPaint=c;this.propertyChangeSupport.firePropertyChange("TOP_PAINT",b,c)}};a.prototype.getTopPaint=function(){return this.topPaint};a.prototype.setShape=function(c){if(c!==this.shape){var d=this.shape;this.shape=c;this.propertyChangeSupport.firePropertyChange("SHAPE",d,c);if(c===a.WallShape.RECTANGULAR_WALL){if(this.rectangularWallHeight!=null){this.getLeftSideBaseboardController().setMaxHeight(this.rectangularWallHeight);this.getRightSideBaseboardController().setMaxHeight(this.rectangularWallHeight)}}else{if(c===a.WallShape.SLOPING_WALL){if(this.slopingWallHeightAtStart!=null&&this.sloppingWallHeightAtEnd!=null){var b=Math.max(this.sloppingWallHeightAtEnd,this.slopingWallHeightAtStart);this.getLeftSideBaseboardController().setMaxHeight(b);this.getRightSideBaseboardController().setMaxHeight(b)}else{if(this.slopingWallHeightAtStart!=null){this.getLeftSideBaseboardController().setMaxHeight(this.slopingWallHeightAtStart);this.getRightSideBaseboardController().setMaxHeight(this.slopingWallHeightAtStart)}else{if(this.sloppingWallHeightAtEnd!=null){this.getLeftSideBaseboardController().setMaxHeight(this.sloppingWallHeightAtEnd);this.getRightSideBaseboardController().setMaxHeight(this.sloppingWallHeightAtEnd)}}}}}}};a.prototype.getShape=function(){return this.shape};a.prototype.setRectangularWallHeight=function(b){if(b!==this.rectangularWallHeight){var c=this.rectangularWallHeight;this.rectangularWallHeight=b;this.propertyChangeSupport.firePropertyChange("RECTANGULAR_WALL_HEIGHT",c,b);this.setShape(a.WallShape.RECTANGULAR_WALL);if(b!=null){this.getLeftSideBaseboardController().setMaxHeight(b);this.getRightSideBaseboardController().setMaxHeight(b)}}};a.prototype.getRectangularWallHeight=function(){return this.rectangularWallHeight};a.prototype.setSlopingWallHeightAtStart=function(c){if(c!==this.slopingWallHeightAtStart){var d=this.slopingWallHeightAtStart;this.slopingWallHeightAtStart=c;this.propertyChangeSupport.firePropertyChange("SLOPING_WALL_HEIGHT_AT_START",d,c);this.setShape(a.WallShape.SLOPING_WALL);if(c!=null){var b=this.sloppingWallHeightAtEnd!=null?Math.max(this.sloppingWallHeightAtEnd,c):c;b=Math.max(b,this.preferences.getLengthUnit().getMinimumLength());this.getLeftSideBaseboardController().setMaxHeight(b);this.getRightSideBaseboardController().setMaxHeight(b)}}};a.prototype.getSlopingWallHeightAtStart=function(){return this.slopingWallHeightAtStart};a.prototype.setSlopingWallHeightAtEnd=function(b){if(b!==this.sloppingWallHeightAtEnd){var d=this.sloppingWallHeightAtEnd;this.sloppingWallHeightAtEnd=b;this.propertyChangeSupport.firePropertyChange("SLOPING_WALL_HEIGHT_AT_END",d,b);this.setShape(a.WallShape.SLOPING_WALL);if(b!=null){var c=this.slopingWallHeightAtStart!=null?Math.max(this.slopingWallHeightAtStart,b):b;c=Math.max(c,this.preferences.getLengthUnit().getMinimumLength());this.getLeftSideBaseboardController().setMaxHeight(c);this.getRightSideBaseboardController().setMaxHeight(c)}}};a.prototype.getSlopingWallHeightAtEnd=function(){return this.sloppingWallHeightAtEnd};a.prototype.setThickness=function(c){if(c!==this.thickness){var b=this.thickness;this.thickness=c;this.propertyChangeSupport.firePropertyChange("THICKNESS",b,c)}};a.prototype.getThickness=function(){return this.thickness};a.prototype.setArcExtentInDegrees=function(c){if(c!==this.arcExtentInDegrees){var b=this.arcExtentInDegrees;this.arcExtentInDegrees=c;this.propertyChangeSupport.firePropertyChange("ARC_EXTENT_IN_DEGREES",b,c)}};a.prototype.getArcExtentInDegrees=function(){return this.arcExtentInDegrees};a.prototype.getArcLength=function(){var g=this.getXStart();var e=this.getYStart();var c=this.getXEnd();var f=this.getYEnd();var d=this.getArcExtentInDegrees();if(g!=null&&e!=null&&c!=null&&f!=null&&d!=null){var b=new Wall(g,e,c,f,0.00001,0);b.setArcExtent((function(h){return h*Math.PI/180})(d));return b.getLength()}else{return null}};a.prototype.modifyWalls=function(){var y=this.home.getSelectedItems();var r=Home.getWallsSubList(y);if(!(r.length==0)){var n=this.getXStart();var G=this.getYStart();var s=this.getXEnd();var I=this.getYEnd();var v=this.getLeftSidePaint();var c=v===a.WallPaint.COLORED?this.getLeftSideColor():null;var C=v===a.WallPaint.TEXTURED?this.getLeftSideTextureController().getTexture():null;var f=this.getLeftSideShininess();var F=this.getLeftSideBaseboardController().getVisible();var E=this.getLeftSideBaseboardController().getThickness();var z=this.getLeftSideBaseboardController().getHeight();var l=this.getLeftSideBaseboardController().getPaint();var J=l===BaseboardChoiceController.BaseboardPaint.COLORED?this.getLeftSideBaseboardController().getColor():null;var D=l===BaseboardChoiceController.BaseboardPaint.TEXTURED?this.getLeftSideBaseboardController().getTextureController().getTexture():null;var u=this.getRightSidePaint();var b=u===a.WallPaint.COLORED?this.getRightSideColor():null;var k=u===a.WallPaint.TEXTURED?this.getRightSideTextureController().getTexture():null;var K=this.getRightSideShininess();var p=this.getRightSideBaseboardController().getVisible();var g=this.getRightSideBaseboardController().getThickness();var h=this.getRightSideBaseboardController().getHeight();var H=this.getRightSideBaseboardController().getPaint();var x=H===BaseboardChoiceController.BaseboardPaint.COLORED?this.getRightSideBaseboardController().getColor():null;var j=H===BaseboardChoiceController.BaseboardPaint.TEXTURED?this.getRightSideBaseboardController().getTextureController().getTexture():null;var m=this.getPattern();var B=this.getTopPaint()!=null;var A=this.getTopPaint()===a.WallPaint.COLORED?this.getTopColor():null;var w=this.getThickness();var e=this.getArcExtentInDegrees();if(e!=null){e=(function(N){return N*Math.PI/180})(e)}var d=void 0;if(this.getShape()===a.WallShape.SLOPING_WALL){d=this.getSlopingWallHeightAtStart()}else{if(this.getShape()===a.WallShape.RECTANGULAR_WALL){d=this.getRectangularWallHeight()}else{d=null}}var o=void 0;if(this.getShape()===a.WallShape.SLOPING_WALL){o=this.getSlopingWallHeightAtEnd()}else{if(this.getShape()===a.WallShape.RECTANGULAR_WALL){o=this.getRectangularWallHeight()}else{o=null}}if(d!=null&&o!=null){var L=Math.max(d,o);if(z!=null){z=Math.min(z,L)}if(h!=null){h=Math.min(h,L)}}var q=(function(O){var N=[];while(O-->0){N.push(null)}return N})(r.length);for(var M=0;M<q.length;M++){q[M]=new a.ModifiedWall(r[M])}a.doModifyWalls(q,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),n,G,s,I,v,c,C,f,F,E,z,l,J,D,u,b,k,K,p,g,h,H,x,j,m,B,A,d,o,w,e);if(this.undoSupport!=null){var t=new a.WallsModificationUndoableEdit(this.home,this.preferences,y.slice(0),q,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),n,G,s,I,v,c,C,f,F,E,z,l,J,D,u,b,k,K,p,g,h,H,x,j,m,B,A,d,o,w,e);this.undoSupport.postEdit(t)}}};a.doModifyWalls=function(t,v,h,p,L,w,N,y,c,F,g,K,I,B,n,P,G,x,b,m,Q,r,j,k,M,A,l,o,E,C,e,q,z,f){for(var J=0;J<t.length;J++){var O=t[J];var s=O.getWall();a.moveWallPoints(s,p,L,w,N);if(y!=null){switch((y)){case a.WallPaint.DEFAULT:s.setLeftSideColor(null);s.setLeftSideTexture(null);break;case a.WallPaint.COLORED:if(c!=null){s.setLeftSideColor(c)}s.setLeftSideTexture(null);break;case a.WallPaint.TEXTURED:s.setLeftSideColor(null);if(F!=null){s.setLeftSideTexture(F)}break}}if(g!=null){s.setLeftSideShininess(g)}if(K===false){s.setLeftSideBaseboard(null)}else{var d=s.getLeftSideBaseboard();if(K===true||d!=null){var D=d!=null?d.getThickness():v;var H=d!=null?d.getHeight():h;var R=d!=null?d.getColor():null;var u=d!=null?d.getTexture():null;if(n!=null){switch((n)){case BaseboardChoiceController.BaseboardPaint.DEFAULT:R=null;u=null;break;case BaseboardChoiceController.BaseboardPaint.COLORED:if(P!=null){R=P}u=null;break;case BaseboardChoiceController.BaseboardPaint.TEXTURED:R=null;if(G!=null){u=G}break}}s.setLeftSideBaseboard(Baseboard.getInstance(I!=null?I:D,B!=null?B:H,R,u))}}if(x!=null){switch((x)){case a.WallPaint.DEFAULT:s.setRightSideColor(null);s.setRightSideTexture(null);break;case a.WallPaint.COLORED:if(b!=null){s.setRightSideColor(b)}s.setRightSideTexture(null);break;case a.WallPaint.TEXTURED:s.setRightSideColor(null);if(m!=null){s.setRightSideTexture(m)}break}}if(Q!=null){s.setRightSideShininess(Q)}if(r===false){s.setRightSideBaseboard(null)}else{var d=s.getRightSideBaseboard();if(r===true||d!=null){var D=d!=null?d.getThickness():v;var H=d!=null?d.getHeight():h;var R=d!=null?d.getColor():null;var u=d!=null?d.getTexture():null;if(M!=null){switch((M)){case BaseboardChoiceController.BaseboardPaint.DEFAULT:R=null;u=null;break;case BaseboardChoiceController.BaseboardPaint.COLORED:if(A!=null){R=A}u=null;break;case BaseboardChoiceController.BaseboardPaint.TEXTURED:R=null;if(l!=null){u=l}break}}s.setRightSideBaseboard(Baseboard.getInstance(j!=null?j:D,k!=null?k:H,R,u))}}if(o!=null){s.setPattern(o)}if(E){s.setTopColor(C)}if(e!=null){s.setHeight(e);if(q!=null){if(q===e){s.setHeightAtEnd(null)}else{s.setHeightAtEnd(q)}}}if(z!=null){s.setThickness(z)}if(f!=null){if(f===0){s.setArcExtent(null)}else{s.setArcExtent(f)}}}};a.undoModifyWalls=function(d){for(var e=0;e<d.length;e++){var c=d[e];var b=c.getWall();a.moveWallPoints(b,c.getXStart(),c.getYStart(),c.getXEnd(),c.getYEnd());b.setLeftSideColor(c.getLeftSideColor());b.setLeftSideTexture(c.getLeftSideTexture());b.setLeftSideShininess(c.getLeftSideShininess());b.setLeftSideBaseboard(c.getLeftSideBaseboard());b.setRightSideColor(c.getRightSideColor());b.setRightSideTexture(c.getRightSideTexture());b.setRightSideShininess(c.getRightSideShininess());b.setRightSideBaseboard(c.getRightSideBaseboard());b.setPattern(c.getPattern());b.setTopColor(c.getTopColor());b.setHeight(c.getHeight());b.setHeightAtEnd(c.getHeightAtEnd());b.setThickness(c.getThickness());b.setArcExtent(c.getArcExtent())}};a.moveWallPoints=function(c,g,e,b,f){var d=c.getWallAtStart();if(g!=null){c.setXStart(g);if(d!=null){if(d.getWallAtStart()===c){d.setXStart(g)}else{if(d.getWallAtEnd()===c){d.setXEnd(g)}}}}if(e!=null){c.setYStart(e);if(d!=null){if(d.getWallAtStart()===c){d.setYStart(e)}else{if(d.getWallAtEnd()===c){d.setYEnd(e)}}}}var h=c.getWallAtEnd();if(b!=null){c.setXEnd(b);if(h!=null){if(h.getWallAtStart()===c){h.setXStart(b)}else{if(h.getWallAtEnd()===c){h.setXEnd(b)}}}}if(f!=null){c.setYEnd(f);if(h!=null){if(h.getWallAtStart()===c){h.setYStart(f)}else{if(h.getWallAtEnd()===c){h.setYEnd(f)}}}}};return a}());WallController.__class="com.eteks.sweethome3d.viewcontroller.WallController";WallController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(d){var c;(function(h){h[h.RECTANGULAR_WALL=0]="RECTANGULAR_WALL";h[h.SLOPING_WALL=1]="SLOPING_WALL"})(c=d.WallShape||(d.WallShape={}));var g;(function(h){h[h.DEFAULT=0]="DEFAULT";h[h.COLORED=1]="COLORED";h[h.TEXTURED=2]="TEXTURED"})(g=d.WallPaint||(d.WallPaint={}));var b=(function(j){__extends(h,j);function h(y,M,I,B,C,p,x,R,D,T,G,l,N,o,Q,P,J,v,U,O,F,k,u,V,A,r,s,S,H,t,w,L,K,m,z,E,n){var q=j.call(this,M,d,"undoModifyWallsName")||this;if(q.home===undefined){q.home=null}if(q.oldSelection===undefined){q.oldSelection=null}if(q.modifiedWalls===undefined){q.modifiedWalls=null}if(q.newWallBaseboardThickness===undefined){q.newWallBaseboardThickness=0}if(q.newWallBaseboardHeight===undefined){q.newWallBaseboardHeight=0}if(q.xStart===undefined){q.xStart=null}if(q.yStart===undefined){q.yStart=null}if(q.xEnd===undefined){q.xEnd=null}if(q.yEnd===undefined){q.yEnd=null}if(q.leftSidePaint===undefined){q.leftSidePaint=null}if(q.leftSideColor===undefined){q.leftSideColor=null}if(q.leftSideTexture===undefined){q.leftSideTexture=null}if(q.leftSideShininess===undefined){q.leftSideShininess=null}if(q.leftSideBaseboardVisible===undefined){q.leftSideBaseboardVisible=null}if(q.leftSideBaseboardThickness===undefined){q.leftSideBaseboardThickness=null}if(q.leftSideBaseboardHeight===undefined){q.leftSideBaseboardHeight=null}if(q.leftSideBaseboardPaint===undefined){q.leftSideBaseboardPaint=null}if(q.leftSideBaseboardColor===undefined){q.leftSideBaseboardColor=null}if(q.leftSideBaseboardTexture===undefined){q.leftSideBaseboardTexture=null}if(q.rightSidePaint===undefined){q.rightSidePaint=null}if(q.rightSideColor===undefined){q.rightSideColor=null}if(q.rightSideTexture===undefined){q.rightSideTexture=null}if(q.rightSideShininess===undefined){q.rightSideShininess=null}if(q.rightSideBaseboardVisible===undefined){q.rightSideBaseboardVisible=null}if(q.rightSideBaseboardThickness===undefined){q.rightSideBaseboardThickness=null}if(q.rightSideBaseboardHeight===undefined){q.rightSideBaseboardHeight=null}if(q.rightSideBaseboardPaint===undefined){q.rightSideBaseboardPaint=null}if(q.rightSideBaseboardColor===undefined){q.rightSideBaseboardColor=null}if(q.rightSideBaseboardTexture===undefined){q.rightSideBaseboardTexture=null}if(q.pattern===undefined){q.pattern=null}if(q.modifiedTopColor===undefined){q.modifiedTopColor=false}if(q.topColor===undefined){q.topColor=null}if(q.height===undefined){q.height=null}if(q.heightAtEnd===undefined){q.heightAtEnd=null}if(q.thickness===undefined){q.thickness=null}if(q.arcExtent===undefined){q.arcExtent=null}q.home=y;q.oldSelection=I;q.modifiedWalls=B;q.newWallBaseboardThickness=C;q.newWallBaseboardHeight=p;q.xStart=x;q.yStart=R;q.xEnd=D;q.yEnd=T;q.leftSidePaint=G;q.leftSideColor=l;q.leftSideShininess=o;q.leftSideBaseboardVisible=Q;q.leftSideBaseboardThickness=P;q.leftSideBaseboardHeight=J;q.leftSideBaseboardPaint=v;q.leftSideBaseboardColor=U;q.leftSideBaseboardTexture=O;q.rightSidePaint=F;q.rightSideColor=k;q.rightSideTexture=u;q.leftSideTexture=N;q.rightSideShininess=V;q.rightSideBaseboardVisible=A;q.rightSideBaseboardThickness=r;q.rightSideBaseboardHeight=s;q.rightSideBaseboardPaint=S;q.rightSideBaseboardColor=H;q.rightSideBaseboardTexture=t;q.pattern=w;q.modifiedTopColor=L;q.topColor=K;q.height=m;q.heightAtEnd=z;q.thickness=E;q.arcExtent=n;return q}h.prototype.undo=function(){j.prototype.undo.call(this);d.undoModifyWalls(this.modifiedWalls);this.home.setSelectedItems(this.oldSelection.slice(0))};h.prototype.redo=function(){j.prototype.redo.call(this);d.doModifyWalls(this.modifiedWalls,this.newWallBaseboardThickness,this.newWallBaseboardHeight,this.xStart,this.yStart,this.xEnd,this.yEnd,this.leftSidePaint,this.leftSideColor,this.leftSideTexture,this.leftSideShininess,this.leftSideBaseboardVisible,this.leftSideBaseboardThickness,this.leftSideBaseboardHeight,this.leftSideBaseboardPaint,this.leftSideBaseboardColor,this.leftSideBaseboardTexture,this.rightSidePaint,this.rightSideColor,this.rightSideTexture,this.rightSideShininess,this.rightSideBaseboardVisible,this.rightSideBaseboardThickness,this.rightSideBaseboardHeight,this.rightSideBaseboardPaint,this.rightSideBaseboardColor,this.rightSideBaseboardTexture,this.pattern,this.modifiedTopColor,this.topColor,this.height,this.heightAtEnd,this.thickness,this.arcExtent);this.home.setSelectedItems(this.oldSelection.slice(0))};return h}(LocalizedUndoableEdit));d.WallsModificationUndoableEdit=b;b.__class="com.eteks.sweethome3d.viewcontroller.WallController.WallsModificationUndoableEdit";b.__interfaces=["javax.swing.undo.UndoableEdit"];var a=(function(){function h(j){if(this.wall===undefined){this.wall=null}if(this.xStart===undefined){this.xStart=0}if(this.yStart===undefined){this.yStart=0}if(this.xEnd===undefined){this.xEnd=0}if(this.yEnd===undefined){this.yEnd=0}if(this.leftSideColor===undefined){this.leftSideColor=null}if(this.leftSideTexture===undefined){this.leftSideTexture=null}if(this.leftSideShininess===undefined){this.leftSideShininess=0}if(this.leftSideBaseboard===undefined){this.leftSideBaseboard=null}if(this.rightSideColor===undefined){this.rightSideColor=null}if(this.rightSideTexture===undefined){this.rightSideTexture=null}if(this.rightSideShininess===undefined){this.rightSideShininess=0}if(this.rightSideBaseboard===undefined){this.rightSideBaseboard=null}if(this.pattern===undefined){this.pattern=null}if(this.topColor===undefined){this.topColor=null}if(this.height===undefined){this.height=null}if(this.heightAtEnd===undefined){this.heightAtEnd=null}if(this.thickness===undefined){this.thickness=0}if(this.arcExtent===undefined){this.arcExtent=null}this.wall=j;this.xStart=j.getXStart();this.yStart=j.getYStart();this.xEnd=j.getXEnd();this.yEnd=j.getYEnd();this.leftSideColor=j.getLeftSideColor();this.leftSideTexture=j.getLeftSideTexture();this.leftSideShininess=j.getLeftSideShininess();this.leftSideBaseboard=j.getLeftSideBaseboard();this.rightSideColor=j.getRightSideColor();this.rightSideTexture=j.getRightSideTexture();this.rightSideShininess=j.getRightSideShininess();this.rightSideBaseboard=j.getRightSideBaseboard();this.pattern=j.getPattern();this.topColor=j.getTopColor();this.height=j.getHeight();this.heightAtEnd=j.getHeightAtEnd();this.thickness=j.getThickness();this.arcExtent=j.getArcExtent()}h.prototype.getWall=function(){return this.wall};h.prototype.getXStart=function(){return this.xStart};h.prototype.getXEnd=function(){return this.xEnd};h.prototype.getYStart=function(){return this.yStart};h.prototype.getYEnd=function(){return this.yEnd};h.prototype.getHeight=function(){return this.height};h.prototype.getHeightAtEnd=function(){return this.heightAtEnd};h.prototype.getLeftSideColor=function(){return this.leftSideColor};h.prototype.getLeftSideTexture=function(){return this.leftSideTexture};h.prototype.getLeftSideShininess=function(){return this.leftSideShininess};h.prototype.getLeftSideBaseboard=function(){return this.leftSideBaseboard};h.prototype.getRightSideColor=function(){return this.rightSideColor};h.prototype.getRightSideTexture=function(){return this.rightSideTexture};h.prototype.getRightSideShininess=function(){return this.rightSideShininess};h.prototype.getRightSideBaseboard=function(){return this.rightSideBaseboard};h.prototype.getPattern=function(){return this.pattern};h.prototype.getTopColor=function(){return this.topColor};h.prototype.getThickness=function(){return this.thickness};h.prototype.getArcExtent=function(){return this.arcExtent};return h}());d.ModifiedWall=a;a.__class="com.eteks.sweethome3d.viewcontroller.WallController.ModifiedWall";var f=(function(){function h(j){this.__parent=j}h.prototype.propertyChange=function(j){this.__parent.setLeftSidePaint(d.WallPaint.TEXTURED)};return h}());d.WallController$0=f;var e=(function(){function h(j){this.__parent=j}h.prototype.propertyChange=function(j){this.__parent.setRightSidePaint(d.WallPaint.TEXTURED)};return h}());d.WallController$1=e})(WallController||(WallController={}));var FurnitureController=(function(){function a(g,d,f,h,b){if(((g!=null&&g instanceof Home)||g===null)&&((d!=null&&d instanceof UserPreferences)||d===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||f===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||h===null)&&((b!=null&&b instanceof javax.swing.undo.UndoableEditSupport)||b===null)){var e=arguments;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.furnitureView===undefined){this.furnitureView=null}if(this.leadSelectedPieceOfFurniture===undefined){this.leadSelectedPieceOfFurniture=null}this.home=g;this.preferences=d;this.viewFactory=f;this.undoSupport=b;this.contentManager=h;this.addModelListeners()}else{if(((g!=null&&g instanceof Home)||g===null)&&((d!=null&&d instanceof UserPreferences)||d===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||f===null)&&h===undefined&&b===undefined){var e=arguments;var c=arguments;var k=null;var j=null;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.furnitureView===undefined){this.furnitureView=null}if(this.leadSelectedPieceOfFurniture===undefined){this.leadSelectedPieceOfFurniture=null}this.home=g;this.preferences=d;this.viewFactory=f;this.undoSupport=j;this.contentManager=k;this.addModelListeners();if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.furnitureView===undefined){this.furnitureView=null}if(this.leadSelectedPieceOfFurniture===undefined){this.leadSelectedPieceOfFurniture=null}}else{throw new Error("invalid overload")}}}a.prototype.getView=function(){if(this.furnitureView==null){this.furnitureView=this.viewFactory.createFurnitureView(this.home,this.preferences,this)}return this.furnitureView};a.prototype.addModelListeners=function(){this.home.addSelectionListener(new a.FurnitureController$0(this));var d=new a.FurnitureController$1(this);var h=this.home.getFurniture();for(var c=0;c<h.length;c++){var e=h[c];e.addPropertyChangeListener(d);if(e!=null&&e instanceof HomeFurnitureGroup){var f=e.getAllFurniture();for(var g=0;g<f.length;g++){var b=f[g];b.addPropertyChangeListener(d)}}}this.home.addFurnitureListener(function(m){var l=m.getItem();if(m.getType()===CollectionEvent.Type.ADD){l.addPropertyChangeListener(d);if(l!=null&&l instanceof HomeFurnitureGroup){var n=l.getAllFurniture();for(var k=0;k<n.length;k++){var j=n[k];j.addPropertyChangeListener(d)}}}else{if(m.getType()===CollectionEvent.Type.DELETE){l.removePropertyChangeListener(d);if(l!=null&&l instanceof HomeFurnitureGroup){var n=l.getAllFurniture();for(var k=0;k<n.length;k++){var j=n[k];j.removePropertyChangeListener(d)}}}}})};a.prototype.addFurniture$java_util_List=function(b){this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(b,null,null,null)};a.prototype.addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(c,b){this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(c,null,null,b)};a.prototype.addFurnitureToGroup=function(b,c){if(c==null){throw new IllegalArgumentException("Group shouldn't be null")}this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(b,null,c,null)};a.prototype.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(j,q,e,m){var n=this.home.isBasePlanLocked();var f=this.home.isAllLevelsSelection();var p=this.home.getSelectedItems();var d=j.slice(0);var t=(function(v){var u=[];while(v-->0){u.push(0)}return u})(j.length);var s=e==null?this.home.getFurniture().length:e.getFurniture().length;if(m!=null){var g=this.home.getFurniture();e=a.getPieceOfFurnitureGroup(m,null,g);if(e!=null){g=e.getFurniture()}s=g.indexOf(m)}var k=e!=null?(function(v){var u=[];while(v-->0){u.push(null)}return u})(j.length):null;var r=n;var l=e!=null||q==null;for(var o=0;o<t.length;o++){t[o]=s++;r=!this.isPieceOfFurniturePartOfBasePlan(d[o])&&r;if(q!=null){l=q[o]==null||l}if(k!=null){k[o]=e}}var b=l?null:q;var h=r;var c=e!=null?e.getLevel():this.home.getSelectedLevel();a.doAddFurniture(this.home,d,k,t,c,b,h,false);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureAdditionUndoableEdit(this.home,this.preferences,p.slice(0),n,f,d,t,k,b,c,h))}};a.prototype.addFurniture=function(d,b,e,c){if(((d!=null&&(d instanceof Array))||d===null)&&((b!=null&&b instanceof Array&&(b.length==0||b[0]==null||(b[0]!=null&&b[0] instanceof Level)))||b===null)&&((e!=null&&e instanceof HomeFurnitureGroup)||e===null)&&((c!=null&&c instanceof HomePieceOfFurniture)||c===null)){return this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(d,b,e,c)}else{if(((d!=null&&(d instanceof Array))||d===null)&&((b!=null&&b instanceof HomePieceOfFurniture)||b===null)&&e===undefined&&c===undefined){return this.addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(d,b)}else{if(((d!=null&&(d instanceof Array))||d===null)&&b===undefined&&e===undefined&&c===undefined){return this.addFurniture$java_util_List(d)}else{throw new Error("invalid overload")}}}};a.doAddFurniture=function(j,g,c,b,f,k,e,h){for(var d=0;d<b.length;d++){if(c!=null&&c[d]!=null){j.addPieceOfFurnitureToGroup(g[d],c[d],b[d]);g[d].setVisible(c[d].isVisible())}else{j.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(g[d],b[d])}g[d].setLevel(k!=null?k[d]:f)}j.setBasePlanLocked(e);j.setSelectedItems(g.slice(0));j.setAllLevelsSelection(h)};a.prototype.deleteSelection=function(){this.deleteFurniture(Home.getFurnitureSubList(this.home.getSelectedItems()))};a.prototype.deleteFurniture=function(b){var y=this.home.isBasePlanLocked();var r=this.home.isAllLevelsSelection();var w=this.home.getSelectedItems();var q=this.home.getFurniture();b=(b.slice(0));var e=([]);a.searchGroups(q,e);var v;do{v=false;for(var h=0;h<e.length;h++){var n=e[h];var l=n.getFurniture();if((function(B,C){for(var A=0;A<C.length;A++){if(B.indexOf(C[A])<0){return false}}return true})(b,l)){(function(C,E){var B=false;for(var A=0;A<E.length;A++){var D=C.indexOf(E[A]);if(D>=0){C.splice(D,1);B=true}}return B})(b,l);(b.push(n)>0);v=true}}}while((v));var t=({});var o=0;for(var h=0;h<b.length;h++){var f=b[h];if(this.isPieceOfFurnitureDeletable(f)){var n=a.getPieceOfFurnitureGroup(f,null,q);var d=(function(A,B){if(A.entries==null){A.entries=[]}for(var C=0;C<A.entries.length;C++){if(A.entries[C].key==null&&B==null||A.entries[C].key.equals!=null&&A.entries[C].key.equals(B)||A.entries[C].key===B){return A.entries[C].value}}return null})(t,n);if(d==null){d=({});(function(A,C,B){if(A.entries==null){A.entries=[]}for(var D=0;D<A.entries.length;D++){if(A.entries[D].key==null&&C==null||A.entries[D].key.equals!=null&&A.entries[D].key.equals(C)||A.entries[D].key===C){A.entries[D].value=B;return}}A.entries.push({key:C,value:B,getKey:function(){return this.key},getValue:function(){return this.value}})})(t,n,d)}if(n==null){(function(A,C,B){if(A.entries==null){A.entries=[]}for(var D=0;D<A.entries.length;D++){if(A.entries[D].key.equals!=null&&A.entries[D].key.equals(C)||A.entries[D].key===C){var E=A.entries[D].value;A.entries[D].value=B;return E}}A.entries.push({key:C,value:B,getKey:function(){return this.key},getValue:function(){return this.value}});A.entries.sort(function(G,F){return(G.key.compareTo!=null)?G.key.compareTo(F):(G.key-F.key)});return null})(d,q.indexOf(f),f)}else{(function(A,C,B){if(A.entries==null){A.entries=[]}for(var D=0;D<A.entries.length;D++){if(A.entries[D].key.equals!=null&&A.entries[D].key.equals(C)||A.entries[D].key===C){var E=A.entries[D].value;A.entries[D].value=B;return E}}A.entries.push({key:C,value:B,getKey:function(){return this.key},getValue:function(){return this.value}});A.entries.sort(function(G,F){return(G.key.compareTo!=null)?G.key.compareTo(F):(G.key-F.key)});return null})(d,n.getFurniture().indexOf(f),f)}o++}}var s=(function(B){var A=[];while(B-->0){A.push(null)}return A})(o);var j=(function(B){var A=[];while(B-->0){A.push(0)}return A})(s.length);var x=(function(B){var A=[];while(B-->0){A.push(null)}return A})(s.length);var p=(function(B){var A=[];while(B-->0){A.push(null)}return A})(s.length);var u=0;var k=(function(A){if(A.entries==null){A.entries=[]}return A.entries})(t);for(var h=0;h<k.length;h++){var m=k[h];var z=(function(A){if(A.entries==null){A.entries=[]}return A.entries})(m.getValue());for(var g=0;g<z.length;g++){var c=z[g];s[u]=c.getValue();j[u]=c.getKey();x[u]=s[u].getLevel();p[u++]=m.getKey()}}a.doDeleteFurniture(this.home,s,y,false);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureDeletionUndoableEdit(this.home,this.preferences,w.slice(0),y,r,s,j,p,x))}};a.doDeleteFurniture=function(g,f,b,d){for(var c=0;c<f.length;c++){var e=f[c];g.deletePieceOfFurniture(e)}g.setBasePlanLocked(b);g.setAllLevelsSelection(d)};a.searchGroups=function(e,b){for(var c=0;c<e.length;c++){var d=e[c];if(d!=null&&d instanceof HomeFurnitureGroup){(b.push(d)>0);a.searchGroups(d.getFurniture(),b)}}};a.getPieceOfFurnitureGroup=function(d,c,f){for(var b=0;b<f.length;b++){var e=f[b];if((function(j,h){if(j&&j.equals){return j.equals(h)}else{return j===h}})(e,d)){return c}else{if(e!=null&&e instanceof HomeFurnitureGroup){var g=a.getPieceOfFurnitureGroup(d,e,e.getFurniture());if(g!=null){return g}}}}return null};a.prototype.moveSelectedFurnitureBefore=function(d){var b=Home.getFurnitureSubList(this.home.getSelectedItems());if(!(b.length==0)){var c=(function(g){var f=[];while(g-->0){f.push(null)}return f})(b.length);for(var e=0;e<c.length;e++){c[e]=b[e].getLevel()}this.undoSupport.beginUpdate();this.deleteFurniture(b);this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(b,c,null,d);this.undoSupport.postEdit(new LocalizedUndoableEdit(this.preferences,a,"undoReorderName"));this.undoSupport.endUpdate()}};a.prototype.setSelectedFurniture$java_util_List=function(b){this.setSelectedFurniture$java_util_List$boolean(b,true)};a.prototype.setSelectedFurniture$java_util_List$boolean=function(b,f){if(this.home.isBasePlanLocked()){b=this.getFurnitureNotPartOfBasePlan(b)}if(f){this.home.setSelectedItems(b);this.home.setAllLevelsSelection(false)}else{var g=(this.home.getSelectedItems().slice(0));b=(b.slice(0));for(var d=g.length-1;d>=0;d--){var e=g[d];if(e!=null&&e instanceof HomePieceOfFurniture){var c=b.indexOf(e);if(c>=0){b.splice(c,1)[0]}else{g.splice(d,1)[0]}}}(function(j,h){return j.push.apply(j,h)})(g,b);this.home.setSelectedItems(g)}};a.prototype.setSelectedFurniture=function(b,c){if(((b!=null&&(b instanceof Array))||b===null)&&((typeof c==="boolean")||c===null)){return this.setSelectedFurniture$java_util_List$boolean(b,c)}else{if(((b!=null&&(b instanceof Array))||b===null)&&c===undefined){return this.setSelectedFurniture$java_util_List(b)}else{throw new Error("invalid overload")}}};a.prototype.selectAll=function(){this.setSelectedFurniture$java_util_List(this.home.getFurniture())};a.prototype.isPieceOfFurniturePartOfBasePlan=function(b){return !b.isMovable()||b.isDoorOrWindow()};a.prototype.isPieceOfFurnitureMovable=function(b){return true};a.prototype.isPieceOfFurnitureDeletable=function(b){return true};a.prototype.createHomePieceOfFurniture=function(b){if(b!=null&&(b.constructor!=null&&b.constructor.__interfaces!=null&&b.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0)){return new HomeDoorOrWindow(b)}else{if(b!=null&&(b.constructor!=null&&b.constructor.__interfaces!=null&&b.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0)){return new HomeLight(b)}else{return new HomePieceOfFurniture(b)}}};a.prototype.getFurnitureNotPartOfBasePlan=function(e){var c=([]);for(var b=0;b<e.length;b++){var d=e[b];if(!this.isPieceOfFurniturePartOfBasePlan(d)){(c.push(d)>0)}}return c};a.prototype.toggleFurnitureSort=function(b){if((b==this.home.getFurnitureSortedProperty())){this.home.setFurnitureSortedProperty(null)}else{this.home.setFurnitureSortedProperty(b)}};a.prototype.toggleFurnitureSortOrder=function(){this.home.setFurnitureDescendingSorted(!this.home.isFurnitureDescendingSorted())};a.prototype.sortFurniture=function(d){var c=this.home.getFurnitureSortedProperty();var b=this.home.isFurnitureDescendingSorted();var e=false;if((d==c)){if(b){d=null}else{e=true}}this.home.setFurnitureSortedProperty(d);this.home.setFurnitureDescendingSorted(e)};a.prototype.setFurnitureVisibleProperties=function(b){this.home.setFurnitureVisibleProperties(b)};a.prototype.toggleFurnitureVisibleProperty=function(c){var d=(this.home.getFurnitureVisibleProperties().slice(0));if((d.indexOf((c))>=0)){(function(g){var h=g.indexOf(c);if(h>=0){g.splice(h,1);return true}else{return false}})(d);if((d.length==0)){(d.push("NAME")>0)}}else{var f=["CATALOG_ID","NAME","CREATOR","WIDTH","DEPTH","HEIGHT","X","Y","ELEVATION","ANGLE","LEVEL","MODEL_SIZE","COLOR","TEXTURE","MOVABLE","DOOR_OR_WINDOW","VISIBLE","PRICE","VALUE_ADDED_TAX_PERCENTAGE","VALUE_ADDED_TAX","PRICE_VALUE_ADDED_TAX_INCLUDED"].slice(0);var e=f.indexOf(c)-1;if(e>0){while((e>0)){var b=d.indexOf(f[e]);if(b>=0){e=b+1;break}else{e--}}}if(e<0){e=0}d.splice(e,0,c)}this.home.setFurnitureVisibleProperties(d)};a.prototype.modifySelectedFurniture=function(){if(!(Home.getFurnitureSubList(this.home.getSelectedItems()).length==0)){new HomeFurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())}};a.prototype.toggleSelectedFurnitureVisibility=function(){if(Home.getFurnitureSubList(this.home.getSelectedItems()).length===1){var b=new HomeFurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,this.undoSupport);b.setVisible(!b.getVisible());b.modifyFurniture()}};a.prototype.groupSelectedFurniture=function(){var B=this.getMovableSelectedFurniture();if(B.length>0){var D=this.home.isBasePlanLocked();var r=this.home.isAllLevelsSelection();var z=this.home.getSelectedItems();var o=this.home.getFurniture();var t=({});var v=0;for(var k=0;k<B.length;k++){var f=B[k];var n=a.getPieceOfFurnitureGroup(f,null,o);var c=(function(H,I){if(H.entries==null){H.entries=[]}for(var J=0;J<H.entries.length;J++){if(H.entries[J].key==null&&I==null||H.entries[J].key.equals!=null&&H.entries[J].key.equals(I)||H.entries[J].key===I){return H.entries[J].value}}return null})(t,n);if(c==null){c=({});(function(H,K,J){if(H.entries==null){H.entries=[]}for(var I=0;I<H.entries.length;I++){if(H.entries[I].key==null&&K==null||H.entries[I].key.equals!=null&&H.entries[I].key.equals(K)||H.entries[I].key===K){H.entries[I].value=J;return}}H.entries.push({key:K,value:J,getKey:function(){return this.key},getValue:function(){return this.value}})})(t,n,c)}if(n==null){(function(H,J,I){if(H.entries==null){H.entries=[]}for(var K=0;K<H.entries.length;K++){if(H.entries[K].key.equals!=null&&H.entries[K].key.equals(J)||H.entries[K].key===J){var L=H.entries[K].value;H.entries[K].value=I;return L}}H.entries.push({key:J,value:I,getKey:function(){return this.key},getValue:function(){return this.value}});H.entries.sort(function(N,M){return(N.key.compareTo!=null)?N.key.compareTo(M):(N.key-M.key)});return null})(c,o.indexOf(f),f)}else{(function(H,J,I){if(H.entries==null){H.entries=[]}for(var K=0;K<H.entries.length;K++){if(H.entries[K].key.equals!=null&&H.entries[K].key.equals(J)||H.entries[K].key===J){var L=H.entries[K].value;H.entries[K].value=I;return L}}H.entries.push({key:J,value:I,getKey:function(){return this.key},getValue:function(){return this.value}});H.entries.sort(function(N,M){return(N.key.compareTo!=null)?N.key.compareTo(M):(N.key-M.key)});return null})(c,n.getFurniture().indexOf(f),f)}v++}var s=(function(I){var H=[];while(I-->0){H.push(null)}return H})(v);var y=(function(I){var H=[];while(I-->0){H.push(0)}return H})(s.length);var q=(function(I){var H=[];while(I-->0){H.push(null)}return H})(s.length);var u=(function(I){var H=[];while(I-->0){H.push(0)}return H})(s.length);var p=(function(I){var H=[];while(I-->0){H.push(false)}return H})(s.length);var j=(function(I){var H=[];while(I-->0){H.push(null)}return H})(s.length);var E=this.home.getSelectedLevel();var x=0;var l=(function(H){if(H.entries==null){H.entries=[]}return H.entries})(t);for(var k=0;k<l.length;k++){var m=l[k];var G=(function(H){if(H.entries==null){H.entries=[]}return H.entries})(m.getValue());for(var h=0;h<G.length;h++){var b=G[h];var f=b.getValue();s[x]=f;y[x]=b.getKey();q[x]=f.getLevel();u[x]=f.getElevation();p[x]=f.isVisible();j[x]=m.getKey();if(q[x]!=null){if(E==null||q[x].getElevation()<E.getElevation()){E=q[x]}}x++}}var g=void 0;var A=s.slice(0);if(A.indexOf(this.leadSelectedPieceOfFurniture)>0){g=this.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(A,this.leadSelectedPieceOfFurniture)}else{g=this.createHomeFurnitureGroup$java_util_List(A)}var w=(function(I){var H=[];while(I-->0){H.push(0)}return H})(s.length);x=0;for(var k=0;k<s.length;k++){var f=s[k];w[x++]=f.getElevation()}var F=(function(H,J){if(H.entries==null){H.entries=[]}for(var I=0;I<H.entries.length;I++){if(H.entries[I].key==null&&J==null||H.entries[I].key.equals!=null&&H.entries[I].key.equals(J)||H.entries[I].key===J){return H.entries[I].value}}return null})(t,null);var e=F!=null?(function(H){return H.entries[H.entries.length-1].key})(F)+1-s.length:o.length;var d=g.isMovable();var C=E;a.doGroupFurniture(this.home,s,[g],null,[e],[C],D,false);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureGroupingUndoableEdit(this.home,this.preferences,z.slice(0),D,r,s,y,j,q,u,p,g,e,C,w,d))}}};a.prototype.createHomeFurnitureGroup$java_util_List=function(b){return this.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(b,b[0])};a.prototype.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(e,d){var b=this.preferences.getLocalizedString(a,"groupName",a.getFurnitureGroupCount(this.home.getFurniture())+1);var c=new HomeFurnitureGroup(e,d,b);return c};a.prototype.createHomeFurnitureGroup=function(c,b){if(((c!=null&&(c instanceof Array))||c===null)&&((b!=null&&b instanceof HomePieceOfFurniture)||b===null)){return this.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(c,b)}else{if(((c!=null&&(c instanceof Array))||c===null)&&b===undefined){return this.createHomeFurnitureGroup$java_util_List(c)}else{throw new Error("invalid overload")}}};a.getFurnitureGroupCount=function(e){var c=0;for(var b=0;b<e.length;b++){var d=e[b];if(d!=null&&d instanceof HomeFurnitureGroup){c+=1+a.getFurnitureGroupCount(d.getFurniture())}}return c};a.doGroupFurniture=function(j,h,d,g,c,e,b,f){a.doDeleteFurniture(j,h,b,f);a.doAddFurniture(j,d,g,c,null,e,b,f)};a.doUngroupFurniture=function(j,c,f,h,g,e,b,d){a.doDeleteFurniture(j,c,b,d);a.doAddFurniture(j,f,h,g,null,e,b,d)};a.prototype.ungroupSelectedFurniture=function(){var t=([]);var f=this.home.getSelectedItems();for(var A=0;A<f.length;A++){var y=f[A];if(y!=null&&y instanceof HomeFurnitureGroup){var r=y;if(this.isPieceOfFurnitureMovable(r)){(t.push(r)>0)}}}if(!(t.length==0)){var n=this.home.getFurniture();var j=this.home.isBasePlanLocked();var p=this.home.isAllLevelsSelection();var o=this.home.getSelectedItems();var k=({});var l=0;for(var A=0;A<t.length;A++){var q=t[A];var J=a.getPieceOfFurnitureGroup(q,null,n);var w=(function(N,O){if(N.entries==null){N.entries=[]}for(var M=0;M<N.entries.length;M++){if(N.entries[M].key==null&&O==null||N.entries[M].key.equals!=null&&N.entries[M].key.equals(O)||N.entries[M].key===O){return N.entries[M].value}}return null})(k,J);if(w==null){w=({});(function(M,O,N){if(M.entries==null){M.entries=[]}for(var P=0;P<M.entries.length;P++){if(M.entries[P].key==null&&O==null||M.entries[P].key.equals!=null&&M.entries[P].key.equals(O)||M.entries[P].key===O){M.entries[P].value=N;return}}M.entries.push({key:O,value:N,getKey:function(){return this.key},getValue:function(){return this.value}})})(k,J,w)}if(J==null){(function(M,O,N){if(M.entries==null){M.entries=[]}for(var P=0;P<M.entries.length;P++){if(M.entries[P].key.equals!=null&&M.entries[P].key.equals(O)||M.entries[P].key===O){var Q=M.entries[P].value;M.entries[P].value=N;return Q}}M.entries.push({key:O,value:N,getKey:function(){return this.key},getValue:function(){return this.value}});M.entries.sort(function(S,R){return(S.key.compareTo!=null)?S.key.compareTo(R):(S.key-R.key)});return null})(w,n.indexOf(q),q)}else{(function(M,O,N){if(M.entries==null){M.entries=[]}for(var P=0;P<M.entries.length;P++){if(M.entries[P].key.equals!=null&&M.entries[P].key.equals(O)||M.entries[P].key===O){var Q=M.entries[P].value;M.entries[P].value=N;return Q}}M.entries.push({key:O,value:N,getKey:function(){return this.key},getValue:function(){return this.value}});M.entries.sort(function(S,R){return(S.key.compareTo!=null)?S.key.compareTo(R):(S.key-R.key)});return null})(w,J.getFurniture().indexOf(q),q)}l++}var h=(function(N){var M=[];while(N-->0){M.push(null)}return M})(l);var L=(function(N){var M=[];while(N-->0){M.push(null)}return M})(h.length);var d=(function(N){var M=[];while(N-->0){M.push(0)}return M})(h.length);var b=(function(N){var M=[];while(N-->0){M.push(null)}return M})(h.length);var I=0;var B=([]);var z=([]);var D=([]);var f=(function(M){if(M.entries==null){M.entries=[]}return M.entries})(k);for(var A=0;A<f.length;A++){var G=f[A];var w=G.getValue();var g=(function(M){return M.entries[M.entries.length-1].key})(w)+1-(function(M){if(M.entries==null){M.entries=[]}return M.entries.length})(w);var u=(function(M){if(M.entries==null){M.entries=[]}return M.entries})(w);for(var F=0;F<u.length;F++){var c=u[F];var r=c.getValue();h[I]=r;L[I]=G.getKey();d[I]=c.getKey();b[I++]=r.getLevel();var s=r.getFurniture();for(var E=0;E<s.length;E++){var H=s[E];(B.push(H)>0);(D.push(G.getKey())>0);(z.push(g++)>0)}}}var v=B.slice(0);var C=D.slice(0);var x=(function(N){var M=[];while(N-->0){M.push(0)}return M})(v.length);var K=(function(N){var M=[];while(N-->0){M.push(null)}return M})(v.length);var e=j;for(I=0;I<v.length;I++){x[I]=z[I];K[I]=v[I].getLevel();e=!this.isPieceOfFurniturePartOfBasePlan(v[I])&&e}var m=e;a.doUngroupFurniture(this.home,h,v,C,x,K,m,false);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureUngroupingUndoableEdit(this.home,this.preferences,o.slice(0),j,p,h,d,L,b,v,x,C,K,m))}}};a.prototype.importFurniture$=function(){new ImportedFurnitureWizardController(this.home,this.preferences,this,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())};a.prototype.importFurniture$java_lang_String=function(b){new ImportedFurnitureWizardController(this.home,b,this.preferences,this,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())};a.prototype.importFurniture=function(b){if(((typeof b==="string")||b===null)){return this.importFurniture$java_lang_String(b)}else{if(b===undefined){return this.importFurniture$()}else{throw new Error("invalid overload")}}};a.prototype.alignSelectedFurnitureOnTop=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureTopAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnBottom=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureBottomAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnLeft=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureLeftAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnRight=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureRightAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnFrontSide=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureFrontSideAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnBackSide=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureBackSideAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnLeftSide=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureLeftSideAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnRightSide=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureRightSideAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureSideBySide=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureSideBySideAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.sortFurniture=function(d,e,c){var b=([]);if(e!=null){(b.push(e)>0)}(function(g,f){return g.push.apply(g,f)})(b,d.slice(0));(function(f,g){if(g.compare){f.sort(function(j,h){return g.compare(j,h)})}else{f.sort(g)}})(b,new a.FurnitureController$2(c));return b};a.alignPieceOfFurnitureAlongSides=function(o,j,h,n,l,m){var b=h.relativeCCW(o.getX(),o.getY())*h.ptLineDist(o.getX(),o.getY())+a.getPieceBoundingRectangleHeight(o,-j.getAngle())/2;if(n){b=-b}var g=Math.sin(j.getAngle());var k=Math.cos(j.getAngle());var e=(-b*g);var c=(b*k);var d=a.getPieceBoundingRectangleWidth(o,-j.getAngle());if(l!=null){var f=l.relativeCCW(o.getX(),o.getY());if(f===0){f=n?1:-1}b=m+f*(l.ptLineDist(o.getX(),o.getY())-d/2);e+=(b*k);c+=(b*g)}o.move(e,c);return d};a.alignPieceOfFurnitureAlongLeftOrRightSides=function(c,e,b,d){var f=b.relativeCCW(c.getX(),c.getY())*b.ptLineDist(c.getX(),c.getY())+a.getPieceBoundingRectangleWidth(c,-e.getAngle())/2;if(d){f=-f}c.move((f*Math.cos(e.getAngle())),(f*Math.sin(e.getAngle())))};a.getPieceBoundingRectangleWidth=function(c,b){return Math.abs(c.getWidthInPlan()*Math.cos(b+c.getAngle()))+Math.abs(c.getDepthInPlan()*Math.sin(b+c.getAngle()))};a.getPieceBoundingRectangleHeight=function(c,b){return Math.abs(c.getWidthInPlan()*Math.sin(b+c.getAngle()))+Math.abs(c.getDepthInPlan()*Math.cos(b+c.getAngle()))};a.prototype.alignSelectedFurniture=function(c){var b=this.getMovableSelectedFurniture();if(b.length>=2){this.home.setSelectedItems(b.slice(0));c.alignFurniture$();if(this.undoSupport!=null){this.undoSupport.postEdit(c)}}};a.prototype.getMovableSelectedFurniture=function(){var e=([]);var f=this.home.getSelectedItems();for(var b=0;b<f.length;b++){var d=f[b];if(d!=null&&d instanceof HomePieceOfFurniture){var c=d;if(this.isPieceOfFurnitureMovable(c)){(e.push(c)>0)}}}return e.slice(0)};a.undoAlignFurniture=function(c,b,f){for(var d=0;d<c.length;d++){var e=c[d];e.setX(b[d]);e.setY(f[d])}};a.getMinX=function(f){var e=f.getPoints();var c=Infinity;for(var d=0;d<e.length;d++){var b=e[d];c=Math.min(c,b[0])}return c};a.getMaxX=function(e){var d=e.getPoints();var f=-Infinity;for(var c=0;c<d.length;c++){var b=d[c];f=Math.max(f,b[0])}return f};a.getMinY=function(e){var d=e.getPoints();var f=Infinity;for(var c=0;c<d.length;c++){var b=d[c];f=Math.min(f,b[1])}return f};a.getMaxY=function(e){var d=e.getPoints();var f=-Infinity;for(var c=0;c<d.length;c++){var b=d[c];f=Math.max(f,b[1])}return f};a.prototype.distributeSelectedFurnitureHorizontally=function(){this.distributeSelectedFurniture(true)};a.prototype.distributeSelectedFurnitureVertically=function(){this.distributeSelectedFurniture(false)};a.prototype.distributeSelectedFurniture=function(d){var b=this.getMovableSelectedFurniture();if(b.length>=3){var c=this.home.getSelectedItems();var g=(function(j){var h=[];while(j-->0){h.push(0)}return h})(b.length);var f=(function(j){var h=[];while(j-->0){h.push(0)}return h})(b.length);for(var e=0;e<b.length;e++){g[e]=b[e].getX();f[e]=b[e].getY()}this.home.setSelectedItems(b.slice(0));a.doDistributeFurnitureAlongAxis(b,d);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureDistributionUndoableEdit(this.home,this.preferences,c.slice(0),g,f,b,d))}}};a.doDistributeFurnitureAlongAxis=function(e,b){var n=b?new java.awt.geom.Line2D.Float(0,0,0,-1):new java.awt.geom.Line2D.Float(0,0,1,0);var c=a.sortFurniture(e,null,n);var j=(b?0:Math.PI/2);var h=c[0];var g=a.getPieceBoundingRectangleWidth(h,j)/2;var o=c[c.length-1];var m=a.getPieceBoundingRectangleWidth(o,j)/2;var k=Math.abs(n.ptLineDist(o.getX(),o.getY())*n.relativeCCW(o.getX(),o.getY())-n.ptLineDist(h.getX(),h.getY())*n.relativeCCW(h.getX(),h.getY()))-m-g;var l=(function(r){var q=[];while(r-->0){q.push(0)}return q})(c.length-2);for(var f=1;f<c.length-1;f++){var p=c[f];l[f-1]=a.getPieceBoundingRectangleWidth(p,j);k-=l[f-1]}k/=c.length-1;var d=(b?h.getX():h.getY())+(g+k);for(var f=1;f<c.length-1;f++){var p=c[f];if(b){p.setX((d+l[f-1]/2))}else{p.setY((d+l[f-1]/2))}d+=k+l[f-1]}};a.prototype.resetFurnitureElevation=function(){var c=this.getMovableSelectedFurniture();if(c.length>=1){var b=this.home.getSelectedItems();var j=(function(l){var k=[];while(l-->0){k.push(0)}return k})(c.length);var h=(function(l){var k=[];while(l-->0){k.push(0)}return k})(c.length);for(var e=0;e<c.length;e++){var f=c[e];j[e]=f.getElevation();var d=this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List(f,c.slice(0));if(d!=null){var g=d.getElevation()+d.getHeightInPlan()*d.getDropOnTopElevation();if(d.getLevel()!=null){g+=d.getLevel().getElevation()-f.getLevel().getElevation()}h[e]=Math.max(0,g)}else{h[e]=0}}this.home.setSelectedItems(c.slice(0));a.doSetFurnitureElevation(c,h);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureElevationResetUndoableEdit(this.home,this.preferences,b.slice(0),j,c,h))}}};a.doSetFurnitureElevation=function(b,d){for(var c=0;c<b.length;c++){b[c].setElevation(d[c])}};a.prototype.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(b){var c=[];return this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List(b,c)};a.prototype.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List=function(o,n){var e=o.getPoints();var c=Math.min(o.getWidthInPlan(),o.getDepthInPlan())*0.05;var d=null;var b=1.4e-45;var h=this.getFurnitureInSameGroup(o);for(var g=0;g<h.length;g++){var l=h[g];if(l!==o&&!(n.indexOf((l))>=0)&&this.isPieceOfFurnitureVisibleAtSelectedLevel(l)&&l.getDropOnTopElevation()>=0){var f=true;for(var j=0;j<e.length;j++){var k=e[j];if(!l.containsPoint(k[0],k[1],c)){f=false;break}}if(f){var m=l.getElevation()+l.getHeightInPlan()*l.getDropOnTopElevation();if(m>b){b=m;d=l}}}}return d};a.prototype.getHighestSurroundingPieceOfFurniture=function(b,c){if(((b!=null&&b instanceof HomePieceOfFurniture)||b===null)&&((c!=null&&(c instanceof Array))||c===null)){return this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List(b,c)}else{if(((b!=null&&b instanceof HomePieceOfFurniture)||b===null)&&c===undefined){return this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(b)}else{throw new Error("invalid overload")}}};a.prototype.getFurnitureInSameGroup=function(c){var b=this.home.getFurniture();var d=a.getFurnitureInSameGroup(c,b);if(d!=null){return d}else{return b}};a.getFurnitureInSameGroup=function(e,f){for(var c=0;c<f.length;c++){var d=f[c];if(d===e){return f}else{if(d!=null&&d instanceof HomeFurnitureGroup){var b=a.getFurnitureInSameGroup(e,d.getFurniture());if(b!=null){return b}}}}return null};a.prototype.isPieceOfFurnitureVisibleAtSelectedLevel=function(b){var c=this.home.getSelectedLevel();return b.isVisible()&&(b.getLevel()==null||b.getLevel().isViewable())&&(b.getLevel()===c||b.isAtLevel(c))};a.prototype.setVisualProperty=function(c,b){this.home.setVisualProperty(c,b)};a.prototype.setHomeProperty=function(c,b){this.home.setProperty(c,b)};return a}());FurnitureController.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController";FurnitureController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(l){var g=(function(w){__extends(v,w);function v(H,B,y,I,G,F,E,A,z,D,x){var C=w.call(this,B,l,"undoAddFurnitureName")||this;if(C.home===undefined){C.home=null}if(C.allLevelsSelection===undefined){C.allLevelsSelection=false}if(C.oldSelection===undefined){C.oldSelection=null}if(C.oldBasePlanLocked===undefined){C.oldBasePlanLocked=false}if(C.newFurniture===undefined){C.newFurniture=null}if(C.newFurnitureIndex===undefined){C.newFurnitureIndex=null}if(C.newFurnitureGroups===undefined){C.newFurnitureGroups=null}if(C.newFurnitureLevels===undefined){C.newFurnitureLevels=null}if(C.furnitureLevel===undefined){C.furnitureLevel=null}if(C.newBasePlanLocked===undefined){C.newBasePlanLocked=false}C.home=H;C.oldSelection=y;C.oldBasePlanLocked=I;C.allLevelsSelection=G;C.newFurniture=F;C.newFurnitureIndex=E;C.newFurnitureGroups=A;C.newFurnitureLevels=z;C.furnitureLevel=D;C.newBasePlanLocked=x;return C}v.prototype.undo=function(){w.prototype.undo.call(this);l.doDeleteFurniture(this.home,this.newFurniture,this.oldBasePlanLocked,this.allLevelsSelection);this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);l.doAddFurniture(this.home,this.newFurniture,this.newFurnitureGroups,this.newFurnitureIndex,this.furnitureLevel,this.newFurnitureLevels,this.newBasePlanLocked,false)};return v}(LocalizedUndoableEdit));l.FurnitureAdditionUndoableEdit=g;g.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureAdditionUndoableEdit";g.__interfaces=["javax.swing.undo.UndoableEdit"];var m=(function(w){__extends(v,w);function v(F,A,x,B,E,D,y,z,G){var C=w.call(this,A,l,"undoDeleteSelectionName")||this;if(C.home===undefined){C.home=null}if(C.oldSelection===undefined){C.oldSelection=null}if(C.basePlanLocked===undefined){C.basePlanLocked=false}if(C.allLevelsSelection===undefined){C.allLevelsSelection=false}if(C.furniture===undefined){C.furniture=null}if(C.furnitureIndex===undefined){C.furnitureIndex=null}if(C.furnitureGroups===undefined){C.furnitureGroups=null}if(C.furnitureLevels===undefined){C.furnitureLevels=null}C.home=F;C.oldSelection=x;C.basePlanLocked=B;C.allLevelsSelection=E;C.furniture=D;C.furnitureIndex=y;C.furnitureGroups=z;C.furnitureLevels=G;return C}v.prototype.undo=function(){w.prototype.undo.call(this);l.doAddFurniture(this.home,this.furniture,this.furnitureGroups,this.furnitureIndex,null,this.furnitureLevels,this.basePlanLocked,this.allLevelsSelection);this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);this.home.setSelectedItems(this.furniture.slice(0));l.doDeleteFurniture(this.home,this.furniture,this.basePlanLocked,false)};return v}(LocalizedUndoableEdit));l.FurnitureDeletionUndoableEdit=m;m.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureDeletionUndoableEdit";m.__interfaces=["javax.swing.undo.UndoableEdit"];var t=(function(w){__extends(v,w);function v(H,C,x,D,G,F,J,K,z,M,I,y,L,B,A,N){var E=w.call(this,C,l,"undoGroupName")||this;if(E.home===undefined){E.home=null}if(E.oldSelection===undefined){E.oldSelection=null}if(E.basePlanLocked===undefined){E.basePlanLocked=false}if(E.allLevelsSelection===undefined){E.allLevelsSelection=false}if(E.groupedPieces===undefined){E.groupedPieces=null}if(E.groupedPiecesIndex===undefined){E.groupedPiecesIndex=null}if(E.groupedPiecesGroups===undefined){E.groupedPiecesGroups=null}if(E.groupedPiecesLevel===undefined){E.groupedPiecesLevel=null}if(E.groupedPiecesElevation===undefined){E.groupedPiecesElevation=null}if(E.groupedPiecesVisible===undefined){E.groupedPiecesVisible=null}if(E.newGroup===undefined){E.newGroup=null}if(E.groupIndex===undefined){E.groupIndex=0}if(E.groupLevel===undefined){E.groupLevel=null}if(E.groupPiecesNewElevation===undefined){E.groupPiecesNewElevation=null}if(E.movable===undefined){E.movable=false}E.home=H;E.basePlanLocked=D;E.oldSelection=x;E.allLevelsSelection=G;E.groupedPieces=F;E.groupedPiecesIndex=J;E.groupedPiecesGroups=K;E.groupedPiecesLevel=z;E.groupedPiecesElevation=M;E.groupedPiecesVisible=I;E.newGroup=y;E.groupIndex=L;E.groupLevel=B;E.groupPiecesNewElevation=A;E.movable=N;return E}v.prototype.undo=function(){w.prototype.undo.call(this);l.doUngroupFurniture(this.home,[this.newGroup],this.groupedPieces,this.groupedPiecesGroups,this.groupedPiecesIndex,this.groupedPiecesLevel,this.basePlanLocked,this.allLevelsSelection);for(var x=0;x<this.groupedPieces.length;x++){this.groupedPieces[x].setElevation(this.groupedPiecesElevation[x]);this.groupedPieces[x].setVisible(this.groupedPiecesVisible[x])}this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);for(var x=0;x<this.groupedPieces.length;x++){this.groupedPieces[x].setElevation(this.groupPiecesNewElevation[x]);this.groupedPieces[x].setLevel(null)}this.newGroup.setMovable(this.movable);this.newGroup.setVisible(true);l.doGroupFurniture(this.home,this.groupedPieces,[this.newGroup],null,[this.groupIndex],[this.groupLevel],this.basePlanLocked,false)};return v}(LocalizedUndoableEdit));l.FurnitureGroupingUndoableEdit=t;t.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureGroupingUndoableEdit";t.__interfaces=["javax.swing.undo.UndoableEdit"];var p=(function(w){__extends(v,w);function v(I,D,y,L,G,A,B,z,K,F,J,H,C,x){var E=w.call(this,D,l,"undoUngroupName")||this;if(E.home===undefined){E.home=null}if(E.oldBasePlanLocked===undefined){E.oldBasePlanLocked=false}if(E.oldSelection===undefined){E.oldSelection=null}if(E.allLevelsSelection===undefined){E.allLevelsSelection=false}if(E.groups===undefined){E.groups=null}if(E.groupsIndex===undefined){E.groupsIndex=null}if(E.groupsGroups===undefined){E.groupsGroups=null}if(E.groupsLevels===undefined){E.groupsLevels=null}if(E.ungroupedPieces===undefined){E.ungroupedPieces=null}if(E.ungroupedPiecesIndex===undefined){E.ungroupedPiecesIndex=null}if(E.ungroupedPiecesGroups===undefined){E.ungroupedPiecesGroups=null}if(E.ungroupedPiecesLevels===undefined){E.ungroupedPiecesLevels=null}if(E.newBasePlanLocked===undefined){E.newBasePlanLocked=false}E.home=I;E.oldSelection=y;E.oldBasePlanLocked=L;E.allLevelsSelection=G;E.groups=A;E.groupsIndex=B;E.groupsGroups=z;E.groupsLevels=K;E.ungroupedPieces=F;E.ungroupedPiecesIndex=J;E.ungroupedPiecesGroups=H;E.ungroupedPiecesLevels=C;E.newBasePlanLocked=x;return E}v.prototype.undo=function(){w.prototype.undo.call(this);l.doGroupFurniture(this.home,this.ungroupedPieces,this.groups,this.groupsGroups,this.groupsIndex,this.groupsLevels,this.oldBasePlanLocked,this.allLevelsSelection);this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);l.doUngroupFurniture(this.home,this.groups,this.ungroupedPieces,this.ungroupedPiecesGroups,this.ungroupedPiecesIndex,this.ungroupedPiecesLevels,this.newBasePlanLocked,false)};return v}(LocalizedUndoableEdit));l.FurnitureUngroupingUndoableEdit=p;p.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureUngroupingUndoableEdit";p.__interfaces=["javax.swing.undo.UndoableEdit"];var k=(function(w){__extends(v,w);function v(E,A,x,y,D){var B=w.call(this,A,l,"undoAlignName")||this;if(B.home===undefined){B.home=null}if(B.oldSelection===undefined){B.oldSelection=null}if(B.selectedFurniture===undefined){B.selectedFurniture=null}if(B.leadPiece===undefined){B.leadPiece=null}if(B.alignedFurniture===undefined){B.alignedFurniture=null}if(B.oldX===undefined){B.oldX=null}if(B.oldY===undefined){B.oldY=null}B.home=E;B.oldSelection=x;B.selectedFurniture=y;B.leadPiece=D;B.alignedFurniture=(function(H){var G=[];while(H-->0){G.push(null)}return G})(D==null?y.length:y.length-1);B.oldX=(function(H){var G=[];while(H-->0){G.push(0)}return G})(B.alignedFurniture.length);B.oldY=(function(H){var G=[];while(H-->0){G.push(0)}return G})(B.alignedFurniture.length);var z=0;for(var C=0;C<y.length;C++){var F=y[C];if(F!==D){B.alignedFurniture[z]=F;B.oldX[z]=F.getX();B.oldY[z]=F.getY();z++}}return B}v.prototype.undo=function(){w.prototype.undo.call(this);l.undoAlignFurniture(this.alignedFurniture,this.oldX,this.oldY);this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);this.home.setSelectedItems(this.selectedFurniture.slice(0));this.alignFurniture$()};v.prototype.alignFurniture$=function(){this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(this.alignedFurniture,this.leadPiece)};v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,y){throw new Error("cannot invoke abstract overloaded method... check your argument(s) type(s)")};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(LocalizedUndoableEdit));l.FurnitureAlignmentUndoableEdit=k;k.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureAlignmentUndoableEdit";k.__interfaces=["javax.swing.undo.UndoableEdit"];var b=(function(v){__extends(w,v);function w(D,A,z,C,B,x,y){var E=v.call(this,A,l,"undoDistributeName")||this;if(E.home===undefined){E.home=null}if(E.oldSelection===undefined){E.oldSelection=null}if(E.oldX===undefined){E.oldX=null}if(E.oldY===undefined){E.oldY=null}if(E.alignedFurniture===undefined){E.alignedFurniture=null}if(E.horizontal===undefined){E.horizontal=false}E.home=D;E.oldSelection=z;E.oldX=C;E.oldY=B;E.alignedFurniture=x;E.horizontal=y;return E}w.prototype.undo=function(){v.prototype.undo.call(this);l.undoAlignFurniture(this.alignedFurniture,this.oldX,this.oldY);this.home.setSelectedItems(this.oldSelection.slice(0))};w.prototype.redo=function(){v.prototype.redo.call(this);this.home.setSelectedItems(this.alignedFurniture.slice(0));l.doDistributeFurnitureAlongAxis(this.alignedFurniture,this.horizontal)};return w}(LocalizedUndoableEdit));l.FurnitureDistributionUndoableEdit=b;b.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureDistributionUndoableEdit";b.__interfaces=["javax.swing.undo.UndoableEdit"];var c=(function(w){__extends(v,w);function v(B,z,x,D,y,A){var C=w.call(this,z,l,"undoResetElevation")||this;if(C.home===undefined){C.home=null}if(C.oldSelection===undefined){C.oldSelection=null}if(C.furnitureOldElevation===undefined){C.furnitureOldElevation=null}if(C.selectedFurniture===undefined){C.selectedFurniture=null}if(C.furnitureNewElevation===undefined){C.furnitureNewElevation=null}C.home=B;C.oldSelection=x;C.furnitureOldElevation=D;C.selectedFurniture=y;C.furnitureNewElevation=A;return C}v.prototype.undo=function(){w.prototype.undo.call(this);l.doSetFurnitureElevation(this.selectedFurniture,this.furnitureOldElevation);this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);this.home.setSelectedItems(this.selectedFurniture.slice(0));l.doSetFurnitureElevation(this.selectedFurniture,this.furnitureNewElevation)};return v}(LocalizedUndoableEdit));l.FurnitureElevationResetUndoableEdit=c;c.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureElevationResetUndoableEdit";c.__interfaces=["javax.swing.undo.UndoableEdit"];var n=(function(v){__extends(w,v);function w(B,z,x,y,A){return v.call(this,B,z,x,y,A)||this}w.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,B){var A=l.getMinY(B);for(var y=0;y<x.length;y++){var z=x[y];var C=l.getMinY(z);z.setY(z.getY()+A-C)}};w.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return w}(l.FurnitureAlignmentUndoableEdit));l.FurnitureTopAlignmentUndoableEdit=n;n.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureTopAlignmentUndoableEdit";n.__interfaces=["javax.swing.undo.UndoableEdit"];var o=(function(w){__extends(v,w);function v(B,z,x,y,A){return w.call(this,B,z,x,y,A)||this}v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var B=l.getMaxY(C);for(var y=0;y<x.length;y++){var z=x[y];var A=l.getMaxY(z);z.setY(z.getY()+B-A)}};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(l.FurnitureAlignmentUndoableEdit));l.FurnitureBottomAlignmentUndoableEdit=o;o.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureBottomAlignmentUndoableEdit";o.__interfaces=["javax.swing.undo.UndoableEdit"];var f=(function(w){__extends(v,w);function v(B,z,x,y,A){return w.call(this,B,z,x,y,A)||this}v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(y,C){var B=l.getMinX(C);for(var z=0;z<y.length;z++){var A=y[z];var x=l.getMinX(A);A.setX(A.getX()+B-x)}};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(l.FurnitureAlignmentUndoableEdit));l.FurnitureLeftAlignmentUndoableEdit=f;f.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureLeftAlignmentUndoableEdit";f.__interfaces=["javax.swing.undo.UndoableEdit"];var e=(function(w){__extends(v,w);function v(B,z,x,y,A){return w.call(this,B,z,x,y,A)||this}v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var A=l.getMaxX(C);for(var y=0;y<x.length;y++){var z=x[y];var B=l.getMaxX(z);z.setX(z.getX()+A-B)}};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(l.FurnitureAlignmentUndoableEdit));l.FurnitureRightAlignmentUndoableEdit=e;e.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureRightAlignmentUndoableEdit";e.__interfaces=["javax.swing.undo.UndoableEdit"];var a=(function(v){__extends(w,v);function w(B,z,x,y,A){return v.call(this,B,z,x,y,A)||this}w.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var A=C.getPoints();var B=new java.awt.geom.Line2D.Float(A[2][0],A[2][1],A[3][0],A[3][1]);for(var y=0;y<x.length;y++){var z=x[y];l.alignPieceOfFurnitureAlongSides(z,C,B,true,null,0)}};w.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return w}(l.FurnitureAlignmentUndoableEdit));l.FurnitureFrontSideAlignmentUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureFrontSideAlignmentUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"];var r=(function(w){__extends(v,w);function v(B,z,x,y,A){return w.call(this,B,z,x,y,A)||this}v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var A=C.getPoints();var B=new java.awt.geom.Line2D.Float(A[0][0],A[0][1],A[1][0],A[1][1]);for(var y=0;y<x.length;y++){var z=x[y];l.alignPieceOfFurnitureAlongSides(z,C,B,false,null,0)}};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(l.FurnitureAlignmentUndoableEdit));l.FurnitureBackSideAlignmentUndoableEdit=r;r.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureBackSideAlignmentUndoableEdit";r.__interfaces=["javax.swing.undo.UndoableEdit"];var h=(function(v){__extends(w,v);function w(B,z,x,y,A){return v.call(this,B,z,x,y,A)||this}w.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var B=C.getPoints();var y=new java.awt.geom.Line2D.Float(B[3][0],B[3][1],B[0][0],B[0][1]);for(var z=0;z<x.length;z++){var A=x[z];l.alignPieceOfFurnitureAlongLeftOrRightSides(A,C,y,false)}};w.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return w}(l.FurnitureAlignmentUndoableEdit));l.FurnitureLeftSideAlignmentUndoableEdit=h;h.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureLeftSideAlignmentUndoableEdit";h.__interfaces=["javax.swing.undo.UndoableEdit"];var d=(function(v){__extends(w,v);function w(B,z,x,y,A){return v.call(this,B,z,x,y,A)||this}w.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var z=C.getPoints();var B=new java.awt.geom.Line2D.Float(z[1][0],z[1][1],z[2][0],z[2][1]);for(var y=0;y<x.length;y++){var A=x[y];l.alignPieceOfFurnitureAlongLeftOrRightSides(A,C,B,true)}};w.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return w}(l.FurnitureAlignmentUndoableEdit));l.FurnitureRightSideAlignmentUndoableEdit=d;d.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureRightSideAlignmentUndoableEdit";d.__interfaces=["javax.swing.undo.UndoableEdit"];var j=(function(w){__extends(v,w);function v(B,z,x,y,A){return w.call(this,B,z,x,y,A)||this}v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(z,C){var D=C.getPoints();var E=new java.awt.geom.Line2D.Float(C.getX(),C.getY(),(D[0][0]+D[1][0])/2,(D[0][1]+D[1][1])/2);var x=l.sortFurniture(z,C,E);var B=x.indexOf(C);var y=new java.awt.geom.Line2D.Float(D[0][0],D[0][1],D[1][0],D[1][1]);var F=C.getWidthInPlan()/2;for(var A=B+1;A<x.length;A++){F+=l.alignPieceOfFurnitureAlongSides(x[A],C,y,false,E,F)}F=-C.getWidthInPlan()/2;for(var A=B-1;A>=0;A--){F-=l.alignPieceOfFurnitureAlongSides(x[A],C,y,false,E,F)}};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(l.FurnitureAlignmentUndoableEdit));l.FurnitureSideBySideAlignmentUndoableEdit=j;j.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureSideBySideAlignmentUndoableEdit";j.__interfaces=["javax.swing.undo.UndoableEdit"];var u=(function(){function v(w){this.__parent=w}v.prototype.selectionChanged=function(x){var w=Home.getFurnitureSubList(this.__parent.home.getSelectedItems());if((w.length==0)){this.__parent.leadSelectedPieceOfFurniture=null}else{if(this.__parent.leadSelectedPieceOfFurniture==null||w.length===1||w.indexOf(this.__parent.leadSelectedPieceOfFurniture)===-1){this.__parent.leadSelectedPieceOfFurniture=w[0]}}};return v}());l.FurnitureController$0=u;u.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var s=(function(){function v(w){this.__parent=w}v.prototype.propertyChange=function(w){if("MOVABLE"===w.getPropertyName()){var y=w.getSource();if(this.__parent.home.isBasePlanLocked()&&this.__parent.isPieceOfFurniturePartOfBasePlan(y)){var x=this.__parent.home.getSelectedItems();if((x.indexOf((y))>=0)){x=(x.slice(0));(function(z){var A=z.indexOf(y);if(A>=0){z.splice(A,1);return true}else{return false}})(x);this.__parent.home.setSelectedItems(x)}}}};return v}());l.FurnitureController$1=s;var q=(function(){function v(w){this.orthogonalAxis=w}v.prototype.compare=function(x,w){return(this.orthogonalAxis.ptLineDistSq(w.getX(),w.getY())*this.orthogonalAxis.relativeCCW(w.getX(),w.getY())-this.orthogonalAxis.ptLineDistSq(x.getX(),x.getY())*this.orthogonalAxis.relativeCCW(x.getX(),x.getY()))};return v}());l.FurnitureController$2=q})(FurnitureController||(FurnitureController={}));var LabelController=(function(){function a(h,k,j,d,f,c){if(((h!=null&&h instanceof Home)||h===null)&&((typeof k==="number")||k===null)&&((typeof j==="number")||j===null)&&((d!=null&&d instanceof UserPreferences)||d===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||f===null)&&((c!=null&&c instanceof javax.swing.undo.UndoableEditSupport)||c===null)){var e=arguments;if(this.home===undefined){this.home=null}if(this.x===undefined){this.x=null}if(this.y===undefined){this.y=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.labelView===undefined){this.labelView=null}if(this.text===undefined){this.text=null}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontNameSet===undefined){this.fontNameSet=false}if(this.fontSize===undefined){this.fontSize=null}if(this.color===undefined){this.color=null}if(this.pitch===undefined){this.pitch=null}if(this.pitchEnabled===undefined){this.pitchEnabled=null}if(this.elevation===undefined){this.elevation=null}this.home=h;this.x=k;this.y=j;this.preferences=d;this.viewFactory=f;this.undoSupport=c;this.propertyChangeSupport=new PropertyChangeSupport(this);this.alignment=TextStyle.Alignment.CENTER;this.fontName=d.getDefaultFontName();this.fontNameSet=true;this.fontSize=d.getDefaultTextStyle(Label).getFontSize();this.pitchEnabled=false;this.elevation=0}else{if(((h!=null&&h instanceof Home)||h===null)&&((k!=null&&k instanceof UserPreferences)||k===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||j===null)&&((d!=null&&d instanceof javax.swing.undo.UndoableEditSupport)||d===null)&&f===undefined&&c===undefined){var e=arguments;var b=e[1];var g=e[2];var l=e[3];if(this.home===undefined){this.home=null}if(this.x===undefined){this.x=null}if(this.y===undefined){this.y=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.labelView===undefined){this.labelView=null}if(this.text===undefined){this.text=null}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontNameSet===undefined){this.fontNameSet=false}if(this.fontSize===undefined){this.fontSize=null}if(this.color===undefined){this.color=null}if(this.pitch===undefined){this.pitch=null}if(this.pitchEnabled===undefined){this.pitchEnabled=null}if(this.elevation===undefined){this.elevation=null}this.home=h;this.x=null;this.y=null;this.preferences=b;this.viewFactory=g;this.undoSupport=l;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}else{throw new Error("invalid overload")}}}a.prototype.updateProperties=function(){var f=Home.getLabelsSubList(this.home.getSelectedItems());if((f.length==0)){this.setText(null);this.setFontName(null);this.fontNameSet=false;this.setFontSize(null);this.setAlignment(null);this.setColor(null);this.setPitch(null);this.pitchEnabled=false;this.setElevation(null)}else{var d=f[0];var o=d.getText();if(o!=null){for(var g=1;g<f.length;g++){if(!(o===f[g].getText())){o=null;break}}}this.setText(o);var j=d.getStyle()!=null?d.getStyle().getAlignment():TextStyle.Alignment.CENTER;for(var g=1;g<f.length;g++){var m=f[g];if(!((j)===(m.getStyle()!=null?m.getStyle().getAlignment():TextStyle.Alignment.CENTER))){j=null;break}}this.setAlignment(j);var b=d.getStyle()!=null?d.getStyle().getFontName():null;var k=true;for(var g=1;g<f.length;g++){var m=f[g];if(!(b==null&&(m.getStyle()==null||m.getStyle().getFontName()==null)||b!=null&&m.getStyle()!=null&&(b===m.getStyle().getFontName()))){k=false;break}}this.setFontName(b);this.fontNameSet=k;var l=this.preferences.getDefaultTextStyle(Label).getFontSize();var p=d.getStyle()!=null?d.getStyle().getFontSize():l;for(var g=1;g<f.length;g++){var m=f[g];if(!(p===(m.getStyle()!=null?m.getStyle().getFontSize():l))){p=null;break}}this.setFontSize(p);var e=d.getColor();if(e!=null){for(var g=1;g<f.length;g++){if(!(e===f[g].getColor())){e=null;break}}}this.setColor(e);var c=d.getPitch();for(var g=1;g<f.length;g++){var m=f[g];if(!(c==null&&m.getPitch()==null||c!=null&&(c===m.getPitch()))){c=null;break}}this.setPitch(c);var h=d.getPitch()!=null;for(var g=1;g<f.length;g++){if(!(h===(f[g].getPitch()!=null))){h=null;break}}this.pitchEnabled=h;var n=d.getElevation();for(var g=1;g<f.length;g++){if(n!==f[g].getElevation()){n=null;break}}this.setElevation(n)}};a.prototype.getView=function(){if(this.labelView==null){this.labelView=this.viewFactory.createLabelView(this.x==null,this.preferences,this)}return this.labelView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.setText=function(c){if(c!==this.text){var b=this.text;this.text=c;this.propertyChangeSupport.firePropertyChange("TEXT",b,c)}};a.prototype.getText=function(){return this.text};a.prototype.setAlignment=function(c){if(c!==this.alignment){var b=this.alignment;this.alignment=c;this.propertyChangeSupport.firePropertyChange("ALIGNMENT",b,c)}};a.prototype.getAlignment=function(){return this.alignment};a.prototype.setFontName=function(c){if(c!==this.fontName){var b=this.fontName;this.fontName=c;this.propertyChangeSupport.firePropertyChange("FONT_NAME",b,c);this.fontNameSet=true}};a.prototype.getFontName=function(){return this.fontName};a.prototype.setFontSize=function(c){if(c!==this.fontSize){var b=this.fontSize;this.fontSize=c;this.propertyChangeSupport.firePropertyChange("FONT_SIZE",b,c)}};a.prototype.getFontSize=function(){return this.fontSize};a.prototype.isFontNameSet=function(){return this.fontNameSet};a.prototype.setColor=function(b){if(b!==this.color){var c=this.color;this.color=b;this.propertyChangeSupport.firePropertyChange("COLOR",c,b)}};a.prototype.getColor=function(){return this.color};a.prototype.setPitch=function(c){if(c!==this.pitch){var b=this.pitch;this.pitch=c;this.propertyChangeSupport.firePropertyChange("PITCH",b,c)}this.pitchEnabled=c!=null};a.prototype.getPitch=function(){return this.pitch};a.prototype.isPitchEnabled=function(){return this.pitchEnabled};a.prototype.setElevation=function(c){if(c!==this.elevation){var b=this.elevation;this.elevation=c;this.propertyChangeSupport.firePropertyChange("ELEVATION",b,c)}};a.prototype.getElevation=function(){return this.elevation};a.prototype.createLabel=function(){var l=this.getText();if(l!=null&&l.trim().length>0){var c=this.home.getSelectedItems();var g=this.home.isBasePlanLocked();var h=this.home.isAllLevelsSelection();var k=new Label(l,this.x,this.y);var j=this.getAlignment();var e=this.getFontName();var m=this.getFontSize();if(e!=null||m!=null||this.getPitch()!=null){var d=this.preferences.getDefaultTextStyle(Label);if(e!=null){d=d.deriveStyle$java_lang_String(e)}if(m!=null){d=d.deriveStyle$float(m)}if(j!=null){d=d.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(j)}k.setStyle(d)}if(this.color!=null){k.setColor(this.color)}k.setColor(this.getColor());k.setPitch(this.getPitch());k.setElevation(this.getElevation());var b=g&&!this.isLabelPartOfBasePlan(k);a.doAddLabel(this.home,k,b);if(this.undoSupport!=null){var f=new a.LabelCreationUndoableEdit(this.home,this.preferences,c.slice(0),g,h,k,b);this.undoSupport.postEdit(f)}if(l.indexOf("\n")<0){this.preferences.addAutoCompletionString("LabelText",l)}}};a.doAddLabel=function(d,c,b){d.addLabel(c);d.setBasePlanLocked(b);d.setSelectedItems([c].slice(0));d.setAllLevelsSelection(false)};a.doDeleteLabel=function(d,c,b){d.deleteLabel(c);d.setBasePlanLocked(b)};a.prototype.isLabelPartOfBasePlan=function(b){return true};a.prototype.modifyLabels=function(){var b=this.home.getSelectedItems();var g=Home.getLabelsSubList(b);if(!(g.length==0)){var o=this.getText();if(o!=null&&o.trim().length===0){o=null}var k=this.getAlignment();var c=this.getFontName();var l=this.isFontNameSet();var q=this.getFontSize();var f=this.getColor();var d=this.getPitch();var j=this.isPitchEnabled();var n=this.getElevation();var m=(function(t){var r=[];while(t-->0){r.push(null)}return r})(g.length);for(var h=0;h<m.length;h++){m[h]=new a.ModifiedLabel(g[h])}var p=this.preferences.getDefaultTextStyle(Label);a.doModifyLabels(m,o,k,c,l,q,p,f,d,j,n);if(this.undoSupport!=null){var e=new a.LabelModificationUndoableEdit(this.home,this.preferences,b.slice(0),m,o,k,c,l,q,p,f,d,j,n);this.undoSupport.postEdit(e)}if(o!=null&&o.indexOf("\n")<0){this.preferences.addAutoCompletionString("LabelText",o)}}};a.doModifyLabels=function(l,n,h,b,j,p,o,d,c,g,m){for(var e=0;e<l.length;e++){var f=l[e];var k=f.getLabel();if(n!=null){k.setText(n)}if(h!=null){k.setStyle(k.getStyle()!=null?k.getStyle().deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(h):o.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(h))}if(j){k.setStyle(k.getStyle()!=null?k.getStyle().deriveStyle$java_lang_String(b):o.deriveStyle$java_lang_String(b))}if(p!=null){k.setStyle(k.getStyle()!=null?k.getStyle().deriveStyle$float(p):o.deriveStyle$float(p))}if(d!=null){k.setColor(d)}if(g!=null){if(false===g){k.setPitch(null)}else{if(c!=null){k.setPitch(c);if(k.getStyle()==null){k.setStyle(o)}}}}if(m!=null){k.setElevation(m)}}};a.undoModifyLabels=function(d){for(var c=0;c<d.length;c++){var b=d[c];b.reset()}};return a}());LabelController.__class="com.eteks.sweethome3d.viewcontroller.LabelController";LabelController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(a){var c=(function(e){__extends(f,e);function f(n,h,g,l,m,j,k){var o=e.call(this,h,a,"undoCreateLabelName")||this;if(o.home===undefined){o.home=null}if(o.oldSelection===undefined){o.oldSelection=null}if(o.oldBasePlanLocked===undefined){o.oldBasePlanLocked=false}if(o.oldAllLevelsSelection===undefined){o.oldAllLevelsSelection=false}if(o.label===undefined){o.label=null}if(o.newBasePlanLocked===undefined){o.newBasePlanLocked=false}o.home=n;o.oldSelection=g;o.oldBasePlanLocked=l;o.oldAllLevelsSelection=m;o.label=j;o.newBasePlanLocked=k;return o}f.prototype.undo=function(){e.prototype.undo.call(this);a.doDeleteLabel(this.home,this.label,this.oldBasePlanLocked);this.home.setSelectedItems(this.oldSelection.slice(0));this.home.setAllLevelsSelection(this.oldAllLevelsSelection)};f.prototype.redo=function(){e.prototype.redo.call(this);a.doAddLabel(this.home,this.label,this.newBasePlanLocked)};return f}(LocalizedUndoableEdit));a.LabelCreationUndoableEdit=c;c.__class="com.eteks.sweethome3d.viewcontroller.LabelController.LabelCreationUndoableEdit";c.__interfaces=["javax.swing.undo.UndoableEdit"];var d=(function(e){__extends(f,e);function f(p,l,g,r,t,o,h,q,v,u,k,j,n,s){var m=e.call(this,l,a,"undoModifyLabelsName")||this;if(m.home===undefined){m.home=null}if(m.oldSelection===undefined){m.oldSelection=null}if(m.modifiedLabels===undefined){m.modifiedLabels=null}if(m.text===undefined){m.text=null}if(m.alignment===undefined){m.alignment=null}if(m.fontName===undefined){m.fontName=null}if(m.fontNameSet===undefined){m.fontNameSet=false}if(m.fontSize===undefined){m.fontSize=null}if(m.defaultStyle===undefined){m.defaultStyle=null}if(m.color===undefined){m.color=null}if(m.pitch===undefined){m.pitch=null}if(m.pitchEnabled===undefined){m.pitchEnabled=null}if(m.elevation===undefined){m.elevation=null}m.home=p;m.oldSelection=g;m.modifiedLabels=r;m.text=t;m.alignment=o;m.fontName=h;m.fontNameSet=q;m.fontSize=v;m.defaultStyle=u;m.color=k;m.pitch=j;m.pitchEnabled=n;m.elevation=s;return m}f.prototype.undo=function(){e.prototype.undo.call(this);a.undoModifyLabels(this.modifiedLabels);this.home.setSelectedItems(this.oldSelection.slice(0))};f.prototype.redo=function(){e.prototype.redo.call(this);a.doModifyLabels(this.modifiedLabels,this.text,this.alignment,this.fontName,this.fontNameSet,this.fontSize,this.defaultStyle,this.color,this.pitch,this.pitchEnabled,this.elevation);this.home.setSelectedItems(this.oldSelection.slice(0))};return f}(LocalizedUndoableEdit));a.LabelModificationUndoableEdit=d;d.__class="com.eteks.sweethome3d.viewcontroller.LabelController.LabelModificationUndoableEdit";d.__interfaces=["javax.swing.undo.UndoableEdit"];var b=(function(){function e(f){if(this.label===undefined){this.label=null}if(this.text===undefined){this.text=null}if(this.style===undefined){this.style=null}if(this.color===undefined){this.color=null}if(this.pitch===undefined){this.pitch=null}if(this.elevation===undefined){this.elevation=0}this.label=f;this.text=f.getText();this.style=f.getStyle();this.color=f.getColor();this.pitch=f.getPitch();this.elevation=f.getElevation()}e.prototype.getLabel=function(){return this.label};e.prototype.reset=function(){this.label.setText(this.text);this.label.setStyle(this.style);this.label.setColor(this.color);this.label.setPitch(this.pitch);this.label.setElevation(this.elevation)};return e}());a.ModifiedLabel=b;b.__class="com.eteks.sweethome3d.viewcontroller.LabelController.ModifiedLabel"})(LabelController||(LabelController={}));var PhotoController=(function(a){__extends(b,a);function b(f,d,h,c,e){var g=a.call(this,f,d,h,e)||this;if(g.__com_eteks_sweethome3d_viewcontroller_PhotoController_home===undefined){g.__com_eteks_sweethome3d_viewcontroller_PhotoController_home=null}if(g.preferences===undefined){g.preferences=null}if(g.viewFactory===undefined){g.viewFactory=null}if(g.cameraChangeListener===undefined){g.cameraChangeListener=null}if(g.photoView===undefined){g.photoView=null}if(g.time===undefined){g.time=0}if(g.lens===undefined){g.lens=null}g.__com_eteks_sweethome3d_viewcontroller_PhotoController_home=f;g.preferences=d;g.viewFactory=c;g.cameraChangeListener=new b.CameraChangeListener(g);f.getCamera().addPropertyChangeListener(g.cameraChangeListener);f.addPropertyChangeListener("CAMERA",new b.HomeCameraChangeListener(g));g.updateProperties();return g}b.prototype.getView=function(){if(this.photoView==null){this.photoView=this.viewFactory.createPhotoView(this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home,this.preferences,this)}return this.photoView};b.prototype.displayView=function(c){this.getView().displayView(c)};b.prototype.updateProperties=function(){if(this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home!=null){a.prototype.updateProperties.call(this);this.setTime(this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera().getTime());this.setLens(this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera().getLens())}};b.prototype.setTime=function(d){if(this.time!==d){var e=this.time;this.time=d;this.propertyChangeSupport.firePropertyChange("TIME",e,d);var c=this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera();c.removePropertyChangeListener(this.cameraChangeListener);c.setTime(d);c.addPropertyChangeListener(this.cameraChangeListener)}};b.prototype.getTime=function(){return this.time};b.prototype.setLens=function(c){if(this.lens!==c){var d=this.lens;this.lens=c;this.propertyChangeSupport.firePropertyChange("LENS",d,c);if(c===Camera.Lens.SPHERICAL){this.setAspectRatio(AspectRatio.RATIO_2_1)}else{if(c===Camera.Lens.FISHEYE){this.setAspectRatio(AspectRatio.SQUARE_RATIO)}}this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera().setLens(this.lens)}};b.prototype.getLens=function(){return this.lens};return b}(AbstractPhotoController));PhotoController.__class="com.eteks.sweethome3d.viewcontroller.PhotoController";PhotoController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(c){var a=(function(){function d(e){if(this.photoController===undefined){this.photoController=null}this.photoController=(e)}d.prototype.propertyChange=function(f){var e=this.photoController;if(e==null){f.getSource().removePropertyChangeListener("CAMERA",this)}else{f.getOldValue().removePropertyChangeListener(e.cameraChangeListener);e.updateProperties();f.getNewValue().addPropertyChangeListener(e.cameraChangeListener)}};return d}());c.HomeCameraChangeListener=a;a.__class="com.eteks.sweethome3d.viewcontroller.PhotoController.HomeCameraChangeListener";var b=(function(){function d(e){if(this.photoController===undefined){this.photoController=null}this.photoController=(e)}d.prototype.propertyChange=function(f){var e=this.photoController;if(e==null){f.getSource().removePropertyChangeListener(this)}else{e.updateProperties()}};return d}());c.CameraChangeListener=b;b.__class="com.eteks.sweethome3d.viewcontroller.PhotoController.CameraChangeListener"})(PhotoController||(PhotoController={}));var PhotosController=(function(b){__extends(a,b);function a(f,d,h,c,e){var g=b.call(this,f,d,h,e)||this;if(g.__com_eteks_sweethome3d_viewcontroller_PhotosController_home===undefined){g.__com_eteks_sweethome3d_viewcontroller_PhotosController_home=null}if(g.preferences===undefined){g.preferences=null}if(g.viewFactory===undefined){g.viewFactory=null}if(g.photoView===undefined){g.photoView=null}if(g.cameras===undefined){g.cameras=null}if(g.selectedCameras===undefined){g.selectedCameras=null}if(g.fileFormat===undefined){g.fileFormat=null}if(g.fileCompressionQuality===undefined){g.fileCompressionQuality=null}g.__com_eteks_sweethome3d_viewcontroller_PhotosController_home=f;g.preferences=d;g.viewFactory=c;g.cameras=[];g.selectedCameras=[];f.addPropertyChangeListener("STORED_CAMERAS",new a.HomeStoredCamerasChangeListener(g));g.updateProperties();return g}a.prototype.getView=function(){if(this.photoView==null){this.photoView=this.viewFactory.createPhotosView(this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home,this.preferences,this)}return this.photoView};a.prototype.displayView=function(c){this.getView().displayView(c)};a.prototype.updateProperties=function(){if(this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home!=null){b.prototype.updateProperties.call(this);this.setCameras(this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home.getStoredCameras());this.setSelectedCameras(this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home.getStoredCameras())}};a.prototype.getCameras=function(){return this.cameras};a.prototype.setCameras=function(d){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.cameras)){var c=this.cameras;this.cameras=(d.slice(0));this.propertyChangeSupport.firePropertyChange("CAMERAS",c.slice(0),d.slice(0))}};a.prototype.getSelectedCameras=function(){return this.selectedCameras};a.prototype.setSelectedCameras=function(d){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.selectedCameras)){var c=this.selectedCameras;this.selectedCameras=(d.slice(0));this.propertyChangeSupport.firePropertyChange("SELECTED_CAMERAS",c.slice(0),d.slice(0))}};a.prototype.getFileFormat=function(){return this.fileFormat};a.prototype.setFileFormat=function(d){if(d!==this.fileFormat){var c=this.fileFormat;this.fileFormat=d;this.propertyChangeSupport.firePropertyChange("FILE_FORMAT",c,d)}};a.prototype.getFileCompressionQuality=function(){return this.fileCompressionQuality};a.prototype.setFileCompressionQuality=function(d){if(d!==this.fileCompressionQuality){var c=this.fileCompressionQuality;this.fileCompressionQuality=d;this.propertyChangeSupport.firePropertyChange("FILE_COMPRESSION_QUALITY",c,d)}};return a}(AbstractPhotoController));PhotosController.__class="com.eteks.sweethome3d.viewcontroller.PhotosController";PhotosController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(a){var b=(function(){function c(d){if(this.photosController===undefined){this.photosController=null}this.photosController=(d)}c.prototype.propertyChange=function(e){var d=this.photosController;if(d==null){e.getSource().removePropertyChangeListener("STORED_CAMERAS",this)}else{d.updateProperties()}};return c}());a.HomeStoredCamerasChangeListener=b;b.__class="com.eteks.sweethome3d.viewcontroller.PhotosController.HomeStoredCamerasChangeListener"})(PhotosController||(PhotosController={}));var HomeLight=(function(b){__extends(a,b);function a(j,c){var h=this;if(((typeof j==="string")||j===null)&&((c!=null&&(c.constructor!=null&&c.constructor.__interfaces!=null&&c.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0))||c===null)){var d=arguments;h=b.call(this,j,c)||this;if(h.lightSources===undefined){h.lightSources=null}if(h.power===undefined){h.power=0}h.lightSources=c.getLightSources();h.power=0.5}else{if(((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0))||j===null)&&c===undefined){var d=arguments;var f=d[0];var e=arguments;var g=HomeObject.createId("light");h=b.call(this,g,f)||this;if(h.lightSources===undefined){h.lightSources=null}if(h.power===undefined){h.power=0}h.lightSources=f.getLightSources();h.power=0.5;if(h.lightSources===undefined){h.lightSources=null}if(h.power===undefined){h.power=0}}else{throw new Error("invalid overload")}}return h}a.prototype.getLightSources=function(){if(this.lightSources.length===0){return this.lightSources}else{return this.lightSources.slice(0)}};a.prototype.setLightSources=function(c){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(c,this.lightSources)){var d=this.lightSources.length===0?this.lightSources:this.lightSources.slice(0);this.lightSources=c.length===0?c:c.slice(0);this.firePropertyChange("LIGHT_SOURCES",d,c)}};a.prototype.getPower=function(){return this.power};a.prototype.setPower=function(d){if(d!==this.power){var c=this.power;this.power=d;this.firePropertyChange("POWER",c,d)}};a.prototype.clone=function(){var c=this;return(function(e){if(b.prototype.clone!=undefined){return b.prototype.clone.call(c)}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(this)};return a}(HomePieceOfFurniture));HomeLight.__class="com.eteks.sweethome3d.model.HomeLight";HomeLight.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable","com.eteks.sweethome3d.model.Light"];HomeLight.__transients=["shapeCache","propertyChangeSupport"];var HomeDoorOrWindow=(function(b){__extends(a,b);function a(j,c){var h=this;if(((typeof j==="string")||j===null)&&((c!=null&&(c.constructor!=null&&c.constructor.__interfaces!=null&&c.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0))||c===null)){var d=arguments;h=b.call(this,j,c)||this;if(h.wallThickness===undefined){h.wallThickness=0}if(h.wallDistance===undefined){h.wallDistance=0}if(h.wallWidth===undefined){h.wallWidth=0}if(h.wallLeft===undefined){h.wallLeft=0}if(h.wallHeight===undefined){h.wallHeight=0}if(h.wallTop===undefined){h.wallTop=0}if(h.wallCutOutOnBothSides===undefined){h.wallCutOutOnBothSides=false}if(h.widthDepthDeformable===undefined){h.widthDepthDeformable=false}if(h.sashes===undefined){h.sashes=null}if(h.cutOutShape===undefined){h.cutOutShape=null}if(h.boundToWall===undefined){h.boundToWall=false}h.wallThickness=c.getWallThickness();h.wallDistance=c.getWallDistance();h.wallWidth=1;h.wallLeft=0;h.wallHeight=1;h.wallTop=0;h.wallCutOutOnBothSides=c.isWallCutOutOnBothSides();h.widthDepthDeformable=c.isWidthDepthDeformable();h.sashes=c.getSashes();h.cutOutShape=c.getCutOutShape()}else{if(((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0))||j===null)&&c===undefined){var d=arguments;var g=d[0];var e=arguments;var f=HomeObject.createId("doorOrWindow");h=b.call(this,f,g)||this;if(h.wallThickness===undefined){h.wallThickness=0}if(h.wallDistance===undefined){h.wallDistance=0}if(h.wallWidth===undefined){h.wallWidth=0}if(h.wallLeft===undefined){h.wallLeft=0}if(h.wallHeight===undefined){h.wallHeight=0}if(h.wallTop===undefined){h.wallTop=0}if(h.wallCutOutOnBothSides===undefined){h.wallCutOutOnBothSides=false}if(h.widthDepthDeformable===undefined){h.widthDepthDeformable=false}if(h.sashes===undefined){h.sashes=null}if(h.cutOutShape===undefined){h.cutOutShape=null}if(h.boundToWall===undefined){h.boundToWall=false}h.wallThickness=g.getWallThickness();h.wallDistance=g.getWallDistance();h.wallWidth=1;h.wallLeft=0;h.wallHeight=1;h.wallTop=0;h.wallCutOutOnBothSides=g.isWallCutOutOnBothSides();h.widthDepthDeformable=g.isWidthDepthDeformable();h.sashes=g.getSashes();h.cutOutShape=g.getCutOutShape();if(h.wallThickness===undefined){h.wallThickness=0}if(h.wallDistance===undefined){h.wallDistance=0}if(h.wallWidth===undefined){h.wallWidth=0}if(h.wallLeft===undefined){h.wallLeft=0}if(h.wallHeight===undefined){h.wallHeight=0}if(h.wallTop===undefined){h.wallTop=0}if(h.wallCutOutOnBothSides===undefined){h.wallCutOutOnBothSides=false}if(h.widthDepthDeformable===undefined){h.widthDepthDeformable=false}if(h.sashes===undefined){h.sashes=null}if(h.cutOutShape===undefined){h.cutOutShape=null}if(h.boundToWall===undefined){h.boundToWall=false}}else{throw new Error("invalid overload")}}return h}a.prototype.getWallThickness=function(){return this.wallThickness};a.prototype.setWallThickness=function(c){if(c!==this.wallThickness){var d=this.wallThickness;this.wallThickness=c;this.firePropertyChange("WALL_THICKNESS",d,c)}};a.prototype.getWallDistance=function(){return this.wallDistance};a.prototype.setWallDistance=function(c){if(c!==this.wallDistance){var d=this.wallDistance;this.wallDistance=c;this.firePropertyChange("WALL_DISTANCE",d,c)}};a.prototype.getWallWidth=function(){return this.wallWidth};a.prototype.setWallWidth=function(d){if(d!==this.wallWidth){var c=this.wallWidth;this.wallWidth=d;this.firePropertyChange("WALL_WIDTH",c,d)}};a.prototype.getWallLeft=function(){return this.wallLeft};a.prototype.setWallLeft=function(d){if(d!==this.wallLeft){var c=this.wallLeft;this.wallLeft=d;this.firePropertyChange("WALL_LEFT",c,d)}};a.prototype.getWallHeight=function(){return this.wallHeight};a.prototype.setWallHeight=function(c){if(c!==this.wallHeight){var d=this.wallHeight;this.wallHeight=c;this.firePropertyChange("WALL_HEIGHT",d,c)}};a.prototype.getWallTop=function(){return this.wallTop};a.prototype.setWallTop=function(d){if(d!==this.wallTop){var c=this.wallTop;this.wallTop=d;this.firePropertyChange("WALL_TOP",c,d)}};a.prototype.getSashes=function(){if(this.sashes.length===0){return this.sashes}else{return this.sashes.slice(0)}};a.prototype.setSashes=function(d){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.sashes)){var c=this.sashes.length===0?this.sashes:this.sashes.slice(0);this.sashes=d.length===0?d:d.slice(0);this.firePropertyChange("SASHES",c,d)}};a.prototype.getCutOutShape=function(){return this.cutOutShape};a.prototype.setCutOutShape=function(c){if(c!==this.cutOutShape&&(c==null||!(c===this.cutOutShape))){var d=this.cutOutShape;this.cutOutShape=c;this.firePropertyChange("CUT_OUT_SHAPE",d,c)}};a.prototype.isWallCutOutOnBothSides=function(){return this.wallCutOutOnBothSides};a.prototype.setWallCutOutOnBothSides=function(c){if(c!==this.wallCutOutOnBothSides){this.wallCutOutOnBothSides=c;this.firePropertyChange("WALL_CUT_OUT_ON_BOTH_SIDES",!c,c)}};a.prototype.isWidthDepthDeformable=function(){return this.widthDepthDeformable};a.prototype.setWidthDepthDeformable=function(c){if(c!==this.widthDepthDeformable){this.widthDepthDeformable=c;this.firePropertyChange("WIDTH_DEPTH_DEFORMABLE",!c,c)}};a.prototype.isBoundToWall=function(){return this.boundToWall};a.prototype.setBoundToWall=function(c){if(c!==this.boundToWall){this.boundToWall=c;this.firePropertyChange("BOUND_TO_WALL",!c,c)}};a.prototype.setX=function(c){if(this.getX()!==c){this.boundToWall=false}b.prototype.setX.call(this,c)};a.prototype.setY=function(c){if(this.getY()!==c){this.boundToWall=false}b.prototype.setY.call(this,c)};a.prototype.setAngle=function(c){if(this.getAngle()!==c){this.boundToWall=false}b.prototype.setAngle.call(this,c)};a.prototype.setDepth=function(c){if(this.getDepth()!==c){this.boundToWall=false}b.prototype.setDepth.call(this,c)};a.prototype.isDoorOrWindow=function(){return true};a.prototype.duplicate=function(){var c=b.prototype.duplicate.call(this);c.boundToWall=false;return c};return a}(HomePieceOfFurniture));HomeDoorOrWindow.__class="com.eteks.sweethome3d.model.HomeDoorOrWindow";HomeDoorOrWindow.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.DoorOrWindow","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable"];HomeDoorOrWindow.__transients=["shapeCache","propertyChangeSupport"];var HomeFurnitureGroup=(function(b){__extends(a,b);function a(t,q,z,y,J){var w=this;if(((typeof t==="string")||t===null)&&((q!=null&&(q instanceof Array))||q===null)&&((typeof z==="number")||z===null)&&((typeof y==="boolean")||y===null)&&((typeof J==="string")||J===null)){var m=arguments;w=b.call(this,t,q[0])||this;if(w.furniture===undefined){w.furniture=null}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(w.fixedWidth===undefined){w.fixedWidth=0}if(w.fixedDepth===undefined){w.fixedDepth=0}if(w.fixedHeight===undefined){w.fixedHeight=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(w.furnitureListener===undefined){w.furnitureListener=null}w.furniture=q.slice(0);w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=true;w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=true;w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=true;var l=true;var j=false;for(var n=0;n<q.length;n++){var k=q[n];l=k.isMovable()&&l;j=k.isVisible()||j}w.setName(J);w.setCatalogId(null);w.setDescription(null);w.setInformation(null);w.setCreator(null);w.setNameVisible(false);w.setNameXOffset(0);w.setNameYOffset(0);w.setNameAngle(0);w.setNameStyle(null);b.prototype.setMovable.call(w,l);b.prototype.setAngle.call(w,z);b.prototype.setModelMirrored.call(w,y);w.setVisible(j);w.updateLocationAndSize(q,z,true);w.addFurnitureListener()}else{if(((t!=null&&(t instanceof Array))||t===null)&&((typeof q==="number")||q===null)&&((typeof z==="boolean")||z===null)&&((typeof y==="string")||y===null)&&J===undefined){var m=arguments;var r=m[0];var G=m[1];var f=m[2];var x=m[3];var I=arguments;var h=HomeObject.createId("furnitureGroup");w=b.call(this,h,r[0])||this;if(w.furniture===undefined){w.furniture=null}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(w.fixedWidth===undefined){w.fixedWidth=0}if(w.fixedDepth===undefined){w.fixedDepth=0}if(w.fixedHeight===undefined){w.fixedHeight=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(w.furnitureListener===undefined){w.furnitureListener=null}w.furniture=r.slice(0);w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=true;w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=true;w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=true;var l=true;var j=false;for(var n=0;n<r.length;n++){var k=r[n];l=k.isMovable()&&l;j=k.isVisible()||j}w.setName(x);w.setCatalogId(null);w.setDescription(null);w.setInformation(null);w.setCreator(null);w.setNameVisible(false);w.setNameXOffset(0);w.setNameYOffset(0);w.setNameAngle(0);w.setNameStyle(null);b.prototype.setMovable.call(w,l);b.prototype.setAngle.call(w,G);b.prototype.setModelMirrored.call(w,f);w.setVisible(j);w.updateLocationAndSize(r,G,true);w.addFurnitureListener();if(w.furniture===undefined){w.furniture=null}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(w.fixedWidth===undefined){w.fixedWidth=0}if(w.fixedDepth===undefined){w.fixedDepth=0}if(w.fixedHeight===undefined){w.fixedHeight=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(w.furnitureListener===undefined){w.furnitureListener=null}}else{if(((t!=null&&(t instanceof Array))||t===null)&&((q!=null&&q instanceof HomePieceOfFurniture)||q===null)&&((typeof z==="string")||z===null)&&y===undefined&&J===undefined){var m=arguments;var p=m[0];var s=m[1];var v=m[2];var H=arguments;var E=s.getAngle();var d=false;var F=arguments;var g=HomeObject.createId("furnitureGroup");w=b.call(this,g,p[0])||this;if(w.furniture===undefined){w.furniture=null}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(w.fixedWidth===undefined){w.fixedWidth=0}if(w.fixedDepth===undefined){w.fixedDepth=0}if(w.fixedHeight===undefined){w.fixedHeight=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(w.furnitureListener===undefined){w.furnitureListener=null}w.furniture=p.slice(0);w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=true;w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=true;w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=true;var l=true;var j=false;for(var n=0;n<p.length;n++){var k=p[n];l=k.isMovable()&&l;j=k.isVisible()||j}w.setName(v);w.setCatalogId(null);w.setDescription(null);w.setInformation(null);w.setCreator(null);w.setNameVisible(false);w.setNameXOffset(0);w.setNameYOffset(0);w.setNameAngle(0);w.setNameStyle(null);b.prototype.setMovable.call(w,l);b.prototype.setAngle.call(w,E);b.prototype.setModelMirrored.call(w,d);w.setVisible(j);w.updateLocationAndSize(p,E,true);w.addFurnitureListener();if(w.furniture===undefined){w.furniture=null}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(w.fixedWidth===undefined){w.fixedWidth=0}if(w.fixedDepth===undefined){w.fixedDepth=0}if(w.fixedHeight===undefined){w.fixedHeight=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(w.furnitureListener===undefined){w.furnitureListener=null}if(w.furniture===undefined){w.furniture=null}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(w.fixedWidth===undefined){w.fixedWidth=0}if(w.fixedDepth===undefined){w.fixedDepth=0}if(w.fixedHeight===undefined){w.fixedHeight=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(w.furnitureListener===undefined){w.furnitureListener=null}}else{if(((t!=null&&(t instanceof Array))||t===null)&&((typeof q==="string")||q===null)&&z===undefined&&y===undefined&&J===undefined){var m=arguments;var o=m[0];var u=m[1];var D=arguments;var s=D[0][0];var C=arguments;var B=s.getAngle();var c=false;var A=arguments;var e=HomeObject.createId("furnitureGroup");w=b.call(this,e,o[0])||this;if(w.furniture===undefined){w.furniture=null}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(w.fixedWidth===undefined){w.fixedWidth=0}if(w.fixedDepth===undefined){w.fixedDepth=0}if(w.fixedHeight===undefined){w.fixedHeight=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(w.furnitureListener===undefined){w.furnitureListener=null}w.furniture=o.slice(0);w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=true;w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=true;w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=true;var l=true;var j=false;for(var n=0;n<o.length;n++){var k=o[n];l=k.isMovable()&&l;j=k.isVisible()||j}w.setName(u);w.setCatalogId(null);w.setDescription(null);w.setInformation(null);w.setCreator(null);w.setNameVisible(false);w.setNameXOffset(0);w.setNameYOffset(0);w.setNameAngle(0);w.setNameStyle(null);b.prototype.setMovable.call(w,l);b.prototype.setAngle.call(w,B);b.prototype.setModelMirrored.call(w,c);w.setVisible(j);w.updateLocationAndSize(o,B,true);w.addFurnitureListener();if(w.furniture===undefined){w.furniture=null}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(w.fixedWidth===undefined){w.fixedWidth=0}if(w.fixedDepth===undefined){w.fixedDepth=0}if(w.fixedHeight===undefined){w.fixedHeight=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(w.furnitureListener===undefined){w.furnitureListener=null}if(w.furniture===undefined){w.furniture=null}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(w.fixedWidth===undefined){w.fixedWidth=0}if(w.fixedDepth===undefined){w.fixedDepth=0}if(w.fixedHeight===undefined){w.fixedHeight=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(w.furnitureListener===undefined){w.furnitureListener=null}if(w.furniture===undefined){w.furniture=null}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(w.fixedWidth===undefined){w.fixedWidth=0}if(w.fixedDepth===undefined){w.fixedDepth=0}if(w.fixedHeight===undefined){w.fixedHeight=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){w.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(w.furnitureListener===undefined){w.furnitureListener=null}}else{throw new Error("invalid overload")}}}}return w}a.prototype.updateLocationAndSize=function(j,s,p){this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=true;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=true;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=true;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=true;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=j[0].getCurrency();for(var f=0;f<j.length;f++){var e=j[f];this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=e.isResizable()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=e.isDeformable()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=e.isTexturable()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=e.isDoorOrWindow()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow;if(this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency!=null){if(e.getCurrency()==null||!(e.getCurrency()===this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency)){this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}}}var m=3.4028235e+38;if(p){var u=null;for(var f=0;f<j.length;f++){var e=j[f];var c=e.getLevel();if(c!=null&&(u==null||c.getElevation()<u.getElevation())){u=c}}for(var f=0;f<j.length;f++){var e=j[f];if(e.getLevel()!=null){m=Math.min(m,e.getGroundElevation()-u.getElevation());e.setElevation(e.getGroundElevation()-u.getElevation());e.setLevel(null)}else{m=Math.min(m,e.getElevation())}}}else{for(var f=0;f<j.length;f++){var e=j[f];m=Math.min(m,e.getElevation())}}var k=0;var o=-1;for(var f=0;f<j.length;f++){var e=j[f];k=Math.max(k,e.getElevation()+e.getHeightInPlan());if(e.getDropOnTopElevation()>=0){o=Math.max(o,e.getElevation()+e.getHeightInPlan()*e.getDropOnTopElevation())}}k-=m;o-=m;var n=java.awt.geom.AffineTransform.getRotateInstance(-s);var h=null;var g=this.getFurnitureWithoutGroups(j);for(var f=0;f<g.length;f++){var e=g[f];var d=new java.awt.geom.GeneralPath();var q=e.getPoints();d.moveTo(q[0][0],q[0][1]);for(var r=1;r<q.length;r++){d.lineTo(q[r][0],q[r][1])}d.closePath();if(h==null){h=d.createTransformedShape(n).getBounds2D()}else{h.add(d.createTransformedShape(n).getBounds2D())}}var t=new java.awt.geom.Point2D.Float(h.getCenterX(),h.getCenterY());n.setToRotation(s);n.transform(t,t);if(this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable){var l=h.getWidth();b.prototype.setWidth.call(this,l);b.prototype.setWidthInPlan.call(this,l);var v=h.getHeight();b.prototype.setDepth.call(this,v);b.prototype.setDepthInPlan.call(this,v);b.prototype.setHeight.call(this,k);b.prototype.setHeightInPlan.call(this,k)}else{this.fixedWidth=h.getWidth();this.fixedDepth=h.getHeight();this.fixedHeight=k}this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=o/k;b.prototype.setX.call(this,t.getX());b.prototype.setY.call(this,t.getY());b.prototype.setElevation.call(this,m)};a.prototype.addFurnitureListener=function(){this.furnitureListener=new a.LocationAndSizeChangeListener(this);for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.addPropertyChangeListener(this.furnitureListener)}};a.prototype.getFurnitureWithoutGroups=function(f){var e=([]);for(var c=0;c<f.length;c++){var d=f[c];if(d!=null&&d instanceof a){(function(h,g){return h.push.apply(h,g)})(e,this.getFurnitureWithoutGroups(d.getFurniture()))}else{(e.push(d)>0)}}return e};a.prototype.getAllFurniture=function(){var e=(this.furniture.slice(0));var f=this.getFurniture();for(var c=0;c<f.length;c++){var d=f[c];if(d!=null&&d instanceof a){(function(h,g){return h.push.apply(h,g)})(e,d.getAllFurniture())}}return e};a.prototype.getFurniture=function(){return this.furniture.slice(0)};a.prototype.addPieceOfFurniture=function(d,c){this.furniture=(this.furniture.slice(0));d.setLevel(this.getLevel());this.furniture.splice(c,0,d);d.addPropertyChangeListener(this.furnitureListener);this.updateLocationAndSize(this.furniture,this.getAngle(),false)};a.prototype.deletePieceOfFurniture=function(d){var c=this.furniture.indexOf(d);if(c!==-1){if(this.furniture.length>1){d.setLevel(null);d.removePropertyChangeListener(this.furnitureListener);this.furniture=(this.furniture.slice(0));this.furniture.splice(c,1)[0];this.updateLocationAndSize(this.furniture,this.getAngle(),false)}else{throw new IllegalStateException("Group can't be empty")}}};a.prototype.getCatalogId=function(){return b.prototype.getCatalogId.call(this)};a.prototype.getInformation=function(){return b.prototype.getInformation.call(this)};a.prototype.isMovable=function(){return b.prototype.isMovable.call(this)};a.prototype.setMovable=function(c){b.prototype.setMovable.call(this,c)};a.prototype.isDoorOrWindow=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow};a.prototype.isResizable=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable};a.prototype.isDeformable=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable};a.prototype.isTexturable=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable};a.prototype.isHorizontallyRotatable=function(){return false};a.prototype.getWidth=function(){if(!this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable){return this.fixedWidth}else{return b.prototype.getWidth.call(this)}};a.prototype.getWidthInPlan=function(){return this.getWidth()};a.prototype.getDepth=function(){if(!this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable){return this.fixedDepth}else{return b.prototype.getDepth.call(this)}};a.prototype.getDepthInPlan=function(){return this.getDepth()};a.prototype.getHeight=function(){if(!this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable){return this.fixedHeight}else{return b.prototype.getHeight.call(this)}};a.prototype.getHeightInPlan=function(){return this.getHeight()};a.prototype.isHorizontallyRotated=function(){if(b.prototype.isHorizontallyRotated.call(this)){return true}else{var e=this.getFurniture();for(var d=0;d<e.length;d++){var c=e[d];if(c.isHorizontallyRotated()){return true}}return false}};a.prototype.getDropOnTopElevation=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation};a.prototype.getIcon=function(){return null};a.prototype.setIcon=function(c){throw new IllegalStateException("Can't set icon of a group")};a.prototype.getPlanIcon=function(){return null};a.prototype.setPlanIcon=function(c){throw new IllegalStateException("Can't set plan icon of a group")};a.prototype.getModel=function(){return null};a.prototype.setModel=function(c){throw new IllegalStateException("Can't set model of a group")};a.prototype.getModelSize=function(){return null};a.prototype.setModelSize=function(c){throw new IllegalStateException("Can't set model size of a group")};a.prototype.getModelRotation=function(){return PieceOfFurniture.IDENTITY_ROTATION_$LI$()};a.prototype.setModelRotation=function(c){throw new IllegalStateException("Can't set model rotation of a group")};a.prototype.isModelCenteredAtOrigin=function(){return true};a.prototype.isBackFaceShown=function(){return false};a.prototype.setBackFaceShown=function(c){throw new IllegalStateException("Can't set back face shown attribute of a group")};a.prototype.getModelTransformations=function(){return null};a.prototype.setModelTransformations=function(e){if(this.isDeformable()){for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.setModelTransformations(e)}}};a.prototype.getPitch=function(){return 0};a.prototype.getRoll=function(){return 0};a.prototype.getStaircaseCutOutShape=function(){return null};a.prototype.setStaircaseCutOutShape=function(c){throw new IllegalStateException("Can't set staircase cut out shape of a group")};a.prototype.getCreator=function(){return b.prototype.getCreator.call(this)};a.prototype.getPrice=function(){var e=null;for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];if(d.getPrice()!=null){if(e==null){e=d.getPrice()}else{e=e.plus(d.getPrice())}}}if(e==null){return b.prototype.getPrice.call(this)}else{return e}};a.prototype.setPrice=function(e){for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];if(d.getPrice()!=null){throw new UnsupportedOperationException("Can't change the price of a group containing pieces with a price")}}b.prototype.setPrice.call(this,e)};a.prototype.getValueAddedTaxPercentage=function(){var e=this.furniture[0].getValueAddedTaxPercentage();if(e!=null){for(var d=0;d<this.furniture.length;d++){var f=this.furniture[d];var c=f.getValueAddedTaxPercentage();if(c==null||!((e)!=null?c.eq(e):(c===(e)))){return null}}}return e};a.prototype.getCurrency=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency};a.prototype.getValueAddedTax=function(){var c=null;for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];var f=e.getValueAddedTax();if(f!=null){if(c==null){c=f}else{c=c.plus(f)}}}return c};a.prototype.getPriceValueAddedTaxIncluded=function(){var c=null;for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];if(e.getPrice()!=null){if(c==null){c=e.getPriceValueAddedTaxIncluded()}else{c=c.plus(e.getPriceValueAddedTaxIncluded())}}}return c};a.prototype.getColor=function(){return null};a.prototype.setColor=function(c){if(this.isTexturable()){for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];e.setColor(c)}}};a.prototype.getTexture=function(){return null};a.prototype.setTexture=function(e){if(this.isTexturable()){for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.setTexture(e)}}};a.prototype.getModelMaterials=function(){return null};a.prototype.setModelMaterials=function(d){if(this.isTexturable()){for(var c=0;c<this.furniture.length;c++){var e=this.furniture[c];e.setModelMaterials(d)}}};a.prototype.getShininess=function(){return null};a.prototype.setShininess=function(d){if(this.isTexturable()){for(var c=0;c<this.furniture.length;c++){var e=this.furniture[c];e.setShininess(d)}}};a.prototype.setAngle=function(k){if(k!==this.getAngle()){var c=k-this.getAngle();var f=Math.cos(c);var g=Math.sin(c);for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];e.removePropertyChangeListener(this.furnitureListener);e.setAngle(e.getAngle()+c);var j=this.getX()+((e.getX()-this.getX())*f-(e.getY()-this.getY())*g);var h=this.getY()+((e.getX()-this.getX())*g+(e.getY()-this.getY())*f);e.setX(j);e.setY(h);e.addPropertyChangeListener(this.furnitureListener)}b.prototype.setAngle.call(this,k)}};a.prototype.setX=function(c){if(c!==this.getX()){var d=c-this.getX();for(var e=0;e<this.furniture.length;e++){var f=this.furniture[e];f.removePropertyChangeListener(this.furnitureListener);f.setX(f.getX()+d);f.addPropertyChangeListener(this.furnitureListener)}b.prototype.setX.call(this,c)}};a.prototype.setY=function(f){if(f!==this.getY()){var c=f-this.getY();for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];e.removePropertyChangeListener(this.furnitureListener);e.setY(e.getY()+c);e.addPropertyChangeListener(this.furnitureListener)}b.prototype.setY.call(this,f)}};a.prototype.setWidth=function(d){if(d!==this.getWidth()){var k=d/this.getWidth();var h=this.getAngle();for(var j=0;j<this.furniture.length;j++){var o=this.furniture[j];o.removePropertyChangeListener(this.furnitureListener);var g=o.getAngle()-h;var m=o.getWidth();var e=o.getDepth();o.setWidth(m+m*(k-1)*Math.abs(Math.cos(g)));o.setDepth(e+e*(k-1)*Math.abs(Math.sin(g)));var l=Math.cos(h);var f=Math.sin(h);var c=this.getX()+((o.getX()-this.getX())*l+(o.getY()-this.getY())*f);var n=this.getY()+((o.getX()-this.getX())*-f+(o.getY()-this.getY())*l);c=this.getX()+(c-this.getX())*k;o.setX(this.getX()+((c-this.getX())*l-(n-this.getY())*f));o.setY(this.getY()+((c-this.getX())*f+(n-this.getY())*l));o.addPropertyChangeListener(this.furnitureListener)}b.prototype.setWidth.call(this,d)}};a.prototype.setDepth=function(j){if(j!==this.getDepth()){var d=j/this.getDepth();var h=this.getAngle();for(var k=0;k<this.furniture.length;k++){var o=this.furniture[k];o.removePropertyChangeListener(this.furnitureListener);var g=o.getAngle()-h;var m=o.getWidth();var e=o.getDepth();o.setWidth(m+m*(d-1)*Math.abs(Math.sin(g)));o.setDepth(e+e*(d-1)*Math.abs(Math.cos(g)));var l=Math.cos(h);var f=Math.sin(h);var c=this.getX()+((o.getX()-this.getX())*l+(o.getY()-this.getY())*f);var n=this.getY()+((o.getX()-this.getX())*-f+(o.getY()-this.getY())*l);n=this.getY()+(n-this.getY())*d;o.setX(this.getX()+((c-this.getX())*l-(n-this.getY())*f));o.setY(this.getY()+((c-this.getX())*f+(n-this.getY())*l));o.addPropertyChangeListener(this.furnitureListener)}b.prototype.setDepth.call(this,j)}};a.prototype.setHeight=function(c){if(c!==this.getHeight()){var e=c/this.getHeight();for(var d=0;d<this.furniture.length;d++){var f=this.furniture[d];f.removePropertyChangeListener(this.furnitureListener);f.setHeight(f.getHeight()*e);f.setElevation(this.getElevation()+(f.getElevation()-this.getElevation())*e);f.addPropertyChangeListener(this.furnitureListener)}b.prototype.setHeight.call(this,c)}};a.prototype.scale=function(k){var j=this.getAngle();for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];e.removePropertyChangeListener(this.furnitureListener);e.setWidth(e.getWidth()*k);e.setDepth(e.getDepth()*k);e.setHeight(e.getHeight()*k);var c=Math.cos(j);var f=Math.sin(j);var h=this.getX()+((e.getX()-this.getX())*c+(e.getY()-this.getY())*f);var g=this.getY()+((e.getX()-this.getX())*-f+(e.getY()-this.getY())*c);h=this.getX()+(h-this.getX())*k;g=this.getY()+(g-this.getY())*k;e.setX(this.getX()+((h-this.getX())*c-(g-this.getY())*f));e.setY(this.getY()+((h-this.getX())*f+(g-this.getY())*c));e.setElevation(this.getElevation()+(e.getElevation()-this.getElevation())*k);e.addPropertyChangeListener(this.furnitureListener)}b.prototype.setWidth.call(this,this.getWidth()*k);b.prototype.setDepth.call(this,this.getDepth()*k);b.prototype.setHeight.call(this,this.getHeight()*k)};a.prototype.setElevation=function(e){if(e!==this.getElevation()){var f=e-this.getElevation();for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.removePropertyChangeListener(this.furnitureListener);d.setElevation(d.getElevation()+f);d.addPropertyChangeListener(this.furnitureListener)}b.prototype.setElevation.call(this,e)}};a.prototype.setModelMirrored=function(c){if(c!==this.isModelMirrored()){var k=this.getAngle();for(var e=0;e<this.furniture.length;e++){var f=this.furniture[e];f.removePropertyChangeListener(this.furnitureListener);f.setModelMirrored(!f.isModelMirrored());var d=Math.cos(k);var g=Math.sin(k);var j=this.getX()+((f.getX()-this.getX())*d+(f.getY()-this.getY())*g);var h=this.getY()+((f.getX()-this.getX())*-g+(f.getY()-this.getY())*d);j=this.getX()-(j-this.getX());f.setX(this.getX()+((j-this.getX())*d-(h-this.getY())*g));f.setY(this.getY()+((j-this.getX())*g+(h-this.getY())*d));f.addPropertyChangeListener(this.furnitureListener)}b.prototype.setModelMirrored.call(this,c)}};a.prototype.setVisible=function(e){for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.setVisible(e)}b.prototype.setVisible.call(this,e)};a.prototype.setLevel=function(e){for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.setLevel(e)}b.prototype.setLevel.call(this,e)};a.prototype.intersectsRectangle=function(e,h,d,g){for(var c=0;c<this.furniture.length;c++){var f=this.furniture[c];if(f.intersectsRectangle(e,h,d,g)){return true}}return false};a.prototype.containsPoint=function(c,g,f){for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];if(e.containsPoint(c,g,f)){return true}}return false};a.prototype.duplicate=function(){var g=b.prototype.duplicate.call(this);var c=([]);for(var d=0;d<g.furniture.length;d++){var f=g.furniture[d];f.removePropertyChangeListener(g.furnitureListener);var e=f.duplicate();(c.push(e)>0);e.addPropertyChangeListener(g.furnitureListener)}g.furniture=c.slice(0);return g};a.prototype.clone=function(){var f=this;var e=(function(j){if(b.prototype.clone!=undefined){return b.prototype.clone.call(f)}else{var g=Object.create(j);for(var h in j){if(j.hasOwnProperty(h)){g[h]=j[h]}}return g}})(this);e.furniture=([]);for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];(e.furniture.push((function(j){if(j.clone!=undefined){return j.clone()}else{var h=Object.create(j);for(var g in j){if(j.hasOwnProperty(g)){h[g]=j[g]}}return h}})(d))>0)}e.furniture=e.furniture.slice(0);e.addFurnitureListener();return e};return a}(HomePieceOfFurniture));HomeFurnitureGroup.__class="com.eteks.sweethome3d.model.HomeFurnitureGroup";HomeFurnitureGroup.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable"];(function(a){var b=(function(){function c(d){if(this.group===undefined){this.group=null}this.group=(d)}c.prototype.propertyChange=function(d){var e=this.group;if(e==null){d.getSource().removePropertyChangeListener(this)}else{if(("X"===d.getPropertyName())||("Y"===d.getPropertyName())||("ELEVATION"===d.getPropertyName())||("ANGLE"===d.getPropertyName())||("WIDTH_IN_PLAN"===d.getPropertyName())||("DEPTH_IN_PLAN"===d.getPropertyName())||("HEIGHT_IN_PLAN"===d.getPropertyName())){e.updateLocationAndSize(e.getFurniture(),e.getAngle(),false)}}};return c}());a.LocationAndSizeChangeListener=b;b.__class="com.eteks.sweethome3d.model.HomeFurnitureGroup.LocationAndSizeChangeListener"})(HomeFurnitureGroup||(HomeFurnitureGroup={}));HomeFurnitureGroup.__transients=["furnitureListener","shapeCache","propertyChangeSupport"];var ObserverCamera=(function(b){__extends(a,b);function a(d,r,p,n,h,e,j){var l=this;if(((typeof d==="string")||d===null)&&((typeof r==="number")||r===null)&&((typeof p==="number")||p===null)&&((typeof n==="number")||n===null)&&((typeof h==="number")||h===null)&&((typeof e==="number")||e===null)&&((typeof j==="number")||j===null)){var k=arguments;l=b.call(this,d,r,p,n,h,e,j)||this;if(l.fixedSize===undefined){l.fixedSize=false}if(l.shapeCache===undefined){l.shapeCache=null}if(l.rectangleShapeCache===undefined){l.rectangleShapeCache=null}}else{if(((typeof d==="number")||d===null)&&((typeof r==="number")||r===null)&&((typeof p==="number")||p===null)&&((typeof n==="number")||n===null)&&((typeof h==="number")||h===null)&&((typeof e==="number")||e===null)&&j===undefined){var k=arguments;var o=k[0];var s=k[1];var f=k[2];var q=k[3];var g=k[4];var t=k[5];var c=arguments;var m=HomeObject.createId("observerCamera");l=b.call(this,m,o,s,f,q,g,t)||this;if(l.fixedSize===undefined){l.fixedSize=false}if(l.shapeCache===undefined){l.shapeCache=null}if(l.rectangleShapeCache===undefined){l.rectangleShapeCache=null}if(l.fixedSize===undefined){l.fixedSize=false}if(l.shapeCache===undefined){l.shapeCache=null}if(l.rectangleShapeCache===undefined){l.rectangleShapeCache=null}}else{throw new Error("invalid overload")}}return l}a.prototype.setFixedSize=function(e){if(this.fixedSize!==e){var c=this.getWidth();var d=this.getDepth();var f=this.getHeight();this.fixedSize=e;this.shapeCache=null;this.rectangleShapeCache=null;this.firePropertyChange("WIDTH",c,this.getWidth());this.firePropertyChange("DEPTH",d,this.getDepth());this.firePropertyChange("HEIGHT",f,this.getHeight())}};a.prototype.isFixedSize=function(){return this.fixedSize};a.prototype.setYaw=function(c){b.prototype.setYaw.call(this,c);this.shapeCache=null;this.rectangleShapeCache=null};a.prototype.setX=function(c){b.prototype.setX.call(this,c);this.shapeCache=null;this.rectangleShapeCache=null};a.prototype.setY=function(c){b.prototype.setY.call(this,c);this.shapeCache=null;this.rectangleShapeCache=null};a.prototype.setZ=function(e){var c=this.getWidth();var d=this.getDepth();var f=this.getHeight();b.prototype.setZ.call(this,e);this.shapeCache=null;this.rectangleShapeCache=null;this.firePropertyChange("WIDTH",c,this.getWidth());this.firePropertyChange("DEPTH",d,this.getDepth());this.firePropertyChange("HEIGHT",f,this.getHeight())};a.prototype.getWidth=function(){if(this.fixedSize){return 46.6}else{var c=this.getZ()*4/14;return Math.min(Math.max(c,20),62.5)}};a.prototype.getDepth=function(){if(this.fixedSize){return 18.6}else{var c=this.getZ()*8/70;return Math.min(Math.max(c,8),25)}};a.prototype.getHeight=function(){if(this.fixedSize){return 175}else{return this.getZ()*15/14}};a.prototype.getPoints=function(){var e=(function(g){var f=function(j){if(j.length===0){return 0}else{var k=[];for(var h=0;h<j[0];h++){k.push(f(j.slice(1)))}return k}};return f(g)})([4,2]);var d=this.getRectangleShape().getPathIterator(null);for(var c=0;c<e.length;c++){d.currentSegment(e[c]);d.next()}return e};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape().intersects(d)};a.prototype.containsPoint=function(c,e,d){if(d===0){return this.getShape().contains(c,e)}else{return this.getShape().intersects(c-d,e-d,2*d,2*d)}};a.prototype.getShape=function(){if(this.shapeCache==null){var c=new java.awt.geom.Ellipse2D.Float(this.getX()-this.getWidth()/2,this.getY()-this.getDepth()/2,this.getWidth(),this.getDepth());var d=java.awt.geom.AffineTransform.getRotateInstance(this.getYaw(),this.getX(),this.getY());var f=c.getPathIterator(d);var e=new java.awt.geom.GeneralPath();e.append(f,false);this.shapeCache=e}return this.shapeCache};a.prototype.getRectangleShape=function(){if(this.rectangleShapeCache==null){var c=new java.awt.geom.Rectangle2D.Float(this.getX()-this.getWidth()/2,this.getY()-this.getDepth()/2,this.getWidth(),this.getDepth());var d=java.awt.geom.AffineTransform.getRotateInstance(this.getYaw(),this.getX(),this.getY());var e=c.getPathIterator(d);var f=new java.awt.geom.GeneralPath();f.append(e,false);this.rectangleShapeCache=f}return this.rectangleShapeCache};a.prototype.move=function(d,c){this.setX(this.getX()+d);this.setY(this.getY()+c)};a.prototype.clone=function(){var c=this;return(function(e){if(b.prototype.clone!=undefined){return b.prototype.clone.call(c)}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(this)};return a}(Camera));ObserverCamera.__class="com.eteks.sweethome3d.model.ObserverCamera";ObserverCamera.__interfaces=["com.eteks.sweethome3d.model.Selectable"];ObserverCamera.__transients=["shapeCache","rectangleShapeCache","lens","propertyChangeSupport"];var Home=(function(){function a(h,b){if(((h!=null&&(h instanceof Array))||h===null)&&((typeof b==="number")||b===null)){var g=arguments;if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}this.furniture=(h.slice(0));this.walls=([]);this.wallHeight=b;this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0);this.init(true);this.addModelListeners()}else{if(((h!=null&&(h instanceof Array))||h===null)&&b===undefined){var g=arguments;var c=arguments;var n=250;if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}this.furniture=(h.slice(0));this.walls=([]);this.wallHeight=n;this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0);this.init(true);this.addModelListeners();if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}}else{if(((h!=null&&h instanceof a)||h===null)&&b===undefined){var g=arguments;var j=g[0];if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}this.wallHeight=j.getWallHeight();a.copyHomeData(j,this);a.initListenersSupport(this);this.addModelListeners()}else{if(((typeof h==="number")||h===null)&&b===undefined){var g=arguments;var m=g[0];var o=arguments;var f=[];if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}this.furniture=(f.slice(0));this.walls=([]);this.wallHeight=m;this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0);this.init(true);this.addModelListeners();if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}}else{if(h===undefined&&b===undefined){var g=arguments;var l=arguments;var k=250;var d=arguments;var e=[];if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}this.furniture=(e.slice(0));this.walls=([]);this.wallHeight=k;this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0);this.init(true);this.addModelListeners();if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}}else{throw new Error("invalid overload")}}}}}}a.LEVEL_ELEVATION_COMPARATOR_$LI$=function(){if(a.LEVEL_ELEVATION_COMPARATOR==null){a.LEVEL_ELEVATION_COMPARATOR=function(d,c){var b=(d.getElevation()-c.getElevation());if(b!==0){return b}else{return d.getElevationIndex()-c.getElevationIndex()}}}return a.LEVEL_ELEVATION_COMPARATOR};a.prototype.moveVisualProperty=function(b){var d=this;if(this.visualProperties.hasOwnProperty(b)){var c=(function(e,f){return e[f]===undefined?null:e[f]})(this.visualProperties,b);(this.properties[b]=c!=null?String(c).toString():null);(function(f){var e=d.visualProperties[b];delete d.visualProperties[b];return e})(this.visualProperties)}};a.prototype.init=function(b){this.selectedItems=([]);a.initListenersSupport(this);if(this.furnitureVisibleProperties==null){this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","COLOR","MOVABLE","DOOR_OR_WINDOW","VISIBLE"].slice(0)}this.topCamera=new Camera(a.HOME_TOP_CAMERA_ID,50,1050,1010,Math.PI,Math.PI/4,Math.PI*63/180);this.observerCamera=new ObserverCamera(a.HOME_OBSERVER_CAMERA_ID,50,50,170,7*Math.PI/4,Math.PI/16,Math.PI*63/180);this.storedCameras=[];this.environment=new HomeEnvironment(a.HOME_ENVIRONMENT_ID);this.rooms=([]);this.polylines=([]);this.dimensionLines=([]);this.labels=([]);this.compass=new Compass(a.HOME_COMPASS_ID,-100,50,100);this.levels=([]);this.compass.setVisible(b);this.visualProperties=({});this.properties=({});this.version=a.CURRENT_VERSION};a.initListenersSupport=function(b){b.furnitureChangeSupport=(new CollectionChangeSupport(b));b.selectionListeners=([]);b.levelsChangeSupport=(new CollectionChangeSupport(b));b.wallsChangeSupport=(new CollectionChangeSupport(b));b.roomsChangeSupport=(new CollectionChangeSupport(b));b.polylinesChangeSupport=(new CollectionChangeSupport(b));b.dimensionLinesChangeSupport=(new CollectionChangeSupport(b));b.labelsChangeSupport=(new CollectionChangeSupport(b));b.propertyChangeSupport=new PropertyChangeSupport(b)};a.prototype.addModelListeners=function(){var c=new a.Home$0(this);for(var b=0;b<this.levels.length;b++){var d=this.levels[b];d.addPropertyChangeListener(c)}this.addLevelsListener(function(e){switch((e.getType())){case CollectionEvent.Type.ADD:e.getItem().addPropertyChangeListener(c);break;case CollectionEvent.Type.DELETE:e.getItem().removePropertyChangeListener(c);break}})};a.prototype.isFurnitureSortedPropertyBackwardCompatible=function(b){switch((b)){case"NAME":case"WIDTH":case"DEPTH":case"HEIGHT":case"MOVABLE":case"DOOR_OR_WINDOW":case"COLOR":case"VISIBLE":case"X":case"Y":case"ELEVATION":case"ANGLE":return true;default:return false}};a.prototype.getGroupFurniture=function(d){var c=([]);var f=d.getFurniture();for(var b=0;b<f.length;b++){var e=f[b];if(e!=null&&e instanceof HomeFurnitureGroup){(function(h,g){return h.push.apply(h,g)})(c,this.getGroupFurniture(e))}else{(c.push(e)>0)}}return c};a.prototype.addLevelsListener=function(b){this.levelsChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeLevelsListener=function(b){this.levelsChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getLevels=function(){return this.levels.slice(0)};a.prototype.addLevel=function(g){if(g.getElevationIndex()<0){var d=0;for(var c=0;c<this.levels.length;c++){var b=this.levels[c];if(b.getElevation()===g.getElevation()){d=b.getElevationIndex()+1}else{if(b.getElevation()>g.getElevation()){break}}}g.setElevationIndex(d)}this.levels=(this.levels.slice(0));var e=(function(h,r,n){var m=n;if(typeof n!="function"){m=function(s,l){return n.compare(s,l)}}var o=0;var j=h.length-1;while(o<=j){var q=(o+j)>>>1;var k=h[q];var p=m(k,r);if(p<0){o=q+1}else{if(p>0){j=q-1}else{return q}}}return -(o+1)})(this.levels,g,a.LEVEL_ELEVATION_COMPARATOR_$LI$());var f;if(e>=0){f=e}else{f=-(e+1)}this.levels.splice(f,0,g);this.levelsChangeSupport.fireCollectionChanged(g,f,CollectionEvent.Type.ADD)};a.prototype.deleteLevel=function(c){var d=this.levels.indexOf(c);if(d!==-1){for(var e=0;e<this.furniture.length;e++){var k=this.furniture[e];if(k.getLevel()===c){this.deletePieceOfFurniture(k)}}for(var e=0;e<this.rooms.length;e++){var b=this.rooms[e];if(b.getLevel()===c){this.deleteRoom(b)}}for(var e=0;e<this.walls.length;e++){var h=this.walls[e];if(h.getLevel()===c){this.deleteWall(h)}}for(var e=0;e<this.polylines.length;e++){var g=this.polylines[e];if(g.getLevel()===c){this.deletePolyline(g)}}for(var e=0;e<this.dimensionLines.length;e++){var j=this.dimensionLines[e];if(j.getLevel()===c){this.deleteDimensionLine(j)}}for(var e=0;e<this.labels.length;e++){var f=this.labels[e];if(f.getLevel()===c){this.deleteLabel(f)}}if(this.selectedLevel===c){if(this.levels.length===1){this.setSelectedLevel(null);this.setAllLevelsSelection(false)}else{this.setSelectedLevel(this.levels[d>=1?d-1:d+1])}}this.levels=(this.levels.slice(0));this.levels.splice(d,1)[0];this.levelsChangeSupport.fireCollectionChanged(c,d,CollectionEvent.Type.DELETE)}};a.prototype.getSelectedLevel=function(){return this.selectedLevel};a.prototype.setSelectedLevel=function(c){if(c!==this.selectedLevel){var b=this.selectedLevel;this.selectedLevel=c;this.propertyChangeSupport.firePropertyChange("SELECTED_LEVEL",b,c)}};a.prototype.isAllLevelsSelection=function(){return this.allLevelsSelection};a.prototype.setAllLevelsSelection=function(b){if(b!==this.allLevelsSelection){this.allLevelsSelection=b;this.propertyChangeSupport.firePropertyChange("ALL_LEVELS_SELECTION",!b,b)}};a.prototype.addFurnitureListener=function(b){this.furnitureChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeFurnitureListener=function(b){this.furnitureChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getFurniture=function(){return this.furniture.slice(0)};a.prototype.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(b){this.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(b,this.furniture.length)};a.prototype.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int=function(c,b){this.furniture=(this.furniture.slice(0));c.setLevel(this.selectedLevel);this.furniture.splice(b,0,c);this.furnitureChangeSupport.fireCollectionChanged(c,b,CollectionEvent.Type.ADD)};a.prototype.addPieceOfFurniture=function(c,b){if(((c!=null&&c instanceof HomePieceOfFurniture)||c===null)&&((typeof b==="number")||b===null)){return this.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(c,b)}else{if(((c!=null&&c instanceof HomePieceOfFurniture)||c===null)&&b===undefined){return this.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(c)}else{throw new Error("invalid overload")}}};a.prototype.addPieceOfFurnitureToGroup=function(c,d,b){c.setLevel(this.selectedLevel);d.addPieceOfFurniture(c,b);this.furnitureChangeSupport.fireCollectionChanged(c,CollectionEvent.Type.ADD)};a.prototype.deletePieceOfFurniture=function(d){this.deselectItem(d);if(d!=null&&d instanceof HomeFurnitureGroup){var g=d.getAllFurniture();for(var b=0;b<g.length;b++){var f=g[b];this.deselectItem(f)}}var c=this.furniture.indexOf(d);var e=c===-1?this.getPieceOfFurnitureGroup(d,null,this.furniture):null;if(c!==-1||e!=null){d.setLevel(null);this.furniture=(this.furniture.slice(0));if(e!=null){e.deletePieceOfFurniture(d);this.furnitureChangeSupport.fireCollectionChanged(d,CollectionEvent.Type.DELETE)}else{this.furniture.splice(c,1)[0];this.furnitureChangeSupport.fireCollectionChanged(d,c,CollectionEvent.Type.DELETE)}}};a.prototype.getPieceOfFurnitureGroup=function(d,c,f){for(var b=0;b<f.length;b++){var e=f[b];if((function(j,h){if(j&&j.equals){return j.equals(h)}else{return j===h}})(e,d)){return c}else{if(e!=null&&e instanceof HomeFurnitureGroup){var g=this.getPieceOfFurnitureGroup(d,e,e.getFurniture());if(g!=null){return g}}}}return null};a.prototype.addSelectionListener=function(b){(this.selectionListeners.push(b)>0)};a.prototype.removeSelectionListener=function(b){(function(c){var d=c.indexOf(b);if(d>=0){c.splice(d,1);return true}else{return false}})(this.selectionListeners)};a.prototype.getSelectedItems=function(){return this.selectedItems.slice(0)};a.prototype.setSelectedItems=function(f){this.selectedItems=(f.slice(0));if(!(this.selectionListeners.length==0)){var b=new SelectionEvent(this,this.getSelectedItems());var d=this.selectionListeners.slice(0);for(var c=0;c<d.length;c++){var e=d[c];e.selectionChanged(b)}}};a.prototype.deselectItem=function(c){var b=this.selectedItems.indexOf(c);if(b!==-1){var d=(this.getSelectedItems().slice(0));d.splice(b,1)[0];this.setSelectedItems(d)}};a.prototype.addRoomsListener=function(b){this.roomsChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeRoomsListener=function(b){this.roomsChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getRooms=function(){return this.rooms.slice(0)};a.prototype.addRoom$com_eteks_sweethome3d_model_Room=function(b){this.addRoom$com_eteks_sweethome3d_model_Room$int(b,this.rooms.length)};a.prototype.addRoom$com_eteks_sweethome3d_model_Room$int=function(c,b){this.rooms=(this.rooms.slice(0));this.rooms.splice(b,0,c);c.setLevel(this.selectedLevel);this.roomsChangeSupport.fireCollectionChanged(c,b,CollectionEvent.Type.ADD)};a.prototype.addRoom=function(c,b){if(((c!=null&&c instanceof Room)||c===null)&&((typeof b==="number")||b===null)){return this.addRoom$com_eteks_sweethome3d_model_Room$int(c,b)}else{if(((c!=null&&c instanceof Room)||c===null)&&b===undefined){return this.addRoom$com_eteks_sweethome3d_model_Room(c)}else{throw new Error("invalid overload")}}};a.prototype.deleteRoom=function(c){this.deselectItem(c);var b=this.rooms.indexOf(c);if(b!==-1){c.setLevel(null);this.rooms=(this.rooms.slice(0));this.rooms.splice(b,1)[0];this.roomsChangeSupport.fireCollectionChanged(c,b,CollectionEvent.Type.DELETE)}};a.prototype.addWallsListener=function(b){this.wallsChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeWallsListener=function(b){this.wallsChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getWalls=function(){return this.walls.slice(0)};a.prototype.addWall=function(b){this.walls=(this.walls.slice(0));(this.walls.push(b)>0);b.setLevel(this.selectedLevel);this.wallsChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.ADD)};a.prototype.deleteWall=function(b){this.deselectItem(b);var f=this.getWalls();for(var e=0;e<f.length;e++){var d=f[e];if((function(h,g){if(h&&h.equals){return h.equals(g)}else{return h===g}})(b,d.getWallAtStart())){d.setWallAtStart(null)}else{if((function(h,g){if(h&&h.equals){return h.equals(g)}else{return h===g}})(b,d.getWallAtEnd())){d.setWallAtEnd(null)}}}var c=this.walls.indexOf(b);if(c!==-1){b.setLevel(null);this.walls=(this.walls.slice(0));this.walls.splice(c,1)[0];this.wallsChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.DELETE)}};a.prototype.addPolylinesListener=function(b){this.polylinesChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removePolylinesListener=function(b){this.polylinesChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getPolylines=function(){return this.polylines.slice(0)};a.prototype.addPolyline$com_eteks_sweethome3d_model_Polyline=function(b){this.addPolyline$com_eteks_sweethome3d_model_Polyline$int(b,this.polylines.length)};a.prototype.addPolyline$com_eteks_sweethome3d_model_Polyline$int=function(b,c){this.polylines=(this.polylines.slice(0));this.polylines.splice(c,0,b);b.setLevel(this.selectedLevel);this.polylinesChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.ADD)};a.prototype.addPolyline=function(b,c){if(((b!=null&&b instanceof Polyline)||b===null)&&((typeof c==="number")||c===null)){return this.addPolyline$com_eteks_sweethome3d_model_Polyline$int(b,c)}else{if(((b!=null&&b instanceof Polyline)||b===null)&&c===undefined){return this.addPolyline$com_eteks_sweethome3d_model_Polyline(b)}else{throw new Error("invalid overload")}}};a.prototype.deletePolyline=function(b){this.deselectItem(b);var c=this.polylines.indexOf(b);if(c!==-1){b.setLevel(null);this.polylines=(this.polylines.slice(0));this.polylines.splice(c,1)[0];this.polylinesChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.DELETE)}};a.prototype.addDimensionLinesListener=function(b){this.dimensionLinesChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeDimensionLinesListener=function(b){this.dimensionLinesChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getDimensionLines=function(){return this.dimensionLines.slice(0)};a.prototype.addDimensionLine=function(b){this.dimensionLines=(this.dimensionLines.slice(0));(this.dimensionLines.push(b)>0);b.setLevel(this.selectedLevel);this.dimensionLinesChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.ADD)};a.prototype.deleteDimensionLine=function(b){this.deselectItem(b);var c=this.dimensionLines.indexOf(b);if(c!==-1){b.setLevel(null);this.dimensionLines=(this.dimensionLines.slice(0));this.dimensionLines.splice(c,1)[0];this.dimensionLinesChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.DELETE)}};a.prototype.addLabelsListener=function(b){this.labelsChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeLabelsListener=function(b){this.labelsChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getLabels=function(){return this.labels.slice(0)};a.prototype.addLabel=function(b){this.labels=(this.labels.slice(0));(this.labels.push(b)>0);b.setLevel(this.selectedLevel);this.labelsChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.ADD)};a.prototype.deleteLabel=function(c){this.deselectItem(c);var b=this.labels.indexOf(c);if(b!==-1){c.setLevel(null);this.labels=(this.labels.slice(0));this.labels.splice(b,1)[0];this.labelsChangeSupport.fireCollectionChanged(c,CollectionEvent.Type.DELETE)}};a.prototype.getSelectableViewableItems=function(){var b=([]);this.addViewableItems(this.walls,b);this.addViewableItems(this.rooms,b);this.addViewableItems(this.dimensionLines,b);this.addViewableItems(this.polylines,b);this.addViewableItems(this.labels,b);var e=this.getFurniture();for(var c=0;c<e.length;c++){var d=e[c];if(d.isVisible()&&(d.getLevel()==null||d.getLevel().isViewable())){(b.push(d)>0)}}if(this.compass.isVisible()){(b.push(this.compass)>0)}return b};a.prototype.addViewableItems=function(b,f){for(var c=0;c<b.length;c++){var d=b[c];if(d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0)){var e=d;if(e.getLevel()==null||e.getLevel().isViewable()){(f.push(d)>0)}}}};a.prototype.getHomeObjects=function(){var c=([]);(c.push(this.environment)>0);(c.push(this.compass)>0);(function(g,f){return g.push.apply(g,f)})(c,this.levels);(function(g,f){return g.push.apply(g,f)})(c,this.walls);(function(g,f){return g.push.apply(g,f)})(c,this.rooms);(function(g,f){return g.push.apply(g,f)})(c,this.dimensionLines);(function(g,f){return g.push.apply(g,f)})(c,this.polylines);(function(g,f){return g.push.apply(g,f)})(c,this.labels);var e=this.getFurniture();for(var b=0;b<e.length;b++){var d=e[b];(c.push(d)>0);if(d!=null&&d instanceof HomeFurnitureGroup){(function(g,f){return g.push.apply(g,f)})(c,d.getAllFurniture())}}(c.push(this.topCamera)>0);(c.push(this.observerCamera)>0);(function(g,f){return g.push.apply(g,f)})(c,this.storedCameras);(function(g,f){return g.push.apply(g,f)})(c,this.environment.getVideoCameraPath());return c};a.prototype.isEmpty=function(){return(this.furniture.length==0)&&(this.walls.length==0)&&(this.rooms.length==0)&&(this.dimensionLines.length==0)&&(this.polylines.length==0)&&(this.labels.length==0)};a.prototype.getWallHeight=function(){return this.wallHeight};a.prototype.getName=function(){return this.name};a.prototype.setName=function(b){if(b!==this.name&&(b==null||!(b===this.name))){var c=this.name;this.name=b;this.propertyChangeSupport.firePropertyChange("NAME",c,b)}};a.prototype.isModified=function(){return this.modified};a.prototype.setModified=function(b){if(b!==this.modified){this.modified=b;this.propertyChangeSupport.firePropertyChange("MODIFIED",!b,b)}};a.prototype.isRecovered=function(){return this.recovered};a.prototype.setRecovered=function(b){if(b!==this.recovered){this.recovered=b;this.propertyChangeSupport.firePropertyChange("RECOVERED",!b,b)}};a.prototype.isRepaired=function(){return this.repaired};a.prototype.setRepaired=function(b){if(b!==this.repaired){this.repaired=b;this.propertyChangeSupport.firePropertyChange("REPAIRED",!b,b)}};a.prototype.getFurnitureSortedProperty=function(){return this.furnitureSortedProperty};a.prototype.setFurnitureSortedProperty=function(b){if(b!==this.furnitureSortedProperty&&(b==null||!(b==this.furnitureSortedProperty))){var c=this.furnitureSortedProperty;this.furnitureSortedProperty=b;this.propertyChangeSupport.firePropertyChange("FURNITURE_SORTED_PROPERTY",c,b)}};a.prototype.isFurnitureDescendingSorted=function(){return this.furnitureDescendingSorted};a.prototype.setFurnitureDescendingSorted=function(b){if(b!==this.furnitureDescendingSorted){this.furnitureDescendingSorted=b;this.propertyChangeSupport.firePropertyChange("FURNITURE_DESCENDING_SORTED",!b,b)}};a.prototype.getFurnitureVisibleProperties=function(){if(this.furnitureVisibleProperties==null){return[]}else{return this.furnitureVisibleProperties.slice(0)}};a.prototype.setFurnitureVisibleProperties=function(c){if(c!==this.furnitureVisibleProperties&&(c==null||!(function(e,d){if(e==null&&d==null){return true}if(e==null||d==null){return false}if(e.length!=d.length){return false}for(var f=0;f<e.length;f++){if(e[f]!=d[f]){return false}}return true})(c,this.furnitureVisibleProperties))){var b=this.furnitureVisibleProperties;this.furnitureVisibleProperties=(c.slice(0));this.propertyChangeSupport.firePropertyChange("FURNITURE_VISIBLE_PROPERTIES",b.slice(0),c.slice(0))}};a.prototype.getBackgroundImage=function(){return this.backgroundImage};a.prototype.setBackgroundImage=function(c){if(c!==this.backgroundImage){var b=this.backgroundImage;this.backgroundImage=c;this.propertyChangeSupport.firePropertyChange("BACKGROUND_IMAGE",b,c)}};a.prototype.getTopCamera=function(){return this.topCamera};a.prototype.getObserverCamera=function(){return this.observerCamera};a.prototype.setCamera=function(c){if(c!==this.camera){var b=this.camera;this.camera=c;this.propertyChangeSupport.firePropertyChange("CAMERA",b,c)}};a.prototype.getCamera=function(){if(this.camera==null){this.camera=this.getTopCamera()}return this.camera};a.prototype.setStoredCameras=function(c){if(!(function(e,d){if(e==null&&d==null){return true}if(e==null||d==null){return false}if(e.length!=d.length){return false}for(var f=0;f<e.length;f++){if(e[f]!=d[f]){return false}}return true})(this.storedCameras,c)){var b=this.storedCameras;if(c==null){this.storedCameras=[]}else{this.storedCameras=(c.slice(0))}this.propertyChangeSupport.firePropertyChange("STORED_CAMERAS",b.slice(0),c.slice(0))}};a.prototype.getStoredCameras=function(){return this.storedCameras.slice(0)};a.prototype.getEnvironment=function(){return this.environment};a.prototype.getCompass=function(){return this.compass};a.prototype.getPrint=function(){return this.print};a.prototype.setPrint=function(b){if(b!==this.print){var c=this.print;this.print=b;this.propertyChangeSupport.firePropertyChange("PRINT",c,b)}this.print=b};a.prototype.getVisualProperty=function(b){return(function(c,d){return c[d]===undefined?null:c[d]})(this.visualProperties,b)};a.prototype.setVisualProperty=function(b,c){(this.visualProperties[b]=c)};a.prototype.getProperty=function(b){return(function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b)};a.prototype.getNumericProperty=function(b){var e=(function(f,g){return f[g]===undefined?null:f[g]})(this.properties,b);if(e!=null){try{return new Number(e).valueOf()}catch(c){try{return new Number(e).valueOf()}catch(d){}}}return null};a.prototype.setProperty=function(c,d){var e=this;var b=(function(f,g){return f[g]===undefined?null:f[g]})(this.properties,c);if(d==null){if(b!=null){(function(g){var f=e.properties[c];delete e.properties[c];return f})(this.properties);this.propertyChangeSupport.firePropertyChange(c,b,null)}}else{(this.properties[c]=d);this.propertyChangeSupport.firePropertyChange(c,b,d)}};a.prototype.getPropertyNames=function(){return Object.keys(this.properties)};a.prototype.addPropertyChangeListener=function(b,c){this.propertyChangeSupport.addPropertyChangeListener(b,c)};a.prototype.removePropertyChangeListener=function(b,c){this.propertyChangeSupport.removePropertyChangeListener(b,c)};a.prototype.isBasePlanLocked=function(){return this.basePlanLocked};a.prototype.setBasePlanLocked=function(b){if(b!==this.basePlanLocked){this.basePlanLocked=b;this.propertyChangeSupport.firePropertyChange("BASE_PLAN_LOCKED",!b,b)}};a.prototype.getVersion=function(){return this.version};a.prototype.setVersion=function(b){this.version=b};a.prototype.clone=function(){try{var c=(function(e){var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f})(this);a.copyHomeData(this,c);a.initListenersSupport(c);c.addModelListeners();return c}catch(b){throw new IllegalStateException("Super class isn't cloneable")}};a.copyHomeData=function(b,j){j.allLevelsSelection=b.allLevelsSelection;j.name=b.name;j.modified=b.modified;j.recovered=b.recovered;j.repaired=b.repaired;j.backgroundImage=b.backgroundImage;j.print=b.print;j.furnitureDescendingSorted=b.furnitureDescendingSorted;j.version=b.version;j.basePlanLocked=b.basePlanLocked;j.skyColor=b.skyColor;j.groundColor=b.groundColor;j.lightColor=b.lightColor;j.wallsAlpha=b.wallsAlpha;j.furnitureSortedProperty=b.furnitureSortedProperty;j.selectedItems=([]);j.furniture=a.cloneSelectableItems(b.furniture,b.selectedItems,j.selectedItems);j.rooms=a.cloneSelectableItems(b.rooms,b.selectedItems,j.selectedItems);j.dimensionLines=a.cloneSelectableItems(b.dimensionLines,b.selectedItems,j.selectedItems);j.polylines=a.cloneSelectableItems(b.polylines,b.selectedItems,j.selectedItems);j.labels=a.cloneSelectableItems(b.labels,b.selectedItems,j.selectedItems);j.walls=Wall.clone(b.walls);for(var d=0;d<b.walls.length;d++){var l=b.walls[d];if((b.selectedItems.indexOf((l))>=0)){(j.selectedItems.push(j.walls[d])>0)}}j.levels=([]);if(b.levels.length>0){for(var e=0;e<b.levels.length;e++){var c=b.levels[e];(j.levels.push((function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(c))>0)}for(var d=0;d<b.furniture.length;d++){var m=b.furniture[d].getLevel();if(m!=null){j.furniture[d].setLevel(j.levels[b.levels.indexOf(m)])}}for(var d=0;d<b.rooms.length;d++){var o=b.rooms[d].getLevel();if(o!=null){j.rooms[d].setLevel(j.levels[b.levels.indexOf(o)])}}for(var d=0;d<b.dimensionLines.length;d++){var n=b.dimensionLines[d].getLevel();if(n!=null){j.dimensionLines[d].setLevel(j.levels[b.levels.indexOf(n)])}}for(var d=0;d<b.polylines.length;d++){var k=b.polylines[d].getLevel();if(k!=null){j.polylines[d].setLevel(j.levels[b.levels.indexOf(k)])}}for(var d=0;d<b.labels.length;d++){var h=b.labels[d].getLevel();if(h!=null){j.labels[d].setLevel(j.levels[b.levels.indexOf(h)])}}for(var d=0;d<b.walls.length;d++){var g=b.walls[d].getLevel();if(g!=null){j.walls[d].setLevel(j.levels[b.levels.indexOf(g)])}}if(b.selectedLevel!=null){j.selectedLevel=j.levels[b.levels.indexOf(b.selectedLevel)]}}j.observerCamera=(function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(b.observerCamera);j.topCamera=(function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(b.topCamera);if(b.camera===b.observerCamera){j.camera=j.observerCamera;if((b.selectedItems.indexOf((b.observerCamera))>=0)){(j.selectedItems.push(j.observerCamera)>0)}}else{j.camera=j.topCamera}j.storedCameras=([]);for(var e=0;e<b.storedCameras.length;e++){var f=b.storedCameras[e];(j.storedCameras.push((function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(f))>0)}j.environment=(function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(b.environment);j.compass=(function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(b.compass);j.furnitureVisibleProperties=(b.furnitureVisibleProperties.slice(0));j.visualProperties=((function(t){var q={};for(var s in t){q[s]=t[s]}return q})(b.visualProperties));j.properties=((function(t){var q={};for(var s in t){q[s]=t[s]}return q})(b.properties))};a.cloneSelectableItems=function(b,h,c){var k=([]);for(var g=0;g<b.length;g++){var l=b[g];var j=(function(r){if(r.clone!=undefined){return r.clone()}else{var q=Object.create(r);for(var n in r){if(r.hasOwnProperty(n)){q[n]=r[n]}}return q}})(l);(k.push(j)>0);if((h.indexOf((l))>=0)){(c.push(j)>0)}else{if(l!=null&&l instanceof HomeFurnitureGroup){var m=l.getAllFurniture();var d=null;for(var f=0,e=m.length;f<e;f++){var o=m[f];if((h.indexOf((o))>=0)){if(d==null){d=j.getAllFurniture()}(c.push(d[f])>0)}}}}}return k};a.duplicate=function(d){var g=([]);var c=Wall.duplicate(a.getWallsSubList(d));var b=0;for(var e=0;e<d.length;e++){var f=d[e];if(f!=null&&f instanceof Wall){(g.push(c[b++])>0)}else{if(f!=null&&f instanceof HomeObject){(g.push(f.duplicate())>0)}else{(g.push((function(j){if(j.clone!=undefined){return j.clone()}else{var k=Object.create(j);for(var h in j){if(j.hasOwnProperty(h)){k[h]=j[h]}}return k}})(f))>0)}}}return g};a.getFurnitureSubList=function(b){return a.getSubList(b,HomePieceOfFurniture)};a.getWallsSubList=function(b){return a.getSubList(b,Wall)};a.getRoomsSubList=function(b){return a.getSubList(b,Room)};a.getPolylinesSubList=function(b){return a.getSubList(b,Polyline)};a.getDimensionLinesSubList=function(b){return a.getSubList(b,DimensionLine)};a.getLabelsSubList=function(b){return a.getSubList(b,Label)};a.getSubList=function(c,f){var b=([]);for(var d=0;d<c.length;d++){var e=c[d];if((function(h,g){if(typeof h==="string"){return(g.constructor&&g.constructor.__interfaces&&g.constructor.__interfaces.indexOf(h)>=0)||(g.__interfaces&&g.__interfaces.indexOf(h)>=0)}else{if(typeof h==="function"){return(g instanceof h)||(g.constructor&&g.constructor===h)}}})(f,e)){(b.push(e)>0)}}return b};a.CURRENT_VERSION=6500;a.HOME_TOP_CAMERA_ID="camera-homeTopCamera";a.HOME_OBSERVER_CAMERA_ID="observerCamera-homeObserverCamera";a.HOME_ENVIRONMENT_ID="environment-homeEnvironment";a.HOME_COMPASS_ID="compass-homeCompass";a.KEEP_BACKWARD_COMPATIBLITY=true;return a}());Home.__class="com.eteks.sweethome3d.model.Home";(function(a){var b=(function(){function c(d){this.__parent=d}c.prototype.propertyChange=function(d){if(("ELEVATION"===d.getPropertyName())||("ELEVATION_INDEX"===d.getPropertyName())){this.__parent.levels=(this.__parent.levels.slice(0));(function(e,f){if(f.compare){e.sort(function(h,g){return f.compare(h,g)})}else{e.sort(f)}})(this.__parent.levels,a.LEVEL_ELEVATION_COMPARATOR_$LI$())}};return c}());a.Home$0=b})(Home||(Home={}));Home.__transients=["furnitureChangeSupport","selectedItems","selectionListeners","allLevelsSelection","levelsChangeSupport","wallsChangeSupport","roomsChangeSupport","polylinesChangeSupport","dimensionLinesChangeSupport","labelsChangeSupport","modified","recovered","repaired","propertyChangeSupport"];var PlanController=(function(a){__extends(b,a);function b(h,d,c,f,e){var j=a.call(this,h,d,c,f,e)||this;if(j.__com_eteks_sweethome3d_viewcontroller_PlanController_home===undefined){j.__com_eteks_sweethome3d_viewcontroller_PlanController_home=null}if(j.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences===undefined){j.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences=null}if(j.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory===undefined){j.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory=null}if(j.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager===undefined){j.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager=null}if(j.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport===undefined){j.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport=null}if(j.propertyChangeSupport===undefined){j.propertyChangeSupport=null}if(j.planView===undefined){j.planView=null}if(j.selectionListener===undefined){j.selectionListener=null}if(j.wallChangeListener===undefined){j.wallChangeListener=null}if(j.furnitureSizeChangeListener===undefined){j.furnitureSizeChangeListener=null}if(j.selectionState===undefined){j.selectionState=null}if(j.rectangleSelectionState===undefined){j.rectangleSelectionState=null}if(j.selectionMoveState===undefined){j.selectionMoveState=null}if(j.panningState===undefined){j.panningState=null}if(j.dragAndDropState===undefined){j.dragAndDropState=null}if(j.wallCreationState===undefined){j.wallCreationState=null}if(j.wallDrawingState===undefined){j.wallDrawingState=null}if(j.wallResizeState===undefined){j.wallResizeState=null}if(j.wallArcExtentState===undefined){j.wallArcExtentState=null}if(j.pieceOfFurnitureRotationState===undefined){j.pieceOfFurnitureRotationState=null}if(j.pieceOfFurniturePitchRotationState===undefined){j.pieceOfFurniturePitchRotationState=null}if(j.pieceOfFurnitureRollRotationState===undefined){j.pieceOfFurnitureRollRotationState=null}if(j.pieceOfFurnitureElevationState===undefined){j.pieceOfFurnitureElevationState=null}if(j.pieceOfFurnitureHeightState===undefined){j.pieceOfFurnitureHeightState=null}if(j.pieceOfFurnitureResizeState===undefined){j.pieceOfFurnitureResizeState=null}if(j.lightPowerModificationState===undefined){j.lightPowerModificationState=null}if(j.pieceOfFurnitureNameOffsetState===undefined){j.pieceOfFurnitureNameOffsetState=null}if(j.pieceOfFurnitureNameRotationState===undefined){j.pieceOfFurnitureNameRotationState=null}if(j.cameraYawRotationState===undefined){j.cameraYawRotationState=null}if(j.cameraPitchRotationState===undefined){j.cameraPitchRotationState=null}if(j.cameraElevationState===undefined){j.cameraElevationState=null}if(j.dimensionLineCreationState===undefined){j.dimensionLineCreationState=null}if(j.dimensionLineDrawingState===undefined){j.dimensionLineDrawingState=null}if(j.dimensionLineResizeState===undefined){j.dimensionLineResizeState=null}if(j.dimensionLineOffsetState===undefined){j.dimensionLineOffsetState=null}if(j.roomCreationState===undefined){j.roomCreationState=null}if(j.roomDrawingState===undefined){j.roomDrawingState=null}if(j.roomResizeState===undefined){j.roomResizeState=null}if(j.roomAreaOffsetState===undefined){j.roomAreaOffsetState=null}if(j.roomAreaRotationState===undefined){j.roomAreaRotationState=null}if(j.roomNameOffsetState===undefined){j.roomNameOffsetState=null}if(j.roomNameRotationState===undefined){j.roomNameRotationState=null}if(j.polylineCreationState===undefined){j.polylineCreationState=null}if(j.polylineDrawingState===undefined){j.polylineDrawingState=null}if(j.polylineResizeState===undefined){j.polylineResizeState=null}if(j.labelCreationState===undefined){j.labelCreationState=null}if(j.labelRotationState===undefined){j.labelRotationState=null}if(j.labelElevationState===undefined){j.labelElevationState=null}if(j.compassRotationState===undefined){j.compassRotationState=null}if(j.compassResizeState===undefined){j.compassResizeState=null}if(j.state===undefined){j.state=null}if(j.previousState===undefined){j.previousState=null}if(j.xLastMousePress===undefined){j.xLastMousePress=0}if(j.yLastMousePress===undefined){j.yLastMousePress=0}if(j.shiftDownLastMousePress===undefined){j.shiftDownLastMousePress=false}if(j.alignmentActivatedLastMousePress===undefined){j.alignmentActivatedLastMousePress=false}if(j.duplicationActivatedLastMousePress===undefined){j.duplicationActivatedLastMousePress=false}if(j.magnetismToggledLastMousePress===undefined){j.magnetismToggledLastMousePress=false}if(j.pointerTypeLastMousePress===undefined){j.pointerTypeLastMousePress=null}if(j.xLastMouseMove===undefined){j.xLastMouseMove=0}if(j.yLastMouseMove===undefined){j.yLastMouseMove=0}if(j.wallsAreaCache===undefined){j.wallsAreaCache=null}if(j.wallsIncludingBaseboardsAreaCache===undefined){j.wallsIncludingBaseboardsAreaCache=null}if(j.insideWallsAreaCache===undefined){j.insideWallsAreaCache=null}if(j.roomPathsCache===undefined){j.roomPathsCache=null}if(j.furnitureSidesCache===undefined){j.furnitureSidesCache=null}if(j.draggedItems===undefined){j.draggedItems=null}j.__com_eteks_sweethome3d_viewcontroller_PlanController_home=h;j.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences=d;j.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory=c;j.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager=f;j.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport=e;j.propertyChangeSupport=new PropertyChangeSupport(j);j.furnitureSidesCache=({});j.selectionState=new b.SelectionState(j);j.selectionMoveState=new b.SelectionMoveState(j);j.rectangleSelectionState=new b.RectangleSelectionState(j);j.panningState=new b.PanningState(j);j.dragAndDropState=new b.DragAndDropState(j);j.wallCreationState=new b.WallCreationState(j);j.wallDrawingState=new b.WallDrawingState(j);j.wallResizeState=new b.WallResizeState(j);j.wallArcExtentState=new b.WallArcExtentState(j);j.pieceOfFurnitureRotationState=new b.PieceOfFurnitureRotationState(j);j.pieceOfFurniturePitchRotationState=new b.PieceOfFurniturePitchRotationState(j);j.pieceOfFurnitureRollRotationState=new b.PieceOfFurnitureRollRotationState(j);j.pieceOfFurnitureElevationState=new b.PieceOfFurnitureElevationState(j);j.pieceOfFurnitureHeightState=new b.PieceOfFurnitureHeightState(j);j.pieceOfFurnitureResizeState=new b.PieceOfFurnitureResizeState(j);j.lightPowerModificationState=new b.LightPowerModificationState(j);j.pieceOfFurnitureNameOffsetState=new b.PieceOfFurnitureNameOffsetState(j);j.pieceOfFurnitureNameRotationState=new b.PieceOfFurnitureNameRotationState(j);j.cameraYawRotationState=new b.CameraYawRotationState(j);j.cameraPitchRotationState=new b.CameraPitchRotationState(j);j.cameraElevationState=new b.CameraElevationState(j);j.dimensionLineCreationState=new b.DimensionLineCreationState(j);j.dimensionLineDrawingState=new b.DimensionLineDrawingState(j);j.dimensionLineResizeState=new b.DimensionLineResizeState(j);j.dimensionLineOffsetState=new b.DimensionLineOffsetState(j);j.roomCreationState=new b.RoomCreationState(j);j.roomDrawingState=new b.RoomDrawingState(j);j.roomResizeState=new b.RoomResizeState(j);j.roomAreaOffsetState=new b.RoomAreaOffsetState(j);j.roomAreaRotationState=new b.RoomAreaRotationState(j);j.roomNameOffsetState=new b.RoomNameOffsetState(j);j.roomNameRotationState=new b.RoomNameRotationState(j);j.polylineCreationState=new b.PolylineCreationState(j);j.polylineDrawingState=new b.PolylineDrawingState(j);j.polylineResizeState=new b.PolylineResizeState(j);j.labelCreationState=new b.LabelCreationState(j);j.labelRotationState=new b.LabelRotationState(j);j.labelElevationState=new b.LabelElevationState(j);j.compassRotationState=new b.CompassRotationState(j);j.compassResizeState=new b.CompassResizeState(j);j.setState(j.selectionState);j.__com_eteks_sweethome3d_viewcontroller_PlanController_addModelListeners();var g=h.getNumericProperty(b.SCALE_VISUAL_PROPERTY);if(g!=null){j.setScale(g)}return j}b.prototype.getView=function(){if(this.planView==null){this.planView=this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory.createPlanView(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this)}return this.planView};b.prototype.setState=function(f){var c=null;var e=false;var d=false;if(this.state!=null){c=this.state.getMode();e=this.state.isModificationState();d=this.state.isBasePlanModificationState();this.state.exit()}this.previousState=this.state;this.state=f;this.state.enter();if(c!==f.getMode()){this.propertyChangeSupport.firePropertyChange("MODE",c,f.getMode())}if(e!==f.isModificationState()){this.propertyChangeSupport.firePropertyChange("MODIFICATION_STATE",e,!e)}if(d!==f.isBasePlanModificationState()){this.propertyChangeSupport.firePropertyChange("BASE_PLAN_MODIFICATION_STATE",d,!d)}};b.prototype.addPropertyChangeListener=function(d,c){this.propertyChangeSupport.addPropertyChangeListener(d,c)};b.prototype.removePropertyChangeListener=function(d,c){this.propertyChangeSupport.removePropertyChangeListener(d,c)};b.prototype.getMode=function(){return this.state.getMode()};b.prototype.setMode=function(d){var c=this.state.getMode();if(d!==c){this.state.setMode(d);this.propertyChangeSupport.firePropertyChange("MODE",c,d)}};b.prototype.isModificationState=function(){return this.state.isModificationState()};b.prototype.isBasePlanModificationState=function(){return this.state.isBasePlanModificationState()};b.prototype.deleteSelection=function(){this.state.deleteSelection()};b.prototype.escape=function(){this.state.escape()};b.prototype.moveSelection=function(d,c){this.state.moveSelection(d,c)};b.prototype.toggleMagnetism=function(c){this.state.toggleMagnetism(c)};b.prototype.setAlignmentActivated=function(c){this.state.setAlignmentActivated(c)};b.prototype.setDuplicationActivated=function(c){this.state.setDuplicationActivated(c)};b.prototype.setEditionActivated=function(c){this.state.setEditionActivated(c)};b.prototype.updateEditableProperty=function(d,c){this.state.updateEditableProperty(d,c)};b.prototype.pressMouse$float$float$int$boolean$boolean=function(d,g,c,e,f){this.pressMouse$float$float$int$boolean$boolean$boolean$boolean(d,g,c,e,e,f,e)};b.prototype.pressMouse$float$float$int$boolean$boolean$boolean$boolean=function(d,j,c,f,g,h,e){this.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType(d,j,c,f,g,h,e,null)};b.prototype.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType=function(e,k,d,g,h,j,f,c){this.xLastMousePress=e;this.yLastMousePress=k;this.xLastMouseMove=e;this.yLastMouseMove=k;this.shiftDownLastMousePress=g;this.alignmentActivatedLastMousePress=h;this.duplicationActivatedLastMousePress=j;this.pointerTypeLastMousePress=c;this.magnetismToggledLastMousePress=f;this.state.pressMouse(e,k,d,g,j)};b.prototype.pressMouse=function(e,k,d,g,h,j,f,c){if(((typeof e==="number")||e===null)&&((typeof k==="number")||k===null)&&((typeof d==="number")||d===null)&&((typeof g==="boolean")||g===null)&&((typeof h==="boolean")||h===null)&&((typeof j==="boolean")||j===null)&&((typeof f==="boolean")||f===null)&&((typeof c==="number")||c===null)){return this.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType(e,k,d,g,h,j,f,c)}else{if(((typeof e==="number")||e===null)&&((typeof k==="number")||k===null)&&((typeof d==="number")||d===null)&&((typeof g==="boolean")||g===null)&&((typeof h==="boolean")||h===null)&&((typeof j==="boolean")||j===null)&&((typeof f==="boolean")||f===null)&&c===undefined){return this.pressMouse$float$float$int$boolean$boolean$boolean$boolean(e,k,d,g,h,j,f)}else{if(((typeof e==="number")||e===null)&&((typeof k==="number")||k===null)&&((typeof d==="number")||d===null)&&((typeof g==="boolean")||g===null)&&((typeof h==="boolean")||h===null)&&j===undefined&&f===undefined&&c===undefined){return this.pressMouse$float$float$int$boolean$boolean(e,k,d,g,h)}else{throw new Error("invalid overload")}}}};b.prototype.releaseMouse=function(c,d){this.state.releaseMouse(c,d)};b.prototype.moveMouse=function(c,d){this.xLastMouseMove=c;this.yLastMouseMove=d;this.state.moveMouse(c,d)};b.prototype.zoom=function(c){this.state.zoom(c)};b.prototype.getSelectionState=function(){return this.selectionState};b.prototype.getSelectionMoveState=function(){return this.selectionMoveState};b.prototype.getRectangleSelectionState=function(){return this.rectangleSelectionState};b.prototype.getPanningState=function(){return this.panningState};b.prototype.getDragAndDropState=function(){return this.dragAndDropState};b.prototype.getWallCreationState=function(){return this.wallCreationState};b.prototype.getWallDrawingState=function(){return this.wallDrawingState};b.prototype.getWallResizeState=function(){return this.wallResizeState};b.prototype.getWallArcExtentState=function(){return this.wallArcExtentState};b.prototype.getPieceOfFurnitureRotationState=function(){return this.pieceOfFurnitureRotationState};b.prototype.getPieceOfFurniturePitchRotationState=function(){return this.pieceOfFurniturePitchRotationState};b.prototype.getPieceOfFurnitureRollRotationState=function(){return this.pieceOfFurnitureRollRotationState};b.prototype.getPieceOfFurnitureElevationState=function(){return this.pieceOfFurnitureElevationState};b.prototype.getPieceOfFurnitureHeightState=function(){return this.pieceOfFurnitureHeightState};b.prototype.getPieceOfFurnitureResizeState=function(){return this.pieceOfFurnitureResizeState};b.prototype.getLightPowerModificationState=function(){return this.lightPowerModificationState};b.prototype.getPieceOfFurnitureNameOffsetState=function(){return this.pieceOfFurnitureNameOffsetState};b.prototype.getPieceOfFurnitureNameRotationState=function(){return this.pieceOfFurnitureNameRotationState};b.prototype.getCameraYawRotationState=function(){return this.cameraYawRotationState};b.prototype.getCameraPitchRotationState=function(){return this.cameraPitchRotationState};b.prototype.getCameraElevationState=function(){return this.cameraElevationState};b.prototype.getDimensionLineCreationState=function(){return this.dimensionLineCreationState};b.prototype.getDimensionLineDrawingState=function(){return this.dimensionLineDrawingState};b.prototype.getDimensionLineResizeState=function(){return this.dimensionLineResizeState};b.prototype.getDimensionLineOffsetState=function(){return this.dimensionLineOffsetState};b.prototype.getRoomCreationState=function(){return this.roomCreationState};b.prototype.getRoomDrawingState=function(){return this.roomDrawingState};b.prototype.getRoomResizeState=function(){return this.roomResizeState};b.prototype.getRoomAreaOffsetState=function(){return this.roomAreaOffsetState};b.prototype.getRoomAreaRotationState=function(){return this.roomAreaRotationState};b.prototype.getRoomNameOffsetState=function(){return this.roomNameOffsetState};b.prototype.getRoomNameRotationState=function(){return this.roomNameRotationState};b.prototype.getPolylineCreationState=function(){return this.polylineCreationState};b.prototype.getPolylineDrawingState=function(){return this.polylineDrawingState};b.prototype.getPolylineResizeState=function(){return this.polylineResizeState};b.prototype.getLabelCreationState=function(){return this.labelCreationState};b.prototype.getLabelRotationState=function(){return this.labelRotationState};b.prototype.getLabelElevationState=function(){return this.labelElevationState};b.prototype.getCompassRotationState=function(){return this.compassRotationState};b.prototype.getCompassResizeState=function(){return this.compassResizeState};b.prototype.getXLastMousePress=function(){return this.xLastMousePress};b.prototype.getYLastMousePress=function(){return this.yLastMousePress};b.prototype.wasShiftDownLastMousePress=function(){return this.shiftDownLastMousePress};b.prototype.wasMagnetismToggledLastMousePress=function(){return this.magnetismToggledLastMousePress};b.prototype.wasAlignmentActivatedLastMousePress=function(){return this.alignmentActivatedLastMousePress};b.prototype.wasDuplicationActivatedLastMousePress=function(){return this.duplicationActivatedLastMousePress};b.prototype.getPointerTypeLastMousePress=function(){return this.pointerTypeLastMousePress};b.prototype.getXLastMouseMove=function(){return this.xLastMouseMove};b.prototype.getYLastMouseMove=function(){return this.yLastMouseMove};b.prototype.modifySelectedWalls=function(){if(!(Home.getWallsSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length==0)){new WallController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())}};b.prototype.lockBasePlan=function(){if(!this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var d=g.slice(0);var c=this.getItemsNotPartOfBasePlan(g);var f=c.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(true);this.selectItems$java_util_List$boolean(c,e);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LockingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,e,f))}};b.prototype.isItemPartOfBasePlan=function(c){if(c!=null&&c instanceof HomePieceOfFurniture){return this.isPieceOfFurniturePartOfBasePlan(c)}else{return !(c!=null&&c instanceof ObserverCamera)}};b.prototype.getItemsNotPartOfBasePlan=function(c){var f=([]);for(var d=0;d<c.length;d++){var e=c[d];if(!this.isItemPartOfBasePlan(e)){(f.push(e)>0)}}return f};b.prototype.unlockBasePlan=function(){if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()){var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var e=d.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(false);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(false);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.UnlockingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,c))}};b.prototype.isItemMovable=function(c){if(c!=null&&c instanceof HomePieceOfFurniture){return this.isPieceOfFurnitureMovable(c)}else{return true}};b.prototype.isItemResizable=function(c){if(c!=null&&c instanceof HomePieceOfFurniture){return c.isResizable()}else{return true}};b.prototype.isItemDeletable=function(c){if(c!=null&&c instanceof HomePieceOfFurniture){return this.isPieceOfFurnitureDeletable(c)}else{return !((c!=null&&c instanceof Compass)||(c!=null&&c instanceof Camera))}};b.prototype.flipHorizontally=function(){this.flipSelectedItems(true)};b.prototype.flipVertically=function(){this.flipSelectedItems(false)};b.prototype.flipSelectedItems=function(k){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(!(e.length==0)){var d=e.slice(0);var f=(function(o){var j=[];while(o-->0){j.push(null)}return j})(d.length);for(var h=0;h<f.length;h++){if(d[h]!=null&&d[h] instanceof HomeFurnitureGroup){var m=d[h];var l=m.getAllFurniture();f[h]=(function(o){var j=[];while(o-->0){j.push(0)}return j})(l.length+1);f[h][0]=this.getTextBaseOffset(m.getName(),m.getNameStyle(),m.constructor);for(var g=0;g<l.length;g++){var n=l[g];f[h][g+1]=this.getTextBaseOffset(n.getName(),n.getNameStyle(),n.constructor)}}else{if(d[h]!=null&&d[h] instanceof HomePieceOfFurniture){var n=d[h];f[h]=[this.getTextBaseOffset(n.getName(),n.getNameStyle(),n.constructor)]}else{if(d[h]!=null&&d[h] instanceof Room){var c=d[h];f[h]=[this.getTextBaseOffset(c.getName(),c.getNameStyle(),c.constructor),this.getTextBaseOffset(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getAreaFormatWithUnit().format(c.getArea()),c.getAreaStyle(),c.constructor)]}}}}this.doFlipItems(d,f,k);this.selectAndShowItems$java_util_List$boolean(e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection());this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.FlippingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),e.slice(0),f,k))}};b.prototype.doFlipItems=function(q,l,e){var k=3.4028235e+38;var g=3.4028235e+38;var d=-3.4028235e+38;var c=-3.4028235e+38;for(var n=0;n<q.length;n++){var s=q[n];if(!(s!=null&&s instanceof ObserverCamera)){var o=s.getPoints();for(var p=0;p<o.length;p++){var r=o[p];k=Math.min(k,r[0]);g=Math.min(g,r[1]);d=Math.max(d,r[0]);c=Math.max(c,r[1])}}}var j=(k+d)/2;var f=(g+c)/2;var h=q.slice(0);for(var m=0;m<q.length;m++){this.flipItem(q[m],l[m],0,e?j:f,e,h)}};b.prototype.flipItem=function(B,p,l,j,D,d){if(B!=null&&B instanceof HomePieceOfFurniture){var e=B;if(D){e.setX(j*2-e.getX());e.setAngle(-e.getAngle());b.flipPieceOfFurnitureName(e,p[0],D)}else{e.setY(j*2-e.getY());e.setAngle(Math.PI-e.getAngle());b.flipPieceOfFurnitureName(e,p[0],D)}if(e.isHorizontallyRotatable()){e.setRoll(-e.getRoll())}if(e.isResizable()){e.setModelMirrored(!e.isModelMirrored())}if(B!=null&&B instanceof HomeFurnitureGroup){var q=B.getAllFurniture();for(var w=0;w<q.length;w++){b.flipPieceOfFurnitureName(q[w],p[w+1],D)}}}else{if(B!=null&&B instanceof Wall){var y=B;if(D){y.setXStart(j*2-y.getXStart());var C=y.getWallAtStart();if(C!=null&&!(d.indexOf((C))>=0)){if(C.getWallAtStart()===y){C.setXStart(j*2-C.getXStart())}else{C.setXEnd(j*2-C.getXEnd())}}y.setXEnd(j*2-y.getXEnd());var k=y.getWallAtEnd();if(k!=null&&!(d.indexOf((k))>=0)){if(k.getWallAtStart()===y){k.setXStart(j*2-k.getXStart())}else{k.setXEnd(j*2-k.getXEnd())}}}else{y.setYStart(j*2-y.getYStart());var C=y.getWallAtStart();if(C!=null&&!(d.indexOf((C))>=0)){if(C.getWallAtStart()===y){C.setYStart(j*2-C.getYStart())}else{C.setYEnd(j*2-C.getYEnd())}}y.setYEnd(j*2-y.getYEnd());var k=y.getWallAtEnd();if(k!=null&&!(d.indexOf((k))>=0)){if(k.getWallAtStart()===y){k.setYStart(j*2-k.getYStart())}else{k.setYEnd(j*2-k.getYEnd())}}}var s=y.getArcExtent();if(s!=null){y.setArcExtent(-s)}b.reverseWallSidesStyle(y)}else{if(B!=null&&B instanceof Room){var z=B;var v=z.getPoints();for(var h=0;h<v.length;h++){var u=v[h];if(D){u[0]=j*2-u[0]}else{u[1]=j*2-u[1]}}z.setPoints(v);var t=z.getNameStyle();var o=z.getAreaStyle();if(D){z.setNameXOffset(-z.getNameXOffset());z.setAreaXOffset(-z.getAreaXOffset());if(t!=null){if(t.getAlignment()===TextStyle.Alignment.LEFT){z.setNameStyle(t.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT))}else{if(t.getAlignment()===TextStyle.Alignment.RIGHT){z.setNameStyle(t.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT))}}}if(o!=null){if(o.getAlignment()===TextStyle.Alignment.LEFT){z.setAreaStyle(o.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT))}else{if(o.getAlignment()===TextStyle.Alignment.RIGHT){z.setAreaStyle(o.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT))}}}}else{z.setNameYOffset(-z.getNameYOffset());var A=p[0];z.setNameXOffset(z.getNameXOffset()-A*Math.sin(z.getNameAngle()));z.setNameYOffset(z.getNameYOffset()-A*Math.cos(z.getNameAngle()));z.setAreaYOffset(-z.getAreaYOffset());A=p[1];z.setAreaXOffset(z.getAreaXOffset()-A*Math.sin(z.getAreaAngle()));z.setAreaYOffset(z.getAreaYOffset()-A*Math.cos(z.getAreaAngle()))}z.setNameAngle(-z.getNameAngle());z.setAreaAngle(-z.getAreaAngle())}else{if(B!=null&&B instanceof Polyline){var r=B;var v=r.getPoints();for(var h=0;h<v.length;h++){var u=v[h];if(D){u[0]=j*2-u[0]}else{u[1]=j*2-u[1]}}r.setPoints(v)}else{if(B!=null&&B instanceof DimensionLine){var g=B;if(D){var f=g.getXStart();g.setXStart(j*2-g.getXEnd());g.setXEnd(j*2-f);var n=g.getYStart();g.setYStart(g.getYEnd());g.setYEnd(n)}else{g.setYStart(j*2-g.getYStart());g.setYEnd(j*2-g.getYEnd());g.setOffset(-g.getOffset())}}else{if(B!=null&&B instanceof Label){var m=B;if(D){m.setX(j*2-m.getX());m.setAngle(-m.getAngle())}else{m.setY(j*2-m.getY());if(m.getPitch()!=null){m.setAngle(Math.PI-m.getAngle())}else{m.setAngle(-m.getAngle())}}var x=m.getStyle();if(x!=null){if(x.getAlignment()===TextStyle.Alignment.LEFT){m.setStyle(x.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT))}else{if(x.getAlignment()===TextStyle.Alignment.RIGHT){m.setStyle(x.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT))}}}}else{if(B!=null&&B instanceof Compass){var c=B;if(D){c.setX(j*2-c.getX());c.setNorthDirection(-c.getNorthDirection())}else{c.setY(j*2-c.getY());c.setNorthDirection(Math.PI-c.getNorthDirection())}}}}}}}}};b.flipPieceOfFurnitureName=function(c,d,f){if(f){c.setNameXOffset(-c.getNameXOffset());var e=c.getNameStyle();if(e!=null){if(e.getAlignment()===TextStyle.Alignment.LEFT){c.setNameStyle(e.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT))}else{if(e.getAlignment()===TextStyle.Alignment.RIGHT){c.setNameStyle(e.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT))}}}}else{c.setNameYOffset(-c.getNameYOffset());if(c.getNameXOffset()!==0||c.getNameYOffset()!==0){c.setNameXOffset(c.getNameXOffset()-d*Math.sin(c.getNameAngle()));c.setNameYOffset(c.getNameYOffset()-d*Math.cos(c.getNameAngle()))}c.setNameAngle(-c.getNameAngle())}};b.prototype.getTextBaseOffset=function(f,e,d){if(e==null){e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(d)}var c=this.getView().getTextBounds(f!=null?f:"Ag",e,0,0,0);return(c[c.length-1][1]+c[0][1])/2};b.prototype.joinSelectedWalls=function(){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var p=Home.getWallsSubList(h);var f=[null,null];for(var l=0;l<p.length;l++){var o=p[l];if((o.getArcExtent()==null||o.getArcExtent()===0)&&(o.getWallAtStart()==null||o.getWallAtEnd()==null)){if(f[0]==null){f[0]=o}else{f[1]=o;break}}}if(f[1]==null){(function(q,r){if(r.compare){q.sort(function(t,s){return r.compare(t,s)})}else{q.sort(r)}})(p,new b.PlanController$0(this,f));if(f[0]!==p[1]){f[1]=p[1]}}if(f[1]!=null){var n=Math.atan2(f[0].getYEnd()-f[0].getYStart(),f[0].getXEnd()-f[0].getXStart());var g=Math.atan2(f[1].getYEnd()-f[1].getYStart(),f[1].getXEnd()-f[1].getXStart());var j=Math.abs(n-g)%Math.PI;var k=j<=Math.PI/360||(Math.PI-j)<=Math.PI/360;var e=null;if(!k){e=b.computeIntersection$float$float$float$float$float$float$float$float(f[0].getXStart(),f[0].getYStart(),f[0].getXEnd(),f[0].getYEnd(),f[1].getXStart(),f[1].getYStart(),f[1].getXEnd(),f[1].getYEnd())}else{if(java.awt.geom.Line2D.ptLineDistSq(f[1].getXStart(),f[1].getYStart(),f[1].getXEnd(),f[1].getYEnd(),f[0].getXStart(),f[0].getYStart())<0.01&&java.awt.geom.Line2D.ptLineDistSq(f[1].getXStart(),f[1].getYStart(),f[1].getXEnd(),f[1].getYEnd(),f[0].getXEnd(),f[0].getYEnd())<0.01){if((f[1].getWallAtStart()==null)!==(f[1].getWallAtEnd()==null)){if(f[1].getWallAtStart()==null){e=[f[1].getXStart(),f[1].getYStart()]}else{e=[f[1].getXEnd(),f[1].getYEnd()]}}else{if(f[1].getWallAtStart()==null&&f[1].getWallAtEnd()==null){var m=java.awt.geom.Line2D.ptSegDistSq(f[1].getXStart(),f[1].getYStart(),f[1].getXEnd(),f[1].getYEnd(),f[0].getXStart(),f[0].getYStart());var d=java.awt.geom.Line2D.ptSegDistSq(f[1].getXStart(),f[1].getYStart(),f[1].getXEnd(),f[1].getYEnd(),f[0].getXEnd(),f[0].getYEnd());if(m>0.01&&d>0.01){if(f[0].getWallAtEnd()!=null||f[0].getWallAtStart()==null&&m<=d){if(java.awt.geom.Point2D.distanceSq(f[1].getXStart(),f[1].getYStart(),f[0].getXStart(),f[0].getYStart())<java.awt.geom.Point2D.distanceSq(f[1].getXEnd(),f[1].getYEnd(),f[0].getXStart(),f[0].getYStart())){e=[f[1].getXStart(),f[1].getYStart()]}else{e=[f[1].getXEnd(),f[1].getYEnd()]}}else{if(java.awt.geom.Point2D.distanceSq(f[1].getXStart(),f[1].getYStart(),f[0].getXEnd(),f[0].getYEnd())<java.awt.geom.Point2D.distanceSq(f[1].getXEnd(),f[1].getYEnd(),f[0].getXEnd(),f[0].getYEnd())){e=[f[1].getXStart(),f[1].getYStart()]}else{e=[f[1].getXEnd(),f[1].getYEnd()]}}}}}}}if(e!=null){var c=b.JoinedWall.getJoinedWalls([f[0],f[1]]);this.doJoinWalls(c,e);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallsJoiningUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,h.slice(0),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),c,e))}}};b.prototype.doJoinWalls=function(j,e){var d=[j[0].getWall(),j[1].getWall()];var g=false;for(var f=0;f<2;f++){var c=d[f].getWallAtEnd()==null;var h=d[f].getWallAtStart()==null;if(h&&c){if(java.awt.geom.Point2D.distanceSq(d[f].getXStart(),d[f].getYStart(),e[0],e[1])<java.awt.geom.Point2D.distanceSq(d[f].getXEnd(),d[f].getYEnd(),e[0],e[1])){c=false}else{h=false}}if(c){d[f].setXEnd(e[0]);d[f].setYEnd(e[1])}else{if(h){d[f].setXStart(e[0]);d[f].setYStart(e[1])}}if(g||d[(f+1)%2].getWallAtStart()==null||d[(f+1)%2].getWallAtEnd()==null){if(c){d[f].setWallAtEnd(d[(f+1)%2]);g=true}else{if(h){d[f].setWallAtStart(d[(f+1)%2]);g=true}}}}if(g){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([d[0],d[1]])}else{this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([d[0]])}};b.prototype.reverseSelectedWallsDirection=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var c=Home.getWallsSubList(e);if(!(c.length==0)){var d=c.slice(0);this.doReverseWallsDirection(d);this.selectAndShowItems$java_util_List$boolean(d.slice(0),false);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallsDirectionReversingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e.slice(0),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),d))}};b.prototype.doReverseWallsDirection=function(e){for(var h=0;h<e.length;h++){var m=e[h];var k=m.getXStart();var r=m.getYStart();var c=m.getXEnd();var n=m.getYEnd();m.setXStart(c);m.setYStart(n);m.setXEnd(k);m.setYEnd(r);if(m.getArcExtent()!=null){m.setArcExtent(-m.getArcExtent())}var l=m.getWallAtStart();var q=l!=null&&l.getWallAtEnd()===m;var p=l!=null&&l.getWallAtStart()===m;var d=m.getWallAtEnd();var f=d!=null&&d.getWallAtEnd()===m;var g=d!=null&&d.getWallAtStart()===m;m.setWallAtStart(d);m.setWallAtEnd(l);if(q){l.setWallAtEnd(m)}else{if(p){l.setWallAtStart(m)}}if(f){d.setWallAtEnd(m)}else{if(g){d.setWallAtStart(m)}}var j=m.getHeightAtEnd();if(j!=null){var o=m.getHeight();m.setHeight(j);m.setHeightAtEnd(o)}b.reverseWallSidesStyle(m)}};b.reverseWallSidesStyle=function(g){var f=g.getRightSideColor();var l=g.getRightSideTexture();var c=g.getLeftSideShininess();var d=g.getLeftSideBaseboard();var e=g.getLeftSideColor();var j=g.getLeftSideTexture();var h=g.getRightSideShininess();var k=g.getRightSideBaseboard();g.setLeftSideColor(f);g.setLeftSideTexture(l);g.setLeftSideShininess(h);g.setLeftSideBaseboard(k);g.setRightSideColor(e);g.setRightSideTexture(j);g.setRightSideShininess(c);g.setRightSideBaseboard(d)};b.prototype.splitSelectedWall=function(){var m=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var s=Home.getWallsSubList(m);if(s.length===1){var o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var w=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();var r=s[0];var x=new b.JoinedWall(r);var f=r.getXStart();var k=r.getYStart();var j=r.getXEnd();var n=r.getYEnd();var q=(f+j)/2;var d=(k+n)/2;var t=r.getWallAtStart();var g=t!=null&&t.getWallAtEnd()===r;var l=t!=null&&t.getWallAtStart()===r;var h=r.getWallAtEnd();var u=h!=null&&h.getWallAtEnd()===r;var c=h!=null&&h.getWallAtStart()===r;var v=r.duplicate();this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(v);v.setLevel(r.getLevel());var p=r.duplicate();this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(p);p.setLevel(r.getLevel());v.setXEnd(q);v.setYEnd(d);p.setXStart(q);p.setYStart(d);if(r.getHeightAtEnd()!=null){var e=(r.getHeight()+r.getHeightAtEnd())/2;v.setHeightAtEnd(e);p.setHeight(e)}v.setWallAtEnd(p);p.setWallAtStart(v);v.setWallAtStart(t);if(g){t.setWallAtEnd(v)}else{if(l){t.setWallAtStart(v)}}p.setWallAtEnd(h);if(u){h.setWallAtEnd(p)}else{if(c){h.setWallAtStart(p)}}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(r);this.selectAndShowItems$java_util_List$boolean([v].slice(0),false);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallSplittingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,m.slice(0),w,o,x,new b.JoinedWall(v),new b.JoinedWall(p),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()))}};b.prototype.modifySelectedRooms=function(){if(!(Home.getRoomsSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length==0)){new RoomController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())}};b.prototype.createLabel=function(c,d){new LabelController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,c,d,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())};b.prototype.modifySelectedLabels=function(){if(!(Home.getLabelsSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length==0)){new LabelController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())}};b.prototype.modifySelectedPolylines=function(){if(!(Home.getPolylinesSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length==0)){new PolylineController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())}};b.prototype.modifyCompass=function(){new CompassController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())};b.prototype.modifyObserverCamera=function(){new ObserverCameraController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory).displayView(this.getView())};b.prototype.toggleBoldStyle=function(){var h=null;var k=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var j=0;j<k.length;j++){var r=k[j];var l=void 0;if(r!=null&&r instanceof Label){l=this.getItemTextStyle(r,r.getStyle()).isBold()}else{if((r!=null&&r instanceof HomePieceOfFurniture)&&r.isVisible()){l=this.getItemTextStyle(r,r.getNameStyle()).isBold()}else{if(r!=null&&r instanceof Room){var c=r;l=this.getItemTextStyle(c,c.getNameStyle()).isBold();if(l!==this.getItemTextStyle(c,c.getAreaStyle()).isBold()){l=null}}else{if(r!=null&&r instanceof DimensionLine){l=this.getItemTextStyle(r,r.getLengthStyle()).isBold()}else{continue}}}}if(h==null){h=l}else{if(l==null||!(h===l)){h=null;break}}}if(h==null){h=true}else{h=!h}var f=([]);var e=([]);var o=([]);var k=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var j=0;j<k.length;j++){var r=k[j];if(r!=null&&r instanceof Label){var n=r;(f.push(n)>0);var q=this.getItemTextStyle(n,n.getStyle());(e.push(q)>0);(o.push(q.deriveBoldStyle(h))>0)}else{if(r!=null&&r instanceof HomePieceOfFurniture){var s=r;if(s.isVisible()){(f.push(s)>0);var g=this.getItemTextStyle(s,s.getNameStyle());(e.push(g)>0);(o.push(g.deriveBoldStyle(h))>0)}}else{if(r!=null&&r instanceof Room){var c=r;(f.push(c)>0);var g=this.getItemTextStyle(c,c.getNameStyle());(e.push(g)>0);(o.push(g.deriveBoldStyle(h))>0);var d=this.getItemTextStyle(c,c.getAreaStyle());(e.push(d)>0);(o.push(d.deriveBoldStyle(h))>0)}else{if(r!=null&&r instanceof DimensionLine){var p=r;(f.push(p)>0);var m=this.getItemTextStyle(p,p.getLengthStyle());(e.push(m)>0);(o.push(m.deriveBoldStyle(h))>0)}}}}}this.modifyTextStyle(f.slice(0),e.slice(0),o.slice(0))};b.prototype.getItemTextStyle=function(c,d){if(d==null){d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(c.constructor)}return d};b.prototype.toggleItalicStyle=function(){var h=null;var l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var k=0;k<l.length;k++){var r=l[k];var j=void 0;if(r!=null&&r instanceof Label){j=this.getItemTextStyle(r,r.getStyle()).isItalic()}else{if((r!=null&&r instanceof HomePieceOfFurniture)&&r.isVisible()){j=this.getItemTextStyle(r,r.getNameStyle()).isItalic()}else{if(r!=null&&r instanceof Room){var c=r;j=this.getItemTextStyle(c,c.getNameStyle()).isItalic();if(j!==this.getItemTextStyle(c,c.getAreaStyle()).isItalic()){j=null}}else{if(r!=null&&r instanceof DimensionLine){j=this.getItemTextStyle(r,r.getLengthStyle()).isItalic()}else{continue}}}}if(h==null){h=j}else{if(j==null||!(h===j)){h=null;break}}}if(h==null){h=true}else{h=!h}var f=([]);var e=([]);var o=([]);var l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var k=0;k<l.length;k++){var r=l[k];if(r!=null&&r instanceof Label){var n=r;(f.push(n)>0);var q=this.getItemTextStyle(n,n.getStyle());(e.push(q)>0);(o.push(q.deriveItalicStyle(h))>0)}else{if(r!=null&&r instanceof HomePieceOfFurniture){var s=r;if(s.isVisible()){(f.push(s)>0);var g=this.getItemTextStyle(s,s.getNameStyle());(e.push(g)>0);(o.push(g.deriveItalicStyle(h))>0)}}else{if(r!=null&&r instanceof Room){var c=r;(f.push(c)>0);var g=this.getItemTextStyle(c,c.getNameStyle());(e.push(g)>0);(o.push(g.deriveItalicStyle(h))>0);var d=this.getItemTextStyle(c,c.getAreaStyle());(e.push(d)>0);(o.push(d.deriveItalicStyle(h))>0)}else{if(r!=null&&r instanceof DimensionLine){var p=r;(f.push(p)>0);var m=this.getItemTextStyle(p,p.getLengthStyle());(e.push(m)>0);(o.push(m.deriveItalicStyle(h))>0)}}}}}this.modifyTextStyle(f.slice(0),e.slice(0),o.slice(0))};b.prototype.increaseTextSize=function(){this.applyFactorToTextSize(1.1)};b.prototype.decreaseTextSize=function(){this.applyFactorToTextSize(1/1.1)};b.prototype.applyFactorToTextSize=function(k){var f=([]);var e=([]);var m=([]);var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var h=0;h<j.length;h++){var q=j[h];if(q!=null&&q instanceof Label){var n=q;(f.push(n)>0);var p=this.getItemTextStyle(q,n.getStyle());(e.push(p)>0);(m.push(p.deriveStyle$float(Math.round(p.getFontSize()*k)))>0)}else{if(q!=null&&q instanceof HomePieceOfFurniture){var r=q;if(r.isVisible()){(f.push(r)>0);var g=this.getItemTextStyle(r,r.getNameStyle());(e.push(g)>0);(m.push(g.deriveStyle$float(Math.round(g.getFontSize()*k)))>0)}}else{if(q!=null&&q instanceof Room){var c=q;(f.push(c)>0);var g=this.getItemTextStyle(c,c.getNameStyle());(e.push(g)>0);(m.push(g.deriveStyle$float(Math.round(g.getFontSize()*k)))>0);var d=this.getItemTextStyle(c,c.getAreaStyle());(e.push(d)>0);(m.push(d.deriveStyle$float(Math.round(d.getFontSize()*k)))>0)}else{if(q!=null&&q instanceof DimensionLine){var o=q;(f.push(o)>0);var l=this.getItemTextStyle(o,o.getLengthStyle());(e.push(l)>0);(m.push(l.deriveStyle$float(Math.round(l.getFontSize()*k)))>0)}}}}}this.modifyTextStyle(f.slice(0),e.slice(0),m.slice(0))};b.prototype.modifyTextStyle=function(d,f,g){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var c=h.slice(0);b.doModifyTextStyle(d,g);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.TextStyleModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,e,f,d,g))};b.doModifyTextStyle=function(c,g){var j=0;for(var d=0;d<c.length;d++){var f=c[d];if(f!=null&&f instanceof Label){f.setStyle(g[j++])}else{if(f!=null&&f instanceof HomePieceOfFurniture){var e=f;if(e.isVisible()){e.setNameStyle(g[j++])}}else{if(f!=null&&f instanceof Room){var h=f;h.setNameStyle(g[j++]);h.setAreaStyle(g[j++])}else{if(f!=null&&f instanceof DimensionLine){f.setLengthStyle(g[j++])}}}}}};b.prototype.getMinimumScale=function(){return 0.01};b.prototype.getMaximumScale=function(){return 10};b.prototype.getScale=function(){return this.getView().getScale()};b.prototype.setScale=function(e){e=Math.max(this.getMinimumScale(),Math.min(e,this.getMaximumScale()));if(e!==this.getView().getScale()){var d=this.getView().getScale();this.furnitureSidesCache.entries=[];if(this.getView()!=null){var c=this.getView().convertXModelToScreen(this.getXLastMouseMove());var f=this.getView().convertXModelToScreen(this.getYLastMouseMove());this.getView().setScale(e);this.moveMouse(this.getView().convertXPixelToModel(c),this.getView().convertYPixelToModel(f))}this.propertyChangeSupport.firePropertyChange("SCALE",d,e);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setProperty(b.SCALE_VISUAL_PROPERTY,String(e).toString())}};b.prototype.setSelectedLevel=function(c){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedLevel(c)};b.prototype.selectAll=function(){var c=this.getVisibleItemsAtSelectedLevel();if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(this.getItemsNotPartOfBasePlan(c))}else{this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(c)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(false)};b.prototype.getVisibleItemsAtSelectedLevel=function(){var e=([]);var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectableViewableItems();for(var c=0;c<g.length;c++){var d=g[c];if(d!=null&&d instanceof HomePieceOfFurniture){if(this.isPieceOfFurnitureVisibleAtSelectedLevel(d)){(e.push(d)>0)}}else{if(!(d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))||d.isAtLevel(f)){(e.push(d)>0)}}}return e};b.prototype.selectAllAtAllLevels=function(){var c=(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectableViewableItems().slice(0));if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()){c=this.getItemsNotPartOfBasePlan(c)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(c);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(true)};b.prototype.getDetectableRoomsAtSelectedLevel=function(){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();if(j==null||l.length<=1){return d}else{var g=([]);var f=l.indexOf(j);var k=l[0]===j||l[f-1].getElevation()===j.getElevation();var h=l[k&&f<l.length-1?f+1:f-1];for(var e=0;e<d.length;e++){var c=d[e];if(c.isAtLevel(j)||h!=null&&c.isAtLevel(h)&&(k&&c.isFloorVisible()||!k&&c.isCeilingVisible())){(g.push(c)>0)}}return g}};b.prototype.getDetectableWallsAtSelectedLevel=function(){var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();if(j==null||l.length<=1){return c}else{var e=([]);var f=l.indexOf(j);var k=l[0]===j||l[f-1].getElevation()===j.getElevation();var g=l[k&&f<l.length-1?f+1:f-1];for(var d=0;d<c.length;d++){var h=c[d];if(h.isAtLevel(j)||g!=null&&h.isAtLevel(g)){(e.push(h)>0)}}return e}};b.prototype.getHorizontalRulerView=function(){return this.getView().getHorizontalRuler()};b.prototype.getVerticalRulerView=function(){return this.getView().getVerticalRuler()};b.prototype.__com_eteks_sweethome3d_viewcontroller_PlanController_addModelListeners=function(){var c=this;this.selectionListener=new b.PlanController$1(this);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera().addPropertyChangeListener(new b.PlanController$2(this));this.wallChangeListener=new b.PlanController$3(this);var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var d=0;d<e.length;d++){var h=e[d];h.addPropertyChangeListener(this.wallChangeListener)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWallsListener(function(m){if(m.getType()===CollectionEvent.Type.ADD){m.getItem().addPropertyChangeListener(c.wallChangeListener)}else{if(m.getType()===CollectionEvent.Type.DELETE){m.getItem().removePropertyChangeListener(c.wallChangeListener)}}c.resetAreaCache()});var g=new b.PlanController$4(this);this.furnitureSizeChangeListener=new b.PlanController$5(this);var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();for(var d=0;d<e.length;d++){var l=e[d];l.addPropertyChangeListener(g);l.addPropertyChangeListener(this.furnitureSizeChangeListener);if(l!=null&&l instanceof HomeFurnitureGroup){var k=l.getAllFurniture();for(var f=0;f<k.length;f++){var j=k[f];j.addPropertyChangeListener(this.furnitureSizeChangeListener)}}}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addFurnitureListener(function(p){var o=p.getItem();if(p.getType()===CollectionEvent.Type.ADD){o.addPropertyChangeListener(g);o.addPropertyChangeListener(c.furnitureSizeChangeListener);if(o!=null&&o instanceof HomeFurnitureGroup){var q=o.getAllFurniture();for(var n=0;n<q.length;n++){var m=q[n];m.addPropertyChangeListener(c.furnitureSizeChangeListener)}}}else{if(p.getType()===CollectionEvent.Type.DELETE){o.removePropertyChangeListener(g);(function(r,s){if(r.entries==null){r.entries=[]}for(var t=0;t<r.entries.length;t++){if(r.entries[t].key==null&&s==null||r.entries[t].key.equals!=null&&r.entries[t].key.equals(s)||r.entries[t].key===s){return r.entries.splice(t,1)[0]}}})(c.furnitureSidesCache,o);o.removePropertyChangeListener(c.furnitureSizeChangeListener);if(o!=null&&o instanceof HomeFurnitureGroup){var q=o.getAllFurniture();for(var n=0;n<q.length;n++){var m=q[n];m.removePropertyChangeListener(c.furnitureSizeChangeListener)}}}}});this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPropertyChangeListener("SELECTED_LEVEL",new b.PlanController$6(this));this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera().setFixedSize(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels().length>=2);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLevelsListener(function(m){c.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera().setFixedSize(c.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels().length>=2)})};b.prototype.getSelectionListener=function(){return this.selectionListener};b.prototype.resetAreaCache=function(){this.wallsAreaCache=null;this.wallsIncludingBaseboardsAreaCache=null;this.insideWallsAreaCache=null;this.roomPathsCache=null};b.prototype.startDraggedItems=function(h,c,g){this.draggedItems=h;if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()){var f=Home.getFurnitureSubList(h);for(var d=0;d<f.length;d++){var e=f[d];if(e.isResizable()){e.setWidth(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(e.getWidth(),0.1));e.setWidthInPlan(e.getWidth());e.setDepth(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(e.getDepth(),0.1));e.setDepthInPlan(e.getDepth());e.setHeight(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(e.getHeight(),0.1));e.setHeightInPlan(e.getHeight())}e.setElevation(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(e.getElevation(),0.1))}}if(this.isModificationState()){this.escape()}this.setState(this.getDragAndDropState());this.moveMouse(c,g)};b.prototype.stopDraggedItems=function(){if(this.state!==this.getDragAndDropState()){throw new IllegalStateException("Controller isn't in a drag and drop state")}this.draggedItems=null;this.setState(this.previousState)};b.prototype.adjustMagnetizedPieceOfFurniture=function(d,c,g){var f=this.adjustPieceOfFurnitureElevation(d)!=null;var e=this.adjustPieceOfFurnitureOnWallAt(d,c,g,true);if(!f){this.adjustPieceOfFurnitureSideBySideAt(d,e==null,e)}};b.prototype.adjustPieceOfFurnitureOnWallAt=function(A,X,W,w){var k=b.PIXEL_MARGIN/this.getScale();var m=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var ai=A.getPoints();var d=!A.isDoorOrWindow()&&A.getElevation()===0;var v=this.getWallsArea(d);var s=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();var h=null;var T=null;if(w||!A.isDoorOrWindow()){for(var R=0;R<s.length;R++){var q=s[R];if(q.isAtLevel(m)&&this.isLevelNullOrViewable(q.getLevel())&&q.containsPoint$float$float$boolean$float(X,W,d,0)&&q.getStartPointToEndPointDistance()>0){h=this.getReferenceWall(q,X,W);T=q.getArcExtent();break}}if(h==null){for(var R=0;R<s.length;R++){var q=s[R];if(q.isAtLevel(m)&&this.isLevelNullOrViewable(q.getLevel())&&q.containsPoint$float$float$boolean$float(X,W,d,0)&&q.getStartPointToEndPointDistance()>0){h=this.getReferenceWall(q,X,W);T=q.getArcExtent();break}}}}if(h==null){var c=new java.awt.geom.Area(this.getRotatedRectangle(A.getX()-A.getWidthInPlan()/2-k,A.getY()-A.getDepthInPlan()/2-k,A.getWidthInPlan()+2*k,A.getDepthInPlan()+2*k,A.getAngle()));var ag=0;for(var R=0;R<s.length;R++){var q=s[R];if(q.isAtLevel(m)&&this.isLevelNullOrViewable(q.getLevel())&&q.getStartPointToEndPointDistance()>0){var aj=q.getPoints$boolean(d);var ad=new java.awt.geom.Area(this.getPath$float_A_A(aj));ad.intersect(c);if(!ad.isEmpty()){var Y=this.getArea(ad);if(Y>ag){ag=Y;if(w){h=this.getReferenceWall(q,X,W);T=q.getArcExtent()}else{var r=ad.getBounds2D();h=this.getReferenceWall(q,r.getCenterX(),r.getCenterY());T=q.getArcExtent()}}}}}}if(h!=null){var e=X;var P=W;var B=A.getAngle();var O=A.getWidthInPlan()/2;var Z=A.getDepthInPlan()/2;var F=Math.atan2(h.getYEnd()-h.getYStart(),h.getXEnd()-h.getXStart());var aj=h.getPoints$boolean(d);var t=F>-Math.PI/2&&F<=Math.PI/2;var J=Math.cos(F);var G=Math.sin(F);var z=aj[0][0]!==aj[0][1]||aj[1][0]!==aj[1][1]?java.awt.geom.Line2D.ptLineDist(aj[0][0],aj[0][1],aj[1][0],aj[1][1],X,W):java.awt.geom.Point2D.distance(aj[0][0],aj[0][1],X,W);var H=aj[2][0]!==aj[2][1]||aj[3][0]!==aj[3][1]?java.awt.geom.Line2D.ptLineDist(aj[2][0],aj[2][1],aj[3][0],aj[3][1],X,W):java.awt.geom.Point2D.distance(aj[2][0],aj[2][1],X,W);var u=w||A.isDoorOrWindow()||h.containsPoint$float$float$boolean$float(X,W,d,k);if(u){var p=java.awt.geom.Line2D.ptLineDist(ai[0][0],ai[0][1],ai[3][0],ai[3][1],X,W);var Q=java.awt.geom.Line2D.ptLineDist(ai[1][0],ai[1][1],ai[2][0],ai[2][1],X,W);var l=B>(3*Math.PI/2+0.000001)||B<(Math.PI/2+0.000001)?p:Q;B=(H<z?F:F+Math.PI);if(A.isDoorOrWindow()){var E=0.00075;var ac=void 0;if(T==null||T===0){ac=E/2;if(A!=null&&A instanceof HomeDoorOrWindow){var V=A;if(A.isResizable()&&this.isItemResizable(A)&&V.isWidthDepthDeformable()&&V.getModelTransformations()==null){A.setDepth(E+h.getThickness()/V.getWallThickness());A.setDepthInPlan(A.getDepth());Z=A.getDepth()/2;ac+=A.getDepth()*V.getWallDistance()}else{ac+=A.getDepth()*(V.getWallDistance()+V.getWallThickness())-h.getThickness()}}}else{ac=-h.getThickness()/2;if(A!=null&&A instanceof HomeDoorOrWindow){var V=A;ac+=A.getDepth()*(V.getWallDistance()+V.getWallThickness()/2)}}if(H<z){e+=G*((z+ac)-Z);P+=J*(-(z+ac)+Z)}else{e+=G*(-(H+ac)+Z);P+=J*((H+ac)-Z)}if(t){e+=J*(O-l);P+=G*(O-l)}else{e+=-J*(O-l);P+=-G*(O-l)}}else{if(H<z){var o=java.awt.geom.Line2D.relativeCCW(aj[2][0],aj[2][1],aj[3][0],aj[3][1],X,W);e+=o*G*H-G*Z;P+=-o*J*H+J*Z}else{var o=java.awt.geom.Line2D.relativeCCW(aj[0][0],aj[0][1],aj[1][0],aj[1][1],X,W);e+=-o*G*z+G*Z;P+=o*J*z-J*Z}if(t){e+=J*(O-l);P+=G*(O-l)}else{e+=-J*(O-l);P+=-G*(O-l)}}}else{var I=new java.awt.geom.Line2D.Float(h.getXStart(),h.getYStart(),h.getXEnd(),h.getYEnd());var j=this.getRotatedRectangle(0,0,A.getWidthInPlan(),A.getDepthInPlan(),(B-F));var U=j.getBounds2D().getHeight();var M=(function(x){if(x>0){return 1}else{if(x<0){return -1}else{return 0}}})(I.relativeCCW(A.getX(),A.getY()));var f=(function(x){if(x>0){return 1}else{if(x<0){return -1}else{return 0}}})(I.relativeCCW(X,W));var D=M*(-h.getThickness()/2+I.ptLineDist(A.getX(),A.getY())-U/2);if(d){if(M>0&&h.getLeftSideBaseboard()!=null){D-=M*h.getLeftSideBaseboard().getThickness()}else{if(M<0&&h.getRightSideBaseboard()!=null){D-=M*h.getRightSideBaseboard().getThickness()}}}if(f!==M){D-=f*(U+h.getThickness());if(h.getLeftSideBaseboard()!=null){D-=f*h.getLeftSideBaseboard().getThickness()}if(h.getRightSideBaseboard()!=null){D-=f*h.getRightSideBaseboard().getThickness()}}e=A.getX()+(-D*G);P=A.getY()+(D*J)}if(!A.isDoorOrWindow()&&(h.getArcExtent()==null||!u||java.awt.geom.Line2D.relativeCCW(h.getXStart(),h.getYStart(),h.getXEnd(),h.getYEnd(),X,W)>0)){var S=new java.awt.geom.Area(v);var n=new java.awt.geom.Area(this.getRotatedRectangle(e-O,P-Z,A.getWidthInPlan(),A.getDepthInPlan(),B));S.subtract(new java.awt.geom.Area(this.getPath$float_A_A(aj)));S.intersect(n);if(!S.isEmpty()){var L=this.getClosestPath(this.getAreaPaths(S),X,W);if(L!=null){n.subtract(v);if(n.isEmpty()){return null}else{var ah=this.getAreaPaths(n);var C=(F-B+2*Math.PI)%Math.PI;if(C<0.00001||Math.PI-C<0.00001||ah.length<2){var K=this.getClosestPath(ah,X,W);var ae=new java.awt.geom.Area(L);for(var R=0;R<ah.length;R++){var ab=ah[R];if(ab!==K){ae.add(new java.awt.geom.Area(ab))}}var N=java.awt.geom.AffineTransform.getRotateInstance(-F);var af=ae.createTransformedArea(N).getBounds2D();var aa=K.createTransformedShape(N).getBounds2D();if(!af.contains(aa)){var g=(function(x){if(x>0){return 1}else{if(x<0){return -1}else{return 0}}})(aa.getCenterX()-af.getCenterX());e+=af.getWidth()*J*g;P+=af.getWidth()*G*g}}}}}}A.setAngle(B);A.setX(e);A.setY(P);if(A!=null&&A instanceof HomeDoorOrWindow){A.setBoundToWall(T==null||T===0)}return h}return null};b.prototype.isLevelNullOrViewable=function(c){return c==null||c.isViewable()};b.prototype.getReferenceWall=function(e,d,k){var h=e.getArcExtent();if(h==null||h===0){return e}else{var j=Math.atan2(e.getYArcCircleCenter()-k,d-e.getXArcCircleCenter());var c=java.awt.geom.Point2D.distance(e.getXArcCircleCenter(),e.getYArcCircleCenter(),e.getXStart(),e.getYStart());var f=0.001;var g=new Wall((e.getXArcCircleCenter()+Math.cos(j+f)*c),(e.getYArcCircleCenter()-Math.sin(j+f)*c),(e.getXArcCircleCenter()+Math.cos(j-f)*c),(e.getYArcCircleCenter()-Math.sin(j-f)*c),e.getThickness(),0);g.setLeftSideBaseboard(e.getLeftSideBaseboard());g.setRightSideBaseboard(e.getRightSideBaseboard());return g}};b.prototype.getClosestPath=function(l,j,h){var c=null;var d=1.7976931348623157e+308;for(var f=0;f<l.length;f++){var m=l[f];var g=this.getPathPoints(m,true);for(var e=0;e<g.length;e++){var k=java.awt.geom.Line2D.ptSegDistSq(g[e][0],g[e][1],g[(e+1)%g.length][0],g[(e+1)%g.length][1],j,h);if(k<d){d=k;c=m}}}return c};b.prototype.getDimensionLinesAlongWall=function(g,A){var e=g.getPoints();var y=g.getAngle();var c=A.getPoints$();var v;var r;var s=g.isDoorOrWindow()?e[3]:e[0];if(java.awt.geom.Line2D.ptLineDistSq(c[0][0],c[0][1],c[1][0],c[1][1],s[0],s[1])<=java.awt.geom.Line2D.ptLineDistSq(c[2][0],c[2][1],c[3][0],c[3][1],s[0],s[1])){v=b.computeIntersection$float_A$float_A$float_A$float_A(c[0],c[1],e[0],e[3]);r=b.computeIntersection$float_A$float_A$float_A$float_A(c[0],c[1],e[1],e[2])}else{v=b.computeIntersection$float_A$float_A$float_A$float_A(c[2],c[3],e[0],e[3]);r=b.computeIntersection$float_A$float_A$float_A$float_A(c[2],c[3],e[1],e[2])}var l=([]);var z=null;var q=null;var C=this.getRoomPathsFromWalls();for(var x=0;x<C.length&&z==null&&q==null;x++){var o=this.getPathPoints(C[x],true);for(var w=0;w<o.length;w++){var p=o[w];var n=o[(w+1)%o.length];var E=n[0]-p[0];var D=n[1]-p[1];var B=Math.abs(E)<0.00001?Math.PI/2:(Math.abs(D)<0.00001?0:Math.atan2(D,E));var F=(B-y+2*Math.PI)%Math.PI;if(F<0.00001||Math.PI-F<0.00001){var k=java.awt.geom.Line2D.ptSegDistSq(p[0],p[1],n[0],n[1],v[0],v[1])<0.0001;var u=java.awt.geom.Line2D.ptSegDistSq(p[0],p[1],n[0],n[1],r[0],r[1])<0.0001;if(k||u){if(k){var t=java.awt.geom.Point2D.distanceSq(p[0],p[1],v[0],v[1]);var G=java.awt.geom.Point2D.distanceSq(p[0],p[1],r[0],r[1]);if(t<G||!u){z=p.slice(0)}else{z=n.slice(0)}}if(u){var d=java.awt.geom.Point2D.distanceSq(n[0],n[1],v[0],v[1]);var f=java.awt.geom.Point2D.distanceSq(n[0],n[1],r[0],r[1]);if(d<f&&k){q=p.slice(0)}else{q=n.slice(0)}}break}}}}var m=!g.isDoorOrWindow()&&java.awt.geom.Line2D.ptLineDistSq(A.getXStart(),A.getYStart(),A.getXEnd(),A.getYEnd(),s[0],s[1])>java.awt.geom.Line2D.ptLineDistSq(A.getXStart(),A.getYStart(),A.getXEnd(),A.getYEnd(),e[3][0],e[3][1]);if(z!=null){var h=void 0;if(m){h=-java.awt.geom.Point2D.distance(v[0],v[1],e[0][0],e[0][1])-10/this.getView().getScale()}else{h=java.awt.geom.Point2D.distance(v[0],v[1],e[3][0],e[3][1])+10/this.getView().getScale()}(l.push(this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(z,v,h,0,false))>0)}if(q!=null){var h=void 0;if(m){h=-java.awt.geom.Point2D.distance(r[0],r[1],e[1][0],e[1][1])-10/this.getView().getScale()}else{h=java.awt.geom.Point2D.distance(r[0],r[1],e[2][0],e[2][1])+10/this.getView().getScale()}(l.push(this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(r,q,h,0,false))>0)}for(var x=l.length-1;x>=0;x--){if(l[x].getLength()<0.01){l.splice(x,1)[0]}}return l};b.computeIntersection$float_A$float_A$float_A$float_A=function(f,e,d,c){return b.computeIntersection$float$float$float$float$float$float$float$float(f[0],f[1],e[0],e[1],d[0],d[1],c[0],c[1])};b.computeIntersection$float$float$float$float$float$float$float$float=function(r,j,q,h,o,g,m,f){var l=q;var k=h;var p=(h-j)/(q-r);var n=(f-g)/(m-o);if(p!==n){if(Math.abs(p)>4000){if(Math.abs(n)<4000){l=r;var d=f-n*m;k=n*l+d}}else{if(Math.abs(n)>4000){if(Math.abs(p)<4000){l=o;var e=h-p*q;k=p*l+e}}else{var c=(function(s){if(s>0){return 1}else{if(s<0){return -1}else{return 0}}})(p)===(function(s){if(s>0){return 1}else{if(s<0){return -1}else{return 0}}})(n);if(Math.abs(p-n)>0.00001&&(!c||(Math.abs(p)>Math.abs(n)?p/n:n/p)>1.004)){var e=h-p*q;var d=f-n*m;l=(d-e)/(p-n);k=p*l+e}}}}return[l,k]};b.computeIntersection=function(d,h,c,g,k,f,j,e){if(((typeof d==="number")||d===null)&&((typeof h==="number")||h===null)&&((typeof c==="number")||c===null)&&((typeof g==="number")||g===null)&&((typeof k==="number")||k===null)&&((typeof f==="number")||f===null)&&((typeof j==="number")||j===null)&&((typeof e==="number")||e===null)){return b.computeIntersection$float$float$float$float$float$float$float$float(d,h,c,g,k,f,j,e)}else{if(((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||(typeof d[0]==="number")))||d===null)&&((h!=null&&h instanceof Array&&(h.length==0||h[0]==null||(typeof h[0]==="number")))||h===null)&&((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||(typeof c[0]==="number")))||c===null)&&((g!=null&&g instanceof Array&&(g.length==0||g[0]==null||(typeof g[0]==="number")))||g===null)&&k===undefined&&f===undefined&&j===undefined&&e===undefined){return b.computeIntersection$float_A$float_A$float_A$float_A(d,h,c,g)}else{throw new Error("invalid overload")}}};b.prototype.adjustPieceOfFurnitureElevation=function(d){if(!d.isDoorOrWindow()&&d.getElevation()===0){var c=this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(d);if(c!=null){var e=c.getElevation();if(c.isHorizontallyRotated()){e+=c.getHeightInPlan()}else{e+=c.getHeight()*c.getDropOnTopElevation()}if(c.getLevel()!=null){e+=c.getLevel().getElevation()-(d.getLevel()!=null?d.getLevel().getElevation():this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel().getElevation())}d.setElevation(Math.max(0,e));return c}}return null};b.prototype.adjustPieceOfFurnitureSideBySideAt=function(u,s,K){var O=u.getPoints();var k=new java.awt.geom.Area(this.getPath$float_A_A(O));var m=(u!=null&&u instanceof HomeDoorOrWindow)&&u.isBoundToWall();var x=u.getGroundElevation();var h=2*b.PIXEL_MARGIN/this.getScale();var L=null;var c=null;var J=0;var n=null;var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();for(var D=0;D<e.length;D++){var A=e[D];var F=A.getGroundElevation();if(A!==u&&this.isPieceOfFurnitureVisibleAtSelectedLevel(A)&&x<F+A.getHeightInPlan()&&x+u.getHeightInPlan()>F&&(!m||A.isDoorOrWindow())){var H=A.getPoints();var G=void 0;if(m&&A.isDoorOrWindow()){G=new java.awt.geom.Area(this.getPath$float_A_A(new Wall(H[1][0],H[1][1],H[2][0],H[2][1],h,0).getPoints$()));G.add(new java.awt.geom.Area(this.getPath$float_A_A(new Wall(H[3][0],H[3][1],H[0][0],H[0][1],h,0).getPoints$())))}else{G=(function(P,Q){if(P.entries==null){P.entries=[]}for(var R=0;R<P.entries.length;R++){if(P.entries[R].key==null&&Q==null||P.entries[R].key.equals!=null&&P.entries[R].key.equals(Q)||P.entries[R].key===Q){return P.entries[R].value}}return null})(this.furnitureSidesCache,A);if(G==null){var N=(function(Q){var P=[];while(Q-->0){P.push(null)}return P})(H.length);for(var M=0;M<N.length;M++){N[M]=new Wall(H[M][0],H[M][1],H[(M+1)%N.length][0],H[(M+1)%N.length][1],h,0)}for(var M=0;M<N.length;M++){N[(M+1)%N.length].setWallAtStart(N[M]);N[M].setWallAtEnd(N[(M+1)%N.length])}var C=(function(Q){var P=[];while(Q-->0){P.push(null)}return P})(N.length*2+2);var B=null;for(var M=0;M<N.length;M++){B=N[M].getPoints$();C[M]=B[0];C[C.length-M-1]=B[3]}C[(C.length/2|0)-1]=B[1];C[(C.length/2|0)]=B[2];G=new java.awt.geom.Area(this.getPath$float_A_A(C));(function(P,R,Q){if(P.entries==null){P.entries=[]}for(var S=0;S<P.entries.length;S++){if(P.entries[S].key==null&&R==null||P.entries[S].key.equals!=null&&P.entries[S].key.equals(R)||P.entries[S].key===R){P.entries[S].value=Q;return}}P.entries.push({key:R,value:Q,getKey:function(){return this.key},getValue:function(){return this.value}})})(this.furnitureSidesCache,A,G)}}var d=new java.awt.geom.Area(G);d.intersect(k);if(!d.isEmpty()){var r=new java.awt.geom.Area(k);r.exclusiveOr(d);if(r.isSingular()){var t=new java.awt.geom.Area(this.getPath$float_A_A(H));t.subtract(G);t.intersect(k);if(t.isEmpty()){var I=this.getArea(d);if(I>J){J=I;L=A;n=H;c=d}}}}}}if(L!=null){var v=void 0;if(m&&L.isDoorOrWindow()){v=false}else{var l=this.getRotatedRectangle(L.getX()-L.getWidthInPlan(),L.getY()-L.getDepthInPlan(),L.getWidthInPlan()*2,L.getDepthInPlan()*2,L.getAngle());var f=this.getPathPoints(l,false);v=this.isAreaLargerOnFrontOrBackSide(c,f)}if(s){u.setAngle(L.getAngle())}var j=this.getRotatedRectangle(0,0,u.getWidthInPlan(),u.getDepthInPlan(),u.getAngle()-L.getAngle());var p=0;var o=0;if(!v){var y=new java.awt.geom.Line2D.Float(L.getX(),L.getY(),(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2);var z=j.getBounds2D().getWidth();var w=y.relativeCCW(u.getX(),u.getY())*(-L.getWidthInPlan()/2+y.ptLineDist(u.getX(),u.getY())-z/2);p=(w*Math.cos(L.getAngle()));o=(w*Math.sin(L.getAngle()))}else{var y=new java.awt.geom.Line2D.Float(L.getX(),L.getY(),(n[2][0]+n[1][0])/2,(n[2][1]+n[1][1])/2);var E=j.getBounds2D().getHeight();var w=y.relativeCCW(u.getX(),u.getY())*(-L.getDepthInPlan()/2+y.ptLineDist(u.getX(),u.getY())-E/2);p=(-w*Math.sin(L.getAngle()));o=(w*Math.cos(L.getAngle()));if(!this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float(u,K,p,o)){p=o=0}}if(!this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float(u,L,p,o)){u.move(p,o);return L}else{if(s){O=u.getPoints()}var q=this.isAreaLargerOnFrontOrBackSide(c,O);var g=this.getRotatedRectangle(0,0,L.getWidthInPlan(),L.getDepthInPlan(),L.getAngle()-u.getAngle());if(!q){var y=new java.awt.geom.Line2D.Float(u.getX(),u.getY(),(O[0][0]+O[1][0])/2,(O[0][1]+O[1][1])/2);var z=g.getBounds2D().getWidth();var w=y.relativeCCW(L.getX(),L.getY())*(-u.getWidthInPlan()/2+y.ptLineDist(L.getX(),L.getY())-z/2);p=-(w*Math.cos(u.getAngle()));o=-(w*Math.sin(u.getAngle()))}else{var y=new java.awt.geom.Line2D.Float(u.getX(),u.getY(),(O[2][0]+O[1][0])/2,(O[2][1]+O[1][1])/2);var E=g.getBounds2D().getHeight();var w=y.relativeCCW(L.getX(),L.getY())*(-u.getDepthInPlan()/2+y.ptLineDist(L.getX(),L.getY())-E/2);p=-(-w*Math.sin(u.getAngle()));o=-(w*Math.cos(u.getAngle()));if(!this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float(u,K,p,o)){p=o=0}}if(!this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float(u,L,p,o)){u.move(p,o);return L}}return L}return null};b.prototype.isAreaLargerOnFrontOrBackSide=function(f,d){var e=new java.awt.geom.GeneralPath();e.moveTo(d[0][0],d[0][1]);e.lineTo(d[2][0],d[2][1]);e.lineTo(d[3][0],d[3][1]);e.lineTo(d[1][0],d[1][1]);e.closePath();var h=new java.awt.geom.Area(f);h.intersect(new java.awt.geom.Area(e));if(h.isEmpty()){return false}else{var g=new java.awt.geom.GeneralPath();g.moveTo(d[0][0],d[0][1]);g.lineTo(d[2][0],d[2][1]);g.lineTo(d[1][0],d[1][1]);g.lineTo(d[3][0],d[3][1]);g.closePath();var c=new java.awt.geom.Area(f);c.intersect(new java.awt.geom.Area(g));return this.getArea(h)>this.getArea(c)}};b.prototype.getArea=function(d){var c=this.getPathPoints(this.getPath$java_awt_geom_Area(d),false);if(c.length>1){return new Room(c).getArea()}else{return 0}};b.prototype.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float=function(f,e,d,c){var h=new java.awt.geom.Area(this.getRotatedRectangle(f.getX()-f.getWidthInPlan()/2+d,f.getY()-f.getDepthInPlan()/2+c,f.getWidthInPlan(),f.getDepth(),f.getAngle()));var g=0.01;h.intersect(new java.awt.geom.Area(this.getRotatedRectangle(e.getX()-e.getWidthInPlan()/2-g,e.getY()-e.getDepthInPlan()/2-g,e.getWidthInPlan()+2*g,e.getDepthInPlan()+2*g,e.getAngle())));return h.isEmpty()};b.prototype.isIntersectionEmpty=function(f,e,d,c){if(((f!=null&&f instanceof HomePieceOfFurniture)||f===null)&&((e!=null&&e instanceof HomePieceOfFurniture)||e===null)&&((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)){return this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float(f,e,d,c)}else{if(((f!=null&&f instanceof HomePieceOfFurniture)||f===null)&&((e!=null&&e instanceof Wall)||e===null)&&((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)){return this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float(f,e,d,c)}else{throw new Error("invalid overload")}}};b.prototype.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float=function(f,d,e,c){if(d!=null){var g=new java.awt.geom.Area(this.getPath$float_A_A(d.getPoints$()));g.intersect(new java.awt.geom.Area(this.getRotatedRectangle(f.getX()-f.getWidthInPlan()/2+e,f.getY()-f.getDepthInPlan()/2+c,f.getWidthInPlan(),f.getDepthInPlan(),f.getAngle())));return this.getArea(g)<0.0001}return true};b.prototype.getRotatedRectangle=function(d,k,h,c,j){var g=new java.awt.geom.Rectangle2D.Float(d,k,h,c);var f=java.awt.geom.AffineTransform.getRotateInstance(j,d+h/2,k+c/2);var e=new java.awt.geom.GeneralPath();e.append(g.getPathIterator(f),false);return e};b.prototype.getMeasuringDimensionLineAt=function(k,j,e){var d=this.getSelectionMargin();var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();for(var g=0;g<h.length;g++){var m=h[g];if(this.isPieceOfFurnitureVisibleAtSelectedLevel(m)){var l=this.getDimensionLineBetweenPointsAt(m.getPoints(),k,j,d,e);if(l!=null){return l}}}var h=this.getRoomPathsFromWalls();for(var g=0;g<h.length;g++){var f=h[g];if(f.intersects(k-d,j-d,2*d,2*d)){var l=this.getDimensionLineBetweenPointsAt(this.getPathPoints(f,true),k,j,d,e);if(l!=null){return l}}}var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();for(var g=0;g<h.length;g++){var c=h[g];if(this.isLevelNullOrViewable(c.getLevel())&&c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())){var l=this.getDimensionLineBetweenPointsAt(c.getPoints(),k,j,d,e);if(l!=null){return l}}}return null};b.prototype.getDimensionLineBetweenPointsAt=function(g,c,k,h,e){for(var f=0;f<g.length;f++){var d=(f+1)%g.length;var j=java.awt.geom.Point2D.distanceSq(g[f][0],g[f][1],g[d][0],g[d][1]);if(j>0.01&&java.awt.geom.Line2D.ptSegDistSq(g[f][0],g[f][1],g[d][0],g[d][1],c,k)<=h*h){return this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(g[f],g[d],0,j,e)}}return null};b.prototype.getDimensionLineBetweenPoints$float_A$float_A$float$boolean=function(e,d,f,c){return this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(e,d,f,java.awt.geom.Point2D.distanceSq(e[0],e[1],d[0],d[1]),c)};b.prototype.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean=function(l,k,f,o,g){var d=Math.atan2(l[1]-k[1],k[0]-l[0]);var h=d<=-Math.PI/2||d>Math.PI/2;var j;var n;var c;var m;if(h){j=k[0];n=k[1];c=l[0];m=l[1];f=-f}else{j=l[0];n=l[1];c=k[0];m=k[1]}if(g){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(Math.sqrt(o),this.getView().getPixelLength());if(h){c=k[0]-(e*Math.cos(d));m=k[1]+(e*Math.sin(d))}else{c=l[0]+(e*Math.cos(d));m=l[1]-(e*Math.sin(d))}}return new DimensionLine(j,n,c,m,f)};b.prototype.getDimensionLineBetweenPoints=function(e,d,g,f,c){if(((e!=null&&e instanceof Array&&(e.length==0||e[0]==null||(typeof e[0]==="number")))||e===null)&&((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||(typeof d[0]==="number")))||d===null)&&((typeof g==="number")||g===null)&&((typeof f==="number")||f===null)&&((typeof c==="boolean")||c===null)){return this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(e,d,g,f,c)}else{if(((e!=null&&e instanceof Array&&(e.length==0||e[0]==null||(typeof e[0]==="number")))||e===null)&&((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||(typeof d[0]==="number")))||d===null)&&((typeof g==="number")||g===null)&&((typeof f==="boolean")||f===null)&&c===undefined){return this.getDimensionLineBetweenPoints$float_A$float_A$float$boolean(e,d,g,f)}else{throw new Error("invalid overload")}}};b.prototype.addLevel$=function(){this.addLevel$boolean(false)};b.prototype.addLevelAtSameElevation=function(){this.addLevel$boolean(true)};b.prototype.addLevel$boolean=function(o){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var c=f.slice(0);var n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getBackgroundImage();var p=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();var r=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallHeight();var q=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewFloorThickness();var m;if((p.length==0)){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(b,"levelName",0);m=this.createLevel(d,0,q,r);this.moveHomeItemsToLevel(m);m.setBackgroundImage(g);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBackgroundImage(null);p=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels()}else{m=null}var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(b,"levelName",p.length);var e;if(o){var l=m!=null?m:this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();e=this.createLevel(h,l.getElevation(),l.getFloorThickness(),l.getHeight())}else{var k=p[p.length-1].getElevation()+r+q;e=this.createLevel(h,k,q,r)}this.setSelectedLevel(e);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LevelAdditionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,j,n,m,g,e))};b.prototype.addLevel=function(c){if(((typeof c==="boolean")||c===null)){return this.addLevel$boolean(c)}else{if(c===undefined){return this.addLevel$()}else{throw new Error("invalid overload")}}};b.prototype.createLevel=function(e,f,g,d){var c=new Level(e,f,g,d);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLevel(c);return c};b.prototype.moveHomeItemsToLevel=function(d){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();for(var e=0;e<f.length;e++){var l=f[e];l.setLevel(d)}var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var e=0;e<f.length;e++){var j=f[e];j.setLevel(d)}var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();for(var e=0;e<f.length;e++){var c=f[e];c.setLevel(d)}var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines();for(var e=0;e<f.length;e++){var h=f[e];h.setLevel(d)}var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getDimensionLines();for(var e=0;e<f.length;e++){var k=f[e];k.setLevel(d)}var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLabels();for(var e=0;e<f.length;e++){var g=f[e];g.setLevel(d)}};b.prototype.toggleSelectedLevelViewability=function(){var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();c.setViewable(!c.isViewable());this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LevelViewabilityModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c))};b.prototype.setSelectedLevelOnlyViewable=function(){var e=this.getLevels(true);var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var c=d.isViewable();if(e.length!==1||!c){b.setLevelsViewability(e,false);d.setViewable(true);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LevelsViewabilityModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,c,e))}};b.prototype.setAllLevelsViewable=function(){var c=this.getLevels(false);if(c.length>0){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();b.setLevelsViewability(c,true);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.AllLevelsViewabilityModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,c))}};b.prototype.getLevels=function(c){var e=([]);var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();for(var d=0;d<g.length;d++){var f=g[d];if(f.isViewable()===c){(e.push(f)>0)}}return e.slice(0)};b.setLevelsViewability=function(e,c){for(var d=0;d<e.length;d++){var f=e[d];f.setViewable(c)}};b.prototype.modifySelectedLevel=function(){if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel()!=null){new LevelController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())}};b.prototype.deleteSelectedLevel=function(){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate();var g=([]);var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();for(var c=0;c<d.length;c++){var m=d[c];if(m.getLevel()===f){(g.push(m)>0)}}this.deleteFurniture(g);var h=([]);this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),h);this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms(),h);this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getDimensionLines(),h);this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLabels(),h);this.postDeleteItems(h,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection());this.doDeleteItems(h);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteLevel(f);var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();var l;var k;var e;if(j.length===1){l=j[0];k=l.getElevation();e=l.isViewable();l.setElevation(0);l.setViewable(true)}else{l=null;k=null;e=false}this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LevelDeletionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,f,l,k,e));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate()};b.prototype.addLevelItemsAtSelectedLevel=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();for(var d=0;d<c.length;d++){var e=c[d];if((e!=null&&(e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))&&e.getLevel()===f){(g.push(e)>0)}}};b.prototype.createWall=function(g,e,d,f,j,c){var h=new Wall(g,e,d,f,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallThickness(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallHeight(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallPattern());this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(h);if(j!=null){h.setWallAtStart(j);j.setWallAtStart(h)}else{if(c!=null){h.setWallAtStart(c);c.setWallAtEnd(h)}}return h};b.prototype.joinNewWallEndToWall=function(c,d,e){if(d!=null){c.setWallAtEnd(d);d.setWallAtStart(c);c.setXEnd(d.getXStart());c.setYEnd(d.getYStart())}else{if(e!=null){c.setWallAtEnd(e);e.setWallAtEnd(c);c.setXEnd(e.getXEnd());c.setYEnd(e.getYEnd())}}};b.prototype.getWallStartAt=function(d,j,f){var g=b.WALL_ENDS_PIXEL_MARGIN/this.getScale();var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var e=0;e<h.length;e++){var c=h[e];if(c!==f&&this.isLevelNullOrViewable(c.getLevel())&&c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.getWallAtStart()==null&&c.containsWallStartAt(d,j,g)){return c}}return null};b.prototype.getWallEndAt=function(d,j,f){var g=b.WALL_ENDS_PIXEL_MARGIN/this.getScale();var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var e=0;e<h.length;e++){var c=h[e];if(c!==f&&this.isLevelNullOrViewable(c.getLevel())&&c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.getWallAtEnd()==null&&c.containsWallEndAt(d,j,g)){return c}}return null};b.prototype.getIndicatorMargin=function(){var c=b.INDICATOR_PIXEL_MARGIN;if(this.getPointerTypeLastMousePress()===View.PointerType.TOUCH){c*=3}return c/this.getScale()};b.prototype.getResizedWallStartAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Wall)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.containsWallStartAt(d,g,e)){return c}}return null};b.prototype.getResizedWallEndAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Wall)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.containsWallEndAt(d,g,e)){return c}}return null};b.prototype.getArcExtentWallAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Wall)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.isMiddlePointAt(d,g,e)){return c}}return null};b.prototype.createRoom=function(c){var d=new Room(c);d.setFloorColor(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewRoomFloorColor());this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room(d);return d};b.prototype.getResizedRoomAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Room)&&this.isItemResizable(f[0])){var e=f[0];var d=this.getIndicatorMargin();if(e.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&e.getPointIndexAt(c,g,d)!==-1){return e}}return null};b.prototype.getRoomNameAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Room)&&this.isItemMovable(f[0])){var e=f[0];var d=this.getIndicatorMargin();if(e.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&e.getName()!=null&&e.getName().trim().length>0&&e.isNameCenterPointAt(c,g,d)){return e}}return null};b.prototype.getRoomRotatedNameAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Room)&&this.isItemMovable(f[0])){var e=f[0];var d=this.getIndicatorMargin();if(e.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&e.getName()!=null&&e.getName().trim().length>0&&this.isTextAnglePointAt(e,e.getName(),e.getNameStyle(),e.getXCenter()+e.getNameXOffset(),e.getYCenter()+e.getNameYOffset(),e.getNameAngle(),c,g,d)){return e}}return null};b.prototype.getRoomAreaAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Room)&&this.isItemMovable(f[0])){var e=f[0];var d=this.getIndicatorMargin();if(e.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&e.isAreaVisible()&&e.isAreaCenterPointAt(c,g,d)){return e}}return null};b.prototype.getRoomRotatedAreaAt=function(c,j){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(h.length===1&&(h[0]!=null&&h[0] instanceof Room)&&this.isItemMovable(h[0])){var g=h[0];var f=this.getIndicatorMargin();if(g.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&g.isAreaVisible()){var e=g.getArea();if(e>0.01){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getAreaFormatWithUnit().format(e);if(this.isTextAnglePointAt(g,d,g.getAreaStyle(),g.getXCenter()+g.getAreaXOffset(),g.getYCenter()+g.getAreaYOffset(),g.getAreaAngle(),c,j,f)){return g}}}}return null};b.prototype.addPointToSelectedRoom=function(l,k){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(e.length===1&&(e[0]!=null&&e[0] instanceof Room)&&this.isItemResizable(e[0])){var c=e[0];var n=c.getPoints();var d=-1;var o=1.7976931348623157e+308;for(var f=0;f<n.length;f++){var m=n[f];var j=n[(f+1)%n.length];var g=java.awt.geom.Line2D.ptSegDistSq(m[0],m[1],j[0],j[1],l,k);if(o>g){o=g;d=f}}var h=d+1;c.addPoint$float$float$int(l,k,h);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([c].slice(0));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomPointAdditionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e.slice(0),c,h,l,k))}};b.prototype.isRoomPointDeletableAt=function(d,c,e){return this.isItemResizable(d)&&d.getPointIndexAt(c,e,this.getIndicatorMargin())>=0};b.prototype.deletePointFromSelectedRoom=function(j,h){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(d.length===1&&(d[0]!=null&&d[0] instanceof Room)&&this.isItemResizable(d[0])){var c=d[0];var f=c.getPointIndexAt(j,h,this.getIndicatorMargin());if(f>=0){var l=c.getPoints();var k=l[f];var e=k[0];var g=k[1];c.removePoint(f);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([c].slice(0));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomPointDeletionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d.slice(0),c,f,e,g))}}};b.prototype.createDimensionLine=function(g,e,c,f,h){var d=new DimensionLine(g,e,c,f,h);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(d);return d};b.prototype.getResizedDimensionLineStartAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof DimensionLine)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.containsStartExtensionLinetAt(d,g,e)){return c}}return null};b.prototype.getResizedDimensionLineEndAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof DimensionLine)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.containsEndExtensionLineAt(d,g,e)){return c}}return null};b.prototype.getOffsetDimensionLineAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof DimensionLine)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.isMiddlePointAt(d,g,e)){return c}}return null};b.prototype.createPolyline=function(d){var e=new Polyline(d);var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit();e.setThickness(c===LengthUnit.INCH||c===LengthUnit.INCH_DECIMALS?LengthUnit.inchToCentimeter(1):2);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline(e);return e};b.prototype.getResizedPolylineAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Polyline)&&this.isItemResizable(f[0])){var d=f[0];var e=this.getIndicatorMargin();if(d.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&d.getPointIndexAt(c,g,e)!==-1){return d}}return null};b.prototype.getSelectionMargin=function(){var c=b.PIXEL_MARGIN;if(this.getPointerTypeLastMousePress()===View.PointerType.TOUCH){c*=2}return c/this.getScale()};b.prototype.isItemSelectedAt=function(c,h){var f=this.getSelectionMargin();var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var d=0;d<g.length;d++){var e=g[d];if(e.containsPoint(c,h,f)){return true}}return false};b.prototype.getSelectableItemAt$float$float=function(c,d){return this.getSelectableItemAt$float$float$boolean(c,d,true)};b.prototype.getSelectableItemAt$float$float$boolean=function(c,f,e){var d=this.getSelectableItemsAt$float$float$boolean$boolean(c,f,true,e);if(d.length!==0){return d[0]}else{return null}};b.prototype.getSelectableItemAt=function(c,e,d){if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&((typeof d==="boolean")||d===null)){return this.getSelectableItemAt$float$float$boolean(c,e,d)}else{if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&d===undefined){return this.getSelectableItemAt$float$float(c,e)}else{throw new Error("invalid overload")}}};b.prototype.getSelectableItemsAt$float$float=function(c,d){return this.getSelectableItemsAt$float$float$boolean$boolean(c,d,false,true)};b.prototype.getSelectableItemsAt$float$float$boolean$boolean=function(t,r,k,e){var z=([]);var w=this.getSelectionMargin();var L=w/2;var D=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera();if(D!=null&&D===this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getCamera()&&D.containsPoint(t,r,w)){(z.push(D)>0);if(k){return z}}var J=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();var I=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLabels();for(var m=0;m<o.length;m++){var p=o[m];if((!J||!this.isItemPartOfBasePlan(p))&&this.isLevelNullOrViewable(p.getLevel())&&p.isAtLevel(I)&&(p.containsPoint(t,r,w)||this.isItemTextAt(p,p.getText(),p.getStyle(),p.getX(),p.getY(),p.getAngle(),t,r,L))){(z.push(p)>0);if(k){return z}}}var o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getDimensionLines();for(var m=0;m<o.length;m++){var l=o[m];if((!J||!this.isItemPartOfBasePlan(l))&&this.isLevelNullOrViewable(l.getLevel())&&l.isAtLevel(I)&&l.containsPoint(t,r,w)){(z.push(l)>0);if(k){return z}}}var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines();for(var C=j.length-1;C>=0;C--){var B=j[C];if((!J||!this.isItemPartOfBasePlan(B))&&this.isLevelNullOrViewable(B.getLevel())&&B.isAtLevel(I)&&B.containsPoint(t,r,w)){(z.push(B)>0);if(k){return z}}}var v=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();var A=([]);var f=null;for(var C=v.length-1;C>=0;C--){var g=v[C];if((!J||!this.isItemPartOfBasePlan(g))&&this.isPieceOfFurnitureVisibleAtSelectedLevel(g)){if(g.containsPoint(t,r,w)){(A.push(g)>0);if(f==null||g.getGroundElevation()>f.getGroundElevation()){f=g}}else{if(f==null){var q=g.getName();if(q!=null&&g.isNameVisible()&&this.isItemTextAt(g,q,g.getNameStyle(),g.getX()+g.getNameXOffset(),g.getY()+g.getNameYOffset(),g.getNameAngle(),t,r,L)){(A.push(g)>0);f=g}}}}}if(f==null&&J){var o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var m=0;m<o.length;m++){var G=o[m];if(G!=null&&G instanceof HomePieceOfFurniture){var g=G;if(!this.isItemPartOfBasePlan(g)&&this.isPieceOfFurnitureVisibleAtSelectedLevel(g)&&(g.containsPoint(t,r,w)||g.getName()!=null&&g.isNameVisible()&&this.isItemTextAt(g,g.getName(),g.getNameStyle(),g.getX()+g.getNameXOffset(),g.getY()+g.getNameYOffset(),g.getNameAngle(),t,r,L))){(A.push(g)>0);f=g;if(k){break}}}}}if(f!=null&&k){if(!e&&(f!=null&&f instanceof HomeFurnitureGroup)){var s=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(s.length>=1){if((s.length===1&&s[0]===f)||(function(x,M){for(var y=0;y<M.length;y++){if(x.indexOf(M[y])<0){return false}}return true})(f.getAllFurniture(),s)){for(var m=0;m<s.length;m++){var d=s[m];if(d!=null&&d instanceof HomeFurnitureGroup){var n=d.getFurniture();for(var C=n.length-1;C>=0;C--){var g=n[C];if((!J||!this.isItemPartOfBasePlan(g))&&!(s.indexOf((g))>=0)&&g.containsPoint(t,r,w)){return[g].slice(0)}}}}for(var m=0;m<s.length;m++){var d=s[m];if(d!=null&&d instanceof HomePieceOfFurniture){var n=this.getFurnitureInSameGroup(d);for(var C=n.length-1;C>=0;C--){var g=n[C];if((!J||!this.isItemPartOfBasePlan(g))&&g.containsPoint(t,r,w)){return[g].slice(0)}}}}}}}return[f].slice(0)}else{(function(x,y){if(y.compare){x.sort(function(N,M){return y.compare(N,M)})}else{x.sort(y)}})(A,new b.PlanController$7(this));(function(y,x){return y.push.apply(y,x)})(z,A);var o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var m=0;m<o.length;m++){var F=o[m];if((!J||!this.isItemPartOfBasePlan(F))&&this.isLevelNullOrViewable(F.getLevel())&&F.isAtLevel(I)&&F.containsPoint$float$float$float(t,r,w)){(z.push(F)>0);if(k){return z}}}var K=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();var h=null;for(var C=K.length-1;C>=0;C--){var E=K[C];if((!J||!this.isItemPartOfBasePlan(E))&&this.isLevelNullOrViewable(E.getLevel())&&E.isAtLevel(I)){if(E.containsPoint(t,r,w)){(z.push(E)>0);if(h==null||E.isCeilingVisible()&&!h.isCeilingVisible()){h=E}}else{var H=E.getName();if(H!=null&&this.isItemTextAt(E,H,E.getNameStyle(),E.getXCenter()+E.getNameXOffset(),E.getYCenter()+E.getNameYOffset(),E.getNameAngle(),t,r,L)){(z.push(E)>0);h=E}if(E.isAreaVisible()){var u=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getAreaFormatWithUnit().format(E.getArea());if(this.isItemTextAt(E,u,E.getAreaStyle(),E.getXCenter()+E.getAreaXOffset(),E.getYCenter()+E.getAreaYOffset(),E.getAreaAngle(),t,r,L)){(z.push(E)>0);h=E}}}}}if(h!=null&&k){return[h].slice(0)}else{var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getCompass();if((!J||!this.isItemPartOfBasePlan(c))&&c.containsPoint(t,r,L)){(z.push(c)>0)}return z}}};b.prototype.getSelectableItemsAt=function(c,f,d,e){if(((typeof c==="number")||c===null)&&((typeof f==="number")||f===null)&&((typeof d==="boolean")||d===null)&&((typeof e==="boolean")||e===null)){return this.getSelectableItemsAt$float$float$boolean$boolean(c,f,d,e)}else{if(((typeof c==="number")||c===null)&&((typeof f==="number")||f===null)&&d===undefined&&e===undefined){return this.getSelectableItemsAt$float$float(c,f)}else{throw new Error("invalid overload")}}};b.prototype.isItemTextAt=function(m,l,d,j,f,h,g,e,c){if(d==null){d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(m.constructor)}var k=this.getView().getTextBounds(l,d,j,f,h);return this.getPath$float_A_A(k).intersects(g-c,e-c,2*c,2*c)};b.prototype.getSelectableItemsIntersectingRectangle=function(d,l,c,k){var j=([]);var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();var h=this.getVisibleItemsAtSelectedLevel();for(var f=0;f<h.length;f++){var m=h[f];if((!e||!this.isItemPartOfBasePlan(m))&&m.intersectsRectangle(d,l,c,k)){(j.push(m)>0)}}var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera();if(g!=null&&g.intersectsRectangle(d,l,c,k)){(j.push(g)>0)}return j};b.prototype.getRotatedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(d.isTopLeftPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getElevatedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(d.isTopRightPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getHeightResizedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedResizablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(!d.isHorizontallyRotated()&&d.isBottomLeftPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getPitchRotatedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null&&this.getView().isFurnitureSizeInPlanSupported()){var e=this.getIndicatorMargin();if(d.getPitch()!==0&&d.isBottomLeftPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getRollRotatedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null&&this.getView().isFurnitureSizeInPlanSupported()){var e=this.getIndicatorMargin();if(d.getRoll()!==0&&d.isBottomLeftPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getWidthAndDepthResizedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedResizablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(d.isBottomRightPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getSelectedMovablePieceOfFurniture=function(){var c=this.getSelectedPieceOfFurniture();if(c!=null&&this.isItemMovable(c)){return c}return null};b.prototype.getSelectedResizablePieceOfFurniture=function(){var c=this.getSelectedPieceOfFurniture();if(c!=null&&c.isResizable()&&this.isItemResizable(c)){return c}return null};b.prototype.getSelectedPieceOfFurniture=function(){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(d.length===1&&(d[0]!=null&&d[0] instanceof HomePieceOfFurniture)){var c=d[0];if(this.isPieceOfFurnitureVisibleAtSelectedLevel(c)){return c}}return null};b.prototype.getModifiedLightPowerAt=function(c,f){var d=this.getSelectedPieceOfFurniture();if(d!=null&&d instanceof HomeLight){var e=this.getIndicatorMargin();if(d.isBottomLeftPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getPieceOfFurnitureNameAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(d.isNameVisible()&&d.getName().trim().length>0&&d.isNameCenterPointAt(c,f,e)){return d}}return null};b.prototype.getPieceOfFurnitureRotatedNameAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(d.isNameVisible()&&d.getName().trim().length>0&&this.isTextAnglePointAt(d,d.getName(),d.getNameStyle(),d.getX()+d.getNameXOffset(),d.getY()+d.getNameYOffset(),d.getNameAngle(),c,f,e)){return d}}return null};b.prototype.isTextAnglePointAt=function(o,m,d,j,f,h,g,e,c){if(d==null){d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(o.constructor)}var k=this.getView().getTextBounds(m,d,j,f,h);var n;var l;if(d.getAlignment()===TextStyle.Alignment.LEFT){n=k[0][0];l=k[0][1]}else{if(d.getAlignment()===TextStyle.Alignment.RIGHT){n=k[1][0];l=k[1][1]}else{n=(k[0][0]+k[1][0])/2;l=(k[0][1]+k[1][1])/2}}return Math.abs(g-n)<=c&&Math.abs(e-l)<=c};b.prototype.getRotatedLabelAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Label)&&this.isItemMovable(f[0])){var d=f[0];var e=this.getIndicatorMargin();if(d.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&this.isTextAnglePointAt(d,d.getText(),d.getStyle(),d.getX(),d.getY(),d.getAngle(),c,g,e)){return d}}return null};b.prototype.getElevatedLabelAt=function(j,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Label)){var h=f[0];if(h.getPitch()!=null&&this.isItemMovable(h)){var e=this.getIndicatorMargin();if(h.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())){var d=h.getStyle();if(d==null){d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(h.constructor)}var k=this.getView().getTextBounds(h.getText(),this.getItemTextStyle(h,h.getStyle()),h.getX(),h.getY(),h.getAngle());var c=void 0;var l=void 0;if(d.getAlignment()===TextStyle.Alignment.LEFT){c=k[3][0];l=k[3][1]}else{if(d.getAlignment()===TextStyle.Alignment.RIGHT){c=k[2][0];l=k[2][1]}else{c=(k[2][0]+k[3][0])/2;l=(k[2][1]+k[3][1])/2}}if(Math.abs(j-c)<=e&&Math.abs(g-l)<=e){return h}}}}return null};b.prototype.getYawRotatedCameraAt=function(c,k){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(j.length===1&&(j[0]!=null&&j[0] instanceof Camera)&&this.isItemResizable(j[0])){var d=j[0];var f=this.getIndicatorMargin();var e=d.getPoints();var h=(e[0][0]+e[3][0])/2;var g=(e[0][1]+e[3][1])/2;if(Math.abs(c-h)<=f&&Math.abs(k-g)<=f&&!d.containsPoint(c,k,0)){return d}}return null};b.prototype.getPitchRotatedCameraAt=function(c,k){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(j.length===1&&(j[0]!=null&&j[0] instanceof Camera)&&this.isItemResizable(j[0])){var d=j[0];var f=this.getIndicatorMargin();var e=d.getPoints();var h=(e[1][0]+e[2][0])/2;var g=(e[1][1]+e[2][1])/2;if(Math.abs(c-h)<=f&&Math.abs(k-g)<=f&&!d.containsPoint(c,k,0)){return d}}return null};b.prototype.getElevatedCameraAt=function(c,k){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(j.length===1&&(j[0]!=null&&j[0] instanceof Camera)&&this.isItemResizable(j[0])){var e=j[0];var h=this.getIndicatorMargin();var f=e.getPoints();var d=(f[0][0]+f[1][0])/2;var g=(f[0][1]+f[1][1])/2;if(Math.abs(c-d)<=h&&Math.abs(k-g)<=h&&!e.containsPoint(c,k,0)){return e}}return null};b.prototype.getRotatedCompassAt=function(c,k){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(j.length===1&&(j[0]!=null&&j[0] instanceof Compass)&&this.isItemMovable(j[0])){var f=j[0];var g=this.getIndicatorMargin();var e=f.getPoints();var h=(e[2][0]+e[3][0])/2;var d=(e[2][1]+e[3][1])/2;if(Math.abs(c-h)<=g&&Math.abs(k-d)<=g&&!f.containsPoint(c,k,0)){return f}}return null};b.prototype.getResizedCompassAt=function(d,k){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(j.length===1&&(j[0]!=null&&j[0] instanceof Compass)&&this.isItemMovable(j[0])){var g=j[0];var h=this.getIndicatorMargin();var e=g.getPoints();var f=(e[1][0]+e[2][0])/2;var c=(e[1][1]+e[2][1])/2;if(Math.abs(d-f)<=h&&Math.abs(k-c)<=h&&!g.containsPoint(d,k,0)){return g}}return null};b.prototype.deleteItems=function(c){var f=([]);for(var d=0;d<c.length;d++){var g=c[d];if(this.isItemDeletable(g)){(f.push(g)>0)}}if(!(f.length==0)){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate();this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.removeSelectionListener(this.selectionListener);var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var j=(c.slice(0));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.ItemsDeletionStartUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,e,j.slice(0)));this.deleteFurniture(Home.getFurnitureSubList(f));var h=(Home.getWallsSubList(f).slice(0));(function(l,k){return l.push.apply(l,k)})(h,Home.getRoomsSubList(f));(function(l,k){return l.push.apply(l,k)})(h,Home.getDimensionLinesSubList(f));(function(l,k){return l.push.apply(l,k)})(h,Home.getPolylinesSubList(f));(function(l,k){return l.push.apply(l,k)})(h,Home.getLabelsSubList(f));this.postDeleteItems(h,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection());this.doDeleteItems(h);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.ItemsDeletionEndUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate()}};b.prototype.postDeleteItems=function(m,C,q){var w=Home.getWallsSubList(m);var r=b.JoinedWall.getJoinedWalls(w);var v=Home.getRoomsSubList(m);var F=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();var e=({});for(var h=0;h<v.length;h++){var z=v[h];(function(G,I,H){if(G.entries==null){G.entries=[]}for(var J=0;J<G.entries.length;J++){if(G.entries[J].key.equals!=null&&G.entries[J].key.equals(I)||G.entries[J].key===I){var K=G.entries[J].value;G.entries[J].value=H;return K}}G.entries.push({key:I,value:H,getKey:function(){return this.key},getValue:function(){return this.value}});G.entries.sort(function(M,L){return(M.key.compareTo!=null)?M.key.compareTo(L):(M.key-L.key)});return null})(e,F.indexOf(z),z)}var D=(function(H,G){if(H.length>=G.length){H.length=0;H.push.apply(H,G);return H}else{return G.slice(0)}})((function(H){var G=[];while(H-->0){G.push(null)}return G})((function(G){if(G.entries==null){G.entries=[]}return G.entries.length})(e)),(function(G){var H=[];if(G.entries==null){G.entries=[]}for(var I=0;I<G.entries.length;I++){H.push(G.entries[I].value)}return H})(e));var B=(function(H){var G=[];while(H-->0){G.push(0)}return G})(D.length);var k=(function(H){var G=[];while(H-->0){G.push(null)}return G})(D.length);var x=0;var j=(function(G){var H=[];if(G.entries==null){G.entries=[]}for(var I=0;I<G.entries.length;I++){H.push(G.entries[I].key)}return H})(e);for(var p=0;p<j.length;p++){var h=j[p];B[x]=h;k[x]=D[x].getLevel();x++}var o=Home.getDimensionLinesSubList(m);var l=o.slice(0);var n=(function(H){var G=[];while(H-->0){G.push(null)}return G})(l.length);for(x=0;x<l.length;x++){n[x]=l[x].getLevel()}var t=Home.getPolylinesSubList(m);var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines();var y=({});for(var h=0;h<t.length;h++){var s=t[h];(function(G,I,H){if(G.entries==null){G.entries=[]}for(var J=0;J<G.entries.length;J++){if(G.entries[J].key.equals!=null&&G.entries[J].key.equals(I)||G.entries[J].key===I){var K=G.entries[J].value;G.entries[J].value=H;return K}}G.entries.push({key:I,value:H,getKey:function(){return this.key},getValue:function(){return this.value}});G.entries.sort(function(M,L){return(M.key.compareTo!=null)?M.key.compareTo(L):(M.key-L.key)});return null})(y,d.indexOf(s),s)}var g=(function(H,G){if(H.length>=G.length){H.length=0;H.push.apply(H,G);return H}else{return G.slice(0)}})((function(H){var G=[];while(H-->0){G.push(null)}return G})((function(G){if(G.entries==null){G.entries=[]}return G.entries.length})(y)),(function(G){var H=[];if(G.entries==null){G.entries=[]}for(var I=0;I<G.entries.length;I++){H.push(G.entries[I].value)}return H})(y));var c=(function(H){var G=[];while(H-->0){G.push(0)}return G})(g.length);var E=(function(H){var G=[];while(H-->0){G.push(null)}return G})(g.length);x=0;var j=(function(G){var I=[];if(G.entries==null){G.entries=[]}for(var H=0;H<G.entries.length;H++){I.push(G.entries[H].key)}return I})(y);for(var p=0;p<j.length;p++){var h=j[p];c[x]=h;E[x]=g[x].getLevel();x++}var u=Home.getLabelsSubList(m);var A=u.slice(0);var f=(function(H){var G=[];while(H-->0){G.push(null)}return G})(A.length);for(x=0;x<A.length;x++){f[x]=A[x].getLevel()}this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.ItemsDeletionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,C,q,m.slice(0),r,D,B,k,l,n,g,c,E,A,f))};b.prototype.doDeleteItems=function(d){var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();for(var e=0;e<d.length;e++){var f=d[e];if(f!=null&&f instanceof Wall){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(f)}else{if(f!=null&&f instanceof DimensionLine){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteDimensionLine(f)}else{if(f!=null&&f instanceof Room){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteRoom(f)}else{if(f!=null&&f instanceof Polyline){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePolyline(f)}else{if(f!=null&&f instanceof Label){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteLabel(f)}else{if(f!=null&&f instanceof HomePieceOfFurniture){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePieceOfFurniture(f)}}}}}}c=!this.isItemPartOfBasePlan(f)&&c}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(false)};b.prototype.moveAndShowSelectedItems=function(d,c){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var g=([]);for(var e=0;e<h.length;e++){var f=h[e];if(this.isItemMovable(f)){(g.push(f)>0)}}if(!(g.length==0)){this.moveItems(g,d,c);this.selectAndShowItems$java_util_List$boolean(g,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection());if(g.length!==1||!(g[0]!=null&&g[0] instanceof Camera)){this.postItemsMove(g,h,d,c)}}};b.prototype.moveItems=function(f,e,d){for(var g=0;g<f.length;g++){var j=f[g];if(j!=null&&j instanceof Wall){var c=j;c.removePropertyChangeListener(this.wallChangeListener);b.moveWallStartPoint(c,c.getXStart()+e,c.getYStart()+d,!(f.indexOf((c.getWallAtStart()))>=0));b.moveWallEndPoint(c,c.getXEnd()+e,c.getYEnd()+d,!(f.indexOf((c.getWallAtEnd()))>=0));this.resetAreaCache();c.addPropertyChangeListener(this.wallChangeListener)}else{var h=false;if(j!=null&&j instanceof HomeDoorOrWindow){h=j.isBoundToWall()}j.move(e,d);if(h){var k=new java.awt.geom.Area(this.getPath$float_A_A(j.getPoints()));k.intersect(this.getWallsArea(true));j.setBoundToWall(!k.isEmpty())}}}};b.moveWallStartPoint=function(c,j,h,d){var g=c.getXStart();var f=c.getYStart();c.setXStart(j);c.setYStart(h);var e=c.getWallAtStart();if(e!=null&&d){if(e.getWallAtStart()===c&&(e.getWallAtEnd()!==c||(e.getXStart()===g&&e.getYStart()===f))){e.setXStart(j);e.setYStart(h)}else{if(e.getWallAtEnd()===c&&(e.getWallAtStart()!==c||(e.getXEnd()===g&&e.getYEnd()===f))){e.setXEnd(j);e.setYEnd(h)}}}};b.moveWallEndPoint=function(d,c,g,f){var e=d.getXEnd();var j=d.getYEnd();d.setXEnd(c);d.setYEnd(g);var h=d.getWallAtEnd();if(h!=null&&f){if(h.getWallAtStart()===d&&(h.getWallAtEnd()!==d||(h.getXStart()===e&&h.getYStart()===j))){h.setXStart(c);h.setYStart(g)}else{if(h.getWallAtEnd()===d&&(h.getWallAtStart()!==d||(h.getXEnd()===e&&h.getYEnd()===j))){h.setXEnd(c);h.setYEnd(g)}}}};b.moveWallPoint=function(d,c,f,e){if(e){b.moveWallStartPoint(d,c,f,true)}else{b.moveWallEndPoint(d,c,f,true)}};b.moveRoomPoint=function(e,c,f,d){e.setPoint(c,f,d)};b.moveDimensionLinePoint=function(d,c,f,e){if(e){d.setXStart(c);d.setYStart(f)}else{d.setXEnd(c);d.setYEnd(f)}};b.reverseDimensionLine=function(c){var e=c.getXStart();var d=c.getYStart();c.setXStart(c.getXEnd());c.setYStart(c.getYEnd());c.setXEnd(e);c.setYEnd(d);c.setOffset(-c.getOffset())};b.prototype.selectAndShowItems$java_util_List=function(c){this.selectAndShowItems$java_util_List$boolean(c,false)};b.prototype.selectAndShowItems$java_util_List$boolean=function(c,d){this.selectItems$java_util_List$boolean(c,d);this.selectLevelFromSelectedItems();this.getView().makeSelectionVisible()};b.prototype.selectAndShowItems=function(c,d){if(((c!=null&&(c instanceof Array))||c===null)&&((typeof d==="boolean")||d===null)){return this.selectAndShowItems$java_util_List$boolean(c,d)}else{if(((c!=null&&(c instanceof Array))||c===null)&&d===undefined){return this.selectAndShowItems$java_util_List(c)}else{throw new Error("invalid overload")}}};b.prototype.selectItems$java_util_List=function(c){this.selectItems$java_util_List$boolean(c,false)};b.prototype.selectItems$java_util_List$boolean=function(c,d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.removeSelectionListener(this.selectionListener);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(c);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(d)};b.prototype.selectItems=function(c,d){if(((c!=null&&(c instanceof Array))||c===null)&&((typeof d==="boolean")||d===null)){return this.selectItems$java_util_List$boolean(c,d)}else{if(((c!=null&&(c instanceof Array))||c===null)&&d===undefined){return this.selectItems$java_util_List(c)}else{throw new Error("invalid overload")}}};b.prototype.selectItem=function(c){this.selectItems$java_util_List([c].slice(0))};b.prototype.toggleItemSelection=function(c){var d=(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0));if((d.indexOf((c))>=0)){(function(e){var f=e.indexOf(c);if(f>=0){e.splice(f,1);return true}else{return false}})(d)}else{(d.push(c)>0)}this.selectItems$java_util_List$boolean(d,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.deselectAll=function(){var c=[];this.selectItems$java_util_List(c)};b.prototype.addItems=function(c){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate();this.addFurniture$java_util_List(Home.getFurnitureSubList(c));this.addWalls(Home.getWallsSubList(c));this.addRooms(Home.getRoomsSubList(c));this.addPolylines(Home.getPolylinesSubList(c));this.addDimensionLines(Home.getDimensionLinesSubList(c));this.addLabels(Home.getLabelsSubList(c));this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(c);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.ItemsAdditionEndUndoableEdit(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c.slice(0)));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate()};b.prototype.addFurniture=function(e,c,f,d){if(((e!=null&&(e instanceof Array))||e===null)&&((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||(c[0]!=null&&c[0] instanceof Level)))||c===null)&&((f!=null&&f instanceof HomeFurnitureGroup)||f===null)&&((d!=null&&d instanceof HomePieceOfFurniture)||d===null)){a.prototype.addFurniture.call(this,e,c,f,d)}else{if(((e!=null&&(e instanceof Array))||e===null)&&((c!=null&&c instanceof HomePieceOfFurniture)||c===null)&&f===undefined&&d===undefined){return this.addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,c)}else{if(((e!=null&&(e instanceof Array))||e===null)&&c===undefined&&f===undefined&&d===undefined){return this.addFurniture$java_util_List(e)}else{throw new Error("invalid overload")}}}};b.prototype.addFurniture$java_util_List=function(g){a.prototype.addFurniture$java_util_List.call(this,g);if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()){var e=this.getWallsArea(false);for(var d=0;d<g.length;d++){var f=g[d];if(f!=null&&f instanceof HomeDoorOrWindow){var c=f.getPoints();var h=new java.awt.geom.Area(this.getPath$float_A_A(c));h.intersect(e);if(!h.isEmpty()&&new Room(c).getArea()/this.getArea(h)>0.999){f.setBoundToWall(true)}}}}};b.prototype.addWalls=function(e){for(var d=0;d<e.length;d++){var c=e[d];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(c)}this.postCreateWalls(e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.postCreateWalls=function(g,e,m,j){if(g.length>0){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(f){for(var h=0;h<g.length;h++){var k=g[h];f=!this.isItemPartOfBasePlan(k)&&f}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(f)}var d=f;var l=b.JoinedWall.getJoinedWalls(g);var c=e.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallsCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,m,j,l,d))}};b.prototype.doAddWalls=function(j,d){for(var e=0;e<j.length;e++){var f=j[e];var c=f.getWall();this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(c);c.setLevel(f.getLevel())}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(d);for(var e=0;e<j.length;e++){var f=j[e];var c=f.getWall();var g=f.getWallAtStart();if(g!=null){c.setWallAtStart(g);if(f.isJoinedAtEndOfWallAtStart()){g.setWallAtEnd(c)}else{g.setWallAtStart(c)}}var h=f.getWallAtEnd();if(h!=null){c.setWallAtEnd(h);if(f.isJoinedAtStartOfWallAtEnd()){h.setWallAtStart(c)}else{h.setWallAtEnd(c)}}}};b.prototype.doDeleteWalls=function(d,c){for(var e=0;e<d.length;e++){var f=d[e];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(f.getWall())}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.addRooms=function(f){var g=f.slice(0);var c=(function(j){var h=[];while(j-->0){h.push(0)}return h})(f.length);var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms().length;for(var d=0;d<c.length;d++){c[d]=e++;this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room$int(g[d],c[d])}this.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean(g,c,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean=function(l,k,g,n,m){if(l.length>0){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(h){for(var j=0;j<l.length;j++){var e=l[j];h=!this.isItemPartOfBasePlan(e)&&h}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(h)}var d=h;var c=g.slice(0);var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomsCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,n,m,l,k,f,d))}};b.prototype.postCreateRooms=function(g,c,f,d,e){if(((g!=null&&g instanceof Array&&(g.length==0||g[0]==null||(g[0]!=null&&g[0] instanceof Room)))||g===null)&&((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||(typeof c[0]==="number")))||c===null)&&((f!=null&&(f instanceof Array))||f===null)&&((typeof d==="boolean")||d===null)&&((typeof e==="boolean")||e===null)){return this.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean(g,c,f,d,e)}else{if(((g!=null&&(g instanceof Array))||g===null)&&((c!=null&&(c instanceof Array))||c===null)&&((typeof f==="boolean")||f===null)&&((typeof d==="boolean")||d===null)&&e===undefined){return this.postCreateRooms$java_util_List$java_util_List$boolean$boolean(g,c,f,d)}else{throw new Error("invalid overload")}}};b.prototype.postCreateRooms$java_util_List$java_util_List$boolean$boolean=function(j,e,d,h){var k=j.slice(0);var f=(function(m){var l=[];while(m-->0){l.push(0)}return l})(j.length);var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();for(var g=0;g<f.length;g++){f[g]=c.lastIndexOf(k[g])}this.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean(k,f,e,d,h)};b.prototype.doAddRooms=function(g,f,d,h,c){for(var e=0;e<f.length;e++){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room$int(g[e],f[e]);g[e].setLevel(d!=null?d[e]:h)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.doDeleteRooms=function(f,c){for(var d=0;d<f.length;d++){var e=f[d];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteRoom(e)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.addDimensionLines=function(d){for(var e=0;e<d.length;e++){var c=d[e];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(c)}this.postCreateDimensionLines(d,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.postCreateDimensionLines=function(e,g,n,k){if(e.length>0){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(h){for(var j=0;j<e.length;j++){var l=e[j];h=!this.isItemPartOfBasePlan(l)&&h}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(h)}var d=h;var f=e.slice(0);var c=g.slice(0);var m=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DimensionLinesCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,n,k,f,m,d))}};b.prototype.doAddDimensionLines=function(e,h,g,d){for(var f=0;f<e.length;f++){var c=e[f];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(c);c.setLevel(h!=null?h[f]:g)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(d)};b.prototype.doDeleteDimensionLines=function(e,d){for(var f=0;f<e.length;f++){var c=e[f];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteDimensionLine(c)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(d)};b.prototype.addPolylines=function(d){var g=d.slice(0);var e=(function(j){var h=[];while(j-->0){h.push(0)}return h})(d.length);var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines().length;for(var c=0;c<e.length;c++){e[c]=f++;this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline$int(g[c],e[c])}this.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean(g,e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean=function(e,g,f,n,k){if(e.length>0){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(h){for(var j=0;j<e.length;j++){var l=e[j];h=!this.isItemPartOfBasePlan(l)&&h}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(h)}var d=h;var c=f.slice(0);var m=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PolylinesCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,n,k,e,g,m,d))}};b.prototype.postCreatePolylines=function(g,c,f,d,e){if(((g!=null&&g instanceof Array&&(g.length==0||g[0]==null||(g[0]!=null&&g[0] instanceof Polyline)))||g===null)&&((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||(typeof c[0]==="number")))||c===null)&&((f!=null&&(f instanceof Array))||f===null)&&((typeof d==="boolean")||d===null)&&((typeof e==="boolean")||e===null)){return this.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean(g,c,f,d,e)}else{if(((g!=null&&(g instanceof Array))||g===null)&&((c!=null&&(c instanceof Array))||c===null)&&((typeof f==="boolean")||f===null)&&((typeof d==="boolean")||d===null)&&e===undefined){return this.postCreatePolylines$java_util_List$java_util_List$boolean$boolean(g,c,f,d)}else{throw new Error("invalid overload")}}};b.prototype.postCreatePolylines$java_util_List$java_util_List$boolean$boolean=function(h,e,d,g){var k=h.slice(0);var j=(function(m){var l=[];while(m-->0){l.push(0)}return l})(h.length);var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines();for(var f=0;f<j.length;f++){j[f]=c.lastIndexOf(k[f])}this.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean(k,j,e,d,g)};b.prototype.doAddPolylines=function(g,h,d,f,c){for(var e=0;e<h.length;e++){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline$int(g[e],h[e]);g[e].setLevel(d!=null?d[e]:f)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.doDeletePolylines=function(f,c){for(var e=0;e<f.length;e++){var d=f[e];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePolyline(d)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.addLabels=function(e){for(var d=0;d<e.length;d++){var c=e[d];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLabel(c)}this.postCreateLabels(e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.postCreateLabels=function(k,e,n,l){if(k.length>0){var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(g){for(var h=0;h<k.length;h++){var m=k[h];g=!this.isItemPartOfBasePlan(m)&&g}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(g)}var d=g;var f=k.slice(0);var c=e.slice(0);var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LabelsCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,n,l,f,j,d))}};b.prototype.doAddLabels=function(h,d,f,c){for(var g=0;g<h.length;g++){var e=h[g];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLabel(e);e.setLevel(d!=null?d[g]:f)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.doDeleteLabels=function(f,c){for(var e=0;e<f.length;e++){var d=f[e];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteLabel(d)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.postLabelRotation=function(c,d){var e=c.getAngle();if(e!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LabelRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,c,e))}};b.prototype.postLabelElevation=function(d,e){var c=d.getElevation();if(c!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LabelElevationModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,d,c))}};b.prototype.postItemsMove=function(j,h,e,d){if(e!==0||d!==0){var g=j.slice(0);var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var c=h.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.ItemsMovingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,f,g,e,d))}};b.prototype.doMoveAndShowItems=function(g,f,d,c,e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(e);this.moveItems(g.slice(0),d,c);this.selectAndShowItems$java_util_List$boolean(f.slice(0),e)};b.prototype.postPieceOfFurnitureMove=function(l,m,k,e,g,d,h){var f=l.getAngle();var j=l.getDepth();var c=l.getElevation();if(m!==0||k!==0||f!==e||j!==g||c!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureMovingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,g,d,h,l,m,k,f,j,c))}};b.prototype.postItemsDuplication=function(e,d){var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var j=Home.getFurnitureSubList(e);for(var f=0;f<j.length;f++){var h=j[f];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePieceOfFurniture(h)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DuplicationStartUndoableEdit(this,d.slice(0),g));this.addFurniture$java_util_List(j);var k=[];this.postCreateWalls(Home.getWallsSubList(e),k,c,g);this.postCreateRooms$java_util_List$java_util_List$boolean$boolean(Home.getRoomsSubList(e),k,c,g);this.postCreatePolylines$java_util_List$java_util_List$boolean$boolean(Home.getPolylinesSubList(e),k,c,g);this.postCreateDimensionLines(Home.getDimensionLinesSubList(e),k,c,g);this.postCreateLabels(Home.getLabelsSubList(e),k,c,g);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DuplicationEndUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e.slice(0)));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate();this.selectItems$java_util_List(e)};b.prototype.postWallResize=function(c,f,d,e){var h;var g;if(e){h=c.getXStart();g=c.getYStart()}else{h=c.getXEnd();g=c.getYEnd()}if(h!==f||g!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,f,d,c,e,h,g))}};b.prototype.postWallArcExtent=function(c,e){var d=c.getArcExtent();if(d!==e&&(d==null||!(d===e))){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallArcExtentModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,c,d))}};b.prototype.postRoomResize=function(j,g,e,f){var d=j.getPoints()[f];var k=d[0];var h=d[1];if(k!==g||h!==e){var c=new b.RoomResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,g,e,j,f,k,h);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(c)}};b.prototype.postRoomNameOffset=function(f,d,g){var c=f.getNameXOffset();var e=f.getNameYOffset();if(c!==d||e!==g){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomNameOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,g,f,c,e))}};b.prototype.postRoomNameRotation=function(d,e){var c=d.getNameAngle();if(c!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomNameRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,d,c))}};b.prototype.postRoomAreaOffset=function(g,d,f){var c=g.getAreaXOffset();var e=g.getAreaYOffset();if(c!==d||e!==f){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomAreaOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,f,g,c,e))}};b.prototype.postRoomAreaRotation=function(e,d){var c=e.getAreaAngle();if(c!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomAreaRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,e,c))}};b.prototype.postPieceOfFurnitureRotation=function(d,c,e){var f=d.getAngle();if(f!==c){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,e,d,f))}};b.prototype.postPieceOfFurniturePitchRotation=function(g,e,d,f,c){var h=g.getPitch();if(h!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurniturePitchRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,d,f,c,g,h,g.getWidthInPlan(),g.getDepthInPlan(),g.getHeightInPlan()))}};b.prototype.setPieceOfFurniturePitch=function(f,g,d,e,c){f.removePropertyChangeListener(this.furnitureSizeChangeListener);f.setPitch(g);f.setWidthInPlan(d);f.setDepthInPlan(e);f.setHeightInPlan(c);f.addPropertyChangeListener(this.furnitureSizeChangeListener)};b.prototype.postPieceOfFurnitureRollRotation=function(h,g,e,f,d){var c=h.getRoll();if(c!==g){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureRollRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,g,e,f,d,h,c,h.getWidthInPlan(),h.getDepthInPlan(),h.getHeightInPlan()))}};b.prototype.setPieceOfFurnitureRoll=function(g,e,d,f,c){g.removePropertyChangeListener(this.furnitureSizeChangeListener);g.setRoll(e);g.setWidthInPlan(d);g.setDepthInPlan(f);g.setHeightInPlan(c);g.addPropertyChangeListener(this.furnitureSizeChangeListener)};b.prototype.postPieceOfFurnitureElevation=function(e,d){var c=e.getElevation();if(c!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureElevationModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,e,c))}};b.prototype.postPieceOfFurnitureHeightResize=function(c){if(c.getPieceOfFurniture().getHeight()!==c.getHeight()){this.postPieceOfFurnitureResize(c,"undoPieceOfFurnitureHeightResizeName")}};b.prototype.postPieceOfFurnitureWidthAndDepthResize=function(c){var d=c.getPieceOfFurniture();if(d.getWidth()!==c.getWidth()||d.getDepth()!==c.getDepth()){this.postPieceOfFurnitureResize(c,"undoPieceOfFurnitureWidthAndDepthResizeName")}};b.prototype.postPieceOfFurnitureResize=function(d,c){var f=d.getPieceOfFurniture();var e=(f!=null&&f instanceof HomeDoorOrWindow)&&f.isBoundToWall();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,e,d,f.getX(),f.getY(),f.getWidth(),f.getDepth(),f.getHeight()))};b.prototype.setPieceOfFurnitureSize=function(e,h,j,c){var g=e.getPieceOfFurniture();g.removePropertyChangeListener(this.furnitureSizeChangeListener);if(g!=null&&g instanceof HomeFurnitureGroup){var k=g.getAllFurniture();for(var f=0;f<k.length;f++){var d=k[f];d.removePropertyChangeListener(this.furnitureSizeChangeListener)}}b.ResizedPieceOfFurniture.setPieceOfFurnitureSize(g,h,j,c);g.addPropertyChangeListener(this.furnitureSizeChangeListener);if(g!=null&&g instanceof HomeFurnitureGroup){var k=g.getAllFurniture();for(var f=0;f<k.length;f++){var d=k[f];d.addPropertyChangeListener(this.furnitureSizeChangeListener)}}};b.prototype.resetPieceOfFurnitureSize=function(d){var f=d.getPieceOfFurniture();f.removePropertyChangeListener(this.furnitureSizeChangeListener);if(f!=null&&f instanceof HomeFurnitureGroup){var g=f.getAllFurniture();for(var e=0;e<g.length;e++){var c=g[e];c.removePropertyChangeListener(this.furnitureSizeChangeListener)}}d.reset();f.addPropertyChangeListener(this.furnitureSizeChangeListener);if(f!=null&&f instanceof HomeFurnitureGroup){var g=f.getAllFurniture();for(var e=0;e<g.length;e++){var c=g[e];c.addPropertyChangeListener(this.furnitureSizeChangeListener)}}};b.prototype.postLightPowerModification=function(d,c){var e=d.getPower();if(e!==c){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LightPowerModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,d,e))}};b.prototype.postPieceOfFurnitureNameOffset=function(c,e,g){var d=c.getNameXOffset();var f=c.getNameYOffset();if(d!==e||f!==g){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureNameOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,g,c,d,f))}};b.prototype.postPieceOfFurnitureNameRotation=function(c,e){var d=c.getNameAngle();if(d!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureNameRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,c,d))}};b.prototype.postDimensionLineResize=function(c,f,d,e,j){var h;var g;if(e){h=c.getXStart();g=c.getYStart()}else{h=c.getXEnd();g=c.getYEnd()}if(h!==f||g!==d||j){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DimensionLineResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,f,d,c,h,g,e,j))}};b.prototype.postDimensionLineOffset=function(c,d){var e=c.getOffset();if(e!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DimensionLineOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,c,e))}};b.prototype.postPolylineResize=function(c,g,e,f){var d=c.getPoints()[f];var j=d[0];var h=d[1];if(j!==g||h!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PolylineResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,g,e,c,f,j,h))}};b.prototype.postCompassRotation=function(e,d){var c=e.getNorthDirection();if(c!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.CompassRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,e,c))}};b.prototype.postCompassResize=function(d,e){var c=d.getDiameter();if(c!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.CompassResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,d,c))}};b.prototype.getPathPoints=function(l,e){var k=([]);var j=null;for(var h=l.getPathIterator(null);!h.isDone();h.next()){var f=[0,0];if(h.currentSegment(f)!==java.awt.geom.PathIterator.SEG_CLOSE&&(j==null||!(function(n,m){if(n==null&&m==null){return true}if(n==null||m==null){return false}if(n.length!=m.length){return false}for(var o=0;o<n.length;o++){if(n[o]!=m[o]){return false}}return true})(f,j))){var d=false;if(e&&k.length>1){var c=k[k.length-2];var g=j;d=java.awt.geom.Line2D.ptLineDistSq(c[0],c[1],g[0],g[1],f[0],f[1])<0.0001}if(d){(k[k.length-1]=f)}else{(k.push(f)>0)}j=f}}if(k.length>1&&(function(n,m){if(n==null&&m==null){return true}if(n==null||m==null){return false}if(n.length!=m.length){return false}for(var o=0;o<n.length;o++){if(n[o]!=m[o]){return false}}return true})(k[0],k[k.length-1])){k.splice(k.length-1,1)[0]}return k.slice(0)};b.prototype.getRoomPathsFromWalls=function(){if(this.roomPathsCache==null){var e=this.getWallsArea(false);var d=this.getAreaPaths(e);var g=new java.awt.geom.Area(e);for(var c=0;c<d.length;c++){var f=d[c];g.add(new java.awt.geom.Area(f))}this.roomPathsCache=d;this.insideWallsAreaCache=g}return this.roomPathsCache};b.prototype.getAreaPaths=function(h){var d=([]);var g=null;var c=null;for(var f=h.getPathIterator(null,0.5);!f.isDone();f.next()){var e=[0,0];switch((f.currentSegment(e))){case java.awt.geom.PathIterator.SEG_MOVETO:g=new java.awt.geom.GeneralPath();g.moveTo(e[0],e[1]);c=e;break;case java.awt.geom.PathIterator.SEG_LINETO:if((e[0]!==c[0]||e[1]!==c[1])&&java.awt.geom.Point2D.distanceSq(e[0],e[1],c[0],c[1])>1e-10){g.lineTo(e[0],e[1]);c=e}break;case java.awt.geom.PathIterator.SEG_CLOSE:g.closePath();(d.push(g)>0);break}}return d};b.prototype.getInsideWallsArea=function(){if(this.insideWallsAreaCache==null){this.getRoomPathsFromWalls()}return this.insideWallsAreaCache};b.prototype.getWallsArea=function(g){if(!g&&this.wallsAreaCache==null||g&&this.wallsIncludingBaseboardsAreaCache==null){var e=new java.awt.geom.Area();var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var d=0;d<h.length;d++){var c=h[d];if(c.isAtLevel(f)){e.add(new java.awt.geom.Area(this.getPath$float_A_A(c.getPoints$boolean(g))))}}if(g){this.wallsIncludingBaseboardsAreaCache=e}else{this.wallsAreaCache=e}}return g?this.wallsIncludingBaseboardsAreaCache:this.wallsAreaCache};b.prototype.getPath$float_A_A=function(d){var e=new java.awt.geom.GeneralPath();e.moveTo(d[0][0],d[0][1]);for(var c=1;c<d.length;c++){e.lineTo(d[c][0],d[c][1])}e.closePath();return e};b.prototype.getPath=function(c){if(((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||c[0] instanceof Array))||c===null)){return this.getPath$float_A_A(c)}else{if(((c!=null&&c instanceof java.awt.geom.Area)||c===null)){return this.getPath$java_awt_geom_Area(c)}else{throw new Error("invalid overload")}}};b.prototype.getPath$java_awt_geom_Area=function(e){var f=new java.awt.geom.GeneralPath();var c=[0,0];for(var d=e.getPathIterator(null,0.5);!d.isDone();d.next()){switch((d.currentSegment(c))){case java.awt.geom.PathIterator.SEG_MOVETO:f.moveTo(c[0],c[1]);break;case java.awt.geom.PathIterator.SEG_LINETO:f.lineTo(c[0],c[1]);break}}return f};b.prototype.selectLevelFromSelectedItems=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var c=0;c<f.length;c++){var d=f[c];if((d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))&&d.isAtLevel(e)){return}}for(var c=0;c<f.length;c++){var d=f[c];if(d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0)){this.setSelectedLevel(d.getLevel());break}}};b.SCALE_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanScale";b.PIXEL_MARGIN=4;b.INDICATOR_PIXEL_MARGIN=5;b.WALL_ENDS_PIXEL_MARGIN=2;return b}(FurnitureController));PlanController.__class="com.eteks.sweethome3d.viewcontroller.PlanController";PlanController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(ai){var aI=(function(){function a9(ba){if(this.__name===undefined){this.__name=null}this.__name=ba}a9.SELECTION_$LI$=function(){if(a9.SELECTION==null){a9.SELECTION=new ai.Mode("SELECTION")}return a9.SELECTION};a9.PANNING_$LI$=function(){if(a9.PANNING==null){a9.PANNING=new ai.Mode("PANNING")}return a9.PANNING};a9.WALL_CREATION_$LI$=function(){if(a9.WALL_CREATION==null){a9.WALL_CREATION=new ai.Mode("WALL_CREATION")}return a9.WALL_CREATION};a9.ROOM_CREATION_$LI$=function(){if(a9.ROOM_CREATION==null){a9.ROOM_CREATION=new ai.Mode("ROOM_CREATION")}return a9.ROOM_CREATION};a9.POLYLINE_CREATION_$LI$=function(){if(a9.POLYLINE_CREATION==null){a9.POLYLINE_CREATION=new ai.Mode("POLYLINE_CREATION")}return a9.POLYLINE_CREATION};a9.DIMENSION_LINE_CREATION_$LI$=function(){if(a9.DIMENSION_LINE_CREATION==null){a9.DIMENSION_LINE_CREATION=new ai.Mode("DIMENSION_LINE_CREATION")}return a9.DIMENSION_LINE_CREATION};a9.LABEL_CREATION_$LI$=function(){if(a9.LABEL_CREATION==null){a9.LABEL_CREATION=new ai.Mode("LABEL_CREATION")}return a9.LABEL_CREATION};a9.prototype.name=function(){return this.__name};a9.prototype.toString=function(){return this.__name};return a9}());ai.Mode=aI;aI.__class="com.eteks.sweethome3d.viewcontroller.PlanController.Mode";var k=(function(ba){__extends(a9,ba);function a9(bc,bg,bd,bb,be,bf){var bh=ba.call(this,bd,ai,"undoLockBasePlan")||this;if(bh.controller===undefined){bh.controller=null}if(bh.home===undefined){bh.home=null}if(bh.oldSelection===undefined){bh.oldSelection=null}if(bh.allLevelsSelection===undefined){bh.allLevelsSelection=false}if(bh.newSelectedItems===undefined){bh.newSelectedItems=null}bh.controller=bc;bh.home=bg;bh.oldSelection=bb;bh.allLevelsSelection=be;bh.newSelectedItems=bf;return bh}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.home.setBasePlanLocked(false);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.home.setBasePlanLocked(true);this.controller.selectAndShowItems$java_util_List$boolean(this.newSelectedItems.slice(0),this.allLevelsSelection)};return a9}(LocalizedUndoableEdit));ai.LockingUndoableEdit=k;k.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LockingUndoableEdit";k.__interfaces=["javax.swing.undo.UndoableEdit"];var aH=(function(a9){__extends(ba,a9);function ba(bb,be,bc,bg,bd){var bf=a9.call(this,bc,ai,"undoUnlockBasePlan")||this;if(bf.controller===undefined){bf.controller=null}if(bf.home===undefined){bf.home=null}if(bf.selectedItems===undefined){bf.selectedItems=null}if(bf.allLevelsSelection===undefined){bf.allLevelsSelection=false}bf.controller=bb;bf.home=be;bf.selectedItems=bg;bf.allLevelsSelection=bd;return bf}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.home.setBasePlanLocked(true);this.controller.selectAndShowItems$java_util_List$boolean(this.selectedItems.slice(0),this.allLevelsSelection)};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.home.setBasePlanLocked(false);this.controller.selectAndShowItems$java_util_List$boolean(this.selectedItems.slice(0),false)};return ba}(LocalizedUndoableEdit));ai.UnlockingUndoableEdit=aH;aH.__class="com.eteks.sweethome3d.viewcontroller.PlanController.UnlockingUndoableEdit";aH.__interfaces=["javax.swing.undo.UndoableEdit"];var H=(function(a9){__extends(ba,a9);function ba(bb,bd,be,bc,bf,bg){var bh=a9.call(this,bd,ai,"undoFlipName")||this;if(bh.controller===undefined){bh.controller=null}if(bh.allLevelsSelection===undefined){bh.allLevelsSelection=false}if(bh.items===undefined){bh.items=null}if(bh.itemTextBaseOffsets===undefined){bh.itemTextBaseOffsets=null}if(bh.horizontalFlip===undefined){bh.horizontalFlip=false}bh.controller=bb;bh.allLevelsSelection=be;bh.items=bc;bh.itemTextBaseOffsets=bf;bh.horizontalFlip=bg;return bh}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.controller.doFlipItems(this.items,this.itemTextBaseOffsets,this.horizontalFlip);this.controller.selectAndShowItems$java_util_List$boolean(this.items.slice(0),this.allLevelsSelection)};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.controller.doFlipItems(this.items,this.itemTextBaseOffsets,this.horizontalFlip);this.controller.selectAndShowItems$java_util_List$boolean(this.items.slice(0),this.allLevelsSelection)};return ba}(LocalizedUndoableEdit));ai.FlippingUndoableEdit=H;H.__class="com.eteks.sweethome3d.viewcontroller.PlanController.FlippingUndoableEdit";H.__interfaces=["javax.swing.undo.UndoableEdit"];var S=(function(a9){__extends(ba,a9);function ba(bc,bd,bb,bf,bh,be){var bg=a9.call(this,bd,ai,"undoJoinWallsName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldSelection===undefined){bg.oldSelection=null}if(bg.allLevelsSelection===undefined){bg.allLevelsSelection=false}if(bg.joinedWalls===undefined){bg.joinedWalls=null}if(bg.joinPoint===undefined){bg.joinPoint=null}bg.controller=bc;bg.oldSelection=bb;bg.allLevelsSelection=bf;bg.joinedWalls=bh;bg.joinPoint=be;return bg}ba.prototype.undo=function(){a9.prototype.undo.call(this);for(var bc=0;bc<this.joinedWalls.length;bc++){var bd=this.joinedWalls[bc];var bb=bd.getWall();bb.setWallAtStart(bd.getWallAtStart());if(bd.getWallAtStart()!=null){if(bd.isJoinedAtEndOfWallAtStart()){bd.getWallAtStart().setWallAtEnd(bb)}else{bd.getWallAtStart().setWallAtStart(bb)}}bb.setWallAtEnd(bd.getWallAtEnd());if(bd.getWallAtEnd()!=null){if(bd.isJoinedAtStartOfWallAtEnd()){bd.getWallAtEnd().setWallAtStart(bb)}else{bd.getWallAtEnd().setWallAtEnd(bb)}}bb.setXStart(bd.getXStart());bb.setYStart(bd.getYStart());bb.setXEnd(bd.getXEnd());bb.setYEnd(bd.getYEnd())}this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.controller.doJoinWalls(this.joinedWalls,this.joinPoint)};return ba}(LocalizedUndoableEdit));ai.WallsJoiningUndoableEdit=S;S.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallsJoiningUndoableEdit";S.__interfaces=["javax.swing.undo.UndoableEdit"];var aE=(function(ba){__extends(a9,ba);function a9(bc,bd,bb,bf,be){var bg=ba.call(this,bd,ai,"undoReverseWallsDirectionName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldSelection===undefined){bg.oldSelection=null}if(bg.allLevelsSelection===undefined){bg.allLevelsSelection=false}if(bg.walls===undefined){bg.walls=null}bg.controller=bc;bg.oldSelection=bb;bg.allLevelsSelection=bf;bg.walls=be;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.controller.doReverseWallsDirection(this.walls);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.controller.doReverseWallsDirection(this.walls);this.controller.selectAndShowItems$java_util_List$boolean(this.walls.slice(0),false)};return a9}(LocalizedUndoableEdit));ai.WallsDirectionReversingUndoableEdit=aE;aE.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallsDirectionReversingUndoableEdit";aE.__interfaces=["javax.swing.undo.UndoableEdit"];var an=(function(ba){__extends(a9,ba);function a9(bf,be,bc,bk,bh,bj,bi,bd,bb){var bg=ba.call(this,be,ai,"undoSplitWallName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldSelection===undefined){bg.oldSelection=null}if(bg.oldBasePlanLocked===undefined){bg.oldBasePlanLocked=false}if(bg.oldAllLevelsSelection===undefined){bg.oldAllLevelsSelection=false}if(bg.splitJoinedWall===undefined){bg.splitJoinedWall=null}if(bg.firstJoinedWall===undefined){bg.firstJoinedWall=null}if(bg.secondJoinedWall===undefined){bg.secondJoinedWall=null}if(bg.newBasePlanLocked===undefined){bg.newBasePlanLocked=false}bg.controller=bf;bg.oldSelection=bc;bg.oldBasePlanLocked=bk;bg.oldAllLevelsSelection=bh;bg.splitJoinedWall=bj;bg.firstJoinedWall=bi;bg.secondJoinedWall=bd;bg.newBasePlanLocked=bb;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.controller.doDeleteWalls([this.firstJoinedWall,this.secondJoinedWall],this.oldBasePlanLocked);this.controller.doAddWalls([this.splitJoinedWall],this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.controller.doDeleteWalls([this.splitJoinedWall],this.newBasePlanLocked);this.controller.doAddWalls([this.firstJoinedWall,this.secondJoinedWall],this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean([this.firstJoinedWall.getWall()].slice(0),false)};return a9}(LocalizedUndoableEdit));ai.WallSplittingUndoableEdit=an;an.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallSplittingUndoableEdit";an.__interfaces=["javax.swing.undo.UndoableEdit"];var B=(function(ba){__extends(a9,ba);function a9(bc,be,bb,bf,bg,bd,bh){var bi=ba.call(this,be,ai,"undoModifyTextStyleName")||this;if(bi.controller===undefined){bi.controller=null}if(bi.oldSelection===undefined){bi.oldSelection=null}if(bi.allLevelsSelection===undefined){bi.allLevelsSelection=false}if(bi.oldStyles===undefined){bi.oldStyles=null}if(bi.items===undefined){bi.items=null}if(bi.styles===undefined){bi.styles=null}bi.controller=bc;bi.oldSelection=bb;bi.allLevelsSelection=bf;bi.oldStyles=bg;bi.items=bd;bi.styles=bh;return bi}a9.prototype.undo=function(){ba.prototype.undo.call(this);ai.doModifyTextStyle(this.items,this.oldStyles);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};a9.prototype.redo=function(){ba.prototype.redo.call(this);ai.doModifyTextStyle(this.items,this.styles);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};return a9}(LocalizedUndoableEdit));ai.TextStyleModificationUndoableEdit=B;B.__class="com.eteks.sweethome3d.viewcontroller.PlanController.TextStyleModificationUndoableEdit";B.__interfaces=["javax.swing.undo.UndoableEdit"];var ah=(function(a9){__extends(ba,a9);function ba(be,bi,bd,bb,bh,bk,bj,bg,bc){var bf=a9.call(this,bd,ai,"undoAddLevel")||this;if(bf.controller===undefined){bf.controller=null}if(bf.home===undefined){bf.home=null}if(bf.oldSelection===undefined){bf.oldSelection=null}if(bf.allLevelsSelection===undefined){bf.allLevelsSelection=false}if(bf.oldSelectedLevel===undefined){bf.oldSelectedLevel=null}if(bf.level0===undefined){bf.level0=null}if(bf.homeBackgroundImage===undefined){bf.homeBackgroundImage=null}if(bf.newLevel===undefined){bf.newLevel=null}bf.controller=be;bf.home=bi;bf.oldSelection=bb;bf.allLevelsSelection=bh;bf.oldSelectedLevel=bk;bf.level0=bj;bf.homeBackgroundImage=bg;bf.newLevel=bc;return bf}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.controller.setSelectedLevel(this.oldSelectedLevel);this.home.deleteLevel(this.newLevel);if(this.level0!=null){this.home.setBackgroundImage(this.homeBackgroundImage);this.controller.moveHomeItemsToLevel(this.oldSelectedLevel);this.home.deleteLevel(this.level0)}this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};ba.prototype.redo=function(){a9.prototype.redo.call(this);if(this.level0!=null){this.home.addLevel(this.level0);this.controller.moveHomeItemsToLevel(this.level0);this.level0.setBackgroundImage(this.homeBackgroundImage);this.home.setBackgroundImage(null)}this.home.addLevel(this.newLevel);this.controller.setSelectedLevel(this.newLevel)};return ba}(LocalizedUndoableEdit));ai.LevelAdditionUndoableEdit=ah;ah.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelAdditionUndoableEdit";ah.__interfaces=["javax.swing.undo.UndoableEdit"];var aK=(function(ba){__extends(a9,ba);function a9(bb,bc,bd){var be=ba.call(this,bc,ai,"undoModifyLevelViewabilityName")||this;if(be.controller===undefined){be.controller=null}if(be.selectedLevel===undefined){be.selectedLevel=null}be.controller=bb;be.selectedLevel=bd;return be}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.controller.setSelectedLevel(this.selectedLevel);this.selectedLevel.setViewable(!this.selectedLevel.isViewable())};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.controller.setSelectedLevel(this.selectedLevel);this.selectedLevel.setViewable(!this.selectedLevel.isViewable())};return a9}(LocalizedUndoableEdit));ai.LevelViewabilityModificationUndoableEdit=aK;aK.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelViewabilityModificationUndoableEdit";aK.__interfaces=["javax.swing.undo.UndoableEdit"];var a8=(function(a9){__extends(ba,a9);function ba(bb,bc,be,bd,bf){var bg=a9.call(this,bc,ai,"undoModifyLevelViewabilityName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.selectedLevel===undefined){bg.selectedLevel=null}if(bg.selectedLevelViewable===undefined){bg.selectedLevelViewable=false}if(bg.viewableLevels===undefined){bg.viewableLevels=null}bg.controller=bb;bg.selectedLevel=be;bg.selectedLevelViewable=bd;bg.viewableLevels=bf;return bg}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.controller.setSelectedLevel(this.selectedLevel);ai.setLevelsViewability(this.viewableLevels,true);this.selectedLevel.setViewable(this.selectedLevelViewable)};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.controller.setSelectedLevel(this.selectedLevel);ai.setLevelsViewability(this.viewableLevels,false);this.selectedLevel.setViewable(true)};return ba}(LocalizedUndoableEdit));ai.LevelsViewabilityModificationUndoableEdit=a8;a8.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelsViewabilityModificationUndoableEdit";a8.__interfaces=["javax.swing.undo.UndoableEdit"];var A=(function(ba){__extends(a9,ba);function a9(bc,bd,be,bb){var bf=ba.call(this,bd,ai,"undoModifyLevelViewabilityName")||this;if(bf.controller===undefined){bf.controller=null}if(bf.selectedLevel===undefined){bf.selectedLevel=null}if(bf.unviewableLevels===undefined){bf.unviewableLevels=null}bf.controller=bc;bf.selectedLevel=be;bf.unviewableLevels=bb;return bf}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.controller.setSelectedLevel(this.selectedLevel);ai.setLevelsViewability(this.unviewableLevels,false)};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.controller.setSelectedLevel(this.selectedLevel);ai.setLevelsViewability(this.unviewableLevels,true)};return a9}(LocalizedUndoableEdit));ai.AllLevelsViewabilityModificationUndoableEdit=A;A.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AllLevelsViewabilityModificationUndoableEdit";A.__interfaces=["javax.swing.undo.UndoableEdit"];var f=(function(ba){__extends(a9,ba);function a9(bc,bg,bd,bf,bi,be,bb){var bh=ba.call(this,bd,ai,"undoDeleteSelectedLevel")||this;if(bh.controller===undefined){bh.controller=null}if(bh.home===undefined){bh.home=null}if(bh.oldSelectedLevel===undefined){bh.oldSelectedLevel=null}if(bh.remainingLevel===undefined){bh.remainingLevel=null}if(bh.remainingLevelElevation===undefined){bh.remainingLevelElevation=null}if(bh.remainingLevelViewable===undefined){bh.remainingLevelViewable=false}bh.controller=bc;bh.home=bg;bh.oldSelectedLevel=bf;bh.remainingLevel=bi;bh.remainingLevelElevation=be;bh.remainingLevelViewable=bb;return bh}a9.prototype.undo=function(){ba.prototype.undo.call(this);if(this.remainingLevel!=null){this.remainingLevel.setElevation(this.remainingLevelElevation);this.remainingLevel.setViewable(this.remainingLevelViewable)}this.home.addLevel(this.oldSelectedLevel);this.controller.setSelectedLevel(this.oldSelectedLevel)};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.home.deleteLevel(this.oldSelectedLevel);if(this.remainingLevel!=null){this.remainingLevel.setElevation(0);this.remainingLevel.setViewable(true)}};return a9}(LocalizedUndoableEdit));ai.LevelDeletionUndoableEdit=f;f.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelDeletionUndoableEdit";f.__interfaces=["javax.swing.undo.UndoableEdit"];var a3=(function(ba){__extends(a9,ba);function a9(bd,be,bc,bg,bf,bb,bi){var bh=ba.call(this,be,ai,"undoAddRoomPointName")||this;if(bh.controller===undefined){bh.controller=null}if(bh.oldSelection===undefined){bh.oldSelection=null}if(bh.room===undefined){bh.room=null}if(bh.index===undefined){bh.index=0}if(bh.x===undefined){bh.x=0}if(bh.y===undefined){bh.y=0}bh.controller=bd;bh.oldSelection=bc;bh.room=bg;bh.index=bf;bh.x=bb;bh.y=bi;return bh}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.room.removePoint(this.index);this.controller.selectAndShowItems$java_util_List(this.oldSelection.slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.room.addPoint$float$float$int(this.x,this.y,this.index);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return a9}(LocalizedUndoableEdit));ai.RoomPointAdditionUndoableEdit=a3;a3.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomPointAdditionUndoableEdit";a3.__interfaces=["javax.swing.undo.UndoableEdit"];var ab=(function(ba){__extends(a9,ba);function a9(bc,bd,bb,bg,be,bh,bf){var bi=ba.call(this,bd,ai,"undoDeleteRoomPointName")||this;if(bi.controller===undefined){bi.controller=null}if(bi.oldSelection===undefined){bi.oldSelection=null}if(bi.room===undefined){bi.room=null}if(bi.index===undefined){bi.index=0}if(bi.xPoint===undefined){bi.xPoint=0}if(bi.yPoint===undefined){bi.yPoint=0}bi.controller=bc;bi.oldSelection=bb;bi.room=bg;bi.index=be;bi.xPoint=bh;bi.yPoint=bf;return bi}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.room.addPoint$float$float$int(this.xPoint,this.yPoint,this.index);this.controller.selectAndShowItems$java_util_List(this.oldSelection.slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.room.removePoint(this.index);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return a9}(LocalizedUndoableEdit));ai.RoomPointDeletionUndoableEdit=ab;ab.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomPointDeletionUndoableEdit";ab.__interfaces=["javax.swing.undo.UndoableEdit"];var j=(function(ba){__extends(a9,ba);function a9(bb,bd,bc,bf){var be=ba.call(this)||this;if(be.controller===undefined){be.controller=null}if(be.home===undefined){be.home=null}if(be.allLevelsSelection===undefined){be.allLevelsSelection=false}if(be.selectedItems===undefined){be.selectedItems=null}be.controller=bb;be.home=bd;be.allLevelsSelection=bc;be.selectedItems=bf;return be}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.controller.selectAndShowItems$java_util_List$boolean(this.selectedItems.slice(0),this.allLevelsSelection)};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.home.removeSelectionListener(this.controller.getSelectionListener())};return a9}(javax.swing.undo.AbstractUndoableEdit));ai.ItemsDeletionStartUndoableEdit=j;j.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsDeletionStartUndoableEdit";j.__interfaces=["javax.swing.undo.UndoableEdit"];var ae=(function(a9){__extends(ba,a9);function ba(bb,bc){var bd=a9.call(this)||this;if(bd.controller===undefined){bd.controller=null}if(bd.home===undefined){bd.home=null}bd.controller=bb;bd.home=bc;return bd}ba.prototype.redo=function(){a9.prototype.redo.call(this);this.home.addSelectionListener(this.controller.getSelectionListener())};return ba}(javax.swing.undo.AbstractUndoableEdit));ai.ItemsDeletionEndUndoableEdit=ae;ae.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsDeletionEndUndoableEdit";ae.__interfaces=["javax.swing.undo.UndoableEdit"];var ac=(function(a9){__extends(ba,a9);function ba(bi,bh,bk,bn,bb,bq,be,bo,bp,bg,bf,bd,bm,br,bj,bc){var bl=a9.call(this,bh,ai,"undoDeleteSelectionName")||this;if(bl.controller===undefined){bl.controller=null}if(bl.basePlanLocked===undefined){bl.basePlanLocked=false}if(bl.allLevelsSelection===undefined){bl.allLevelsSelection=false}if(bl.deletedItems===undefined){bl.deletedItems=null}if(bl.joinedDeletedWalls===undefined){bl.joinedDeletedWalls=null}if(bl.rooms===undefined){bl.rooms=null}if(bl.roomsIndices===undefined){bl.roomsIndices=null}if(bl.roomsLevels===undefined){bl.roomsLevels=null}if(bl.dimensionLines===undefined){bl.dimensionLines=null}if(bl.dimensionLinesLevels===undefined){bl.dimensionLinesLevels=null}if(bl.polylines===undefined){bl.polylines=null}if(bl.polylinesIndices===undefined){bl.polylinesIndices=null}if(bl.polylinesLevels===undefined){bl.polylinesLevels=null}if(bl.labels===undefined){bl.labels=null}if(bl.labelsLevels===undefined){bl.labelsLevels=null}bl.controller=bi;bl.basePlanLocked=bk;bl.allLevelsSelection=bn;bl.deletedItems=bb;bl.joinedDeletedWalls=bq;bl.rooms=be;bl.roomsIndices=bo;bl.roomsLevels=bp;bl.dimensionLines=bg;bl.dimensionLinesLevels=bf;bl.polylines=bd;bl.polylinesIndices=bm;bl.polylinesLevels=br;bl.labels=bj;bl.labelsLevels=bc;return bl}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.controller.doAddWalls(this.joinedDeletedWalls,this.basePlanLocked);this.controller.doAddRooms(this.rooms,this.roomsIndices,this.roomsLevels,null,this.basePlanLocked);this.controller.doAddDimensionLines(this.dimensionLines,this.dimensionLinesLevels,null,this.basePlanLocked);this.controller.doAddPolylines(this.polylines,this.polylinesIndices,this.polylinesLevels,null,this.basePlanLocked);this.controller.doAddLabels(this.labels,this.labelsLevels,null,this.basePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.deletedItems.slice(0),this.allLevelsSelection)};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.controller.selectItems$java_util_List(this.deletedItems.slice(0));this.controller.doDeleteWalls(this.joinedDeletedWalls,this.basePlanLocked);this.controller.doDeleteRooms(this.rooms,this.basePlanLocked);this.controller.doDeleteDimensionLines(this.dimensionLines,this.basePlanLocked);this.controller.doDeletePolylines(this.polylines,this.basePlanLocked);this.controller.doDeleteLabels(this.labels,this.basePlanLocked)};return ba}(LocalizedUndoableEdit));ai.ItemsDeletionUndoableEdit=ac;ac.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsDeletionUndoableEdit";ac.__interfaces=["javax.swing.undo.UndoableEdit"];var aF=(function(ba){__extends(a9,ba);function a9(bd,bc,bb){var be=ba.call(this,bc,ai,"undoAddItemsName")||this;if(be.home===undefined){be.home=null}if(be.items===undefined){be.items=null}be.home=bd;be.items=bb;return be}a9.prototype.redo=function(){ba.prototype.redo.call(this);this.home.setSelectedItems(this.items.slice(0))};return a9}(LocalizedUndoableEdit));ai.ItemsAdditionEndUndoableEdit=aF;aF.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsAdditionEndUndoableEdit";aF.__interfaces=["javax.swing.undo.UndoableEdit"];var l=(function(a9){__extends(ba,a9);function ba(bc,bd,bb,bf,bh,bg,be){var bi=a9.call(this,bd,ai,"undoCreateWallsName")||this;if(bi.controller===undefined){bi.controller=null}if(bi.oldSelection===undefined){bi.oldSelection=null}if(bi.oldBasePlanLocked===undefined){bi.oldBasePlanLocked=false}if(bi.oldAllLevelsSelection===undefined){bi.oldAllLevelsSelection=false}if(bi.joinedNewWalls===undefined){bi.joinedNewWalls=null}if(bi.newBasePlanLocked===undefined){bi.newBasePlanLocked=false}bi.controller=bc;bi.oldSelection=bb;bi.oldBasePlanLocked=bf;bi.oldAllLevelsSelection=bh;bi.joinedNewWalls=bg;bi.newBasePlanLocked=be;return bi}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.controller.doDeleteWalls(this.joinedNewWalls,this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.controller.doAddWalls(this.joinedNewWalls,this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(ai.JoinedWall.getWalls(this.joinedNewWalls),false)};return ba}(LocalizedUndoableEdit));ai.WallsCreationUndoableEdit=l;l.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallsCreationUndoableEdit";l.__interfaces=["javax.swing.undo.UndoableEdit"];var al=(function(ba){__extends(a9,ba);function a9(bf,be,bc,bk,bj,bi,bh,bd,bb){var bg=ba.call(this,be,ai,"undoCreateRoomsName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldSelection===undefined){bg.oldSelection=null}if(bg.oldBasePlanLocked===undefined){bg.oldBasePlanLocked=false}if(bg.oldAllLevelsSelection===undefined){bg.oldAllLevelsSelection=false}if(bg.newRooms===undefined){bg.newRooms=null}if(bg.roomsIndex===undefined){bg.roomsIndex=null}if(bg.roomsLevel===undefined){bg.roomsLevel=null}if(bg.newBasePlanLocked===undefined){bg.newBasePlanLocked=false}bg.controller=bf;bg.oldSelection=bc;bg.oldBasePlanLocked=bk;bg.oldAllLevelsSelection=bj;bg.newRooms=bi;bg.roomsIndex=bh;bg.roomsLevel=bd;bg.newBasePlanLocked=bb;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.controller.doDeleteRooms(this.newRooms,this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.controller.doAddRooms(this.newRooms,this.roomsIndex,null,this.roomsLevel,this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.newRooms.slice(0),false)};return a9}(LocalizedUndoableEdit));ai.RoomsCreationUndoableEdit=al;al.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomsCreationUndoableEdit";al.__interfaces=["javax.swing.undo.UndoableEdit"];var ay=(function(a9){__extends(ba,a9);function ba(bf,be,bc,bj,bh,bd,bi,bb){var bg=a9.call(this,be,ai,"undoCreateDimensionLinesName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldSelection===undefined){bg.oldSelection=null}if(bg.oldBasePlanLocked===undefined){bg.oldBasePlanLocked=false}if(bg.oldAllLevelsSelection===undefined){bg.oldAllLevelsSelection=false}if(bg.dimensionLines===undefined){bg.dimensionLines=null}if(bg.dimensionLinesLevel===undefined){bg.dimensionLinesLevel=null}if(bg.newBasePlanLocked===undefined){bg.newBasePlanLocked=false}bg.controller=bf;bg.oldSelection=bc;bg.oldBasePlanLocked=bj;bg.oldAllLevelsSelection=bh;bg.dimensionLines=bd;bg.dimensionLinesLevel=bi;bg.newBasePlanLocked=bb;return bg}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.controller.doDeleteDimensionLines(this.dimensionLines,this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.controller.doAddDimensionLines(this.dimensionLines,null,this.dimensionLinesLevel,this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.dimensionLines.slice(0),false)};return ba}(LocalizedUndoableEdit));ai.DimensionLinesCreationUndoableEdit=ay;ay.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLinesCreationUndoableEdit";ay.__interfaces=["javax.swing.undo.UndoableEdit"];var aq=(function(ba){__extends(a9,ba);function a9(bg,bf,bc,bj,bi,bd,be,bk,bb){var bh=ba.call(this,bf,ai,"undoCreatePolylinesName")||this;if(bh.controller===undefined){bh.controller=null}if(bh.oldSelection===undefined){bh.oldSelection=null}if(bh.oldBasePlanLocked===undefined){bh.oldBasePlanLocked=false}if(bh.oldAllLevelsSelection===undefined){bh.oldAllLevelsSelection=false}if(bh.newPolylines===undefined){bh.newPolylines=null}if(bh.polylinesIndex===undefined){bh.polylinesIndex=null}if(bh.polylinesLevel===undefined){bh.polylinesLevel=null}if(bh.newBasePlanLocked===undefined){bh.newBasePlanLocked=false}bh.controller=bg;bh.oldSelection=bc;bh.oldBasePlanLocked=bj;bh.oldAllLevelsSelection=bi;bh.newPolylines=bd;bh.polylinesIndex=be;bh.polylinesLevel=bk;bh.newBasePlanLocked=bb;return bh}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.controller.doDeletePolylines(this.newPolylines,this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.controller.doAddPolylines(this.newPolylines,this.polylinesIndex,null,this.polylinesLevel,this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List(this.newPolylines.slice(0))};return a9}(LocalizedUndoableEdit));ai.PolylinesCreationUndoableEdit=aq;aq.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylinesCreationUndoableEdit";aq.__interfaces=["javax.swing.undo.UndoableEdit"];var a6=(function(ba){__extends(a9,ba);function a9(be,bd,bc,bj,bi,bf,bh,bb){var bg=ba.call(this,bd,ai,"undoCreateLabelsName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldSelection===undefined){bg.oldSelection=null}if(bg.oldBasePlanLocked===undefined){bg.oldBasePlanLocked=false}if(bg.oldAllLevelsSelection===undefined){bg.oldAllLevelsSelection=false}if(bg.labels===undefined){bg.labels=null}if(bg.labelsLevel===undefined){bg.labelsLevel=null}if(bg.newBasePlanLocked===undefined){bg.newBasePlanLocked=false}bg.controller=be;bg.oldSelection=bc;bg.oldBasePlanLocked=bj;bg.oldAllLevelsSelection=bi;bg.labels=bf;bg.labelsLevel=bh;bg.newBasePlanLocked=bb;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.controller.doDeleteLabels(this.labels,this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.controller.doAddLabels(this.labels,null,this.labelsLevel,this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.labels.slice(0),false)};return a9}(LocalizedUndoableEdit));ai.LabelsCreationUndoableEdit=a6;a6.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelsCreationUndoableEdit";a6.__interfaces=["javax.swing.undo.UndoableEdit"];var r=(function(ba){__extends(a9,ba);function a9(bb,bc,be,bd,bg){var bf=ba.call(this,bc,ai,"undoLabelRotationName")||this;if(bf.controller===undefined){bf.controller=null}if(bf.oldAngle===undefined){bf.oldAngle=0}if(bf.label===undefined){bf.label=null}if(bf.newAngle===undefined){bf.newAngle=0}bf.controller=bb;bf.oldAngle=be;bf.label=bd;bf.newAngle=bg;return bf}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.label.setAngle(this.oldAngle);this.controller.selectAndShowItems$java_util_List([this.label].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.label.setAngle(this.newAngle);this.controller.selectAndShowItems$java_util_List([this.label].slice(0))};return a9}(LocalizedUndoableEdit));ai.LabelRotationUndoableEdit=r;r.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelRotationUndoableEdit";r.__interfaces=["javax.swing.undo.UndoableEdit"];var Y=(function(ba){__extends(a9,ba);function a9(bb,bc,bf,be,bd){var bg=ba.call(this,bc,ai,bf<bd?"undoLabelRaiseName":"undoLabelLowerName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldElevation===undefined){bg.oldElevation=0}if(bg.label===undefined){bg.label=null}if(bg.newElevation===undefined){bg.newElevation=0}bg.controller=bb;bg.oldElevation=bf;bg.label=be;bg.newElevation=bd;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.label.setElevation(this.oldElevation);this.controller.selectAndShowItems$java_util_List([this.label].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.label.setElevation(this.newElevation);this.controller.selectAndShowItems$java_util_List([this.label].slice(0))};return a9}(LocalizedUndoableEdit));ai.LabelElevationModificationUndoableEdit=Y;Y.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelElevationModificationUndoableEdit";Y.__interfaces=["javax.swing.undo.UndoableEdit"];var aM=(function(ba){__extends(a9,ba);function a9(bd,bg,bc,bh,bf,be,bb){var bi=ba.call(this,bg,ai,"undoMoveSelectionName")||this;if(bi.controller===undefined){bi.controller=null}if(bi.oldSelection===undefined){bi.oldSelection=null}if(bi.allLevelsSelection===undefined){bi.allLevelsSelection=false}if(bi.itemsArray===undefined){bi.itemsArray=null}if(bi.dx===undefined){bi.dx=0}if(bi.dy===undefined){bi.dy=0}bi.controller=bd;bi.oldSelection=bc;bi.allLevelsSelection=bh;bi.itemsArray=bf;bi.dx=be;bi.dy=bb;return bi}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.controller.doMoveAndShowItems(this.itemsArray,this.oldSelection,-this.dx,-this.dy,this.allLevelsSelection)};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.controller.doMoveAndShowItems(this.itemsArray,this.itemsArray,this.dx,this.dy,this.allLevelsSelection)};return a9}(LocalizedUndoableEdit));ai.ItemsMovingUndoableEdit=aM;aM.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsMovingUndoableEdit";aM.__interfaces=["javax.swing.undo.UndoableEdit"];var ar=(function(ba){__extends(a9,ba);function a9(be,bd,bf,bi,bc,bj,bm,bn,bl,bh,bk,bb){var bg=ba.call(this,bd,ai,"undoMoveSelectionName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldAngle===undefined){bg.oldAngle=0}if(bg.oldDepth===undefined){bg.oldDepth=0}if(bg.oldElevation===undefined){bg.oldElevation=0}if(bg.oldDoorOrWindowBoundToWall===undefined){bg.oldDoorOrWindowBoundToWall=false}if(bg.piece===undefined){bg.piece=null}if(bg.dx===undefined){bg.dx=0}if(bg.dy===undefined){bg.dy=0}if(bg.newAngle===undefined){bg.newAngle=0}if(bg.newDepth===undefined){bg.newDepth=0}if(bg.newElevation===undefined){bg.newElevation=0}bg.controller=be;bg.oldAngle=bf;bg.oldDepth=bi;bg.oldElevation=bc;bg.oldDoorOrWindowBoundToWall=bj;bg.piece=bm;bg.dx=bn;bg.dy=bl;bg.newAngle=bh;bg.newDepth=bk;bg.newElevation=bb;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.piece.move(-this.dx,-this.dy);this.piece.setAngle(this.oldAngle);if((this.piece!=null&&this.piece instanceof HomeDoorOrWindow)&&this.piece.isResizable()&&this.controller.isItemResizable(this.piece)){this.piece.setDepth(this.oldDepth)}this.piece.setElevation(this.oldElevation);if(this.piece!=null&&this.piece instanceof HomeDoorOrWindow){this.piece.setBoundToWall(this.oldDoorOrWindowBoundToWall)}this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.piece.move(this.dx,this.dy);this.piece.setAngle(this.newAngle);if((this.piece!=null&&this.piece instanceof HomeDoorOrWindow)&&this.piece.isResizable()&&this.controller.isItemResizable(this.piece)){this.piece.setDepth(this.newDepth)}this.piece.setElevation(this.newElevation);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return a9}(LocalizedUndoableEdit));ai.PieceOfFurnitureMovingUndoableEdit=ar;ar.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureMovingUndoableEdit";ar.__interfaces=["javax.swing.undo.UndoableEdit"];var aJ=(function(ba){__extends(a9,ba);function a9(bc,bb,bd){var be=ba.call(this)||this;if(be.controller===undefined){be.controller=null}if(be.oldSelection===undefined){be.oldSelection=null}if(be.allLevelsSelection===undefined){be.allLevelsSelection=false}be.controller=bc;be.oldSelection=bb;be.allLevelsSelection=bd;return be}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};return a9}(javax.swing.undo.AbstractUndoableEdit));ai.DuplicationStartUndoableEdit=aJ;aJ.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DuplicationStartUndoableEdit";aJ.__interfaces=["javax.swing.undo.UndoableEdit"];var aO=(function(ba){__extends(a9,ba);function a9(bb,bd,bc){var be=ba.call(this,bd,ai,"undoDuplicateSelectionName")||this;if(be.controller===undefined){be.controller=null}if(be.items===undefined){be.items=null}be.controller=bb;be.items=bc;return be}a9.prototype.redo=function(){ba.prototype.redo.call(this);this.controller.selectAndShowItems$java_util_List(this.items.slice(0))};return a9}(LocalizedUndoableEdit));ai.DuplicationEndUndoableEdit=aO;aO.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DuplicationEndUndoableEdit";aO.__interfaces=["javax.swing.undo.UndoableEdit"];var E=(function(ba){__extends(a9,ba);function a9(be,bd,bi,bh,bg,bc,bb,bj){var bf=ba.call(this,bd,ai,"undoWallResizeName")||this;if(bf.controller===undefined){bf.controller=null}if(bf.oldX===undefined){bf.oldX=0}if(bf.oldY===undefined){bf.oldY=0}if(bf.wall===undefined){bf.wall=null}if(bf.startPoint===undefined){bf.startPoint=false}if(bf.newX===undefined){bf.newX=0}if(bf.newY===undefined){bf.newY=0}bf.controller=be;bf.oldX=bi;bf.oldY=bh;bf.wall=bg;bf.startPoint=bc;bf.newX=bb;bf.newY=bj;return bf}a9.prototype.undo=function(){ba.prototype.undo.call(this);ai.moveWallPoint(this.wall,this.oldX,this.oldY,this.startPoint);this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);ai.moveWallPoint(this.wall,this.newX,this.newY,this.startPoint);this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))};return a9}(LocalizedUndoableEdit));ai.WallResizingUndoableEdit=E;E.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallResizingUndoableEdit";E.__interfaces=["javax.swing.undo.UndoableEdit"];var aG=(function(ba){__extends(a9,ba);function a9(bc,bd,bf,bb,be){var bg=ba.call(this,bd,ai,"undoWallArcExtentName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldArcExtent===undefined){bg.oldArcExtent=null}if(bg.wall===undefined){bg.wall=null}if(bg.newArcExtent===undefined){bg.newArcExtent=null}bg.controller=bc;bg.oldArcExtent=bf;bg.wall=bb;bg.newArcExtent=be;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.wall.setArcExtent(this.oldArcExtent);this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.wall.setArcExtent(this.newArcExtent);this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))};return a9}(LocalizedUndoableEdit));ai.WallArcExtentModificationUndoableEdit=aG;aG.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallArcExtentModificationUndoableEdit";aG.__interfaces=["javax.swing.undo.UndoableEdit"];var a=(function(ba){__extends(a9,ba);function a9(be,bd,bi,bh,bc,bg,bb,bj){var bf=ba.call(this,bd,ai,"undoRoomResizeName")||this;if(bf.controller===undefined){bf.controller=null}if(bf.oldX===undefined){bf.oldX=0}if(bf.oldY===undefined){bf.oldY=0}if(bf.room===undefined){bf.room=null}if(bf.pointIndex===undefined){bf.pointIndex=0}if(bf.newX===undefined){bf.newX=0}if(bf.newY===undefined){bf.newY=0}bf.controller=be;bf.oldX=bi;bf.oldY=bh;bf.room=bc;bf.pointIndex=bg;bf.newX=bb;bf.newY=bj;return bf}a9.prototype.undo=function(){ba.prototype.undo.call(this);ai.moveRoomPoint(this.room,this.oldX,this.oldY,this.pointIndex);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);ai.moveRoomPoint(this.room,this.newX,this.newY,this.pointIndex);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return a9}(LocalizedUndoableEdit));ai.RoomResizingUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomResizingUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"];var n=(function(a9){__extends(ba,a9);function ba(bb,bc,be,bi,bg,bd,bf){var bh=a9.call(this,bc,ai,"undoRoomNameOffsetName")||this;if(bh.controller===undefined){bh.controller=null}if(bh.oldNameXOffset===undefined){bh.oldNameXOffset=0}if(bh.oldNameYOffset===undefined){bh.oldNameYOffset=0}if(bh.room===undefined){bh.room=null}if(bh.newNameXOffset===undefined){bh.newNameXOffset=0}if(bh.newNameYOffset===undefined){bh.newNameYOffset=0}bh.controller=bb;bh.oldNameXOffset=be;bh.oldNameYOffset=bi;bh.room=bg;bh.newNameXOffset=bd;bh.newNameYOffset=bf;return bh}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.room.setNameXOffset(this.oldNameXOffset);this.room.setNameYOffset(this.oldNameYOffset);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.room.setNameXOffset(this.newNameXOffset);this.room.setNameYOffset(this.newNameYOffset);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return ba}(LocalizedUndoableEdit));ai.RoomNameOffsetModificationUndoableEdit=n;n.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameOffsetModificationUndoableEdit";n.__interfaces=["javax.swing.undo.UndoableEdit"];var aj=(function(ba){__extends(a9,ba);function a9(bb,bc,bf,be,bd){var bg=ba.call(this,bc,ai,"undoRoomNameRotationName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldNameAngle===undefined){bg.oldNameAngle=0}if(bg.room===undefined){bg.room=null}if(bg.newNameAngle===undefined){bg.newNameAngle=0}bg.controller=bb;bg.oldNameAngle=bf;bg.room=be;bg.newNameAngle=bd;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.room.setNameAngle(this.oldNameAngle);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.room.setNameAngle(this.newNameAngle);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return a9}(LocalizedUndoableEdit));ai.RoomNameRotationUndoableEdit=aj;aj.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameRotationUndoableEdit";aj.__interfaces=["javax.swing.undo.UndoableEdit"];var ao=(function(ba){__extends(a9,ba);function a9(bb,bc,be,bh,bg,bd,bf){var bi=ba.call(this,bc,ai,"undoRoomAreaOffsetName")||this;if(bi.controller===undefined){bi.controller=null}if(bi.oldAreaXOffset===undefined){bi.oldAreaXOffset=0}if(bi.oldAreaYOffset===undefined){bi.oldAreaYOffset=0}if(bi.room===undefined){bi.room=null}if(bi.newAreaXOffset===undefined){bi.newAreaXOffset=0}if(bi.newAreaYOffset===undefined){bi.newAreaYOffset=0}bi.controller=bb;bi.oldAreaXOffset=be;bi.oldAreaYOffset=bh;bi.room=bg;bi.newAreaXOffset=bd;bi.newAreaYOffset=bf;return bi}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.room.setAreaXOffset(this.oldAreaXOffset);this.room.setAreaYOffset(this.oldAreaYOffset);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.room.setAreaXOffset(this.newAreaXOffset);this.room.setAreaYOffset(this.newAreaYOffset);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return a9}(LocalizedUndoableEdit));ai.RoomAreaOffsetModificationUndoableEdit=ao;ao.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaOffsetModificationUndoableEdit";ao.__interfaces=["javax.swing.undo.UndoableEdit"];var X=(function(ba){__extends(a9,ba);function a9(bb,bc,be,bf,bd){var bg=ba.call(this,bc,ai,"undoRoomAreaRotationName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldAreaAngle===undefined){bg.oldAreaAngle=0}if(bg.room===undefined){bg.room=null}if(bg.newAreaAngle===undefined){bg.newAreaAngle=0}bg.controller=bb;bg.oldAreaAngle=be;bg.room=bf;bg.newAreaAngle=bd;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.room.setAreaAngle(this.oldAreaAngle);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.room.setAreaAngle(this.newAreaAngle);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return a9}(LocalizedUndoableEdit));ai.RoomAreaRotationUndoableEdit=X;X.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaRotationUndoableEdit";X.__interfaces=["javax.swing.undo.UndoableEdit"];var aY=(function(ba){__extends(a9,ba);function a9(bb,bc,be,bf,bd,bh){var bg=ba.call(this,bc,ai,"undoPieceOfFurnitureRotationName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldAngle===undefined){bg.oldAngle=0}if(bg.oldDoorOrWindowBoundToWall===undefined){bg.oldDoorOrWindowBoundToWall=false}if(bg.piece===undefined){bg.piece=null}if(bg.newAngle===undefined){bg.newAngle=0}bg.controller=bb;bg.oldAngle=be;bg.oldDoorOrWindowBoundToWall=bf;bg.piece=bd;bg.newAngle=bh;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.piece.setAngle(this.oldAngle);if(this.piece!=null&&this.piece instanceof HomeDoorOrWindow){this.piece.setBoundToWall(this.oldDoorOrWindowBoundToWall)}this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.piece.setAngle(this.newAngle);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return a9}(LocalizedUndoableEdit));ai.PieceOfFurnitureRotationUndoableEdit=aY;aY.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRotationUndoableEdit";aY.__interfaces=["javax.swing.undo.UndoableEdit"];var av=(function(a9){__extends(ba,a9);function ba(bh,bg,bd,bf,bl,bk,bm,be,bj,bc,bb){var bi=a9.call(this,bg,ai,"undoPieceOfFurnitureRotationName")||this;if(bi.controller===undefined){bi.controller=null}if(bi.oldPitch===undefined){bi.oldPitch=0}if(bi.oldWidthInPlan===undefined){bi.oldWidthInPlan=0}if(bi.oldDepthInPlan===undefined){bi.oldDepthInPlan=0}if(bi.oldHeightInPlan===undefined){bi.oldHeightInPlan=0}if(bi.piece===undefined){bi.piece=null}if(bi.newPitch===undefined){bi.newPitch=0}if(bi.newWidthInPlan===undefined){bi.newWidthInPlan=0}if(bi.newDepthInPlan===undefined){bi.newDepthInPlan=0}if(bi.newHeightInPlan===undefined){bi.newHeightInPlan=0}bi.controller=bh;bi.oldPitch=bd;bi.oldWidthInPlan=bf;bi.oldDepthInPlan=bl;bi.oldHeightInPlan=bk;bi.piece=bm;bi.newPitch=be;bi.newWidthInPlan=bj;bi.newDepthInPlan=bc;bi.newHeightInPlan=bb;return bi}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.controller.setPieceOfFurniturePitch(this.piece,this.oldPitch,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.controller.setPieceOfFurniturePitch(this.piece,this.newPitch,this.newWidthInPlan,this.newDepthInPlan,this.newHeightInPlan);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return ba}(LocalizedUndoableEdit));ai.PieceOfFurniturePitchRotationUndoableEdit=av;av.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurniturePitchRotationUndoableEdit";av.__interfaces=["javax.swing.undo.UndoableEdit"];var e=(function(ba){__extends(a9,ba);function a9(bg,bf,bd,be,bl,bk,bm,bj,bi,bc,bb){var bh=ba.call(this,bf,ai,"undoPieceOfFurnitureRotationName")||this;if(bh.controller===undefined){bh.controller=null}if(bh.oldRoll===undefined){bh.oldRoll=0}if(bh.oldWidthInPlan===undefined){bh.oldWidthInPlan=0}if(bh.oldDepthInPlan===undefined){bh.oldDepthInPlan=0}if(bh.oldHeightInPlan===undefined){bh.oldHeightInPlan=0}if(bh.piece===undefined){bh.piece=null}if(bh.newRoll===undefined){bh.newRoll=0}if(bh.newWidthInPlan===undefined){bh.newWidthInPlan=0}if(bh.newDepthInPlan===undefined){bh.newDepthInPlan=0}if(bh.newHeightInPlan===undefined){bh.newHeightInPlan=0}bh.controller=bg;bh.oldRoll=bd;bh.oldWidthInPlan=be;bh.oldDepthInPlan=bl;bh.oldHeightInPlan=bk;bh.piece=bm;bh.newRoll=bj;bh.newWidthInPlan=bi;bh.newDepthInPlan=bc;bh.newHeightInPlan=bb;return bh}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.controller.setPieceOfFurnitureRoll(this.piece,this.oldRoll,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.controller.setPieceOfFurnitureRoll(this.piece,this.newRoll,this.newWidthInPlan,this.newDepthInPlan,this.newHeightInPlan);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return a9}(LocalizedUndoableEdit));ai.PieceOfFurnitureRollRotationUndoableEdit=e;e.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRollRotationUndoableEdit";e.__interfaces=["javax.swing.undo.UndoableEdit"];var t=(function(a9){__extends(ba,a9);function ba(bb,bc,be,bf,bd){var bg=a9.call(this,bc,ai,be<bd?"undoPieceOfFurnitureRaiseName":"undoPieceOfFurnitureLowerName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldElevation===undefined){bg.oldElevation=0}if(bg.piece===undefined){bg.piece=null}if(bg.newElevation===undefined){bg.newElevation=0}bg.controller=bb;bg.oldElevation=be;bg.piece=bf;bg.newElevation=bd;return bg}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.piece.setElevation(this.oldElevation);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.piece.setElevation(this.newElevation);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return ba}(LocalizedUndoableEdit));ai.PieceOfFurnitureElevationModificationUndoableEdit=t;t.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureElevationModificationUndoableEdit";t.__interfaces=["javax.swing.undo.UndoableEdit"];var O=(function(a9){__extends(ba,a9);function ba(bf,be,bj,bl,bg,bc,bk,bd,bi,bb){var bh=a9.call(this,be,ai,bj)||this;if(bh.controller===undefined){bh.controller=null}if(bh.doorOrWindowBoundToWall===undefined){bh.doorOrWindowBoundToWall=false}if(bh.resizedPiece===undefined){bh.resizedPiece=null}if(bh.newX===undefined){bh.newX=0}if(bh.newY===undefined){bh.newY=0}if(bh.newWidth===undefined){bh.newWidth=0}if(bh.newDepth===undefined){bh.newDepth=0}if(bh.newHeight===undefined){bh.newHeight=0}bh.controller=bf;bh.doorOrWindowBoundToWall=bl;bh.resizedPiece=bg;bh.newX=bc;bh.newY=bk;bh.newWidth=bd;bh.newDepth=bi;bh.newHeight=bb;return bh}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.controller.resetPieceOfFurnitureSize(this.resizedPiece);this.controller.selectAndShowItems$java_util_List([this.resizedPiece.getPieceOfFurniture()].slice(0))};ba.prototype.redo=function(){a9.prototype.redo.call(this);var bb=this.resizedPiece.getPieceOfFurniture();bb.setX(this.newX);bb.setY(this.newY);this.controller.setPieceOfFurnitureSize(this.resizedPiece,this.newWidth,this.newDepth,this.newHeight);if(bb!=null&&bb instanceof HomeDoorOrWindow){bb.setBoundToWall(this.doorOrWindowBoundToWall)}this.controller.selectAndShowItems$java_util_List([bb].slice(0))};return ba}(LocalizedUndoableEdit));ai.PieceOfFurnitureResizingUndoableEdit=O;O.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureResizingUndoableEdit";O.__interfaces=["javax.swing.undo.UndoableEdit"];var aw=(function(ba){__extends(a9,ba);function a9(bd,be,bc,bb,bf){var bg=ba.call(this,be,ai,"undoLightPowerModificationName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldPower===undefined){bg.oldPower=0}if(bg.light===undefined){bg.light=null}if(bg.newPower===undefined){bg.newPower=0}bg.controller=bd;bg.oldPower=bc;bg.light=bb;bg.newPower=bf;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.light.setPower(this.oldPower);this.controller.selectAndShowItems$java_util_List([this.light].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.light.setPower(this.newPower);this.controller.selectAndShowItems$java_util_List([this.light].slice(0))};return a9}(LocalizedUndoableEdit));ai.LightPowerModificationUndoableEdit=aw;aw.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LightPowerModificationUndoableEdit";aw.__interfaces=["javax.swing.undo.UndoableEdit"];var x=(function(ba){__extends(a9,ba);function a9(bb,bc,bf,bi,bd,be,bg){var bh=ba.call(this,bc,ai,"undoPieceOfFurnitureNameOffsetName")||this;if(bh.controller===undefined){bh.controller=null}if(bh.oldNameXOffset===undefined){bh.oldNameXOffset=0}if(bh.oldNameYOffset===undefined){bh.oldNameYOffset=0}if(bh.piece===undefined){bh.piece=null}if(bh.newNameXOffset===undefined){bh.newNameXOffset=0}if(bh.newNameYOffset===undefined){bh.newNameYOffset=0}bh.controller=bb;bh.oldNameXOffset=bf;bh.oldNameYOffset=bi;bh.piece=bd;bh.newNameXOffset=be;bh.newNameYOffset=bg;return bh}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.piece.setNameXOffset(this.oldNameXOffset);this.piece.setNameYOffset(this.oldNameYOffset);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.piece.setNameXOffset(this.newNameXOffset);this.piece.setNameYOffset(this.newNameYOffset);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return a9}(LocalizedUndoableEdit));ai.PieceOfFurnitureNameOffsetModificationUndoableEdit=x;x.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameOffsetModificationUndoableEdit";x.__interfaces=["javax.swing.undo.UndoableEdit"];var ad=(function(a9){__extends(ba,a9);function ba(bb,bc,bf,bd,be){var bg=a9.call(this,bc,ai,"undoPieceOfFurnitureNameRotationName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldNameAngle===undefined){bg.oldNameAngle=0}if(bg.piece===undefined){bg.piece=null}if(bg.newNameAngle===undefined){bg.newNameAngle=0}bg.controller=bb;bg.oldNameAngle=bf;bg.piece=bd;bg.newNameAngle=be;return bg}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.piece.setNameAngle(this.oldNameAngle);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.piece.setNameAngle(this.newNameAngle);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return ba}(LocalizedUndoableEdit));ai.PieceOfFurnitureNameRotationUndoableEdit=ad;ad.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameRotationUndoableEdit";ad.__interfaces=["javax.swing.undo.UndoableEdit"];var aX=(function(ba){__extends(a9,ba);function a9(bf,be,bj,bi,bh,bb,bk,bc,bd){var bg=ba.call(this,be,ai,"undoDimensionLineResizeName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldX===undefined){bg.oldX=0}if(bg.oldY===undefined){bg.oldY=0}if(bg.dimensionLine===undefined){bg.dimensionLine=null}if(bg.newX===undefined){bg.newX=0}if(bg.newY===undefined){bg.newY=0}if(bg.startPoint===undefined){bg.startPoint=false}if(bg.reversed===undefined){bg.reversed=false}bg.controller=bf;bg.oldX=bj;bg.oldY=bi;bg.dimensionLine=bh;bg.newX=bb;bg.newY=bk;bg.startPoint=bc;bg.reversed=bd;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);if(this.reversed){ai.reverseDimensionLine(this.dimensionLine);ai.moveDimensionLinePoint(this.dimensionLine,this.oldX,this.oldY,!this.startPoint)}else{ai.moveDimensionLinePoint(this.dimensionLine,this.oldX,this.oldY,this.startPoint)}this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);if(this.reversed){ai.moveDimensionLinePoint(this.dimensionLine,this.newX,this.newY,!this.startPoint);ai.reverseDimensionLine(this.dimensionLine)}else{ai.moveDimensionLinePoint(this.dimensionLine,this.newX,this.newY,this.startPoint)}this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};return a9}(LocalizedUndoableEdit));ai.DimensionLineResizingUndoableEdit=aX;aX.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineResizingUndoableEdit";aX.__interfaces=["javax.swing.undo.UndoableEdit"];var au=(function(a9){__extends(ba,a9);function ba(bc,bd,be,bb,bg){var bf=a9.call(this,bd,ai,"undoDimensionLineOffsetName")||this;if(bf.controller===undefined){bf.controller=null}if(bf.oldOffset===undefined){bf.oldOffset=0}if(bf.dimensionLine===undefined){bf.dimensionLine=null}if(bf.newOffset===undefined){bf.newOffset=0}bf.controller=bc;bf.oldOffset=be;bf.dimensionLine=bb;bf.newOffset=bg;return bf}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.dimensionLine.setOffset(this.oldOffset);this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.dimensionLine.setOffset(this.newOffset);this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};return ba}(LocalizedUndoableEdit));ai.DimensionLineOffsetModificationUndoableEdit=au;au.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineOffsetModificationUndoableEdit";au.__interfaces=["javax.swing.undo.UndoableEdit"];var u=(function(ba){__extends(a9,ba);function a9(bd,bc,bi,bh,bg,bf,bb,bj){var be=ba.call(this,bc,ai,"undoPolylineResizeName")||this;if(be.controller===undefined){be.controller=null}if(be.oldX===undefined){be.oldX=0}if(be.oldY===undefined){be.oldY=0}if(be.polyline===undefined){be.polyline=null}if(be.pointIndex===undefined){be.pointIndex=0}if(be.newX===undefined){be.newX=0}if(be.newY===undefined){be.newY=0}be.controller=bd;be.oldX=bi;be.oldY=bh;be.polyline=bg;be.pointIndex=bf;be.newX=bb;be.newY=bj;return be}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.polyline.setPoint(this.oldX,this.oldY,this.pointIndex);this.controller.selectAndShowItems$java_util_List([this.polyline].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.polyline.setPoint(this.newX,this.newY,this.pointIndex);this.controller.selectAndShowItems$java_util_List([this.polyline].slice(0))};return a9}(LocalizedUndoableEdit));ai.PolylineResizingUndoableEdit=u;u.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineResizingUndoableEdit";u.__interfaces=["javax.swing.undo.UndoableEdit"];var g=(function(ba){__extends(a9,ba);function a9(bd,be,bc,bf,bb){var bg=ba.call(this,be,ai,"undoCompassRotationName")||this;if(bg.controller===undefined){bg.controller=null}if(bg.oldNorthDirection===undefined){bg.oldNorthDirection=0}if(bg.compass===undefined){bg.compass=null}if(bg.newNorthDirection===undefined){bg.newNorthDirection=0}bg.controller=bd;bg.compass=bf;bg.newNorthDirection=bb;bg.oldNorthDirection=bc;return bg}a9.prototype.undo=function(){ba.prototype.undo.call(this);this.compass.setNorthDirection(this.oldNorthDirection);this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))};a9.prototype.redo=function(){ba.prototype.redo.call(this);this.compass.setNorthDirection(this.newNorthDirection);this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))};return a9}(LocalizedUndoableEdit));ai.CompassRotationUndoableEdit=g;g.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassRotationUndoableEdit";g.__interfaces=["javax.swing.undo.UndoableEdit"];var am=(function(a9){__extends(ba,a9);function ba(bc,bd,bg,be,bb){var bf=a9.call(this,bd,ai,"undoCompassResizeName")||this;if(bf.controller===undefined){bf.controller=null}if(bf.oldDiameter===undefined){bf.oldDiameter=0}if(bf.compass===undefined){bf.compass=null}if(bf.newDiameter===undefined){bf.newDiameter=0}bf.controller=bc;bf.oldDiameter=bg;bf.compass=be;bf.newDiameter=bb;return bf}ba.prototype.undo=function(){a9.prototype.undo.call(this);this.compass.setDiameter(this.oldDiameter);this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))};ba.prototype.redo=function(){a9.prototype.redo.call(this);this.compass.setDiameter(this.newDiameter);this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))};return ba}(LocalizedUndoableEdit));ai.CompassResizingUndoableEdit=am;am.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassResizingUndoableEdit";am.__interfaces=["javax.swing.undo.UndoableEdit"];var aS=(function(){function a9(bc){if(this.piece===undefined){this.piece=null}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.doorOrWindowBoundToWall===undefined){this.doorOrWindowBoundToWall=false}if(this.groupFurnitureX===undefined){this.groupFurnitureX=null}if(this.groupFurnitureY===undefined){this.groupFurnitureY=null}if(this.groupFurnitureWidth===undefined){this.groupFurnitureWidth=null}if(this.groupFurnitureDepth===undefined){this.groupFurnitureDepth=null}if(this.groupFurnitureHeight===undefined){this.groupFurnitureHeight=null}this.piece=bc;this.x=bc.getX();this.y=bc.getY();this.width=bc.getWidth();this.depth=bc.getDepth();this.height=bc.getHeight();this.doorOrWindowBoundToWall=(bc!=null&&bc instanceof HomeDoorOrWindow)&&bc.isBoundToWall();if(bc!=null&&bc instanceof HomeFurnitureGroup){var ba=bc.getAllFurniture();this.groupFurnitureX=(function(bf){var be=[];while(bf-->0){be.push(0)}return be})(ba.length);this.groupFurnitureY=(function(bf){var be=[];while(bf-->0){be.push(0)}return be})(ba.length);this.groupFurnitureWidth=(function(bf){var be=[];while(bf-->0){be.push(0)}return be})(ba.length);this.groupFurnitureDepth=(function(bf){var be=[];while(bf-->0){be.push(0)}return be})(ba.length);this.groupFurnitureHeight=(function(bf){var be=[];while(bf-->0){be.push(0)}return be})(ba.length);for(var bb=0;bb<ba.length;bb++){var bd=ba[bb];this.groupFurnitureX[bb]=bd.getX();this.groupFurnitureY[bb]=bd.getY();this.groupFurnitureWidth[bb]=bd.getWidth();this.groupFurnitureDepth[bb]=bd.getDepth();this.groupFurnitureHeight[bb]=bd.getHeight()}}else{this.groupFurnitureX=null;this.groupFurnitureY=null;this.groupFurnitureWidth=null;this.groupFurnitureDepth=null;this.groupFurnitureHeight=null}}a9.prototype.getPieceOfFurniture=function(){return this.piece};a9.prototype.getWidth=function(){return this.width};a9.prototype.getDepth=function(){return this.depth};a9.prototype.getHeight=function(){return this.height};a9.prototype.isDoorOrWindowBoundToWall=function(){return this.doorOrWindowBoundToWall};a9.prototype.reset=function(){this.piece.setX(this.x);this.piece.setY(this.y);a9.setPieceOfFurnitureSize(this.piece,this.width,this.depth,this.height);if(this.piece!=null&&this.piece instanceof HomeDoorOrWindow){this.piece.setBoundToWall(this.doorOrWindowBoundToWall)}if(this.piece!=null&&this.piece instanceof HomeFurnitureGroup){var ba=this.piece.getAllFurniture();for(var bb=0;bb<ba.length;bb++){var bc=ba[bb];if(this.piece.isResizable()){bc.setX(this.groupFurnitureX[bb]);bc.setY(this.groupFurnitureY[bb]);a9.setPieceOfFurnitureSize(bc,this.groupFurnitureWidth[bb],this.groupFurnitureDepth[bb],this.groupFurnitureHeight[bb])}}}};a9.setPieceOfFurnitureSize=function(bk,bb,be,bj){if(bk.isHorizontallyRotated()){var bc=bb/bk.getWidth();bk.scale(bc);bk.setWidthInPlan(bc*bk.getWidthInPlan());bk.setDepthInPlan(bc*bk.getDepthInPlan());bk.setHeightInPlan(bc*bk.getHeightInPlan());if(bk!=null&&bk instanceof HomeFurnitureGroup){var bg=bk.getAllFurniture();for(var bf=0;bf<bg.length;bf++){var bi=bg[bf];bi.setWidthInPlan(bc*bi.getWidthInPlan());bi.setDepthInPlan(bc*bi.getDepthInPlan());bi.setHeightInPlan(bc*bi.getHeightInPlan())}}}else{var bh=bk.getWidthInPlan()*bb/bk.getWidth();bk.setWidth(bb);bk.setWidthInPlan(bh);var ba=bk.getDepthInPlan()*be/bk.getDepth();bk.setDepth(be);bk.setDepthInPlan(ba);var bd=bk.getHeightInPlan()*bj/bk.getHeight();bk.setHeight(bj);bk.setHeightInPlan(bd);if(bk!=null&&bk instanceof HomeFurnitureGroup){var bg=bk.getAllFurniture();for(var bf=0;bf<bg.length;bf++){var bi=bg[bf];bi.setWidthInPlan(bi.getWidth());bi.setDepthInPlan(bi.getDepth());bi.setHeightInPlan(bi.getHeight())}}}};return a9}());ai.ResizedPieceOfFurniture=aS;aS.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ResizedPieceOfFurniture";var ap=(function(){function a9(ba){if(this.wall===undefined){this.wall=null}if(this.level===undefined){this.level=null}if(this.xStart===undefined){this.xStart=0}if(this.yStart===undefined){this.yStart=0}if(this.xEnd===undefined){this.xEnd=0}if(this.yEnd===undefined){this.yEnd=0}if(this.wallAtStart===undefined){this.wallAtStart=null}if(this.wallAtEnd===undefined){this.wallAtEnd=null}if(this.joinedAtEndOfWallAtStart===undefined){this.joinedAtEndOfWallAtStart=false}if(this.joinedAtStartOfWallAtEnd===undefined){this.joinedAtStartOfWallAtEnd=false}this.wall=ba;this.level=ba.getLevel();this.xStart=ba.getXStart();this.xEnd=ba.getXEnd();this.yStart=ba.getYStart();this.yEnd=ba.getYEnd();this.wallAtStart=ba.getWallAtStart();this.joinedAtEndOfWallAtStart=this.wallAtStart!=null&&this.wallAtStart.getWallAtEnd()===ba;this.wallAtEnd=ba.getWallAtEnd();this.joinedAtStartOfWallAtEnd=this.wallAtEnd!=null&&this.wallAtEnd.getWallAtStart()===ba}a9.prototype.getWall=function(){return this.wall};a9.prototype.getLevel=function(){return this.level};a9.prototype.getXStart=function(){return this.xStart};a9.prototype.getYStart=function(){return this.yStart};a9.prototype.getXEnd=function(){return this.xEnd};a9.prototype.getYEnd=function(){return this.yEnd};a9.prototype.getWallAtEnd=function(){return this.wallAtEnd};a9.prototype.getWallAtStart=function(){return this.wallAtStart};a9.prototype.isJoinedAtEndOfWallAtStart=function(){return this.joinedAtEndOfWallAtStart};a9.prototype.isJoinedAtStartOfWallAtEnd=function(){return this.joinedAtStartOfWallAtEnd};a9.getJoinedWalls=function(ba){var bc=(function(be){var bd=[];while(be-->0){bd.push(null)}return bd})(ba.length);for(var bb=0;bb<bc.length;bb++){bc[bb]=new ai.JoinedWall(ba[bb])}return bc};a9.getWalls=function(bc){var ba=(function(be){var bd=[];while(be-->0){bd.push(null)}return bd})(bc.length);for(var bb=0;bb<bc.length;bb++){ba[bb]=bc[bb].getWall()}return ba.slice(0)};return a9}());ai.JoinedWall=ap;ap.__class="com.eteks.sweethome3d.viewcontroller.PlanController.JoinedWall";var a7=(function(){function a9(bg,bj,bo,bm,bq,bn,bv){if(((typeof bg==="number")||bg===null)&&((typeof bj==="number")||bj===null)&&((typeof bo==="number")||bo===null)&&((typeof bm==="number")||bm===null)&&((bq!=null)||bq===null)&&((typeof bn==="number")||bn===null)&&((typeof bv==="number")||bv===null)){var bh=arguments;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.angle===undefined){this.angle=0}this.x=bo;this.y=bm;if(bg===bo){var br=bq.getMagnetizedLength(Math.abs(bj-bm),bn);this.y=bj+(br*(function(bz){if(bz>0){return 1}else{if(bz<0){return -1}else{return 0}}})(bm-bj))}else{if(bj===bm){var br=bq.getMagnetizedLength(Math.abs(bg-bo),bn);this.x=bg+(br*(function(bz){if(bz>0){return 1}else{if(bz<0){return -1}else{return 0}}})(bo-bg))}else{var bp=2*Math.PI/bv;var by=Math.atan2(bj-bm,bo-bg);var bk=Math.floor(by/bp)*bp;var bc=void 0;var bt=void 0;var ba=void 0;var bs=void 0;if(Math.tan(by)>0){bc=bk;bt=Math.tan(bk);ba=bk+bp;bs=Math.tan(bk+bp)}else{bc=bk+bp;bt=Math.tan(bk+bp);ba=bk;bs=Math.tan(bk)}var bl=Math.abs(bt);var bi=Math.abs(bs);var be=Math.abs(bg-bo);var bu=Math.abs(bj-bm);var bd=0;if(bi>1e-10){bd=(bu/bi)}var bw=0;if(bl<10000000000){bw=(be*bl)}var bx=void 0;if(Math.abs(bd-be)<Math.abs(bw-bu)){bx=ba;this.x=bg+((bj-bm)/bs)}else{bx=bc;this.y=bj-((bo-bg)*bt)}var br=bq.getMagnetizedLength(java.awt.geom.Point2D.distance(bg,bj,this.x,this.y),bn);this.x=bg+(br*Math.cos(bx));this.y=bj-(br*Math.sin(bx));this.angle=bx}}}else{if(((typeof bg==="number")||bg===null)&&((typeof bj==="number")||bj===null)&&((typeof bo==="number")||bo===null)&&((typeof bm==="number")||bm===null)&&((bq!=null)||bq===null)&&((typeof bn==="number")||bn===null)&&bv===undefined){var bh=arguments;var bf=arguments;var bb=a9.CIRCLE_STEPS_15_DEG;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.angle===undefined){this.angle=0}this.x=bo;this.y=bm;if(bg===bo){var br=bq.getMagnetizedLength(Math.abs(bj-bm),bn);this.y=bj+(br*(function(bz){if(bz>0){return 1}else{if(bz<0){return -1}else{return 0}}})(bm-bj))}else{if(bj===bm){var br=bq.getMagnetizedLength(Math.abs(bg-bo),bn);this.x=bg+(br*(function(bz){if(bz>0){return 1}else{if(bz<0){return -1}else{return 0}}})(bo-bg))}else{var bp=2*Math.PI/bb;var by=Math.atan2(bj-bm,bo-bg);var bk=Math.floor(by/bp)*bp;var bc=void 0;var bt=void 0;var ba=void 0;var bs=void 0;if(Math.tan(by)>0){bc=bk;bt=Math.tan(bk);ba=bk+bp;bs=Math.tan(bk+bp)}else{bc=bk+bp;bt=Math.tan(bk+bp);ba=bk;bs=Math.tan(bk)}var bl=Math.abs(bt);var bi=Math.abs(bs);var be=Math.abs(bg-bo);var bu=Math.abs(bj-bm);var bd=0;if(bi>1e-10){bd=(bu/bi)}var bw=0;if(bl<10000000000){bw=(be*bl)}var bx=void 0;if(Math.abs(bd-be)<Math.abs(bw-bu)){bx=ba;this.x=bg+((bj-bm)/bs)}else{bx=bc;this.y=bj-((bo-bg)*bt)}var br=bq.getMagnetizedLength(java.awt.geom.Point2D.distance(bg,bj,this.x,this.y),bn);this.x=bg+(br*Math.cos(bx));this.y=bj-(br*Math.sin(bx));this.angle=bx}}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.angle===undefined){this.angle=0}}else{throw new Error("invalid overload")}}}a9.prototype.getX=function(){return this.x};a9.prototype.setX=function(ba){this.x=ba};a9.prototype.getY=function(){return this.y};a9.prototype.setY=function(ba){this.y=ba};a9.prototype.getAngle=function(){return this.angle};a9.CIRCLE_STEPS_15_DEG=24;return a9}());ai.PointWithAngleMagnetism=a7;a7.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PointWithAngleMagnetism";var aL=(function(){function a9(bd,bk,bi,bo,bn){if(((bk!=null&&bk instanceof Room)||bk===null)&&((typeof bi==="number")||bi===null)&&((typeof bo==="number")||bo===null)&&((typeof bn==="number")||bn===null)){var bh=Array.prototype.slice.call(arguments,[1]);if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.magnetized===undefined){this.magnetized=false}var be=bd.getSelectionMargin();var bp=1.7976931348623157e+308;var bj=bd.getRoomPathsFromWalls();for(var bg=0;bg<bj.length;bg++){var bf=bj[bg];bp=this.updateMagnetizedPoint(-1,bo,bn,bp,bd.getPathPoints(bf,false))}var bj=bd.getDetectableRoomsAtSelectedLevel();for(var bg=0;bg<bj.length;bg++){var ba=bj[bg];bp=this.updateMagnetizedPoint(ba===bk?bi:-1,bo,bn,bp,ba.getPoints())}this.magnetized=bp<=be*be;if(!this.magnetized){this.x=bo;this.y=bn}}else{if(((typeof bk==="number")||bk===null)&&((typeof bi==="number")||bi===null)&&bo===undefined&&bn===undefined){var bh=Array.prototype.slice.call(arguments,[1]);var bm=bh[0];var bq=bh[1];var bb=Array.prototype.slice.call(arguments,[1]);var bl=null;var bc=-1;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.magnetized===undefined){this.magnetized=false}var be=bd.getSelectionMargin();var bp=1.7976931348623157e+308;var bj=bd.getRoomPathsFromWalls();for(var bg=0;bg<bj.length;bg++){var bf=bj[bg];bp=this.updateMagnetizedPoint(-1,bm,bq,bp,bd.getPathPoints(bf,false))}var bj=bd.getDetectableRoomsAtSelectedLevel();for(var bg=0;bg<bj.length;bg++){var ba=bj[bg];bp=this.updateMagnetizedPoint(ba===bl?bc:-1,bm,bq,bp,ba.getPoints())}this.magnetized=bp<=be*be;if(!this.magnetized){this.x=bm;this.y=bq}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.magnetized===undefined){this.magnetized=false}}else{throw new Error("invalid overload")}}}a9.prototype.updateMagnetizedPoint=function(be,ba,bg,bb,bd){for(var bc=0;bc<bd.length;bc++){if(bc!==be){var bf=java.awt.geom.Point2D.distanceSq(bd[bc][0],bd[bc][1],ba,bg);if(bf<bb){this.x=bd[bc][0];this.y=bd[bc][1];bb=bf}}}return bb};a9.prototype.getX=function(){return this.x};a9.prototype.getY=function(){return this.y};a9.prototype.isMagnetized=function(){return this.magnetized};return a9}());ai.PointMagnetizedToClosestWallOrRoomPoint=aL;aL.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PointMagnetizedToClosestWallOrRoomPoint";var y=(function(){function a9(){}a9.prototype.enter=function(){};a9.prototype.exit=function(){};a9.prototype.setMode=function(ba){};a9.prototype.isModificationState=function(){return false};a9.prototype.isBasePlanModificationState=function(){return false};a9.prototype.deleteSelection=function(){};a9.prototype.escape=function(){};a9.prototype.moveSelection=function(bb,ba){};a9.prototype.toggleMagnetism=function(ba){};a9.prototype.setAlignmentActivated=function(ba){};a9.prototype.setDuplicationActivated=function(ba){};a9.prototype.setEditionActivated=function(ba){};a9.prototype.updateEditableProperty=function(ba,bb){};a9.prototype.pressMouse=function(bb,be,ba,bc,bd){};a9.prototype.releaseMouse=function(ba,bb){};a9.prototype.moveMouse=function(ba,bb){};a9.prototype.zoom=function(ba){};return a9}());ai.ControllerState=y;y.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ControllerState";var M=(function(a9){__extends(ba,a9);function ba(bd,bt,bb,bm,bh,bg){var bk=a9.call(this,bb,bm,bh,bg,bd.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bd.getView().getPixelLength())||this;bk.__parent=bd;var bj=ai.PIXEL_MARGIN/bd.getScale();var bp=Infinity;var bs=Infinity;var bi=0;var bl=0;var bf=bd.getDetectableWallsAtSelectedLevel();for(var be=0;be<bf.length;be++){var bn=bf[be];if(bn!==bt){if(Math.abs(bk.getX()-bn.getXStart())<bj&&(bt==null||!bk.equalsWallPoint(bn.getXStart(),bn.getYStart(),bt))){if(Math.abs(bs)>Math.abs(bk.getY()-bn.getYStart())){bi=bn.getXStart();bs=bk.getY()-bl}}else{if(Math.abs(bk.getX()-bn.getXEnd())<bj&&(bt==null||!bk.equalsWallPoint(bn.getXEnd(),bn.getYEnd(),bt))){if(Math.abs(bs)>Math.abs(bk.getY()-bn.getYEnd())){bi=bn.getXEnd();bs=bk.getY()-bl}}}if(Math.abs(bk.getY()-bn.getYStart())<bj&&(bt==null||!bk.equalsWallPoint(bn.getXStart(),bn.getYStart(),bt))){if(Math.abs(bp)>Math.abs(bk.getX()-bn.getXStart())){bl=bn.getYStart();bp=bk.getX()-bi}}else{if(Math.abs(bk.getY()-bn.getYEnd())<bj&&(bt==null||!bk.equalsWallPoint(bn.getXEnd(),bn.getYEnd(),bt))){if(Math.abs(bp)>Math.abs(bk.getX()-bn.getXEnd())){bl=bn.getYEnd();bp=bk.getX()-bi}}}}}if(bt!=null){var bc=-Math.tan(bk.getAngle());var br=Math.abs(bc)<10000000000?bm-bc*bb:Infinity;if(bp!==Infinity&&Math.abs(bc)>1e-10){var bq=((bl-br)/bc);if(java.awt.geom.Point2D.distanceSq(bk.getX(),bk.getY(),bq,bl)<=bj*bj){bk.setX(bq);bk.setY(bl);return bk}}if(bs!==Infinity&&br!==Infinity){var bo=(bc*bi+br);if(java.awt.geom.Point2D.distanceSq(bk.getX(),bk.getY(),bi,bo)<=bj*bj){bk.setX(bi);bk.setY(bo)}}}else{if(bp!==Infinity){bk.setY(bl)}if(bs!==Infinity){bk.setX(bi)}}return bk}ba.prototype.equalsWallPoint=function(bc,bd,bb){return bc===bb.getXStart()&&bd===bb.getYStart()||bc===bb.getXEnd()&&bd===bb.getYEnd()};return ba}(ai.PointWithAngleMagnetism));ai.WallPointWithAngleMagnetism=M;M.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallPointWithAngleMagnetism";var h=(function(a9){__extends(ba,a9);function ba(bf,bz,by,bd,bp,bk,bj){var bo=a9.call(this,bd,bp,bk,bj,bf.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bf.getView().getPixelLength())||this;bo.__parent=bf;var br=bf.getScale();var bm=ai.PIXEL_MARGIN/br;var bs=Infinity;var bc=Infinity;var bi=0;var bl=0;var bh=bf.getDetectableRoomsAtSelectedLevel();for(var bg=0;bg<bh.length;bg++){var bu=bh[bg];var bn=bu.getPoints();for(var bq=0;bq<bn.length;bq++){if(by===-1||(bq!==by&&bn.length>2)){if(Math.abs(bo.getX()-bn[bq][0])<bm&&Math.abs(bc)>Math.abs(bo.getY()-bn[bq][1])){bi=bn[bq][0];bc=bo.getY()-bn[bq][1]}if(Math.abs(bo.getY()-bn[bq][1])<bm&&Math.abs(bs)>Math.abs(bo.getX()-bn[bq][0])){bl=bn[bq][1];bs=bo.getX()-bn[bq][0]}}}}var bh=bf.getDetectableWallsAtSelectedLevel();for(var bg=0;bg<bh.length;bg++){var bt=bh[bg];var bb=bt.getPoints$();bb=[bb[0],bb[(bb.length/2|0)-1],bb[(bb.length/2|0)],bb[bb.length-1]];for(var bq=0;bq<bb.length;bq++){if(Math.abs(bo.getX()-bb[bq][0])<bm&&Math.abs(bc)>Math.abs(bo.getY()-bb[bq][1])){bi=bb[bq][0];bc=bo.getY()-bb[bq][1]}if(Math.abs(bo.getY()-bb[bq][1])<bm&&Math.abs(bs)>Math.abs(bo.getX()-bb[bq][0])){bl=bb[bq][1];bs=bo.getX()-bb[bq][0]}}}if(bz!=null){var be=-Math.tan(bo.getAngle());var bx=Math.abs(be)<10000000000?bp-be*bd:Infinity;if(bs!==Infinity&&Math.abs(be)>1e-10){var bw=((bl-bx)/be);if(java.awt.geom.Point2D.distanceSq(bo.getX(),bo.getY(),bw,bl)<=bm*bm){bo.setX(bw);bo.setY(bl);return bo}}if(bc!==Infinity&&bx!==Infinity){var bv=(be*bi+bx);if(java.awt.geom.Point2D.distanceSq(bo.getX(),bo.getY(),bi,bv)<=bm*bm){bo.setX(bi);bo.setY(bv)}}}else{if(bs!==Infinity){bo.setY(bl)}if(bc!==Infinity){bo.setX(bi)}}return bo}return ba}(ai.PointWithAngleMagnetism));ai.RoomPointWithAngleMagnetism=h;h.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomPointWithAngleMagnetism";var a2=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;if(bc.state===undefined){bc.state=null}bc.state=bb;return bc}ba.prototype.enter=function(){this.state.enter()};ba.prototype.exit=function(){this.state.exit()};ba.prototype.getMode=function(){return this.state.getMode()};ba.prototype.setMode=function(bb){this.state.setMode(bb)};ba.prototype.isModificationState=function(){return this.state.isModificationState()};ba.prototype.isBasePlanModificationState=function(){return this.state.isBasePlanModificationState()};ba.prototype.deleteSelection=function(){this.state.deleteSelection()};ba.prototype.escape=function(){this.state.escape()};ba.prototype.moveSelection=function(bc,bb){this.state.moveSelection(bc,bb)};ba.prototype.toggleMagnetism=function(bb){this.state.toggleMagnetism(bb)};ba.prototype.setAlignmentActivated=function(bb){this.state.setAlignmentActivated(bb)};ba.prototype.setDuplicationActivated=function(bb){this.state.setDuplicationActivated(bb)};ba.prototype.setEditionActivated=function(bb){this.state.setEditionActivated(bb)};ba.prototype.updateEditableProperty=function(bb,bc){this.state.updateEditableProperty(bb,bc)};ba.prototype.pressMouse=function(bc,bf,bb,bd,be){this.state.pressMouse(bc,bf,bb,bd,be)};ba.prototype.releaseMouse=function(bb,bc){this.state.releaseMouse(bb,bc)};ba.prototype.moveMouse=function(bb,bc){this.state.moveMouse(bb,bc)};ba.prototype.zoom=function(bb){this.state.zoom(bb)};return ba}(ai.ControllerState));ai.ControllerStateDecorator=a2;a2.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ControllerStateDecorator";var aB=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;return bc}a9.prototype.setMode=function(bb){if(bb===ai.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bb===ai.Mode.PANNING_$LI$()){this.__parent.setState(this.__parent.getPanningState())}else{if(bb===ai.Mode.WALL_CREATION_$LI$()){this.__parent.setState(this.__parent.getWallCreationState())}else{if(bb===ai.Mode.ROOM_CREATION_$LI$()){this.__parent.setState(this.__parent.getRoomCreationState())}else{if(bb===ai.Mode.POLYLINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getPolylineCreationState())}else{if(bb===ai.Mode.DIMENSION_LINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getDimensionLineCreationState())}else{if(bb===ai.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}}};a9.prototype.deleteSelection=function(){this.__parent.deleteItems(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems());this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.moveSelection=function(bc,bb){this.__parent.moveAndShowSelectedItems(bc,bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.zoom=function(bb){this.__parent.setScale(this.__parent.getScale()*bb)};return a9}(ai.ControllerState));ai.AbstractModeChangeState=aB;aB.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractModeChangeState";var ax=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.xLastMouseMove===undefined){bc.xLastMouseMove=0}if(bc.yLastMouseMove===undefined){bc.yLastMouseMove=0}if(bc.mouseMoved===undefined){bc.mouseMoved=false}if(bc.oldSelection===undefined){bc.oldSelection=null}if(bc.selectionUpdateNeeded===undefined){bc.selectionUpdateNeeded=false}if(bc.movedItems===undefined){bc.movedItems=null}if(bc.duplicatedItems===undefined){bc.duplicatedItems=null}if(bc.movedPieceOfFurniture===undefined){bc.movedPieceOfFurniture=null}if(bc.angleMovedPieceOfFurniture===undefined){bc.angleMovedPieceOfFurniture=0}if(bc.depthMovedPieceOfFurniture===undefined){bc.depthMovedPieceOfFurniture=0}if(bc.elevationMovedPieceOfFurniture===undefined){bc.elevationMovedPieceOfFurniture=0}if(bc.xMovedPieceOfFurniture===undefined){bc.xMovedPieceOfFurniture=0}if(bc.yMovedPieceOfFurniture===undefined){bc.yMovedPieceOfFurniture=0}if(bc.movedDoorOrWindowBoundToWall===undefined){bc.movedDoorOrWindowBoundToWall=false}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.duplicationActivated===undefined){bc.duplicationActivated=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}if(bc.basePlanModification===undefined){bc.basePlanModification=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return this.basePlanModification};a9.prototype.enter=function(){this.xLastMouseMove=this.__parent.getXLastMousePress();this.yLastMouseMove=this.__parent.getYLastMousePress();this.mouseMoved=false;var bh=this.__parent.getSelectableItemsAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());var bb=(bh.slice(0));var bg=this.__parent.getSelectionMargin();for(var bd=0;bd<bh.length;bd++){var bi=bh[bd];if(bi!=null&&bi instanceof HomeFurnitureGroup){var be=bi.getAllFurniture();for(var bf=0;bf<be.length;bf++){var bj=be[bf];if(bj.containsPoint(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bg)){(bb.push(bj)>0)}}}}this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());this.selectionUpdateNeeded=(function(bm,bl){for(var bk=0;bk<bm.length;bk++){if(bl.indexOf(bm[bk])>=0){return false}}return true})(bb,this.oldSelection);if(this.selectionUpdateNeeded&&this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH){this.__parent.selectItem(this.__parent.getSelectableItemAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),false))}var bc=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.movedItems=([]);this.basePlanModification=false;for(var bd=0;bd<bc.length;bd++){var bi=bc[bd];if(this.__parent.isItemMovable(bi)){(this.movedItems.push(bi)>0);if(!this.basePlanModification&&this.__parent.isItemPartOfBasePlan(bi)){this.basePlanModification=true}}}if(this.movedItems.length===1&&(this.movedItems[0]!=null&&this.movedItems[0] instanceof HomePieceOfFurniture)){this.movedPieceOfFurniture=this.movedItems[0];this.xMovedPieceOfFurniture=this.movedPieceOfFurniture.getX();this.yMovedPieceOfFurniture=this.movedPieceOfFurniture.getY();this.angleMovedPieceOfFurniture=this.movedPieceOfFurniture.getAngle();this.depthMovedPieceOfFurniture=this.movedPieceOfFurniture.getDepth();this.elevationMovedPieceOfFurniture=this.movedPieceOfFurniture.getElevation();this.movedDoorOrWindowBoundToWall=(this.movedPieceOfFurniture!=null&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow)&&this.movedPieceOfFurniture.isBoundToWall()}this.duplicatedItems=null;this.duplicationActivated=this.__parent.wasDuplicationActivatedLastMousePress()&&!this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();if(!(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.selectionUpdateNeeded)){this.__parent.getView().setCursor(PlanView.CursorType.MOVE)}};a9.prototype.moveMouse=function(bb,bf){if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.selectionUpdateNeeded){this.__parent.setState(new a9.SelectionMoveState$0(this,this.__parent.getPanningState()))}else{if(!this.mouseMoved){this.toggleDuplication(this.duplicationActivated)}if(this.alignmentActivated){var bc=new ai.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bb,bf,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);bb=bc.getX();bf=bc.getY()}if(this.movedPieceOfFurniture!=null){this.movedPieceOfFurniture.setX(this.xMovedPieceOfFurniture);this.movedPieceOfFurniture.setY(this.yMovedPieceOfFurniture);this.movedPieceOfFurniture.setAngle(this.angleMovedPieceOfFurniture);if((this.movedPieceOfFurniture!=null&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow)&&this.movedPieceOfFurniture.isResizable()&&this.__parent.isItemResizable(this.movedPieceOfFurniture)){this.movedPieceOfFurniture.setDepth(this.depthMovedPieceOfFurniture)}this.movedPieceOfFurniture.setElevation(this.elevationMovedPieceOfFurniture);this.movedPieceOfFurniture.move(bb-this.__parent.getXLastMousePress(),bf-this.__parent.getYLastMousePress());if(this.magnetismEnabled&&!this.alignmentActivated){var be=this.__parent.adjustPieceOfFurnitureElevation(this.movedPieceOfFurniture)!=null;var bd=this.__parent.adjustPieceOfFurnitureOnWallAt(this.movedPieceOfFurniture,bb,bf,false);if(!be){this.__parent.adjustPieceOfFurnitureSideBySideAt(this.movedPieceOfFurniture,false,bd)}if(bd!=null){this.__parent.getView().setDimensionLinesFeedback(this.__parent.getDimensionLinesAlongWall(this.movedPieceOfFurniture,bd))}else{this.__parent.getView().setDimensionLinesFeedback(null)}}}else{this.__parent.moveItems(this.movedItems,bb-this.xLastMouseMove,bf-this.yLastMouseMove)}if(!this.mouseMoved){this.__parent.selectItems(this.movedItems,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())}this.__parent.getView().makePointVisible(bb,bf);this.xLastMouseMove=bb;this.yLastMouseMove=bf;this.mouseMoved=true}};a9.prototype.releaseMouse=function(bb,bd){if(this.mouseMoved){if(this.movedItems.length>0&&!(this.movedItems[0]!=null&&this.movedItems[0] instanceof Camera)){if(this.duplicatedItems!=null){this.__parent.postItemsDuplication(this.movedItems,this.duplicatedItems)}else{if(this.movedPieceOfFurniture!=null){this.__parent.postPieceOfFurnitureMove(this.movedPieceOfFurniture,this.movedPieceOfFurniture.getX()-this.xMovedPieceOfFurniture,this.movedPieceOfFurniture.getY()-this.yMovedPieceOfFurniture,this.angleMovedPieceOfFurniture,this.depthMovedPieceOfFurniture,this.elevationMovedPieceOfFurniture,this.movedDoorOrWindowBoundToWall)}else{this.__parent.postItemsMove(this.movedItems,this.oldSelection,this.xLastMouseMove-this.__parent.getXLastMousePress(),this.yLastMouseMove-this.__parent.getYLastMousePress())}}}}else{if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH||!(function(bg,bf){for(var be=0;be<bg.length;be++){if(bf.indexOf(bg[be])>=0){return false}}return true})(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.oldSelection)){var bc=this.__parent.getSelectableItemAt(bb,bd,false);if(bc!=null){this.__parent.selectItem(bc)}else{this.__parent.deselectAll()}}}this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);if(this.movedPieceOfFurniture!=null){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove());if(!this.magnetismEnabled){this.__parent.getView().deleteFeedback()}}};a9.prototype.escape=function(){if(this.mouseMoved){if(this.duplicatedItems!=null){this.__parent.doDeleteItems(this.movedItems);this.__parent.selectItems(this.duplicatedItems)}else{if(this.movedPieceOfFurniture!=null){this.movedPieceOfFurniture.setX(this.xMovedPieceOfFurniture);this.movedPieceOfFurniture.setY(this.yMovedPieceOfFurniture);this.movedPieceOfFurniture.setAngle(this.angleMovedPieceOfFurniture);if((this.movedPieceOfFurniture!=null&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow)&&this.movedPieceOfFurniture.isResizable()&&this.__parent.isItemResizable(this.movedPieceOfFurniture)){this.movedPieceOfFurniture.setDepth(this.depthMovedPieceOfFurniture)}this.movedPieceOfFurniture.setElevation(this.elevationMovedPieceOfFurniture);if(this.movedPieceOfFurniture!=null&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow){this.movedPieceOfFurniture.setBoundToWall(this.movedDoorOrWindowBoundToWall)}}else{this.__parent.moveItems(this.movedItems,this.__parent.getXLastMousePress()-this.xLastMouseMove,this.__parent.getYLastMousePress()-this.yLastMouseMove)}}}this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.setDuplicationActivated=function(bb){bb=!this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()&&bb;if(this.mouseMoved){this.toggleDuplication(bb)}this.duplicationActivated=bb};a9.prototype.setAlignmentActivated=function(bb){if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.selectionUpdateNeeded&&!this.duplicationActivated){this.__parent.setState(this.__parent.getSelectionState());this.__parent.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),1,true,false,false,false,this.__parent.getPointerTypeLastMousePress())}else{this.alignmentActivated=bb;if(this.mouseMoved){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}if(this.alignmentActivated){this.__parent.getView().deleteFeedback()}}};a9.prototype.toggleDuplication=function(bd){if(this.movedItems.length>1||(this.movedItems.length===1&&!(this.movedItems[0]!=null&&this.movedItems[0] instanceof Camera)&&!(this.movedItems[0]!=null&&this.movedItems[0] instanceof Compass))){if(bd&&this.duplicatedItems==null){this.duplicatedItems=this.movedItems;this.movedItems=([]);var be=Home.duplicate(this.duplicatedItems);for(var bb=0;bb<be.length;bb++){var bc=be[bb];if(bc!=null&&bc instanceof Wall){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(bc)}else{if(bc!=null&&bc instanceof Room){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room(bc)}else{if(bc!=null&&bc instanceof Polyline){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline(bc)}else{if(bc!=null&&bc instanceof DimensionLine){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(bc)}else{if(bc!=null&&bc instanceof HomePieceOfFurniture){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(bc)}else{if(bc!=null&&bc instanceof Label){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLabel(bc)}else{continue}}}}}}(this.movedItems.push(bc)>0)}if(this.movedPieceOfFurniture!=null){this.movedPieceOfFurniture.setX(this.xMovedPieceOfFurniture);this.movedPieceOfFurniture.setY(this.yMovedPieceOfFurniture);this.movedPieceOfFurniture.setAngle(this.angleMovedPieceOfFurniture);if((this.movedPieceOfFurniture!=null&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow)&&this.movedPieceOfFurniture.isResizable()&&this.__parent.isItemResizable(this.movedPieceOfFurniture)){this.movedPieceOfFurniture.setDepth(this.depthMovedPieceOfFurniture)}this.movedPieceOfFurniture.setElevation(this.elevationMovedPieceOfFurniture);this.movedPieceOfFurniture=this.movedItems[0]}else{this.__parent.moveItems(this.duplicatedItems,this.__parent.getXLastMousePress()-this.xLastMouseMove,this.__parent.getYLastMousePress()-this.yLastMouseMove)}this.__parent.getView().setCursor(PlanView.CursorType.DUPLICATION)}else{if(!bd&&this.duplicatedItems!=null){this.__parent.doDeleteItems(this.movedItems);this.__parent.moveItems(this.duplicatedItems,this.xLastMouseMove-this.__parent.getXLastMousePress(),this.yLastMouseMove-this.__parent.getYLastMousePress());this.movedItems=this.duplicatedItems;this.duplicatedItems=null;if(this.movedPieceOfFurniture!=null){this.movedPieceOfFurniture=this.movedItems[0]}this.__parent.getView().setCursor(PlanView.CursorType.MOVE)}}this.__parent.selectItems(this.movedItems,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())}};a9.prototype.exit=function(){this.__parent.getView().deleteFeedback();this.movedItems=null;this.duplicatedItems=null;this.movedPieceOfFurniture=null};return a9}(ai.ControllerState));ai.SelectionMoveState=ax;ax.__class="com.eteks.sweethome3d.viewcontroller.PlanController.SelectionMoveState";(function(ba){var a9=(function(bc){__extends(bb,bc);function bb(bd,be){var bf=bc.call(this,be)||this;bf.__parent=bd;return bf}bb.prototype.enter=function(){bc.prototype.enter.call(this);this.pressMouse(this.__parent.__parent.getXLastMousePress(),this.__parent.__parent.getYLastMousePress(),1,this.__parent.__parent.wasShiftDownLastMousePress(),this.__parent.__parent.wasDuplicationActivatedLastMousePress());this.moveMouse(this.__parent.__parent.getXLastMouseMove(),this.__parent.__parent.getYLastMouseMove())};bb.prototype.releaseMouse=function(bd,be){this.escape()};bb.prototype.escape=function(){bc.prototype.escape.call(this);this.__parent.__parent.setState(this.__parent.__parent.getSelectionState())};return bb}(ai.ControllerStateDecorator));ba.SelectionMoveState$0=a9})(ax=ai.SelectionMoveState||(ai.SelectionMoveState={}));var aQ=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.selectedItemsMousePressed===undefined){bc.selectedItemsMousePressed=null}if(bc.ignoreRectangleSelection===undefined){bc.ignoreRectangleSelection=false}if(bc.mouseMoved===undefined){bc.mouseMoved=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.enter=function(){var bc=this.__parent.getSelectableItemAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());if(bc==null&&!this.__parent.wasShiftDownLastMousePress()){this.__parent.deselectAll()}this.selectedItemsMousePressed=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0));var be=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();this.ignoreRectangleSelection=false;for(var bb=0;bb<this.selectedItemsMousePressed.length;bb++){var bd=this.selectedItemsMousePressed[bb];if((bd!=null&&bd instanceof HomePieceOfFurniture)&&!(be.indexOf((bd))>=0)){this.ignoreRectangleSelection=true;break}}this.mouseMoved=false};a9.prototype.moveMouse=function(bc,bd){this.mouseMoved=true;if(!this.ignoreRectangleSelection){this.updateSelectedItems(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bc,bd,this.selectedItemsMousePressed);var bb=this.__parent.getView();bb.setRectangleFeedback(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bc,bd);bb.makePointVisible(bc,bd)}};a9.prototype.releaseMouse=function(bb,bf){if(!this.mouseMoved){var bd=this.__parent.getSelectableItemAt(bb,bf,false);if(bd!=null){if((this.selectedItemsMousePressed.indexOf((bd))>=0)){(function(bg){var bh=bg.indexOf(bd);if(bh>=0){bg.splice(bh,1);return true}else{return false}})(this.selectedItemsMousePressed)}else{for(var bc=this.selectedItemsMousePressed.length-1;bc>=0;bc--){var be=this.selectedItemsMousePressed[bc];if((be!=null&&be instanceof Camera)||((bd!=null&&bd instanceof HomePieceOfFurniture)&&(be!=null&&be instanceof HomeFurnitureGroup)&&(be.getAllFurniture().indexOf((bd))>=0))||((bd!=null&&bd instanceof HomeFurnitureGroup)&&(be!=null&&be instanceof HomePieceOfFurniture)&&(bd.getAllFurniture().indexOf((be))>=0))){this.selectedItemsMousePressed.splice(bc,1)[0]}}if(!(bd!=null&&bd instanceof Camera)||this.selectedItemsMousePressed.length===0){(this.selectedItemsMousePressed.push(bd)>0)}}this.__parent.selectItems(this.selectedItemsMousePressed,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()&&this.__parent.wasShiftDownLastMousePress())}}this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.escape=function(){this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){this.__parent.getView().deleteFeedback();this.selectedItemsMousePressed=null};a9.prototype.updateSelectedItems=function(bd,bk,bc,bj,bi){var be;var bf=this.__parent.wasShiftDownLastMousePress();if(bf){be=(bi.slice(0))}else{be=([])}var bh=this.__parent.getSelectableItemsIntersectingRectangle(bd,bk,bc,bj);var bb=function(bl){var bm=bh[bl];if(!(bm!=null&&bm instanceof Camera)){if(bf){if((bi.indexOf((bm))>=0)){(function(bn){var bo=bn.indexOf(bm);if(bo>=0){bn.splice(bo,1);return true}else{return false}})(be)}else{(be.push(bm)>0)}}else{if(!(bi.indexOf((bm))>=0)){(be.push(bm)>0)}}}};for(var bg=0;bg<bh.length;bg++){bb(bg)}this.__parent.selectItems(be,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()&&bf)};return a9}(ai.ControllerState));ai.RectangleSelectionState=aQ;aQ.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RectangleSelectionState";var ak=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.xLastMouseMove===undefined){bc.xLastMouseMove=null}if(bc.yLastMouseMove===undefined){bc.yLastMouseMove=null}return bc}a9.prototype.getMode=function(){return ai.Mode.PANNING_$LI$()};a9.prototype.setMode=function(bb){if(bb===ai.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bb===ai.Mode.WALL_CREATION_$LI$()){this.__parent.setState(this.__parent.getWallCreationState())}else{if(bb===ai.Mode.ROOM_CREATION_$LI$()){this.__parent.setState(this.__parent.getRoomCreationState())}else{if(bb===ai.Mode.POLYLINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getPolylineCreationState())}else{if(bb===ai.Mode.DIMENSION_LINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getDimensionLineCreationState())}else{if(bb===ai.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}};a9.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.PANNING)};a9.prototype.moveSelection=function(bc,bb){this.__parent.getView().moveView(bc*10,bb*10)};a9.prototype.pressMouse=function(bc,bf,bb,bd,be){if(bb===1){this.xLastMouseMove=this.__parent.getView().convertXModelToScreen(bc);this.yLastMouseMove=this.__parent.getView().convertYModelToScreen(bf)}else{this.xLastMouseMove=null;this.yLastMouseMove=null}};a9.prototype.moveMouse=function(bb,be){if(this.xLastMouseMove!=null){var bd=this.__parent.getView().convertXModelToScreen(bb);var bc=this.__parent.getView().convertYModelToScreen(be);this.__parent.getView().moveView((this.xLastMouseMove-bd)/this.__parent.getScale(),(this.yLastMouseMove-bc)/this.__parent.getScale());this.xLastMouseMove=bd;this.yLastMouseMove=bc}};a9.prototype.releaseMouse=function(bb,bc){this.xLastMouseMove=null};a9.prototype.escape=function(){this.xLastMouseMove=null};a9.prototype.zoom=function(bb){this.__parent.setScale(this.__parent.getScale()*bb)};return a9}(ai.ControllerState));ai.PanningState=ak;ak.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PanningState";var a0=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.xLastMouseMove===undefined){bc.xLastMouseMove=0}if(bc.yLastMouseMove===undefined){bc.yLastMouseMove=0}if(bc.draggedPieceOfFurniture===undefined){bc.draggedPieceOfFurniture=null}if(bc.xDraggedPieceOfFurniture===undefined){bc.xDraggedPieceOfFurniture=0}if(bc.yDraggedPieceOfFurniture===undefined){bc.yDraggedPieceOfFurniture=0}if(bc.angleDraggedPieceOfFurniture===undefined){bc.angleDraggedPieceOfFurniture=0}if(bc.depthDraggedPieceOfFurniture===undefined){bc.depthDraggedPieceOfFurniture=0}if(bc.elevationDraggedPieceOfFurniture===undefined){bc.elevationDraggedPieceOfFurniture=0}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return false};a9.prototype.isBasePlanModificationState=function(){return this.draggedPieceOfFurniture!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.draggedPieceOfFurniture)};a9.prototype.enter=function(){this.xLastMouseMove=0;this.yLastMouseMove=0;this.__parent.getView().setDraggedItemsFeedback(this.__parent.draggedItems);if(this.__parent.draggedItems.length===1&&(this.__parent.draggedItems[0]!=null&&this.__parent.draggedItems[0] instanceof HomePieceOfFurniture)){this.draggedPieceOfFurniture=this.__parent.draggedItems[0];this.xDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getX();this.yDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getY();this.angleDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getAngle();this.depthDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getDepth();this.elevationDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getElevation()}};a9.prototype.moveMouse=function(bb,bf){var bc=(this.__parent.draggedItems.slice(0));this.__parent.moveItems(this.__parent.draggedItems,bb-this.xLastMouseMove,bf-this.yLastMouseMove);if(this.draggedPieceOfFurniture!=null&&this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()){this.draggedPieceOfFurniture.setX(this.xDraggedPieceOfFurniture);this.draggedPieceOfFurniture.setY(this.yDraggedPieceOfFurniture);this.draggedPieceOfFurniture.setAngle(this.angleDraggedPieceOfFurniture);if(this.draggedPieceOfFurniture.isResizable()){this.draggedPieceOfFurniture.setDepth(this.depthDraggedPieceOfFurniture);this.draggedPieceOfFurniture.setDepthInPlan(this.depthDraggedPieceOfFurniture)}this.draggedPieceOfFurniture.setElevation(this.elevationDraggedPieceOfFurniture);this.draggedPieceOfFurniture.move(bb,bf);var be=this.__parent.adjustPieceOfFurnitureElevation(this.draggedPieceOfFurniture)!=null;var bd=this.__parent.adjustPieceOfFurnitureOnWallAt(this.draggedPieceOfFurniture,bb,bf,true);if(!be){this.__parent.adjustPieceOfFurnitureSideBySideAt(this.draggedPieceOfFurniture,bd==null,bd)}if(bd!=null){this.__parent.getView().setDimensionLinesFeedback(this.__parent.getDimensionLinesAlongWall(this.draggedPieceOfFurniture,bd))}else{this.__parent.getView().setDimensionLinesFeedback(null)}}this.__parent.getView().setDraggedItemsFeedback(bc);this.xLastMouseMove=bb;this.yLastMouseMove=bf};a9.prototype.exit=function(){this.draggedPieceOfFurniture=null;this.__parent.getView().deleteFeedback()};return a9}(ai.ControllerState));ai.DragAndDropState=a0;a0.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DragAndDropState";var o=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.wallLengthToolTipFeedback===undefined){bc.wallLengthToolTipFeedback=null}if(bc.wallAngleToolTipFeedback===undefined){bc.wallAngleToolTipFeedback=null}if(bc.wallArcExtentToolTipFeedback===undefined){bc.wallArcExtentToolTipFeedback=null}if(bc.wallThicknessToolTipFeedback===undefined){bc.wallThicknessToolTipFeedback=null}return bc}a9.prototype.enter=function(){this.wallLengthToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"wallLengthToolTipFeedback");try{this.wallAngleToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"wallAngleToolTipFeedback")}catch(bb){}this.wallArcExtentToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"wallArcExtentToolTipFeedback");try{this.wallThicknessToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"wallThicknessToolTipFeedback")}catch(bb){}};a9.prototype.getToolTipFeedbackText=function(bb,bf){var be=bb.getArcExtent();if(!bf&&be!=null){return"<html>"+CoreTools.format(this.wallArcExtentToolTipFeedback,Math.round((function(bg){return bg*180/Math.PI})(be)))}else{var bd=bb.getStartPointToEndPointDistance();var bc="<html>"+CoreTools.format(this.wallLengthToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bd));if(this.wallAngleToolTipFeedback!=null&&this.wallAngleToolTipFeedback.length>0){bc+="<br>"+CoreTools.format(this.wallAngleToolTipFeedback,this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float(bb,bd))}if(this.wallThicknessToolTipFeedback!=null&&this.wallThicknessToolTipFeedback.length>0){bc+="<br>"+CoreTools.format(this.wallThicknessToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bb.getThickness()))}return bc}};a9.prototype.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall=function(bb){return this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float(bb,bb.getStartPointToEndPointDistance())};a9.prototype.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float=function(bg,bb){var bf=bg.getWallAtStart();if(bf!=null){var bi=bf.getStartPointToEndPointDistance();if(bb!==0&&bi!==0){var bj=(bg.getXEnd()-bg.getXStart())/bb;var bd=(bg.getYEnd()-bg.getYStart())/bb;var be=(bf.getXEnd()-bf.getXStart())/bi;var bc=(bf.getYEnd()-bf.getYStart())/bi;if(bf.getWallAtStart()===bg){be=-be;bc=-bc}var bh=(Math.round(180-(function(bk){return bk*180/Math.PI})(Math.atan2(bd*be-bj*bc,bj*be+bd*bc)))|0);if(bh>180){bh-=360}return bh}}if(bb===0){return 0}else{return(Math.round((function(bk){return bk*180/Math.PI})(Math.atan2(bg.getYStart()-bg.getYEnd(),bg.getXEnd()-bg.getXStart())))|0)}};a9.prototype.getWallAngleInDegrees=function(bb,bc){if(((bb!=null&&bb instanceof Wall)||bb===null)&&((typeof bc==="number")||bc===null)){return this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float(bb,bc)}else{if(((bb!=null&&bb instanceof Wall)||bb===null)&&bc===undefined){return this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(bb)}else{throw new Error("invalid overload")}}};a9.prototype.getArcExtent=function(bd,bk,bc,bj,bl,bi){var bf=this.getCircumscribedCircleCenter(bd,bk,bc,bj,bl,bi);var bh=java.awt.geom.Point2D.distance(bd,bk,bc,bj)/2;var bg=(function(bn){return Number.NEGATIVE_INFINITY===bn||Number.POSITIVE_INFINITY===bn})(bf[0])||(function(bn){return Number.NEGATIVE_INFINITY===bn||Number.POSITIVE_INFINITY===bn})(bf[1])?Infinity:java.awt.geom.Line2D.ptLineDist(bd,bk,bc,bj,bf[0],bf[1]);var bm=java.awt.geom.Line2D.relativeCCW(bd,bk,bc,bj,bl,bi);var bb=java.awt.geom.Line2D.relativeCCW(bd,bk,bc,bj,bf[0],bf[1]);var be;if(bb===bm){be=(Math.PI+2*Math.atan2(bg,bh))}else{be=(2*Math.atan2(bh,bg))}be=Math.min(be,3*Math.PI/2);be*=bm;return be};a9.prototype.getCircumscribedCircleCenter=function(bc,bi,bb,bh,bj,bg){var be=this.getBissectorLine(bc,bi,bb,bh);var bd=this.getBissectorLine(bc,bi,bj,bg);var bf=ai.computeIntersection(be[0],be[1],bd[0],bd[1]);return bf};a9.prototype.getBissectorLine=function(bd,bf,bc,be){var bg=(bd+bc)/2;var bb=(bf+be)/2;var bh=(bd-bc)/(be-bf);if(bh>10000000000){return[[bg,bb],[bg,bb+1]]}else{return[[bg,bb],[bg+1,bh+bb]]}};a9.prototype.showWallAngleFeedback=function(bb,be){var bd=bb.getArcExtent();if(!be&&bd!=null){if(bd<0){this.__parent.getView().setAngleFeedback(bb.getXArcCircleCenter(),bb.getYArcCircleCenter(),bb.getXStart(),bb.getYStart(),bb.getXEnd(),bb.getYEnd())}else{this.__parent.getView().setAngleFeedback(bb.getXArcCircleCenter(),bb.getYArcCircleCenter(),bb.getXEnd(),bb.getYEnd(),bb.getXStart(),bb.getYStart())}}else{if(this.wallAngleToolTipFeedback!=null&&this.wallAngleToolTipFeedback.length>0){var bc=bb.getWallAtStart();if(bc!=null){if(bc.getWallAtStart()===bb){if(this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(bb)>0){this.__parent.getView().setAngleFeedback(bb.getXStart(),bb.getYStart(),bc.getXEnd(),bc.getYEnd(),bb.getXEnd(),bb.getYEnd())}else{this.__parent.getView().setAngleFeedback(bb.getXStart(),bb.getYStart(),bb.getXEnd(),bb.getYEnd(),bc.getXEnd(),bc.getYEnd())}}else{if(this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(bb)>0){this.__parent.getView().setAngleFeedback(bb.getXStart(),bb.getYStart(),bc.getXStart(),bc.getYStart(),bb.getXEnd(),bb.getYEnd())}else{this.__parent.getView().setAngleFeedback(bb.getXStart(),bb.getYStart(),bb.getXEnd(),bb.getYEnd(),bc.getXStart(),bc.getYStart())}}}}}};return a9}(ai.ControllerState));ai.AbstractWallState=o;o.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractWallState";var c=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;bc.__parent=bb;if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}if(bc.selectedPiece===undefined){bc.selectedPiece=null}if(bc.angleMousePress===undefined){bc.angleMousePress=0}if(bc.oldAngle===undefined){bc.oldAngle=0}if(bc.doorOrWindowBoundToWall===undefined){bc.doorOrWindowBoundToWall=false}if(bc.rotationToolTipFeedback===undefined){bc.rotationToolTipFeedback=null}return bc}ba.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};ba.prototype.isModificationState=function(){return true};ba.prototype.isBasePlanModificationState=function(){return this.selectedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)};ba.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"rotationToolTipFeedback");this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedPiece.getY()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedPiece.getX());this.oldAngle=this.selectedPiece.getAngle();this.doorOrWindowBoundToWall=(this.selectedPiece!=null&&this.selectedPiece instanceof HomeDoorOrWindow)&&this.selectedPiece.isBoundToWall();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.oldAngle),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};ba.prototype.moveMouse=function(bc,bg){if(bc!==this.selectedPiece.getX()||bg!==this.selectedPiece.getY()){var bf=Math.atan2(this.selectedPiece.getY()-bg,bc-this.selectedPiece.getX());var be=this.oldAngle-bf+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var bd=2*Math.PI/ba.STEP_COUNT;be=Math.round(be/bd)*bd}this.selectedPiece.setAngle(be);var bb=this.__parent.getView();bb.makePointVisible(bc,bg);bb.setToolTipFeedback(this.getToolTipFeedbackText(be),bc,bg)}};ba.prototype.releaseMouse=function(bb,bc){this.__parent.postPieceOfFurnitureRotation(this.selectedPiece,this.oldAngle,this.doorOrWindowBoundToWall);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};ba.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};ba.prototype.escape=function(){this.selectedPiece.setAngle(this.oldAngle);if(this.selectedPiece!=null&&this.selectedPiece instanceof HomeDoorOrWindow){this.selectedPiece.setBoundToWall(this.doorOrWindowBoundToWall)}this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedPiece=null};ba.prototype.getToolTipFeedbackText=function(bb){return CoreTools.format(this.rotationToolTipFeedback,(Math.round((function(bc){return bc*180/Math.PI})(bb))+360)%360)};ba.STEP_COUNT=24;return ba}(ai.ControllerState));ai.PieceOfFurnitureRotationState=c;c.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRotationState";var aD=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;bc.__parent=bb;if(bc.selectedPiece===undefined){bc.selectedPiece=null}if(bc.oldPitch===undefined){bc.oldPitch=0}if(bc.oldWidthInPlan===undefined){bc.oldWidthInPlan=0}if(bc.oldDepthInPlan===undefined){bc.oldDepthInPlan=0}if(bc.oldHeightInPlan===undefined){bc.oldHeightInPlan=0}if(bc.pitchRotationToolTipFeedback===undefined){bc.pitchRotationToolTipFeedback=null}return bc}ba.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};ba.prototype.isModificationState=function(){return true};ba.prototype.isBasePlanModificationState=function(){return this.selectedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)};ba.prototype.enter=function(){this.pitchRotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"pitchRotationToolTipFeedback");this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldPitch=this.selectedPiece.getPitch();this.oldWidthInPlan=this.selectedPiece.getWidthInPlan();this.oldDepthInPlan=this.selectedPiece.getDepthInPlan();this.oldHeightInPlan=this.selectedPiece.getHeightInPlan();var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.oldPitch),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};ba.prototype.moveMouse=function(bb,bd){var bc=(this.oldPitch-(bd-this.__parent.getYLastMousePress())*Math.cos(this.selectedPiece.getAngle())*Math.PI/360+(bb-this.__parent.getXLastMousePress())*Math.sin(this.selectedPiece.getAngle())*Math.PI/360);if(Math.abs(bc)<1e-8){bc=0}this.selectedPiece.setPitch(bc);this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(bc),bb,bd)};ba.prototype.releaseMouse=function(bb,bc){this.__parent.postPieceOfFurniturePitchRotation(this.selectedPiece,this.oldPitch,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.escape=function(){this.selectedPiece.setPitch(this.oldPitch);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedPiece=null};ba.prototype.getToolTipFeedbackText=function(bb){return CoreTools.format(this.pitchRotationToolTipFeedback,(Math.round((function(bc){return bc*180/Math.PI})(bb))+360)%360)};return ba}(ai.ControllerState));ai.PieceOfFurniturePitchRotationState=aD;aD.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurniturePitchRotationState";var m=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;bc.__parent=bb;if(bc.selectedPiece===undefined){bc.selectedPiece=null}if(bc.oldRoll===undefined){bc.oldRoll=0}if(bc.oldWidthInPlan===undefined){bc.oldWidthInPlan=0}if(bc.oldDepthInPlan===undefined){bc.oldDepthInPlan=0}if(bc.oldHeightInPlan===undefined){bc.oldHeightInPlan=0}if(bc.rollRotationToolTipFeedback===undefined){bc.rollRotationToolTipFeedback=null}return bc}ba.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};ba.prototype.isModificationState=function(){return true};ba.prototype.isBasePlanModificationState=function(){return this.selectedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)};ba.prototype.enter=function(){this.rollRotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"rollRotationToolTipFeedback");this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldRoll=this.selectedPiece.getRoll();this.oldWidthInPlan=this.selectedPiece.getWidthInPlan();this.oldDepthInPlan=this.selectedPiece.getDepthInPlan();this.oldHeightInPlan=this.selectedPiece.getHeightInPlan();var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.oldRoll),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};ba.prototype.moveMouse=function(bb,bd){var bc=(this.oldRoll+(bd-this.__parent.getYLastMousePress())*Math.sin(this.selectedPiece.getAngle())*Math.PI/360+(bb-this.__parent.getXLastMousePress())*Math.cos(this.selectedPiece.getAngle())*Math.PI/360);if(Math.abs(bc)<1e-8){bc=0}this.selectedPiece.setRoll(bc);this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(bc),bb,bd)};ba.prototype.releaseMouse=function(bb,bc){this.__parent.postPieceOfFurnitureRollRotation(this.selectedPiece,this.oldRoll,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.escape=function(){this.selectedPiece.setRoll(this.oldRoll);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedPiece=null};ba.prototype.getToolTipFeedbackText=function(bb){return CoreTools.format(this.rollRotationToolTipFeedback,(Math.round((function(bc){return bc*180/Math.PI})(bb))+360)%360)};return ba}(ai.ControllerState));ai.PieceOfFurnitureRollRotationState=m;m.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRollRotationState";var U=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.deltaYToElevationPoint===undefined){bc.deltaYToElevationPoint=0}if(bc.selectedPiece===undefined){bc.selectedPiece=null}if(bc.oldElevation===undefined){bc.oldElevation=0}if(bc.elevationToolTipFeedback===undefined){bc.elevationToolTipFeedback=null}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return this.selectedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)};a9.prototype.enter=function(){this.elevationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"elevationToolTipFeedback");this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var bc=this.selectedPiece.getPoints()[1];this.deltaYToElevationPoint=this.__parent.getYLastMousePress()-bc[1];this.oldElevation=this.selectedPiece.getElevation();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.oldElevation),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};a9.prototype.moveMouse=function(bd,bg){var bc=this.__parent.getView();var bf=this.selectedPiece.getPoints()[1];var bb=bg-this.deltaYToElevationPoint-bf[1];var be=this.oldElevation-bb;be=Math.min(Math.max(be,0),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumElevation());if(this.magnetismEnabled){be=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(be,bc.getPixelLength())}this.selectedPiece.setElevation(be);bc.makePointVisible(bd,bg);bc.setToolTipFeedback(this.getToolTipFeedbackText(be),bd,bg)};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postPieceOfFurnitureElevation(this.selectedPiece,this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){this.selectedPiece.setElevation(this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedPiece=null};a9.prototype.getToolTipFeedbackText=function(bb){return CoreTools.format(this.elevationToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bb))};return a9}(ai.ControllerState));ai.PieceOfFurnitureElevationState=U;U.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureElevationState";var az=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;bc.__parent=bb;if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.deltaYToResizePoint===undefined){bc.deltaYToResizePoint=0}if(bc.resizedPiece===undefined){bc.resizedPiece=null}if(bc.topLeftPoint===undefined){bc.topLeftPoint=null}if(bc.resizePoint===undefined){bc.resizePoint=null}if(bc.resizeToolTipFeedback===undefined){bc.resizeToolTipFeedback=null}return bc}ba.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};ba.prototype.isModificationState=function(){return true};ba.prototype.isBasePlanModificationState=function(){return this.resizedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.resizedPiece.getPieceOfFurniture())};ba.prototype.enter=function(){this.resizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"heightResizeToolTipFeedback");var bd=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.resizedPiece=new ai.ResizedPieceOfFurniture(bd);var bc=bd.getPoints();this.resizePoint=bc[3];this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.resizePoint[1];this.topLeftPoint=bc[0];this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(bd.getHeight()),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};ba.prototype.moveMouse=function(bm,bk){var bh=this.__parent.getView();var bl=this.resizedPiece.getPieceOfFurniture();var bf=bk-this.deltaYToResizePoint-this.resizePoint[1];var bc=this.resizedPiece.getHeight()-bf;bc=Math.max(bc,0);if(this.magnetismEnabled){bc=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(bc,bh.getPixelLength())}bc=Math.min(Math.max(bc,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength());if(bl.isDeformable()&&!bl.isHorizontallyRotated()&&bl.getModelTransformations()==null){this.__parent.setPieceOfFurnitureSize(this.resizedPiece,this.resizedPiece.getWidth(),this.resizedPiece.getDepth(),bc)}else{var be=bc/this.resizedPiece.getHeight();var bg=this.resizedPiece.getWidth()*be;var bj=this.resizedPiece.getDepth()*be;var bd=bl.getAngle();var bn=Math.cos(bd);var bi=Math.sin(bd);var bb=(this.topLeftPoint[0]+(bg*bn-bj*bi)/2);var bo=(this.topLeftPoint[1]+(bg*bi+bj*bn)/2);bl.setX(bb);bl.setY(bo);this.__parent.setPieceOfFurnitureSize(this.resizedPiece,bg,bj,bc)}bh.makePointVisible(bm,bk);bh.setToolTipFeedback(this.getToolTipFeedbackText(bc),bm,bk)};ba.prototype.releaseMouse=function(bb,bc){this.__parent.postPieceOfFurnitureHeightResize(this.resizedPiece);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};ba.prototype.escape=function(){this.__parent.resetPieceOfFurnitureSize(this.resizedPiece);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.resizedPiece=null};ba.prototype.getToolTipFeedbackText=function(bb){return CoreTools.format(this.resizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bb))};return ba}(ai.ControllerState));ai.PieceOfFurnitureHeightState=az;az.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureHeightState";var at=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}if(bc.widthOrDepthResizingActivated===undefined){bc.widthOrDepthResizingActivated=false}if(bc.deltaXToResizePoint===undefined){bc.deltaXToResizePoint=0}if(bc.deltaYToResizePoint===undefined){bc.deltaYToResizePoint=0}if(bc.resizedPiece===undefined){bc.resizedPiece=null}if(bc.resizedPieceWidthInPlan===undefined){bc.resizedPieceWidthInPlan=0}if(bc.resizePoint===undefined){bc.resizePoint=null}if(bc.topLeftPoint===undefined){bc.topLeftPoint=null}if(bc.widthResizeToolTipFeedback===undefined){bc.widthResizeToolTipFeedback=null}if(bc.depthResizeToolTipFeedback===undefined){bc.depthResizeToolTipFeedback=null}if(bc.heightResizeToolTipFeedback===undefined){bc.heightResizeToolTipFeedback=null}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return this.resizedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.resizedPiece.getPieceOfFurniture())};a9.prototype.enter=function(){this.widthResizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"widthResizeToolTipFeedback");this.depthResizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"depthResizeToolTipFeedback");this.heightResizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"heightResizeToolTipFeedback");var bd=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.resizedPiece=new ai.ResizedPieceOfFurniture(bd);this.resizedPieceWidthInPlan=bd.getWidthInPlan();var bc=bd.getPoints();this.resizePoint=bc[2];this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.resizePoint[0];this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.resizePoint[1];this.topLeftPoint=bc[0];this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.widthOrDepthResizingActivated=this.__parent.wasDuplicationActivatedLastMousePress();var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(bd.getWidth(),bd.getDepth(),bd.getHeight()),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};a9.prototype.moveMouse=function(bn,bl){var bi=this.__parent.getView();var bm=this.resizedPiece.getPieceOfFurniture();var be=bm.getAngle();var bo=Math.cos(be);var bj=Math.sin(be);var bg=bn-this.deltaXToResizePoint-this.topLeftPoint[0];var bf=bl-this.deltaYToResizePoint-this.topLeftPoint[1];var bh=(bf*bj+bg*bo);if(this.magnetismEnabled){bh=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(bh,bi.getPixelLength())}bh=Math.min(Math.max(bh,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength());var bk=this.resizedPiece.getDepth();var bc=this.resizedPiece.getHeight();var bq=this.resizedPiece.isDoorOrWindowBoundToWall();if(this.isProprortionallyResized(bm)){var bd=bh/this.resizedPieceWidthInPlan;bh=this.resizedPiece.getWidth()*bd;bk=this.resizedPiece.getDepth()*bd;bc=this.resizedPiece.getHeight()*bd;bq=bk===this.resizedPiece.getDepth()}else{if(!bm.isWidthDepthDeformable()){bk=this.resizedPiece.getDepth()*bh/this.resizedPiece.getWidth()}else{if(!this.resizedPiece.isDoorOrWindowBoundToWall()||!this.magnetismEnabled||this.widthOrDepthResizingActivated){bk=(bf*bo-bg*bj);if(this.magnetismEnabled){bk=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(bk,bi.getPixelLength())}bk=Math.min(Math.max(bk,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength());bq=bk===this.resizedPiece.getDepth();if(this.widthOrDepthResizingActivated){if((function(br){if(br>0){return 1}else{if(br<0){return -1}else{return 0}}})(java.awt.geom.Line2D.relativeCCW(this.topLeftPoint[0],this.topLeftPoint[1],this.resizePoint[0],this.resizePoint[1],bn-this.deltaXToResizePoint,bl-this.deltaYToResizePoint))>=0){bk=this.resizedPiece.getDepth()}else{bh=this.resizedPiece.getWidth()}}}}}this.__parent.setPieceOfFurnitureSize(this.resizedPiece,bh,bk,bc);if(this.resizedPiece.isDoorOrWindowBoundToWall()){bm.setBoundToWall(this.magnetismEnabled&&bq)}var bb=(this.topLeftPoint[0]+(bm.getWidthInPlan()*bo-bm.getDepthInPlan()*bj)/2);var bp=(this.topLeftPoint[1]+(bm.getWidthInPlan()*bj+bm.getDepthInPlan()*bo)/2);bm.setX(bb);bm.setY(bp);bi.makePointVisible(bn,bl);bi.setToolTipFeedback(this.getToolTipFeedbackText(bh,bk,bc),bn,bl)};a9.prototype.isProprortionallyResized=function(bb){return !bb.isDeformable()||bb.isHorizontallyRotated()||bb.getModelTransformations()!=null||this.alignmentActivated};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postPieceOfFurnitureWidthAndDepthResize(this.resizedPiece);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setDuplicationActivated=function(bb){this.widthOrDepthResizingActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){this.__parent.resetPieceOfFurnitureSize(this.resizedPiece);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.resizedPiece=null};a9.prototype.getToolTipFeedbackText=function(bd,be,bb){var bc="<html>"+CoreTools.format(this.widthResizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bd));if(!(this.resizedPiece.getPieceOfFurniture()!=null&&this.resizedPiece.getPieceOfFurniture() instanceof HomeDoorOrWindow)||!this.resizedPiece.getPieceOfFurniture().isBoundToWall()||this.isProprortionallyResized(this.resizedPiece.getPieceOfFurniture())){bc+="<br>"+CoreTools.format(this.depthResizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(be))}if(this.isProprortionallyResized(this.resizedPiece.getPieceOfFurniture())){bc+="<br>"+CoreTools.format(this.heightResizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bb))}return bc};return a9}(ai.ControllerState));ai.PieceOfFurnitureResizeState=at;at.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureResizeState";var aV=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;bc.__parent=bb;if(bc.deltaXToModificationPoint===undefined){bc.deltaXToModificationPoint=0}if(bc.selectedLight===undefined){bc.selectedLight=null}if(bc.oldPower===undefined){bc.oldPower=0}if(bc.lightPowerToolTipFeedback===undefined){bc.lightPowerToolTipFeedback=null}return bc}ba.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};ba.prototype.isModificationState=function(){return true};ba.prototype.enter=function(){this.lightPowerToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"lightPowerToolTipFeedback");this.selectedLight=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var bc=this.selectedLight.getPoints()[3];this.deltaXToModificationPoint=this.__parent.getXLastMousePress()-bc[0];this.oldPower=this.selectedLight.getPower();var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.oldPower),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};ba.prototype.moveMouse=function(bc,bg){var bb=this.__parent.getView();var be=this.selectedLight.getPoints()[3];var bd=bc-this.deltaXToModificationPoint-be[0];var bf=this.oldPower+bd/100*this.__parent.getScale();bf=Math.min(Math.max(bf,0),1);this.selectedLight.setPower(bf);bb.makePointVisible(bc,bg);bb.setToolTipFeedback(this.getToolTipFeedbackText(bf),bc,bg)};ba.prototype.releaseMouse=function(bb,bc){this.__parent.postLightPowerModification(this.selectedLight,this.oldPower);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.escape=function(){this.selectedLight.setPower(this.oldPower);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedLight=null};ba.prototype.getToolTipFeedbackText=function(bb){return CoreTools.format(this.lightPowerToolTipFeedback,Math.round(bb*100))};return ba}(ai.ControllerState));ai.LightPowerModificationState=aV;aV.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LightPowerModificationState";var aA=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;bc.__parent=bb;if(bc.selectedPiece===undefined){bc.selectedPiece=null}if(bc.oldNameXOffset===undefined){bc.oldNameXOffset=0}if(bc.oldNameYOffset===undefined){bc.oldNameYOffset=0}if(bc.xLastMouseMove===undefined){bc.xLastMouseMove=0}if(bc.yLastMouseMove===undefined){bc.yLastMouseMove=0}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}ba.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};ba.prototype.isModificationState=function(){return true};ba.prototype.enter=function(){this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldNameXOffset=this.selectedPiece.getNameXOffset();this.oldNameYOffset=this.selectedPiece.getNameYOffset();this.xLastMouseMove=this.__parent.getXLastMousePress();this.yLastMouseMove=this.__parent.getYLastMousePress();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true)};ba.prototype.moveMouse=function(bb,bd){if(this.alignmentActivated){var bc=new ai.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bb,bd,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);bb=bc.getX();bd=bc.getY()}this.selectedPiece.setNameXOffset(this.selectedPiece.getNameXOffset()+bb-this.xLastMouseMove);this.selectedPiece.setNameYOffset(this.selectedPiece.getNameYOffset()+bd-this.yLastMouseMove);this.xLastMouseMove=bb;this.yLastMouseMove=bd;this.__parent.getView().makePointVisible(bb,bd)};ba.prototype.releaseMouse=function(bb,bc){this.__parent.postPieceOfFurnitureNameOffset(this.selectedPiece,this.oldNameXOffset,this.oldNameYOffset);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.escape=function(){this.selectedPiece.setNameXOffset(this.oldNameXOffset);this.selectedPiece.setNameYOffset(this.oldNameYOffset);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};ba.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedPiece=null};return ba}(ai.ControllerState));ai.PieceOfFurnitureNameOffsetState=aA;aA.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameOffsetState";var aP=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.selectedPiece===undefined){bc.selectedPiece=null}if(bc.oldNameAngle===undefined){bc.oldNameAngle=0}if(bc.angleMousePress===undefined){bc.angleMousePress=0}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.enter=function(){this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedPiece.getY()+this.selectedPiece.getNameYOffset()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedPiece.getX()-this.selectedPiece.getNameXOffset());this.oldNameAngle=this.selectedPiece.getNameAngle();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true)};a9.prototype.moveMouse=function(bb,bf){if(bb!==this.selectedPiece.getX()+this.selectedPiece.getNameXOffset()||bf!==this.selectedPiece.getY()+this.selectedPiece.getNameYOffset()){var be=Math.atan2(this.selectedPiece.getY()+this.selectedPiece.getNameYOffset()-bf,bb-this.selectedPiece.getX()-this.selectedPiece.getNameXOffset());var bd=this.oldNameAngle-be+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var bc=2*Math.PI/a9.STEP_COUNT;bd=Math.round(bd/bc)*bc}this.selectedPiece.setNameAngle(bd);this.__parent.getView().makePointVisible(bb,bf)}};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postPieceOfFurnitureNameRotation(this.selectedPiece,this.oldNameAngle);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){this.selectedPiece.setNameAngle(this.oldNameAngle);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedPiece=null};a9.STEP_COUNT=24;return a9}(ai.ControllerState));ai.PieceOfFurnitureNameRotationState=aP;aP.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameRotationState";var aC=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.selectedCamera===undefined){bc.selectedCamera=null}if(bc.oldYaw===undefined){bc.oldYaw=0}if(bc.xLastMouseMove===undefined){bc.xLastMouseMove=0}if(bc.yLastMouseMove===undefined){bc.yLastMouseMove=0}if(bc.angleLastMouseMove===undefined){bc.angleLastMouseMove=0}if(bc.rotationToolTipFeedback===undefined){bc.rotationToolTipFeedback=null}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"cameraYawRotationToolTipFeedback");this.selectedCamera=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldYaw=this.selectedCamera.getYaw();this.xLastMouseMove=this.__parent.getXLastMousePress();this.yLastMouseMove=this.__parent.getYLastMousePress();this.angleLastMouseMove=Math.atan2(this.selectedCamera.getY()-this.yLastMouseMove,this.xLastMouseMove-this.selectedCamera.getX());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.oldYaw),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};a9.prototype.moveMouse=function(bb,bg){if(bb!==this.selectedCamera.getX()||bg!==this.selectedCamera.getY()){var bf=Math.atan2(this.selectedCamera.getY()-bg,bb-this.selectedCamera.getX());var bc=this.angleLastMouseMove-bf;var be=(function(bh){if(bh>0){return 1}else{if(bh<0){return -1}else{return 0}}})((bg-this.selectedCamera.getY())*(this.xLastMouseMove-this.selectedCamera.getX())-(this.yLastMouseMove-this.selectedCamera.getY())*(bb-this.selectedCamera.getX()));if(be<0&&bc>0){bc-=(Math.PI*2)}else{if(be>0&&bc<0){bc+=(Math.PI*2)}}var bd=this.selectedCamera.getYaw()+bc;this.selectedCamera.setYaw(bd);this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(bd),bb,bg);this.xLastMouseMove=bb;this.yLastMouseMove=bg;this.angleLastMouseMove=bf}};a9.prototype.releaseMouse=function(bb,bc){this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.escape=function(){this.selectedCamera.setYaw(this.oldYaw);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedCamera=null};a9.prototype.getToolTipFeedbackText=function(bb){return CoreTools.format(this.rotationToolTipFeedback,(Math.round((function(bc){return bc*180/Math.PI})(bb))+360)%360)};return a9}(ai.ControllerState));ai.CameraYawRotationState=aC;aC.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CameraYawRotationState";var p=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;bc.__parent=bb;if(bc.selectedCamera===undefined){bc.selectedCamera=null}if(bc.oldPitch===undefined){bc.oldPitch=0}if(bc.rotationToolTipFeedback===undefined){bc.rotationToolTipFeedback=null}return bc}ba.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};ba.prototype.isModificationState=function(){return true};ba.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"cameraPitchRotationToolTipFeedback");this.selectedCamera=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldPitch=this.selectedCamera.getPitch();var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.oldPitch),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};ba.prototype.moveMouse=function(bb,bd){var bc=(this.oldPitch+(bd-this.__parent.getYLastMousePress())*Math.cos(this.selectedCamera.getYaw())*Math.PI/360-(bb-this.__parent.getXLastMousePress())*Math.sin(this.selectedCamera.getYaw())*Math.PI/360);bc=Math.max(bc,-Math.PI/2);bc=Math.min(bc,Math.PI/2);this.selectedCamera.setPitch(bc);this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(bc),bb,bd)};ba.prototype.releaseMouse=function(bb,bc){this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.escape=function(){this.selectedCamera.setPitch(this.oldPitch);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedCamera=null};ba.prototype.getToolTipFeedbackText=function(bb){return CoreTools.format(this.rotationToolTipFeedback,Math.round((function(bc){return bc*180/Math.PI})(bb))%360)};return ba}(ai.ControllerState));ai.CameraPitchRotationState=p;p.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CameraPitchRotationState";var a5=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;bc.__parent=bb;if(bc.selectedCamera===undefined){bc.selectedCamera=null}if(bc.oldElevation===undefined){bc.oldElevation=0}if(bc.cameraElevationToolTipFeedback===undefined){bc.cameraElevationToolTipFeedback=null}if(bc.observerHeightToolTipFeedback===undefined){bc.observerHeightToolTipFeedback=null}return bc}ba.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};ba.prototype.isModificationState=function(){return true};ba.prototype.enter=function(){this.cameraElevationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"cameraElevationToolTipFeedback");this.observerHeightToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"observerHeightToolTipFeedback");this.selectedCamera=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldElevation=this.selectedCamera.getZ();var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.oldElevation),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};ba.prototype.moveMouse=function(bb,bf){var bc=(this.oldElevation-(bf-this.__parent.getYLastMousePress()));var be=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();var bd=be.length===0?10:10+be[0].getElevation();bc=Math.min(Math.max(bc,bd),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumElevation());this.selectedCamera.setZ(bc);this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(bc),bb,bf)};ba.prototype.releaseMouse=function(bb,bc){this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.escape=function(){this.selectedCamera.setZ(this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedCamera=null};ba.prototype.getToolTipFeedbackText=function(bc){var bb="<html>"+CoreTools.format(this.cameraElevationToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bc));if(!this.selectedCamera.isFixedSize()&&bc>=70&&bc<=218.75){bb+="<br>"+CoreTools.format(this.observerHeightToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bc*15/14))}return bb};return ba}(ai.ControllerState));ai.CameraElevationState=a5;a5.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CameraElevationState";var s=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.xStart===undefined){bc.xStart=0}if(bc.yStart===undefined){bc.yStart=0}if(bc.editingStartPoint===undefined){bc.editingStartPoint=false}if(bc.newDimensionLine===undefined){bc.newDimensionLine=null}if(bc.oldSelection===undefined){bc.oldSelection=null}if(bc.oldBasePlanLocked===undefined){bc.oldBasePlanLocked=false}if(bc.oldAllLevelsSelection===undefined){bc.oldAllLevelsSelection=false}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}if(bc.offsetChoice===undefined){bc.offsetChoice=false}return bc}a9.prototype.getMode=function(){return ai.Mode.DIMENSION_LINE_CREATION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.setMode=function(bb){this.escape();if(bb===ai.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bb===ai.Mode.PANNING_$LI$()){this.__parent.setState(this.__parent.getPanningState())}else{if(bb===ai.Mode.WALL_CREATION_$LI$()){this.__parent.setState(this.__parent.getWallCreationState())}else{if(bb===ai.Mode.ROOM_CREATION_$LI$()){this.__parent.setState(this.__parent.getRoomCreationState())}else{if(bb===ai.Mode.POLYLINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getPolylineCreationState())}else{if(bb===ai.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}};a9.prototype.enter=function(){this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();this.xStart=this.__parent.getXLastMouseMove();this.yStart=this.__parent.getYLastMouseMove();this.editingStartPoint=false;this.offsetChoice=false;this.newDimensionLine=null;this.__parent.deselectAll();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getMeasuringDimensionLineAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),this.magnetismEnabled);if(bb!=null){this.__parent.getView().setDimensionLinesFeedback([bb].slice(0))}this.__parent.getView().setAlignmentFeedback(DimensionLine,null,this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),false)};a9.prototype.moveMouse=function(be,bi){var bd=this.__parent.getView();bd.deleteFeedback();if(this.offsetChoice){var bf=java.awt.geom.Line2D.ptLineDist(this.newDimensionLine.getXStart(),this.newDimensionLine.getYStart(),this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd(),be,bi);if(this.newDimensionLine.getLength()>0){var bc=java.awt.geom.Line2D.relativeCCW(this.newDimensionLine.getXStart(),this.newDimensionLine.getYStart(),this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd(),be,bi);this.newDimensionLine.setOffset(-(function(bj){if(bj>0){return 1}else{if(bj<0){return -1}else{return 0}}})(bc)*bf)}}else{var bh=void 0;var bg=void 0;if(this.magnetismEnabled||this.alignmentActivated){var bb=new ai.PointWithAngleMagnetism(this.xStart,this.yStart,be,bi,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bd.getPixelLength());bh=bb.getX();bg=bb.getY()}else{bh=be;bg=bi}if(this.newDimensionLine==null){this.newDimensionLine=this.__parent.createDimensionLine(this.xStart,this.yStart,bh,bg,0);this.__parent.getView().setDimensionLinesFeedback(null)}else{if(this.editingStartPoint){this.newDimensionLine.setXStart(bh);this.newDimensionLine.setYStart(bg)}else{this.newDimensionLine.setXEnd(bh);this.newDimensionLine.setYEnd(bg)}}this.updateReversedDimensionLine();bd.setAlignmentFeedback(DimensionLine,this.newDimensionLine,bh,bg,false)}bd.makePointVisible(be,bi)};a9.prototype.updateReversedDimensionLine=function(){var bc=this.getDimensionLineAngle();var bb=bc<-Math.PI/2||bc>Math.PI/2;if((bb)!==(this.editingStartPoint)){ai.reverseDimensionLine(this.newDimensionLine);this.editingStartPoint=!this.editingStartPoint}};a9.prototype.getDimensionLineAngle=function(){if(this.newDimensionLine.getLength()===0){return 0}else{if(this.editingStartPoint){return Math.atan2(this.yStart-this.newDimensionLine.getYStart(),this.newDimensionLine.getXStart()-this.xStart)}else{return Math.atan2(this.yStart-this.newDimensionLine.getYEnd(),this.newDimensionLine.getXEnd()-this.xStart)}}};a9.prototype.pressMouse=function(be,bh,bd,bf,bg){if(this.newDimensionLine==null&&bd===2){var bc=this.__parent.getMeasuringDimensionLineAt(be,bh,this.magnetismEnabled);if(bc!=null){this.newDimensionLine=this.__parent.createDimensionLine(bc.getXStart(),bc.getYStart(),bc.getXEnd(),bc.getYEnd(),bc.getOffset());if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.validateDrawnDimensionLine()}}else{this.__parent.setState(this.__parent.getDimensionLineCreationState());return}}if(this.newDimensionLine!=null){if(this.offsetChoice){this.validateDrawnDimensionLine()}else{this.offsetChoice=true;var bb=this.__parent.getView();bb.setCursor(PlanView.CursorType.HEIGHT);bb.deleteFeedback()}}};a9.prototype.releaseMouse=function(bb,bc){if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.newDimensionLine!=null){this.validateDrawnDimensionLine()}};a9.prototype.validateDrawnDimensionLine=function(){this.__parent.selectItem(this.newDimensionLine);this.__parent.postCreateDimensionLines([this.newDimensionLine].slice(0),this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection);this.newDimensionLine=null;if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getDimensionLineCreationState())}};a9.prototype.setEditionActivated=function(be){var bb=this.__parent.getView();if(be){bb.deleteFeedback();if(this.newDimensionLine==null){bb.setToolTipEditedProperties(["X","Y"],[this.xStart,this.yStart],this.xStart,this.yStart)}else{if(this.offsetChoice){bb.setToolTipEditedProperties(["OFFSET"],[this.newDimensionLine.getOffset()],this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd())}else{bb.setToolTipEditedProperties(["LENGTH","ANGLE"],[this.newDimensionLine.getLength(),(Math.round((function(bf){return bf*180/Math.PI})(this.getDimensionLineAngle()))|0)],this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd())}}}else{if(this.newDimensionLine==null){var bc=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit();var bd=bc===LengthUnit.INCH||bc===LengthUnit.INCH_DECIMALS?LengthUnit.footToCentimeter(3):100;this.newDimensionLine=this.__parent.createDimensionLine(this.xStart,this.yStart,this.xStart+bd,this.yStart,0);bb.deleteFeedback();this.setEditionActivated(true)}else{if(this.offsetChoice){this.validateDrawnDimensionLine()}else{this.offsetChoice=true;this.setEditionActivated(true)}}}};a9.prototype.updateEditableProperty=function(bh,bi){var bg=this.__parent.getView();var bf=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength();if(this.newDimensionLine==null){switch((bh)){case"X":this.xStart=bi!=null?bi:0;this.xStart=Math.max(-bf,Math.min(this.xStart,bf));break;case"Y":this.yStart=bi!=null?bi:0;this.yStart=Math.max(-bf,Math.min(this.yStart,bf));break}bg.setAlignmentFeedback(DimensionLine,null,this.xStart,this.yStart,true);bg.makePointVisible(this.xStart,this.yStart)}else{if(this.offsetChoice){if(bh==="OFFSET"){var be=bi!=null?bi:0;be=Math.max(-bf,Math.min(be,bf));this.newDimensionLine.setOffset(be)}}else{var bb=void 0;var bk=void 0;switch((bh)){case"LENGTH":var bd=bi!=null?bi:0;bd=Math.max(0.001,Math.min(bd,bf));var bc=this.getDimensionLineAngle();bb=(this.xStart+bd*Math.cos(bc));bk=(this.yStart-bd*Math.sin(bc));break;case"ANGLE":bc=(function(bl){return bl*Math.PI/180})(bi!=null?bi:0);var bj=this.newDimensionLine.getLength();bb=(this.xStart+bj*Math.cos(bc));bk=(this.yStart-bj*Math.sin(bc));break;default:return}if(this.editingStartPoint){this.newDimensionLine.setXStart(bb);this.newDimensionLine.setYStart(bk)}else{this.newDimensionLine.setXEnd(bb);this.newDimensionLine.setYEnd(bk)}this.updateReversedDimensionLine();bg.setAlignmentFeedback(DimensionLine,this.newDimensionLine,bb,bk,false);bg.makePointVisible(this.xStart,this.yStart);bg.makePointVisible(bb,bk)}}};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);if(this.newDimensionLine!=null&&!this.offsetChoice){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){if(this.newDimensionLine!=null){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteDimensionLine(this.newDimensionLine)}if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getDimensionLineCreationState())}};a9.prototype.exit=function(){this.__parent.getView().deleteFeedback();this.newDimensionLine=null;this.oldSelection=null};return a9}(ai.ControllerState));ai.DimensionLineDrawingState=s;s.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineDrawingState";var W=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.selectedDimensionLine===undefined){bc.selectedDimensionLine=null}if(bc.editingStartPoint===undefined){bc.editingStartPoint=false}if(bc.oldX===undefined){bc.oldX=0}if(bc.oldY===undefined){bc.oldY=0}if(bc.reversedDimensionLine===undefined){bc.reversedDimensionLine=false}if(bc.deltaXToResizePoint===undefined){bc.deltaXToResizePoint=0}if(bc.deltaYToResizePoint===undefined){bc.deltaYToResizePoint=0}if(bc.distanceFromResizePointToDimensionBaseLine===undefined){bc.distanceFromResizePointToDimensionBaseLine=0}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.enter=function(){var bc=this.__parent.getView();bc.setResizeIndicatorVisible(true);this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.editingStartPoint=this.selectedDimensionLine===this.__parent.getResizedDimensionLineStartAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());if(this.editingStartPoint){this.oldX=this.selectedDimensionLine.getXStart();this.oldY=this.selectedDimensionLine.getYStart()}else{this.oldX=this.selectedDimensionLine.getXEnd();this.oldY=this.selectedDimensionLine.getYEnd()}this.reversedDimensionLine=false;var bd;var bf;var bb=(this.selectedDimensionLine.getYEnd()-this.selectedDimensionLine.getYStart())/(this.selectedDimensionLine.getXEnd()-this.selectedDimensionLine.getXStart());if(Math.abs(bb)>100000){bd=this.__parent.getXLastMousePress();if(this.editingStartPoint){bf=this.selectedDimensionLine.getYStart()}else{bf=this.selectedDimensionLine.getYEnd()}}else{if(this.selectedDimensionLine.getYStart()===this.selectedDimensionLine.getYEnd()){if(this.editingStartPoint){bd=this.selectedDimensionLine.getXStart()}else{bd=this.selectedDimensionLine.getXEnd()}bf=this.__parent.getYLastMousePress()}else{var bg=this.__parent.getYLastMousePress()-bb*this.__parent.getXLastMousePress();var bh=-1/bb;var be=void 0;if(this.editingStartPoint){be=this.selectedDimensionLine.getYStart()-bh*this.selectedDimensionLine.getXStart()}else{be=this.selectedDimensionLine.getYEnd()-bh*this.selectedDimensionLine.getXEnd()}bd=(be-bg)/(bb-bh);bf=bb*bd+bg}}this.deltaXToResizePoint=this.__parent.getXLastMousePress()-bd;this.deltaYToResizePoint=this.__parent.getYLastMousePress()-bf;if(this.editingStartPoint){this.distanceFromResizePointToDimensionBaseLine=java.awt.geom.Point2D.distance(bd,bf,this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart());bc.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),false)}else{this.distanceFromResizePointToDimensionBaseLine=java.awt.geom.Point2D.distance(bd,bf,this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd());bc.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),false)}this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())};a9.prototype.moveMouse=function(bl,bj){var bi=this.__parent.getView();var bq=bl-this.deltaXToResizePoint;var bk=bj-this.deltaYToResizePoint;if(this.editingStartPoint){var bd=java.awt.geom.Point2D.distance(bq,bk,this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd());var bh=Math.sqrt(bd*bd-this.distanceFromResizePointToDimensionBaseLine*this.distanceFromResizePointToDimensionBaseLine);if(bh>0){var bf=-Math.atan2(this.distanceFromResizePointToDimensionBaseLine,bh);if(this.selectedDimensionLine.getOffset()>=0){bf=-bf}var bp=Math.atan2(bk-this.selectedDimensionLine.getYEnd(),bq-this.selectedDimensionLine.getXEnd());var bo=bf+bp;var bb=this.selectedDimensionLine.getXEnd()+(bh*Math.cos(bo));var br=this.selectedDimensionLine.getYEnd()+(bh*Math.sin(bo));if(this.alignmentActivated||this.magnetismEnabled){var bn=new ai.PointWithAngleMagnetism(this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),bb,br,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bi.getPixelLength());bb=bn.getX();br=bn.getY()}ai.moveDimensionLinePoint(this.selectedDimensionLine,bb,br,this.editingStartPoint);this.updateReversedDimensionLine();bi.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,bb,br,false)}else{bi.deleteFeedback()}}else{var bg=java.awt.geom.Point2D.distance(bq,bk,this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart());var bh=Math.sqrt(bg*bg-this.distanceFromResizePointToDimensionBaseLine*this.distanceFromResizePointToDimensionBaseLine);if(bh>0){var bf=Math.atan2(this.distanceFromResizePointToDimensionBaseLine,bh);if(this.selectedDimensionLine.getOffset()>=0){bf=-bf}var bm=Math.atan2(bk-this.selectedDimensionLine.getYStart(),bq-this.selectedDimensionLine.getXStart());var bo=bf+bm;var be=this.selectedDimensionLine.getXStart()+(bh*Math.cos(bo));var bc=this.selectedDimensionLine.getYStart()+(bh*Math.sin(bo));if(this.alignmentActivated||this.magnetismEnabled){var bn=new ai.PointWithAngleMagnetism(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),be,bc,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bi.getPixelLength());be=bn.getX();bc=bn.getY()}ai.moveDimensionLinePoint(this.selectedDimensionLine,be,bc,this.editingStartPoint);this.updateReversedDimensionLine();bi.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,be,bc,false)}else{bi.deleteFeedback()}}this.__parent.getView().makePointVisible(bl,bj)};a9.prototype.updateReversedDimensionLine=function(){var bb=this.getDimensionLineAngle();if(bb<-Math.PI/2||bb>Math.PI/2){ai.reverseDimensionLine(this.selectedDimensionLine);this.editingStartPoint=!this.editingStartPoint;this.reversedDimensionLine=!this.reversedDimensionLine}};a9.prototype.getDimensionLineAngle=function(){if(this.selectedDimensionLine.getLength()===0){return 0}else{return Math.atan2(this.selectedDimensionLine.getYStart()-this.selectedDimensionLine.getYEnd(),this.selectedDimensionLine.getXEnd()-this.selectedDimensionLine.getXStart())}};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postDimensionLineResize(this.selectedDimensionLine,this.oldX,this.oldY,this.editingStartPoint,this.reversedDimensionLine);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){if(this.reversedDimensionLine){ai.reverseDimensionLine(this.selectedDimensionLine);this.editingStartPoint=!this.editingStartPoint}ai.moveDimensionLinePoint(this.selectedDimensionLine,this.oldX,this.oldY,this.editingStartPoint);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){var bb=this.__parent.getView();bb.deleteFeedback();bb.setResizeIndicatorVisible(false);this.selectedDimensionLine=null};return a9}(ai.ControllerState));ai.DimensionLineResizeState=W;W.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineResizeState";var V=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.selectedDimensionLine===undefined){bc.selectedDimensionLine=null}if(bc.oldOffset===undefined){bc.oldOffset=0}if(bc.deltaXToOffsetPoint===undefined){bc.deltaXToOffsetPoint=0}if(bc.deltaYToOffsetPoint===undefined){bc.deltaYToOffsetPoint=0}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.enter=function(){this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldOffset=this.selectedDimensionLine.getOffset();var bf=Math.atan2(this.selectedDimensionLine.getYEnd()-this.selectedDimensionLine.getYStart(),this.selectedDimensionLine.getXEnd()-this.selectedDimensionLine.getXStart());var bd=-Math.sin(bf)*this.oldOffset;var bc=Math.cos(bf)*this.oldOffset;var bg=(this.selectedDimensionLine.getXStart()+this.selectedDimensionLine.getXEnd())/2+bd;var be=(this.selectedDimensionLine.getYStart()+this.selectedDimensionLine.getYEnd())/2+bc;this.deltaXToOffsetPoint=this.__parent.getXLastMousePress()-bg;this.deltaYToOffsetPoint=this.__parent.getYLastMousePress()-be;var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true)};a9.prototype.moveMouse=function(bc,bg){var bf=bc-this.deltaXToOffsetPoint;var be=bg-this.deltaYToOffsetPoint;var bd=java.awt.geom.Line2D.ptLineDist(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),bf,be);var bb=java.awt.geom.Line2D.relativeCCW(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),bf,be);this.selectedDimensionLine.setOffset(-(function(bh){if(bh>0){return 1}else{if(bh<0){return -1}else{return 0}}})(bb)*bd);this.__parent.getView().makePointVisible(bc,bg)};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postDimensionLineOffset(this.selectedDimensionLine,this.oldOffset);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.escape=function(){this.selectedDimensionLine.setOffset(this.oldOffset);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedDimensionLine=null};return a9}(ai.ControllerState));ai.DimensionLineOffsetState=V;V.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineOffsetState";var a1=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;bc.__parent=bb;if(bc.roomSideLengthToolTipFeedback===undefined){bc.roomSideLengthToolTipFeedback=null}if(bc.roomSideAngleToolTipFeedback===undefined){bc.roomSideAngleToolTipFeedback=null}return bc}ba.prototype.enter=function(){this.roomSideLengthToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"roomSideLengthToolTipFeedback");try{this.roomSideAngleToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"roomSideAngleToolTipFeedback")}catch(bb){}};ba.prototype.getToolTipFeedbackText=function(be,bd){var bc=this.getRoomSideLength(be,bd);var bf=this.getRoomSideAngle(be,bd);var bb="<html>"+CoreTools.format(this.roomSideLengthToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bc));if(this.roomSideAngleToolTipFeedback!=null&&this.roomSideAngleToolTipFeedback.length>0){bb+="<br>"+CoreTools.format(this.roomSideAngleToolTipFeedback,bf)}return bb};ba.prototype.getRoomSideLength=function(be,bd){var bc=be.getPoints();var bb=bc[(bd+bc.length-1)%bc.length];return java.awt.geom.Point2D.distance(bb[0],bb[1],bc[bd][0],bc[bd][1])};ba.prototype.getTriangulationDimensionLines=function(bh,bf){var bd=bh.getPoints();var bc=bd[(bf+bd.length-1)%bd.length];var bb=([]);var bi=20/this.__parent.getView().getScale();if(!(function(bk,bj){if(bk==null&&bj==null){return true}if(bk==null||bj==null){return false}if(bk.length!=bj.length){return false}for(var bl=0;bl<bk.length;bl++){if(bk[bl]!=bj[bl]){return false}}return true})(bd[bf],bc)){(bb.push(this.__parent.getDimensionLineBetweenPoints(bc,bd[bf],this.isDimensionInsideRoom(bh,bc,bd[bf])?-bi:bi,false))>0)}if(bd.length>2){var bg=bd[bf+1<bd.length?bf+1:0];if(!(function(bk,bj){if(bk==null&&bj==null){return true}if(bk==null||bj==null){return false}if(bk.length!=bj.length){return false}for(var bl=0;bl<bk.length;bl++){if(bk[bl]!=bj[bl]){return false}}return true})(bd[bf],bg)){(bb.push(this.__parent.getDimensionLineBetweenPoints(bd[bf],bg,this.isDimensionInsideRoom(bh,bd[bf],bg)?-bi:bi,false))>0)}var be=bd[(bf+bd.length-2)%bd.length];if(bd.length===3){(bb.push(this.__parent.getDimensionLineBetweenPoints(bc,be,this.isDimensionInsideRoom(bh,bc,be)?-bi:bi,false))>0)}else{if(!(function(bk,bj){if(bk==null&&bj==null){return true}if(bk==null||bj==null){return false}if(bk.length!=bj.length){return false}for(var bl=0;bl<bk.length;bl++){if(bk[bl]!=bj[bl]){return false}}return true})(bd[bf],be)){(bb.push(this.__parent.getDimensionLineBetweenPoints(bd[bf],be,0,false))>0)}}}return bb};ba.prototype.isDimensionInsideRoom=function(be,bd,bc){var bb=java.awt.geom.AffineTransform.getRotateInstance(Math.atan2(bc[1]-bd[1],bc[0]-bd[0]),bd[0],bd[1]);var bf=[(bd[0]+java.awt.geom.Point2D.distance(bd[0],bd[1],bc[0],bc[1])/2),bd[1]+1];bb.transform(bf,0,bf,0,1);return be.containsPoint(bf[0],bf[1],0)};ba.prototype.getRoomSideAngle=function(bc,bj){var bl=bc.getPoints();var bk=bl[bj];var bh=bl[(bj+bl.length-1)%bl.length];var be=bl[(bj+bl.length-2)%bl.length];var bm=java.awt.geom.Point2D.distance(bh[0],bh[1],bl[bj][0],bl[bj][1]);var bi=java.awt.geom.Point2D.distance(be[0],be[1],bh[0],bh[1]);if(be!==bk&&bm!==0&&bi!==0){var bg=(bk[0]-bh[0])/bm;var bn=(bk[1]-bh[1])/bm;var bb=(bh[0]-be[0])/bi;var bd=(bh[1]-be[1])/bi;var bf=(Math.round(180-(function(bo){return bo*180/Math.PI})(Math.atan2(bn*bb-bg*bd,bg*bb+bn*bd)))|0);if(bf>180){bf-=360}return bf}if(bm===0){return 0}else{return(Math.round((function(bo){return bo*180/Math.PI})(Math.atan2(bh[1]-bk[1],bk[0]-bh[0])))|0)}};ba.prototype.showRoomAngleFeedback=function(bf,be){var bc=bf.getPoints();if(this.roomSideAngleToolTipFeedback!=null&&this.roomSideAngleToolTipFeedback.length>0&&bc.length>2){var bb=bc[(be+bc.length-1)%bc.length];var bd=bc[(be+bc.length-2)%bc.length];if(this.getRoomSideAngle(bf,be)>0){this.__parent.getView().setAngleFeedback(bb[0],bb[1],bd[0],bd[1],bc[be][0],bc[be][1])}else{this.__parent.getView().setAngleFeedback(bb[0],bb[1],bc[be][0],bc[be][1],bd[0],bd[1])}}};return ba}(ai.ControllerState));ai.AbstractRoomState=a1;a1.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractRoomState";var aZ=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.selectedRoom===undefined){bc.selectedRoom=null}if(bc.oldNameXOffset===undefined){bc.oldNameXOffset=0}if(bc.oldNameYOffset===undefined){bc.oldNameYOffset=0}if(bc.xLastMouseMove===undefined){bc.xLastMouseMove=0}if(bc.yLastMouseMove===undefined){bc.yLastMouseMove=0}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldNameXOffset=this.selectedRoom.getNameXOffset();this.oldNameYOffset=this.selectedRoom.getNameYOffset();this.xLastMouseMove=this.__parent.getXLastMousePress();this.yLastMouseMove=this.__parent.getYLastMousePress();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true)};a9.prototype.moveMouse=function(bb,bd){if(this.alignmentActivated){var bc=new ai.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bb,bd,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);bb=bc.getX();bd=bc.getY()}this.selectedRoom.setNameXOffset(this.selectedRoom.getNameXOffset()+bb-this.xLastMouseMove);this.selectedRoom.setNameYOffset(this.selectedRoom.getNameYOffset()+bd-this.yLastMouseMove);this.xLastMouseMove=bb;this.yLastMouseMove=bd;this.__parent.getView().makePointVisible(bb,bd)};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postRoomNameOffset(this.selectedRoom,this.oldNameXOffset,this.oldNameYOffset);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){this.selectedRoom.setNameXOffset(this.oldNameXOffset);this.selectedRoom.setNameYOffset(this.oldNameYOffset);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedRoom=null};return a9}(ai.ControllerState));ai.RoomNameOffsetState=aZ;aZ.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameOffsetState";var af=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.selectedRoom===undefined){bc.selectedRoom=null}if(bc.oldNameAngle===undefined){bc.oldNameAngle=0}if(bc.angleMousePress===undefined){bc.angleMousePress=0}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getNameYOffset()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedRoom.getXCenter()-this.selectedRoom.getNameXOffset());this.oldNameAngle=this.selectedRoom.getNameAngle();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true)};a9.prototype.moveMouse=function(bb,bf){if(bb!==this.selectedRoom.getXCenter()+this.selectedRoom.getNameXOffset()||bf!==this.selectedRoom.getYCenter()+this.selectedRoom.getNameYOffset()){var be=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getNameYOffset()-bf,bb-this.selectedRoom.getXCenter()-this.selectedRoom.getNameXOffset());var bd=this.oldNameAngle-be+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var bc=2*Math.PI/a9.STEP_COUNT;bd=Math.round(bd/bc)*bc}this.selectedRoom.setNameAngle(bd);this.__parent.getView().makePointVisible(bb,bf)}};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postRoomNameRotation(this.selectedRoom,this.oldNameAngle);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){this.selectedRoom.setNameAngle(this.oldNameAngle);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedRoom=null};a9.STEP_COUNT=24;return a9}(ai.ControllerState));ai.RoomNameRotationState=af;af.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameRotationState";var a4=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.selectedRoom===undefined){bc.selectedRoom=null}if(bc.oldAreaXOffset===undefined){bc.oldAreaXOffset=0}if(bc.oldAreaYOffset===undefined){bc.oldAreaYOffset=0}if(bc.xLastMouseMove===undefined){bc.xLastMouseMove=0}if(bc.yLastMouseMove===undefined){bc.yLastMouseMove=0}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldAreaXOffset=this.selectedRoom.getAreaXOffset();this.oldAreaYOffset=this.selectedRoom.getAreaYOffset();this.xLastMouseMove=this.__parent.getXLastMousePress();this.yLastMouseMove=this.__parent.getYLastMousePress();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true)};a9.prototype.moveMouse=function(bb,bd){if(this.alignmentActivated){var bc=new ai.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bb,bd,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);bb=bc.getX();bd=bc.getY()}this.selectedRoom.setAreaXOffset(this.selectedRoom.getAreaXOffset()+bb-this.xLastMouseMove);this.selectedRoom.setAreaYOffset(this.selectedRoom.getAreaYOffset()+bd-this.yLastMouseMove);this.xLastMouseMove=bb;this.yLastMouseMove=bd;this.__parent.getView().makePointVisible(bb,bd)};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postRoomAreaOffset(this.selectedRoom,this.oldAreaXOffset,this.oldAreaYOffset);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){this.selectedRoom.setAreaXOffset(this.oldAreaXOffset);this.selectedRoom.setAreaYOffset(this.oldAreaYOffset);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedRoom=null};return a9}(ai.ControllerState));ai.RoomAreaOffsetState=a4;a4.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaOffsetState";var D=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;bc.__parent=bb;if(bc.selectedRoom===undefined){bc.selectedRoom=null}if(bc.oldAreaAngle===undefined){bc.oldAreaAngle=0}if(bc.angleMousePress===undefined){bc.angleMousePress=0}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}ba.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};ba.prototype.isModificationState=function(){return true};ba.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getAreaYOffset()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedRoom.getXCenter()-this.selectedRoom.getAreaXOffset());this.oldAreaAngle=this.selectedRoom.getAreaAngle();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true)};ba.prototype.moveMouse=function(bb,bf){if(bb!==this.selectedRoom.getXCenter()+this.selectedRoom.getAreaXOffset()||bf!==this.selectedRoom.getYCenter()+this.selectedRoom.getAreaYOffset()){var be=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getAreaYOffset()-bf,bb-this.selectedRoom.getXCenter()-this.selectedRoom.getAreaXOffset());var bd=this.oldAreaAngle-be+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var bc=2*Math.PI/ba.STEP_COUNT;bd=Math.round(bd/bc)*bc}this.selectedRoom.setAreaAngle(bd);this.__parent.getView().makePointVisible(bb,bf)}};ba.prototype.releaseMouse=function(bb,bc){this.__parent.postRoomAreaRotation(this.selectedRoom,this.oldAreaAngle);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};ba.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};ba.prototype.escape=function(){this.selectedRoom.setAreaAngle(this.oldAreaAngle);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedRoom=null};ba.STEP_COUNT=24;return ba}(ai.ControllerState));ai.RoomAreaRotationState=D;D.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaRotationState";var d=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.polylineSegmentLengthToolTipFeedback===undefined){bc.polylineSegmentLengthToolTipFeedback=null}if(bc.polylineSegmentAngleToolTipFeedback===undefined){bc.polylineSegmentAngleToolTipFeedback=null}return bc}a9.prototype.enter=function(){this.polylineSegmentLengthToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"polylineSegmentLengthToolTipFeedback");try{this.polylineSegmentAngleToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"polylineSegmentAngleToolTipFeedback")}catch(bb){}};a9.prototype.getToolTipFeedbackText=function(bb,be){var bd=this.getPolylineSegmentLength(bb,be);var bf=this.getPolylineSegmentAngle(bb,be);var bc="<html>"+CoreTools.format(this.polylineSegmentLengthToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bd));if(this.polylineSegmentAngleToolTipFeedback!=null&&this.polylineSegmentAngleToolTipFeedback.length>0){bc+="<br>"+CoreTools.format(this.polylineSegmentAngleToolTipFeedback,bf)}return bc};a9.prototype.getPolylineSegmentLength=function(bb,be){if(be===0&&!bb.isClosedPath()){be++}var bd=bb.getPoints();var bc=bd[(be+bd.length-1)%bd.length];return java.awt.geom.Point2D.distance(bc[0],bc[1],bd[be][0],bd[be][1])};a9.prototype.getPolylineSegmentAngle=function(bk,bj){if(bj===0&&!bk.isClosedPath()){bj++}var bn=bk.getPoints();var bl=bn[bj];var be=bn[(bj+bn.length-1)%bn.length];var bc=bn[(bj+bn.length-2)%bn.length];var bf=java.awt.geom.Point2D.distance(be[0],be[1],bn[bj][0],bn[bj][1]);var bd=java.awt.geom.Point2D.distance(bc[0],bc[1],be[0],be[1]);if(bc!==bl&&bf!==0&&bd!==0){var bi=(bl[0]-be[0])/bf;var bg=(bl[1]-be[1])/bf;var bm=(be[0]-bc[0])/bd;var bh=(be[1]-bc[1])/bd;var bb=(Math.round(180-(function(bo){return bo*180/Math.PI})(Math.atan2(bg*bm-bi*bh,bi*bm+bg*bh)))|0);if(bb>180){bb-=360}return bb}if(bf===0){return 0}else{return(Math.round((function(bo){return bo*180/Math.PI})(Math.atan2(be[1]-bl[1],bl[0]-be[0])))|0)}};a9.prototype.showPolylineAngleFeedback=function(bb,bf){var bd=bb.getPoints();if(this.polylineSegmentAngleToolTipFeedback!=null&&this.polylineSegmentAngleToolTipFeedback.length>0&&(bf>=2||bd.length>2&&bb.isClosedPath())){var bc=bd[(bf+bd.length-1)%bd.length];var be=bd[(bf+bd.length-2)%bd.length];this.__parent.getView().setAngleFeedback(bc[0],bc[1],be[0],be[1],bd[bf][0],bd[bf][1])}};return a9}(ai.ControllerState));ai.AbstractPolylineState=d;d.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractPolylineState";var aW=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.selectedLabel===undefined){bc.selectedLabel=null}if(bc.oldAngle===undefined){bc.oldAngle=0}if(bc.angleMousePress===undefined){bc.angleMousePress=0}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.enter=function(){this.selectedLabel=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedLabel.getY()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedLabel.getX());this.oldAngle=this.selectedLabel.getAngle();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true)};a9.prototype.moveMouse=function(bb,bf){if(bb!==this.selectedLabel.getX()||bf!==this.selectedLabel.getY()){var be=Math.atan2(this.selectedLabel.getY()-bf,bb-this.selectedLabel.getX());var bd=this.oldAngle-be+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var bc=2*Math.PI/a9.STEP_COUNT;bd=Math.round(bd/bc)*bc}this.selectedLabel.setAngle(bd);this.__parent.getView().makePointVisible(bb,bf)}};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postLabelRotation(this.selectedLabel,this.oldAngle);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){this.selectedLabel.setAngle(this.oldAngle);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedLabel=null};a9.STEP_COUNT=24;return a9}(ai.ControllerState));ai.LabelRotationState=aW;aW.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelRotationState";var R=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.deltaYToElevationPoint===undefined){bc.deltaYToElevationPoint=0}if(bc.selectedLabel===undefined){bc.selectedLabel=null}if(bc.oldElevation===undefined){bc.oldElevation=0}if(bc.elevationToolTipFeedback===undefined){bc.elevationToolTipFeedback=null}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.enter=function(){this.elevationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"elevationToolTipFeedback");this.selectedLabel=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var bd=this.__parent.getItemTextStyle(this.selectedLabel,this.selectedLabel.getStyle());var bc=this.__parent.getView().getTextBounds(this.selectedLabel.getText(),bd,this.selectedLabel.getX(),this.selectedLabel.getY(),this.selectedLabel.getAngle());this.deltaYToElevationPoint=this.__parent.getYLastMousePress()-(bc[2][1]+bc[3][1])/2;this.oldElevation=this.selectedLabel.getElevation();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.oldElevation),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};a9.prototype.moveMouse=function(bd,bh){var bc=this.__parent.getView();var bg=this.__parent.getItemTextStyle(this.selectedLabel,this.selectedLabel.getStyle());var bf=this.__parent.getView().getTextBounds(this.selectedLabel.getText(),bg,this.selectedLabel.getX(),this.selectedLabel.getY(),this.selectedLabel.getAngle());var bb=bh-this.deltaYToElevationPoint-(bf[2][1]+bf[3][1])/2;var be=this.oldElevation-bb;be=Math.min(Math.max(be,0),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumElevation());if(this.magnetismEnabled){be=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(be,bc.getPixelLength())}this.selectedLabel.setElevation(be);bc.makePointVisible(bd,bh);bc.setToolTipFeedback(this.getToolTipFeedbackText(be),bd,bh)};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postLabelElevation(this.selectedLabel,this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){this.selectedLabel.setElevation(this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedLabel=null};a9.prototype.getToolTipFeedbackText=function(bb){return CoreTools.format(this.elevationToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bb))};return a9}(ai.ControllerState));ai.LabelElevationState=R;R.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelElevationState";var K=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this)||this;bc.__parent=bb;if(bc.selectedCompass===undefined){bc.selectedCompass=null}if(bc.angleMousePress===undefined){bc.angleMousePress=0}if(bc.oldNorthDirection===undefined){bc.oldNorthDirection=0}if(bc.rotationToolTipFeedback===undefined){bc.rotationToolTipFeedback=null}return bc}ba.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};ba.prototype.isModificationState=function(){return true};ba.prototype.isBasePlanModificationState=function(){return true};ba.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"rotationToolTipFeedback");this.selectedCompass=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedCompass.getY()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedCompass.getX());this.oldNorthDirection=this.selectedCompass.getNorthDirection();var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.oldNorthDirection),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};ba.prototype.moveMouse=function(bd,bg){if(bd!==this.selectedCompass.getX()||bg!==this.selectedCompass.getY()){var bf=Math.atan2(this.selectedCompass.getY()-bg,bd-this.selectedCompass.getX());var bc=this.oldNorthDirection-bf+this.angleMousePress;var be=Math.PI/180;bc=Math.round(bc/be)*be;bc=((bc+2*Math.PI)%(2*Math.PI));this.selectedCompass.setNorthDirection(bc);var bb=this.__parent.getView();bb.makePointVisible(bd,bg);bb.setToolTipFeedback(this.getToolTipFeedbackText(bc),bd,bg)}};ba.prototype.releaseMouse=function(bb,bc){this.__parent.postCompassRotation(this.selectedCompass,this.oldNorthDirection);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.escape=function(){this.selectedCompass.setNorthDirection(this.oldNorthDirection);this.__parent.setState(this.__parent.getSelectionState())};ba.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedCompass=null};ba.prototype.getToolTipFeedbackText=function(bb){return CoreTools.format(this.rotationToolTipFeedback,Math.round((function(bc){return bc*180/Math.PI})(bb)))};return ba}(ai.ControllerState));ai.CompassRotationState=K;K.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassRotationState";var ag=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this)||this;bc.__parent=bb;if(bc.selectedCompass===undefined){bc.selectedCompass=null}if(bc.oldDiameter===undefined){bc.oldDiameter=0}if(bc.deltaXToResizePoint===undefined){bc.deltaXToResizePoint=0}if(bc.deltaYToResizePoint===undefined){bc.deltaYToResizePoint=0}if(bc.resizeToolTipFeedback===undefined){bc.resizeToolTipFeedback=null}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.enter=function(){this.resizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(ai,"diameterToolTipFeedback");this.selectedCompass=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var bd=this.selectedCompass.getPoints();var be=(bd[1][0]+bd[2][0])/2;var bc=(bd[1][1]+bd[2][1])/2;this.deltaXToResizePoint=this.__parent.getXLastMousePress()-be;this.deltaYToResizePoint=this.__parent.getYLastMousePress()-bc;this.oldDiameter=this.selectedCompass.getDiameter();var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.oldDiameter),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())};a9.prototype.moveMouse=function(bd,be){var bc=this.__parent.getView();var bb=java.awt.geom.Point2D.distance(this.selectedCompass.getX(),this.selectedCompass.getY(),bd-this.deltaXToResizePoint,be-this.deltaYToResizePoint)*2;bb=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(bb,bc.getPixelLength());bb=Math.min(Math.max(bb,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()/10);this.selectedCompass.setDiameter(bb);bc.makePointVisible(bd,be);bc.setToolTipFeedback(this.getToolTipFeedbackText(bb),bd,be)};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postCompassResize(this.selectedCompass,this.oldDiameter);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.escape=function(){this.selectedCompass.setDiameter(this.oldDiameter);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedCompass=null};a9.prototype.getToolTipFeedbackText=function(bb){return CoreTools.format(this.resizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bb))};return a9}(ai.ControllerState));ai.CompassResizeState=ag;ag.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassResizeState";var aR=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this,bb)||this;bc.__parent=bb;bc.selectionListener=new ba.SelectionState$0(bc);return bc}ba.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};ba.prototype.enter=function(){if(this.__parent.getView()!=null){if(this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener);this.selectionListener.selectionChanged(null)}};ba.prototype.moveMouse=function(bb,bc){if(this.__parent.getRotatedLabelAt(bb,bc)!=null||this.__parent.getYawRotatedCameraAt(bb,bc)!=null||this.__parent.getPitchRotatedCameraAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getElevatedLabelAt(bb,bc)!=null||this.__parent.getElevatedCameraAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ELEVATION)}else{if(this.__parent.getRoomNameAt(bb,bc)!=null||this.__parent.getRoomAreaAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.RESIZE)}else{if(this.__parent.getRoomRotatedNameAt(bb,bc)!=null||this.__parent.getRoomRotatedAreaAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getResizedDimensionLineStartAt(bb,bc)!=null||this.__parent.getResizedDimensionLineEndAt(bb,bc)!=null||this.__parent.getWidthAndDepthResizedPieceOfFurnitureAt(bb,bc)!=null||this.__parent.getResizedWallStartAt(bb,bc)!=null||this.__parent.getResizedWallEndAt(bb,bc)!=null||this.__parent.getResizedPolylineAt(bb,bc)!=null||this.__parent.getResizedRoomAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.RESIZE)}else{if(this.__parent.getPitchRotatedPieceOfFurnitureAt(bb,bc)!=null||this.__parent.getRollRotatedPieceOfFurnitureAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getModifiedLightPowerAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.POWER)}else{if(this.__parent.getOffsetDimensionLineAt(bb,bc)!=null||this.__parent.getHeightResizedPieceOfFurnitureAt(bb,bc)!=null||this.__parent.getArcExtentWallAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.HEIGHT)}else{if(this.__parent.getRotatedPieceOfFurnitureAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getElevatedPieceOfFurnitureAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ELEVATION)}else{if(this.__parent.getPieceOfFurnitureNameAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.RESIZE)}else{if(this.__parent.getPieceOfFurnitureRotatedNameAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getRotatedCompassAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getResizedCompassAt(bb,bc)!=null){this.__parent.getView().setCursor(PlanView.CursorType.RESIZE)}else{if(this.__parent.isItemSelectedAt(bb,bc)){this.__parent.getView().setCursor(PlanView.CursorType.MOVE)}else{this.__parent.getView().setCursor(PlanView.CursorType.SELECTION)}}}}}}}}}}}}}}}};ba.prototype.pressMouse=function(bc,bg,bb,bd,bf){if(bb===1){if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.moveMouse(bc,bg)}if(this.__parent.getRotatedLabelAt(bc,bg)!=null){this.__parent.setState(this.__parent.getLabelRotationState())}else{if(this.__parent.getYawRotatedCameraAt(bc,bg)!=null){this.__parent.setState(this.__parent.getCameraYawRotationState())}else{if(this.__parent.getPitchRotatedCameraAt(bc,bg)!=null){this.__parent.setState(this.__parent.getCameraPitchRotationState())}else{if(this.__parent.getElevatedLabelAt(bc,bg)!=null){this.__parent.setState(this.__parent.getLabelElevationState())}else{if(this.__parent.getElevatedCameraAt(bc,bg)!=null){this.__parent.setState(this.__parent.getCameraElevationState())}else{if(this.__parent.getRoomNameAt(bc,bg)!=null){this.__parent.setState(this.__parent.getRoomNameOffsetState())}else{if(this.__parent.getRoomRotatedNameAt(bc,bg)!=null){this.__parent.setState(this.__parent.getRoomNameRotationState())}else{if(this.__parent.getRoomAreaAt(bc,bg)!=null){this.__parent.setState(this.__parent.getRoomAreaOffsetState())}else{if(this.__parent.getRoomRotatedAreaAt(bc,bg)!=null){this.__parent.setState(this.__parent.getRoomAreaRotationState())}else{if(this.__parent.getResizedDimensionLineStartAt(bc,bg)!=null||this.__parent.getResizedDimensionLineEndAt(bc,bg)!=null){this.__parent.setState(this.__parent.getDimensionLineResizeState())}else{if(this.__parent.getWidthAndDepthResizedPieceOfFurnitureAt(bc,bg)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureResizeState())}else{if(this.__parent.getResizedWallStartAt(bc,bg)!=null||this.__parent.getResizedWallEndAt(bc,bg)!=null){this.__parent.setState(this.__parent.getWallResizeState())}else{if(this.__parent.getResizedRoomAt(bc,bg)!=null){this.__parent.setState(this.__parent.getRoomResizeState())}else{if(this.__parent.getOffsetDimensionLineAt(bc,bg)!=null){this.__parent.setState(this.__parent.getDimensionLineOffsetState())}else{if(this.__parent.getResizedPolylineAt(bc,bg)!=null){this.__parent.setState(this.__parent.getPolylineResizeState())}else{if(this.__parent.getPitchRotatedPieceOfFurnitureAt(bc,bg)!=null){this.__parent.setState(this.__parent.getPieceOfFurniturePitchRotationState())}else{if(this.__parent.getRollRotatedPieceOfFurnitureAt(bc,bg)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureRollRotationState())}else{if(this.__parent.getModifiedLightPowerAt(bc,bg)!=null){this.__parent.setState(this.__parent.getLightPowerModificationState())}else{if(this.__parent.getHeightResizedPieceOfFurnitureAt(bc,bg)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureHeightState())}else{if(this.__parent.getArcExtentWallAt(bc,bg)!=null){this.__parent.setState(this.__parent.getWallArcExtentState())}else{if(this.__parent.getRotatedPieceOfFurnitureAt(bc,bg)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureRotationState())}else{if(this.__parent.getElevatedPieceOfFurnitureAt(bc,bg)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureElevationState())}else{if(this.__parent.getPieceOfFurnitureNameAt(bc,bg)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureNameOffsetState())}else{if(this.__parent.getPieceOfFurnitureRotatedNameAt(bc,bg)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureNameRotationState())}else{if(this.__parent.getRotatedCompassAt(bc,bg)!=null){this.__parent.setState(this.__parent.getCompassRotationState())}else{if(this.__parent.getResizedCompassAt(bc,bg)!=null){this.__parent.setState(this.__parent.getCompassResizeState())}else{if(!bd&&(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH||this.__parent.getSelectableItemAt(bc,bg)!=null)){this.__parent.setState(this.__parent.getSelectionMoveState())}else{this.__parent.setState(this.__parent.getRectangleSelectionState())}}}}}}}}}}}}}}}}}}}}}}}}}}}}else{if(bb===2){var be=this.__parent.getSelectableItemAt(bc,bg);if(!bd&&be!=null){if(be!=null&&be instanceof Wall){this.__parent.modifySelectedWalls()}else{if(be!=null&&be instanceof HomePieceOfFurniture){this.__parent.modifySelectedFurniture()}else{if(be!=null&&be instanceof Room){this.__parent.modifySelectedRooms()}else{if(be!=null&&be instanceof Polyline){this.__parent.modifySelectedPolylines()}else{if(be!=null&&be instanceof Label){this.__parent.modifySelectedLabels()}else{if(be!=null&&be instanceof Compass){this.__parent.modifyCompass()}else{if(be!=null&&be instanceof ObserverCamera){this.__parent.modifyObserverCamera()}}}}}}}}}}};ba.prototype.exit=function(){if(this.__parent.getView()!=null){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.removeSelectionListener(this.selectionListener);this.__parent.getView().setResizeIndicatorVisible(false)}};return ba}(ai.AbstractModeChangeState));ai.SelectionState=aR;aR.__class="com.eteks.sweethome3d.viewcontroller.PlanController.SelectionState";(function(a9){var ba=(function(){function bb(bc){this.__parent=bc}bb.prototype.selectionChanged=function(bc){var bd=this.__parent.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.__parent.__parent.getView().setResizeIndicatorVisible(bd.length===1&&(this.__parent.__parent.isItemResizable(bd[0])||this.__parent.__parent.isItemMovable(bd[0])))};return bb}());a9.SelectionState$0=ba;ba.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"]})(aR=ai.SelectionState||(ai.SelectionState={}));var q=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this,bb)||this;bc.__parent=bb;if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}return bc}ba.prototype.getMode=function(){return ai.Mode.WALL_CREATION_$LI$()};ba.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW);this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())};ba.prototype.moveMouse=function(bc,bd){if(this.magnetismEnabled){var bb=new ai.WallPointWithAngleMagnetism(this.__parent,null,bc,bd,bc,bd);bc=bb.getX();bd=bb.getY()}this.__parent.getView().setAlignmentFeedback(Wall,null,bc,bd,false)};ba.prototype.pressMouse=function(bc,bf,bb,bd,be){this.__parent.setState(this.__parent.getWallDrawingState())};ba.prototype.setEditionActivated=function(bb){if(bb){this.__parent.setState(this.__parent.getWallDrawingState());this.setEditionActivated(bb)}};ba.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);if(this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};ba.prototype.exit=function(){this.__parent.getView().deleteFeedback()};return ba}(ai.AbstractModeChangeState));ai.WallCreationState=q;q.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallCreationState";var z=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this,bb)||this;bc.__parent=bb;if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}return bc}a9.prototype.getMode=function(){return ai.Mode.DIMENSION_LINE_CREATION_$LI$()};a9.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW);this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())};a9.prototype.moveMouse=function(bc,bd){this.__parent.getView().setAlignmentFeedback(DimensionLine,null,bc,bd,false);var bb=this.__parent.getMeasuringDimensionLineAt(bc,bd,this.magnetismEnabled);if(bb!=null){this.__parent.getView().setDimensionLinesFeedback([bb].slice(0))}else{this.__parent.getView().setDimensionLinesFeedback(null)}};a9.prototype.pressMouse=function(bc,bf,bb,bd,be){if(bb===1){this.__parent.setState(this.__parent.getDimensionLineDrawingState())}};a9.prototype.setEditionActivated=function(bb){if(bb){this.__parent.setState(this.__parent.getDimensionLineDrawingState());this.setEditionActivated(bb)}};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);if(this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};a9.prototype.exit=function(){this.__parent.getView().deleteFeedback()};return a9}(ai.AbstractModeChangeState));ai.DimensionLineCreationState=z;z.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineCreationState";var b=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this,bb)||this;bc.__parent=bb;if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}return bc}ba.prototype.getMode=function(){return ai.Mode.ROOM_CREATION_$LI$()};ba.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW);this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())};ba.prototype.moveMouse=function(bc,be){if(this.magnetismEnabled){var bb=new ai.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,bc,be);if(bb.isMagnetized()){this.__parent.getView().setAlignmentFeedback(Room,null,bb.getX(),bb.getY(),bb.isMagnetized())}else{var bd=new ai.RoomPointWithAngleMagnetism(this.__parent,null,-1,this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove(),this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove());this.__parent.getView().setAlignmentFeedback(Room,null,bd.getX(),bd.getY(),bb.isMagnetized())}}else{this.__parent.getView().setAlignmentFeedback(Room,null,bc,be,false)}};ba.prototype.pressMouse=function(bc,bf,bb,bd,be){this.__parent.setState(this.__parent.getRoomDrawingState())};ba.prototype.setEditionActivated=function(bb){if(bb){this.__parent.setState(this.__parent.getRoomDrawingState());this.setEditionActivated(bb)}};ba.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);if(this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};ba.prototype.exit=function(){this.__parent.getView().deleteFeedback()};return ba}(ai.AbstractModeChangeState));ai.RoomCreationState=b;b.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomCreationState";var aU=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this,bb)||this;bc.__parent=bb;return bc}a9.prototype.getMode=function(){return ai.Mode.POLYLINE_CREATION_$LI$()};a9.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW)};a9.prototype.pressMouse=function(bc,bf,bb,bd,be){this.__parent.setState(this.__parent.getPolylineDrawingState())};a9.prototype.setEditionActivated=function(bb){if(bb){this.__parent.setState(this.__parent.getPolylineDrawingState());this.setEditionActivated(bb)}};return a9}(ai.AbstractModeChangeState));ai.PolylineCreationState=aU;aU.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineCreationState";var aa=(function(a9){__extends(ba,a9);function ba(bb){var bc=a9.call(this,bb)||this;bc.__parent=bb;return bc}ba.prototype.getMode=function(){return ai.Mode.LABEL_CREATION_$LI$()};ba.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW)};ba.prototype.pressMouse=function(bc,bf,bb,bd,be){this.__parent.createLabel(bc,bf);if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}};return ba}(ai.AbstractModeChangeState));ai.LabelCreationState=aa;aa.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelCreationState";var Z=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this,bb)||this;bc.__parent=bb;if(bc.xStart===undefined){bc.xStart=0}if(bc.yStart===undefined){bc.yStart=0}if(bc.xLastEnd===undefined){bc.xLastEnd=0}if(bc.yLastEnd===undefined){bc.yLastEnd=0}if(bc.wallStartAtStart===undefined){bc.wallStartAtStart=null}if(bc.wallEndAtStart===undefined){bc.wallEndAtStart=null}if(bc.newWall===undefined){bc.newWall=null}if(bc.wallStartAtEnd===undefined){bc.wallStartAtEnd=null}if(bc.wallEndAtEnd===undefined){bc.wallEndAtEnd=null}if(bc.lastWall===undefined){bc.lastWall=null}if(bc.oldSelection===undefined){bc.oldSelection=null}if(bc.oldBasePlanLocked===undefined){bc.oldBasePlanLocked=false}if(bc.oldAllLevelsSelection===undefined){bc.oldAllLevelsSelection=false}if(bc.newWalls===undefined){bc.newWalls=null}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}if(bc.roundWall===undefined){bc.roundWall=false}if(bc.lastWallCreationTime===undefined){bc.lastWallCreationTime=0}if(bc.wallArcExtent===undefined){bc.wallArcExtent=null}return bc}a9.prototype.getMode=function(){return ai.Mode.WALL_CREATION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.setMode=function(bb){this.escape();if(bb===ai.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bb===ai.Mode.PANNING_$LI$()){this.__parent.setState(this.__parent.getPanningState())}else{if(bb===ai.Mode.ROOM_CREATION_$LI$()){this.__parent.setState(this.__parent.getRoomCreationState())}else{if(bb===ai.Mode.POLYLINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getPolylineCreationState())}else{if(bb===ai.Mode.DIMENSION_LINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getDimensionLineCreationState())}else{if(bb===ai.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}};a9.prototype.enter=function(){ba.prototype.enter.call(this);this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());this.xStart=this.__parent.getXLastMouseMove();this.yStart=this.__parent.getYLastMouseMove();this.wallEndAtStart=this.__parent.getWallEndAt(this.xStart,this.yStart,null);if(this.wallEndAtStart!=null){this.wallStartAtStart=null;this.xStart=this.wallEndAtStart.getXEnd();this.yStart=this.wallEndAtStart.getYEnd()}else{this.wallStartAtStart=this.__parent.getWallStartAt(this.xStart,this.yStart,null);if(this.wallStartAtStart!=null){this.xStart=this.wallStartAtStart.getXStart();this.yStart=this.wallStartAtStart.getYStart()}else{if(this.magnetismEnabled){var bc=new ai.WallPointWithAngleMagnetism(this.__parent,null,this.xStart,this.yStart,this.xStart,this.yStart);this.xStart=bc.getX();this.yStart=bc.getY()}}}this.newWall=null;this.wallStartAtEnd=null;this.wallEndAtEnd=null;this.lastWall=null;this.newWalls=([]);this.lastWallCreationTime=-1;this.__parent.deselectAll();this.setDuplicationActivated(this.__parent.wasDuplicationActivatedLastMousePress());var bb=this.__parent.getView();bb.setAlignmentFeedback(Wall,null,this.xStart,this.yStart,false)};a9.prototype.moveMouse=function(be,bg){var bd=this.__parent.getView();var bc;var bf;if(this.alignmentActivated){var bb=new ai.PointWithAngleMagnetism(this.xStart,this.yStart,be,bg,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bd.getPixelLength());bc=bb.getX();bf=bb.getY()}else{if(this.magnetismEnabled){var bb=new ai.WallPointWithAngleMagnetism(this.__parent,this.newWall,this.xStart,this.yStart,be,bg);bc=bb.getX();bf=bb.getY()}else{bc=be;bf=bg}}if(this.newWall==null){this.newWall=this.__parent.createWall(this.xStart,this.yStart,bc,bf,this.wallStartAtStart,this.wallEndAtStart);(this.newWalls.push(this.newWall)>0)}else{if(this.wallArcExtent!=null){this.wallArcExtent=this.getArcExtent(this.newWall.getXStart(),this.newWall.getXEnd(),this.newWall.getYStart(),this.newWall.getYEnd(),be,bg);if(this.alignmentActivated||this.magnetismEnabled){this.wallArcExtent=(function(bh){return bh*Math.PI/180})(Math.round((function(bh){return bh*180/Math.PI})(this.wallArcExtent)))}this.newWall.setArcExtent(this.wallArcExtent)}else{this.newWall.setXEnd(bc);this.newWall.setYEnd(bf)}}bd.setToolTipFeedback(this.getToolTipFeedbackText(this.newWall,false),be,bg);bd.setAlignmentFeedback(Wall,this.newWall,bc,bf,false);this.showWallAngleFeedback(this.newWall,false);this.wallStartAtEnd=this.__parent.getWallStartAt(bc,bf,this.newWall);if(this.wallStartAtEnd!=null){this.wallEndAtEnd=null;this.__parent.selectItem(this.wallStartAtEnd)}else{this.wallEndAtEnd=this.__parent.getWallEndAt(bc,bf,this.newWall);if(this.wallEndAtEnd!=null){this.__parent.selectItem(this.wallEndAtEnd)}else{this.__parent.deselectAll()}}bd.makePointVisible(be,bg);this.xLastEnd=bc;this.yLastEnd=bf};a9.prototype.pressMouse=function(bc,bg,bb,bd,bf){if(bb===2){var be=this.__parent.getSelectableItemAt(bc,bg);if(this.newWalls.length===0&&(be!=null&&be instanceof Room)){this.createWallsAroundRoom(be)}else{if(this.roundWall&&this.newWall!=null){this.endWallCreation()}if(this.lastWall!=null){this.__parent.joinNewWallEndToWall(this.lastWall,this.wallStartAtEnd,this.wallEndAtEnd)}}this.validateDrawnWalls()}else{if(this.newWall!=null&&this.newWall.getStartPointToEndPointDistance()>0){if(this.roundWall&&this.wallArcExtent==null){this.wallArcExtent=Math.PI;this.newWall.setArcExtent(this.wallArcExtent);this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(this.newWall,false),bc,bg)}else{this.__parent.getView().deleteToolTipFeedback();this.__parent.selectItem(this.newWall);this.endWallCreation()}}}};a9.prototype.createWallsAroundRoom=function(bD){if(bD.isSingular()){var bu=bD.getPoints();var bl=(bu.slice(0).slice(0));if(!bD.isClockwise()){bl.reverse()}for(var bz=0;bz<bl.length;){var bw=bl[bz];var bB=bl[(bz+1)%bl.length];if(bw[0]===bB[0]&&bw[1]===bB[1]){bl.splice(bz,1)[0]}else{bz++}}bu=bl.slice(0);var bm=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallThickness()/2;var bG=(function(bK){var bJ=[];while(bK-->0){bJ.push(null)}return bJ})(bu.length);for(var bz=0;bz<bu.length;bz++){var bw=bu[bz];var bv=bu[(bz+bu.length-1)%bu.length];var bB=bu[(bz+1)%bu.length];var by=Math.atan2(bw[0]-bv[0],bv[1]-bw[1]);var bF=(Math.cos(by)*bm);var bE=(Math.sin(by)*bm);var bh=[bv[0]-bF,bv[1]-bE];var bg=[bw[0]-bF,bw[1]-bE];var bH=Math.atan2(bB[0]-bw[0],bw[1]-bB[1]);bF=(Math.cos(bH)*bm);bE=(Math.sin(bH)*bm);var bf=[bw[0]-bF,bw[1]-bE];var be=[bB[0]-bF,bB[1]-bE];bG[bz]=ai.computeIntersection(bh,bg,bf,be)}var bn=null;var bp=this.__parent.getWallsArea(false);var bA=0.05;for(var bz=0;bz<bG.length;bz++){var bs=bG[bz];var bo=bG[(bz+1)%bu.length];var br=new java.awt.geom.Area(this.__parent.getPath(new Wall(bs[0],bs[1],bo[0],bo[1],bA,0).getPoints$()));br.subtract(bp);var bb=this.__parent.getAreaPaths(br);var bd=([]);var bI=0;for(var bx=0;bx<bb.length;bx++){var bc=this.__parent.getPathPoints(bb[bx],false);if(bc.length>4){bc=this.__parent.getPathPoints(bb[bx],true)}if(bc.length===4){var bh=void 0;var bg=void 0;if(java.awt.geom.Point2D.distanceSq(bc[0][0],bc[0][1],bc[1][0],bc[1][1])<java.awt.geom.Point2D.distanceSq(bc[0][0],bc[0][1],bc[3][0],bc[3][1])){bh=[(bc[0][0]+bc[1][0])/2,(bc[0][1]+bc[1][1])/2];bg=[(bc[2][0]+bc[3][0])/2,(bc[2][1]+bc[3][1])/2]}else{bh=[(bc[0][0]+bc[3][0])/2,(bc[0][1]+bc[3][1])/2];bg=[(bc[1][0]+bc[2][0])/2,(bc[1][1]+bc[2][1])/2]}var bt=void 0;var bq=void 0;if(java.awt.geom.Point2D.distanceSq(bh[0],bh[1],bs[0],bs[1])<java.awt.geom.Point2D.distanceSq(bg[0],bg[1],bs[0],bs[1])){bt=bh;bq=bg}else{bt=bg;bq=bh}if(java.awt.geom.Point2D.distanceSq(bt[0],bt[1],bq[0],bq[1])>0.01){(bd.push(this.__parent.createWall(bt[0],bt[1],bq[0],bq[1],null,bn!=null&&java.awt.geom.Point2D.distanceSq(bn.getXEnd(),bn.getYEnd(),bt[0],bt[1])<0.01?bn:null))>0)}else{bI++}}}if(bb.length>bI&&(bd.length==0)){var bk=null;var bj=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var bi=0;bi<bj.length;bi++){var bC=bj[bi];if(bC.isAtLevel(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&Math.abs(bC.getXStart()-bs[0])<0.05&&Math.abs(bC.getYStart()-bs[1])<0.05&&Math.abs(bC.getXEnd()-bo[0])<0.05&&Math.abs(bC.getYEnd()-bo[1])<0.05&&(bC.getArcExtent()==null||bC.getArcExtent()===0)){bk=bC;break}}if(bk==null){(bd.push(this.__parent.createWall(bs[0],bs[1],bo[0],bo[1],null,bn))>0)}}if(bd.length>0){(function(bJ,bK){if(bK.compare){bJ.sort(function(bM,bL){return bK.compare(bM,bL)})}else{bJ.sort(bK)}})(bd,new a9.WallDrawingState$0(this,bs));(function(bK,bJ){return bK.push.apply(bK,bJ)})(this.newWalls,bd);bn=bd[bd.length-1]}else{bn=null}}if(bn!=null&&java.awt.geom.Point2D.distanceSq(bn.getXEnd(),bn.getYEnd(),this.newWalls[0].getXStart(),this.newWalls[0].getYStart())<0.01){this.__parent.joinNewWallEndToWall(bn,this.newWalls[0],null)}}};a9.prototype.validateDrawnWalls=function(){if(this.newWalls.length>0){this.__parent.postCreateWalls(this.newWalls,this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection);this.__parent.selectItems(this.newWalls)}if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getWallCreationState())}};a9.prototype.endWallCreation=function(){this.lastWall=this.wallEndAtStart=this.newWall;this.wallStartAtStart=null;this.xStart=this.newWall.getXEnd();this.yStart=this.newWall.getYEnd();this.newWall=null;this.wallArcExtent=null};a9.prototype.setEditionActivated=function(be){var bf=this;var bb=this.__parent.getView();if(be){bb.deleteFeedback();if(this.newWalls.length===0&&this.wallEndAtStart==null&&this.wallStartAtStart==null){bb.setToolTipEditedProperties(["X","Y"],[this.xStart,this.yStart],this.xStart,this.yStart)}else{if(this.newWall==null){this.createNextWall()}if(this.wallArcExtent==null){bb.setToolTipEditedProperties(["LENGTH","ANGLE","THICKNESS"],[this.newWall.getLength(),this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(this.newWall),this.newWall.getThickness()],this.newWall.getXEnd(),this.newWall.getYEnd())}else{bb.setToolTipEditedProperties(["ARC_EXTENT"],[new Number((Math.round((function(bg){return bg*180/Math.PI})(this.wallArcExtent))|0)).valueOf()],this.newWall.getXEnd(),this.newWall.getYEnd())}}}else{if(this.newWall==null){var bc=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit();var bd=bc===LengthUnit.INCH||bc===LengthUnit.INCH_DECIMALS?LengthUnit.footToCentimeter(10):300;this.xLastEnd=this.xStart+bd;this.yLastEnd=this.yStart;this.newWall=this.__parent.createWall(this.xStart,this.yStart,this.xLastEnd,this.yLastEnd,this.wallStartAtStart,this.wallEndAtStart);(this.newWalls.push(this.newWall)>0);bb.deleteFeedback();this.setEditionActivated(true)}else{if(this.roundWall&&this.wallArcExtent==null){this.wallArcExtent=Math.PI;this.newWall.setArcExtent(this.wallArcExtent);this.setEditionActivated(true)}else{if(Date.now()-this.lastWallCreationTime<300){if(this.newWalls.length>1){(function(bg){var bh=bg.indexOf(bf.newWall);if(bh>=0){bg.splice(bh,1);return true}else{return false}})(this.newWalls);this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(this.newWall)}this.validateDrawnWalls()}else{this.endWallCreation();if(this.newWalls.length>2&&this.wallStartAtEnd!=null){this.__parent.joinNewWallEndToWall(this.lastWall,this.wallStartAtEnd,null);this.validateDrawnWalls();return}this.createNextWall();bb.deleteToolTipFeedback();this.setEditionActivated(true)}}}}};a9.prototype.createNextWall=function(){var bd=this.wallEndAtStart!=null?this.wallEndAtStart:this.wallStartAtStart;var bc=Math.PI-Math.atan2(bd.getYStart()-bd.getYEnd(),bd.getXStart()-bd.getXEnd());bc-=Math.PI/2;var bb=bd.getStartPointToEndPointDistance();this.xLastEnd=(this.xStart+bb*Math.cos(bc));this.yLastEnd=(this.yStart-bb*Math.sin(bc));this.newWall=this.__parent.createWall(this.xStart,this.yStart,this.xLastEnd,this.yLastEnd,this.wallStartAtStart,bd);this.newWall.setThickness(bd.getThickness());(this.newWalls.push(this.newWall)>0);this.lastWallCreationTime=Date.now();this.__parent.deselectAll()};a9.prototype.updateEditableProperty=function(bh,bk){var bg=this.__parent.getView();if(this.newWall==null){var bf=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength();switch((bh)){case"X":this.xStart=bk!=null?bk:0;this.xStart=Math.max(-bf,Math.min(this.xStart,bf));break;case"Y":this.yStart=bk!=null?bk:0;this.yStart=Math.max(-bf,Math.min(this.yStart,bf));break}bg.setAlignmentFeedback(Wall,null,this.xStart,this.yStart,true);bg.makePointVisible(this.xStart,this.yStart)}else{if(bh==="THICKNESS"){var bi=bk!=null?Math.abs(bk):0;bi=Math.max(0.01,Math.min(bi,1000));this.newWall.setThickness(bi)}else{if(bh==="ARC_EXTENT"){var bb=(function(bl){return bl*Math.PI/180})(bk!=null?bk:0);this.wallArcExtent=((function(bl){if(bl>0){return 1}else{if(bl<0){return -1}else{return 0}}})(bb)*Math.min(Math.abs(bb),3*Math.PI/2));this.newWall.setArcExtent(this.wallArcExtent);this.showWallAngleFeedback(this.newWall,false)}else{switch((bh)){case"LENGTH":var bc=bk!=null?bk:0;bc=Math.max(0.001,Math.min(bc,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()));var bj=Math.PI-Math.atan2(this.yStart-this.yLastEnd,this.xStart-this.xLastEnd);this.xLastEnd=(this.xStart+bc*Math.cos(bj));this.yLastEnd=(this.yStart-bc*Math.sin(bj));break;case"ANGLE":bj=(function(bl){return bl*Math.PI/180})(bk!=null?bk:0);var bd=this.newWall.getWallAtStart();if(bd!=null&&bd.getStartPointToEndPointDistance()>0){bj-=Math.atan2(bd.getYStart()-bd.getYEnd(),bd.getXStart()-bd.getXEnd())}var be=this.newWall.getStartPointToEndPointDistance();this.xLastEnd=(this.xStart+be*Math.cos(bj));this.yLastEnd=(this.yStart-be*Math.sin(bj));break;default:return}this.newWall.setXEnd(this.xLastEnd);this.newWall.setYEnd(this.yLastEnd);bg.setAlignmentFeedback(Wall,this.newWall,this.xLastEnd,this.yLastEnd,false);this.showWallAngleFeedback(this.newWall,false);bg.makePointVisible(this.xStart,this.yStart);bg.makePointVisible(this.xLastEnd,this.yLastEnd);if(this.newWalls.length>2&&this.newWalls[0].getWallAtStart()==null&&this.newWalls[0].containsWallStartAt(this.xLastEnd,this.yLastEnd,0.001)){this.wallStartAtEnd=this.newWalls[0];this.__parent.selectItem(this.wallStartAtEnd)}else{this.wallStartAtEnd=null;this.__parent.deselectAll()}}}}};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);if(this.newWall!=null){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setDuplicationActivated=function(bb){this.roundWall=bb};a9.prototype.escape=function(){var bb=this;if(this.newWall!=null){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(this.newWall);(function(bc){var bd=bc.indexOf(bb.newWall);if(bd>=0){bc.splice(bd,1);return true}else{return false}})(this.newWalls)}this.validateDrawnWalls()};a9.prototype.exit=function(){var bb=this.__parent.getView();bb.deleteFeedback();this.wallStartAtStart=null;this.wallEndAtStart=null;this.newWall=null;this.wallArcExtent=null;this.wallStartAtEnd=null;this.wallEndAtEnd=null;this.lastWall=null;this.oldSelection=null;this.newWalls=null};return a9}(ai.AbstractWallState));ai.WallDrawingState=Z;Z.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallDrawingState";(function(a9){var ba=(function(){function bb(bd,bc){this.sidePoint=bc;this.__parent=bd}bb.prototype.compare=function(bd,bc){return(java.awt.geom.Point2D.distanceSq(bd.getXStart(),bd.getYStart(),this.sidePoint[0],this.sidePoint[1])-java.awt.geom.Point2D.distanceSq(bc.getXStart(),bc.getYStart(),this.sidePoint[0],this.sidePoint[1]))};return bb}());a9.WallDrawingState$0=ba})(Z=ai.WallDrawingState||(ai.WallDrawingState={}));var T=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this,bb)||this;bc.__parent=bb;if(bc.selectedWall===undefined){bc.selectedWall=null}if(bc.startPoint===undefined){bc.startPoint=false}if(bc.oldX===undefined){bc.oldX=0}if(bc.oldY===undefined){bc.oldY=0}if(bc.deltaXToResizePoint===undefined){bc.deltaXToResizePoint=0}if(bc.deltaYToResizePoint===undefined){bc.deltaYToResizePoint=0}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.enter=function(){ba.prototype.enter.call(this);this.selectedWall=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.startPoint=this.selectedWall===this.__parent.getResizedWallStartAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());if(this.startPoint){this.oldX=this.selectedWall.getXStart();this.oldY=this.selectedWall.getYStart()}else{this.oldX=this.selectedWall.getXEnd();this.oldY=this.selectedWall.getYEnd()}this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.oldX;this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.oldY;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,true),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());bb.setAlignmentFeedback(Wall,this.selectedWall,this.oldX,this.oldY,false);this.showWallAngleFeedback(this.selectedWall,true);bb.setDimensionLinesFeedback(this.getDimensionLinesAlongWall(this.selectedWall))};a9.prototype.moveMouse=function(be,bi){var bd=this.__parent.getView();var bg=be-this.deltaXToResizePoint;var bf=bi-this.deltaYToResizePoint;var bc=this.startPoint?this.selectedWall.getXEnd():this.selectedWall.getXStart();var bh=this.startPoint?this.selectedWall.getYEnd():this.selectedWall.getYStart();if(this.alignmentActivated){var bb=new ai.PointWithAngleMagnetism(bc,bh,bg,bf,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bd.getPixelLength());bg=bb.getX();bf=bb.getY()}else{if(this.magnetismEnabled){var bb=new ai.WallPointWithAngleMagnetism(this.__parent,this.selectedWall,bc,bh,bg,bf);bg=bb.getX();bf=bb.getY()}}ai.moveWallPoint(this.selectedWall,bg,bf,this.startPoint);bd.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,true),be,bi);bd.setAlignmentFeedback(Wall,this.selectedWall,bg,bf,false);this.showWallAngleFeedback(this.selectedWall,true);bd.setDimensionLinesFeedback(this.getDimensionLinesAlongWall(this.selectedWall));bd.makePointVisible(be,bi)};a9.prototype.getDimensionLinesAlongWall=function(bk){var bh=([]);if(bk.getArcExtent()==null||bk.getArcExtent()===0){var bf=20/this.__parent.getView().getScale();var bm=bk.getPoints$();var bl=this.__parent.getRoomPathsFromWalls();for(var bi=0;bi<bl.length;bi++){var bd=this.__parent.getPathPoints(bl[bi],true);for(var bg=0;bg<bd.length;bg++){var bc=bd[bg];var bj=bd[(bg+1)%bd.length];var be=java.awt.geom.Line2D.ptLineDistSq(bm[0][0],bm[0][1],bm[1][0],bm[1][1],bc[0],bc[1])<0.0001&&java.awt.geom.Line2D.ptLineDistSq(bm[0][0],bm[0][1],bm[1][0],bm[1][1],bj[0],bj[1])<0.0001;var bb=void 0;if(be){bb=java.awt.geom.Line2D.ptSegDistSq(bm[0][0],bm[0][1],bm[1][0],bm[1][1],bc[0],bc[1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bm[0][0],bm[0][1],bm[1][0],bm[1][1],bj[0],bj[1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bc[0],bc[1],bj[0],bj[1],bm[0][0],bm[0][1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bc[0],bc[1],bj[0],bj[1],bm[1][0],bm[1][1])<0.0001}else{bb=java.awt.geom.Line2D.ptLineDistSq(bm[2][0],bm[2][1],bm[3][0],bm[3][1],bc[0],bc[1])<0.0001&&java.awt.geom.Line2D.ptLineDistSq(bm[2][0],bm[2][1],bm[3][0],bm[3][1],bj[0],bj[1])<0.0001&&(java.awt.geom.Line2D.ptSegDistSq(bm[2][0],bm[2][1],bm[3][0],bm[3][1],bc[0],bc[1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bm[2][0],bm[2][1],bm[3][0],bm[3][1],bj[0],bj[1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bc[0],bc[1],bj[0],bj[1],bm[2][0],bm[2][1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bc[0],bc[1],bj[0],bj[1],bm[3][0],bm[3][1])<0.0001)}if(bb){(bh.push(this.__parent.getDimensionLineBetweenPoints(bc,bj,this.isDimensionInsideWall(bk,bc,bj)?-bf:bf,false))>0)}}}for(var bi=bh.length-1;bi>=0;bi--){if(bh[bi].getLength()<0.01){bh.splice(bi,1)[0]}}if(bh.length===2&&Math.abs(bh[0].getLength()-bh[1].getLength())<0.01){bh.splice(1,1)[0]}}return bh};a9.prototype.isDimensionInsideWall=function(bb,be,bd){var bc=java.awt.geom.AffineTransform.getRotateInstance(Math.atan2(bd[1]-be[1],bd[0]-be[0]),be[0],be[1]);var bf=[(be[0]+java.awt.geom.Point2D.distance(be[0],be[1],bd[0],bd[1])/2),be[1]+0.01];bc.transform(bf,0,bf,0,1);return bb.containsPoint$float$float$float(bf[0],bf[1],0)};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postWallResize(this.selectedWall,this.oldX,this.oldY,this.startPoint);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){ai.moveWallPoint(this.selectedWall,this.oldX,this.oldY,this.startPoint);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedWall=null};return a9}(ai.AbstractWallState));ai.WallResizeState=T;T.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallResizeState";var C=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this,bb)||this;bc.__parent=bb;if(bc.selectedWall===undefined){bc.selectedWall=null}if(bc.oldArcExtent===undefined){bc.oldArcExtent=null}if(bc.deltaXToMiddlePoint===undefined){bc.deltaXToMiddlePoint=0}if(bc.deltaYToMiddlePoint===undefined){bc.deltaYToMiddlePoint=0}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.enter=function(){ba.prototype.enter.call(this);this.selectedWall=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldArcExtent=this.selectedWall.getArcExtent();var be=this.selectedWall.getPoints$();var bd=(be.length/4|0);var bc=be.length-1-bd;if(be.length%4===0){bd--}var bg=(be[bd][0]+be[bc][0])/2;var bf=(be[bd][1]+be[bc][1])/2;this.deltaXToMiddlePoint=this.__parent.getXLastMousePress()-bg;this.deltaYToMiddlePoint=this.__parent.getYLastMousePress()-bf;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,false),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());this.showWallAngleFeedback(this.selectedWall,false)};a9.prototype.moveMouse=function(bc,bg){var bb=this.__parent.getView();var bf=bc-this.deltaXToMiddlePoint;var be=bg-this.deltaYToMiddlePoint;var bd=this.getArcExtent(this.selectedWall.getXStart(),this.selectedWall.getYStart(),this.selectedWall.getXEnd(),this.selectedWall.getYEnd(),bf,be);if(this.alignmentActivated||this.magnetismEnabled){bd=(function(bh){return bh*Math.PI/180})(Math.round((function(bh){return bh*180/Math.PI})(bd)))}this.selectedWall.setArcExtent(bd);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,false),bc,bg);this.showWallAngleFeedback(this.selectedWall,false);bb.makePointVisible(bc,bg)};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postWallArcExtent(this.selectedWall,this.oldArcExtent);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){this.selectedWall.setArcExtent(this.oldArcExtent);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedWall=null};return a9}(ai.AbstractWallState));ai.WallArcExtentState=C;C.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallArcExtentState";var w=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this,bb)||this;bc.__parent=bb;if(bc.xPreviousPoint===undefined){bc.xPreviousPoint=0}if(bc.yPreviousPoint===undefined){bc.yPreviousPoint=0}if(bc.newRoom===undefined){bc.newRoom=null}if(bc.newPoint===undefined){bc.newPoint=null}if(bc.oldSelection===undefined){bc.oldSelection=null}if(bc.oldBasePlanLocked===undefined){bc.oldBasePlanLocked=false}if(bc.oldAllLevelsSelection===undefined){bc.oldAllLevelsSelection=false}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}if(bc.lastPointCreationTime===undefined){bc.lastPointCreationTime=0}return bc}a9.prototype.getMode=function(){return ai.Mode.ROOM_CREATION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.setMode=function(bb){this.escape();if(bb===ai.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bb===ai.Mode.PANNING_$LI$()){this.__parent.setState(this.__parent.getPanningState())}else{if(bb===ai.Mode.WALL_CREATION_$LI$()){this.__parent.setState(this.__parent.getWallCreationState())}else{if(bb===ai.Mode.POLYLINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getPolylineCreationState())}else{if(bb===ai.Mode.DIMENSION_LINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getDimensionLineCreationState())}else{if(bb===ai.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}};a9.prototype.enter=function(){ba.prototype.enter.call(this);this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();this.newRoom=null;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());if(this.magnetismEnabled){var bb=new ai.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove());if(bb.isMagnetized()){this.xPreviousPoint=bb.getX();this.yPreviousPoint=bb.getY()}else{var bc=new ai.RoomPointWithAngleMagnetism(this.__parent,null,-1,this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove(),this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove());this.xPreviousPoint=bc.getX();this.yPreviousPoint=bc.getY()}this.__parent.getView().setAlignmentFeedback(Room,null,this.xPreviousPoint,this.yPreviousPoint,bb.isMagnetized())}else{this.xPreviousPoint=this.__parent.getXLastMousePress();this.yPreviousPoint=this.__parent.getYLastMousePress();this.__parent.getView().setAlignmentFeedback(Room,null,this.xPreviousPoint,this.yPreviousPoint,false)}this.__parent.deselectAll()};a9.prototype.moveMouse=function(bh,bg){var be=this.__parent.getView();var bb=bh;var bi=bg;var bd=false;if(this.alignmentActivated){var bf=new ai.PointWithAngleMagnetism(this.xPreviousPoint,this.yPreviousPoint,bh,bg,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),be.getPixelLength());bb=bf.getX();bi=bf.getY()}else{if(this.magnetismEnabled){var bj=this.newRoom!=null?new ai.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,this.newRoom,this.newRoom.getPointCount()-1,bh,bg):new ai.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,bh,bg);bd=bj.isMagnetized();if(bd){bb=bj.getX();bi=bj.getY()}else{var bc=this.newRoom!=null?this.newRoom.getPointCount()-1:-1;var bf=new ai.RoomPointWithAngleMagnetism(this.__parent,this.newRoom,bc,this.xPreviousPoint,this.yPreviousPoint,bh,bg);bb=bf.getX();bi=bf.getY()}}}if(this.newRoom==null){this.newRoom=this.createAndSelectRoom(this.xPreviousPoint,this.yPreviousPoint,bb,bi)}else{if(this.newPoint!=null){var bk=this.newRoom.getPoints();this.xPreviousPoint=bk[bk.length-1][0];this.yPreviousPoint=bk[bk.length-1][1];this.newRoom.addPoint$float$float(bb,bi);this.newPoint=null}else{this.newRoom.setPoint(bb,bi,this.newRoom.getPointCount()-1)}}be.setToolTipFeedback(this.getToolTipFeedbackText(this.newRoom,this.newRoom.getPointCount()-1),bh,bg);be.setAlignmentFeedback(Room,this.newRoom,bb,bi,bd);this.showRoomAngleFeedback(this.newRoom,this.newRoom.getPointCount()-1);be.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.newRoom,this.newRoom.getPointCount()-1));be.makePointVisible(bh,bg)};a9.prototype.createAndSelectRoom=function(bf,bd,bb,be){var bc=this.__parent.createRoom([[bf,bd],[bb,be]]);var bg=this.__parent.getInsideWallsArea();bc.setCeilingVisible(bg.contains(bf,bd));this.__parent.selectItem(bc);return bc};a9.prototype.pressMouse=function(bc,bf,bb,bd,be){if(bb===2){if(this.newRoom==null){this.newRoom=this.createRoomAt(bc,bf);if(this.newRoom!=null){this.__parent.selectItem(this.newRoom)}}this.validateDrawnRoom()}else{this.endRoomSide()}};a9.prototype.validateDrawnRoom=function(){if(this.newRoom!=null){var bb=this.newRoom.getPoints();if(bb.length<3){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteRoom(this.newRoom)}else{this.__parent.postCreateRooms([this.newRoom].slice(0),this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection)}}if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getRoomCreationState())}};a9.prototype.endRoomSide=function(){if(this.newRoom!=null&&this.getRoomSideLength(this.newRoom,this.newRoom.getPointCount()-1)>0){this.newPoint=[0,0];if(this.newRoom.isCeilingVisible()){var bb=this.newRoom.getPoints();var bc=bb[bb.length-1];if(!this.__parent.getInsideWallsArea().contains(bc[0],bc[1])){this.newRoom.setCeilingVisible(false)}}}};a9.prototype.createRoomAt=function(bB,bA){var bb=this.__parent.getRoomPathsFromWalls();for(var bv=0;bv<bb.length;bv++){var bf=bb[bv];if(bf.contains(bB,bA)){var bo=this.getVisibleDoorsAndWindowsAtGround(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture());for(var bE=0;bE<bo.length;bE++){var bk=bo[bE];var bd=bk.getPoints();var bJ=0;for(var bK=0;bK<bd.length;bK++){if(bf.contains(bd[bK][0],bd[bK][1])){bJ++}}if(bd.length===4){var bH=0.05;var bh=null;if((bk!=null&&bk instanceof HomeDoorOrWindow)&&bk.isWallCutOutOnBothSides()){var bF=bk;var bc=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var bz=new java.awt.geom.Area(this.__parent.getPath(bd));var bL=new java.awt.geom.Area();var bn=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var bC=0;bC<bn.length;bC++){var be=bn[bC];if(be.isAtLevel(bc)&&bF.isParallelToWall(be)){var bl=this.__parent.getPath(be.getPoints$());var bm=new java.awt.geom.Area(bl);bm.intersect(bz);if(!bm.isEmpty()){var bq=(function(bP){if(bP.clone!=undefined){return bP.clone()}else{var bQ=Object.create(bP);for(var bO in bP){if(bP.hasOwnProperty(bO)){bQ[bO]=bP[bO]}}return bQ}})(bF);bq.setDepthInPlan(bq.getDepth()+4*be.getThickness());bm=new java.awt.geom.Area(bl);bm.intersect(new java.awt.geom.Area(this.__parent.getPath(bq.getPoints())));bL.add(bm)}}}if(!bL.isEmpty()&&bL.isSingular()){var bg=this.__parent.getPathPoints(this.__parent.getPath(bL),true);if(bg.length===4){var bu=bF.getY()+bF.getDepth()*(-0.5+bF.getWallDistance()+bF.getWallThickness()/2);var bt=bF.getWidth()/2;var bp=[bF.getX()-bt,bu,bF.getX()+bt,bu];var bs=java.awt.geom.AffineTransform.getRotateInstance(bF.getAngle(),bF.getX(),bF.getY());bs.transform(bp,0,bp,0,2);for(var bK=0;bK<bg.length-1;bK++){if(bf.intersects(bg[bK][0]-bH/2,bg[bK][1]-bH/2,bH,bH)){var bj=bK;var by=void 0;var bx=void 0;if(bf.intersects(bg[bK+1][0]-bH/2,bg[bK+1][1]-bH/2,bH,bH)){bx=(bK+2)%4;by=(bK+3)%4}else{if(bf.intersects(bg[(bK+3)%4][0]-bH/2,bg[(bK+3)%4][1]-bH/2,bH,bH)){by=(bK+1)%4;bx=(bK+2)%4}else{break}}if(java.awt.geom.Point2D.distanceSq(bg[bj][0],bg[bj][1],bp[0],bp[1])<java.awt.geom.Point2D.distanceSq(bg[bj][0],bg[bj][1],bp[2],bp[3])){bg[by][0]=bp[0];bg[by][1]=bp[1];bg[bx][0]=bp[2];bg[bx][1]=bp[3]}else{bg[by][0]=bp[2];bg[by][1]=bp[3];bg[bx][0]=bp[0];bg[bx][1]=bp[1]}bh=bg;break}}}}}if(bh==null&&bJ===2){var bL=new java.awt.geom.Area(this.__parent.getWallsArea(false));bL.intersect(new java.awt.geom.Area(this.__parent.getPath(bd)));var bg=this.__parent.getPathPoints(this.__parent.getPath(bL),false);if(bg.length===4){for(var bK=0;bK<bg.length;bK++){if(bf.intersects(bg[bK][0]-bH/2,bg[bK][1]-bH/2,bH,bH)){var bj=bK;var bi=void 0;var by=void 0;var bx=void 0;if(bf.intersects(bg[bK+1][0]-bH/2,bg[bK+1][1]-bH/2,bH,bH)){bi=bK+1;bx=(bK+2)%4;by=(bK+3)%4}else{by=(bK+1)%4;bx=(bK+2)%4;bi=(bK+3)%4}bg[by][0]=(bg[by][0]+bg[bj][0])/2;bg[by][1]=(bg[by][1]+bg[bj][1])/2;bg[bx][0]=(bg[bx][0]+bg[bi][0])/2;bg[bx][1]=(bg[bx][1]+bg[bi][1])/2;bh=bg;break}}}}if(bh!=null){var bG=this.__parent.getPath(bh);var bM=bG.getBounds2D();var br=java.awt.geom.AffineTransform.getTranslateInstance(bM.getCenterX(),bM.getCenterY());var bN=Math.min(bM.getWidth(),bM.getHeight());var bw=(bN+bH)/bN;br.scale(bw,bw);br.translate(-bM.getCenterX(),-bM.getCenterY());var bI=bG.createTransformedShape(br);var bD=new java.awt.geom.Area(bI);bD.add(new java.awt.geom.Area(bf));bf=this.__parent.getPath(bD)}}}return this.__parent.createRoom(this.__parent.getPathPoints(bf,false))}}return null};a9.prototype.getVisibleDoorsAndWindowsAtGround=function(bd){var be=([]);for(var bb=0;bb<bd.length;bb++){var bc=bd[bb];if(this.__parent.isPieceOfFurnitureVisibleAtSelectedLevel(bc)&&bc.getElevation()===0){if(bc!=null&&bc instanceof HomeFurnitureGroup){(function(bg,bf){return bg.push.apply(bg,bf)})(be,this.getVisibleDoorsAndWindowsAtGround(bc.getFurniture()))}else{if(bc.isDoorOrWindow()){(be.push(bc)>0)}}}}return be};a9.prototype.setEditionActivated=function(be){var bb=this.__parent.getView();if(be){bb.deleteFeedback();if(this.newRoom==null){bb.setToolTipEditedProperties(["X","Y"],[this.xPreviousPoint,this.yPreviousPoint],this.xPreviousPoint,this.yPreviousPoint)}else{if(this.newPoint!=null){this.createNextSide()}var bf=this.newRoom.getPoints();bb.setToolTipEditedProperties(["LENGTH","ANGLE"],[this.getRoomSideLength(this.newRoom,bf.length-1),this.getRoomSideAngle(this.newRoom,bf.length-1)],bf[bf.length-1][0],bf[bf.length-1][1])}}else{if(this.newRoom==null){var bc=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit();var bd=bc===LengthUnit.INCH||bc===LengthUnit.INCH_DECIMALS?LengthUnit.footToCentimeter(10):300;this.newRoom=this.createAndSelectRoom(this.xPreviousPoint,this.yPreviousPoint,this.xPreviousPoint+bd,this.yPreviousPoint);bb.deleteFeedback();this.setEditionActivated(true)}else{if(Date.now()-this.lastPointCreationTime<300){this.escape()}else{this.endRoomSide();var bf=this.newRoom.getPoints();if(bf.length>2&&this.newRoom.getPointIndexAt(bf[bf.length-1][0],bf[bf.length-1][1],0.001)===0){this.newRoom.removePoint(this.newRoom.getPointCount()-1);this.validateDrawnRoom();return}this.createNextSide();bb.deleteToolTipFeedback();this.setEditionActivated(true)}}}};a9.prototype.createNextSide=function(){var bc=this.newRoom.getPoints();this.xPreviousPoint=bc[bc.length-1][0];this.yPreviousPoint=bc[bc.length-1][1];var bd=Math.PI-Math.atan2(bc[bc.length-2][1]-bc[bc.length-1][1],bc[bc.length-2][0]-bc[bc.length-1][0]);bd-=Math.PI/2;var bb=this.getRoomSideLength(this.newRoom,bc.length-1);this.newRoom.addPoint$float$float((this.xPreviousPoint+bb*Math.cos(bd)),(this.yPreviousPoint-bb*Math.sin(bd)));this.newPoint=null;this.lastPointCreationTime=Date.now()};a9.prototype.updateEditableProperty=function(bi,bj){var bh=this.__parent.getView();if(this.newRoom==null){var bg=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength();switch((bi)){case"X":this.xPreviousPoint=bj!=null?bj:0;this.xPreviousPoint=Math.max(-bg,Math.min(this.xPreviousPoint,bg));break;case"Y":this.yPreviousPoint=bj!=null?bj:0;this.yPreviousPoint=Math.max(-bg,Math.min(this.yPreviousPoint,bg));break}bh.setAlignmentFeedback(Room,null,this.xPreviousPoint,this.yPreviousPoint,true);bh.makePointVisible(this.xPreviousPoint,this.yPreviousPoint)}else{var bc=this.newRoom.getPoints();var bf=bc[bc.length-2];var bk=bc[bc.length-1];var bb=void 0;var bm=void 0;switch((bi)){case"LENGTH":var bd=bj!=null?bj:0;bd=Math.max(0.001,Math.min(bd,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()));var be=Math.PI-Math.atan2(bf[1]-bk[1],bf[0]-bk[0]);bb=(bf[0]+bd*Math.cos(be));bm=(bf[1]-bd*Math.sin(be));break;case"ANGLE":be=(function(bn){return bn*Math.PI/180})(bj!=null?bj:0);if(bc.length>2){be-=Math.atan2(bc[bc.length-3][1]-bf[1],bc[bc.length-3][0]-bf[0])}var bl=this.getRoomSideLength(this.newRoom,bc.length-1);bb=(bf[0]+bl*Math.cos(be));bm=(bf[1]-bl*Math.sin(be));break;default:return}this.newRoom.setPoint(bb,bm,bc.length-1);bh.setAlignmentFeedback(Room,this.newRoom,bb,bm,false);this.showRoomAngleFeedback(this.newRoom,bc.length-1);bh.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.newRoom,bc.length-1));bh.makePointVisible(bf[0],bf[1]);bh.makePointVisible(bb,bm)}};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);if(this.newRoom!=null){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){if(this.newRoom!=null&&this.newPoint==null){this.newRoom.removePoint(this.newRoom.getPointCount()-1)}this.validateDrawnRoom()};a9.prototype.exit=function(){this.__parent.getView().deleteFeedback();this.newRoom=null;this.newPoint=null;this.oldSelection=null};return a9}(ai.AbstractRoomState));ai.RoomDrawingState=w;w.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomDrawingState";var aN=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this,bb)||this;bc.__parent=bb;if(bc.selectedRoom===undefined){bc.selectedRoom=null}if(bc.roomPointIndex===undefined){bc.roomPointIndex=0}if(bc.oldX===undefined){bc.oldX=0}if(bc.oldY===undefined){bc.oldY=0}if(bc.deltaXToResizePoint===undefined){bc.deltaXToResizePoint=0}if(bc.deltaYToResizePoint===undefined){bc.deltaYToResizePoint=0}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.enter=function(){ba.prototype.enter.call(this);this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var bd=this.__parent.getIndicatorMargin();this.roomPointIndex=this.selectedRoom.getPointIndexAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bd);var bc=this.selectedRoom.getPoints();this.oldX=bc[this.roomPointIndex][0];this.oldY=bc[this.roomPointIndex][1];this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.oldX;this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.oldY;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);bb.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedRoom,this.roomPointIndex),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());this.showRoomAngleFeedback(this.selectedRoom,this.roomPointIndex);bb.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.selectedRoom,this.roomPointIndex))};a9.prototype.moveMouse=function(bk,bi){var bg=this.__parent.getView();var bb=bk-this.deltaXToResizePoint;var bm=bi-this.deltaYToResizePoint;var bc=this.selectedRoom.getPoints();var bj=this.roomPointIndex===0?bc.length-1:this.roomPointIndex-1;var bf=bc[bj][0];var bd=bc[bj][1];var be=false;if(this.alignmentActivated){var bh=new ai.PointWithAngleMagnetism(bf,bd,bb,bm,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bg.getPixelLength());bb=bh.getX();bm=bh.getY()}else{if(this.magnetismEnabled){var bl=new ai.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,this.selectedRoom,this.roomPointIndex,bb,bm);be=bl.isMagnetized();if(be){bb=bl.getX();bm=bl.getY()}else{var bh=new ai.RoomPointWithAngleMagnetism(this.__parent,this.selectedRoom,this.roomPointIndex,bf,bd,bb,bm);bb=bh.getX();bm=bh.getY()}}}ai.moveRoomPoint(this.selectedRoom,bb,bm,this.roomPointIndex);bg.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedRoom,this.roomPointIndex),bk,bi);bg.setAlignmentFeedback(Room,this.selectedRoom,bb,bm,be);this.showRoomAngleFeedback(this.selectedRoom,this.roomPointIndex);bg.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.selectedRoom,this.roomPointIndex));bg.makePointVisible(bk,bi)};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postRoomResize(this.selectedRoom,this.oldX,this.oldY,this.roomPointIndex);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){ai.moveRoomPoint(this.selectedRoom,this.oldX,this.oldY,this.roomPointIndex);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedRoom=null};return a9}(ai.AbstractRoomState));ai.RoomResizeState=aN;aN.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomResizeState";var aT=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this,bb)||this;bc.__parent=bb;if(bc.xPreviousPoint===undefined){bc.xPreviousPoint=0}if(bc.yPreviousPoint===undefined){bc.yPreviousPoint=0}if(bc.newPolyline===undefined){bc.newPolyline=null}if(bc.newPoint===undefined){bc.newPoint=null}if(bc.oldSelection===undefined){bc.oldSelection=null}if(bc.oldBasePlanLocked===undefined){bc.oldBasePlanLocked=false}if(bc.oldAllLevelsSelection===undefined){bc.oldAllLevelsSelection=false}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}if(bc.curvedPolyline===undefined){bc.curvedPolyline=false}if(bc.lastPointCreationTime===undefined){bc.lastPointCreationTime=0}return bc}a9.prototype.getMode=function(){return ai.Mode.POLYLINE_CREATION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.setMode=function(bb){this.escape();if(bb===ai.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bb===ai.Mode.PANNING_$LI$()){this.__parent.setState(this.__parent.getPanningState())}else{if(bb===ai.Mode.WALL_CREATION_$LI$()){this.__parent.setState(this.__parent.getWallCreationState())}else{if(bb===ai.Mode.ROOM_CREATION_$LI$()){this.__parent.setState(this.__parent.getRoomCreationState())}else{if(bb===ai.Mode.DIMENSION_LINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getDimensionLineCreationState())}else{if(bb===ai.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}};a9.prototype.enter=function(){ba.prototype.enter.call(this);this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();this.newPolyline=null;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());this.xPreviousPoint=this.__parent.getXLastMousePress();this.yPreviousPoint=this.__parent.getYLastMousePress();this.setDuplicationActivated(this.__parent.wasDuplicationActivatedLastMousePress());this.__parent.deselectAll()};a9.prototype.moveMouse=function(bd,bh){var bc=this.__parent.getView();var bb=bd;var bg=bh;if(this.alignmentActivated||this.magnetismEnabled){var bf=new ai.PointWithAngleMagnetism(this.xPreviousPoint,this.yPreviousPoint,bd,bh,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bc.getPixelLength());bb=bf.getX();bg=bf.getY()}if(this.newPolyline==null){this.newPolyline=this.createAndSelectPolyline(this.xPreviousPoint,this.yPreviousPoint,bb,bg)}else{if(this.newPoint!=null){var be=this.newPolyline.getPoints();this.xPreviousPoint=be[be.length-1][0];this.yPreviousPoint=be[be.length-1][1];this.newPolyline.addPoint$float$float(bb,bg);this.newPoint[0]=bb;this.newPoint[1]=bg;this.newPoint=null}else{this.newPolyline.setPoint(bb,bg,this.newPolyline.getPointCount()-1)}}bc.setAlignmentFeedback(Polyline,null,bd,bh,false);bc.setToolTipFeedback(this.getToolTipFeedbackText(this.newPolyline,this.newPolyline.getPointCount()-1),bd,bh);if(this.newPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED){this.showPolylineAngleFeedback(this.newPolyline,this.newPolyline.getPointCount()-1)}bc.makePointVisible(bd,bh)};a9.prototype.createAndSelectPolyline=function(bf,bd,bb,be){var bc=this.__parent.createPolyline([[bf,bd],[bb,be]]);if(this.curvedPolyline){bc.setJoinStyle(Polyline.JoinStyle.CURVED)}this.__parent.selectItems([bc].slice(0));return bc};a9.prototype.pressMouse=function(bc,bg,bb,bd,bf){if(bb===2){if(this.newPolyline!=null){var be=this.newPolyline.getPointIndexAt(bc,bg,this.__parent.getSelectionMargin());if(be===0){this.newPolyline.removePoint(this.newPolyline.getPointCount()-1);this.newPolyline.setClosedPath(true)}this.validateDrawnPolyline()}else{if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getPolylineCreationState())}}}else{this.endPolylineSegment()}};a9.prototype.validateDrawnPolyline=function(){if(this.newPolyline!=null){var bb=this.newPolyline.getPoints();if(bb.length<2){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePolyline(this.newPolyline)}else{this.__parent.postCreatePolylines([this.newPolyline].slice(0),this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection)}}if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getPolylineCreationState())}};a9.prototype.endPolylineSegment=function(){if(this.newPolyline!=null&&this.getPolylineSegmentLength(this.newPolyline,this.newPolyline.getPointCount()-1)>0){this.newPoint=[0,0];if(this.newPolyline.getPointCount()<=2&&this.curvedPolyline&&this.newPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED){this.newPolyline.setJoinStyle(Polyline.JoinStyle.CURVED)}}};a9.prototype.setEditionActivated=function(be){var bb=this.__parent.getView();if(be){bb.deleteFeedback();if(this.newPolyline==null){bb.setToolTipEditedProperties(["X","Y"],[this.xPreviousPoint,this.yPreviousPoint],this.xPreviousPoint,this.yPreviousPoint)}else{if(this.newPoint!=null){this.createNextSegment()}var bf=this.newPolyline.getPoints();bb.setToolTipEditedProperties(["LENGTH","ANGLE"],[this.getPolylineSegmentLength(this.newPolyline,bf.length-1),this.getPolylineSegmentAngle(this.newPolyline,bf.length-1)],bf[bf.length-1][0],bf[bf.length-1][1])}}else{if(this.newPolyline==null){var bc=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit();var bd=bc===LengthUnit.INCH||bc===LengthUnit.INCH_DECIMALS?LengthUnit.footToCentimeter(10):300;this.newPolyline=this.createAndSelectPolyline(this.xPreviousPoint,this.yPreviousPoint,this.xPreviousPoint+bd,this.yPreviousPoint);bb.deleteFeedback();this.setEditionActivated(true)}else{if(Date.now()-this.lastPointCreationTime<300){this.escape()}else{this.endPolylineSegment();var bf=this.newPolyline.getPoints();if(bf.length>2&&this.newPolyline.getPointIndexAt(bf[bf.length-1][0],bf[bf.length-1][1],0.001)===0){this.newPolyline.removePoint(this.newPolyline.getPointCount()-1);this.newPolyline.setClosedPath(true);this.validateDrawnPolyline();return}this.createNextSegment();bb.deleteToolTipFeedback();this.setEditionActivated(true)}}}};a9.prototype.createNextSegment=function(){var bc=this.newPolyline.getPoints();this.xPreviousPoint=bc[bc.length-1][0];this.yPreviousPoint=bc[bc.length-1][1];var bb=Math.PI-Math.atan2(bc[bc.length-2][1]-bc[bc.length-1][1],bc[bc.length-2][0]-bc[bc.length-1][0]);bb-=Math.PI/2;var bd=this.getPolylineSegmentLength(this.newPolyline,bc.length-1);this.newPolyline.addPoint$float$float((this.xPreviousPoint+bd*Math.cos(bb)),(this.yPreviousPoint-bd*Math.sin(bb)));this.newPoint=null;this.lastPointCreationTime=Date.now()};a9.prototype.updateEditableProperty=function(bh,bi){var bg=this.__parent.getView();if(this.newPolyline==null){switch((bh)){case"X":this.xPreviousPoint=bi!=null?bi:0;this.xPreviousPoint=Math.max(-100000,Math.min(this.xPreviousPoint,100000));break;case"Y":this.yPreviousPoint=bi!=null?bi:0;this.yPreviousPoint=Math.max(-100000,Math.min(this.yPreviousPoint,100000));break}bg.setAlignmentFeedback(Polyline,null,this.xPreviousPoint,this.yPreviousPoint,true);bg.makePointVisible(this.xPreviousPoint,this.yPreviousPoint)}else{var bk=this.newPolyline.getPoints();var be=bk[bk.length-2];var bj=bk[bk.length-1];var bb=void 0;var bl=void 0;switch((bh)){case"LENGTH":var bd=bi!=null?bi:0;bd=Math.max(0.001,Math.min(bd,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()));var bc=Math.PI-Math.atan2(be[1]-bj[1],be[0]-bj[0]);bb=(be[0]+bd*Math.cos(bc));bl=(be[1]-bd*Math.sin(bc));break;case"ANGLE":bc=(function(bm){return bm*Math.PI/180})(bi!=null?bi:0);if(bk.length>2){bc-=Math.atan2(bk[bk.length-3][1]-be[1],bk[bk.length-3][0]-be[0])}var bf=this.getPolylineSegmentLength(this.newPolyline,bk.length-1);bb=(be[0]+bf*Math.cos(bc));bl=(be[1]-bf*Math.sin(bc));break;default:return}this.newPolyline.setPoint(bb,bl,bk.length-1);if(this.newPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED){this.showPolylineAngleFeedback(this.newPolyline,bk.length-1)}bg.setAlignmentFeedback(Polyline,null,bb,bl,false);bg.makePointVisible(bk[bk.length-2][0],bk[bk.length-2][1]);bg.makePointVisible(bk[bk.length-1][0],bk[bk.length-1][1])}};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);if(this.newPolyline!=null){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setDuplicationActivated=function(bb){this.curvedPolyline=bb};a9.prototype.escape=function(){if(this.newPolyline!=null&&this.newPoint==null){this.newPolyline.removePoint(this.newPolyline.getPointCount()-1)}this.validateDrawnPolyline()};a9.prototype.exit=function(){this.__parent.getView().deleteFeedback();this.newPolyline=null;this.newPoint=null;this.oldSelection=null};return a9}(ai.AbstractPolylineState));ai.PolylineDrawingState=aT;aT.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineDrawingState";var v=(function(ba){__extends(a9,ba);function a9(bb){var bc=ba.call(this,bb)||this;bc.__parent=bb;if(bc.polylines===undefined){bc.polylines=null}if(bc.selectedPolyline===undefined){bc.selectedPolyline=null}if(bc.polylinePointIndex===undefined){bc.polylinePointIndex=0}if(bc.oldX===undefined){bc.oldX=0}if(bc.oldY===undefined){bc.oldY=0}if(bc.deltaXToResizePoint===undefined){bc.deltaXToResizePoint=0}if(bc.deltaYToResizePoint===undefined){bc.deltaYToResizePoint=0}if(bc.magnetismEnabled===undefined){bc.magnetismEnabled=false}if(bc.alignmentActivated===undefined){bc.alignmentActivated=false}return bc}a9.prototype.getMode=function(){return ai.Mode.SELECTION_$LI$()};a9.prototype.isModificationState=function(){return true};a9.prototype.isBasePlanModificationState=function(){return true};a9.prototype.enter=function(){var bf=this;ba.prototype.enter.call(this);this.selectedPolyline=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.polylines=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines().slice(0));(function(bg){var bh=bg.indexOf(bf.selectedPolyline);if(bh>=0){bg.splice(bh,1);return true}else{return false}})(this.polylines);var be=this.__parent.getIndicatorMargin();this.polylinePointIndex=this.selectedPolyline.getPointIndexAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),be);var bc=this.selectedPolyline.getPoints();this.oldX=bc[this.polylinePointIndex][0];this.oldY=bc[this.polylinePointIndex][1];this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.oldX;this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.oldY;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var bb=this.__parent.getView();bb.setResizeIndicatorVisible(true);var bd=this.getToolTipFeedbackText(this.selectedPolyline,this.polylinePointIndex);if(bd!=null){bb.setToolTipFeedback(bd,this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());if(this.selectedPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED){this.showPolylineAngleFeedback(this.selectedPolyline,this.polylinePointIndex)}}};a9.prototype.moveMouse=function(bj,bh){var be=this.__parent.getView();var bb=bj-this.deltaXToResizePoint;var bk=bh-this.deltaYToResizePoint;if(this.alignmentActivated||this.magnetismEnabled){var bg=this.selectedPolyline.getPoints();var bi=this.polylinePointIndex===0?(this.selectedPolyline.isClosedPath()?bg.length-1:1):this.polylinePointIndex-1;var bd=bg[bi][0];var bc=bg[bi][1];var bf=new ai.PointWithAngleMagnetism(bd,bc,bb,bk,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),be.getPixelLength());bb=bf.getX();bk=bf.getY()}this.selectedPolyline.setPoint(bb,bk,this.polylinePointIndex);be.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedPolyline,this.polylinePointIndex),bj,bh);if(this.selectedPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED){this.showPolylineAngleFeedback(this.selectedPolyline,this.polylinePointIndex)}be.makePointVisible(bj,bh)};a9.prototype.releaseMouse=function(bb,bc){this.__parent.postPolylineResize(this.selectedPolyline,this.oldX,this.oldY,this.polylinePointIndex);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.toggleMagnetism=function(bb){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bb);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.setAlignmentActivated=function(bb){this.alignmentActivated=bb;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};a9.prototype.escape=function(){this.selectedPolyline.setPoint(this.oldX,this.oldY,this.polylinePointIndex);this.__parent.setState(this.__parent.getSelectionState())};a9.prototype.exit=function(){var bb=this.__parent.getView();bb.setResizeIndicatorVisible(false);bb.deleteFeedback();this.selectedPolyline=null};return a9}(ai.AbstractPolylineState));ai.PolylineResizeState=v;v.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineResizeState";var Q=(function(){function a9(bb,ba){this.walls=ba;this.__parent=bb}a9.prototype.compare=function(bb,ba){var be=ai.computeIntersection(bb.getXStart(),bb.getYStart(),bb.getXEnd(),bb.getYEnd(),this.walls[0].getXStart(),this.walls[0].getYStart(),this.walls[0].getXEnd(),this.walls[0].getYEnd());var bc=ai.computeIntersection(ba.getXStart(),ba.getYStart(),ba.getXEnd(),ba.getYEnd(),this.walls[0].getXStart(),this.walls[0].getYStart(),this.walls[0].getXEnd(),this.walls[0].getYEnd());var bf=Math.min(java.awt.geom.Point2D.distanceSq(this.walls[0].getXStart(),this.walls[0].getYStart(),be[0],be[1]),java.awt.geom.Point2D.distanceSq(this.walls[0].getXEnd(),this.walls[0].getYEnd(),be[0],be[1]));var bd=Math.min(java.awt.geom.Point2D.distanceSq(this.walls[0].getXStart(),this.walls[0].getYStart(),bc[0],bc[1]),java.awt.geom.Point2D.distanceSq(this.walls[0].getXEnd(),this.walls[0].getYEnd(),bc[0],bc[1]));return(bf-bd)};return a9}());ai.PlanController$0=Q;var P=(function(){function a9(ba){this.__parent=ba}a9.prototype.selectionChanged=function(ba){this.__parent.selectLevelFromSelectedItems();if(this.__parent.getView()!=null){this.__parent.getView().makeSelectionVisible()}};return a9}());ai.PlanController$1=P;P.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var N=(function(){function a9(ba){this.__parent=ba}a9.prototype.propertyChange=function(ba){if((this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().indexOf((ba.getSource()))>=0)){if(this.__parent.getView()!=null){this.__parent.getView().makeSelectionVisible()}}};return a9}());ai.PlanController$2=N;var L=(function(){function a9(ba){this.__parent=ba}a9.prototype.propertyChange=function(bc){var ba=bc.getPropertyName();if(("X_START"===ba)||("X_END"===ba)||("Y_START"===ba)||("Y_END"===ba)||("WALL_AT_START"===ba)||("WALL_AT_END"===ba)||("THICKNESS"===ba)||("ARC_EXTENT"===ba)||("LEVEL"===ba)||("HEIGHT"===ba)||("HEIGHT_AT_END"===ba)||("LEFT_SIDE_BASEBOARD"===ba)||("RIGHT_SIDE_BASEBOARD"===ba)){this.__parent.resetAreaCache();var bb=bc.getSource();if(!bb.isAtLevel(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())){var bd=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0));if((function(be){var bf=be.indexOf(bb);if(bf>=0){be.splice(bf,1);return true}else{return false}})(bd)){this.__parent.selectItems(bd,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())}}}};return a9}());ai.PlanController$3=L;var J=(function(){function a9(ba){this.__parent=ba}a9.prototype.propertyChange=function(bb){var ba=bb.getPropertyName();if(("X"===ba)||("Y"===ba)||("WIDTH_IN_PLAN"===ba)||("DEPTH_IN_PLAN"===ba)){(function(bc,bd){if(bc.entries==null){bc.entries=[]}for(var be=0;be<bc.entries.length;be++){if(bc.entries[be].key==null&&bd==null||bc.entries[be].key.equals!=null&&bc.entries[be].key.equals(bd)||bc.entries[be].key===bd){return bc.entries.splice(be,1)[0]}}})(this.__parent.furnitureSidesCache,bb.getSource())}};return a9}());ai.PlanController$4=J;var I=(function(){function a9(ba){this.__parent=ba}a9.prototype.propertyChange=function(bd){var bc=bd.getSource();var ba=bd.getPropertyName();if(("MODEL"===ba)||("MODEL_MIRRORED"===ba)||("MODEL_ROTATION"===ba)||("WIDTH"===ba)||("DEPTH"===ba)||("HEIGHT"===ba)||("ROLL"===ba)||("PITCH"===ba)){var bb=this.__parent.getView().getPieceOfFurnitureSizeInPlan(bc);if(bb!=null){bc.setWidthInPlan(bb[0]);bc.setDepthInPlan(bb[1]);bc.setHeightInPlan(bb[2])}else{if("WIDTH"===ba){var be=bc.getWidth()/bd.getOldValue();bc.setWidthInPlan(be*bc.getWidthInPlan());bc.setDepthInPlan(be*bc.getDepthInPlan());bc.setHeightInPlan(be*bc.getHeightInPlan())}}}};return a9}());ai.PlanController$5=I;var G=(function(){function a9(ba){this.__parent=ba}a9.prototype.propertyChange=function(ba){this.__parent.resetAreaCache()};return a9}());ai.PlanController$6=G;var F=(function(){function a9(ba){this.__parent=ba}a9.prototype.compare=function(bb,ba){return -(bb.getGroundElevation()-ba.getGroundElevation())};return a9}());ai.PlanController$7=F})(PlanController||(PlanController={}));PlanController.Mode.LABEL_CREATION_$LI$();PlanController.Mode.DIMENSION_LINE_CREATION_$LI$();PlanController.Mode.POLYLINE_CREATION_$LI$();PlanController.Mode.ROOM_CREATION_$LI$();PlanController.Mode.WALL_CREATION_$LI$();PlanController.Mode.PANNING_$LI$();PlanController.Mode.SELECTION_$LI$();Home.LEVEL_ELEVATION_COMPARATOR_$LI$();HomeController.UserPreferencesChangeListener.writingPreferences_$LI$();HomePieceOfFurniture.SORTABLE_PROPERTY_COMPARATORS_$LI$();HomePieceOfFurniture.ROUND_WALL_ANGLE_MARGIN_$LI$();HomePieceOfFurniture.STRAIGHT_WALL_ANGLE_MARGIN_$LI$();HomePieceOfFurniture.TWICE_PI_$LI$();HomePieceOfFurniture.__static_initialize();Label.TWICE_PI_$LI$();Room.TWICE_PI_$LI$();ExportableView.FormatType.CSV_$LI$();ExportableView.FormatType.SVG_$LI$();TransferableView.DataType.FURNITURE_LIST_$LI$();TransferableView.DataType.PLAN_IMAGE_$LI$();FurnitureCategory.COMPARATOR_$LI$();CatalogPieceOfFurniture.recentFilters_$LI$();CatalogPieceOfFurniture.COMPARATOR_$LI$();CatalogPieceOfFurniture.EMPTY_CRITERIA_$LI$();CatalogPieceOfFurniture.__static_initialize();Baseboard.baseboardsCache_$LI$();TextStyle.textStylesCache_$LI$();CatalogTexture.recentFilters_$LI$();CatalogTexture.COMPARATOR_$LI$();CatalogTexture.EMPTY_CRITERIA_$LI$();CatalogTexture.__static_initialize();TexturesCategory.COMPARATOR_$LI$();if(Math.fround===undefined){doubleToFloatConverter=new Float32Array(1);Math.fround=function(a){doubleToFloatConverter[0]=a;return doubleToFloatConverter[0]}}function Node3D(){}Node3D.READING_MODEL="Reading model";Node3D.PARSING_MODEL="Parsing model";Node3D.BUILDING_MODEL="Building model";Node3D.BINDING_MODEL="Binding model";Node3D.prototype.setCapability=function(a){if(this.capability===undefined){this.capability=0}this.capabilities|=a};Node3D.prototype.getCapability=function(a){if(this.capability===undefined){return false}else{return(this.capabilities&a)!==0}};Node3D.prototype.getParent=function(){if(this.parent===undefined){return null}else{return this.parent}};Node3D.prototype.getUserData=function(){if(this.userData===undefined){return null}else{return this.userData}};Node3D.prototype.setUserData=function(a){this.userData=a};Node3D.prototype.getName=function(){if(this.name===undefined){return null}else{return this.name}};Node3D.prototype.setName=function(a){this.name=a};Node3D.prototype.addPropertyChangeListener=function(a,b){if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=new PropertyChangeSupport(this)}this.propertyChangeSupport.addPropertyChangeListener(a,b)};Node3D.prototype.removePropertyChangeListener=function(a,b){if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.removePropertyChangeListener(a,b)}};Node3D.prototype.getPropertyChangeListeners=function(){if(this.propertyChangeSupport!==undefined){return this.propertyChangeSupport.getPropertyChangeListeners()}else{return[]}};Node3D.prototype.setPickable=function(a){this.pickable=a};Node3D.prototype.isPickable=function(){if(this.pickable!==undefined){return this.pickable}else{return true}};Node3D.prototype.clone=function(){var a=new Node3D();if(this.userData!==undefined){a.userData=this.userData}if(this.name!==undefined){a.name=this.name}if(this.pickable!==undefined){a.pickable=this.pickable}return a};function Shape3D(b,a){Node3D.call(this);if(b===undefined){b=null;a=null}else{if(a===undefined){a=null}}this.appearance=a;this.bounds=null;this.geometries=[];if(b!==null){this.geometries.push(b)}}Shape3D.prototype=Object.create(Node3D.prototype);Shape3D.prototype.constructor=Shape3D;Shape3D.ALLOW_GEOMETRY_WRITE=2;Shape3D.prototype.addGeometry=function(e){this.geometries.push(e);var b=vec3.fromValues(Infinity,Infinity,Infinity);var c=vec3.fromValues(-Infinity,-Infinity,-Infinity);if(this.bounds!==null){this.bounds.getLower(b);this.bounds.getUpper(c)}for(var a=0;a<e.vertexIndices.length;a++){var d=e.vertices[e.vertexIndices[a]];vec3.min(b,b,d);vec3.max(c,c,d)}this.bounds=new BoundingBox3D(b,c);if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("GEOMETRY",null,e)}};Shape3D.prototype.setGeometry=function(b,a){this.geometries[a]=b;this.bounds=null;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("GEOMETRY",removedGeometry3D,null)}};Shape3D.prototype.removeGeometry=function(a){var b=this.geometries[a];this.geometries.splice(a,1);this.bounds=null;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("GEOMETRY",b,null)}};Shape3D.prototype.getBounds=function(){if(this.geometries.length===0){return new BoundingBox3D(vec3.fromValues(-Infinity,-Infinity,-Infinity),vec3.fromValues(Infinity,Infinity,Infinity))}else{if(this.bounds===null){var b=vec3.fromValues(Infinity,Infinity,Infinity);var d=vec3.fromValues(-Infinity,-Infinity,-Infinity);for(var c=0;c<this.geometries.length;c++){var f=this.geometries[c];if(f.vertexIndices){for(var a=0;a<f.vertexIndices.length;a++){var e=f.vertices[f.vertexIndices[a]];vec3.min(b,b,e);vec3.max(d,d,e)}}}this.bounds=new BoundingBox3D(b,d)}}return this.bounds.clone()};Shape3D.prototype.getGeometries=function(){return this.geometries};Shape3D.prototype.getAppearance=function(){return this.appearance};Shape3D.prototype.setAppearance=function(a){this.appearance=a};Shape3D.prototype.clone=function(){var a=new Shape3D(null,this.appearance);if(this.userData!==undefined){a.userData=this.userData}if(this.name!==undefined){a.name=this.name}a.geometries=this.geometries;a.bounds=this.bounds;return a};function Background3D(a){Node3D.call(this);this.geometry=a;a.parent=this}Background3D.prototype=Object.create(Node3D.prototype);Background3D.prototype.constructor=Background3D;Background3D.prototype.getGeometry=function(){return this.geometry};Background3D.prototype.clone=function(){var a=new Background3D(this.geometry);if(this.userData!==undefined){a.userData=this.userData}if(this.name!==undefined){a.name=this.name}return a};function Light3D(a){Node3D.call(this);this.color=a}Light3D.prototype=Object.create(Node3D.prototype);Light3D.prototype.constructor=Light3D;Light3D.prototype.getColor=function(){return this.color};Light3D.prototype.setColor=function(a){var b=this.color;this.color=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("COLOR",b,a)}};function AmbientLight3D(a){Light3D.call(this,a)}AmbientLight3D.prototype=Object.create(Light3D.prototype);AmbientLight3D.prototype.constructor=AmbientLight3D;AmbientLight3D.prototype.clone=function(){var a=new AmbientLight3D(this.color);if(this.userData!==undefined){a.userData=this.userData}if(this.name!==undefined){a.name=this.name}return a};function DirectionalLight3D(a,b){Light3D.call(this,a);this.direction=b}DirectionalLight3D.prototype=Object.create(Light3D.prototype);DirectionalLight3D.prototype.constructor=DirectionalLight3D;DirectionalLight3D.prototype.getDirection=function(){return this.direction};DirectionalLight3D.prototype.clone=function(){var a=new DirectionalLight3D(this.color,this.direction);if(this.userData!==undefined){a.userData=this.userData}if(this.name!==undefined){a.name=this.name}return a};function Group3D(){Node3D.call(this);this.children=[]}Group3D.prototype=Object.create(Node3D.prototype);Group3D.prototype.constructor=Group3D;Group3D.ALLOW_CHILDREN_EXTEND=1;Group3D.prototype.addChild=function(a){this.insertChild(a,this.children.length)};Group3D.prototype.insertChild=function(e,a){this.children.splice(a,0,e);e.parent=this;if(this.childrenListeners!==undefined){var d={source:this,child:e,index:a};var c=this.childrenListeners.slice(0);for(var b=0;b<c.length;b++){c[b].childAdded(d)}}};Group3D.prototype.getChild=function(a){return this.children[a]};Group3D.prototype.getChildren=function(){return this.children};Group3D.prototype.removeChild=function(a){var e;if(a instanceof Node3D){e=a;a=this.children.indexOf(e)}else{e=this.children[a]}this.children.splice(a,1);delete e.parent;if(this.childrenListeners!==undefined){var d={source:this,child:e,index:a};var c=this.childrenListeners.slice(0);for(var b=0;b<c.length;b++){c[b].childRemoved(d)}}};Group3D.prototype.removeAllChildren=function(){for(var a=this.children.length-1;a>=0;a--){this.removeChild(a)}};Group3D.prototype.addChildrenListener=function(a){if(this.childrenListeners===undefined){this.childrenListeners=[]}this.childrenListeners.push(a)};Group3D.prototype.removeChildrenListener=function(b){if(this.childrenListeners!==undefined){var a=this.childrenListeners.indexOf(b);if(a!==-1){this.childrenListeners.splice(a,1)}}};Group3D.prototype.getChildrenListeners=function(){if(this.childrenListeners!==undefined){return this.childrenListeners.slice(0)}else{return[]}};Group3D.prototype.setPickable=function(b){Node3D.prototype.setPickable(this,b);for(var a=0;a<this.children.length;a++){this.children[a].setPickable(b)}};Group3D.prototype.clone=function(){var a=new Group3D();if(this.userData!==undefined){a.userData=this.userData}if(this.name!==undefined){a.name=this.name}return a};function BranchGroup3D(){Group3D.call(this)}BranchGroup3D.prototype=Object.create(Group3D.prototype);BranchGroup3D.prototype.constructor=BranchGroup3D;BranchGroup3D.prototype.detach=function(){if(this.parent){this.parent.removeChild(this)}};BranchGroup3D.prototype.clone=function(){var a=new BranchGroup3D();if(this.userData!==undefined){a.userData=this.userData}if(this.name!==undefined){a.name=this.name}return a};function SharedGroup3D(){Group3D.call(this)}SharedGroup3D.prototype=Object.create(Group3D.prototype);SharedGroup3D.prototype.constructor=SharedGroup3D;SharedGroup3D.prototype.clone=function(){var a=new SharedGroup3D();if(this.userData!==undefined){a.userData=this.userData}if(this.name!==undefined){a.name=this.name}return a};function Link3D(a){Node3D.call(this);this.sharedGroup=a}Link3D.prototype=Object.create(Node3D.prototype);Link3D.prototype.constructor=Link3D;Link3D.prototype.getSharedGroup=function(){return this.sharedGroup};Link3D.prototype.setSharedGroup=function(a){this.sharedGroup=a};Link3D.prototype.setPickable=function(a){Node3D.prototype.setPickable(this,a);this.sharedGroup.setPickable(a)};Link3D.prototype.clone=function(){var a=new Link3D(this.sharedGroup);if(this.userData!==undefined){a.userData=this.userData}if(this.name!==undefined){a.name=this.name}return a};function TransformGroup3D(a){Group3D.call(this);if(a!==undefined){this.transform=mat4.clone(a)}else{this.transform=mat4.create()}}TransformGroup3D.prototype=Object.create(Group3D.prototype);TransformGroup3D.prototype.constructor=TransformGroup3D;TransformGroup3D.ALLOW_TRANSFORM_WRITE=4;TransformGroup3D.prototype.getTransform=function(a){mat4.copy(a,this.transform)};TransformGroup3D.prototype.setTransform=function(a){if(!TransformGroup3D.areTransformationsEqual(this.transform,a)){var b=mat4.clone(this.transform);mat4.copy(this.transform,a);if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("TRANSFORM",b,a)}}};TransformGroup3D.areTransformationsEqual=function(c,b){if(c&&b&&c.length===b.length){for(var a=0;a<c.length;a++){if(c[a]!==b[a]){return false}}return true}else{return c===b}};TransformGroup3D.isIdentity=function(a){if(TransformGroup3D.IDENTITY===undefined){TransformGroup3D.IDENTITY=mat4.create()}return mat4.exactEquals(a,TransformGroup3D.IDENTITY)};TransformGroup3D.prototype.clone=function(){var a=new TransformGroup3D(this.transform);if(this.userData!==undefined){a.userData=this.userData}if(this.name!==undefined){a.name=this.name}return a};function Appearance3D(a){if(a!==undefined){this.name=a}}Appearance3D.CULL_NONE=0;Appearance3D.CULL_BACK=1;Appearance3D.CULL_FRONT=2;Appearance3D.prototype.addPropertyChangeListener=function(a){if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=new PropertyChangeSupport(this)}this.propertyChangeSupport.addPropertyChangeListener(a)};Appearance3D.prototype.removePropertyChangeListener=function(a){if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.removePropertyChangeListener(a)}};Appearance3D.prototype.setName=function(a){this.name=a};Appearance3D.prototype.getName=function(){return this.name};Appearance3D.prototype.setAmbientColor=function(a){var b=this.ambientColor;this.ambientColor=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("AMBIENT_COLOR",b,a)}};Appearance3D.prototype.getAmbientColor=function(){return this.ambientColor};Appearance3D.prototype.setEmissiveColor=function(a){var b=this.emissiveColor;this.emissiveColor=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("EMISSIVE_COLOR",b,a)}};Appearance3D.prototype.getEmissiveColor=function(){return this.emissiveColor};Appearance3D.prototype.setDiffuseColor=function(a){var b=this.diffuseColor;this.diffuseColor=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("DIFFUSE_COLOR",b,a)}};Appearance3D.prototype.getDiffuseColor=function(){return this.diffuseColor};Appearance3D.prototype.setSpecularColor=function(b){var a=this.specularColor;this.specularColor=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("SPECULAR_COLOR",a,b)}};Appearance3D.prototype.getSpecularColor=function(){return this.specularColor};Appearance3D.prototype.setShininess=function(b){b=Math.max(b,1);var a=this.shininess;this.shininess=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("SHININESS",a,b)}};Appearance3D.prototype.getShininess=function(){return this.shininess};Appearance3D.prototype.setTransparency=function(a){var b=this.transparency;this.transparency=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("TRANSPARENCY",b,a)}};Appearance3D.prototype.getTransparency=function(){return this.transparency};Appearance3D.prototype.setIllumination=function(a){var b=this.illumination;this.illumination=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("ILLUMINATION",b,a)}};Appearance3D.prototype.getIllumination=function(){return this.illumination};Appearance3D.prototype.setTextureImage=function(a){if(this.textureImage!==a){var b=this.textureImage;this.textureImage=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("TEXTURE_IMAGE",b,a)}}};Appearance3D.prototype.getTextureImage=function(){return this.textureImage};Appearance3D.isPowerOfTwo=function(a){return(a&(a-1))==0};Appearance3D.getNextHighestPowerOfTwo=function(a){--a;for(var b=1;b<32;b<<=1){a=a|a>>b}return(a+1)};Appearance3D.prototype.setTextureCoordinatesGeneration=function(b){if(!Appearance3D.areTextureCoordinatesGenerationsEqual(this.textureCoordinatesGeneration,b)){var a=this.textureCoordinatesGeneration;this.textureCoordinatesGeneration=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("TEXTURE_COORDINATES_GENERATION",a,b)}}};Appearance3D.areTextureCoordinatesGenerationsEqual=function(c,b){if(c&&b){var e=c.planeS;var d=b.planeS;if(e&&d&&vec4.equals(e,d)){var a=c.planeT;var f=b.planeT;return a&&f&&vec4.equals(a,f)}return false}else{return c===b}};Appearance3D.prototype.getTextureCoordinatesGeneration=function(){return this.textureCoordinatesGeneration};Appearance3D.prototype.setTextureTransform=function(b){if(!TransformGroup3D.areTransformationsEqual(this.textureTransform,b)){var a=this.textureTransform;this.textureTransform=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("TEXTURE_TRANSFORM",a,b)}}};Appearance3D.prototype.getTextureTransform=function(){return this.textureTransform};Appearance3D.prototype.setVisible=function(b){var a=this.visible;this.visible=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("VISIBLE",a,b)}};Appearance3D.prototype.isVisible=function(){return this.visible!==false};Appearance3D.prototype.setCullFace=function(a){var b=this.cullFace;this.cullFace=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("CULL_FACE",b,a)}};Appearance3D.prototype.getCullFace=function(){return this.cullFace};Appearance3D.prototype.setBackFaceNormalFlip=function(b){var a=this.backFaceNormalFlip;this.backFaceNormalFlip=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("BACK_FACE_NORMAL_FLIP",a,b)}};Appearance3D.prototype.getBackFaceNormalFlip=function(){return this.backFaceNormalFlip};Appearance3D.prototype.isBackFaceNormalFlip=function(){return this.backFaceNormalFlip===true};Appearance3D.prototype.clone=function(){var b=new Appearance3D(this.name);for(var a in this){if(this.hasOwnProperty(a)){b[a]=this[a]}}return b};function IndexedGeometryArray3D(b,c,a,d){this.vertices=b;this.vertexIndices=c;this.textureCoordinates=a;this.textureCoordinateIndices=d;this.textureCoordinatesDefined=this.textureCoordinateIndices&&this.textureCoordinateIndices.length>0}IndexedGeometryArray3D.prototype.hasTextureCoordinates=function(){return this.textureCoordinatesDefined};IndexedGeometryArray3D.prototype.disposeCoordinates=function(){delete this.textureCoordinates;delete this.textureCoordinateIndices};function IndexedLineArray3D(b,c,a,d){IndexedGeometryArray3D.call(this,b,c,a,d)}IndexedLineArray3D.prototype=Object.create(IndexedGeometryArray3D.prototype);IndexedLineArray3D.prototype.constructor=IndexedLineArray3D;function IndexedTriangleArray3D(c,d,a,f,e,b){IndexedGeometryArray3D.call(this,c,d,a,f);this.normals=e;this.normalIndices=b}IndexedTriangleArray3D.prototype=Object.create(IndexedGeometryArray3D.prototype);IndexedTriangleArray3D.prototype.constructor=IndexedTriangleArray3D;IndexedTriangleArray3D.prototype.disposeCoordinates=function(){IndexedGeometryArray3D.prototype.disposeCoordinates.call(this);delete this.normals;delete this.normalIndices};function BoundingBox3D(a,b){this.lower=a!==undefined?vec3.clone(a):vec3.fromValues(-1,-1,-1);this.upper=b!==undefined?vec3.clone(b):vec3.fromValues(1,1,1)}BoundingBox3D.prototype.getLower=function(a){vec3.copy(a,this.lower)};BoundingBox3D.prototype.getUpper=function(a){vec3.copy(a,this.upper)};BoundingBox3D.prototype.isEmpty=function(){return this.lower[0]==-Infinity&&this.lower[1]==-Infinity&&this.lower[2]==-Infinity&&this.upper[0]==Infinity&&this.upper[1]==Infinity&&this.upper[2]==Infinity};BoundingBox3D.prototype.combine=function(b){if(this.isEmpty()){this.lower[0]=b.lower[0];this.lower[1]=b.lower[1];this.lower[2]=b.lower[2];this.upper[0]=b.upper[0];this.upper[1]=b.upper[1];this.upper[2]=b.upper[2]}if(b instanceof BoundingBox3D){if(!b.isEmpty()){if(this.lower[0]>b.lower[0]){this.lower[0]=b.lower[0]}if(this.lower[1]>b.lower[1]){this.lower[1]=b.lower[1]}if(this.lower[2]>b.lower[2]){this.lower[2]=b.lower[2]}if(this.upper[0]<b.upper[0]){this.upper[0]=b.upper[0]}if(this.upper[1]<b.upper[1]){this.upper[1]=b.upper[1]}if(this.upper[2]<b.upper[2]){this.upper[2]=b.upper[2]}}}else{var a=b;if(this.lower[0]>a[0]){this.lower[0]=a[0]}if(this.lower[1]>a[1]){this.lower[1]=a[1]}if(this.lower[2]>a[2]){this.lower[2]=a[2]}if(this.upper[0]<a[0]){this.upper[0]=a[0]}if(this.upper[1]<a[1]){this.upper[1]=a[1]}if(this.upper[2]<a[2]){this.upper[2]=a[2]}}};BoundingBox3D.prototype.intersect=function(a){return !this.isEmpty()&&a[0]>=this.lower[0]&&a[0]<=this.upper[0]&&a[1]>=this.lower[1]&&a[1]<=this.upper[1]&&a[2]>=this.lower[2]&&a[2]<=this.upper[2]};BoundingBox3D.prototype.transform=function(g){if(!this.isEmpty()){var f=this.upper[0];var e=this.upper[1];var d=this.upper[2];var c=this.lower[0];var a=this.lower[1];var h=this.lower[2];var b=vec3.fromValues(f,e,d);vec3.transformMat4(b,b,g);this.upper[0]=b[0];this.upper[1]=b[1];this.upper[2]=b[2];this.lower[0]=b[0];this.lower[1]=b[1];this.lower[2]=b[2];vec3.set(b,c,e,d);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,c,a,d);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,f,a,d);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,c,e,h);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,f,e,h);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,c,a,h);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,f,a,h);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}}};BoundingBox3D.prototype.clone=function(){return new BoundingBox3D(this.lower,this.upper)};function Box3D(a,d,c,b){Shape3D.call(this,new IndexedTriangleArray3D([vec3.fromValues(-a,-d,-c),vec3.fromValues(a,-d,-c),vec3.fromValues(a,-d,c),vec3.fromValues(-a,-d,c),vec3.fromValues(-a,d,-c),vec3.fromValues(-a,d,c),vec3.fromValues(a,d,c),vec3.fromValues(a,d,-c)],[0,1,2,0,2,3,4,5,6,4,6,7,0,3,5,0,5,4,1,7,6,1,6,2,0,4,7,0,7,1,2,6,5,2,5,3],[vec2.fromValues(0,0),vec2.fromValues(1,0),vec2.fromValues(1,1),vec2.fromValues(0,1)],[0,1,2,0,2,3,3,0,1,3,1,2,0,1,2,0,2,3,1,2,3,1,3,0,1,2,3,1,3,0,1,2,3,1,3,0],[vec3.fromValues(0,-1,0),vec3.fromValues(0,1,0),vec3.fromValues(-1,0,0),vec3.fromValues(1,0,0),vec3.fromValues(0,0,-1),vec3.fromValues(0,0,1)],[0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5]),b);this.bounds=new BoundingBox3D(vec3.fromValues(-a,-d,-c),vec3.fromValues(a,d,c))}Box3D.prototype=Object.create(Shape3D.prototype);Box3D.prototype.constructor=Box3D;function GeometryInfo3D(a){this.type=a}GeometryInfo3D.TRIANGLE_ARRAY=0;GeometryInfo3D.TRIANGLE_STRIP_ARRAY=1;GeometryInfo3D.TRIANGLE_FAN_ARRAY=2;GeometryInfo3D.QUAD_ARRAY=10;GeometryInfo3D.POLYGON_ARRAY=20;GeometryInfo3D.prototype.setCoordinates=function(a){this.vertices=a};GeometryInfo3D.prototype.setCoordinateIndices=function(a){this.coordinatesIndices=a};GeometryInfo3D.prototype.setNormals=function(a){this.normals=a};GeometryInfo3D.prototype.setNormalIndices=function(a){this.normalIndices=a};GeometryInfo3D.prototype.setTextureCoordinates=function(a){this.textureCoordinates=a};GeometryInfo3D.prototype.setTextureCoordinateIndices=function(a){this.textureCoordinateIndices=a};GeometryInfo3D.prototype.setStripCounts=function(a){this.stripCounts=a};GeometryInfo3D.prototype.setContourCounts=function(a){this.contourCounts=a};GeometryInfo3D.prototype.setCreaseAngle=function(a){this.creaseAngle=a};GeometryInfo3D.prototype.setGeneratedNormals=function(a){this.generatedNormals=a};GeometryInfo3D.prototype.computeNormals=function(c,a,k,e){var b;if(this.creaseAngle===undefined){b=44*Math.PI/180}else{b=this.creaseAngle}var n=vec3.create();var m=vec3.create();if(b>0){var g=[];for(var p=0;p<a.length;p+=3){var q=c[a[p+1]];vec3.sub(n,c[a[p+2]],q);vec3.sub(m,c[a[p]],q);var u=vec3.cross(vec3.create(),n,m);for(var o=0;o<3;o++){var t={normal:u};var f=a[p+o];t.nextVertex=g[f];g[f]=t;k.push(u);e.push(k.length-1)}}var l=vec3.create();for(var p=0;p<a.length;p+=3){for(var o=0;o<3;o++){var f=a[p+o];var s=e[p+o];var h=k[s];var u=vec3.create();for(var t=g[f];t!==undefined;t=t.nextVertex){if(t.normal===h){vec3.add(u,u,t.normal)}else{var d=vec3.dot(t.normal,h);if(d>0||b>Math.PI/2){var r=Math.abs(Math.atan2(vec3.length(vec3.cross(l,t.normal,h)),d));if(r<b-0.001){vec3.add(u,u,t.normal)}}}}if(vec3.squaredLength(u)!==0){vec3.normalize(u,u)}else{vec3.copy(u,h);vec3.normalize(u,u)}k[s]=u}}}else{for(var p=0;p<a.length;p+=3){var q=c[a[p+1]];vec3.sub(n,c[a[p+2]],q);vec3.sub(m,c[a[p]],q);var u=vec3.cross(vec3.create(),n,m);vec3.normalize(u,u);var s=k.length-1;if(k.length===0||!vec3.exactEquals(k[s],u)){k.push(u);s++}for(var o=0;o<3;o++){e.push(s)}}}};GeometryInfo3D.prototype.getIndexedGeometryArray=function(){if(this.vertices&&!this.coordinatesIndices){this.coordinatesIndices=new Array(this.vertices.length);if(this.generatedNormals&&(this.creaseAngle===undefined||this.creaseAngle>0)){for(var g=0;g<this.coordinatesIndices.length;g++){for(var f=0;f<this.vertices.length;f++){if(vec3.exactEquals(this.vertices[g],this.vertices[f])){this.coordinatesIndices[g]=f;break}}}}else{for(var g=0;g<this.coordinatesIndices.length;g++){this.coordinatesIndices[g]=g}}}if(this.textureCoordinates&&!this.textureCoordinateIndices){this.textureCoordinateIndices=new Array(this.textureCoordinates.length);for(var g=0;g<this.textureCoordinateIndices.length;g++){this.textureCoordinateIndices[g]=g}}if(this.normals&&!this.normalIndices&&!this.generatedNormals){this.normalIndices=new Array(this.normals.length);for(var g=0;g<this.normalIndices.length;g++){this.normalIndices[g]=g}}var b;var m;var c;if(this.type===GeometryInfo3D.POLYGON_ARRAY){b=[];m=[];c=[];new Triangulator().triangulate(this.vertices,this.coordinatesIndices,this.textureCoordinates?this.textureCoordinateIndices:[],this.normals?this.normalIndices:[],this.stripCounts,b,m,c)}else{if(this.type===GeometryInfo3D.QUAD_ARRAY){b=[];m=[];c=[];for(var g=0;g<this.coordinatesIndices.length;g+=4){b.push(this.coordinatesIndices[g]);b.push(this.coordinatesIndices[g+1]);b.push(this.coordinatesIndices[g+2]);b.push(this.coordinatesIndices[g+2]);b.push(this.coordinatesIndices[g+3]);b.push(this.coordinatesIndices[g]);if(this.textureCoordinateIndices){m.push(this.textureCoordinateIndices[g]);m.push(this.textureCoordinateIndices[g+1]);m.push(this.textureCoordinateIndices[g+2]);m.push(this.textureCoordinateIndices[g+2]);m.push(this.textureCoordinateIndices[g+3]);m.push(this.textureCoordinateIndices[g])}if(this.normalIndices){c.push(this.normalIndices[g]);c.push(this.normalIndices[g+1]);c.push(this.normalIndices[g+2]);c.push(this.normalIndices[g+2]);c.push(this.normalIndices[g+3]);c.push(this.normalIndices[g])}}}else{if(this.type===GeometryInfo3D.TRIANGLE_STRIP_ARRAY){b=[];m=[];c=[];for(var g=0,h=0;g<this.stripCounts.length;g++){var l=this.stripCounts[g];for(var d=0;d<l-2;d++){var e=h+(d%2===0?d+1:d+2);var a=h+(d%2===0?d+2:d+1);b.push(this.coordinatesIndices[h+d]);b.push(this.coordinatesIndices[e]);b.push(this.coordinatesIndices[a]);if(this.textureCoordinateIndices){m.push(this.textureCoordinateIndices[h+d]);m.push(this.textureCoordinateIndices[e]);m.push(this.textureCoordinateIndices[a])}if(this.normalIndices){c.push(this.normalIndices[h+d]);c.push(this.normalIndices[e]);c.push(this.normalIndices[a])}}h+=l}}else{if(this.type===GeometryInfo3D.TRIANGLE_FAN_ARRAY){b=[];m=[];c=[];for(var g=0,h=0;g<this.stripCounts.length;g++){var l=this.stripCounts[g];for(var d=0;d<l-2;d++){b.push(this.coordinatesIndices[h]);b.push(this.coordinatesIndices[h+d+1]);b.push(this.coordinatesIndices[h+d+2]);if(this.textureCoordinateIndices){m.push(this.textureCoordinateIndices[h]);m.push(this.textureCoordinateIndices[h+d+1]);m.push(this.textureCoordinateIndices[h+d+2])}if(this.normalIndices){c.push(this.normalIndices[h]);c.push(this.normalIndices[h+d+1]);c.push(this.normalIndices[h+d+2])}}h+=l}}else{b=this.vertices?this.coordinatesIndices:[];m=this.textureCoordinates?this.textureCoordinateIndices:[];c=this.normals?this.normalIndices:[]}}}}var n;if(this.generatedNormals){n=[];c=[];this.computeNormals(this.vertices,b,n,c)}else{n=this.normals}return new IndexedTriangleArray3D(this.vertices,b,this.textureCoordinates,m,n,c)};function IncorrectFormat3DException(a){this.message=a}function HTMLCanvas3D(d,b){this.scene=null;this.textures=[];this.sharedGeometries=[];this.sceneGeometries=[];this.backgroundGeometries=[];this.lights=[];this.fieldOfView=Math.PI*45/180;this.frontClipDistance=0.1;this.backClipDistance=100;this.projectionPolicy=HTMLCanvas3D.PERSPECTIVE_PROJECTION;this.offscreen=b===true;this.canvas=typeof d==="string"?document.getElementById(d):d;this.gl=this.canvas.getContext("webgl");if(!this.gl){this.gl=this.canvas.getContext("experimental-webgl");if(!this.gl){throw"No WebGL"}}this.updateViewportSize();this.shaderProgram=this.gl.createProgram();var c=this.createShader(this.gl.VERTEX_SHADER,"attribute vec3 vertexPosition;attribute vec3 vertexNormal;attribute vec2 vertexTextureCoord;uniform mat4 modelViewTransform;uniform mat4 projectionTransform;uniform bool textureCoordinatesGenerated;uniform vec4 planeS;uniform vec4 planeT;uniform mat3 textureCoordTransform;uniform mat3 normalTransform;uniform bool ignoreNormal;uniform bool backFaceNormalFlip;uniform bool lightingEnabled;uniform bool useTextures;varying vec2 varTextureCoord;varying vec4 varVertexPosition;varying vec3 varTransformedNormal;void main(void) {  varVertexPosition = modelViewTransform * vec4(vertexPosition, 1.0);  gl_Position = projectionTransform * varVertexPosition;  if (useTextures) {    if (textureCoordinatesGenerated) {      varTextureCoord = vec2(vertexPosition.x * planeS.x + vertexPosition.y * planeS.y          + vertexPosition.z * planeS.z + planeS.w,            vertexPosition.x * planeT.x + vertexPosition.y * planeT.y          + vertexPosition.z * planeT.z + planeT.w);    } else {      varTextureCoord = vec2(vertexTextureCoord);    }    varTextureCoord = vec2(textureCoordTransform * vec3(varTextureCoord, 1));  }  if (lightingEnabled) {    vec3 normal;    if (ignoreNormal) {      normal = vec3(1., 1., 1.);    } else {      normal = vertexNormal;      if (backFaceNormalFlip) {        normal = -normal;      }    }    varTransformedNormal = normalize(normalTransform * normal);  }}");this.gl.attachShader(this.shaderProgram,c);var a=this.createShader(this.gl.FRAGMENT_SHADER,"precision mediump float;uniform vec3  vertexDiffuseColor;uniform vec3  vertexSpecularColor;uniform float shininess;uniform sampler2D sampler;uniform float alpha;uniform bool  useTextures;uniform bool  lightingEnabled;uniform vec3  ambientColor;uniform int   directionalLightCount;uniform vec3  lightDirections["+HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT+"];uniform vec3  directionalLightColors["+HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT+"];varying vec2  varTextureCoord;varying vec4  varVertexPosition;varying vec3  varTransformedNormal;void main(void) {  vec3 lightWeight;  if (lightingEnabled) {    lightWeight = ambientColor;    if (directionalLightCount > 0) {      vec3 diffuseLightWeight = vec3(0., 0., 0.);      vec3 specularLightWeight = vec3(0., 0., 0.);      vec3 eyeDirection = vec3(0., 0., 0.);      bool computeSpecularLightWeight = false;      if (vertexSpecularColor.r > 0.          && vertexSpecularColor.g > 0.          && vertexSpecularColor.b > 0.) {        eyeDirection = normalize(-varVertexPosition.xyz);        computeSpecularLightWeight = length(eyeDirection) <= 1.0001;      }      for (int i = 0; i < "+HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT+"; i++) {        if (i >= directionalLightCount) {          break;        }        float directionalLightWeight = max(dot(varTransformedNormal, lightDirections[i]), 0.);        diffuseLightWeight += directionalLightColors[i] * directionalLightWeight;        if (computeSpecularLightWeight) {          vec3 reflectionDirection = reflect(-lightDirections[i], varTransformedNormal);          specularLightWeight += directionalLightColors[i] * pow(max(dot(reflectionDirection, eyeDirection), 0.), shininess);        }      }      lightWeight += vertexDiffuseColor * diffuseLightWeight;      if (computeSpecularLightWeight) {        lightWeight += vertexSpecularColor * specularLightWeight;      }    }  } else {    lightWeight = vertexDiffuseColor;  }  vec4 fragmentColor;  if (useTextures) {    fragmentColor = texture2D(sampler, vec2(varTextureCoord.s, varTextureCoord.t));  } else {    fragmentColor = vec4(1., 1., 1., 1.);  }  gl_FragColor = vec4(fragmentColor.rgb * lightWeight * alpha, fragmentColor.a * alpha);}");this.gl.attachShader(this.shaderProgram,a);this.gl.linkProgram(this.shaderProgram);this.shaderProgram.vertexPositionAttribute=this.gl.getAttribLocation(this.shaderProgram,"vertexPosition");this.shaderProgram.normalAttribute=this.gl.getAttribLocation(this.shaderProgram,"vertexNormal");this.shaderProgram.textureCoordAttribute=this.gl.getAttribLocation(this.shaderProgram,"vertexTextureCoord");this.shaderProgram.projectionTransform=this.gl.getUniformLocation(this.shaderProgram,"projectionTransform");this.shaderProgram.modelViewTransform=this.gl.getUniformLocation(this.shaderProgram,"modelViewTransform");this.shaderProgram.textureCoordinatesGenerated=this.gl.getUniformLocation(this.shaderProgram,"textureCoordinatesGenerated");this.shaderProgram.planeS=this.gl.getUniformLocation(this.shaderProgram,"planeS");this.shaderProgram.planeT=this.gl.getUniformLocation(this.shaderProgram,"planeT");this.shaderProgram.textureCoordTransform=this.gl.getUniformLocation(this.shaderProgram,"textureCoordTransform");this.shaderProgram.normalTransform=this.gl.getUniformLocation(this.shaderProgram,"normalTransform");this.shaderProgram.ignoreNormal=this.gl.getUniformLocation(this.shaderProgram,"ignoreNormal");this.shaderProgram.backFaceNormalFlip=this.gl.getUniformLocation(this.shaderProgram,"backFaceNormalFlip");this.shaderProgram.ambientColor=this.gl.getUniformLocation(this.shaderProgram,"ambientColor");this.shaderProgram.lightingEnabled=this.gl.getUniformLocation(this.shaderProgram,"lightingEnabled");this.shaderProgram.directionalLightCount=this.gl.getUniformLocation(this.shaderProgram,"directionalLightCount");this.shaderProgram.lightDirections=this.gl.getUniformLocation(this.shaderProgram,"lightDirections");this.shaderProgram.directionalLightColors=this.gl.getUniformLocation(this.shaderProgram,"directionalLightColors");this.shaderProgram.vertexDiffuseColor=this.gl.getUniformLocation(this.shaderProgram,"vertexDiffuseColor");this.shaderProgram.vertexSpecularColor=this.gl.getUniformLocation(this.shaderProgram,"vertexSpecularColor");this.shaderProgram.shininess=this.gl.getUniformLocation(this.shaderProgram,"shininess");this.shaderProgram.alpha=this.gl.getUniformLocation(this.shaderProgram,"alpha");this.shaderProgram.useTextures=this.gl.getUniformLocation(this.shaderProgram,"useTextures");this.gl.useProgram(this.shaderProgram);this.viewPlatformTransform=mat4.create();mat4.translate(this.viewPlatformTransform,this.viewPlatformTransform,[0,0,-2.4]);this.geometryAmbientColor=vec3.create();this.geometrySpecularColor=vec3.create();this.geometryModelViewTransform=mat4.create();this.geometryNormalTransform=mat3.create();this.shaderAmbientColor=vec3.create();this.gl.uniform3fv(this.shaderProgram.ambientColor,this.shaderAmbientColor);this.shaderSpecularColor=vec3.create();this.gl.uniform3fv(this.shaderProgram.vertexSpecularColor,this.shaderSpecularColor);this.geometryDiffuseColor=vec3.create();this.shaderDiffuseColor=vec3.fromValues(1,1,1);this.gl.uniform3fv(this.shaderProgram.vertexDiffuseColor,this.shaderDiffuseColor);this.shaderModelViewTransform=mat4.create();this.gl.uniformMatrix4fv(this.shaderProgram.modelViewTransform,false,this.shaderModelViewTransform);this.shaderNormalTransform=mat3.create();this.gl.uniformMatrix3fv(this.shaderProgram.normalTransform,false,this.shaderNormalTransform);this.shaderTextureTransform=mat3.create();this.gl.uniformMatrix3fv(this.shaderProgram.textureCoordTransform,false,this.shaderTextureTransform);this.shaderLightingEnabled=true;this.gl.uniform1i(this.shaderProgram.lightingEnabled,this.shaderLightingEnabled);this.shaderShininess=1;this.gl.uniform1f(this.shaderProgram.shininess,this.shaderShininess);this.shaderIgnoreNormal=false;this.gl.uniform1i(this.shaderProgram.ignoreNormal,this.shaderIgnoreNormal);this.shaderBackFaceNormalFlip=false;this.gl.uniform1i(this.shaderProgram.backFaceNormalFlip,this.shaderBackFaceNormalFlip);this.shaderTextureCoordinatesGenerated=false;this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,false);this.shaderUseTextures=false;this.gl.uniform1i(this.shaderProgram.useTextures,false);this.shaderAlpha=1;this.gl.uniform1f(this.shaderProgram.alpha,this.shaderAlpha);this.gl.enable(this.gl.CULL_FACE);this.gl.cullFace(this.gl.BACK);this.canvasNeededRepaint=false;this.pickingFrameBufferNeededRepaint=true;this.errorTexture=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,this.errorTexture);var e=new Uint8Array([255,0,0,255]);this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR);this.gl.bindTexture(this.gl.TEXTURE_2D,null)}HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT=16;HTMLCanvas3D.VEC4_DEFAULT_PLANE_S=vec4.fromValues(1,0,0,0);HTMLCanvas3D.VEC4_DEFAULT_PLANE_T=vec4.fromValues(0,1,0,0);HTMLCanvas3D.MAT3_IDENTITY=mat3.create();HTMLCanvas3D.PARALLEL_PROJECTION=0;HTMLCanvas3D.PERSPECTIVE_PROJECTION=1;HTMLCanvas3D.prototype.createShader=function(a,c){var b=this.gl.createShader(a);this.gl.shaderSource(b,c);this.gl.compileShader(b);if(!this.gl.getShaderParameter(b,this.gl.COMPILE_STATUS)){throw"Invalid shader: "+c}return b};HTMLCanvas3D.prototype.getCanvas=function(){return this.canvas};HTMLCanvas3D.prototype.getHTMLElement=function(){return this.getCanvas()};HTMLCanvas3D.prototype.getDepthBits=function(){return this.gl.getParameter(this.gl.DEPTH_BITS)};HTMLCanvas3D.prototype.setFieldOfView=function(a){if(this.fieldOfView!=a){this.fieldOfView=a;this.repaint()}};HTMLCanvas3D.prototype.setFrontClipDistance=function(a){if(this.frontClipDistance!=a){this.frontClipDistance=a;this.repaint()}};HTMLCanvas3D.prototype.setBackClipDistance=function(a){if(this.backClipDistance!=a){this.backClipDistance=a;this.repaint()}};HTMLCanvas3D.prototype.getViewPlatformTransform=function(a){return mat4.copy(a,this.viewPlatformTransform)};HTMLCanvas3D.prototype.setViewPlatformTransform=function(a){if(this.viewPlatformTransform!=a){this.viewPlatformTransform=a;this.repaint()}};HTMLCanvas3D.prototype.updateViewportSize=function(){var c;try{c=this.canvas.getBoundingClientRect()}catch(a){c={width:this.canvas.width,height:this.canvas.height}}var b=c.width!==0&&c.height!==0;if(!b){c={width:this.canvas.width,height:this.canvas.height}}if(this.viewportWidth!=c.width||this.viewportHeight!=c.height){this.viewportWidth=c.width;this.viewportHeight=c.height;this.canvas.width=this.viewportWidth;this.canvas.height=this.viewportHeight;if(this.pickingFrameBuffer!==undefined){this.gl.deleteFramebuffer(this.pickingFrameBuffer);delete this.pickingFrameBuffer}if(b){this.repaint()}}};HTMLCanvas3D.prototype.setScene=function(f,c){var a=[];var d=[];var g=[];var b=[];var h=this.countDisplayedGeometries(f);this.prepareScene(f,a,d,g,false,[],b,mat4.create(),c,h);this.scene=f;this.sharedGeometries=a;this.sceneGeometries=d;this.backgroundGeometries=g;this.lights=b;if(this.offscreen){this.canvasNeededRepaint=true;if(c!==undefined){c(ModelLoader.BINDING_MODEL,"",1)}}else{var e=this;setTimeout(function(){if(c!==undefined){c(ModelLoader.BINDING_MODEL,"",1)}e.drawScene()},0)}};HTMLCanvas3D.prototype.getScene=function(){return this.scene};HTMLCanvas3D.prototype.countDisplayedGeometries=function(c){if(c instanceof Group3D){var d=0;var b=c.getChildren();for(var a=0;a<b.length;a++){d+=this.countDisplayedGeometries(b[a])}return d}else{if(c instanceof Link3D){return this.countDisplayedGeometries(c.getSharedGroup())}else{if(c instanceof Shape3D){return c.getGeometries().length}else{return 0}}}};HTMLCanvas3D.DEFAULT_APPEARANCE=new Appearance3D();HTMLCanvas3D.prototype.prepareScene=function(l,c,j,e,o,p,q,f,k,d){var s=this;if(l instanceof Group3D){if(l instanceof TransformGroup3D){var m=mat4.create();l.getTransform(m);f=mat4.mul(mat4.create(),f,m);if(l.getCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE)){l.addPropertyChangeListener("TRANSFORM",{canvas3D:s,propertyChange:function(v){var w=mat4.invert(mat4.create(),v.getOldValue());mat4.mul(f,f,w);mat4.mul(f,f,v.getNewValue());var u=l.getChildren();for(var t=0;t<u.length;t++){s.updateChildrenTransformation(u[t],o?e:j,p,q,f)}s.repaint()}})}}var b=l.getChildren();for(var n=0;n<b.length;n++){this.prepareScene(b[n],c,j,e,o,p,q,f,k,d)}if(l.getCapability(Group3D.ALLOW_CHILDREN_EXTEND)){l.addChildrenListener({canvas3D:s,childAdded:function(t){s.prepareScene(t.child,c,j,e,o,p,q,f);s.repaint()},childRemoved:function(t){s.removeDisplayedItems(t.child,c,o?e:j,q);s.removeNodeListeners(t.child);s.repaint()}})}}else{if(l instanceof Link3D){p=p.slice(0);p.push(l);this.prepareScene(l.getSharedGroup(),c,j,e,o,p,q,f,k,d)}else{if(l instanceof Shape3D){if(k!==undefined&&!o&&Math.floor((j.length-1)/d*10)<Math.floor(j.length/d*10)){k(ModelLoader.BINDING_MODEL,"",j.length/d)}var r=l.getAppearance();if(!r){r=HTMLCanvas3D.DEFAULT_APPEARANCE}var h=null;if(r.getTextureImage()){h=this.prepareTexture(r.getTextureImage())}var g=l.getGeometries();for(var n=0;n<g.length;n++){this.prepareGeometry(g[n],r,h,l,c,j,e,o,p,f)}if(l.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE)){l.addPropertyChangeListener("GEOMETRY",{canvas3D:s,propertyChange:function(w){if(w.getOldValue()){removedGeometry=w.getOldValue();for(var u=0;u<j.length;u++){var x=j[u];if(x.nodeGeometry===removedGeometry){s.clearGeometryBuffers(x);j.splice(u,1);break}}}if(w.getNewValue()){addedGeometry=w.getNewValue();var t=l.getAppearance();if(!t){t=HTMLCanvas3D.DEFAULT_APPEARANCE}var v=null;if(t.getTextureImage()){v=s.prepareTexture(t.getTextureImage())}s.prepareGeometry(addedGeometry,t,v,l,c,j,e,o,p,f)}}})}if(r!==HTMLCanvas3D.DEFAULT_APPEARANCE){r.addPropertyChangeListener({canvas3D:s,propertyChange:function(w){var v=o?e:j;for(var u=0;u<v.length;u++){var y=v[u];if(y.node===l){var x=w.getNewValue();switch(w.getPropertyName()){case"AMBIENT_COLOR":y.ambientColor=x;break;case"DIFFUSE_COLOR":y.diffuseColor=x;break;case"SPECULAR_COLOR":y.specularColor=x;break;case"SHININESS":y.shininess=x;break;case"TRANSPARENCY":y.transparency=x!=null?1-x:1;break;case"ILLUMINATION":y.lightingEnabled=(x==null||x>=1)&&y.mode===s.gl.TRIANGLES;break;case"TEXTURE_IMAGE":y.texture=x!=null?s.prepareTexture(x):undefined;break;case"TEXTURE_COORDINATES_GENERATION":var t=x;y.textureCoordinatesGeneration=t;break;case"TEXTURE_TRANSFORM":y.textureTransform=x;break;case"VISIBLE":y.visible=x!==false;break;case"CULL_FACE":y.cullFace=x;break;case"BACK_FACE_NORMAL_FLIP":y.backFaceNormalFlip=x===true;break}}}s.repaint()}})}}else{if(l instanceof Background3D){this.prepareScene(l.getGeometry(),c,j,e,true,p,q,f)}else{if(l instanceof Light3D){var a={node:l,color:l.getColor()};if(l instanceof DirectionalLight3D){a.direction=l.getDirection();a.transform=f}q.push(a);l.addPropertyChangeListener("COLOR",{canvas3D:s,propertyChange:function(v){for(var u=0;u<q.length;u++){var t=q[u];if(q[u].node===l){t.color=v.getNewValue();break}}s.repaint()}})}}}}}};HTMLCanvas3D.prototype.prepareGeometry=function(f,y,n,q,d,o,g,u,w,j){var b=null;if(!q.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE)){for(var s=0;s<d.length;s++){if(d[s].nodeGeometry===f){b={node:q,center:d[s].center,nodeGeometry:f,vertexCount:d[s].vertexCount,vertexBuffer:d[s].vertexBuffer,textureCoordinatesBuffer:d[s].textureCoordinatesBuffer,normalBuffer:d[s].normalBuffer,mode:d[s].mode};d[s].referenceCount++;break}}}if(b===null){var e=q.getBounds();var x=vec3.create();e.getLower(x);var t=vec3.create();e.getUpper(t);var v=vec3.fromValues((x[0]+t[0])/2,(x[1]+t[1])/2,(x[2]+t[2])/2);b={node:q,center:v,nodeGeometry:f,vertexCount:f.vertexIndices.length};b.vertexBuffer=this.prepareBuffer(f.vertices,f.vertexIndices);b.textureCoordinatesBuffer=this.prepareBuffer(f.textureCoordinates,f.textureCoordinateIndices);if(f instanceof IndexedTriangleArray3D){b.mode=this.gl.TRIANGLES;b.normalBuffer=this.prepareBuffer(f.normals,f.normalIndices)}else{b.mode=this.gl.LINES}if(!q.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE)){d.push({nodeGeometry:f,center:v,vertexCount:b.vertexCount,vertexBuffer:b.vertexBuffer,textureCoordinatesBuffer:b.textureCoordinatesBuffer,normalBuffer:b.normalBuffer,mode:b.mode,referenceCount:1})}}b.transform=j;if(w.length>0){b.parentLinks=w}var c=y.getAmbientColor();if(c!==undefined){b.ambientColor=c}var m=y.getDiffuseColor();if(m!==undefined){b.diffuseColor=m}var h=y.getSpecularColor();if(h!==undefined){b.specularColor=h}var r=y.getShininess();if(r!==undefined){b.shininess=r}var p=y.getTextureCoordinatesGeneration();if(p!==undefined){b.textureCoordinatesGeneration=p}var l=y.getTextureTransform();if(l!==undefined){b.textureTransform=l}if(n!==null){b.texture=n}b.backFaceNormalFlip=y.isBackFaceNormalFlip();if(y.getCullFace()!==undefined){b.cullFace=y.getCullFace()}var a=y.getIllumination();b.lightingEnabled=(a==null||a>=1)&&b.normalBuffer!==null;b.transparency=y.getTransparency()!=null?1-y.getTransparency():1;b.visible=y.isVisible();var k=u?g:o;k.push(b)};HTMLCanvas3D.prototype.updateChildrenTransformation=function(d,a,l,f,k){var c=this;if(d instanceof Group3D){if(d instanceof TransformGroup3D){var m=mat4.create();d.getTransform(m);k=mat4.mul(mat4.create(),k,m)}var b=d.getChildren();for(var g=0;g<b.length;g++){this.updateChildrenTransformation(b[g],a,l,f,k)}}else{if(d instanceof Link3D){l=l.slice(0);l.push(d);this.updateChildrenTransformation(d.getSharedGroup(),a,l,f,k)}else{if(d instanceof Shape3D){for(var g=0;g<a.length;g++){if(a[g].node===d){var h=a[g].parentLinks===undefined;if(!h){if(a[g].parentLinks.length===l.length){var e;for(e=0;e<l.length;e++){if(a[g].parentLinks[e]!==l[e]){break}}h=e===l.length}}if(h){a[g].transform=k;break}}}}else{if(d instanceof Light3D){for(var g=0;g<f.length;g++){if(f[g].node===d){f[g].transform=k;break}}}}}}};HTMLCanvas3D.prototype.removeDisplayedItems=function(c,h,a,f){if(c instanceof Group3D){var b=c.getChildren();for(var g=0;g<b.length;g++){this.removeDisplayedItems(b[g],h,a,f)}}else{if(c instanceof Link3D){this.removeDisplayedItems(c.getSharedGroup(),h,a,f)}else{if(c instanceof Shape3D){var k=c.getGeometries().length;for(var g=a.length-1;k>0&&g>=0;g--){var l=a[g];if(l.node===c){if(c.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE)){this.clearGeometryBuffers(l)}else{for(var e=0;e<h.length;e++){var d=h[e];if(d.nodeGeometry===l.nodeGeometry){if(--d.referenceCount===0){this.clearGeometryBuffers(l);h.splice(e,1)}break}}}a.splice(g,1);k--}}}else{if(c instanceof Light3D){for(var g=0;g<f.length;g++){if(f[g].node===c){f.splice(g,1);break}}}}}}};HTMLCanvas3D.prototype.removeNodeListeners=function(d){var c=d.getPropertyChangeListeners();for(var b=0;b<c.length;b++){if(c[b].canvas3D===this){d.removePropertyChangeListener(c[b])}}if(d instanceof Group3D){c=d.getChildrenListeners();for(var b=0;b<c.length;b++){if(c[b].canvas3D===this){d.removeChildrenListener(c[b])}}var a=d.getChildren();for(var b=0;b<a.length;b++){this.removeNodeListeners(a[b])}}else{if(d instanceof Link3D){this.removeNodeListeners(d.getSharedGroup())}}};HTMLCanvas3D.prototype.prepareTexture=function(a){if(a.url!==undefined){for(var b=0;b<this.textures.length;b++){if(this.textures[b].image.url==a.url){return this.textures[b]}}}var c=this.gl.createTexture();if(c!==null){c.image=a;if(a.width!==0){this.bindTextureAndRepaint(c,true)}else{var d=this;var e=function(){a.removeEventListener("load",e);d.bindTextureAndRepaint(c,false)};a.addEventListener("load",e)}this.textures.push(c);return c}else{console.error("Can't create texture");return this.errorTexture}};HTMLCanvas3D.resizeTransparentTextures=true;HTMLCanvas3D.prototype.bindTextureAndRepaint=function(d,c){if((!Appearance3D.isPowerOfTwo(d.image.width)||!Appearance3D.isPowerOfTwo(d.image.height))&&(!d.image.transparent||HTMLCanvas3D.resizeTransparentTextures)){var a=document.createElement("canvas");a.width=Appearance3D.getNextHighestPowerOfTwo(d.image.width);a.height=Appearance3D.getNextHighestPowerOfTwo(d.image.height);var b=a.getContext("2d");b.drawImage(d.image,0,0,d.image.width,d.image.height,0,0,a.width,a.height);var f=new Image();f.crossOrigin="anonymous";f.url=d.image.url;f.transparent=d.image.transparent;var e=this;var g=function(){f.removeEventListener("load",g);e.bindTexture(d);e.repaint()};f.addEventListener("load",g);f.src=a.toDataURL();d.image=f}else{this.bindTexture(d);if(!c){this.repaint()}}};HTMLCanvas3D.prototype.bindTexture=function(a){this.gl.bindTexture(this.gl.TEXTURE_2D,a);this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,true);this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,a.image);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);if(Appearance3D.isPowerOfTwo(a.image.width)&&Appearance3D.isPowerOfTwo(a.image.height)){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST);this.gl.generateMipmap(this.gl.TEXTURE_2D)}else{this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}this.gl.bindTexture(this.gl.TEXTURE_2D,null);delete a.image.src;a.image.bound=true};HTMLCanvas3D.prototype.prepareBuffer=function(e,g){if(g.length>0&&e.length>0){var b=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b);var f=e[0].length;var a=new Float32Array(g.length*f);for(var d=0,c=0;d<g.length;d++,c+=f){a.set(e[g[d]],c)}this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.STATIC_DRAW);return b}else{return null}};HTMLCanvas3D.prototype.drawScene=function(){this.gl.viewport(0,0,this.viewportWidth,this.viewportHeight);var h=getComputedStyle(this.canvas).backgroundColor;if(h==""){h=this.canvas.style.backgroundColor}h=h.substring(4,h.length-1).replace(/ /g,"").split(",");this.gl.clearColor(h[0]/256,h[1]/256,h[2]/256,h.length===4?h[3]:1);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);var b=vec3.create();var g=0;var s=[];var p=[];var d=mat4.invert(mat4.create(),this.viewPlatformTransform);var m=mat4.create();for(var o=0;o<this.lights.length;o++){var f=this.lights[o];if(f.direction!==undefined){var a=vec3.transformMat3(vec3.create(),f.direction,mat3.fromMat4(mat3.create(),mat4.mul(m,d,f.transform)));vec3.normalize(a,a);vec3.negate(a,a);s.push.apply(s,f.color);p.push.apply(p,a);g++}else{vec3.add(b,b,f.color)}}this.gl.uniform1i(this.shaderProgram.directionalLightCount,g);if(g<HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT){s.push.apply(s,new Array((HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT-g)*3));p.push.apply(p,new Array((HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT-g)*3))}this.gl.uniform3fv(this.shaderProgram.directionalLightColors,s);this.gl.uniform3fv(this.shaderProgram.lightDirections,p);var t=2*Math.atan(this.viewportHeight/this.viewportWidth*Math.tan(this.fieldOfView/2));var l=mat4.create();if(this.projectionPolicy===HTMLCanvas3D.PARALLEL_PROJECTION){mat4.ortho(l,-1,1,-1,1,0.001,1)}else{mat4.perspective(l,t,this.viewportWidth/this.viewportHeight,0.001,1)}this.gl.uniformMatrix4fv(this.shaderProgram.projectionTransform,false,l);var k=mat4.clone(this.viewPlatformTransform);k[12]=0;k[13]=0;k[14]=0;var n=mat4.invert(mat4.create(),k);for(var o=0;o<this.backgroundGeometries.length;o++){var q=this.backgroundGeometries[o];this.drawGeometry(q,n,b,q.lightingEnabled,true,true)}this.gl.clear(this.gl.DEPTH_BUFFER_BIT);this.getVirtualWorldToImageTransform(l);this.gl.uniformMatrix4fv(this.shaderProgram.projectionTransform,false,l);this.gl.enable(this.gl.DEPTH_TEST);var c=[];for(var o=0;o<this.sceneGeometries.length;o++){var j=this.sceneGeometries[o];if(j.visible){if((j.transparency===undefined||j.transparency===1)&&(j.texture===undefined||j.texture.image===undefined||!j.texture.image.transparent)){this.drawGeometry(j,d,b,j.lightingEnabled,true,true)}else{if(j.transparency>0){c.push(j)}}}}this.gl.enable(this.gl.BLEND);this.gl.blendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA);var r=vec3.create();for(var o=0;o<c.length;o++){var j=c[o];vec3.transformMat4(r,j.center,j.transform);vec3.transformMat4(r,r,d);j.zOrder=r[2]}c.sort(function(v,u){return v.zOrder-u.zOrder});for(var o=0;o<c.length;o++){var j=c[o];this.drawGeometry(j,d,b,j.lightingEnabled,true,true)}var e=Date.now();if(Math.floor(e/1000)>Math.floor(this.lastDrawSceneTime/1000)){this.framesPerSecond=Math.round(this.drawnFrameCount/(e-this.previousFramesPerSecondTime)*10000)/10;this.previousFramesPerSecondTime=e;this.drawnFrameCount=0}if(this.drawnFrameCount===undefined){this.previousFramesPerSecondTime=e;this.drawnFrameCount=0}this.drawnFrameCount++;this.lastDrawSceneTime=e};HTMLCanvas3D.prototype.drawGeometry=function(h,d,b,f,a,c){if(h.cullFace!==this.shaderCullFace){this.shaderCullFace=h.cullFace;if(this.shaderCullFace!==undefined){if(this.shaderCullFace===Appearance3D.CULL_NONE){this.gl.disable(this.gl.CULL_FACE)}else{this.gl.enable(this.gl.CULL_FACE);this.gl.cullFace(this.shaderCullFace===Appearance3D.CULL_BACK?this.gl.BACK:this.gl.FRONT)}}else{this.gl.enable(this.gl.CULL_FACE);this.gl.cullFace(this.gl.BACK)}}mat4.copy(this.geometryModelViewTransform,d);mat4.mul(this.geometryModelViewTransform,this.geometryModelViewTransform,h.transform);if(!mat4.exactEquals(this.shaderModelViewTransform,this.geometryModelViewTransform)){mat4.copy(this.shaderModelViewTransform,this.geometryModelViewTransform);this.gl.uniformMatrix4fv(this.shaderProgram.modelViewTransform,false,this.shaderModelViewTransform)}if(this.shaderLightingEnabled!==f){this.shaderLightingEnabled=f;this.gl.uniform1i(this.shaderProgram.lightingEnabled,this.shaderLightingEnabled)}if(f){if(h.ambientColor!==undefined&&h.texture===undefined){vec3.mul(this.geometryAmbientColor,h.ambientColor,b)}else{vec3.set(this.geometryAmbientColor,0,0,0)}if(!vec3.exactEquals(this.shaderAmbientColor,this.geometryAmbientColor)){vec3.copy(this.shaderAmbientColor,this.geometryAmbientColor);this.gl.uniform3fv(this.shaderProgram.ambientColor,this.shaderAmbientColor)}if(!this.ignoreShininess&&h.specularColor!==undefined&&h.shininess!==undefined){if(this.shaderShininess!==h.shininess){this.shaderShininess=h.shininess;this.gl.uniform1f(this.shaderProgram.shininess,this.shaderShininess)}vec3.copy(this.geometrySpecularColor,h.specularColor)}else{vec3.set(this.geometrySpecularColor,0,0,0)}if(!vec3.exactEquals(this.shaderSpecularColor,this.geometrySpecularColor)){vec3.copy(this.shaderSpecularColor,this.geometrySpecularColor);this.gl.uniform3fv(this.shaderProgram.vertexSpecularColor,this.shaderSpecularColor)}mat3.fromMat4(this.geometryNormalTransform,this.geometryModelViewTransform);if(!mat3.exactEquals(this.shaderNormalTransform,this.geometryNormalTransform)){mat3.copy(this.shaderNormalTransform,this.geometryNormalTransform);this.gl.uniformMatrix3fv(this.shaderProgram.normalTransform,false,this.shaderNormalTransform)}if(this.shaderIgnoreNormal!==(h.mode===this.gl.LINES)){this.shaderIgnoreNormal=h.mode===this.gl.LINES;this.gl.uniform1i(this.shaderProgram.ignoreNormal,this.shaderIgnoreNormal)}if(this.shaderBackFaceNormalFlip!==h.backFaceNormalFlip){this.shaderBackFaceNormalFlip=h.backFaceNormalFlip;this.gl.uniform1i(this.shaderProgram.backFaceNormalFlip,this.shaderBackFaceNormalFlip)}}vec3.set(this.geometryDiffuseColor,1,1,1);if(a&&h.texture!==undefined&&(h.texture.image===undefined||h.texture.image.bound)){this.gl.activeTexture(this.gl.TEXTURE0);if(h.textureCoordinatesGeneration){this.gl.uniform4fv(this.shaderProgram.planeS,h.textureCoordinatesGeneration.planeS);this.gl.uniform4fv(this.shaderProgram.planeT,h.textureCoordinatesGeneration.planeT);if(!this.shaderTextureCoordinatesGenerated){this.shaderTextureCoordinatesGenerated=true;this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,true)}}else{if(h.textureCoordinatesBuffer===null){this.gl.uniform4fv(this.shaderProgram.planeS,HTMLCanvas3D.VEC4_DEFAULT_PLANE_S);this.gl.uniform4fv(this.shaderProgram.planeT,HTMLCanvas3D.VEC4_DEFAULT_PLANE_T);if(!this.shaderTextureCoordinatesGenerated){this.shaderTextureCoordinatesGenerated=true;this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,true)}}else{if(this.shaderTextureCoordinatesGenerated){this.shaderTextureCoordinatesGenerated=false;this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,false)}}}var e=h.textureTransform!==undefined?h.textureTransform:HTMLCanvas3D.MAT3_IDENTITY;if(!mat3.exactEquals(this.shaderTextureTransform,e)){mat3.copy(this.shaderTextureTransform,e);this.gl.uniformMatrix3fv(this.shaderProgram.textureCoordTransform,false,this.shaderTextureTransform)}this.gl.bindTexture(this.gl.TEXTURE_2D,h.texture);if(!this.shaderUseTextures){this.shaderUseTextures=true;this.gl.uniform1i(this.shaderProgram.useTextures,true)}}else{if(this.shaderTextureCoordinatesGenerated){this.shaderTextureCoordinatesGenerated=false;this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,false)}if(this.shaderUseTextures){this.shaderUseTextures=false;this.gl.uniform1i(this.shaderProgram.useTextures,false)}if(h.diffuseColor!==undefined){vec3.copy(this.geometryDiffuseColor,h.diffuseColor)}}if(!vec3.exactEquals(this.shaderDiffuseColor,this.geometryDiffuseColor)){vec3.copy(this.shaderDiffuseColor,this.geometryDiffuseColor);this.gl.uniform3fv(this.shaderProgram.vertexDiffuseColor,this.shaderDiffuseColor)}this.gl.enableVertexAttribArray(this.shaderProgram.vertexPositionAttribute);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,h.vertexBuffer);this.gl.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,3,this.gl.FLOAT,false,0,0);if(f&&h.mode===this.gl.TRIANGLES){this.gl.enableVertexAttribArray(this.shaderProgram.normalAttribute);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,h.normalBuffer);this.gl.vertexAttribPointer(this.shaderProgram.normalAttribute,3,this.gl.FLOAT,false,0,0)}else{this.gl.disableVertexAttribArray(this.shaderProgram.normalAttribute)}if(a&&h.textureCoordinatesBuffer!==null&&h.texture!==undefined){this.gl.enableVertexAttribArray(this.shaderProgram.textureCoordAttribute);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,h.textureCoordinatesBuffer);this.gl.vertexAttribPointer(this.shaderProgram.textureCoordAttribute,2,this.gl.FLOAT,false,0,0)}else{this.gl.disableVertexAttribArray(this.shaderProgram.textureCoordAttribute)}var g=h.transparency&&c?h.transparency:1;if(this.shaderAlpha!==g){this.shaderAlpha=g;this.gl.uniform1f(this.shaderProgram.alpha,this.shaderAlpha)}this.gl.drawArrays(h.mode,0,h.vertexCount)};HTMLCanvas3D.prototype.getFramesPerSecond=function(){return this.framesPerSecond};HTMLCanvas3D.prototype.repaint=function(){if(!this.canvasNeededRepaint){this.canvasNeededRepaint=true;if(!this.offscreen){var a=this;requestAnimationFrame(function(){if(a.canvasNeededRepaint){a.drawScene();a.canvasNeededRepaint=false;a.pickingFrameBufferNeededRepaint=true}})}}};HTMLCanvas3D.prototype.getVirtualWorldToImageTransform=function(b,a){if(a===undefined){a=this.viewportWidth/this.viewportHeight}var c=2*Math.atan(Math.tan(this.fieldOfView/2)/a);if(this.projectionPolicy===HTMLCanvas3D.PARALLEL_PROJECTION){mat4.ortho(b,-1,1,-1,1,this.frontClipDistance,this.backClipDistance)}else{mat4.perspective(b,c,a,this.frontClipDistance,this.backClipDistance)}return b};HTMLCanvas3D.prototype.isLoadingCompleted=function(){return this.isTextureLoadingCompleted(this.backgroundGeometries)&&this.isTextureLoadingCompleted(this.sceneGeometries)};HTMLCanvas3D.prototype.isTextureLoadingCompleted=function(b){for(var a=0;a<b.length;a++){var c=b[a].texture;if(c!==undefined&&c.image!==undefined&&!c.image.bound){return false}}return true};HTMLCanvas3D.prototype.getImage=function(a){if(this.canvasNeededRepaint){this.drawScene();this.canvasNeededRepaint=false}var c=new Image();c.crossOrigin="anonymous";var b;if(a!==undefined){b=function(d){c.removeEventListener("load",b);a(c)};c.addEventListener("load",b)}c.src=this.canvas.toDataURL();if(c.width!==0&&a!==undefined){b()}return c};HTMLCanvas3D.prototype.clear=function(){for(var a=0;a<this.textures.length;a++){delete this.textures[a].src;this.gl.deleteTexture(this.textures[a])}this.textures=[];this.clearGeometries(this.sharedGeometries);this.clearGeometries(this.sceneGeometries);this.clearGeometries(this.backgroundGeometries);this.lights=[];if(this.pickingFrameBuffer!==undefined){this.gl.deleteFramebuffer(this.pickingFrameBuffer);delete this.pickingFrameBuffer}this.repaint()};HTMLCanvas3D.prototype.clearGeometries=function(b){for(var a=0;a<b.length;a++){this.clearGeometryBuffers(b[a])}b.length=0};HTMLCanvas3D.prototype.clearGeometryBuffers=function(a){this.gl.deleteBuffer(a.vertexBuffer);if(a.textureCoordinatesBuffer!==null&&a.texture!==undefined){this.gl.deleteBuffer(a.textureCoordinatesBuffer)}if(a.normalBuffer!==undefined){this.gl.deleteBuffer(a.normalBuffer)}};HTMLCanvas3D.prototype.setProjectionPolicy=function(a){this.projectionPolicy=a};HTMLCanvas3D.prototype.setIgnoreShininess=function(a){this.ignoreShininess=a;this.repaint()};HTMLCanvas3D.prototype.getClosestShapeAt=function(k,j){if(this.pickingFrameBuffer===undefined){this.pickingFrameBuffer=this.gl.createFramebuffer();this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pickingFrameBuffer);this.pickingFrameBuffer.width=Appearance3D.isPowerOfTwo(this.canvas.width)?this.canvas.width:Appearance3D.getNextHighestPowerOfTwo(this.canvas.width);this.pickingFrameBuffer.height=Appearance3D.isPowerOfTwo(this.canvas.height)?this.canvas.height:Appearance3D.getNextHighestPowerOfTwo(this.canvas.height);this.pickingFrameBuffer.colorMap=new Uint8Array(this.pickingFrameBuffer.width*this.pickingFrameBuffer.height*4);var c=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,c);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST);this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null);var e=this.gl.createRenderbuffer();this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,e);this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,c,0);this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.DEPTH_COMPONENT16,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height);this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.RENDERBUFFER,e);this.gl.bindTexture(this.gl.TEXTURE_2D,null)}if(this.pickingFrameBufferNeededRepaint){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pickingFrameBuffer);this.gl.viewport(0,0,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height);this.gl.clearColor(1,1,1,1);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);var n=mat4.create();this.getVirtualWorldToImageTransform(n,this.canvas.width/this.canvas.height);this.gl.uniformMatrix4fv(this.shaderProgram.projectionTransform,false,n);this.gl.enable(this.gl.DEPTH_TEST);var m=mat4.invert(mat4.create(),this.viewPlatformTransform);var l=vec3.create();for(var f=0;f<this.sceneGeometries.length;f++){var h=this.sceneGeometries[f];if(h.visible&&h.node.isPickable()){var d=h.diffuseColor;vec3.set(l,((f>>>16)&255)/255,((f>>>8)&255)/255,(f&255)/255);h.diffuseColor=l;this.drawGeometry(h,m,null,false,false,false);if(d!==undefined){h.diffuseColor=d}}}this.gl.readPixels(0,0,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.pickingFrameBuffer.colorMap);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.pickingFrameBufferNeededRepaint=false}var g=this.canvas.getBoundingClientRect();if(k>=g.left&&j>=g.top&&k<g.right&&j<g.bottom){k-=g.left;j-=g.top;var b=(this.pickingFrameBuffer.height-1-Math.floor(j/g.height*this.pickingFrameBuffer.height))*this.pickingFrameBuffer.width+Math.floor(k/g.width*this.pickingFrameBuffer.width);b*=4;var a=this.pickingFrameBuffer.colorMap[b]*65536+this.pickingFrameBuffer.colorMap[b+1]*256+this.pickingFrameBuffer.colorMap[b+2];if(a!=16777215){return this.sceneGeometries[a].node}}return null};var CoreTools={};CoreTools.unavailableResources=[];CoreTools.loadJSON=function(a){if(a.indexOf("/")!==0&&a.indexOf("://")<0){a=ZIPTools.getScriptFolder()+a}if(CoreTools.unavailableResources.indexOf(a)<0){try{var c=new XMLHttpRequest();c.open("GET",a,false);c.send();return JSON.parse(c.responseText)}catch(b){CoreTools.unavailableResources.push(a)}}return undefined};CoreTools.format=function(d,g){if(g===undefined||g.length===0){return d}else{var e=/%%|%s|%d|%\d+\$s|%\d+\$d/g;var b;var k="";var f=0;var j=Array.isArray(g)?g:Array.prototype.slice.call(arguments,1);var c=0;e.lastIndex=0;while((b=e.exec(d))!==null){k+=d.slice(f,e.lastIndex-b[0].length);var a;if(b[0]=="%%"){k+="%"}else{if((a=/%(\d+)\$s/g.exec(b[0]))!==null){var h=parseInt(a[1])-1;k+=j[h]}else{if((a=/%(\d+)\$d/g.exec(b[0]))!==null){var h=parseInt(a[1])-1;k+=j[h]}else{if(c<j.length){k+=j[c];c++}}}}f=e.lastIndex}k+=d.slice(f);return k}};CoreTools.removeAccents=function(a){return a!=null?(typeof a.normalize=="function"?a.normalize("NFD").replace(/[\u0300-\u036f]/g,""):a.replace(/[]/g,"a").replace(/[]/g,"e").replace(/[]/g,"i").replace(/[]/g,"o").replace(/[]/g,"u")):a};CoreTools.loadResourceBundles=function(c,e,a){var d=a?"?requestId="+UUID.randomUUID():"";var b=[];if(e){b.push(CoreTools.loadJSON(c+"_"+e+".json"+d));if(e.indexOf("_")>0){b.push(CoreTools.loadJSON(c+"_"+e.split("_")[0]+".json"+d))}}b.push(CoreTools.loadJSON(c+".json"+d));return b};CoreTools.getStringFromKey=function(c,b,d){for(var a=0;a<c.length;a++){if(c[a]!=null&&c[a][b]!==undefined){return CoreTools.format.apply(null,[c[a][b]].concat(Array.prototype.slice.call(arguments,2)))}}throw new IllegalArgumentException("Can't find resource bundle for "+b)};CoreTools.getKeys=function(b){var c={};for(var a=0;a<b.length;a++){if(b[a]!=null){CoreTools.merge(c,b[a])}}return Object.getOwnPropertyNames(c)};CoreTools.getFromMap=function(d,b){if(typeof b==="string"){return d[b]===undefined?null:d[b]}else{if(d.entries==null){d.entries=[]}var c=typeof b.hashCode==="function"?b.hashCode():undefined;for(var a=0;a<d.entries.length;a++){if((c===undefined||d.entries[a].keyHashCode===c)&&d.entries[a].key.equals!==undefined&&d.entries[a].key.equals(b)||d.entries[a].key===b){return d.entries[a].value}}return null}};CoreTools.putToMap=function(f,b,e){if(typeof b==="string"){f[b]=e}else{if(f.entries==null){f.entries=[]}var d=typeof b.hashCode==="function"?b.hashCode():undefined;for(var a=0;a<f.entries.length;a++){if((d===undefined||f.entries[a].keyHashCode===d)&&f.entries[a].key.equals!==undefined&&f.entries[a].key.equals(b)||f.entries[a].key===b){f.entries[a].value=e;return}}var c={key:b,value:e,getKey:function(){return this.key},getValue:function(){return this.value}};if(typeof b.hashCode==="function"){c.keyHashCode=b.hashCode()}f.entries.push(c)}};CoreTools.removeFromMap=function(e,b){if(typeof b==="string"){var d=e[b];if(d!==undefined){delete e[b]}return d!==undefined?d:null}else{var c=typeof b.hashCode==="function"?b.hashCode():undefined;for(var a=0;a<e.entries.length;a++){if((c===undefined||e.entries[a].keyHashCode===c)&&e.entries[a].key.equals!==undefined&&e.entries[a].key.equals(b)||e.entries[a].key===b){var d=e.entries[a].value;e.entries.splice(a,1);return d}}return null}};CoreTools.valuesFromMap=function(b){var a=[];if(b.entries===undefined){Object.getOwnPropertyNames(b).forEach(function(c){a.push(b[c])})}else{b.entries.forEach(function(c){a.push(c.value)})}return a};CoreTools.sortArray=function(b,a){if(a.compare){b.sort(function(d,c){return a.compare(d,c)})}else{b.sort(a)}};CoreTools.merge=function(a,c){for(var b in c){a[b]=c[b]}};CoreTools.intersection=function(b,a){return b.filter(function(c){return a.indexOf(c)!==-1})};CoreTools.loadAvailableFontNames=function(c){if(document.fonts){var a=["Arial","Arial Black","Bahnschrift","Calibri","Cambria","Cambria Math","Candara","Comic Sans MS","Consolas","Constantia","Corbel","Courier New","Ebrima","Franklin Gothic Medium","Gabriola","Gadugi","Georgia","HoloLens MDL2 Assets","Impact","Ink Free","Javanese Text","Leelawadee UI","Lucida Console","Lucida Sans Unicode","Malgun Gothic","Marlett","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft YaHei","Microsoft Yi Baiti","MingLiU-ExtB","Mongolian Baiti","MS Gothic","MV Boli","Myanmar Text","Nirmala UI","Palatino Linotype","Segoe MDL2 Assets","Segoe Print","Segoe Script","Segoe UI","Segoe UI Historic","Segoe UI Emoji","Segoe UI Symbol","SimSun","Sitka","Sylfaen","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings","Yu Gothic"];var d=["American Typewriter","Andale Mono","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Avenir","Avenir Next","Avenir Next Condensed","Baskerville","Big Caslon","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bradley Hand","Brush Script MT","Chalkboard","Chalkboard SE","Chalkduster","Charter","Cochin","Comic Sans MS","Copperplate","Courier","Courier New","Didot","DIN Alternate","DIN Condensed","Futura","Geneva","Georgia","Gill Sans","Helvetica","Helvetica Neue","Herculanum","Hoefler Text","Impact","Lucida Grande","Luminari","Marker Felt","Menlo","Microsoft Sans Serif","Monaco","Noteworthy","Optima","Palatino","Papyrus","Phosphate","Rockwell","Savoye LET","SignPainter","Skia","Snell Roundhand","Tahoma","Times","Times New Roman","Trattatello","Trebuchet MS","Verdana","Zapfino"];document.fonts.ready.then(function(){var e=[];var h=a.concat(d);for(var f=0;f<h.length;f++){var g=h[f];if(e.indexOf(g)<0&&document.fonts.check('12px "'+g+'"')){e.push(g)}}c(e.sort())})}else{var b=["Arial","Verdana","Helvetica","Tahoma","Trebuchet MS","Times New Roman","Georgia","Garamond","Courier New","Brush Script MT"];c(b.sort())}};var ColorTools={};ColorTools.integerToHexadecimalString=function(a){return"#"+("00000"+(a&16777215).toString(16).toUpperCase()).slice(-6)};ColorTools.styleToHexadecimalString=function(b){var c="rgb(";var a=b.indexOf(c);if(a<0){c="rgba(";a=b.indexOf(c)}if(a>=0){var d=b.slice(c.length,b.indexOf(")")).split(",");return ColorTools.integerToHexadecimalString((parseInt(d[0])<<16)+(parseInt(d[1])<<8)+parseInt(d[2]))}return""};ColorTools.styleToInteger=function(b){var c="rgb(";var a=b.indexOf(c);if(a<0){c="rgba(";a=b.indexOf(c)}if(a>=0){var d=b.slice(c.length,b.indexOf(")")).split(",");return(parseInt(d[0])<<16)+(parseInt(d[1])<<8)+parseInt(d[2])}return -1};ColorTools.isTransparent=function(b){var c="rgba(";var a=b.indexOf(c);if(a>=0){var d=b.slice(c.length,b.indexOf(")")).split(",");return parseFloat(d[3])===0}return false};ColorTools.hexadecimalStringToInteger=function(a){if(a.indexOf("#")===0&&(a.length===7||a.length===9)){a=a.slice(1);return(parseInt(a.slice(0,2),16)<<16)+(parseInt(a.slice(2,4),16)<<8)+parseInt(a.slice(4,6),16)}return -1};ColorTools.toRGBAStyle=function(a,b){var d=ColorTools.hexadecimalStringToInteger(a);return"rgba("+((d&16711680)>>16)+","+((d&65280)>>8)+","+(d&255)+","+b+")"};var ImageTools={};ImageTools.isImageWithAlpha=function(c){var a=document.createElement("canvas");var b=a.getContext("2d");a.width=c.width;a.height=c.height;b.drawImage(c,0,0,c.width,c.height);return ImageTools.isCanvasWithAlpha(a,b)};ImageTools.isCanvasWithAlpha=function(a,c){c=c?c:a.getContext("2d");var d=c.getImageData(0,0,a.width,a.height).data;var e=false;for(var b=3,f=d.length;b<f;b+=4){if(d[b]<255){e=true;break}}return e};ImageTools.resize=function(h,f,b,a,g){var d=document.createElement("canvas");d.width=f;d.height=b;var c=d.getContext("2d");c.drawImage(h,0,0,f,b);var e=new Image();e.addEventListener("load",function(){a(e)});e.src=d.toDataURL(g?g:"image/png")};function URLContent(a){this.url=a}URLContent.__class="com.eteks.sweethome3d.tools.URLContent";URLContent.__interfaces=["com.eteks.sweethome3d.model.Content"];URLContent.prototype.getURL=function(){var o=this.url.indexOf("https://");var j=this.url.indexOf("http://");if(o!==-1||j!==-1){var e=document.getElementsByTagName("script");if(e&&e.length>0){var c=document.getElementsByTagName("script")[0].src;var h=c.indexOf("://");var g=c.substring(0,h);var a=o!==-1?"https":"http";if(g!=a){var k=c.substring(h+"://".length,c.indexOf("/",h+"://".length));var f="";var l=k.indexOf(":");if(l>0){f=k.substring(l);k=k.substring(0,l)}var n=o!==-1?o:j;var m=this.url.indexOf("://",n);var b=this.url.indexOf("/",m+"://".length);var d=this.url.substring(m+"://".length,b);if(d.indexOf(":")>0){d=d.substring(0,d.indexOf(":"))}if(k==d){return this.url.substring(0,n)+g+"://"+k+f+this.url.substring(b)}}}}return this.url};URLContent.prototype.isJAREntry=function(){return this.url.indexOf("jar:")===0&&this.url.indexOf("!/")!==-1};URLContent.prototype.getJAREntryURL=function(){if(!this.isJAREntry()){throw new IllegalStateException("Content isn't a JAR entry")}var a=this.getURL();return a.substring("jar:".length,a.indexOf("!/"))};URLContent.prototype.getJAREntryName=function(){if(!this.isJAREntry()){throw new IllegalStateException("Content isn't a JAR entry")}return this.url.substring(this.url.indexOf("!/")+2)};URLContent.prototype.equals=function(b){if(b===this){return true}else{if(b instanceof URLContent){var a=b;return a.url==this.url}else{return false}}};URLContent.prototype.hashCode=function(){return this.url.split("").reduce(function(d,c){d=((d<<5)-d)+c.charCodeAt(0);return d&d},0)};function HomeURLContent(a){URLContent.call(this,a)}HomeURLContent.prototype=Object.create(URLContent.prototype);HomeURLContent.prototype.constructor=HomeURLContent;HomeURLContent.__class="com.eteks.sweethome3d.io.HomeURLContent";HomeURLContent.__interfaces=["com.eteks.sweethome3d.model.Content"];function SimpleURLContent(a){URLContent.call(this,a)}SimpleURLContent.prototype=Object.create(URLContent.prototype);SimpleURLContent.prototype.constructor=SimpleURLContent;SimpleURLContent.__class="com.eteks.sweethome3d.tools.SimpleURLContent";SimpleURLContent.__interfaces=["com.eteks.sweethome3d.model.Content"];function BlobURLContent(a){var b=URL.createObjectURL(a);URLContent.call(this,b);this.blob=a;this.savedContent=null}BlobURLContent.prototype=Object.create(URLContent.prototype);BlobURLContent.prototype.constructor=BlobURLContent;BlobURLContent.__class="com.eteks.sweethome3d.tools.BlobURLContent";BlobURLContent.__interfaces=["com.eteks.sweethome3d.model.Content"];BlobURLContent.prototype.getBlob=function(){return this.blob};BlobURLContent.prototype.getSavedContent=function(){return this.savedContent};BlobURLContent.prototype.setSavedContent=function(a){this.savedContent=a};BlobURLContent.fromImage=function(e,d,a){var b=document.createElement("canvas");var c=b.getContext("2d");b.width=e.width;b.height=e.height;c.drawImage(e,0,0,e.width,e.height);if(b.msToBlob){a(new BlobURLContent(b.msToBlob()))}else{b.toBlob(function(f){a(new BlobURLContent(f))},d,0.7)}};var OperatingSystem={};OperatingSystem.isLinux=function(){if(navigator&&navigator.platform){return navigator.platform.indexOf("Linux")!==-1}else{return false}};OperatingSystem.isWindows=function(){if(navigator&&navigator.platform){return navigator.platform.indexOf("Windows")!==-1||navigator.platform.indexOf("Win")!==-1}else{return false}};OperatingSystem.isMacOSX=function(){if(navigator&&navigator.platform){return navigator.platform.indexOf("Mac")!==-1}else{return false}};OperatingSystem.getName=function(){if(OperatingSystem.isMacOSX()){return"Mac OS X"}else{if(OperatingSystem.isLinux()){return"Linux"}else{if(OperatingSystem.isWindows()){return"Windows"}else{return"Other"}}}};OperatingSystem.isInternetExplorerOrLegacyEdge=function(){return(document.documentMode||/Edge/.test(navigator.userAgent))};OperatingSystem.isInternetExplorer=function(){return document.documentMode};var ZIPTools={};ZIPTools.READING="Reading";ZIPTools.openedZips={};ZIPTools.runningRequests=[];ZIPTools.getZIP=function(c,b,a){if(a===undefined){a=b;b=false}if(c in ZIPTools.openedZips){a.zipReady(ZIPTools.openedZips[c])}else{try{var e=new XMLHttpRequest();e.open("GET",c,!b);e.responseType="arraybuffer";e.withCredentials=true;e.overrideMimeType("application/octet-stream");e.addEventListener("readystatechange",function(j){if(e.readyState===XMLHttpRequest.DONE){if((e.status===200||e.status===0)&&e.response!=null){try{ZIPTools.runningRequests.splice(ZIPTools.runningRequests.indexOf(e),1);var h=new JSZip(e.response);ZIPTools.openedZips[c]=h;a.zipReady(ZIPTools.openedZips[c])}catch(g){a.zipError(g)}}else{var f=ZIPTools.runningRequests.indexOf(e);if(f>=0){ZIPTools.runningRequests.splice(f,1);a.zipError(new Error(e.status+" while requesting "+c))}}}});e.addEventListener("progress",function(f){if(f.lengthComputable&&a.progression!==undefined){a.progression(ZIPTools.READING,c,f.loaded/f.total)}});e.send();ZIPTools.runningRequests.push(e)}catch(d){a.zipError(d)}}};ZIPTools.clear=function(){ZIPTools.openedZips={};while(ZIPTools.runningRequests.length>0){var a=ZIPTools.runningRequests[ZIPTools.runningRequests.length-1];ZIPTools.runningRequests.splice(ZIPTools.runningRequests.length-1,1);a.abort()}};ZIPTools.disposeZIP=function(a){delete ZIPTools.openedZips[a]};ZIPTools.isJPEGImage=function(a){return a.charAt(0).charCodeAt(0)===255&&a.charAt(1).charCodeAt(0)===216&&a.charAt(2).charCodeAt(0)===255};ZIPTools.isPNGImage=function(a){return a.charAt(0).charCodeAt(0)===137&&a.charAt(1).charCodeAt(0)===80&&a.charAt(2).charCodeAt(0)===78&&a.charAt(3).charCodeAt(0)===71&&a.charAt(4).charCodeAt(0)===13&&a.charAt(5).charCodeAt(0)===10&&a.charAt(6).charCodeAt(0)===26&&a.charAt(7).charCodeAt(0)===10};ZIPTools.isTransparentImage=function(a){return ZIPTools.isPNGImage(a)&&(a.charAt(25).charCodeAt(0)===4||a.charAt(25).charCodeAt(0)===6||(a.indexOf("PLTE")!==-1&&a.indexOf("tRNS")!==-1))};ZIPTools.getScriptFolder=function(b){if(b===undefined){b="jszip.min.js"}var d="http://www.sweethome3d.com/libjs/";var a=document.getElementsByTagName("script");for(var c=0;c<a.length;c++){if(a[c].src.indexOf(b)!==-1){d=a[c].src.substring(0,a[c].src.lastIndexOf("/")+1);break}}return d};function ModelLoader(a){this.modelExtension=a;this.parserBusy=false;this.waitingParsedEntries=[]}ModelLoader.READING_MODEL=Node3D.READING_MODEL;ModelLoader.PARSING_MODEL=Node3D.PARSING_MODEL;ModelLoader.BUILDING_MODEL=Node3D.BUILDING_MODEL;ModelLoader.BINDING_MODEL=Node3D.BINDING_MODEL;ModelLoader.prototype.load=function(e,c,d){if(d===undefined){d=c;c=false}var g=null;if(e.indexOf("jar:")===0){var f=e.indexOf("!/");g=e.substring(f+2);e=e.substring(4,f)}d.progression(ModelLoader.READING_MODEL,e,0);var b=this;var a={zipReady:function(l){try{if(g===null){var h=l.file(/.*/);for(var k=0;k<h.length;k++){if(h[k].name.toLowerCase().match(new RegExp("."+b.modelExtension.toLowerCase()+"$"))){b.parseModelEntry(h[k],l,e,c,d);return}}if(h.length>0){g=h[0].name}else{if(d.modelError!==undefined){d.modelError("Empty file")}return}}b.parseModelEntry(l.file(decodeURIComponent(g)),l,e,c,d)}catch(j){a.zipError(j)}},zipError:function(h){if(d.modelError!==undefined){d.modelError(h)}},progression:function(j,k,h){if(d.progression!==undefined){d.progression(ModelLoader.READING_MODEL,k,h)}}};ZIPTools.getZIP(e,c,a)};ModelLoader.prototype.clear=function(){this.waitingParsedEntries=[]};ModelLoader.prototype.parseModelEntry=function(g,d,f,a,b){if(a){var c=this.getModelContent(g);b.progression(ModelLoader.READING_MODEL,g.name,1);var j={};this.parseDependencies(c,g.name,d,j);var h=this.parseEntryScene(c,g.name,d,j,null,b.progression);this.loadTextureImages(h,{},d,f,true);b.modelLoaded(h)}else{var e={modelEntry:g,zip:d,zipUrl:f,loadingModelObserver:b};this.waitingParsedEntries.push(e);this.parseNextWaitingEntry()}};ModelLoader.prototype.parseNextWaitingEntry=function(){if(!this.parserBusy){for(var e in this.waitingParsedEntries){if(this.waitingParsedEntries.hasOwnProperty(e)){var c=this.waitingParsedEntries[e];var f=c.modelEntry.name;var d=this.getModelContent(c.modelEntry);c.loadingModelObserver.progression(ModelLoader.READING_MODEL,f,1);var b={};this.parseDependencies(d,f,c.zip,b);var a=this;setTimeout(function(){a.parseEntryScene(d,f,c.zip,b,function(g){a.loadTextureImages(g,{},c.zip,c.zipUrl,true);c.loadingModelObserver.modelLoaded(g);a.parserBusy=false;a.parseNextWaitingEntry()},c.loadingModelObserver.progression)},0);this.parserBusy=true;delete this.waitingParsedEntries[e];break}}}};ModelLoader.prototype.loadTextureImages=function(d,j,b,c,a){if(d instanceof Group3D){for(var g=0;g<d.children.length;g++){this.loadTextureImages(d.children[g],j,b,c,a)}}else{if(d instanceof Link3D){this.loadTextureImages(d.getSharedGroup(),j,b,c,a)}else{if(d instanceof Shape3D){var h=d.getAppearance();if(h){var f=h.imageEntryName;if(f!==undefined){delete h[f];if(f in j){h.setTextureImage(j[f])}else{var e=new Image();e.crossOrigin="anonymous";h.setTextureImage(e);e.url="jar:"+c+"!/"+f;j[f]=e;var k=function(){var l=b.file(decodeURIComponent(f));if(l!==null){var p=l.asBinary();var m=btoa(p);var o=f.substring(f.lastIndexOf(".")+1).toLowerCase();var n=ZIPTools.isJPEGImage(p)?"image/jpeg":(ZIPTools.isPNGImage(p)?"image/png":("image/"+o));e.transparent=ZIPTools.isTransparentImage(p);e.src="data:"+n+";base64,"+m}else{h.setTextureImage(null)}};if(a){k()}else{setTimeout(k,0)}}}}}}}};ModelLoader.prototype.getModelContent=function(a){return a.asBinary()};ModelLoader.prototype.parseDependencies=function(b,d,c,a){};ModelLoader.prototype.parseEntryScene=function(b,f,d,a,e,c){};function OBJLoader(){ModelLoader.call(this,"obj");if(OBJLoader.defaultAppearances===null){OBJLoader.defaultAppearances={};OBJLoader.parseMaterial("newmtl amber\nKa 0.0531 0.0531 0.0531\nKd 0.5755 0.2678 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl amber_trans\nKa 0.0531 0.0531 0.0531\nKd 0.5755 0.2678 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nd 0.1600\nNs 60.0000\n\nnewmtl charcoal\nKa 0.0082 0.0082 0.0082\nKd 0.0041 0.0041 0.0041\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl lavendar\nKa 0.1281 0.0857 0.2122\nKd 0.2187 0.0906 0.3469\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl navy_blue\nKa 0.0000 0.0000 0.0490\nKd 0.0000 0.0000 0.0531\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl pale_green\nKa 0.0444 0.0898 0.0447\nKd 0.0712 0.3796 0.0490\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl pale_pink\nKa 0.0898 0.0444 0.0444\nKd 0.6531 0.2053 0.4160\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl pale_yellow\nKa 0.3606 0.3755 0.0935\nKd 0.6898 0.6211 0.1999\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl peach\nKa 0.3143 0.1187 0.0167\nKd 0.6367 0.1829 0.0156\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl periwinkle\nKa 0.0000 0.0000 0.1184\nKd 0.0000 0.0396 0.8286\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl redwood\nKa 0.0204 0.0027 0.0000\nKd 0.2571 0.0330 0.0000\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl smoked_glass\nKa 0.0000 0.0000 0.0000\nKd 0.0041 0.0041 0.0041\nKs 0.1878 0.1878 0.1878\nillum 2\nd 0.0200\nNs 91.4700\n\nnewmtl aqua_filter\nKa 0.0000 0.0000 0.0000\nKd 0.3743 0.6694 0.5791\nKs 0.1878 0.1878 0.1878\nillum 2\nd 0.0200\nNs 91.4700\n\nnewmtl yellow_green\nKa 0.0000 0.0000 0.0000\nKd 0.1875 0.4082 0.0017\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl bluetint\nKa 0.1100 0.4238 0.5388\nKd 0.0468 0.7115 0.9551\nKs 0.3184 0.3184 0.3184\nillum 9\nd 0.4300\nNs 60.0000\nsharpness 60.0000\n\nnewmtl plasma\nKa 0.4082 0.0816 0.2129\nKd 1.0000 0.0776 0.4478\nKs 0.3000 0.3000 0.3000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl emerald\nKa 0.0470 1.0000 0.0000\nKd 0.0470 1.0000 0.0000\nKs 0.2000 0.2000 0.2000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl ruby\nKa 1.0000 0.0000 0.0000\nKd 1.0000 0.0000 0.0000\nKs 0.2000 0.2000 0.2000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl sapphire\nKa 0.0235 0.0000 1.0000\nKd 0.0235 0.0000 1.0000\nKs 0.2000 0.2000 0.2000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl white\nKa 0.4000 0.4000 0.4000\nKd 1.0000 1.0000 1.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl red\nKa 0.4449 0.0000 0.0000\nKd 0.7714 0.0000 0.0000\nKs 0.8857 0.0000 0.0000\nillum 2\nNs 136.4300\n\nnewmtl blue_pure\nKa 0.0000 0.0000 0.5000\nKd 0.0000 0.0000 1.0000\nKs 0.0000 0.0000 0.5000\nillum 2\nNs 65.8900\n\nnewmtl lime\nKa 0.0000 0.5000 0.0000\nKd 0.0000 1.0000 0.0000\nKs 0.0000 0.5000 0.0000\nillum 2\nNs 65.8900\n\nnewmtl green\nKa 0.0000 0.2500 0.0000\nKd 0.0000 0.2500 0.0000\nKs 0.0000 0.2500 0.0000\nillum 2\nNs 65.8900\n\nnewmtl yellow\nKa 1.0000 0.6667 0.0000\nKd 1.0000 0.6667 0.0000\nKs 1.0000 0.6667 0.0000\nillum 2\nNs 65.8900\n\nnewmtl purple\nKa 0.5000 0.0000 1.0000\nKd 0.5000 0.0000 1.0000\nKs 0.5000 0.0000 1.0000\nillum 2\nNs 65.8900\n\nnewmtl orange\nKa 1.0000 0.1667 0.0000\nKd 1.0000 0.1667 0.0000\nKs 1.0000 0.1667 0.0000\nillum 2\nNs 65.8900\n\nnewmtl grey\nKa 0.5000 0.5000 0.5000\nKd 0.1837 0.1837 0.1837\nKs 0.5000 0.5000 0.5000\nillum 2\nNs 65.8900\n\nnewmtl rubber\nKa 0.0000 0.0000 0.0000\nKd 0.0100 0.0100 0.0100\nKs 0.1000 0.1000 0.1000\nillum 2\nNs 65.8900\n\nnewmtl flaqua\nKa 0.0000 0.4000 0.4000\nKd 0.0000 0.5000 0.5000\nillum 1\n\nnewmtl flblack\nKa 0.0000 0.0000 0.0000\nKd 0.0041 0.0041 0.0041\nillum 1\n\nnewmtl flblue_pure\nKa 0.0000 0.0000 0.5592\nKd 0.0000 0.0000 0.7102\nillum 1\n\nnewmtl flgrey\nKa 0.2163 0.2163 0.2163\nKd 0.5000 0.5000 0.5000\nillum 1\n\nnewmtl fllime\nKa 0.0000 0.3673 0.0000\nKd 0.0000 1.0000 0.0000\nillum 1\n\nnewmtl florange\nKa 0.6857 0.1143 0.0000\nKd 1.0000 0.1667 0.0000\nillum 1\n\nnewmtl flpurple\nKa 0.2368 0.0000 0.4735\nKd 0.3755 0.0000 0.7510\nillum 1\n\nnewmtl flred\nKa 0.4000 0.0000 0.0000\nKd 1.0000 0.0000 0.0000\nillum 1\n\nnewmtl flyellow\nKa 0.7388 0.4925 0.0000\nKd 1.0000 0.6667 0.0000\nillum 1\n\nnewmtl pink\nKa 0.9469 0.0078 0.2845\nKd 0.9878 0.1695 0.6702\nKs 0.7429 0.2972 0.2972\nillum 2\nNs 106.2000\n\nnewmtl flbrown\nKa 0.0571 0.0066 0.0011\nKd 0.1102 0.0120 0.0013\nillum 1\n\nnewmtl brown\nKa 0.1020 0.0185 0.0013\nKd 0.0857 0.0147 0.0000\nKs 0.1633 0.0240 0.0000\nillum 2\nNs 65.8900\n\nnewmtl glass\nKa 1.0000 1.0000 1.0000\nKd 0.4873 0.4919 0.5306\nKs 0.6406 0.6939 0.9020\nillum 2\nNs 200.0000\n\nnewmtl flesh\nKa 0.4612 0.3638 0.2993\nKd 0.5265 0.4127 0.3374\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl aqua\nKa 0.0000 0.4000 0.4000\nKd 0.0000 0.5000 0.5000\nKs 0.5673 0.5673 0.5673\nillum 2\nNs 60.0000\n\nnewmtl black\nKa 0.0000 0.0000 0.0000\nKd 0.0020 0.0020 0.0020\nKs 0.5184 0.5184 0.5184\nillum 2\nNs 157.3600\n\nnewmtl silver\nKa 0.9551 0.9551 0.9551\nKd 0.6163 0.6163 0.6163\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl dkblue_pure\nKa 0.0000 0.0000 0.0449\nKd 0.0000 0.0000 0.1347\nKs 0.0000 0.0000 0.5673\nillum 2\nNs 65.8900\n\nnewmtl fldkblue_pure\nKa 0.0000 0.0000 0.0449\nKd 0.0000 0.0000 0.1347\nillum 1\n\nnewmtl dkgreen\nKa 0.0000 0.0122 0.0000\nKd 0.0058 0.0245 0.0000\nKs 0.0000 0.0490 0.0000\nillum 2\nNs 60.0000\n\nnewmtl dkgrey\nKa 0.0490 0.0490 0.0490\nKd 0.0490 0.0490 0.0490\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl ltbrown\nKa 0.1306 0.0538 0.0250\nKd 0.2776 0.1143 0.0531\nKs 0.3000 0.1235 0.0574\nillum 2\nNs 60.0000\n\nnewmtl fldkgreen\nKa 0.0000 0.0122 0.0000\nKd 0.0058 0.0245 0.0000\nillum 1\n\nnewmtl flltbrown\nKa 0.1306 0.0538 0.0250\nKd 0.2776 0.1143 0.0531\nillum 1\n\nnewmtl tan\nKa 0.4000 0.3121 0.1202\nKd 0.6612 0.5221 0.2186\nKs 0.5020 0.4118 0.2152\nillum 2\nNs 60.0000\n\nnewmtl fltan\nKa 0.4000 0.3121 0.1202\nKd 0.6612 0.4567 0.1295\nillum 1\n\nnewmtl brzskin\nKa 0.4408 0.2694 0.1592\nKd 0.3796 0.2898 0.2122\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 25.0000\n\nnewmtl lips\nKa 0.4408 0.2694 0.1592\nKd 0.9265 0.2612 0.2898\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 25.0000\n\nnewmtl redorange\nKa 0.3918 0.0576 0.0000\nKd 0.7551 0.0185 0.0000\nKs 0.4694 0.3224 0.1667\nillum 2\nNs 132.5600\n\nnewmtl blutan\nKa 0.4408 0.2694 0.1592\nKd 0.0776 0.2571 0.2041\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl bluteal\nKa 0.0041 0.1123 0.1224\nKd 0.0776 0.2571 0.2041\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl pinktan\nKa 0.4408 0.2694 0.1592\nKd 0.6857 0.2571 0.2163\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl brnhair\nKa 0.0612 0.0174 0.0066\nKd 0.0898 0.0302 0.0110\nKs 0.1306 0.0819 0.0352\nillum 2\nNs 60.4700\n\nnewmtl blondhair\nKa 0.4449 0.2632 0.0509\nKd 0.5714 0.3283 0.0443\nKs 0.7755 0.4602 0.0918\nillum 2\nNs 4.6500\n\nnewmtl flblonde\nKa 0.4449 0.2632 0.0509\nKd 0.5714 0.3283 0.0443\nillum 1\n\nnewmtl yelloworng\nKa 0.5837 0.1715 0.0000\nKd 0.8857 0.2490 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl bone\nKa 0.3061 0.1654 0.0650\nKd 0.9000 0.7626 0.4261\nKs 0.8939 0.7609 0.5509\nillum 2\nNs 200.0000\n\nnewmtl teeth\nKa 0.6408 0.5554 0.3845\nKd 0.9837 0.7959 0.4694\nillum 1\n\nnewmtl brass\nKa 0.2490 0.1102 0.0000\nKd 0.4776 0.1959 0.0000\nKs 0.5796 0.5796 0.5796\nillum 2\nNs 134.8800\n\nnewmtl dkred\nKa 0.0939 0.0000 0.0000\nKd 0.2286 0.0000 0.0000\nKs 0.2490 0.0000 0.0000\nillum 2\nNs 60.0000\n\nnewmtl taupe\nKa 0.1061 0.0709 0.0637\nKd 0.2041 0.1227 0.1058\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 84.5000\n\nnewmtl dkteal\nKa 0.0000 0.0245 0.0163\nKd 0.0000 0.0653 0.0449\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 55.0400\n\nnewmtl dkdkgrey\nKa 0.0000 0.0000 0.0000\nKd 0.0122 0.0122 0.0122\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl dkblue\nKa 0.0000 0.0029 0.0408\nKd 0.0000 0.0041 0.0571\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl gold\nKa 0.7224 0.1416 0.0000\nKd 1.0000 0.4898 0.0000\nKs 0.7184 0.3695 0.3695\nillum 2\nNs 123.2600\n\nnewmtl redbrick\nKa 0.1102 0.0067 0.0067\nKd 0.3306 0.0398 0.0081\nillum 1\n\nnewmtl flmustard\nKa 0.4245 0.2508 0.0000\nKd 0.8898 0.3531 0.0073\nillum 1\n\nnewmtl flpinegreen\nKa 0.0367 0.0612 0.0204\nKd 0.1061 0.2163 0.0857\nillum 1\n\nnewmtl fldkred\nKa 0.0939 0.0000 0.0000\nKd 0.2286 0.0082 0.0082\nillum 1\n\nnewmtl fldkgreen2\nKa 0.0025 0.0122 0.0014\nKd 0.0245 0.0694 0.0041\nillum 1\n\nnewmtl flmintgreen\nKa 0.0408 0.1429 0.0571\nKd 0.1306 0.2898 0.1673\nillum 1\n\nnewmtl olivegreen\nKa 0.0167 0.0245 0.0000\nKd 0.0250 0.0367 0.0000\nKs 0.2257 0.2776 0.1167\nillum 2\nNs 97.6700\n\nnewmtl skin\nKa 0.2286 0.0187 0.0187\nKd 0.1102 0.0328 0.0139\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 17.8300\n\nnewmtl redbrown\nKa 0.1469 0.0031 0.0000\nKd 0.2816 0.0060 0.0000\nKs 0.3714 0.3714 0.3714\nillum 2\nNs 141.0900\n\nnewmtl deepgreen\nKa 0.0000 0.0050 0.0000\nKd 0.0000 0.0204 0.0050\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 113.1800\n\nnewmtl flltolivegreen\nKa 0.0167 0.0245 0.0000\nKd 0.0393 0.0531 0.0100\nillum 1\n\nnewmtl jetflame\nKa 0.7714 0.0000 0.0000\nKd 0.9510 0.4939 0.0980\nKs 0.8531 0.5222 0.0000\nillum 2\nNs 132.5600\n\nnewmtl brownskn\nKa 0.0122 0.0041 0.0000\nKd 0.0204 0.0082 0.0000\nKs 0.0735 0.0508 0.0321\nillum 2\nNs 20.1600\n\nnewmtl greenskn\nKa 0.0816 0.0449 0.0000\nKd 0.0000 0.0735 0.0000\nKs 0.0490 0.1224 0.0898\nillum 3\nNs 46.5100\nsharpness 146.5100\n\nnewmtl ltgrey\nKa 0.5000 0.5000 0.5000\nKd 0.3837 0.3837 0.3837\nKs 0.5000 0.5000 0.5000\nillum 2\nNs 65.8900\n\nnewmtl bronze\nKa 0.0449 0.0204 0.0000\nKd 0.0653 0.0367 0.0122\nKs 0.0776 0.0408 0.0000\nillum 3\nNs 137.2100\nsharpness 125.5800\n\nnewmtl bone1\nKa 0.6408 0.5554 0.3845\nKd 0.9837 0.7959 0.4694\nillum 1\n\nnewmtl flwhite1\nKa 0.9306 0.9306 0.9306\nKd 1.0000 1.0000 1.0000\nillum 1\n\nnewmtl flwhite\nKa 0.6449 0.6116 0.5447\nKd 0.9837 0.9309 0.8392\nKs 0.8082 0.7290 0.5708\nillum 2\nNs 200.0000\n\nnewmtl shadow\nKd 0.0350 0.0248 0.0194\nillum 0\nd 0.2500\n\nnewmtl fldkolivegreen\nKa 0.0056 0.0082 0.0000\nKd 0.0151 0.0204 0.0038\nillum 1\n\nnewmtl fldkdkgrey\nKa 0.0000 0.0000 0.0000\nKd 0.0122 0.0122 0.0122\nillum 1\n\nnewmtl lcdgreen\nKa 0.4000 0.4000 0.4000\nKd 0.5878 1.0000 0.5061\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl brownlips\nKa 0.1143 0.0694 0.0245\nKd 0.1429 0.0653 0.0408\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 25.0000\n\nnewmtl muscle\nKa 0.2122 0.0077 0.0154\nKd 0.4204 0.0721 0.0856\nKs 0.1184 0.1184 0.1184\nillum 2\nNs 25.5800\n\nnewmtl flltgrey\nKa 0.5224 0.5224 0.5224\nKd 0.8245 0.8245 0.8245\nillum 1\n\nnewmtl offwhite.warm\nKa 0.5184 0.4501 0.3703\nKd 0.8367 0.6898 0.4490\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl offwhite.cool\nKa 0.5184 0.4501 0.3703\nKd 0.8367 0.6812 0.5703\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl yellowbrt\nKa 0.4000 0.4000 0.4000\nKd 1.0000 0.7837 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl chappie\nKa 0.4000 0.4000 0.4000\nKd 0.5837 0.1796 0.0367\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl archwhite\nKa 0.2816 0.2816 0.2816\nKd 0.9959 0.9959 0.9959\nillum 1\n\nnewmtl archwhite2\nKa 0.2816 0.2816 0.2816\nKd 0.8408 0.8408 0.8408\nillum 1\n\nnewmtl lighttan\nKa 0.0980 0.0536 0.0220\nKd 0.7020 0.4210 0.2206\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl lighttan2\nKa 0.0980 0.0492 0.0144\nKd 0.3143 0.1870 0.0962\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl lighttan3\nKa 0.0980 0.0492 0.0144\nKd 0.1796 0.0829 0.0139\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl lightyellow\nKa 0.5061 0.1983 0.0000\nKd 1.0000 0.9542 0.3388\nKs 1.0000 0.9060 0.0000\nillum 2\nNs 177.5200\n\nnewmtl lighttannew\nKa 0.0980 0.0492 0.0144\nKd 0.7878 0.6070 0.3216\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl default\nKa 0.4000 0.4000 0.4000\nKd 0.7102 0.7020 0.6531\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 128.0000\n\nnewmtl ship2\nKa 0.0000 0.0000 0.0000\nKd 1.0000 1.0000 1.0000\nKs 0.1143 0.1143 0.1143\nillum 2\nNs 60.0000\n\nnewmtl dkpurple\nKa 0.0082 0.0000 0.0163\nKd 0.0245 0.0000 0.0490\nKs 0.1266 0.0000 0.2531\nillum 2\nNs 65.8900\n\nnewmtl dkorange\nKa 0.4041 0.0123 0.0000\nKd 0.7143 0.0350 0.0000\nKs 0.7102 0.0870 0.0000\nillum 2\nNs 65.8900\n\nnewmtl mintgrn\nKa 0.0101 0.1959 0.0335\nKd 0.0245 0.4776 0.0816\nKs 0.0245 0.4776 0.0816\nillum 2\nNs 65.8900\n\nnewmtl fgreen\nKa 0.0000 0.0449 0.0000\nKd 0.0000 0.0449 0.0004\nKs 0.0062 0.0694 0.0000\nillum 2\nNs 106.2000\n\nnewmtl glassblutint\nKa 0.4000 0.4000 0.4000\nKd 0.5551 0.8000 0.7730\nKs 0.7969 0.9714 0.9223\nillum 4\nd 0.6700\nNs 60.0000\nsharpness 60.0000\n\nnewmtl bflesh\nKa 0.0122 0.0122 0.0122\nKd 0.0245 0.0081 0.0021\nKs 0.0531 0.0460 0.0153\nillum 2\nNs 20.1600\n\nnewmtl meh\nKa 0.4000 0.4000 0.4000\nKd 0.5551 0.8000 0.7730\nKs 0.7969 0.9714 0.9223\nillum 4\nd 0.2500\nNs 183.7200\nsharpness 60.0000\n\nnewmtl violet\nKa 0.0083 0.0000 0.1265\nKd 0.0287 0.0269 0.1347\nKs 0.2267 0.4537 0.6612\nillum 2\nNs 96.9000\n\nnewmtl iris\nKa 0.3061 0.0556 0.0037\nKd 0.0000 0.0572 0.3184\nKs 0.8041 0.6782 0.1477\nillum 2\nNs 188.3700\n\nnewmtl blugrn\nKa 0.4408 0.4144 0.1592\nKd 0.0811 0.6408 0.2775\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl glasstransparent\nKa 0.2163 0.2163 0.2163\nKd 0.4694 0.4694 0.4694\nKs 0.6082 0.6082 0.6082\nillum 4\nd 0.2500\nNs 200.0000\nsharpness 60.0000\n\nnewmtl fleshtransparent\nKa 0.4000 0.2253 0.2253\nKd 0.6898 0.2942 0.1295\nKs 0.7388 0.4614 0.4614\nillum 4\nd 0.2500\nNs 6.2000\nsharpness 60.0000\n\nnewmtl fldkgrey\nKa 0.0449 0.0449 0.0449\nKd 0.0939 0.0939 0.0939\nillum 1\n\nnewmtl sky_blue\nKa 0.1363 0.2264 0.4122\nKd 0.1241 0.5931 0.8000\nKs 0.0490 0.0490 0.0490\nillum 2\nNs 13.9500\n\nnewmtl fldkpurple\nKa 0.0443 0.0257 0.0776\nKd 0.1612 0.0000 0.3347\nKs 0.0000 0.0000 0.0000\nillum 2\nNs 13.9500\n\nnewmtl dkbrown\nKa 0.0143 0.0062 0.0027\nKd 0.0087 0.0038 0.0016\nKs 0.2370 0.2147 0.1821\nillum 3\nNs 60.0000\nsharpness 60.0000\n\nnewmtl bone2\nKa 0.6408 0.5388 0.3348\nKd 0.9837 0.8620 0.6504\nillum 1\n\nnewmtl bluegrey\nKa 0.4000 0.4000 0.4000\nKd 0.1881 0.2786 0.2898\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 14.7300\n\nnewmtl metal\nKa 0.9102 0.8956 0.1932\nKd 0.9000 0.7626 0.4261\nKs 0.8939 0.8840 0.8683\nillum 2\nNs 200.0000\n\nnewmtl sand_stone\nKa 0.1299 0.1177 0.0998\nKd 0.1256 0.1138 0.0965\nKs 0.2370 0.2147 0.1821\nillum 3\nNs 60.0000\nsharpness 60.0000\n\nnewmtl hair\nKa 0.0013 0.0012 0.0010\nKd 0.0008 0.0007 0.0006\nKs 0.0000 0.0000 0.0000\nillum 3\nNs 60.0000\nsharpness 60.0000\n",OBJLoader.defaultAppearances,null,null)}}OBJLoader.prototype=Object.create(ModelLoader.prototype);OBJLoader.prototype.constructor=OBJLoader;OBJLoader.defaultAppearances=null;OBJLoader.prototype.createScene=function(d,c,j,b,e,m,f){var h=new Group3D();if(m===null){f(ModelLoader.BUILDING_MODEL,"",0);for(var l in b){this.createGroupShapes(d,c,j,b[l],e,h)}f(ModelLoader.BUILDING_MODEL,"",1);return h}else{var a=0;for(var l in b){a+=b[l].geometries.length}var g=0;var k=this;var n=function(){f(ModelLoader.BUILDING_MODEL,"",a!==0?g/a:0);var p=Date.now();for(var o in b){k.createGroupShapes(d,c,j,b[o],e,h);g+=b[o].geometries.length;delete b[o];if(g<a&&Date.now()-p>10){setTimeout(n,0);return}}setTimeout(function(){f(ModelLoader.BUILDING_MODEL,"",1);m(h)},0)};n()}};OBJLoader.prototype.createGroupShapes=function(o,g,y,r,x,t){var w=r.geometries;if(w.length>0){var F=0;while(F<w.length){var d=w[F];var G=d.textureCoordinateIndices.length>0;var H=(d instanceof OBJLoader.OBJFace)&&d.normalIndices.length>0;var I=(d instanceof OBJLoader.OBJFace)&&d.smooth;var f=d.material;var v=OBJLoader.getAppearance(x,f);var E=F;while(++E<w.length){var m=w[E];var u=m.material;if((m.constructor!==d.constructor)||u===null&&f!==null||u!==null&&OBJLoader.getAppearance(x,u)!==v||(I^((m instanceof OBJLoader.OBJFace)&&m.smooth))||(G^m.textureCoordinateIndices.length>0)||(H^((m instanceof OBJLoader.OBJFace)&&m.normalIndices.length>0))){break}}if(v!==null){v=v.clone()}var z=E-F;var h=[];var q=[];var e=true;for(var D=0;D<z;D++){var b=w[F+D].vertexIndices;h.push.apply(h,b);q.push(b.length);if(e&&b.length!==3){e=false}}var l=[];if(G){for(var D=0;D<z;D++){l.push.apply(l,w[F+D].textureCoordinateIndices)}}var A;if(d instanceof OBJLoader.OBJFace){var s=[];if(H){for(var D=0;D<z;D++){s.push.apply(s,w[F+D].normalIndices)}}var B=new GeometryInfo3D(e?GeometryInfo3D.TRIANGLE_ARRAY:GeometryInfo3D.POLYGON_ARRAY);B.setCoordinates(o);B.setCoordinateIndices(h);B.setNormals(y);B.setNormalIndices(s);B.setTextureCoordinates(g);B.setTextureCoordinateIndices(l);B.setStripCounts(q);if(!H){B.setCreaseAngle(I?Math.PI/2:0);B.setGeneratedNormals(true)}A=B.getIndexedGeometryArray()}else{var n=[];var a=[];for(var D=0,p=0;D<z;p+=q[D],D++){for(var C=0;C<q[D]-1;C++){n.push(h[p+C]);n.push(h[p+C+1]);if(l.length>0){a.push(l[p+C]);a.push(l[p+C+1])}}}A=new IndexedLineArray3D(o,n,g,a)}var c=new Shape3D(A,v);t.addChild(c);c.setName(r.name+(F===0?"":"_"+F));F=E}}};OBJLoader.getAppearance=function(c,b){var a=undefined;if(b!==null){a=c[b]}if(a===undefined){a=OBJLoader.defaultAppearances["default"]}return a};OBJLoader.prototype.parseDependencies=function(c,a,b,f){f.appearances={};for(var d in OBJLoader.defaultAppearances){var e=OBJLoader.defaultAppearances[d];f.appearances[e.getName()]=e}try{var h=c.indexOf("mtllib");while(h!==-1){var j=h+6;while(j<c.length&&c.charAt(j)!="\n"&&c.charAt(j)!="\r"){j++}var m=c.substring(h,j).trim();var l=m.substring(7,m.length).trim();this.parseMaterialEntry(l,f.appearances,a,b);h=c.indexOf("mtllib",j)}}catch(g){f.appearances={}}};OBJLoader.prototype.parseEntryScene=function(f,c,e,k,r,m){var j=[];var h=[];var p=[];var n=new OBJLoader.OBJGroup("default");var g={"default":n};var b={};var a={group:n,material:"default",smooth:false};if(r===null){try{m(ModelLoader.PARSING_MODEL,c,0);for(var o=0;o<=f.length;){o=this.parseObjectLine(f,o,j,h,p,g,b,a)}m(ModelLoader.PARSING_MODEL,c,1);return this.createScene(j,h,p,g,k.appearances,null,m)}catch(l){m(ModelLoader.PARSING_MODEL,c,1);return this.createScene([],[],[],{},k.appearances,null,m)}}else{var o=0;var q=this;var d=function(){try{m(ModelLoader.PARSING_MODEL,c,o/f.length);var t=o+200000;var u=Date.now();while(o<=f.length){o=q.parseObjectLine(f,o,j,h,p,g,b,a);if(o<=f.length&&o>t&&Date.now()-u>10){setTimeout(d,0);return}}setTimeout(function(){m(ModelLoader.PARSING_MODEL,c,1);q.createScene(j,h,p,g,k.appearances,function(v){r(v)},m)},0)}catch(s){m(ModelLoader.PARSING_MODEL,c,1);q.createScene([],[],[],{},k.appearances,r,m)}};d()}};OBJLoader.prototype.parseObjectLine=function(f,m,k,h,n,g,b,a){var o=m+1;while(o<f.length&&f.charAt(o)!="\n"&&f.charAt(o)!="\r"){o++}var q=f.substring(m,o);if(q.indexOf("v")===0||q.indexOf("f ")===0||q.indexOf("l ")===0){while(q.charAt(q.length-1)==="\\"){q=q.substring(0,q.length-1)+" ";m=o+1;if(m<f.length&&f.charAt(o)=="\r"&&f.charAt(m)=="\n"){m++}o=m+1;while(o<f.length&&f.charAt(o)!="\n"&&f.charAt(o)!="\r"){o++}q+=f.substring(m,o)}}q=q.trim();var p=q.split(/\s+/);var d=p[0];if(d==="v"){k.push(OBJLoader.parseVector3f(p))}else{if(d==="vt"){h.push(OBJLoader.parseVector2f(p))}else{if(d==="vn"){try{n.push(OBJLoader.parseVector3f(p))}catch(j){console.log(f+" "+q)}}else{if(d==="l"){var q=this.parseLine(p,a.material);if(q.vertexIndices.length>1){a.group.addGeometry(q)}}else{if(d==="f"){var l=this.parseFace(p,a.smooth,a.material);if(l.vertexIndices.length>2){if(l.normalIndices.length===0||a.group.name.indexOf("sweethome3d_")===0){a.group.addGeometry(l)}else{if(!(l.material in b)){b[l.material]=a.group}b[l.material].addGeometry(l)}}}else{if(d==="g"||d==="o"){if(p.length>1){var c=p[1];a.group=g[c];if(a.group===undefined){a.group=new OBJLoader.OBJGroup(c);g[c]=a.group}}else{a.group=g["default"]}}else{if(d==="s"){a.smooth=p[1]!="off"}else{if(d==="usemtl"){a.material=q.substring(7,q.length).trim()}}}}}}}}m=o+1;if(m<f.length&&f.charAt(o)=="\r"&&f.charAt(m)=="\n"){m++}return m};OBJLoader.prototype.parseLine=function(a,e){var d=[];var g=[];for(var c=0;c<a.length;c++){var f=a[c];if(c>0&&f.length>0){var b=f.indexOf("/");if(b===-1){d.push(OBJLoader.parseInteger(f)-1)}else{d.push(OBJLoader.parseInteger(f.substring(0,b))-1);g.push(OBJLoader.parseInteger(f.substring(b+1))-1)}}}if(d.length!==g.length){g=[]}return new OBJLoader.OBJLine(d,g,e)};OBJLoader.prototype.parseFace=function(h,a,g){var e=[];var c=[];var k=[];for(var f=0;f<h.length;f++){var j=h[f];if(f>0&&j.length>0){var b=j.indexOf("/");if(b===-1){e.push(OBJLoader.parseInteger(j)-1)}else{e.push(OBJLoader.parseInteger(j.substring(0,b))-1);var d=j.lastIndexOf("/");if(b===d){c.push(OBJLoader.parseInteger(j.substring(b+1))-1)}else{if(b+1!==d){c.push(OBJLoader.parseInteger(j.substring(b+1,d))-1)}k.push(OBJLoader.parseInteger(j.substring(d+1))-1)}}}}if(e.length!==c.length){c=[]}if(e.length!==k.length){k=[]}return new OBJLoader.OBJFace(e,c,k,a,g)};OBJLoader.prototype.parseMaterialEntry=function(d,f,e,c){var a=e.lastIndexOf("/");if(a>=0){d=e.substring(0,a+1)+d}var b=c.file(d);if(b!==null){OBJLoader.parseMaterial(b.asBinary(),f,e,c)}};OBJLoader.parseVector3f=function(a){return vec3.fromValues(OBJLoader.parseNumber(a[1]),OBJLoader.parseNumber(a[2]),OBJLoader.parseNumber(a[3]))};OBJLoader.parseVector2f=function(a){return vec2.fromValues(OBJLoader.parseNumber(a[1]),OBJLoader.parseNumber(a[2]))};OBJLoader.parseInteger=function(a){var b=parseInt(a);if(isNaN(b)){throw new IncorrectFormat3DException("Incorrect integer "+a)}return b};OBJLoader.parseNumber=function(b){var a=parseFloat(b);if(isNaN(a)){if(b=="NaN"){return NaN}throw new IncorrectFormat3DException("Incorrect number "+b)}return a};OBJLoader.parseMaterial=function(l,j,a,c){var d=null;var m=l.match(/^.*$/mg);for(var h=0;h<m.length;h++){var n=m[h].trim();var k=n.split(/\s+/);var b=k[0];if(b=="newmtl"){d=new Appearance3D(n.substring(7,n.length).trim());j[d.getName()]=d}else{if(d!==null){if(b=="Ka"){d.setAmbientColor(OBJLoader.parseVector3f(k))}else{if(b=="Kd"){d.setDiffuseColor(OBJLoader.parseVector3f(k))}else{if(b=="Ks"){d.setSpecularColor(OBJLoader.parseVector3f(k))}else{if(b=="Ns"){d.setShininess(Math.max(1,Math.min(OBJLoader.parseNumber(k[1]),128)))}else{if(b=="d"){d.setTransparency(1-Math.max(0,OBJLoader.parseNumber(k[1]=="-halo"?k[2]:k[1])))}else{if(b=="illum"){d.setIllumination(OBJLoader.parseInteger(k[1]))}else{if(b=="map_Kd"){var e=k[k.length-1];var f=a.lastIndexOf("/");if(f>=0){e=a.substring(0,f+1)+e}var g=c.file(e);if(g===null&&k.length>2){e=n.substring(7,n.length).trim();if(f>=0){e=a.substring(0,f+1)+e}g=c.file(e)}if(g!==null){d.imageEntryName=e}}}}}}}}}}}};OBJLoader.OBJGroup=function(a){this.name=a;this.geometries=[]};OBJLoader.OBJGroup.prototype.addGeometry=function(a){this.geometries.push(a)};OBJLoader.OBJLine=function(b,c,a){this.vertexIndices=b;this.textureCoordinateIndices=c;this.material=a};OBJLoader.OBJFace=function(d,e,b,a,c){this.vertexIndices=d;this.textureCoordinateIndices=e;this.normalIndices=b;this.smooth=a;this.material=c};function DAELoader(){ModelLoader.call(this,"dae")}DAELoader.prototype=Object.create(ModelLoader.prototype);DAELoader.prototype.constructor=DAELoader;DAELoader.prototype.parseEntryScene=function(b,c,a,d,j,g){var h=new Group3D();var k=new DAEHandler(h,c);var f=new SAXParser(k,k,k,k,k);g(ModelLoader.PARSING_MODEL,c,0);try{f.parseString(b)}catch(e){h.removeAllChildren()}if(j===null){g(ModelLoader.PARSING_MODEL,c,1);return h}else{setTimeout(function(){g(ModelLoader.PARSING_MODEL,c,1);j(h)},0)}};function DAEHandler(a,b){DefaultHandler.call(this);this.sceneRoot=a;this.daeEntryName=b;this.parentGroups=[];this.parentElements=[];this.buffer="";this.postProcessingBinders=[];this.textures={};this.effectAppearances={};this.materialEffects={};this.materialNames={};this.surface2DIds={};this.sampler2DIds={};this.geometries={};this.sources={};this.positions={};this.normals={};this.textureCoordinates={};this.floatArrays={};this.sourceAccessorStrides=[];this.appearanceGeometries={};this.facesAndLinesPrimitives=[];this.polygonsPrimitives=[];this.polygonsHoles=[];this.nodes={};this.instantiatedNodes={};this.visualScenes={};this.visualScene=null;this.floats=null;this.geometryVertices=[];this.geometryNormals=[];this.geometryTextureCoordinates=[];this.vcount=[];this.transparentColor=[];this.transparency=null;this.inRootAsset=false;this.reverseTransparency=false;this.imageId=null;this.materialId=null;this.effectId=null;this.newParamSid=null;this.inSurface2D=false;this.inPhongBlinnOrLambert=false;this.techniqueProfile=null;this.inConstant=false;this.geometryId=null;this.meshSourceId=null;this.verticesId=null;this.floatArrayId=null;this.geometryAppearance=null;this.geometryVertexOffset=0;this.geometryNormalOffset=0;this.geometryTextureCoordinatesOffset=0;this.axis=null;this.meterScale=1;this.floatValue=0;this.opaque=null;this.inputCount=0}DAEHandler.prototype=Object.create(DefaultHandler.prototype);DAEHandler.prototype.constructor=DAEHandler;DAEHandler.prototype.startElement=function(o,g,I,r){this.buffer="";var s=this.parentElements.length===0?null:this.parentElements[this.parentElements.length-1];if(s===null&&!("COLLADA"==I)){throw new SAXException("Expected COLLADA element")}else{if("COLLADA"==I){var l=r.getValue("version");if(l.indexOf("1.4")!==0){throw new SAXException("Version "+l+" not supported")}}else{if("COLLADA"==s&&"asset"==I){this.inRootAsset=true}else{if("asset"==s&&"unit"==I){var B=r.getValue("meter");if(B!==null){this.meterScale=parseFloat(B)}}else{if("image"==I){this.imageId=r.getValue("id")}else{if("material"==I){this.materialId=r.getValue("id");this.materialNames[this.materialId]=r.getValue("name")}else{if("material"==s&&"instance_effect"==I){var t=r.getValue("url");if(t.indexOf("#")===0){var f=t.substring(1);this.materialEffects[this.materialId]=f}}else{if("effect"==I){this.effectId=r.getValue("id");this.effectAppearances[this.effectId]=new Appearance3D()}else{if(this.effectId!==null){if("profile_COMMON"==s&&"newparam"==I){this.newParamSid=r.getValue("sid")}else{if("newparam"==s&&"surface"==I&&"2D"==r.getValue("type")){this.inSurface2D=true}else{if("extra"==s&&"technique"==I){this.techniqueProfile=r.getValue("profile")}else{if("phong"==I||"blinn"==I){this.inPhongBlinnOrLambert=true}else{if("lambert"==I){this.inPhongBlinnOrLambert=true;this.effectAppearances[this.effectId].setSpecularColor(vec3.fromValues(0,0,0));this.effectAppearances[this.effectId].setShininess(1)}else{if("constant"==I){this.inConstant=true}else{if(this.inConstant||this.inPhongBlinnOrLambert&&("transparent"==I)){this.opaque=r.getValue("opaque");if(this.opaque===null){this.opaque="A_ONE"}}else{if("texture"==I&&"diffuse"==s){var J=this.surface2DIds[this.sampler2DIds[r.getValue("texture")]];var u=this.effectAppearances[this.effectId];var d=this;this.postProcessingBinders.push(function(){u.imageEntryName=d.textures[J]})}}}}}}}}}else{if("geometry"==I){this.geometryId=r.getValue("id");this.geometries[this.geometryId]=[]}else{if(this.geometryId!==null){if("mesh"==s&&"source"==I){this.meshSourceId=r.getValue("id")}else{if("mesh"==s&&"vertices"==I){this.verticesId=r.getValue("id")}else{if(this.meshSourceId!==null){if("float_array"==I){this.floatArrayId=r.getValue("id")}else{if("technique_common"==s&&"accessor"==I){var b=r.getValue("source").substring(1);var z=r.getValue("stride");z=z!==null?parseInt(z):1;this.sourceAccessorStrides.push({floatArray:this.floatArrays[b],stride:z})}}}else{if(this.verticesId!==null&&"input"==I){var H=r.getValue("source").substring(1);var A=this.sources[H];if(A!==undefined){if("POSITION"==r.getValue("semantic")){this.positions[this.verticesId]=new Array(A.length/3);for(var E=0,C=0;C<A.length;E++,C+=3){this.positions[this.verticesId][E]=vec3.fromValues(A[C],A[C+1],A[C+2])}}else{if("NORMAL"==r.getValue("semantic")){this.normals[this.verticesId]=new Array(A.length/3);for(var E=0,C=0;C<A.length;E++,C+=3){this.normals[this.verticesId][E]=vec3.fromValues(A[C],A[C+1],A[C+2])}}else{if("TEXCOORD"==r.getValue("semantic")){this.textureCoordinates[this.verticesId]=new Array(A.length/2);for(var E=0,C=0;C<A.length;E++,C+=2){this.textureCoordinates[this.verticesId][E]=vec2.fromValues(A[C],A[C+1])}}}}}}else{if(this.verticesId===null&&"input"==I){var H=r.getValue("source").substring(1);var n=parseInt(r.getValue("offset"));if(this.inputCount<n+1){this.inputCount=n+1}if("VERTEX"==r.getValue("semantic")){this.geometryVertices=this.positions[H];if(this.geometryVertices===undefined){this.geometryVertices=null}this.geometryVertexOffset=n;if(this.geometryNormals===null){this.geometryNormals=this.normals[H];this.geometryNormalOffset=n}if(this.geometryTextureCoordinates===null){this.geometryTextureCoordinates=this.textureCoordinates[H];this.geometryTextureCoordinatesOffset=n}}else{if("NORMAL"==r.getValue("semantic")){var A=this.sources[H];if(A!==undefined){this.geometryNormals=new Array(A.length/3);for(var E=0,C=0;C<A.length;E++,C+=3){this.geometryNormals[E]=vec3.fromValues(A[C],A[C+1],A[C+2])}this.geometryNormalOffset=n}}else{if("TEXCOORD"==r.getValue("semantic")){var A=this.sources[H];if(A!==undefined){this.geometryTextureCoordinates=new Array(A.length/2);for(var E=0,C=0;C<A.length;E++,C+=2){this.geometryTextureCoordinates[E]=vec2.fromValues(A[C],A[C+1])}this.geometryTextureCoordinatesOffset=n}}}}}else{if("triangles"==I||"trifans"==I||"tristrips"==I||"polylist"==I||"polygons"==I||"lines"==I||"linestrips"==I){this.geometryAppearance=r.getValue("material");this.inputCount=0;this.facesAndLinesPrimitives=[];this.polygonsPrimitives=[];this.polygonsHoles=[];this.vcount=null}}}}}}}else{if("visual_scene"==I){var v=new TransformGroup3D();this.parentGroups.push(v);this.visualScenes[r.getValue("id")]=v}else{if("node"==I){var G=new TransformGroup3D();if(this.parentGroups.length>0){this.parentGroups[this.parentGroups.length-1].addChild(G)}this.parentGroups.push(G);this.nodes[r.getValue("id")]=G;var c=r.getValue("name");if(c!==null){G.setName(c)}}else{if("node"==s&&"instance_geometry"==I){var D=r.getValue("url");if(D.indexOf("#")===0){var p=D.substring(1);var c=r.getValue("name");var j=new Group3D();this.parentGroups[this.parentGroups.length-1].addChild(j);this.parentGroups.push(j);var d=this;this.postProcessingBinders.push(function(){var M=0;var L=d.geometries[p];for(var K=0;K<L.length;K++){var k=new Shape3D(L[K]);j.addChild(k);if(c!==null){if(M===0){k.setName(c)}else{k.setName(c+"_"+M)}M++}}})}}else{if("instance_node"==I){var h=r.getValue("url");if(h.indexOf("#")===0){var y=h.substring(1);var F=this.parentGroups[this.parentGroups.length-1];var d=this;this.postProcessingBinders.push(function(){var k=d.instantiatedNodes[y];if(k===undefined){k=new SharedGroup3D();k.addChild(d.nodes[y]);d.instantiatedNodes[y]=k}F.addChild(new Link3D(k))})}}else{if("instance_material"==I&&this.parentGroups.length>0){var m=r.getValue("target");if(m.indexOf("#")==0){var x=m.substring(1);var a=r.getValue("symbol");var q=this.parentGroups[this.parentGroups.length-1];var d=this;this.postProcessingBinders.push(function(){var k=d.effectAppearances[d.materialEffects[x]];var K=function(P,L){if(P instanceof Group3D){var N=P.getChildren();for(var M=0;M<N.length;M++){K(N[M],L)}}else{if(P instanceof Link3D){K(P.getSharedGroup(),L)}else{if(P instanceof Shape3D){var O=d.appearanceGeometries[a];if(O!==undefined){for(var M=0;M<O.length;M++){if(O[M]===P.getGeometries()[0]){P.setAppearance(L);break}}}}}}};K(q,k);k.setName(d.materialNames[x])})}}else{if("instance_visual_scene"==I){var w=r.getValue("url");if(w.indexOf("#")===0){var e=w.substring(1);var d=this;this.postProcessingBinders.push(function(){d.visualScene=d.visualScenes[e]})}}}}}}}}}}}}}}}}}}this.parentElements.push(I)};DAEHandler.prototype.characters=function(a,c,b){this.buffer+=a.substring(c,c+b)};DAEHandler.prototype.endElement=function(c,f,b){this.parentElements.pop();var l=this.parentElements.length===0?null:this.parentElements[this.parentElements.length-1];if("color"==b||"float_array"==b||"matrix"==b||"rotate"==b||"scale"==b||"translate"==b){var g=this.getCharacters().split(/\s/);this.floats=new Array(g.length);var d=0;for(var h=0;h<g.length;h++){if(g[h].length>0){var j=parseFloat(g[h]);if(isNaN(j)){j=0}this.floats[d++]=j}}if(d!==g.length){this.floats.splice(d,this.floats.length-d)}if(this.floatArrayId!==null){this.floatArrays[this.floatArrayId]=this.floats;this.floatArrayId=null}}else{if("float"==b){this.floatValue=parseFloat(this.getCharacters())}}if(this.inRootAsset){this.handleRootAssetElementsEnd(b)}else{if("image"==b){this.imageId=null}else{if(this.imageId!==null){this.handleImageElementsEnd(b)}else{if("material"==b){this.materialId=null}else{if("effect"==b){this.effectId=null}else{if(this.effectId!==null){this.handleEffectElementsEnd(b,l)}else{if("geometry"==b){this.geometryId=null}}}}}}}if(this.geometryId!==null){this.handleGeometryElementsEnd(b,l)}else{if("visual_scene"==b||"node"==b||"node"==l&&"instance_geometry"==b){this.parentGroups.pop()}else{if("matrix"==b){var k=mat4.fromValues(this.floats[0],this.floats[4],this.floats[8],this.floats[12],this.floats[1],this.floats[5],this.floats[9],this.floats[13],this.floats[2],this.floats[6],this.floats[10],this.floats[14],this.floats[3],this.floats[7],this.floats[11],this.floats[15]);this.mulTransformGroup(k)}else{if("node"==l&&"rotate"==b){var m=mat4.create();mat4.fromRotation(m,this.floats[3]*Math.PI/180,vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]));this.mulTransformGroup(m)}else{if("scale"==b){var e=mat4.create();mat4.scale(e,e,vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]));this.mulTransformGroup(e)}else{if("node"==l&&"translate"==b){var a=mat4.create();mat4.translate(a,a,vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]));this.mulTransformGroup(a)}}}}}}};DAEHandler.prototype.getCharacters=function(){return this.buffer.trim()};DAEHandler.prototype.handleRootAssetElementsEnd=function(c){if("asset"==c){this.inRootAsset=false}else{if("up_axis"==c){this.axis=this.getCharacters()}else{if("subject"==c){this.scene.setName(this.getCharacters())}else{if("authoring_tool"==c){var b=this.getCharacters();if(b.indexOf("Google SketchUp")===0){var d=b.substring("Google SketchUp".length).trim();if(d.length>0){var f=d.indexOf(".");var e=f===-1?d:d.substring(0,f);var a=parseInt(e);if(a<7||(a==7&&(f>=d.length-1||d[f+1]<"1"))){this.reverseTransparency=true}}}}}}}};DAEHandler.prototype.handleImageElementsEnd=function(c){if("init_from"==c){var f=this.getCharacters();if(f.indexOf("./")===0){f=f.substring(2)}var a=this.daeEntryName.lastIndexOf("/");if(a>=0){var e=this.daeEntryName.split("/");var b=f.split("/");e.splice(e.length-1,1);while(b[0]==".."||b[0]=="."){if(b[0]==".."){e.splice(e.length-1,1)}b.splice(0,1)}f="";for(var d=0;d<e.length;d++){f+=e[d]+"/"}for(var d=0;d<b.length;d++){f+=b[d]+"/"}f=f.substring(0,f.length-1)}this.textures[this.imageId]=f}else{if("data"==c){throw new SAXException("<data> not supported")}}};DAEHandler.prototype.handleEffectElementsEnd=function(b,c){if("profile_COMMON"==c&&"newparam"==b){this.newParamSid=null}else{if("newparam"==c&&"surface"==b){this.inSurface2D=false}else{if(this.newParamSid!==null){if(this.inSurface2D&&"init_from"==b){this.surface2DIds[this.newParamSid]=this.getCharacters()}else{if("sampler2D"==c&&"source"==b){this.sampler2DIds[this.newParamSid]=this.getCharacters()}}}else{if("extra"==c&&"technique"==b){this.techniqueProfile=null}else{if("phong"==b||"blinn"==b||"lambert"==b||"constant"==b){var d;if(this.transparentColor!==null){if("RGB_ZERO"==this.opaque){d=this.transparentColor[0]*0.212671+this.transparentColor[1]*0.71516+this.transparentColor[2]*0.072169;if(this.transparency!==null){d*=this.transparency}}else{if(this.transparency!==null){d=1-this.transparentColor[3]*this.transparency}else{d=1-this.transparentColor[3]}if(this.reverseTransparency){d=1-d}}}else{d=0}var a=this.effectAppearances[this.effectId];if(d>0){a.setTransparency(d)}else{var e=vec3.fromValues(0,0,0);if(!a.getAmbientColor()){a.setAmbientColor(e)}if(!a.getDiffuseColor()){a.setDiffuseColor(e)}if(!a.getSpecularColor()){a.setSpecularColor(e)}if(!a.getShininess()){a.setShininess(1)}}this.transparentColor=null;this.transparency=null;this.inPhongBlinnOrLambert=false;this.inConstant=false}else{if(this.inConstant||this.inPhongBlinnOrLambert){if("color"==b){if("emission"==c){if(this.inPhongBlinnOrLambert){this.effectAppearances[this.effectId].setEmissiveColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]))}else{this.effectAppearances[this.effectId].setDiffuseColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]))}}else{if("ambient"==c){this.effectAppearances[this.effectId].setAmbientColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]))}else{if("diffuse"==c){this.effectAppearances[this.effectId].setDiffuseColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]))}else{if("specular"==c){this.effectAppearances[this.effectId].setSpecularColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]))}else{if("transparent"==c){this.transparentColor=this.floats}}}}}}else{if("float"==b){if("shininess"==c){this.effectAppearances[this.effectId].setShininess(this.floatValue)}else{if("transparency"==c){this.transparency=this.floatValue}}}}}else{if("double_sided"==b&&"1"==this.getCharacters()&&("GOOGLEEARTH"==this.techniqueProfile||"MAX3D"==this.techniqueProfile||"MAYA"==this.techniqueProfile)){this.effectAppearances[this.effectId].setCullFace(Appearance3D.CULL_NONE)}}}}}}}};DAEHandler.prototype.handleGeometryElementsEnd=function(a,e){if("mesh"==e&&"source"==a){if(this.floats!==null){this.sources[this.meshSourceId]=this.floats;this.floats=null}this.meshSourceId=null}else{if("mesh"==e&&"vertices"==a){this.verticesId=null}else{if("p"==a||"h"==a||"vcount"==a){var f=this.getCharacters().split(/\s/);var h=new Array(f.length);var d=0;for(var b=0;b<f.length;b++){if(f[b].length>0){h[d++]=parseInt(f[b])}}if(d!==f.length){h.splice(d,h.length-d)}if("ph"!=e&&"p"==a){this.facesAndLinesPrimitives.push(h)}else{if("vcount"==a){this.vcount=h}else{if("ph"==e){if("p"==a){this.polygonsPrimitives.push(h)}else{if("h"==a){if(this.polygonsPrimitives.length>this.polygonsHoles.length){this.polygonsHoles.push([])}this.polygonsHoles[this.polygonsPrimitives.length-1].push(h)}}}}}}else{if(("triangles"==a||"trifans"==a||"tristrips"==a||"polylist"==a||"polygons"==a||"lines"==a||"linestrips"==a)&&this.geometryVertices!==null){var g;if("lines"==a||"linestrips"==a){g=this.getLinesGeometry(a)}else{g=this.getFacesGeometry(a)}if(g!==null){this.geometries[this.geometryId].push(g);if(this.geometryAppearance!==null){var c=this.appearanceGeometries[this.geometryAppearance];if(c===undefined){c=[];this.appearanceGeometries[this.geometryAppearance]=c}c.push(g)}}this.geometryAppearance=null;this.geometryVertices=null;this.geometryNormals=null;this.geometryTextureCoordinates=null;this.facesAndLinesPrimitives=[];this.polygonsPrimitives=[];this.polygonsHoles=[];this.vcount=null}}}}};DAEHandler.prototype.getFacesGeometry=function(b){var o;if("triangles"==b){o=GeometryInfo3D.TRIANGLE_ARRAY}else{if("trifans"==b){o=GeometryInfo3D.TRIANGLE_FAN_ARRAY}else{if("tristrips"==b){o=GeometryInfo3D.TRIANGLE_STRIP_ARRAY}else{o=GeometryInfo3D.POLYGON_ARRAY}}}var d=new GeometryInfo3D(o);d.setCoordinates(this.geometryVertices);d.setCoordinateIndices(this.getIndices(this.geometryVertexOffset));if(this.geometryNormals){d.setNormals(this.geometryNormals);d.setNormalIndices(this.getIndices(this.geometryNormalOffset))}if(this.geometryTextureCoordinates){var a;for(var f=0;f<this.sourceAccessorStrides.length;f++){var p=this.sourceAccessorStrides[f];if(p.floatArray===this.geometryTextureCoordinates){a=p.stride;break}}var c;if(a>2){c=new Array(this.geometryTextureCoordinates.length/a*2);for(var f=0,e=0;e<this.geometryTextureCoordinates.length;e+=a){c[f++]=this.geometryTextureCoordinates[e];c[f++]=this.geometryTextureCoordinates[e+1]}}else{c=this.geometryTextureCoordinates}d.setTextureCoordinates(c);d.setTextureCoordinateIndices(this.getIndices(this.geometryTextureCoordinatesOffset))}if("tristrips"==b||"trifans"==b){var h=new Array(this.facesAndLinesPrimitives.length);for(var f=0;f<h.length;f++){h[f]=this.facesAndLinesPrimitives[f].length/this.inputCount}d.setStripCounts(h)}else{if("polylist"==b){d.setStripCounts(this.vcount)}else{if("polygons"==b){var m=0;for(var f=0;f<this.polygonsHoles.length;f++){m+=this.polygonsHoles[f].length}var h=new Array(this.facesAndLinesPrimitives.length+this.polygonsPrimitives.length+m);var n=new Array(this.facesAndLinesPrimitives.length+this.polygonsPrimitives.length);var l=0;var k=0;for(var f=0;f<this.facesAndLinesPrimitives.length;f++){h[l++]=this.facesAndLinesPrimitives[f].length/this.inputCount;n[k++]=1}for(var f=0;f<this.polygonsPrimitives.length;f++){h[l++]=this.polygonsPrimitives[f].length/this.inputCount;var g=this.polygonsHoles[f];for(var e=0;e<g.length;e++){h[l++]=g[e].length/this.inputCount}n[k++]=1+g.length}d.setStripCounts(h);d.setContourCounts(n)}}}if(!this.geometryNormals){d.setCreaseAngle(Math.PI/2);d.setGeneratedNormals(true)}return d.getIndexedGeometryArray()};DAEHandler.prototype.getLinesGeometry=function(a){var h=this.getIndices(this.geometryVertexOffset);if(h.length!==0){var f=this.geometryTextureCoordinates?this.getIndices(this.geometryTextureCoordinatesOffset):[];if("linestrips"==a){var j=[];var b=[];for(var d=0,e=0;d<this.facesAndLinesPrimitives.length;d++){var g=this.facesAndLinesPrimitives[d].length/this.inputCount;for(var c=0;c<g-1;c++){j.push(h[e+c]);j.push(h[e+c+1]);if(textureCoordinateIndices.length>0){b.push(textureCoordinateIndices[e+c]);b.push(textureCoordinateIndices[e+c+1])}}e+=g}h=j;f=b}return new IndexedLineArray3D(this.geometryVertices,h,this.geometryTextureCoordinates,f)}else{return null}};DAEHandler.prototype.getIndices=function(f){if(this.facesAndLinesPrimitives.length===1&&this.polygonsPrimitives.length===1&&this.inputCount===1){return facesAndLinesPrimitives[0]}else{var m=this.getIndexCount(this.facesAndLinesPrimitives);m+=this.getIndexCount(this.polygonsPrimitives);for(var e=0;e<this.polygonsHoles.length;e++){m+=this.getIndexCount(this.polygonsHoles[e])}var o=new Array(m/this.inputCount);var e=0;for(var d=0;d<this.facesAndLinesPrimitives.length;d++){var n=this.facesAndLinesPrimitives[d];for(var c=f;c<n.length;c+=this.inputCount){o[e++]=n[c]}}for(var d=0;d<this.polygonsPrimitives.length;d++){var h=this.polygonsPrimitives[d];for(var c=f;c<h.length;c+=this.inputCount){o[e++]=h[c]}var g=this.polygonsHoles[d];for(var c=0;c<g.length;c++){var a=g[c];for(var b=f;b<a.length;b+=this.inputCount){o[e++]=a[b]}}}return o}};DAEHandler.prototype.getIndexCount=function(a){var c=0;for(var b=0;b<a.length;b++){c+=a[b].length}return c};DAEHandler.prototype.mulTransformGroup=function(b){var c=this.parentGroups[this.parentGroups.length-1];var a=mat4.create();c.getTransform(a);mat4.mul(a,a,b);c.setTransform(a)};DAEHandler.prototype.endDocument=function(){for(var b=0;b<this.postProcessingBinders.length;b++){this.postProcessingBinders[b]()}if(this.visualScene!==null){var g=mat4.create();this.visualScene.getTransform(g);var e=new BoundingBox3D(vec3.fromValues(Infinity,Infinity,Infinity),vec3.fromValues(-Infinity,-Infinity,-Infinity));this.computeBounds(this.visualScene,e,mat4.create());var a=vec3.create();e.getLower(a);if(a[0]!==Infinity){var d=vec3.create();e.getUpper(d);var h=mat4.create();mat4.translate(h,h,vec3.fromValues(-a[0]-(d[0]-a[0])/2,-a[1]-(d[1]-a[1])/2,-a[2]-(d[2]-a[2])/2));mat4.mul(h,h,g);g=h}var c=mat4.create();mat4.scale(c,c,vec3.fromValues(this.meterScale*100,this.meterScale*100,this.meterScale*100));mat4.mul(c,c,g);var f=mat4.create();if("Z_UP"==this.axis){mat4.fromXRotation(f,-Math.PI/2)}else{if("X_UP"==this.axis){mat4.fromZRotation(f,Math.PI/2)}}mat4.mul(f,f,c);this.visualScene.setTransform(f);this.sceneRoot.addChild(this.visualScene)}};DAEHandler.prototype.computeBounds=function(g,f,e){if(g instanceof Group3D){if(g instanceof TransformGroup3D){e=mat4.clone(e);var b=mat4.create();g.getTransform(b);mat4.mul(e,e,b)}var d=g.getChildren();for(var c=0;c<d.length;c++){this.computeBounds(d[c],f,e)}}else{if(g instanceof Link3D){this.computeBounds(g.getSharedGroup(),f,e)}else{if(g instanceof Shape3D){var a=g.getBounds();a.transform(e);f.combine(a)}}}};function Max3DSLoader(){ModelLoader.call(this,"3ds");if(Max3DSLoader.DEFAULT_APPEARANCE===null){Max3DSLoader.DEFAULT_APPEARANCE=new Appearance3D("Default");Max3DSLoader.DEFAULT_APPEARANCE.setAmbientColor(vec3.fromValues(0.4,0.4,0.4));Max3DSLoader.DEFAULT_APPEARANCE.setDiffuseColor(vec3.fromValues(0.7102,0.702,0.6531));Max3DSLoader.DEFAULT_APPEARANCE.setSpecularColor(vec3.fromValues(0.3,0.3,0.3));Max3DSLoader.DEFAULT_APPEARANCE.setShininess(128)}}Max3DSLoader.prototype=Object.create(ModelLoader.prototype);Max3DSLoader.prototype.constructor=Max3DSLoader;Max3DSLoader.NULL_CHUNK=0;Max3DSLoader.M3DMAGIC=19789;Max3DSLoader.MLIBMAGIC=15786;Max3DSLoader.CMAGIC=49725;Max3DSLoader.M3D_VERSION=2;Max3DSLoader.COLOR_FLOAT=16;Max3DSLoader.COLOR_24=17;Max3DSLoader.LINEAR_COLOR_24=18;Max3DSLoader.LINEAR_COLOR_FLOAT=19;Max3DSLoader.PERCENTAGE_INT=48;Max3DSLoader.PERCENTAGE_FLOAT=49;Max3DSLoader.EDITOR_DATA=15677;Max3DSLoader.MESH_VERSION=15678;Max3DSLoader.MASTER_SCALE=256;Max3DSLoader.MATERIAL_ENTRY=45055;Max3DSLoader.MATERIAL_NAME=40960;Max3DSLoader.MATERIAL_AMBIENT=40976;Max3DSLoader.MATERIAL_DIFFUSE=40992;Max3DSLoader.MATERIAL_SPECULAR=41008;Max3DSLoader.MATERIAL_SHININESS=41024;Max3DSLoader.MATERIAL_TRANSPARENCY=41040;Max3DSLoader.MATERIAL_TWO_SIDED=41089;Max3DSLoader.MATERIAL_TEXMAP=41472;Max3DSLoader.MATERIAL_MAPNAME=41728;Max3DSLoader.NAMED_OBJECT=16384;Max3DSLoader.TRIANGLE_MESH_OBJECT=16640;Max3DSLoader.POINT_ARRAY=16656;Max3DSLoader.FACE_ARRAY=16672;Max3DSLoader.MESH_MATERIAL_GROUP=16688;Max3DSLoader.SMOOTHING_GROUP=16720;Max3DSLoader.MESH_BOXMAP=16784;Max3DSLoader.TEXTURE_COORDINATES=16704;Max3DSLoader.MESH_MATRIX=16736;Max3DSLoader.MESH_COLOR=16741;Max3DSLoader.KEY_FRAMER_DATA=45056;Max3DSLoader.OBJECT_NODE_TAG=45058;Max3DSLoader.NODE_ID=45104;Max3DSLoader.NODE_HIERARCHY=45072;Max3DSLoader.PIVOT=45075;Max3DSLoader.POSITION_TRACK_TAG=45088;Max3DSLoader.ROTATION_TRACK_TAG=45089;Max3DSLoader.SCALE_TRACK_TAG=45090;Max3DSLoader.TRACK_KEY_USE_TENS=1;Max3DSLoader.TRACK_KEY_USE_CONT=2;Max3DSLoader.TRACK_KEY_USE_BIAS=4;Max3DSLoader.TRACK_KEY_USE_EASE_TO=8;Max3DSLoader.TRACK_KEY_USE_EASE_FROM=16;Max3DSLoader.DEFAULT_APPEARANCE=null;Max3DSLoader.prototype.createScene=function(j,b,d,s,c,l,r){var m=new Group3D();var n=mat4.create();mat4.fromXRotation(n,-Math.PI/2);mat4.scale(n,n,vec3.fromValues(c,c,c));var g=new TransformGroup3D(n);m.addChild(g);if(s.getChildren().length>0){g.addChild(s);g=s}var q={};for(var u in d){var o=d[u];var p=new Appearance3D(u);if(o.ambientColor!==null){p.setAmbientColor(o.ambientColor)}if(o.diffuseColor!==null){p.setDiffuseColor(o.diffuseColor)}if(o.shininess!==null){p.setShininess(o.shininess*128*0.6)}if(o.specularColor!==null){if(o.shininess!==null){var a=vec3.clone(o.specularColor);vec3.scale(a,a,o.shininess);p.setSpecularColor(a)}else{p.setSpecularColor(o.specularColor)}}if(o.transparency!==null&&o.transparency>0){p.setTransparency(Math.min(1,o.transparency))}if(o.texture){p.imageEntryName=o.texture}q[u]=p}if(l===null){r(ModelLoader.BUILDING_MODEL,"",0);for(var t=0;t<j.length;t++){this.createShapes(j[t],b,q,m,g)}r(ModelLoader.BUILDING_MODEL,"",1);return m}else{var e=j.length;var h=0;var k=this;var f=function(){r(ModelLoader.BUILDING_MODEL,"",e!==0?h/e:0);var v=Date.now();while(j.length>0){k.createShapes(j[0],b,q,m,g);h++;j.splice(0,1);if(h<e&&Date.now()-v>10){setTimeout(f,0);return}}setTimeout(function(){r(ModelLoader.BUILDING_MODEL,"",1);l(m)},0)};f()}};Max3DSLoader.prototype.createShapes=function(s,R,h,w,e){var J=mat4.create();var g=s.faces;if(g!==null&&g.length>0){var a=s.vertices;var S=new Array(a.length);for(var Q=0;Q<S.length;Q++){S[Q]=null}var F=new Array(3*g.length);var p=vec3.create();var m=vec3.create();for(var Q=0,O=0;Q<g.length;Q++){var f=g[Q];var x=f.vertexIndices;for(var P=0;P<3;P++,O++){var C=x[P];vec3.subtract(p,a[x[P<2?P+1:0]],a[C]);vec3.subtract(m,a[x[P>0?P-1:2]],a[C]);var G=vec3.create();vec3.cross(G,p,m);var n=vec3.length(G);if(n>0){var I=Math.atan2(n,vec3.dot(p,m));vec3.scale(G,G,I/n)}var c=new Max3DSLoader.Mesh3DSSharedVertex(Q,G);c.nextVertex=S[C];S[C]=c;F[O]=G}}var q=new Array(3*g.length);for(var Q=0,O=0;Q<g.length;Q++){var f=g[Q];var x=f.vertexIndices;var d=new Array(3);for(var P=0;P<3;P++,O++){var C=x[P];var G=vec3.create();if(f.smoothingGroup===null){for(var c=S[C];c!==null;c=c.nextVertex){if(g[c.faceIndex].smoothingGroup===null&&(c.normal===F[O]||vec3.dot(c.normal,F[O])>0)){vec3.add(G,G,c.normal)}}}else{var E=f.smoothingGroup;for(var c=S[C];c!==null;c=c.nextVertex){var L=g[c.faceIndex];if(L.smoothingGroup!==null&&(f.smoothingGroup&L.smoothingGroup)!==0){E|=L.smoothingGroup}}for(var c=S[C];c!==null;c=c.nextVertex){var L=g[c.faceIndex];if(L.smoothingGroup!==null&&(E&L.smoothingGroup)!==0){vec3.add(G,G,c.normal)}}}if(vec3.squaredLength(G)!==0){vec3.normalize(G,G)}else{vec3.copy(G,F[O]);if(vec3.squaredLength(G)!==0){vec3.normalize(G,G)}}q[O]=G;d[P]=O}f.normalIndices=d}g.sort(function(k,V){var l=k.material;var j=V.material;if(l===null){if(j===null){return k.index-V.index}else{return -1}}else{if(j===null){return 1}else{return 0}}});var K;var B=R[s.name];if(B===undefined){K=e}else{if(B.length===1){K=B[0]}else{var b=new SharedGroup3D();for(var Q=0;Q<B.length;Q++){B[Q].addChild(new Link3D(b))}K=b}}var z=s.transform;if(z!==null){if(!mat4.exactEquals(z,J)){var y=new TransformGroup3D(z);K.addChild(y);K=y}}var r=s.textureCoordinates;var Q=0;var o=null;var N=null;while(Q<g.length){var D=g[Q];var v=D.material;var u=Q;while(++u<g.length){if(v!==g[u].material){break}}var U=u-Q;var T=new Array(U*3);var d=new Array(U*3);for(var P=0,O=0;P<U;P++){var f=g[Q+P];var x=f.vertexIndices;var A=f.normalIndices;for(var M=0;M<3;M++,O++){T[O]=x[M];d[O]=A[M]}}var H=new GeometryInfo3D(GeometryInfo3D.TRIANGLE_ARRAY);H.setCoordinates(a);H.setCoordinateIndices(T);H.setNormals(q);H.setNormalIndices(d);if(r!==null){H.setTextureCoordinates(r);H.setTextureCoordinateIndices(T)}geometryArray=H.getIndexedGeometryArray();if(o===null||N!==v){N=v;var t=Max3DSLoader.DEFAULT_APPEARANCE;if(v!==null&&h[v.name]!==undefined){t=h[v.name]}t=t.clone();if(v!==null&&v.twoSided){t.setCullFace(Appearance3D.CULL_NONE)}o=new Shape3D(geometryArray,t);K.addChild(o);o.setName(s.name+(Q===0?"":"_"+Q))}else{o.addGeometry(geometryArray)}Q=u}}};Max3DSLoader.prototype.getModelContent=function(a){return a.asUint8Array()};Max3DSLoader.prototype.parseEntryScene=function(f,a,c,g,l,h){var d=[];var n={};var m={};var b;var j=new TransformGroup3D();if(l===null){h(ModelLoader.PARSING_MODEL,a,0);b=this.parse3DSStream(new Max3DSLoader.ChunksInputStream(f),a,c,d,n,m,j);h(ModelLoader.PARSING_MODEL,a,1);return this.createScene(d,n,m,j,b,null,h)}else{var k=this;b=this.parse3DSStream(new Max3DSLoader.ChunksInputStream(f),a,c,d,n,m,j);var e=function(){setTimeout(function(){h(ModelLoader.PARSING_MODEL,a,1);k.createScene(d,n,m,j,b,function(o){l(o)},h)},0)};e()}};Max3DSLoader.prototype.parse3DSStream=function(g,a,b,c,h,j,f){try{masterScale=1;var d=false;switch(g.readChunkHeader().id){case Max3DSLoader.M3DMAGIC:case Max3DSLoader.MLIBMAGIC:case Max3DSLoader.CMAGIC:d=true;while(!g.isChunckEndReached()){switch(g.readChunkHeader().id){case Max3DSLoader.M3D_VERSION:g.readLittleEndianUnsignedInt();break;case Max3DSLoader.EDITOR_DATA:this.parseEditorData(g,a,b,c,j);break;case Max3DSLoader.KEY_FRAMER_DATA:this.parseKeyFramerData(g,h,f);break;default:g.readUntilChunkEnd();break}g.releaseChunk()}break;case Max3DSLoader.EDITOR_DATA:masterScale=this.parseEditorData(g,a,b,c,j);break;default:if(d){g.readUntilChunkEnd()}else{throw new IncorrectFormat3DException("Bad magic number")}}g.releaseChunk()}catch(e){c.length=0}return masterScale};Max3DSLoader.prototype.parseEditorData=function(e,b,g,a,c){var d=1;while(!e.isChunckEndReached()){switch(e.readChunkHeader().id){case Max3DSLoader.MESH_VERSION:e.readLittleEndianInt();break;case Max3DSLoader.MASTER_SCALE:d=e.readLittleEndianFloat();break;case Max3DSLoader.NAMED_OBJECT:this.parseNamedObject(e,a,c);break;case Max3DSLoader.MATERIAL_ENTRY:var f=this.parseMaterial(e,b,g);c[f.name]=f;break;default:e.readUntilChunkEnd();break}e.releaseChunk()}return d};Max3DSLoader.prototype.parseNamedObject=function(c,a,b){var d=c.readString();while(!c.isChunckEndReached()){switch(c.readChunkHeader().id){case Max3DSLoader.TRIANGLE_MESH_OBJECT:a.push(this.parseMeshData(c,d,b));break;default:c.readUntilChunkEnd();break}c.releaseChunk()}};Max3DSLoader.prototype.parseMeshData=function(l,a,o){var k=null;var e=null;var c=null;var f=null;var d=null;while(!l.isChunckEndReached()){switch(l.readChunkHeader().id){case Max3DSLoader.MESH_MATRIX:c=this.parseMatrix(l);c=mat4.invert(c,c);break;case Max3DSLoader.MESH_COLOR:f=l.readUnsignedByte();break;case Max3DSLoader.POINT_ARRAY:k=new Array(l.readLittleEndianUnsignedShort());for(var g=0;g<k.length;g++){k[g]=vec3.fromValues(l.readLittleEndianFloat(),l.readLittleEndianFloat(),l.readLittleEndianFloat())}break;case Max3DSLoader.FACE_ARRAY:d=this.parseFacesData(l);while(!l.isChunckEndReached()){switch(l.readChunkHeader().id){case Max3DSLoader.MESH_MATERIAL_GROUP:var m=l.readString();var j=null;if(o!==null){j=o[m]}for(var g=0,b=l.readLittleEndianUnsignedShort();g<b;g++){var h=l.readLittleEndianUnsignedShort();if(h<d.length){d[h].material=j}}break;case Max3DSLoader.SMOOTHING_GROUP:for(var g=0;g<d.length;g++){d[g].smoothingGroup=l.readLittleEndianUnsignedInt()}break;case Max3DSLoader.MESH_BOXMAP:default:l.readUntilChunkEnd();break}l.releaseChunk()}break;case Max3DSLoader.TEXTURE_COORDINATES:e=new Array(l.readLittleEndianUnsignedShort());for(var g=0;g<e.length;g++){e[g]=vec2.fromValues(l.readLittleEndianFloat(),l.readLittleEndianFloat())}break;default:l.readUntilChunkEnd();break}l.releaseChunk()}return new Max3DSLoader.Mesh3DS(a,k,e,d,f,c)};Max3DSLoader.prototype.parseKeyFramerData=function(m,b,p){var k=[];var j=null;while(!m.isChunckEndReached()){switch(m.readChunkHeader().id){case Max3DSLoader.OBJECT_NODE_TAG:var r=true;var h=null;var u=null;var f=0;var t=null;var v=null;while(!m.isChunckEndReached()){switch(m.readChunkHeader().id){case Max3DSLoader.NODE_HIERARCHY:var s=m.readString();r="$$$DUMMY"!=s;m.readLittleEndianUnsignedShort();m.readLittleEndianUnsignedShort();var q=m.readLittleEndianShort();var l=new TransformGroup3D();if(q===-1){p.addChild(l)}else{if(q>k.length-1){throw new IncorrectFormat3DException("Inconsistent nodes hierarchy")}k[q].addChild(l)}k.push(l);if(r){var d=b[s];if(d===undefined){d=[];b[s]=d}d.push(l)}j=l;break;case Max3DSLoader.PIVOT:h=this.parseVector(m);break;case Max3DSLoader.POSITION_TRACK_TAG:this.parseKeyFramerTrackStart(m);u=this.parseVector(m);m.readUntilChunkEnd();break;case Max3DSLoader.ROTATION_TRACK_TAG:this.parseKeyFramerTrackStart(m);f=m.readLittleEndianFloat();t=this.parseVector(m);m.readUntilChunkEnd();break;case Max3DSLoader.SCALE_TRACK_TAG:this.parseKeyFramerTrackStart(m);v=this.parseVector(m);m.readUntilChunkEnd();break;default:m.readUntilChunkEnd();break}m.releaseChunk()}var n=mat4.create();if(u!==null){mat4.translate(n,n,u)}if(t!==null&&f!==0){var e=vec3.length(t);if(e>0){var o=-f/2;var a=Math.sin(o)/e;var c=Math.cos(o);var g=mat4.create();mat4.fromQuat(g,quat.fromValues(t[0]*a,t[1]*a,t[2]*a,c));mat4.mul(n,n,g)}}if(v!==null){mat4.scale(n,n,v)}if(h!==null&&r){vec3.negate(h,h);mat4.translate(n,n,h)}j.setTransform(n);break;default:m.readUntilChunkEnd();break}m.releaseChunk()}};Max3DSLoader.prototype.parseKeyFramerTrackStart=function(b){b.readLittleEndianUnsignedShort();b.readLittleEndianUnsignedInt();b.readLittleEndianUnsignedInt();b.readLittleEndianInt();b.readLittleEndianInt();var a=b.readLittleEndianUnsignedShort();if((a&Max3DSLoader.TRACK_KEY_USE_TENS)!==0){b.readLittleEndianFloat()}if((a&Max3DSLoader.TRACK_KEY_USE_CONT)!==0){b.readLittleEndianFloat()}if((a&Max3DSLoader.TRACK_KEY_USE_BIAS)!==0){b.readLittleEndianFloat()}if((a&Max3DSLoader.TRACK_KEY_USE_EASE_TO)!==0){b.readLittleEndianFloat()}if((a&Max3DSLoader.TRACK_KEY_USE_EASE_FROM)!==0){b.readLittleEndianFloat()}};Max3DSLoader.prototype.parseFacesData=function(b){var a=new Array(b.readLittleEndianUnsignedShort());for(var c=0;c<a.length;c++){a[c]=new Max3DSLoader.Face3DS(c,b.readLittleEndianUnsignedShort(),b.readLittleEndianUnsignedShort(),b.readLittleEndianUnsignedShort(),b.readLittleEndianUnsignedShort())}return a};Max3DSLoader.prototype.parseMaterial=function(k,a,c){var b=null;var g=null;var h=null;var e=null;var l=null;var d=null;var f=false;var j=null;while(!k.isChunckEndReached()){switch(k.readChunkHeader().id){case Max3DSLoader.MATERIAL_NAME:b=k.readString();break;case Max3DSLoader.MATERIAL_AMBIENT:g=this.parseColor(k);break;case Max3DSLoader.MATERIAL_DIFFUSE:h=this.parseColor(k);break;case Max3DSLoader.MATERIAL_SPECULAR:e=this.parseColor(k);break;case Max3DSLoader.MATERIAL_SHININESS:l=this.parsePercentage(k);break;case Max3DSLoader.MATERIAL_TRANSPARENCY:d=this.parsePercentage(k);break;case Max3DSLoader.MATERIAL_TWO_SIDED:f=true;break;case Max3DSLoader.MATERIAL_TEXMAP:j=this.parseTextureMap(k,a,c);break;default:k.readUntilChunkEnd();break}k.releaseChunk()}return new Max3DSLoader.Material3DS(b,g,h,e,l,d,j,f)};Max3DSLoader.prototype.parseColor=function(c){var d=false;var b=null;var a;while(!c.isChunckEndReached()){switch(c.readChunkHeader().id){case Max3DSLoader.LINEAR_COLOR_24:d=true;b=vec3.fromValues(c.readUnsignedByte()/255,c.readUnsignedByte()/255,c.readUnsignedByte()/255);break;case Max3DSLoader.COLOR_24:a=vec3.fromValues(c.readUnsignedByte()/255,c.readUnsignedByte()/255,c.readUnsignedByte()/255);if(!d){b=a}break;case Max3DSLoader.LINEAR_COLOR_FLOAT:d=true;b=vec3.fromValues(c.readLittleEndianFloat(),c.readLittleEndianFloat(),c.readLittleEndianFloat());break;case Max3DSLoader.COLOR_FLOAT:a=vec3.fromValues(c.readLittleEndianFloat(),c.readLittleEndianFloat(),c.readLittleEndianFloat());if(!d){b=a}break;default:c.readUntilChunkEnd();break}c.releaseChunk()}if(b!==null){return b}else{throw new IncorrectFormat3DException("Expected color value")}};Max3DSLoader.prototype.parsePercentage=function(b){var a=null;while(!b.isChunckEndReached()){switch(b.readChunkHeader().id){case Max3DSLoader.PERCENTAGE_INT:a=b.readLittleEndianShort()/100;break;case Max3DSLoader.PERCENTAGE_FLOAT:a=b.readLittleEndianFloat();break;default:b.readUntilChunkEnd();break}b.releaseChunk()}if(a!==null){return a}else{throw new IncorrectFormat3DException("Expected percentage value")}};Max3DSLoader.prototype.parseTextureMap=function(c,b,f){var e=null;while(!c.isChunckEndReached()){switch(c.readChunkHeader().id){case Max3DSLoader.MATERIAL_MAPNAME:e=c.readString();break;case Max3DSLoader.PERCENTAGE_INT:default:c.readUntilChunkEnd();break}c.releaseChunk()}if(e!==null){var a=b.lastIndexOf("/");if(a>=0){e=b.substring(0,a+1)+e}var d=f.file(e);if(d!==null){return e}else{return this.getEntryNameIgnoreCase(f,e)}}return null};Max3DSLoader.prototype.getEntryNameIgnoreCase=function(c,d){d=d.toUpperCase();var a=c.file(/.*/);for(var b=0;b<a.length;b++){if(a[b].name.toUpperCase()==d){return a[b].name}}return null};Max3DSLoader.prototype.parseMatrix=function(a){return mat4.fromValues(a.readLittleEndianFloat(),a.readLittleEndianFloat(),a.readLittleEndianFloat(),0,a.readLittleEndianFloat(),a.readLittleEndianFloat(),a.readLittleEndianFloat(),0,a.readLittleEndianFloat(),a.readLittleEndianFloat(),a.readLittleEndianFloat(),0,a.readLittleEndianFloat(),a.readLittleEndianFloat(),a.readLittleEndianFloat(),1)};Max3DSLoader.prototype.parseVector=function(a){return vec3.fromValues(a.readLittleEndianFloat(),a.readLittleEndianFloat(),a.readLittleEndianFloat())};Max3DSLoader.Chunk3DS=function(b,a){if(a<6){throw new IncorrectFormat3DException("Invalid chunk "+b+" length "+a)}this.id=b;this.length=a;this.readLength=6};Max3DSLoader.Chunk3DS.prototype.incrementReadLength=function(a){this.readLength+=a};Max3DSLoader.Chunk3DS.prototype.toString=function(){return this.id+" "+this.length};Max3DSLoader.ChunksInputStream=function(a){this.input=a;this.index=0;this.stack=[]};Max3DSLoader.ChunksInputStream.prototype.read=function(){if(this.index>=this.input.length){return -1}else{return this.input[this.index++]}};Max3DSLoader.ChunksInputStream.prototype.readChunkHeader=function(){var a=this.readLittleEndianUnsignedShort(false);var b=new Max3DSLoader.Chunk3DS(a,this.readLittleEndianUnsignedInt(false));this.stack.push(b);return b};Max3DSLoader.ChunksInputStream.prototype.releaseChunk=function(){var a=this.stack.pop();if(a.length!==a.readLength){throw new IncorrectFormat3DException("Chunk "+a.id+" invalid length. Expected to read "+a.length+" bytes, but actually read "+a.readLength+" bytes")}if(this.stack.length!==0){this.stack[this.stack.length-1].incrementReadLength(a.length)}};Max3DSLoader.ChunksInputStream.prototype.isChunckEndReached=function(){var a=this.stack[this.stack.length-1];return a.length===a.readLength};Max3DSLoader.ChunksInputStream.prototype.readUntilChunkEnd=function(){var a=this.stack[this.stack.length-1];var c=a.length-a.readLength;for(var b=c;b>0;b--){if(this.read()<0){throw new IncorrectFormat3DException("Chunk "+a.id+" too short")}}a.incrementReadLength(c)};Max3DSLoader.ChunksInputStream.prototype.readUnsignedByte=function(){var a=this.read();if(a===-1){throw new IncorrectFormat3DException("Unexpected EOF")}else{this.stack[this.stack.length-1].incrementReadLength(1);return a}};Max3DSLoader.ChunksInputStream.prototype.readLittleEndianUnsignedShort=function(c){if(c===undefined){c=true}var b=this.read();if(b===-1){throw new IncorrectFormat3DException("Unexpected EOF")}var a=this.read();if(a===-1){throw new IncorrectFormat3DException("Can't read short")}if(c){this.stack[this.stack.length-1].incrementReadLength(2)}return(a<<8)|b};Max3DSLoader.ChunksInputStream.prototype.readLittleEndianShort=function(b){var a=this.readLittleEndianUnsignedShort(b);if(a&32768){a=(-1&~32767)|a}return a};Max3DSLoader.ChunksInputStream.converter=new Int8Array(4);Max3DSLoader.ChunksInputStream.int32Converter=new Int32Array(Max3DSLoader.ChunksInputStream.converter.buffer,0,1);Max3DSLoader.ChunksInputStream.float32Converter=new Float32Array(Max3DSLoader.ChunksInputStream.converter.buffer,0,1);Max3DSLoader.ChunksInputStream.prototype.readLittleEndianFloat=function(){Max3DSLoader.ChunksInputStream.int32Converter[0]=this.readLittleEndianUnsignedInt(true);return Max3DSLoader.ChunksInputStream.float32Converter[0]};Max3DSLoader.ChunksInputStream.prototype.readLittleEndianUnsignedInt=function(e){if(e===undefined){e=true}var d=this.read();if(d===-1){throw new IncorrectFormat3DException("Unexpected EOF")}var c=this.read();var b=this.read();var a=this.read();if(c===-1||b===-1||a===-1){throw new IncorrectFormat3DException("Can't read int")}if(e){this.stack[this.stack.length-1].incrementReadLength(4)}return(a<<24)|(b<<16)|(c<<8)|d};Max3DSLoader.ChunksInputStream.prototype.readLittleEndianInt=function(b){var a=this.readLittleEndianUnsignedInt(b);if(a&2147483648){a=(-1&~2147483647)|a}return a};Max3DSLoader.ChunksInputStream.prototype.readString=function(){var c="";var a;while((a=this.read())!==-1&&a!==0){c+=String.fromCharCode(a)}if(a===-1){throw new IncorrectFormat3DException("Unexpected end of file")}this.stack[this.stack.length-1].incrementReadLength(c.length+1);return c};Max3DSLoader.Mesh3DS=function(f,e,b,a,c,d){this.name=f;this.vertices=e;this.textureCoordinates=b;this.faces=a;this.color=c;this.transform=d};Max3DSLoader.Face3DS=function(e,d,b,c,a){this.index=e;this.vertexIndices=[d,b,c];this.normalIndices=null;this.material=null;this.smoothingGroup=null};Max3DSLoader.Material3DS=function(d,c,g,h,e,b,f,a){this.name=d;this.ambientColor=c;this.diffuseColor=g;this.specularColor=h;this.shininess=e;this.transparency=b;this.texture=f;this.twoSided=a};Max3DSLoader.Mesh3DSSharedVertex=function(a,b){this.faceIndex=a;this.normal=b;this.nextVertex=null};function ModelManager(){this.loadedModelNodes={};this.loadingModelObservers={}}ModelManager.WINDOW_PANE_SHAPE_PREFIX="sweethome3d_window_pane";ModelManager.MIRROR_SHAPE_PREFIX="sweethome3d_window_mirror";ModelManager.LIGHT_SHAPE_PREFIX="sweethome3d_light";ModelManager.MANNEQUIN_ABDOMEN_PREFIX="sweethome3d_mannequin_abdomen";ModelManager.MANNEQUIN_CHEST_PREFIX="sweethome3d_mannequin_chest";ModelManager.MANNEQUIN_PELVIS_PREFIX="sweethome3d_mannequin_pelvis";ModelManager.MANNEQUIN_NECK_PREFIX="sweethome3d_mannequin_neck";ModelManager.MANNEQUIN_HEAD_PREFIX="sweethome3d_mannequin_head";ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX="sweethome3d_mannequin_left_shoulder";ModelManager.MANNEQUIN_LEFT_ARM_PREFIX="sweethome3d_mannequin_left_arm";ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX="sweethome3d_mannequin_left_elbow";ModelManager.MANNEQUIN_LEFT_FOREARM_PREFIX="sweethome3d_mannequin_left_forearm";ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX="sweethome3d_mannequin_left_wrist";ModelManager.MANNEQUIN_LEFT_HAND_PREFIX="sweethome3d_mannequin_left_hand";ModelManager.MANNEQUIN_LEFT_HIP_PREFIX="sweethome3d_mannequin_left_hip";ModelManager.MANNEQUIN_LEFT_THIGH_PREFIX="sweethome3d_mannequin_left_thigh";ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX="sweethome3d_mannequin_left_knee";ModelManager.MANNEQUIN_LEFT_LEG_PREFIX="sweethome3d_mannequin_left_leg";ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX="sweethome3d_mannequin_left_ankle";ModelManager.MANNEQUIN_LEFT_FOOT_PREFIX="sweethome3d_mannequin_left_foot";ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX="sweethome3d_mannequin_right_shoulder";ModelManager.MANNEQUIN_RIGHT_ARM_PREFIX="sweethome3d_mannequin_right_arm";ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX="sweethome3d_mannequin_right_elbow";ModelManager.MANNEQUIN_RIGHT_FOREARM_PREFIX="sweethome3d_mannequin_right_forearm";ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX="sweethome3d_mannequin_right_wrist";ModelManager.MANNEQUIN_RIGHT_HAND_PREFIX="sweethome3d_mannequin_right_hand";ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX="sweethome3d_mannequin_right_hip";ModelManager.MANNEQUIN_RIGHT_THIGH_PREFIX="sweethome3d_mannequin_right_thigh";ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX="sweethome3d_mannequin_right_knee";ModelManager.MANNEQUIN_RIGHT_LEG_PREFIX="sweethome3d_mannequin_right_leg";ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX="sweethome3d_mannequin_right_ankle";ModelManager.MANNEQUIN_RIGHT_FOOT_PREFIX="sweethome3d_mannequin_right_foot";ModelManager.MANNEQUIN_ABDOMEN_CHEST_PREFIX="sweethome3d_mannequin_abdomen_chest";ModelManager.MANNEQUIN_ABDOMEN_PELVIS_PREFIX="sweethome3d_mannequin_abdomen_pelvis";ModelManager.BALL_PREFIX="sweethome3d_ball_";ModelManager.ARM_ON_BALL_PREFIX="sweethome3d_arm_on_ball_";ModelManager.HINGE_PREFIX="sweethome3d_hinge_";ModelManager.OPENING_ON_HINGE_PREFIX="sweethome3d_opening_on_hinge_";ModelManager.WINDOW_PANE_ON_HINGE_PREFIX=ModelManager.WINDOW_PANE_SHAPE_PREFIX+"_on_hinge_";ModelManager.MIRROR_ON_HINGE_PREFIX=ModelManager.MIRROR_SHAPE_PREFIX+"_on_hinge_";ModelManager.UNIQUE_RAIL_PREFIX="sweethome3d_unique_rail";ModelManager.RAIL_PREFIX="sweethome3d_rail_";ModelManager.OPENING_ON_RAIL_PREFIX="sweethome3d_opening_on_rail_";ModelManager.WINDOW_PANE_ON_RAIL_PREFIX=ModelManager.WINDOW_PANE_SHAPE_PREFIX+"_on_rail_";ModelManager.MIRROR_ON_RAIL_PREFIX=ModelManager.MIRROR_SHAPE_PREFIX+"_on_rail_";ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX="_transformation";ModelManager.instance=null;ModelManager.getInstance=function(){if(ModelManager.instance==null){ModelManager.instance=new ModelManager()}return ModelManager.instance};ModelManager.prototype.clear=function(){this.loadedModelNodes={};this.loadingModelObservers={};if(this.modelLoaders){for(var a=0;a<this.modelLoaders.length;a++){this.modelLoaders[a].clear()}}};ModelManager.prototype.getMinimumSize=function(){return 0.001};ModelManager.prototype.getSize=function(e,d){if(d===undefined){d=mat4.create()}var c=this.getBounds(e,d);var a=vec3.create();c.getLower(a);var b=vec3.create();c.getUpper(b);return vec3.fromValues(Math.max(this.getMinimumSize(),b[0]-a[0]),Math.max(this.getMinimumSize(),b[1]-a[1]),Math.max(this.getMinimumSize(),b[2]-a[2]))};ModelManager.prototype.getCenter=function(d){var c=this.getBounds(d);var a=vec3.create();c.getLower(a);var b=vec3.create();c.getUpper(b);return vec3.fromValues((a[0]+b[0])/2,(a[1]+b[1])/2,(a[2]+b[2])/2)};ModelManager.prototype.getBounds=function(b,a){if(a===undefined){a=mat4.create()}var c=new BoundingBox3D(vec3.fromValues(Infinity,Infinity,Infinity),vec3.fromValues(-Infinity,-Infinity,-Infinity));this.computeBounds(b,c,a,!this.isOrthogonalRotation(a),this.isDeformed(b));return c};ModelManager.prototype.isOrthogonalRotation=function(c){for(var b=0;b<3;b++){for(var a=0;a<3;a++){if(Math.abs(c[b*4+a])>0.000001&&Math.abs(c[b*4+a]-1)>0.000001&&Math.abs(c[b*4+a]+1)>0.000001){return false}}}return true};ModelManager.prototype.computeBounds=function(f,e,g,c,b){if(f instanceof Group3D){if(f instanceof TransformGroup3D){g=mat4.clone(g);mat4.mul(g,g,f.transform)}for(var d=0;d<f.children.length;d++){this.computeBounds(f.children[d],e,g,c,b)}}else{if(f instanceof Link3D){this.computeBounds(f.getSharedGroup(),e,g,c,b)}else{if(f instanceof Shape3D){var a;if(c||b&&!this.isOrthogonalRotation(g)){a=this.computeTransformedGeometryBounds(f,g)}else{a=f.getBounds();a.transform(g)}e.combine(a)}}}};ModelManager.prototype.computeTransformedGeometryBounds=function(a,f){var c=vec3.fromValues(Infinity,Infinity,Infinity);var e=vec3.fromValues(-Infinity,-Infinity,-Infinity);for(var d=0;d<a.geometries.length;d++){var h=a.geometries[d];var g=vec3.create();for(var b=0;b<h.vertexIndices.length;b++){vec3.copy(g,h.vertices[h.vertexIndices[b]]);this.updateBounds(g,f,c,e)}}return new BoundingBox3D(c,e)};ModelManager.prototype.updateBounds=function(d,c,a,b){if(c!==null){vec3.transformMat4(d,d,c)}vec3.min(a,a,d);vec3.max(b,b,d)};ModelManager.prototype.getNormalizedTransformGroup=function(c,d,b,a){return new TransformGroup3D(this.getNormalizedTransform(c,d,b,a!==false))};ModelManager.prototype.getNormalizedTransform=function(d,c,b,g){var k=this.getBounds(d);var f=vec3.create();k.getLower(f);var m=vec3.create();k.getUpper(m);var a=mat4.create();mat4.translate(a,a,vec3.fromValues(-f[0]-(m[0]-f[0])/2,-f[1]-(m[1]-f[1])/2,-f[2]-(m[2]-f[2])/2));var j;if(c!==undefined&&c!==null){var e=this.getRotationTransformation(c);mat4.mul(e,e,a);var h=this.getBounds(d,e);h.getLower(f);h.getUpper(m);j=mat4.create();if(g){mat4.translate(j,j,vec3.fromValues(-f[0]-(m[0]-f[0])/2,-f[1]-(m[1]-f[1])/2,-f[2]-(m[2]-f[2])/2))}mat4.mul(j,j,e)}else{j=a}var l=mat4.create();mat4.scale(l,l,vec3.fromValues(b/Math.max(this.getMinimumSize(),m[0]-f[0]),b/Math.max(this.getMinimumSize(),m[1]-f[1]),b/Math.max(this.getMinimumSize(),m[2]-f[2])));mat4.mul(l,l,j);return l};ModelManager.prototype.getRotationTransformation=function(b){var a=mat4.create();a[0]=b[0][0];a[4]=b[0][1];a[8]=b[0][2];a[1]=b[1][0];a[5]=b[1][1];a[9]=b[1][2];a[2]=b[2][0];a[6]=b[2][1];a[10]=b[2][2];return a};ModelManager.prototype.getPieceOfFurnitureNormalizedModelTransformation=function(o,b){var d=mat4.create();var l=o.getWidth();if(o.isModelMirrored()){l*=-1}mat4.scale(d,d,vec3.fromValues(l,o.getHeight(),o.getDepth()));var h;var n;if(o.isHorizontallyRotated()&&b!==undefined&&b!==null){var j=mat4.create();if(o.getPitch()!=0){mat4.fromXRotation(j,-o.getPitch())}if(o.getRoll()!=0){var m=mat4.create();mat4.fromZRotation(m,-o.getRoll());mat4.mul(j,m,j)}mat4.mul(j,j,d);var g=this.getBounds(b,j);var e=vec3.create();g.getLower(e);var k=vec3.create();g.getUpper(k);h=mat4.create();mat4.translate(h,h,vec3.fromValues(-e[0]-(k[0]-e[0])/2,-e[1]-(k[1]-e[1])/2,-e[2]-(k[2]-e[2])/2));mat4.mul(h,h,j);n=Math.max(this.getMinimumSize(),k[1]-e[1])}else{h=d;n=o.getHeight()}var a=mat4.create();mat4.fromYRotation(a,-o.getAngle());mat4.mul(a,a,h);var f=mat4.create();var c;if(o.getLevel()!==null){c=o.getLevel().getElevation()}else{c=0}mat4.translate(f,f,vec3.fromValues(o.getX(),o.getElevation()+n/2+c,o.getY()));mat4.mul(f,f,a);return f};ModelManager.prototype.getPieceOFFurnitureNormalizedModelTransformation=ModelManager.prototype.getPieceOfFurnitureNormalizedModelTransformation;ModelManager.prototype.loadModel=function(e,b,d){if(d===undefined){d=b;b=false}var g=e.getURL();if(g in this.loadedModelNodes){var c=this.loadedModelNodes[g];if(d.modelUpdated!==undefined){d.modelUpdated(this.cloneNode(c))}}else{if(b){var a=this;this.load(e,b,{modelLoaded:function(h){a.loadedModelNodes[g]=h;if(d.modelUpdated!==undefined){d.modelUpdated(a.cloneNode(h))}},modelError:function(h){if(d.modelError!==undefined){d.modelError(h)}},progression:function(j,k,h){if(d.progression!==undefined){d.progression(j,k,h)}}})}else{if(g in this.loadingModelObservers){this.loadingModelObservers[g].push(d)}else{var f=[];f.push(d);this.loadingModelObservers[g]=f;var a=this;this.load(e,b,{modelLoaded:function(j){a.loadedModelNodes[g]=j;var k=a.loadingModelObservers[g];if(k){for(var h=0;h<k.length;h++){if(k[h].modelUpdated!==undefined){k[h].modelUpdated(a.cloneNode(j))}}}},modelError:function(j){var k=a.loadingModelObservers[g];if(k){delete a.loadingModelObservers[g];for(var h=0;h<k.length;h++){if(k[h].modelError!==undefined){k[h].modelError(j)}}}},progression:function(j,l,h){var m=a.loadingModelObservers[g];if(m){for(var k=0;k<m.length;k++){if(m[k].progression!==undefined){m[k].progression(j,l,h)}}}}})}}}};ModelManager.prototype.unloadModel=function(b,a){var c=b.getURL();var d=this.loadedModelNodes[c];delete this.loadedModelNodes[c];delete this.loadingModelObservers[c];if(a){this.disposeGeometries(d)}};ModelManager.prototype.disposeGeometries=function(c){if(c instanceof Group3D){for(var a=0;a<c.children.length;a++){this.disposeGeometries(c.children[a])}}else{if(c instanceof Link3D){this.disposeGeometries(c.getSharedGroup())}else{if(c instanceof Shape3D){var b=c.getGeometries();for(var a=0;a<b.length;a++){b[a].disposeCoordinates()}}}}};ModelManager.prototype.cloneNode=function(d,k){if(k===undefined){return this.cloneNode(d,[])}else{var j=d.clone();if(d instanceof Shape3D){var h;if(d.getAppearance()){j.setAppearance(d.getAppearance().clone())}}else{if(d instanceof Link3D){var f=d.clone();var e=f.getSharedGroup();if(e!==null){var a=null;for(var g=0;g<k.length;g++){if(k[g].sharedGroup===e){a=k[g].clonedSharedGroup;break}}if(a===null){a=this.cloneNode(e,k);k.push({sharedGroup:e,clonedSharedGroup:a})}f.setSharedGroup(a)}return f}else{j=d.clone();if(d instanceof Group3D){var b=d.getChildren();for(var g=0;g<b.length;g++){var c=this.cloneNode(b[g],k);j.addChild(c)}}}}return j}};ModelManager.prototype.load=function(d,b,c){var e=d.getURL();if(!this.modelLoaders){this.modelLoaders=[new OBJLoader()];if(typeof DAELoader!=="undefined"){this.modelLoaders.push(new DAELoader())}if(typeof Max3DSLoader!=="undefined"){this.modelLoaders.push(new Max3DSLoader())}}var a=this;var f={modelLoaderIndex:0,modelLoaded:function(h){var j=a.getBounds(h);var g=vec3.create();j.getLower(g);if(g[0]!==Infinity){a.updateWindowPanesTransparency(h);a.updateDeformableModelHierarchy(h);a.replaceMultipleSharedShapes(h);c.modelLoaded(h)}else{if(++this.modelLoaderIndex<a.modelLoaders.length){a.modelLoaders[this.modelLoaderIndex].load(e,b,this)}else{this.modelError("Unsupported 3D format")}}},modelError:function(g){c.modelError(g)},progression:function(h,j,g){c.progression(h,j,g)}};a.modelLoaders[0].load(e,b,f)};ModelManager.prototype.updateWindowPanesTransparency=function(d){if(d instanceof Group3D){for(var c=0;c<d.children.length;c++){this.updateWindowPanesTransparency(d.children[c])}}else{if(d instanceof Link3D){this.updateWindowPanesTransparency(d.getSharedGroup())}else{if(d instanceof Shape3D){var b=d.getName();if(b&&b.indexOf(ModelManager.WINDOW_PANE_SHAPE_PREFIX)===0){var a=d.getAppearance();if(a===null){a=new Appearance3D();d.setAppearance(a)}if(a.getTransparency()===undefined){a.setTransparency(0.5)}}}}}};ModelManager.prototype.updateDeformableModelHierarchy=function(z){if(this.containsNode(z,ModelManager.MANNEQUIN_ABDOMEN_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_CHEST_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_PELVIS_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_NECK_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_HEAD_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_ARM_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_FOREARM_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_HAND_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_HIP_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_THIGH_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_LEG_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_FOOT_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_ARM_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_FOREARM_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_HAND_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_THIGH_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_LEG_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_FOOT_PREFIX)){var v=this.extractNodes(z,ModelManager.MANNEQUIN_HEAD_PREFIX,null);var m=this.createPickableTransformGroup(ModelManager.MANNEQUIN_NECK_PREFIX,[v]);var S=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_HAND_PREFIX,null);var d=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX,[S]);var P=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_FOREARM_PREFIX,null);var h=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX,null);var D=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX,[P,h,d]);var p=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_ARM_PREFIX,null);var K=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX,null);var L=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX,[p,K,D]);var y=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_HAND_PREFIX,null);var e=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX,[y]);var l=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_FOREARM_PREFIX,null);var M=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX,null);var j=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX,[l,M,e]);var I=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_ARM_PREFIX,null);var o=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX,null);var q=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX,[I,o,j]);var k=this.extractNodes(z,ModelManager.MANNEQUIN_CHEST_PREFIX,null);var E=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX,null);var g=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX,null);var b=this.extractNodes(z,ModelManager.MANNEQUIN_NECK_PREFIX,null);var f=this.createPickableTransformGroup(ModelManager.MANNEQUIN_ABDOMEN_CHEST_PREFIX,[k,E,L,g,q,b,m]);var c=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_FOOT_PREFIX,null);var G=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX,[c]);var t=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_LEG_PREFIX,null);var N=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX,null);var A=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX,[t,N,G]);var Q=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_THIGH_PREFIX,null);var H=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX,null);var n=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_HIP_PREFIX,[Q,H,A]);var B=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_FOOT_PREFIX,null);var F=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX,[B]);var J=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_LEG_PREFIX,null);var s=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX,null);var T=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX,[J,s,F]);var C=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_THIGH_PREFIX,null);var a=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX,null);var r=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX,[C,a,T]);var x=this.extractNodes(z,ModelManager.MANNEQUIN_PELVIS_PREFIX,null);var w=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_HIP_PREFIX,null);var O=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX,null);var R=this.createPickableTransformGroup(ModelManager.MANNEQUIN_ABDOMEN_PELVIS_PREFIX,[x,w,n,O,r]);var u=this.extractNodes(z,ModelManager.MANNEQUIN_ABDOMEN_PREFIX,null);z.addChild(u);z.addChild(f);z.addChild(R)}else{this.updateSimpleDeformableModelHierarchy(z,null,ModelManager.HINGE_PREFIX,ModelManager.OPENING_ON_HINGE_PREFIX,ModelManager.WINDOW_PANE_ON_HINGE_PREFIX,ModelManager.MIRROR_ON_HINGE_PREFIX);this.updateSimpleDeformableModelHierarchy(z,null,ModelManager.BALL_PREFIX,ModelManager.ARM_ON_BALL_PREFIX,null,null);this.updateSimpleDeformableModelHierarchy(z,ModelManager.UNIQUE_RAIL_PREFIX,ModelManager.RAIL_PREFIX,ModelManager.OPENING_ON_RAIL_PREFIX,ModelManager.MIRROR_ON_RAIL_PREFIX)}};ModelManager.prototype.updateSimpleDeformableModelHierarchy=function(k,g,j,c,m,l){if(this.containsNode(k,c+1)||(m!==null&&this.containsNode(k,m+1))||(l!==null&&this.containsNode(k,l+1))){if(this.containsNode(k,j+1)){var e=1;do{var h=this.extractNodes(k,j+e,null);var b=this.extractNodes(k,c+e,null);var d=m!==null?this.extractNodes(k,m+e,null):null;var f=l!==null?this.extractNodes(k,l+e,null):null;var a=this.createPickableTransformGroup(j+e,[b,d,f]);k.addChild(h);k.addChild(a);e++}while(this.containsNode(k,j+e)&&(this.containsNode(k,c+e)||(m!==null&&this.containsNode(k,m+e))||(l!==null&&this.containsNode(k,l+e))))}else{if(g!==null&&this.containsNode(k,g)){var h=this.extractNodes(k,g,null);k.addChild(h);var e=1;do{var b=this.extractNodes(k,c+e,null);var d=this.extractNodes(k,m+e,null);var f=this.extractNodes(k,l+e,null);k.addChild(this.createPickableTransformGroup(j+e,[b,d,f]));e++}while(this.containsNode(k,c+e)||this.containsNode(k,m+e)||this.containsNode(k,l+e))}}}};ModelManager.prototype.containsNode=function(c,d){var a=c.getName();if(a!==null&&a.indexOf(d)===0){return true}if(c instanceof Group3D){for(var b=c.getChildren().length-1;b>=0;b--){if(this.containsNode(c.getChild(b),d)){return true}}}return false};ModelManager.prototype.extractNodes=function(d,a,c){if(d.getName()!==null&&d.getName().indexOf(a)===0){d.getParent().removeChild(d);if(c===null){c=new Group3D()}c.addChild(d)}if(d instanceof Group3D){for(var b=d.getChildren().length-1;b>=0;b--){c=this.extractNodes(d.getChild(b),a,c)}}return c};ModelManager.prototype.createPickableTransformGroup=function(d,b){var c=new TransformGroup3D();c.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);c.setName(d+ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX);for(var a=0;a<b.length;a++){if(b[a]!==null){c.addChild(b[a])}}return c};ModelManager.prototype.containsDeformableNode=function(c){if(c instanceof TransformGroup3D&&c.getName()!==null&&c.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)>=0&&c.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)===(c.getName().length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length)){return true}else{if(c instanceof Group3D){var b=c.getChildren();for(var a=0;a<b.length;a++){if(this.containsDeformableNode(b[a])){return true}}}}return false};ModelManager.prototype.isDeformed=function(d){if(d instanceof TransformGroup3D&&d.getName()!==null&&d.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)>=0&&d.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)===(d.getName().length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length)){var a=mat4.create();d.getTransform(a);return !TransformGroup3D.isIdentity(a)}else{if(d instanceof Group3D){var c=d.getChildren();for(var b=0;b<c.length;b++){if(this.isDeformed(c[b])){return true}}}}return false};ModelManager.prototype.getMaterials=function(m,f){if(f===undefined){f=null}var k=[];this.searchAppearances(m,k);var b=[];for(var q=0;q<k.length;q++){var g=k[q];var o=null;var n=null;var h=g.getDiffuseColor();if(h!=null){o=4278190080|(Math.round(h[0]*255)<<16)|(Math.round(h[1]*255)<<8)|Math.round(h[2]*255);n=g.getShininess()!=null?g.getShininess()/128:null}var e=g.getTextureImage();var l=null;if(e!=null){var a=e.url;if(a!=null){var t=new SimpleURLContent(a);var s=a.substring(a.lastIndexOf("/")+1);var c=s.lastIndexOf(".");if(c!==-1){s=s.substring(0,c)}l=new HomeTexture(new CatalogTexture(null,s,t,-1,-1,f))}}var r=g.getName();if(r===undefined){r=null}var d=new HomeMaterial(r,o,l,n);for(var p=0;p<b.length;p++){if(b[p].getName()==d.getName()){d=null;break}}if(d!=null){b.push(d)}}b.sort(function(u,j){var w=u.getName();var v=j.getName();if(w!=null){if(v!=null){return w.localeCompare(v)}else{return 1}}else{if(v!=null){return -1}else{return 0}}});return b};ModelManager.prototype.searchAppearances=function(d,e){if(d instanceof Group3D){var c=d.getChildren();for(var b=0;b<c.length;b++){this.searchAppearances(c[b],e)}}else{if(d instanceof Link3D){this.searchAppearances(d.getSharedGroup(),e)}else{if(d instanceof Shape3D){var a=d.getAppearance();if(a!==null&&e.indexOf(a)==-1){e.push(a)}}}}};ModelManager.prototype.replaceMultipleSharedShapes=function(c){var a=[];this.searchSharedShapes(c,a,false);for(var e=0;e<a.length;e++){if(a[e].value>1){var f=[];var g=a[e].key;this.searchShapeTransformations(c,g,f,mat4.create());var k=g.clone();var b=k.getGeometries();for(var d=0;d<b.length;d++){var h=this.getTransformedGeometry(b[d],f);if(h===null){return}k.setGeometry(h,d)}this.removeSharedShape(c,g);c.addChild(k)}}};ModelManager.prototype.searchSharedShapes=function(d,e,a){if(d instanceof Group3D){var c=d.getChildren();for(var b=0;b<c.length;b++){this.searchSharedShapes(c[b],e,a)}}else{if(d instanceof Link3D){this.searchSharedShapes(d.getSharedGroup(),e,true)}else{if(d instanceof Shape3D){if(a){for(var b=0;b<e.length;b++){if(e[b].key===d){e[b].value++;return}}e.push({key:d,value:1})}}}}};ModelManager.prototype.searchShapeTransformations=function(g,a,c,f){if(g instanceof Group3D){if(!(g instanceof TransformGroup3D)||!this.isDeformed(g)){if(g instanceof TransformGroup3D){f=mat4.clone(f);var b=mat4.create();g.getTransform(b);mat4.mul(f,f,b)}var e=g.getChildren();for(var d=0;d<e.length;d++){this.searchShapeTransformations(e[d],a,c,f)}}}else{if(g instanceof Link3D){this.searchShapeTransformations(g.getSharedGroup(),a,c,f)}else{if(g===a){c.push(f)}}}};ModelManager.prototype.getTransformedGeometry=function(p,h){var a=0;var q=0;var o=new Array(h.length*p.vertexIndices.length);for(var f=0;f<h.length;f++){for(var e=0,c=p.vertexIndices.length;e<c;e++){o[a+e]=q+p.vertexIndices[e]}a+=p.vertexIndices.length;q+=p.vertices.length}var l=new Array(h.length*p.textureCoordinateIndices.length);a=0;for(var f=0;f<h.length;f++){for(var e=0,c=p.textureCoordinateIndices.length;e<c;e++){l[a+e]=p.textureCoordinateIndices[e]}a+=p.textureCoordinateIndices.length}q=0;var d=new Array(h.length*p.vertices.length);for(var f=0;f<h.length;f++){for(var e=0,c=p.vertices.length;e<c;e++){var k=vec3.clone(p.vertices[e]);vec3.transformMat4(k,k,h[f]);d[q+e]=k}q+=p.vertices.length}if(p instanceof IndexedLineArray3D){return new IndexedLineArray3D(d,o,p.textureCoordinates,l)}else{if(p instanceof IndexedTriangleArray3D){var g=new Array(h.length*p.normalIndices.length);a=0;var r=0;for(var f=0;f<h.length;f++){for(var e=0,c=p.normalIndices.length;e<c;e++){g[a+e]=r+p.normalIndices[e]}a+=p.normalIndices.length;r+=p.normals.length}var r=0;var b=new Array(h.length*p.normals.length);for(var f=0;f<h.length;f++){for(var e=0,c=p.normals.length;e<c;e++){var m=vec3.clone(p.normals[e]);vec3.transformMat4(m,m,h[f]);vec3.normalize(m,m);b[r+e]=m}r+=p.normals.length}return new IndexedTriangleArray3D(d,o,p.textureCoordinates,l,b,g)}else{return null}}};ModelManager.prototype.removeSharedShape=function(d,a){if(d instanceof Group3D){if(!(d instanceof TransformGroup3D)||!this.isDeformed(d)){var c=d.getChildren();for(var b=c.length-1;b>=0;b--){this.removeSharedShape(c[b],a)}if(c.length===0&&d.getParent() instanceof Group3D){d.getParent().removeChild(d)}}}else{if(d instanceof Link3D){var e=d.getSharedGroup();this.removeSharedShape(e,a);if(e.children.length==0){d.getParent().removeChild(d)}}else{if(d===a){d.getParent().removeChild(d)}}}};ModelManager.prototype.getFrontArea=function(k,e){var c;if(k!==null){c=new java.awt.geom.Area(this.getShape(k));c.transform(java.awt.geom.AffineTransform.getScaleInstance(1,-1));c.transform(java.awt.geom.AffineTransform.getTranslateInstance(-0.5,0.5))}else{var b=this.getVertexCount(e);if(b<1000000){var f=new java.awt.geom.Area();this.computeBottomOrFrontArea(e,f,mat4.create(),false,false);c=new java.awt.geom.Area();var o=[];var l=null;for(var h=f.getPathIterator(null,1);!h.isDone();h.next()){var j=[0,0];switch(h.currentSegment(j)){case java.awt.geom.PathIterator.SEG_MOVETO:case java.awt.geom.PathIterator.SEG_LINETO:if(l===null||j[0]!==l[0]||j[1]!==l[1]){o.push(j)}l=j;break;case java.awt.geom.PathIterator.SEG_CLOSE:if(o[0][0]===l[0]&&o[0][1]===l[1]){o.splice(o.length-1,1)}if(o.length>2){var m=o.slice(0);var d=new Room(m);if(d.getArea()>0){if(!d.isClockwise()){var n=new java.awt.geom.GeneralPath();n.moveTo(m[0][0],m[0][1]);for(var g=1;g<m.length;g++){n.lineTo(m[g][0],m[g][1])}n.closePath();c.add(new java.awt.geom.Area(n))}}}o.length=0;l=null;break}}var a=f.getBounds2D();c.transform(java.awt.geom.AffineTransform.getTranslateInstance(-a.getCenterX(),-a.getCenterY()));c.transform(java.awt.geom.AffineTransform.getScaleInstance(1/a.getWidth(),1/a.getHeight()))}else{c=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(-0.5,-0.5,1,1))}}return c};ModelManager.prototype.getAreaOnFloor=function(b){if(b instanceof Node3D){var j;var a=this.getVertexCount(b);if(a<10000){j=new java.awt.geom.Area();this.computeBottomOrFrontArea(b,j,mat4.create(),true,true)}else{var h=[];this.computeVerticesOnFloor(b,h,mat4.create());if(h.length>0){var k=this.getSurroundingPolygon(h.slice(0));var e=new java.awt.geom.GeneralPath(java.awt.geom.Path2D.WIND_NON_ZERO,k.length);e.moveTo(k[0][0],k[0][1]);for(var c=0;c<k.length;c++){e.lineTo(k[c][0],k[c][1])}e.closePath();j=new java.awt.geom.Area(e)}else{j=new java.awt.geom.Area()}}return j}else{var g=b;if(g.getStaircaseCutOutShape()===null){throw new IllegalArgumentException("No cut out shape associated to piece")}var f=this.getShape(g.getStaircaseCutOutShape());var d=new java.awt.geom.Area(f);if(g.isModelMirrored()){d=this.getMirroredArea(d)}var l=java.awt.geom.AffineTransform.getTranslateInstance(g.getX()-g.getWidth()/2,g.getY()-g.getDepth()/2);l.concatenate(java.awt.geom.AffineTransform.getRotateInstance(g.getAngle(),g.getWidth()/2,g.getDepth()/2));l.concatenate(java.awt.geom.AffineTransform.getScaleInstance(g.getWidth(),g.getDepth()));d.transform(l);return d}};ModelManager.prototype.getVertexCount=function(f){var e=0;if(f instanceof Group3D){var c=f.getChildren();for(var b=0;b<c.length;b++){e+=this.getVertexCount(c[b])}}else{if(f instanceof Link3D){e=this.getVertexCount(f.getSharedGroup())}else{if(f instanceof Shape3D){var a=f.getAppearance();if(a.isVisible()){var d=f.getGeometries();for(var b=0,h=d.length;b<h;b++){var g=d[b];e+=g.vertices.length}}}}}return e};ModelManager.prototype.computeBottomOrFrontArea=function(f,m,l,h,a){if(f instanceof Group3D){if(f instanceof TransformGroup3D){l=mat4.clone(l);var e=mat4.create();f.getTransform(e);mat4.mul(l,l,e)}var c=f.getChildren();for(var g=0;g<c.length;g++){this.computeBottomOrFrontArea(c[g],m,l,h,a)}}else{if(f instanceof Link3D){this.computeBottomOrFrontArea(f.getSharedGroup(),m,l,h,a)}else{if(f instanceof Shape3D){var j=f.getAppearance();if(j.isVisible()&&(!h||j.getTransparency()===undefined||j.getTransparency()<1)){var b=f.getGeometries();for(var g=0,d=b.length;g<d;g++){var k=b[g];this.computeBottomOrFrontGeometryArea(k,m,l,a)}}}}}};ModelManager.prototype.computeBottomOrFrontGeometryArea=function(c,l,k,b){if(c instanceof IndexedTriangleArray3D){var a=c.vertices.length;var h=new Array(a*2);var f=vec3.create();for(var g=0,e=0;g<h.length;e++){vec3.copy(f,c.vertices[e]);vec3.transformMat4(f,f,k);h[g++]=f[0];if(b){h[g++]=f[2]}else{h[g++]=f[1]}}geometryPath=new java.awt.geom.GeneralPath(java.awt.geom.Path2D.WIND_NON_ZERO,1000);for(var e=0,j=0,d=c.vertexIndices.length;e<d;e+=3){this.addTriangleToPath(c,c.vertexIndices[e],c.vertexIndices[e+1],c.vertexIndices[e+2],h,geometryPath,j++,l)}l.add(new java.awt.geom.Area(geometryPath))}};ModelManager.prototype.addTriangleToPath=function(b,m,k,h,d,c,e,g){var a=d[2*m];var l=d[2*m+1];var o=d[2*k];var j=d[2*k+1];var n=d[2*h];var f=d[2*h+1];if((o-a)*(f-j)-(j-l)*(n-o)>0){if(e>0&&e%1000===0){g.add(new java.awt.geom.Area(c));c.reset()}c.moveTo(a,l);c.lineTo(o,j);c.lineTo(n,f);c.closePath()}};ModelManager.prototype.computeVerticesOnFloor=function(g,p,q){if(g instanceof Group3D){if(g instanceof TransformGroup3D){q=mat4.clone(q);var f=mat4.create();g.getTransform(f);mat4.mul(q,q,f)}var d=g.getChildren();for(var k=0;k<d.length;k++){this.computeVerticesOnFloor(d[k],p,q)}}else{if(g instanceof Link3D){this.computeVerticesOnFloor(g.getSharedGroup(),p,q)}else{if(g instanceof Shape3D){var m=g.getAppearance();if(m.isVisible()&&(m.getTransparency()===undefined||m.getTransparency()<1)){var c=g.getGeometries();for(var k=0,e=c.length;k<e;k++){var b=c[k];var a=b.vertices.length;var l=vec3.create();for(var o=0,h=0;o<a;h++,o++){vec3.copy(l,b.vertices[h]);vec3.transformMat4(l,l,q);p.push([l[0],l[2]])}}}}}}};ModelManager.prototype.getSurroundingPolygon=function(k){k.sort(function(o,n){var p;if(o[0]===n[0]){p=n[1]-o[1]}else{p=n[0]-o[0]}if(p>0){return 1}else{if(p<0){return -1}else{return 0}}});var m=new Array(k.length);var b=0;var l=-1;var f;var a=0;var e;var c=k[0][0];for(f=1;f<k.length;f++){if(k[f][0]!==c){break}}e=f-1;if(e===k.length-1){m[++l]=k[a];if(k[e][1]!==k[a][1]){m[++l]=k[e]}m[++l]=k[a];var j=new Array(l+1);System.arraycopy(m,0,j,0,j.length);return j}var d;var h=k.length-1;var g=k[k.length-1][0];for(f=k.length-2;f>=0;f--){if(k[f][0]!==g){break}}d=f+1;m[++l]=k[a];f=e;while(++f<=d){if(this.isLeft(k[a],k[d],k[f])>=0&&f<d){continue}while(l>0){if(this.isLeft(m[l-1],m[l],k[f])>0){break}else{l--}}m[++l]=k[f]}if(h!==d){m[++l]=k[h]}b=l;f=d;while(--f>=e){if(this.isLeft(k[h],k[e],k[f])>=0&&f>e){continue}while(l>b){if(this.isLeft(m[l-1],m[l],k[f])>0){break}else{l--}}m[++l]=k[f]}if(e!==a){m[++l]=k[a]}var j=new Array(l+1);System.arraycopy(m,0,j,0,j.length);return j};ModelManager.prototype.isLeft=function(c,b,a){return(b[0]-c[0])*(a[1]-c[1])-(a[0]-c[0])*(b[1]-c[1])};ModelManager.prototype.getMirroredArea=function(c){var d=new java.awt.geom.GeneralPath();var a=[0,0,0,0,0,0];for(var b=c.getPathIterator(null);!b.isDone();b.next()){switch(b.currentSegment(a)){case java.awt.geom.PathIterator.SEG_MOVETO:d.moveTo(1-a[0],a[1]);break;case java.awt.geom.PathIterator.SEG_LINETO:d.lineTo(1-a[0],a[1]);break;case java.awt.geom.PathIterator.SEG_QUADTO:d.quadTo(1-a[0],a[1],1-a[2],a[3]);break;case java.awt.geom.PathIterator.SEG_CUBICTO:d.curveTo(1-a[0],a[1],1-a[2],a[3],1-a[4],a[5]);break;case java.awt.geom.PathIterator.SEG_CLOSE:d.closePath();break}}return new java.awt.geom.Area(d)};ModelManager.prototype.getShape=function(a){return ShapeTools.getShape(a)};function ModelPreviewComponent(f,g){this.canvas3D=new HTMLCanvas3D(f);this.setDefaultTransform();if(g){var e=0.015;var a=0.02;var d=-Math.PI/2;var c=this;var b={buttonPressed:-1,pointerTouches:{},rotationUpdater:function(h,k,j){if(b.buttonPressed===0){if(j){b.zoomUpdater(b.yLastMove-k)}else{c.viewYaw=c.viewYaw-e*(h-b.xLastMove);c.viewPitch=Math.max(d,Math.min(0,c.viewPitch-e*(k-b.yLastMove)));c.updateViewPlatformTransform()}}},zoomUpdater:function(h){c.viewScale=Math.max(0.5,Math.min(1.3,c.viewScale*Math.exp(h*a)));c.stopRotationAnimation();c.updateViewPlatformTransform()},mousePressed:function(h){b.xLastMove=h.clientX;b.yLastMove=h.clientY;b.buttonPressed=h.button;b.mousePressedInCanvas=true;c.stopRotationAnimation();h.stopPropagation()},windowMouseMoved:function(h){if(b.mousePressedInCanvas){b.rotationUpdater(h.clientX,h.clientY,h.altKey);b.xLastMove=h.clientX;b.yLastMove=h.clientY}},windowMouseReleased:function(h){b.buttonPressed=-1;if(b.mousePressedInCanvas){delete b.mousePressedInCanvas}},pointerPressed:function(h){if(h.pointerType=="mouse"){b.mousePressed(h)}else{b.copyPointerToTargetTouches(h);b.touchStarted(h)}},pointerMousePressed:function(h){h.stopPropagation()},windowPointerMoved:function(h){if(h.pointerType=="mouse"){b.windowMouseMoved(h)}else{b.copyPointerToTargetTouches(h);b.touchMoved(h)}},windowPointerReleased:function(h){if(h.pointerType=="mouse"){b.windowMouseReleased(h)}else{delete b.pointerTouches[h.pointerId];b.touchEnded(h)}},touchStarted:function(h){h.preventDefault();if(h.targetTouches.length==1){b.buttonPressed=0;b.xLastMove=h.targetTouches[0].pageX;b.yLastMove=h.targetTouches[0].pageY}else{if(h.targetTouches.length==2){b.distanceLastPinch=b.distance(h.targetTouches[0],h.targetTouches[1])}}c.stopRotationAnimation()},touchMoved:function(k){k.preventDefault();if(k.targetTouches.length==1){var h=k.targetTouches[0].pageX;var m=k.targetTouches[0].pageY;b.rotationUpdater(h,m,false);b.xLastMove=h;b.yLastMove=m}else{if(k.targetTouches.length==2){var j=b.distance(k.targetTouches[0],k.targetTouches[1]);var l=b.distanceLastPinch/j;c.viewScale=Math.max(0.5,Math.min(1.3,c.viewScale*l));c.updateViewPlatformTransform();b.distanceLastPinch=j}}},touchEnded:function(h){b.buttonPressed=-1},copyPointerToTargetTouches:function(j){b.pointerTouches[j.pointerId]={pageX:j.clientX,pageY:j.clientY};j.targetTouches=[];for(var h in b.pointerTouches){if(b.pointerTouches.hasOwnProperty(h)){j.targetTouches.push(b.pointerTouches[h])}}},distance:function(j,h){return Math.sqrt(Math.pow(h.pageX-j.pageX,2)+Math.pow(h.pageY-j.pageY,2))},mouseScrolled:function(h){h.preventDefault();b.zoomUpdater(h.detail)},mouseWheelMoved:function(h){h.preventDefault();b.zoomUpdater(h.deltaY!==undefined?h.deltaY/2:-h.wheelDelta/3)},visibilityChanged:function(h){if(document.visibilityState=="hidden"){c.stopRotationAnimation()}}};if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){this.canvas3D.getHTMLElement().addEventListener("pointerdown",b.pointerPressed);this.canvas3D.getHTMLElement().addEventListener("mousedown",b.pointerMousePressed);window.addEventListener("pointermove",b.windowPointerMoved);window.addEventListener("pointerup",b.windowPointerReleased)}else{this.canvas3D.getHTMLElement().addEventListener("touchstart",b.touchStarted);this.canvas3D.getHTMLElement().addEventListener("touchmove",b.touchMoved);this.canvas3D.getHTMLElement().addEventListener("touchend",b.touchEnded);this.canvas3D.getHTMLElement().addEventListener("mousedown",b.mousePressed);window.addEventListener("mousemove",b.windowMouseMoved);window.addEventListener("mouseup",b.windowMouseReleased)}this.canvas3D.getHTMLElement().addEventListener("DOMMouseScroll",b.mouseScrolled);this.canvas3D.getHTMLElement().addEventListener("mousewheel",b.mouseWheelMoved);document.addEventListener("visibilitychange",b.visibilityChanged);this.userActionsListener=b}}ModelPreviewComponent.prototype.getHTMLElement=function(){return this.canvas3D.getHTMLElement()};ModelPreviewComponent.prototype.setDefaultTransform=function(){this.viewYaw=Math.PI/8;this.viewPitch=-Math.PI/8;this.viewScale=1;this.updateViewPlatformTransform()};ModelPreviewComponent.prototype.updateViewPlatformTransform=function(){var b=1.4/Math.tan(Math.PI/8);var e=mat4.create();mat4.translate(e,e,vec3.fromValues(0,0,b));var a=mat4.create();mat4.rotateX(a,a,this.viewPitch);var d=mat4.create();mat4.rotateY(d,d,this.viewYaw);var c=mat4.create();mat4.scale(c,c,vec3.fromValues(this.viewScale,this.viewScale,this.viewScale));mat4.mul(a,a,e);mat4.mul(d,d,a);mat4.mul(c,c,d);this.canvas3D.setViewPlatformTransform(c)};ModelPreviewComponent.prototype.setModel=function(e,c,b,a,d,j,h,g){if(d===undefined&&j===undefined&&h===undefined&&g===undefined){g=a;h=b;b=c;c=false;a=-1;d=-1;j=-1}this.model=e;this.canvas3D.clear();if(typeof HomePieceOfFurniture!=="undefined"){this.previewedPiece=null}if(e!==null){var f=this;ModelManager.getInstance().loadModel(e,{modelUpdated:function(r){if(e===f.model){var k=ModelManager.getInstance();var m=a<0?k.getSize(r):vec3.fromValues(a,j,d);var o=1.8/Math.max(Math.max(m[0],m[2]),m[1]);var l;if(typeof HomePieceOfFurniture!=="undefined"){f.previewedPiece=new HomePieceOfFurniture(new CatalogPieceOfFurniture(null,null,e,m[0],m[2],m[1],0,false,null,null,b,c,null,null,0,false));f.previewedPiece.setX(0);f.previewedPiece.setY(0);f.previewedPiece.setElevation(-f.previewedPiece.getHeight()/2);var n=mat4.create();mat4.scale(n,n,vec3.fromValues(o,o,o));l=new TransformGroup3D(n);var q=new HomePieceOfFurniture3D(f.previewedPiece,null,true);l.addChild(q)}else{var n=b?k.getRotationTransformation(b):mat4.create();mat4.scale(n,n,vec3.fromValues(o,o,o));mat4.scale(n,n,m);mat4.mul(n,n,k.getNormalizedTransform(r,null,1));l=new TransformGroup3D(n);l.addChild(r)}var p=new BranchGroup3D();p.addChild(l);p.addChild(new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(1.732,-0.8,-1)));p.addChild(new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(-1.732,-0.8,-1)));p.addChild(new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(0,-0.8,1)));p.addChild(new DirectionalLight3D(vec3.fromValues(0.66,0.66,0.66),vec3.fromValues(0,1,0)));p.addChild(new AmbientLight3D(vec3.fromValues(0.2,0.2,0.2)));f.setDefaultTransform();f.canvas3D.setScene(p,g);f.canvas3D.updateViewportSize()}},modelError:function(k){if(e===f.model&&h!==undefined){h(k)}},progression:function(l,m,k){if(e===f.model&&g!==undefined){g(l,m,k)}}})}};ModelPreviewComponent.prototype.getModelNode=function(){var a=this.canvas3D.getScene().getChild(0);if(a.getChildren().length>0){return a.getChild(0)}else{return null}};ModelPreviewComponent.prototype.setModelMaterials=function(a){if(this.previewedPiece!=null){this.previewedPiece.setModelMaterials(a);this.getModelNode().update()}};ModelPreviewComponent.prototype.setModelTranformations=function(a){if(this.previewedPiece!=null){this.previewedPiece.setModelTransformations(a);this.getModelNode().update()}};ModelPreviewComponent.prototype.clear=function(){this.stopRotationAnimation();this.canvas3D.clear()};ModelPreviewComponent.prototype.dispose=function(){if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){window.removeEventListener("pointermove",this.userActionsListener.windowPointerMoved);window.removeEventListener("pointerup",this.userActionsListener.windowPointerReleased)}else{window.removeEventListener("mousemove",this.userActionsListener.windowMouseMoved);window.removeEventListener("mouseup",this.userActionsListener.windowMouseReleased)}document.removeEventListener("visibilitychange",this.userActionsListener.visibilityChanged);this.clear()};ModelPreviewComponent.prototype.startRotationAnimation=function(a){this.roundsPerMinute=a!==undefined?a:5;if(!this.rotationAnimationStarted){this.rotationAnimationStarted=true;this.animate()}};ModelPreviewComponent.prototype.animate=function(){if(this.rotationAnimationStarted){var b=Date.now();if(this.lastRotationAnimationTime!==undefined){var a=this.roundsPerMinute*2*Math.PI/60000;this.viewYaw+=((b-this.lastRotationAnimationTime)*a)%(2*Math.PI);this.updateViewPlatformTransform()}this.lastRotationAnimationTime=b;var c=this;requestAnimationFrame(function(){c.animate()})}};ModelPreviewComponent.prototype.stopRotationAnimation=function(){delete this.lastRotationAnimationTime;delete this.rotationAnimationStarted};var ShapeTools={parsedShapes:{}};ShapeTools.getStroke=function(h,j,d,a,b){var f;switch(j){case Polyline.CapStyle.ROUND:f=java.awt.BasicStroke.CAP_ROUND;break;case Polyline.CapStyle.SQUARE:f=java.awt.BasicStroke.CAP_SQUARE;break;default:f=java.awt.BasicStroke.CAP_BUTT;break}var e;switch(d){case Polyline.JoinStyle.ROUND:case Polyline.JoinStyle.CURVED:e=java.awt.BasicStroke.JOIN_ROUND;break;case Polyline.JoinStyle.BEVEL:e=java.awt.BasicStroke.JOIN_BEVEL;break;default:e=java.awt.BasicStroke.JOIN_MITER;break}var g=0;if(a!=null){if(!Array.isArray(a)){a=undefined;g=undefined}else{a=a.slice(0);for(var c=0;c<a.length;c++){a[c]*=h;g+=a[c]}g*=b}}return new java.awt.BasicStroke(h,f,e,10,a,g)};ShapeTools.getPolylineShape=function(o,j,h){if(j){var c=new java.awt.geom.GeneralPath();for(var f=0,a=h?o.length:o.length-1;f<a;f++){var g=new java.awt.geom.CubicCurve2D.Float();var d=o[f===0?o.length-1:f-1];var m=o[f];var k=o[f===o.length-1?0:f+1];var l=[k[0]-d[0],k[1]-d[1]];var b=o[(f+2)%o.length];var e=[m[0]-b[0],m[1]-b[1]];g.setCurve(m[0],m[1],m[0]+(f!==0||h?l[0]/3.625:0),m[1]+(f!==0||h?l[1]/3.625:0),k[0]+(f!==o.length-2||h?e[0]/3.625:0),k[1]+(f!==o.length-2||h?e[1]/3.625:0),k[0],k[1]);c.append(g,true)}return c}else{return ShapeTools.getShape(o,h,null)}};ShapeTools.getShape=function(j,e,c){if(j instanceof Array){var k=new java.awt.geom.GeneralPath();k.moveTo(Math.fround(j[0][0]),Math.fround(j[0][1]));for(var d=1;d<j.length;d++){k.lineTo(Math.fround(j[d][0]),Math.fround(j[d][1]))}if(e){k.closePath()}if(c!=null){k.transform(c)}return k}else{var g=j;var b=ShapeTools.parsedShapes[g];if(!b){b=new java.awt.geom.Rectangle2D.Float(0,0,1,1);try{var a=new org.apache.batik.parser.AWTPathProducer();var h=new org.apache.batik.parser.PathParser();h.setPathHandler(a);h.parse(g);b=a.getShape()}catch(f){}ShapeTools.parsedShapes[g]=b}return b}};function HomeComponent3D(e,d,c,b,a){this.home=d;this.object3dFactory=b!==null?b:new Object3DBranchFactory();this.homeObjects=[];this.homeObjects3D=[];this.sceneLights=[];this.camera=null;this.windowSizeListener=null;this.cameraChangeListener=null;this.homeCameraListener=null;this.groundChangeListener=null;this.backgroundChangeListener=null;this.lightColorListener=null;this.elevationChangeListener=null;this.wallsAlphaListener=null;this.levelListener=null;this.levelChangeListener=null;this.wallListener=null;this.wallChangeListener=null;this.furnitureListener=null;this.furnitureChangeListener=null;this.roomListener=null;this.roomChangeListener=null;this.polylineChangeListener=null;this.polylineListener=null;this.labelListener=null;this.labelChangeListener=null;this.approximateHomeBoundsCache=null;this.createComponent3D(e,c,a)}HomeComponent3D.prototype.createComponent3D=function(d,c,a){this.canvas3D=new HTMLCanvas3D(d);if(a){this.addMouseListeners(a,this.canvas3D);if(c!==null){this.navigationPanelId=this.createNavigationPanel(this.home,c,a);this.setNavigationPanelVisible(c.isNavigationPanelVisible());this.revalidate();var b=this;c.addPropertyChangeListener("NAVIGATION_PANEL_VISIBLE",function(e){b.setNavigationPanelVisible(e.getNewValue())})}this.createActions(a);this.installKeyboardActions()}this.updateView(this.home.getCamera());this.updateViewPlatformTransform(this.home.getCamera(),false);this.addCameraListeners();this.canvas3D.setScene(this.createSceneTree(true,false))};HomeComponent3D.prototype.getHTMLElement=function(){return this.canvas3D.getHTMLElement()};HomeComponent3D.prototype.disposeGeometries=function(){if(this.home.structure){ModelManager.getInstance().unloadModel(this.home.structure,true)}ModelManager.getInstance().disposeGeometries(this.canvas3D.getScene())};HomeComponent3D.prototype.revalidate=function(){var a=this.canvas3D.getHTMLElement();var b=a.getBoundingClientRect();navigationPanelDiv=document.getElementById(this.navigationPanelId);if(navigationPanelDiv.style!==undefined){navigationPanelDiv.style.left=(b.left+window.pageXOffset)+"px";navigationPanelDiv.style.top=(b.top+window.pageYOffset)+"px"}this.canvas3D.updateViewportSize()};HomeComponent3D.prototype.createNavigationPanel=function(m,h,j){var a=this.getSimulatedKeyElements(document.getElementsByTagName("body")[0]);var k=null;var c;try{c=h.getLocalizedString(HomeComponent3D,"navigationPanel.innerHTML")}catch(l){c='<img src="'+ZIPTools.getScriptFolder("gl-matrix-min.js")+'/navigationPanel.png"     style="width: 56px; height:59px; margin:5px; user-drag: none; user-select: none; -moz-user-select: none; -webkit-user-drag: none; -webkit-user-select: none; -ms-user-select: none;"     usemap="#navigationPanelMap"/><map name="navigationPanelMap" id="navigationPanelMap">  <area shape="poly" coords="28,4,33,8,33,19,22,19,22,8,29,4" data-simulated-key="UP" />  <area shape="poly" coords="4,28,8,23,19,23,19,34,8,34,4,29" data-simulated-key="LEFT" />  <area shape="poly" coords="28,54,33,50,33,39,22,39,22,50,29,54" data-simulated-key="DOWN" />  <area shape="poly" coords="51,28,47,23,36,23,36,34,47,34,51,29" data-simulated-key="RIGHT" />  <area shape="poly" coords="28,22,33,26,33,28,22,28,22,26,29,22" data-simulated-key="PAGE_UP" />  <area shape="poly" coords="28,36,33,32,33,30,22,30,22,32,29,36" data-simulated-key="PAGE_DOWN" /></map>'}var n=this;if(c!==null){k=document.createElement("div");k.setAttribute("id","div"+Math.floor(Math.random()*10000000000));k.style.position="absolute";var b=this.canvas3D.getHTMLElement();window.addEventListener("resize",function(o){n.revalidate()});var e=0;for(var g=this.canvas3D.getHTMLElement();g&&g.style&&isNaN(e=parseInt(g.style.zIndex));g=g.parentElement){}k.style.zIndex=isNaN(e)?"1":(e+1).toString();k.style.visibility="hidden";k.innerHTML=c;a.push.apply(a,this.getSimulatedKeyElements(k));var d=document.getElementsByTagName("body")[0];d.insertBefore(k,d.firstChild);k.addEventListener("mousedown",function(o){n.userActionsListener.mousePressed(o)})}this.simulatedElementMousePressedListener=function(q){var s=q.target;var o=function(){var u=s.getAttribute("data-simulated-key");var t=u.substring(u.indexOf(":")+1);var v="";if(q.ctrlKey||t.indexOf("control ")!=-1){v+="control "}if(q.altKey||t.indexOf("alt ")!=-1){v+="alt "}if(q.metaKey||t.indexOf("meta ")!=-1){v+="meta "}if(q.shiftKey||t.indexOf("shift ")!=-1){v+="shift "}v+="pressed "+t;n.callAction(q,v)};var r=function(t){window.clearInterval(p);s.removeEventListener("mouseup",r);s.removeEventListener("mouseleave",r);n.userActionsListener.windowMouseReleased(t);t.stopPropagation()};s.addEventListener("mouseup",r);s.addEventListener("mouseleave",r);o();var p=window.setInterval(o,80)};for(var f=0;f<a.length;f++){a[f].addEventListener("mousedown",this.simulatedElementMousePressedListener)}if(k!==null){return k.getAttribute("id")}else{return null}};HomeComponent3D.prototype.getSimulatedKeyElements=function(c){var e=[];if(c.hasChildNodes()){for(var b=0;b<c.childNodes.length;b++){var d=c.childNodes[b];if(d.hasAttribute&&d.hasAttribute("data-simulated-key")){var a=d.getAttribute("data-simulated-key");if(a.indexOf(":")===-1||a.indexOf(this.canvas3D.getHTMLElement().getAttribute("id")+":")===0){e.push(d)}}e.push.apply(e,this.getSimulatedKeyElements(d))}}return e};HomeComponent3D.prototype.setNavigationPanelVisible=function(a){if(this.navigationPanelId!=null){document.getElementById(this.navigationPanelId).style.visibility=a?"visible":"hidden"}};HomeComponent3D.prototype.removeHomeListeners=function(){this.home.removePropertyChangeListener("CAMERA",this.homeCameraListener);var a=this.home.getEnvironment();a.removePropertyChangeListener("SKY_COLOR",this.backgroundChangeListener);a.removePropertyChangeListener("SKY_TEXTURE",this.backgroundChangeListener);a.removePropertyChangeListener("GROUND_COLOR",this.backgroundChangeListener);a.removePropertyChangeListener("GROUND_TEXTURE",this.backgroundChangeListener);a.removePropertyChangeListener("GROUND_COLOR",this.groundChangeListener);a.removePropertyChangeListener("GROUND_TEXTURE",this.groundChangeListener);a.removePropertyChangeListener("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",this.groundChangeListener);this.home.removePropertyChangeListener("BACKGROUND_IMAGE",this.groundChangeListener);a.removePropertyChangeListener("LIGHT_COLOR",this.lightColorListener);a.removePropertyChangeListener("WALLS_ALPHA",this.wallsAlphaListener);this.home.getCamera().removePropertyChangeListener(this.cameraChangeListener);this.home.removePropertyChangeListener("CAMERA",this.elevationChangeListener);this.home.getCamera().removePropertyChangeListener(this.elevationChangeListener);this.home.removeLevelsListener(this.levelListener);var f=this.home.getLevels();for(var d=0;d<f.length;d++){f[d].removePropertyChangeListener(this.levelChangeListener)}this.home.removeWallsListener(this.wallListener);var b=this.home.getWalls();for(var d=0;d<b.length;d++){b[d].removePropertyChangeListener(this.wallChangeListener)}this.home.removeFurnitureListener(this.furnitureListener);var e=this.home.getFurniture();for(var d=0;d<e.length;d++){this.removePropertyChangeListener(e[d],this.furnitureChangeListener)}this.home.removeRoomsListener(this.roomListener);var g=this.home.getRooms();for(var d=0;d<g.length;d++){g[d].removePropertyChangeListener(this.roomChangeListener)}this.home.removePolylinesListener(this.polylineListener);var c=this.home.getPolylines();for(var d=0;d<c.length;d++){c[d].removePropertyChangeListener(this.polylineChangeListener)}this.home.removeLabelsListener(this.labelListener);var h=this.home.getLabels();for(var d=0;d<h.length;d++){h[d].removePropertyChangeListener(this.labelChangeListener)}};HomeComponent3D.prototype.removeMouseListeners=function(a){if(this.userActionsListener){if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){a.getHTMLElement().removeEventListener("pointerdown",this.userActionsListener.pointerPressed);a.getHTMLElement().removeEventListener("mousedown",this.userActionsListener.pointerMousePressed);window.removeEventListener("pointermove",this.userActionsListener.windowPointerMoved);window.removeEventListener("pointerup",this.userActionsListener.windowPointerReleased)}else{a.getHTMLElement().removeEventListener("touchstart",this.userActionsListener.touchStarted);a.getHTMLElement().removeEventListener("touchmove",this.userActionsListener.touchMoved);a.getHTMLElement().removeEventListener("touchend",this.userActionsListener.touchEnded);a.getHTMLElement().removeEventListener("mousedown",this.userActionsListener.mousePressed);window.removeEventListener("mousemove",this.userActionsListener.windowMouseMoved);window.removeEventListener("mouseup",this.userActionsListener.windowMouseReleased)}a.getHTMLElement().removeEventListener("contextmenu",this.userActionsListener.contextMenuDisplayed);a.getHTMLElement().removeEventListener("DOMMouseScroll",this.userActionsListener.mouseScrolled);a.getHTMLElement().removeEventListener("mousewheel",this.userActionsListener.mouseWheelMoved)}};HomeComponent3D.prototype.dispose=function(){this.removeHomeListeners();this.removeMouseListeners(this.canvas3D);if(this.navigationPanelId!=null){window.removeEventListener("resize",this.windowSizeListener);var c=this.getSimulatedKeyElements(document.getElementsByTagName("body")[0]);for(var b=0;b<c.length;b++){c[b].removeEventListener("mousedown",this.simulatedElementMousePressedListener)}var a=document.getElementById(this.navigationPanelId);a.parentElement.removeChild(a)}this.canvas3D.clear()};HomeComponent3D.prototype.addCameraListeners=function(){var a=this;var b=this.home;this.cameraChangeListener=function(d){if(!this.updater){var c=this;this.updater=function(){if(a.canvas3D){a.updateView(b.getCamera());a.updateViewPlatformTransform(b.getCamera(),true)}delete c.updater};setTimeout(this.updater,0)}};b.getCamera().addPropertyChangeListener(this.cameraChangeListener);this.homeCameraListener=function(c){a.updateView(b.getCamera());a.updateViewPlatformTransform(b.getCamera(),false);c.getOldValue().removePropertyChangeListener(a.cameraChangeListener);b.getCamera().addPropertyChangeListener(a.cameraChangeListener)};this.home.addPropertyChangeListener("CAMERA",this.homeCameraListener)};HomeComponent3D.prototype.updateView=function(j){var f=j.getFieldOfView();if(f===0){f=Math.PI*63/180}this.canvas3D.setFieldOfView(f);var k=2.5;var c=500000;if(this.canvas3D.getDepthBits()<=16){var c=3000;var d=this.getApproximateHomeBounds();if(d!=null&&!d.intersect(vec3.fromValues(j.getX(),j.getY(),j.getZ()))){var a=this.getDistanceToBox(j.getX(),j.getY(),j.getZ(),d);if(!isNaN(a)){k=Math.max(k,0.1*a)}}var h=this.canvas3D.getHTMLElement().getBoundingClientRect();if(j.getZ()>0&&h.width!==0&&h.height!==0){var e=Math.atan(Math.tan(f/2)*h.height/h.width);var g=j.getPitch()+e;if(g>0){var b=(j.getZ()/Math.sin(g));k=Math.min(k,0.35*b);if(k*c<b){k=b/c}}}}this.canvas3D.setFrontClipDistance(k);this.canvas3D.setBackClipDistance(k*c)};HomeComponent3D.prototype.getApproximateHomeBounds=function(){if(this.approximateHomeBoundsCache===null){var f=null;var l=this.home.getFurniture();for(var j=0;j<l.length;j++){var p=l[j];if(p.isVisible()&&(p.getLevel()===null||p.getLevel().isViewable())){var g=Math.max(p.getWidthInPlan(),p.getDepthInPlan())/2;var o=p.getGroundElevation();var d=vec3.fromValues(p.getX()-g,p.getY()-g,o);if(f===null){f=new BoundingBox3D(d,d)}else{f.combine(d)}f.combine(vec3.fromValues(p.getX()+g,p.getY()+g,o+p.getHeightInPlan()))}}var e=this.home.getWalls();for(var j=0;j<e.length;j++){var n=e[j];if(n.getLevel()===null||n.getLevel().isViewable()){var c=vec3.fromValues(n.getXStart(),n.getYStart(),n.getLevel()!==null?n.getLevel().getElevation():0);if(f===null){f=new BoundingBox3D(c,c)}else{f.combine(c)}f.combine(vec3.fromValues(n.getXEnd(),n.getYEnd(),c.z+(n.getHeight()!==null?n.getHeight():this.home.getWallHeight())))}}var h=this.home.getRooms();for(var j=0;j<h.length;j++){var b=h[j];if(b.getLevel()===null||b.getLevel().isViewable()){var a=vec3.fromValues(b.getXCenter(),b.getYCenter(),b.getLevel()!==null?b.getLevel().getElevation():0);if(f===null){f=new BoundingBox3D(a,a)}else{f.combine(a)}}}var k=this.home.getLabels();for(var j=0;j<k.length;j++){var m=k[j];if((m.getLevel()===null||m.getLevel().isViewable())&&m.getPitch()!==null){var a=vec3.fromValues(m.getX(),m.getY(),m.getGroundElevation());if(f==null){f=new BoundingBox3D(a,a)}else{f.combine(a)}}}this.approximateHomeBoundsCache=f}return this.approximateHomeBoundsCache};HomeComponent3D.prototype.getDistanceToBox=function(h,g,f,d){var j=vec3.fromValues(h,g,f);var c=vec3.create();d.getLower(c);var k=vec3.create();d.getUpper(k);var m=[vec3.fromValues(c[0],c[1],c[2]),vec3.fromValues(k[0],c[1],c[2]),vec3.fromValues(c[0],k[1],c[2]),vec3.fromValues(k[0],k[1],c[2]),vec3.fromValues(c[0],c[1],k[2]),vec3.fromValues(k[0],c[1],k[2]),vec3.fromValues(c[0],k[1],k[2]),vec3.fromValues(k[0],k[1],k[2])];var e=new Array(m.length);for(var b=0;b<e.length;b++){e[b]=vec3.squaredDistance(j,m[b])}var l=[this.getDistanceToSide(j,m,e,0,1,3,2,2),this.getDistanceToSide(j,m,e,0,1,5,4,1),this.getDistanceToSide(j,m,e,0,2,6,4,0),this.getDistanceToSide(j,m,e,4,5,7,6,2),this.getDistanceToSide(j,m,e,2,3,7,6,1),this.getDistanceToSide(j,m,e,1,3,7,5,0)];var a=l[0];for(var b=1;b<l.length;b++){a=Math.min(a,l[b])}return a};HomeComponent3D.prototype.getDistanceToSide=function(j,k,l,h,g,e,c,a){switch(a){case 0:if(j[1]<=k[h][1]){if(j[2]<=k[h][2]){return Math.sqrt(l[h])}else{if(j[2]>=k[c][2]){return Math.sqrt(l[c])}else{return this.getDistanceToLine(j,k[h],k[c])}}}else{if(j[1]>=k[g][1]){if(j[2]<=k[g][2]){return Math.sqrt(l[g])}else{if(j[2]>=k[e][2]){return Math.sqrt(l[e])}else{return this.getDistanceToLine(j,k[g],k[e])}}}else{if(j[2]<=k[h][2]){return this.getDistanceToLine(j,k[h],k[g])}else{if(j[2]>=k[c][2]){return this.getDistanceToLine(j,k[e],k[c])}}}}break;case 1:if(j[0]<=k[h][0]){if(j[2]<=k[h][2]){return Math.sqrt(l[h])}else{if(j[2]>=k[c][2]){return Math.sqrt(l[c])}else{return this.getDistanceToLine(j,k[h],k[c])}}}else{if(j[0]>=k[g][0]){if(j[2]<=k[g][2]){return Math.sqrt(l[g])}else{if(j[2]>=k[e][2]){return Math.sqrt(l[e])}else{return this.getDistanceToLine(j,k[g],k[e])}}}else{if(j[2]<=k[h][2]){return this.getDistanceToLine(j,k[h],k[g])}else{if(j[2]>=k[c][2]){return this.getDistanceToLine(j,k[e],k[c])}}}}break;case 2:if(j[0]<=k[h][0]){if(j[1]<=k[h][1]){return Math.sqrt(l[h])}else{if(j[1]>=k[c][1]){return Math.sqrt(l[c])}else{return this.getDistanceToLine(j,k[h],k[c])}}}else{if(j[0]>=k[g][0]){if(j[1]<=k[g][1]){return Math.sqrt(l[g])}else{if(j[1]>=k[e][1]){return Math.sqrt(l[e])}else{return this.getDistanceToLine(j,k[g],k[e])}}}else{if(j[1]<=k[h][1]){return this.getDistanceToLine(j,k[h],k[g])}else{if(j[1]>=k[c][1]){return this.getDistanceToLine(j,k[e],k[c])}}}}break}var d=vec3.fromValues(k[g][0]-k[h][0],k[g][1]-k[h][1],k[g][2]-k[h][2]);var b=vec3.fromValues(k[e][0]-k[h][0],k[e][1]-k[h][1],k[e][2]-k[h][2]);var f=vec3.create();vec3.cross(f,d,b);return Math.abs(vec3.dot(f,vec3.fromValues(k[h][0]-j[0],k[h][1]-j[1],k[h][2]-j[2])))/vec3.length(f)};HomeComponent3D.prototype.getDistanceToLine=function(a,e,d){var f=vec3.fromValues(d[0]-e[0],d[1]-e[1],d[2]-e[2]);var b=vec3.fromValues(a[0]-e[0],a[1]-e[1],a[2]-e[2]);var c=vec3.create();vec3.cross(c,f,b);return vec3.length(c)/vec3.length(f)};HomeComponent3D.prototype.updateViewPlatformTransform=function(b,a){if(a){this.moveCameraWithAnimation(b)}else{delete this.cameraInterpolator;var c=mat4.create();this.computeViewPlatformTransform(c,b.getX(),b.getY(),b.getZ(),b.getYaw(),b.getPitch());this.canvas3D.setViewPlatformTransform(c)}};HomeComponent3D.prototype.moveCameraWithAnimation=function(c){if(this.cameraInterpolator===undefined){this.cameraInterpolator={initialCamera:null,finalCamera:null,alpha:null}}if(this.cameraInterpolator.finalCamera===null||this.cameraInterpolator.finalCamera.getX()!==c.getX()||this.cameraInterpolator.finalCamera.getY()!==c.getY()||this.cameraInterpolator.finalCamera.getZ()!==c.getZ()||this.cameraInterpolator.finalCamera.getYaw()!==c.getYaw()||this.cameraInterpolator.finalCamera.getPitch()!==c.getPitch()){if(this.cameraInterpolator.alpha===null||this.cameraInterpolator.alpha===1){this.cameraInterpolator.initialCamera=new Camera(this.camera.getX(),this.camera.getY(),this.camera.getZ(),this.camera.getYaw(),this.camera.getPitch(),this.camera.getFieldOfView())}else{if(this.cameraInterpolator.alpha<0.3){var b=mat4.create();this.computeViewPlatformTransform(b,this.cameraInterpolator.finalCamera.getX(),this.cameraInterpolator.finalCamera.getY(),this.cameraInterpolator.finalCamera.getZ(),this.cameraInterpolator.finalCamera.getYaw(),this.cameraInterpolator.finalCamera.getPitch());this.canvas3D.setViewPlatformTransform(b);this.cameraInterpolator.initialCamera=this.cameraInterpolator.finalCamera}else{this.cameraInterpolator.initialCamera=new Camera(this.cameraInterpolator.initialCamera.getX()+(this.cameraInterpolator.finalCamera.getX()-this.cameraInterpolator.initialCamera.getX())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getY()+(this.cameraInterpolator.finalCamera.getY()-this.cameraInterpolator.initialCamera.getY())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getZ()+(this.cameraInterpolator.finalCamera.getZ()-this.cameraInterpolator.initialCamera.getZ())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getYaw()+(this.cameraInterpolator.finalCamera.getYaw()-this.cameraInterpolator.initialCamera.getYaw())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getPitch()+(this.cameraInterpolator.finalCamera.getPitch()-this.cameraInterpolator.initialCamera.getPitch())*this.cameraInterpolator.alpha,c.getFieldOfView())}}this.cameraInterpolator.finalCamera=new Camera(c.getX(),c.getY(),c.getZ(),c.getYaw(),c.getPitch(),c.getFieldOfView());if(this.cameraInterpolator.alpha===null){this.cameraInterpolator.animationDuration=75}this.cameraInterpolator.startTime=Date.now();this.cameraInterpolator.alpha=0;var a=this;requestAnimationFrame(function(){a.interpolateUntilAlphaEquals1()})}};HomeComponent3D.prototype.interpolateUntilAlphaEquals1=function(){if(this.cameraInterpolator){var c=Date.now();var d=Math.min(1,(c-this.cameraInterpolator.startTime)/this.cameraInterpolator.animationDuration);if(this.cameraInterpolator.alpha!==d){var b=mat4.create();this.computeTransform(d,b);this.canvas3D.setViewPlatformTransform(b);this.cameraInterpolator.alpha=d}if(this.cameraInterpolator.alpha<1){var a=this;requestAnimationFrame(function(){a.interpolateUntilAlphaEquals1()})}}};HomeComponent3D.prototype.computeTransform=function(b,a){this.computeViewPlatformTransform(a,this.cameraInterpolator.initialCamera.getX()+(this.cameraInterpolator.finalCamera.getX()-this.cameraInterpolator.initialCamera.getX())*b,this.cameraInterpolator.initialCamera.getY()+(this.cameraInterpolator.finalCamera.getY()-this.cameraInterpolator.initialCamera.getY())*b,this.cameraInterpolator.initialCamera.getZ()+(this.cameraInterpolator.finalCamera.getZ()-this.cameraInterpolator.initialCamera.getZ())*b,this.cameraInterpolator.initialCamera.getYaw()+(this.cameraInterpolator.finalCamera.getYaw()-this.cameraInterpolator.initialCamera.getYaw())*b,this.cameraInterpolator.initialCamera.getPitch()+(this.cameraInterpolator.finalCamera.getPitch()-this.cameraInterpolator.initialCamera.getPitch())*b)};HomeComponent3D.prototype.computeViewPlatformTransform=function(a,g,f,d,c,e){var h=mat4.create();mat4.fromYRotation(h,-c+Math.PI);var b=mat4.create();mat4.fromXRotation(b,-e);mat4.mul(h,h,b);mat4.identity(a);mat4.translate(a,a,vec3.fromValues(g,d,f));mat4.mul(a,a,h);this.camera=new Camera(g,f,d,c,e,0)};HomeComponent3D.prototype.addMouseListeners=function(a,d){var b=this;var c={xLastMove:-1,yLastMove:-1,buttonPressed:-1,touchEventType:false,pointerTouches:{},distanceLastPinch:-1,actionStartedInComponent3D:false,contextMenuEventType:false,mousePressed:function(e){if(!c.touchEventType&&!c.contextMenuEventType){c.xLastMove=e.clientX;c.yLastMove=e.clientY;c.buttonPressed=e.button;c.actionStartedInComponent3D=true;e.stopPropagation()}},windowMouseMoved:function(e){if(c.actionStartedInComponent3D&&!c.contextMenuEventType){c.moved(e.clientX,e.clientY,e.altKey,e.shiftKey)}},windowMouseReleased:function(e){if(!c.touchEventType&&!c.contextMenuEventType){c.buttonPressed=-1}c.touchEventType=false;c.contextMenuEventType=false;c.actionStartedInComponent3D=false},pointerPressed:function(e){if(e.pointerType=="mouse"){c.mousePressed(e)}else{c.copyPointerToTargetTouches(e);c.touchStarted(e)}},pointerMousePressed:function(e){e.stopPropagation()},windowPointerMoved:function(e){if(e.pointerType=="mouse"){c.windowMouseMoved(e)}else{c.copyPointerToTargetTouches(e);c.touchMoved(e)}},windowPointerReleased:function(e){if(e.pointerType=="mouse"){c.windowMouseReleased(e)}else{delete c.pointerTouches[e.pointerId];c.touchEnded(e)}},contextMenuDisplayed:function(e){c.contextMenuEventType=true},touchStarted:function(e){e.preventDefault();if(document.activeElement!=b.canvas3D.getHTMLElement()){b.canvas3D.getHTMLElement().focus()}c.touchEventType=e.pointerType===undefined;this.actionStartedInComponent3D=true;if(e.targetTouches.length==1){c.xLastMove=e.targetTouches[0].pageX;c.yLastMove=e.targetTouches[0].pageY;if(b.home.getCamera()===b.home.getObserverCamera()){c.xLastMove=-c.xLastMove;c.yLastMove=-c.yLastMove}c.buttonPressed=0}else{if(e.targetTouches.length==2){c.distanceLastPinch=c.distance(e.targetTouches[0],e.targetTouches[1])}}},touchMoved:function(g){if(this.actionStartedInComponent3D){g.preventDefault();if(g.targetTouches.length==1){if(b.home.getCamera()===b.home.getObserverCamera()){c.moved(-g.targetTouches[0].pageX,-g.targetTouches[0].pageY,false,false)}else{c.moved(g.targetTouches[0].pageX,g.targetTouches[0].pageY,false,false)}}else{if(g.targetTouches.length==2){var f=c.distance(g.targetTouches[0],g.targetTouches[1]);var e=f/c.distanceLastPinch;c.zoomed((1-e)*50,false);c.distanceLastPinch=f}}}},touchEnded:function(e){c.buttonPressed=-1;this.actionStartedInComponent3D=false},copyPointerToTargetTouches:function(f){c.pointerTouches[f.pointerId]={pageX:f.clientX,pageY:f.clientY};f.targetTouches=[];for(var e in c.pointerTouches){if(c.pointerTouches.hasOwnProperty(e)){f.targetTouches.push(c.pointerTouches[e])}}},distance:function(f,e){return Math.sqrt(Math.pow(e.pageX-f.pageX,2)+Math.pow(e.pageY-f.pageY,2))},moved:function(e,m,j,g){if((c.xLastMove!==e||c.yLastMove!==m)&&c.buttonPressed===0){if(j){var l=1.25*(c.yLastMove-m);if(g){l*=5}a.moveCamera(l)}else{var k=0.005;var h=k*(e-c.xLastMove);if(g){h*=5}a.rotateCameraYaw(h);var f=k*(m-c.yLastMove);a.rotateCameraPitch(f)}c.xLastMove=e;c.yLastMove=m}},mouseScrolled:function(e){c.zoomed(e.detail,e.shiftKey)},mouseWheelMoved:function(e){e.preventDefault();c.zoomed((e.deltaY!==undefined?e.deltaY:-e.wheelDelta)/4,e.shiftKey)},zoomed:function(f,e){var f=-2.5*f;if(e){f*=5}a.moveCamera(f)}};if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){d.getHTMLElement().addEventListener("pointerdown",c.pointerPressed);d.getHTMLElement().addEventListener("mousedown",c.pointerMousePressed);window.addEventListener("pointermove",c.windowPointerMoved);window.addEventListener("pointerup",c.windowPointerReleased)}else{d.getHTMLElement().addEventListener("touchstart",c.touchStarted);d.getHTMLElement().addEventListener("touchmove",c.touchMoved);d.getHTMLElement().addEventListener("touchend",c.touchEnded);d.getHTMLElement().addEventListener("mousedown",c.mousePressed);window.addEventListener("mousemove",c.windowMouseMoved);window.addEventListener("mouseup",c.windowMouseReleased)}d.getHTMLElement().addEventListener("contextmenu",c.contextMenuDisplayed);d.getHTMLElement().addEventListener("DOMMouseScroll",c.mouseScrolled);d.getHTMLElement().addEventListener("mousewheel",c.mouseWheelMoved);this.userActionsListener=c};HomeComponent3D.prototype.installKeyboardActions=function(){this.inputMap={"shift pressed UP":"MOVE_CAMERA_FAST_FORWARD","alt shift pressed UP":"MOVE_CAMERA_FAST_FORWARD","shift pressed W":"MOVE_CAMERA_FAST_FORWARD","pressed UP":"MOVE_CAMERA_FORWARD","alt pressed UP":"MOVE_CAMERA_FORWARD","pressed W":"MOVE_CAMERA_FORWARD","shift pressed DOWN":"MOVE_CAMERA_FAST_BACKWARD","alt shift pressed DOWN":"MOVE_CAMERA_FAST_BACKWARD","shift pressed S":"MOVE_CAMERA_FAST_BACKWARD","pressed DOWN":"MOVE_CAMERA_BACKWARD","alt pressed DOWN":"MOVE_CAMERA_BACKWARD","pressed S":"MOVE_CAMERA_BACKWARD","alt shift pressed LEFT":"MOVE_CAMERA_FAST_LEFT","alt pressed LEFT":"MOVE_CAMERA_LEFT","alt shift pressed RIGHT":"MOVE_CAMERA_FAST_RIGHT","alt pressed RIGHT":"MOVE_CAMERA_RIGHT","shift pressed LEFT":"ROTATE_CAMERA_YAW_FAST_LEFT","shift pressed A":"ROTATE_CAMERA_YAW_FAST_LEFT","pressed LEFT":"ROTATE_CAMERA_YAW_LEFT","pressed A":"ROTATE_CAMERA_YAW_LEFT","shift pressed RIGHT":"ROTATE_CAMERA_YAW_FAST_RIGHT","shift pressed D":"ROTATE_CAMERA_YAW_FAST_RIGHT","pressed RIGHT":"ROTATE_CAMERA_YAW_RIGHT","pressed D":"ROTATE_CAMERA_YAW_RIGHT","shift pressed PAGE_UP":"ROTATE_CAMERA_PITCH_FAST_UP","pressed PAGE_UP":"ROTATE_CAMERA_PITCH_UP","shift pressed PAGE_DOWN":"ROTATE_CAMERA_PITCH_FAST_DOWN","pressed PAGE_DOWN":"ROTATE_CAMERA_PITCH_DOWN","shift pressed HOME":"ELEVATE_CAMERA_FAST_UP","pressed HOME":"ELEVATE_CAMERA_UP","shift pressed END":"ELEVATE_CAMERA_FAST_DOWN","pressed END":"ELEVATE_CAMERA_DOWN"};var a=this;this.canvas3D.getHTMLElement().addEventListener("keydown",function(b){a.callAction(b,KeyStroke.getKeyStrokeForEvent(b,"keydown"))},false);this.canvas3D.getHTMLElement().addEventListener("keyup",function(b){a.callAction(b,KeyStroke.getKeyStrokeForEvent(b,"keyup"))},false)};HomeComponent3D.prototype.callAction=function(a,d){if(d!==undefined){var c=this.inputMap[d];if(c!==undefined){var b=this.actionMap[c];if(b!==undefined){b.actionPerformed(a)}a.stopPropagation()}}};HomeComponent3D.prototype.createActions=function(a){function f(g){this.delta=g}f.prototype.actionPerformed=function(g){a.moveCamera(this.delta)};function b(g){this.delta=g}b.prototype.actionPerformed=function(g){a.moveCameraSideways(this.delta)};function e(g){this.delta=g}e.prototype.actionPerformed=function(g){a.elevateCamera(this.delta)};function d(g){this.delta=g}d.prototype.actionPerformed=function(g){a.rotateCameraYaw(this.delta)};function c(g){this.delta=g}c.prototype.actionPerformed=function(g){a.rotateCameraPitch(this.delta)};this.actionMap={MOVE_CAMERA_FORWARD:new f(6.5),MOVE_CAMERA_FAST_FORWARD:new f(32.5),MOVE_CAMERA_BACKWARD:new f(-6.5),MOVE_CAMERA_FAST_BACKWARD:new f(-32.5),MOVE_CAMERA_LEFT:new b(-2.5),MOVE_CAMERA_FAST_LEFT:new b(-10),MOVE_CAMERA_RIGHT:new b(2.5),MOVE_CAMERA_FAST_RIGHT:new b(10),ELEVATE_CAMERA_DOWN:new e(-2.5),ELEVATE_CAMERA_FAST_DOWN:new e(-10),ELEVATE_CAMERA_UP:new e(2.5),ELEVATE_CAMERA_FAST_UP:new e(10),ROTATE_CAMERA_YAW_LEFT:new d(-Math.PI/60),ROTATE_CAMERA_YAW_FAST_LEFT:new d(-Math.PI/12),ROTATE_CAMERA_YAW_RIGHT:new d(Math.PI/60),ROTATE_CAMERA_YAW_FAST_RIGHT:new d(Math.PI/12),ROTATE_CAMERA_PITCH_UP:new c(-Math.PI/120),ROTATE_CAMERA_PITCH_FAST_UP:new c(-Math.PI/24),ROTATE_CAMERA_PITCH_DOWN:new c(Math.PI/120),ROTATE_CAMERA_PITCH_FAST_DOWN:new c(Math.PI/24)}};HomeComponent3D.prototype.getActionMap=function(){return this.actionMap};HomeComponent3D.prototype.getInputMap=function(){return this.inputMap};HomeComponent3D.prototype.getClosestItemAt=function(a,d){var b=this.canvas3D.getClosestShapeAt(a,d);var c=-1;while(b!==null&&(c=this.homeObjects3D.indexOf(b))<0){b=b.getParent()}if(b!=null){return this.homeObjects[c]}else{return null}};HomeComponent3D.prototype.createSceneTree=function(b,d){var a=new Group3D();a.addChild(this.createBackgroundNode(b,d));var e=this.createGroundNode(-50000,-50000,100000,100000,b,d);a.addChild(e);a.addChild(this.createHomeTree(b,d));this.sceneLights=this.createLights(b);for(var c=0;c<this.sceneLights.length;c++){a.addChild(this.sceneLights[c])}return a};HomeComponent3D.prototype.createBackgroundNode=function(e,f){var k=new Appearance3D();var d=this.createHalfSphereGeometry(true);var b=new Shape3D(d,k);var c=new BranchGroup3D();c.addChild(b);c.addChild(new Shape3D(this.createHalfSphereGeometry(false)));var h=new Appearance3D();var g=new Shape3D(new IndexedTriangleArray3D([vec3.fromValues(-1,-0.01,-1),vec3.fromValues(-1,-0.01,1),vec3.fromValues(1,-0.01,1),vec3.fromValues(1,-0.01,-1)],[0,1,2,0,2,3],[],[],[vec3.fromValues(0,1,0)],[0,0,0,0,0,0]),h);c.addChild(g);var a=new Background3D(c);this.updateBackgroundColorAndTexture(k,h,this.home,f);h.setVisible(this.home.getCamera().getZ()>=0);if(e){var j=this;this.backgroundChangeListener=function(l){j.updateBackgroundColorAndTexture(k,h,j.home,f)};j.home.getEnvironment().addPropertyChangeListener("SKY_COLOR",this.backgroundChangeListener);j.home.getEnvironment().addPropertyChangeListener("SKY_TEXTURE",this.backgroundChangeListener);j.home.getEnvironment().addPropertyChangeListener("GROUND_COLOR",this.backgroundChangeListener);j.home.getEnvironment().addPropertyChangeListener("GROUND_TEXTURE",this.backgroundChangeListener);this.elevationChangeListener=function(l){if(l.getSource()===j.home){l.getOldValue().removePropertyChangeListener(j.elevationChangeListener);j.home.getCamera().addPropertyChangeListener(j.elevationChangeListener)}if(l.getSource()===j.home||l.getPropertyName()==="Z"){h.setVisible(j.home.getCamera().getZ()>=0)}};this.home.getCamera().addPropertyChangeListener(this.elevationChangeListener);this.home.addPropertyChangeListener("CAMERA",this.elevationChangeListener)}return a};HomeComponent3D.prototype.createHalfSphereGeometry=function(l){var x=48;var q=[];var e=[];var r=[];for(var t=0,n=0;t<x;t++){var b=t*2*Math.PI/x;var g=Math.cos(b);var m=Math.sin(b);var d=(t+1)*2*Math.PI/x;var c=Math.cos(d);var v=Math.sin(d);for(var o=0,s=x/4;o<s;o++,n+=4){var w=2*o*Math.PI/x;var u=Math.cos(w);var z=Math.sin(w);var h=o!==0?(l?z:-z):-0.01;var f=2*(o+1)*Math.PI/x;if(!l){f=-f}var a=Math.cos(f);var p=Math.sin(f);q.push(vec3.fromValues(g*u,h,m*u));q.push(vec3.fromValues(c*u,h,v*u));q.push(vec3.fromValues(c*a,p,v*a));q.push(vec3.fromValues(g*a,p,m*a));if(l){e.push(n);e.push(n+1);e.push(n+2);e.push(n);e.push(n+2);e.push(n+3);r.push(vec2.fromValues(t/x,o/s));r.push(vec2.fromValues((t+1)/x,o/s));r.push(vec2.fromValues((t+1)/x,(o+1)/s));r.push(vec2.fromValues(t/x,(o+1)/s))}else{e.push(n);e.push(n+2);e.push(n+1);e.push(n);e.push(n+3);e.push(n+2)}}}return new IndexedTriangleArray3D(q,e,r,e,[],[])};HomeComponent3D.prototype.updateBackgroundColorAndTexture=function(j,g,f,e){var h=f.getEnvironment().getSkyColor();j.setDiffuseColor(vec3.fromValues(((h>>>16)&255)/255,((h>>>8)&255)/255,(h&255)/255));var k=f.getEnvironment().getSkyTexture();if(k!==null){var a=mat3.create();mat3.fromTranslation(a,vec2.fromValues(-k.getXOffset(),0));TextureManager.getInstance().loadTexture(k.getImage(),0,e,{textureUpdated:function(l){j.setTextureImage(l);j.setTextureTransform(a)},textureError:function(l){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}else{j.setTextureImage(null)}var c=f.getEnvironment().getGroundColor();var d=vec3.fromValues(((c>>>16)&255)/255,((c>>>8)&255)/255,(c&255)/255);g.setDiffuseColor(d);g.setAmbientColor(d);var b=f.getEnvironment().getGroundTexture();if(b!==null){TextureManager.getInstance().loadTexture(b.getImage(),0,e,{textureUpdated:function(l){g.setTextureImage(l);g.setTextureCoordinatesGeneration({planeS:vec4.fromValues(100000,0,0,0),planeT:vec4.fromValues(0,0,100000,0)})},textureError:function(l){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}else{g.setTextureImage(null)}};HomeComponent3D.prototype.createGroundNode=function(g,f,b,c,d,e){if(this.home.structure){var l=new BranchGroup3D();l.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);ModelManager.getInstance().loadModel(this.home.structure,e,{modelUpdated:function(m){l.addChild(m)},modelError:function(m){var n=new Appearance3D();n.setDiffuseColor(vec3.fromValues(1,0,0));l.addChild(new Box3D(10000000,0,10000000,n))}});this.groundChangeListener=function(m){};return l}else{var k=typeof Ground3D!=="undefined"?new Ground3D(this.home,g,f,b,c,e):new Box3D(10000000,0,10000000,new Appearance3D());var a=mat4.create();mat4.translate(a,a,vec3.fromValues(0,-0.2,0));var j=new TransformGroup3D(a);j.addChild(k);if(d){this.groundChangeListener=function(n){if(!this.updater){var m=this;this.updater=function(){k.update();delete m.updater};setTimeout(this.updater,0)}};var h=this.home.getEnvironment();h.addPropertyChangeListener("GROUND_COLOR",this.groundChangeListener);h.addPropertyChangeListener("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",this.groundChangeListener);h.addPropertyChangeListener("GROUND_TEXTURE",this.groundChangeListener);this.home.addPropertyChangeListener("BACKGROUND_IMAGE",this.groundChangeListener)}return j}};HomeComponent3D.prototype.createLights=function(b){var c=[new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(1.5,-0.8,-1)),new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(-1.5,-0.8,-1)),new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(0,-0.8,1)),new DirectionalLight3D(vec3.fromValues(0.7,0.7,0.7),vec3.fromValues(0,1,0)),new AmbientLight3D(vec3.fromValues(0.2,0.2,0.2))];for(var d=0;d<c.length-1;d++){c[d].defaultColor=c[d].getColor();this.updateLightColor(c[d])}if(b){var a=this;this.lightColorListener=function(f){for(var e=0;e<c.length-1;e++){a.updateLightColor(c[e])}};this.home.getEnvironment().addPropertyChangeListener("LIGHT_COLOR",this.lightColorListener)}return c};HomeComponent3D.prototype.updateLightColor=function(b){var c=b.defaultColor;var a=this.home.getEnvironment().getLightColor();b.setColor(vec3.fromValues(((a>>>16)&255)/255*c[0],((a>>>8)&255)/255*c[1],(a&255)/255*c[2]))};HomeComponent3D.prototype.createHomeTree=function(h,k){var a=new BranchGroup3D();a.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);var l=this.home.getLabels();for(var g=0;g<l.length;g++){this.addObject(a,l[g],h,k)}var e=this.home.getPolylines();for(var g=0;g<e.length;g++){this.addObject(a,e[g],h,k)}var d=this.home.getRooms();for(var g=0;g<d.length;g++){this.addObject(a,d[g],h,k)}var b=this.home.getWalls();for(var g=0;g<b.length;g++){this.addObject(a,b[g],h,k)}var m=this.home.getFurniture();for(var g=0;g<m.length;g++){var o=m[g];if(o instanceof HomeFurnitureGroup){var c=o.getAllFurniture();for(var f=0;f<c.length;f++){var n=c[f];if(!(n instanceof HomeFurnitureGroup)){this.addObject(a,n,h,k)}}}else{this.addObject(a,o,h,k)}}if(h){this.addLevelListener(a);this.addWallListener(a);this.addFurnitureListener(a);this.addRoomListener(a);this.addPolylineListener(a);this.addLabelListener(a);this.addEnvironmentListeners()}return a};HomeComponent3D.prototype.addLevelListener=function(d){var a=this;this.levelChangeListener=function(h){var e=h.getPropertyName();if("VISIBLE"==e||"VIEWABLE"==e){var j=a.homeObjects;var k=[];for(var f=0;f<j.length;f++){var g=j[f];if(g instanceof Room||g.isAtLevel!==undefined||g.isAtLevel(h.getSource())){k.push(g)}}a.updateObjects(k);a.groundChangeListener(null)}else{if("ELEVATION"==e){a.updateObjects(a.homeObjects.slice(0));a.groundChangeListener(null)}else{if("BACKGROUND_IMAGE"==e){a.groundChangeListener(null)}else{if("FLOOR_THICKNESS"==e){a.updateObjects(a.home.getWalls());a.updateObjects(a.home.getRooms())}else{if("HEIGHT"==e){a.updateObjects(a.home.getRooms())}}}}}};var c=this.home.getLevels();for(var b=0;b<c.length;b++){c[b].addPropertyChangeListener(this.levelChangeListener)}this.levelListener=function(e){var f=e.getItem();switch((e.getType())){case CollectionEvent.Type.ADD:f.addPropertyChangeListener(a.levelChangeListener);break;case CollectionEvent.Type.DELETE:f.removePropertyChangeListener(a.levelChangeListener);break}a.updateObjects(a.home.getRooms())};this.home.addLevelsListener(this.levelListener)};HomeComponent3D.prototype.addWallListener=function(d){var a=this;this.wallChangeListener=function(g){var f=g.getPropertyName();if("PATTERN"!=f){var e=g.getSource();a.updateWall(e);var h=a.home.getLevels();if(e.getLevel()===null||e.isAtLevel(h[h.length-1])){a.updateObjects(a.home.getRooms())}if(e.getLevel()!=null&&e.getLevel().getElevation()<0){a.groundChangeListener(null)}}};var b=this.home.getWalls();for(var c=0;c<b.length;c++){b[c].addPropertyChangeListener(this.wallChangeListener)}this.wallListener=function(f){var e=f.getItem();switch((f.getType())){case CollectionEvent.Type.ADD:a.addObject(d,e,true,false);e.addPropertyChangeListener(a.wallChangeListener);break;case CollectionEvent.Type.DELETE:a.deleteObject(e);e.removePropertyChangeListener(a.wallChangeListener);break}a.updateObjects(a.home.getRooms());a.groundChangeListener(null)};this.home.addWallsListener(this.wallListener)};HomeComponent3D.prototype.addFurnitureListener=function(e){var a=this;var c=function(j,g,h){a.updateObjects([j]);if(a.containsDoorsAndWindows(j)){if(h!==null){var f=j.clone();if("X"==g){f.setX(h)}else{if("Y"==g){f.setY(h)}else{if("ANGLE"==g){f.setAngle(h)}else{if("WIDTH"==g){f.setWidth(h)}else{if("DEPTH"==g){f.setDepth(h)}}}}}a.updateIntersectingWalls([f,j])}else{a.updateIntersectingWalls([j])}a.updateObjects(a.home.getWalls())}else{if(a.containsStaircases(j)){a.updateObjects(a.home.getRooms())}}if(j.getLevel()!==null&&j.getLevel().getElevation()<0){a.groundChangeListener(null)}};this.furnitureChangeListener=function(h){var f=h.getSource();var g=h.getPropertyName();if("X"==g||"Y"==g||"ANGLE"==g||"ROLL"==g||"PITCH"==g||"WIDTH"==g||"DEPTH"==g){c(f,g,h.getOldValue())}else{if("HEIGHT"==g||"ELEVATION"==g||"MODEL"==g||"MODEL_ROTATION"==g||"MODEL_MIRRORED"==g||"BACK_FACE_SHOWN"==g||"MODEL_TRANSFORMATIONS"==g||"STAIRCASE_CUT_OUT_SHAPE"==g||"VISIBLE"==g||"LEVEL"==g){c(f,null,null)}else{if("CUT_OUT_SHAPE"==g||"WALL_CUT_OUT_ON_BOTH_SIDES"==g||"WALL_WIDTH"==g||"WALL_LEFT"==g||"WALL_HEIGHT"==g||"WALL_TOP"==g){if(a.containsDoorsAndWindows(f)){a.updateIntersectingWalls([f])}}else{if("COLOR"==g||"TEXTURE"==g||"MODEL_MATERIALS"==g||"SHININESS"==g||("POWER"==g&&a.home.getEnvironment().getSubpartSizeUnderLight()>0)){a.updateObjects([f])}}}}};var d=this.home.getFurniture();for(var b=0;b<d.length;b++){this.addPropertyChangeListener(d[b],this.furnitureChangeListener)}this.furnitureListener=function(g){var f=g.getItem();switch(g.getType()){case CollectionEvent.Type.ADD:a.addPieceOfFurniture(e,f,true,false);a.addPropertyChangeListener(f,a.furnitureChangeListener);break;case CollectionEvent.Type.DELETE:a.deletePieceOfFurniture(f);a.removePropertyChangeListener(f,a.furnitureChangeListener);break}if(a.containsDoorsAndWindows(f)){a.updateIntersectingWalls([f])}else{if(a.containsStaircases(f)){a.updateObjects(a.home.getRooms())}else{approximateHomeBoundsCache=null}}a.groundChangeListener(null)};this.home.addFurnitureListener(this.furnitureListener)};HomeComponent3D.prototype.addPropertyChangeListener=function(b,d){if(b instanceof HomeFurnitureGroup){var c=b.getFurniture();for(var a=0;a<c.length;a++){this.addPropertyChangeListener(c[a],d)}}else{b.addPropertyChangeListener(d)}};HomeComponent3D.prototype.removePropertyChangeListener=function(b,d){if(b instanceof HomeFurnitureGroup){var c=b.getFurniture();for(var a=0;a<c.length;a++){this.removePropertyChangeListener(c[a],d)}}else{b.removePropertyChangeListener(d)}};HomeComponent3D.prototype.containsDoorsAndWindows=function(b){if(b instanceof HomeFurnitureGroup){var c=b.getFurniture();for(var a=0;a<c.length;a++){if(this.containsDoorsAndWindows(c[a])){return true}}return false}else{return b.isDoorOrWindow()}};HomeComponent3D.prototype.containsStaircases=function(b){if(b instanceof HomeFurnitureGroup){var c=b.getFurniture();for(var a=0;a<c.length;a++){if(this.containsStaircases(c[a])){return true}}return false}else{return b.getStaircaseCutOutShape()!==null}};HomeComponent3D.prototype.addRoomListener=function(c){var a=this;this.roomChangeListener=function(o){var p=o.getSource();var m=o.getPropertyName();if("FLOOR_COLOR"==m||"FLOOR_TEXTURE"==m||"FLOOR_SHININESS"==m||"CEILING_COLOR"==m||"CEILING_TEXTURE"==m||"CEILING_SHININESS"==m){a.updateObjects([p])}else{if("FLOOR_VISIBLE"==m||"CEILING_VISIBLE"==m||"LEVEL"==m){a.updateObjects(a.home.getRooms());a.groundChangeListener(null)}else{if("POINTS"==m){if(a.homeObjectsToUpdate){a.updateObjects(a.home.getRooms())}else{a.updateObjects([p]);var f=new java.awt.geom.Area(a.getShape(o.getOldValue()));var n=new java.awt.geom.Area(a.getShape(o.getNewValue()));var j=p.getLevel();var h=a.home.getRooms();for(var k=0;k<h.length;k++){var e=h[k];var q=e.getLevel();if(e!=p&&(q==null||Math.abs(j.getElevation()+j.getHeight()-(q.getElevation()+q.getHeight()))<0.00001||Math.abs(j.getElevation()+j.getHeight()-(q.getElevation()-q.getFloorThickness()))<0.00001)){var l=new java.awt.geom.Area(a.getShape(e.getPoints()));var g=new java.awt.geom.Area(l);g.intersect(n);if(!g.isEmpty()){a.updateObjects([e])}else{l.intersect(f);if(!l.isEmpty()){a.updateObjects([e])}}}}}a.groundChangeListener(null)}}}};var d=this.home.getRooms();for(var b=0;b<d.length;b++){d[b].addPropertyChangeListener(this.roomChangeListener)}this.roomListener=function(e){var f=e.getItem();switch(e.getType()){case CollectionEvent.Type.ADD:a.addObject(c,f,e.getIndex(),true,false);f.addPropertyChangeListener(a.roomChangeListener);break;case CollectionEvent.Type.DELETE:a.deleteObject(f);f.removePropertyChangeListener(a.roomChangeListener);break}a.updateObjects(a.home.getRooms());a.groundChangeListener(null)};this.home.addRoomsListener(this.roomListener)};HomeComponent3D.prototype.getShape=function(b){var c=new java.awt.geom.GeneralPath();c.moveTo(b[0][0],b[0][1]);for(var a=1;a<b.length;a++){c.lineTo(b[a][0],b[a][1])}c.closePath();return c};HomeComponent3D.prototype.addPolylineListener=function(d){var a=this;this.polylineChangeListener=function(f){var e=f.getSource();a.updateObjects([e])};var c=this.home.getPolylines();for(var b=0;b<c.length;b++){c[b].addPropertyChangeListener(this.polylineChangeListener)}this.polylineListener=function(f){var e=f.getItem();switch(f.getType()){case CollectionEvent.Type.ADD:a.addObject(d,e,true,false);e.addPropertyChangeListener(a.polylineChangeListener);break;case CollectionEvent.Type.DELETE:a.deleteObject(e);e.removePropertyChangeListener(a.polylineChangeListener);break}};this.home.addPolylinesListener(this.polylineListener)};HomeComponent3D.prototype.addLabelListener=function(c){var a=this;this.labelChangeListener=function(f){var e=f.getSource();a.updateObjects([e])};var d=this.home.getLabels();for(var b=0;b<d.length;b++){d[b].addPropertyChangeListener(this.labelChangeListener)}this.labelListener=function(f){var e=f.getItem();switch(f.getType()){case CollectionEvent.Type.ADD:a.addObject(c,e,true,false);e.addPropertyChangeListener(a.labelChangeListener);break;case CollectionEvent.Type.DELETE:a.deleteObject(e);e.removePropertyChangeListener(a.labelChangeListener);break}};this.home.addLabelsListener(this.labelListener)};HomeComponent3D.prototype.addEnvironmentListeners=function(){var a=this;this.wallsAlphaListener=function(b){a.updateObjects(a.home.getWalls());a.updateObjects(a.home.getRooms())};this.home.getEnvironment().addPropertyChangeListener("WALLS_ALPHA",this.wallsAlphaListener)};HomeComponent3D.prototype.addObject=function(e,b,c,a,d){if(d===undefined){d=a;a=c;c=-1}var f=this.object3dFactory.createObject3D(this.home,b,d);if(a){b.object3D=f;this.homeObjects.push(b);this.homeObjects3D.push(f)}if(c===-1){e.addChild(f)}else{e.insertChild(f,c)}return f};HomeComponent3D.prototype.addPieceOfFurniture=function(f,c,a,e){if(c instanceof HomeFurnitureGroup){var d=c.getFurniture();for(var b=0;b<d.length;b++){this.addPieceOfFurniture(f,d[b],a,e)}}else{this.addObject(f,c,a,e)}};HomeComponent3D.prototype.deleteObject=function(a){if(a.object3D){a.object3D.detach();delete a.object3D;var c=this.homeObjects.indexOf(a);this.homeObjects.splice(c,1);this.homeObjects3D.splice(c,1);if(this.homeObjectsToUpdate){var b=this.homeObjectsToUpdate.indexOf(a);if(b>=0){this.homeObjectsToUpdate.splice(b,1)}}}};HomeComponent3D.prototype.deletePieceOfFurniture=function(b){if(b instanceof HomeFurnitureGroup){var c=b.getFurniture();for(var a=0;a<c.length;a++){this.deletePieceOfFurniture(c[a])}}else{this.deleteObject(b)}};HomeComponent3D.prototype.updateObjects=function(c){if(this.homeObjectsToUpdate){for(var b=0;b<c.length;b++){var a=c[b];if(this.homeObjectsToUpdate.indexOf(a)<=-1){this.homeObjectsToUpdate.push(a)}}}else{this.homeObjectsToUpdate=c.slice(0);setTimeout(function(e){for(var f=0;f<e.homeObjectsToUpdate.length;f++){var d=e.homeObjectsToUpdate[f];if(d.object3D){d.object3D.update()}}delete e.homeObjectsToUpdate},0,this)}this.approximateHomeBoundsCache=null};HomeComponent3D.prototype.updateIntersectingWalls=function(e){var b=this.home.getWalls();var a=0;if(this.homeObjectsToUpdate){for(var d=0;d<this.homeObjectsToUpdate.length;d++){if(this.homeObjectsToUpdate[d] instanceof Wall){a++}}}if(a!==b.length){var l=[];var g=null;for(var d=0;d<e.length;d++){var k=e[d];var h=k.getPoints();if(g===null){g=new java.awt.geom.Rectangle2D.Float(h[0][0],h[0][1],0,0)}else{g.add(h[0][0],h[0][1])}for(var c=1;c<h.length;c++){g.add(h[c][0],h[c][1])}}for(var d=0;d<b.length;d++){var f=b[d];if(f.intersectsRectangle(g.getX(),g.getY(),g.getX()+g.getWidth(),g.getY()+g.getHeight())){l.push(f)}}this.updateObjects(l)}};HomeComponent3D.prototype.updateWall=function(b){var a=[];a.push(b);if(b.getWallAtStart()!=null){a.push(b.getWallAtStart())}if(b.getWallAtEnd()!=null){a.push(b.getWallAtEnd())}this.updateObjects(a)};function Object3DBranchFactory(){}Object3DBranchFactory.prototype.createObject3D=function(c,a,b){if(a instanceof HomePieceOfFurniture){return new HomePieceOfFurniture3D(a,c,b)}else{if(a instanceof Wall){return new Wall3D(a,c,b)}else{if(a instanceof Room){return new Room3D(a,c,false,b)}else{if(a instanceof Polyline){return new Polyline3D(a,c)}else{if(a instanceof Label){return new Label3D(a,c,b)}else{return new Group3D()}}}}}};function Object3DBranch(){BranchGroup3D.call(this)}Object3DBranch.prototype=Object.create(BranchGroup3D.prototype);Object3DBranch.prototype.constructor=Object3DBranch;Object3DBranch.DEFAULT_COLOR=16777215;Object3DBranch.DEFAULT_AMBIENT_COLOR=3355443;Object3DBranch.prototype.getShape=function(a){return ShapeTools.getShape(a,true,null)};Object3DBranch.prototype.updateAppearanceMaterial=function(a,d,b,c){if(d!==null){a.setAmbientColor(vec3.fromValues(((b>>>16)&255)/255,((b>>>8)&255)/255,(b&255)/255));a.setDiffuseColor(vec3.fromValues(((d>>>16)&255)/255,((d>>>8)&255)/255,(d&255)/255));a.setSpecularColor(vec3.fromValues(c,c,c));a.setShininess(Math.max(1,c*128))}else{a.setAmbientColor(vec3.fromValues(0.2,0.2,0.2));a.setDiffuseColor(vec3.fromValues(1,1,1));a.setSpecularColor(vec3.fromValues(c,c,c));a.setShininess(Math.max(1,c*128))}};Object3DBranch.prototype.updateTextureTransform=function(e,g,c){var f=g.getWidth();var k=g.getHeight();if(f===-1||k===-1){f=100;k=100}var j=g.getXOffset();var d=g.getYOffset();var h=1/g.getScale();var l=mat3.create();mat3.rotate(l,l,g.getAngle());var a=mat3.create();var b=mat3.create();if(c){mat3.fromTranslation(a,vec2.fromValues(-j/h*f,-d/h*k));mat3.scale(b,b,vec2.fromValues(h/f,h/k))}else{mat3.fromTranslation(a,vec2.fromValues(-j/h,-d/h));mat3.multiplyScalar(b,b,h)}mat3.mul(l,l,a);mat3.mul(b,b,l);e.setTextureTransform(b)};Object3DBranch.prototype.getAreaPoints=function(t,a,C,e,M){if(e===undefined&&M===undefined){e=a;M=C;a=null;C=null}var p=[];var x=[];var s=null;var Q=null;for(var r=t.getPathIterator(null,e);!r.isDone();r.next()){var u=[0,0];switch((r.currentSegment(u))){case java.awt.geom.PathIterator.SEG_MOVETO:s=[];s.push(u);Q=u;break;case java.awt.geom.PathIterator.SEG_LINETO:if(u[0]!==Q[0]||u[1]!==Q[1]){s.push(u)}Q=u;break;case java.awt.geom.PathIterator.SEG_CLOSE:var n=s[0];if(n[0]===Q[0]&&n[1]===Q[1]){s.splice(s.length-1,1)}if(s.length>2){var G=s;var f=new Room(G);if(f.getArea()>0){var P=f.isClockwise();if(P){x.push(s)}else{p.push(s)}if(a!==null||C!==null){if(P!==M){G=s.slice(0);G.reverse()}if(P){if(C!=null){C.push(G)}}else{if(a!=null){a.push(G)}}}}}break}}var J=[];if((x.length===0)&&a!==null){J.push.apply(J,a)}else{if((p.length===0)&&!(x.length===0)){if(C!==null){C.length=0}}else{var m;var g=[];if(p.length>1){m=[];for(var L=0;p.length!==0;){var y=p[L];var K=0;for(;K<p.length;K++){if(L!==K){var O=p[K];var h=null;for(var I=0;I<g.length;I++){if(g[I].key===O){h=g[I].value;break}}if(h==null){h=new java.awt.geom.Area(this.getShape(O.slice(0)));g.push({key:O,value:h})}if(h.contains(y[0][0],y[0][1])){break}}}if(K===p.length){p.splice(L,1);m.push(y);L=0}else{if(L<p.length){L++}else{L=0}}}}else{m=p}for(var L=m.length-1;L>=0;L--){var D=m[L];var h=null;for(var I=0;I<g.length;I++){if(g[I].key===D){h=g[I].value;break}}if(h===null){h=new java.awt.geom.Area(this.getShape(D.slice(0)))}var E=[];for(var I=0;I<x.length;I++){var F=x[I];if(h.contains(F[0][0],F[0][1])){E.push(F)}}var v=null;while(E.length!==0){var c=Number.MAX_VALUE;var z=0;var w=0;var N=0;for(var K=0;K<E.length&&c>0;K++){var F=E[K];for(var I=0;I<F.length&&c>0;I++){for(var H=0;H<D.length&&c>0;H++){var q=D[H];var o=java.awt.geom.Point2D.distanceSq(F[I][0],F[I][1],q[0],q[1]);if(o<c&&v!==q){c=o;z=K;w=I;N=H}}}}var d=E[z];if(c!==0){v=D[N];D.splice(N,0,v);D.splice(++N,0,d[w])}var B=d.slice(w,d.length);for(var I=0;I<B.length;I++,N++){D.splice(N,0,B[I])}var A=d.slice(0,w);for(var I=0;I<A.length;I++,N++){D.splice(N,0,A[I])}E.splice(z,1);x.splice(d,1)}}for(var I=0;I<m.length;I++){var b=m[I];if(M){b.reverse()}J.push(b.slice(0))}}}return J};Object3DBranch.areModelRotationsEqual=function(a,d){if(a===d){return true}else{if(a==null||d==null){return false}else{for(var c=0;c<a.length;c++){for(var b=0;b<d.length;b++){if(a[c][b]!==d[c][b]){return false}}}return true}}};function HomePieceOfFurniture3D(a,c,b){Object3DBranch.call(this);this.setUserData(a);this.home=c;this.createPieceOfFurnitureNode(a,b)}HomePieceOfFurniture3D.prototype=Object.create(Object3DBranch.prototype);HomePieceOfFurniture3D.prototype.constructor=HomePieceOfFurniture3D;HomePieceOfFurniture3D.DEFAULT_BOX=new Object();HomePieceOfFurniture3D.prototype.createPieceOfFurnitureNode=function(b,c){var a=new TransformGroup3D();a.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);a.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);this.addChild(a);this.loadPieceOfFurnitureModel(c)};HomePieceOfFurniture3D.prototype.loadPieceOfFurnitureModel=function(f){var c=new BranchGroup3D();var a=new TransformGroup3D();a.addChild(this.getModelBox(vec3.fromValues(1,1,1)));a.setUserData(PieceOfFurniture.IDENTITY_ROTATION);c.addChild(a);var e=this.getChild(0);e.removeAllChildren();e.addChild(c);this.updatePieceOfFurnitureTransform();var d=this.getUserData();var b=d.getModel();e.setUserData(b);var g=this;ModelManager.getInstance().loadModel(b,typeof f=="function"?false:f,{modelUpdated:function(k){g.updateModelTransformations(k);var j=d.getModelRotation();var h=ModelManager.getInstance().getNormalizedTransformGroup(k,j,1,d.isModelCenteredAtOrigin());h.setUserData(j);g.updatePieceOfFurnitureModelNode(k,h,f)},modelError:function(h){g.updatePieceOfFurnitureModelNode(g.getModelBox(vec3.fromValues(1,0,0)),new TransformGroup3D(),f)}})};HomePieceOfFurniture3D.prototype.update=function(){if(this.isVisible()){var b=this.getUserData();var c=this.getChild(0);var a=c.getChild(0).getChild(0);if(b.getModel().equals(c.getUserData())&&Object3DBranch.areModelRotationsEqual(b.getModelRotation(),a.getUserData())){this.updatePieceOfFurnitureModelTransformations();this.updatePieceOfFurnitureTransform();this.updatePieceOfFurnitureColorAndTexture(false)}else{this.loadPieceOfFurnitureModel(false)}}this.updatePieceOfFurnitureVisibility()};HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureTransform=function(){var a=this.getChild(0);var b=ModelManager.getInstance().getPieceOfFurnitureNormalizedModelTransformation(this.getUserData(),a.getChild(0));a.setTransform(b)};HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureColorAndTexture=function(d){var c=this.getUserData();var a=this.getModelNode();var b=a.getChild(0);if(b.getUserData()!==HomePieceOfFurniture3D.DEFAULT_BOX){if(c.getColor()!==null){this.setColorAndTexture(a,c.getColor(),null,c.getShininess(),null,c.isModelMirrored(),c.isBackFaceShown(),false,null,null,[])}else{if(c.getTexture()!==null){this.setColorAndTexture(a,null,c.getTexture(),c.getShininess(),null,c.isModelMirrored(),c.isBackFaceShown(),d,vec3.fromValues(c.getWidth(),c.getHeight(),c.getDepth()),ModelManager.getInstance().getBounds(b),[])}else{if(c.getModelMaterials()!==null){this.setColorAndTexture(a,null,null,null,c.getModelMaterials(),c.isModelMirrored(),c.isBackFaceShown(),d,vec3.fromValues(c.getWidth(),c.getHeight(),c.getDepth()),ModelManager.getInstance().getBounds(b),[])}else{this.setColorAndTexture(a,null,null,c.getShininess(),null,c.isModelMirrored(),c.isBackFaceShown(),false,null,null,[])}}}}};HomePieceOfFurniture3D.prototype.getModelNode=function(){var a=this.getChild(0);var b=a.getChild(0);return b.getChild(0)};HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureVisibility=function(){var b=this.getUserData();var c=this.isVisible();var a=b.getColor()===null&&b.getTexture()===null?b.getModelMaterials():null;this.setVisible(this.getModelNode(),c,a)};HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureModelTransformations=function(){var b=this.getUserData();var a=this.getModelNode();if(a.getChild(0).getUserData()!==HomePieceOfFurniture3D.DEFAULT_BOX&&this.updateModelTransformations(this)){var c=ModelManager.getInstance().getNormalizedTransform(a.getChild(0),b.getModelRotation(),1,b.isModelCenteredAtOrigin());a.setTransform(c)}};HomePieceOfFurniture3D.prototype.updateModelTransformations=function(g){var e=false;var b=this.getUserData().getModelTransformations();var a=null;if(b!==null){for(var d=0;d<b.length;d++){var f=b[d];var c=f.getName()+ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX;if(a===null){a=[]}a.push(c);e|=this.updateTransformation(g,c,f.getMatrix())}}e|=this.setNotUpdatedTranformationsToIdentity(g,a);return e};HomePieceOfFurniture3D.prototype.updateTransformation=function(f,g,a){var e=false;if(f instanceof Group3D){if(f instanceof TransformGroup3D&&g==f.getName()){var b=mat4.create();f.getTransform(b);if(a[0][0]!==b[0]||a[0][1]!==b[4]||a[0][2]!==b[8]||a[0][3]!==b[12]||a[1][0]!==b[1]||a[1][1]!==b[5]||a[1][2]!==b[9]||a[1][3]!==b[13]||a[2][0]!==b[2]||a[2][1]!==b[6]||a[2][2]!==b[10]||a[2][3]!==b[14]){mat4.set(b,a[0][0],a[1][0],a[2][0],0,a[0][1],a[1][1],a[2][1],0,a[0][2],a[1][2],a[2][2],0,a[0][3],a[1][3],a[2][3],1);f.setTransform(b);e=true}}else{var d=f.getChildren();for(var c=0;c<d.length;c++){e|=this.updateTransformation(d[c],g,a)}}}return e};HomePieceOfFurniture3D.prototype.setNotUpdatedTranformationsToIdentity=function(f,a){var e=false;if(f instanceof Group3D){if(f instanceof TransformGroup3D&&f.getName()!==null&&f.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)>=0&&f.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)===f.getName().length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length&&(a===null||a.indexOf(f.getName())<0)){var g=f;var b=mat4.create();g.getTransform(b);if(!TransformGroup3D.isIdentity(b)){mat4.identity(b);g.setTransform(b);e=true}}var d=f.getChildren();for(var c=0;c<d.length;c++){e|=this.setNotUpdatedTranformationsToIdentity(d[c],a)}}return e};HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureModelNode=function(b,a,f){a.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);a.addChild(b);var d=new BranchGroup3D();d.addChild(a);var c=this.getUserData();if(c.isDoorOrWindow()){this.setTransparentShapeNotPickable(b)}var e=this.getChild(0);e.removeAllChildren();e.addChild(d);if(c.isHorizontallyRotated()){this.updatePieceOfFurnitureTransform()}if(c.isBackFaceShown()){this.setBackFaceNormalFlip(this.getModelNode(),true)}this.modifiedTexturesCount=0;this.updatePieceOfFurnitureColorAndTexture(f);this.updatePieceOfFurnitureVisibility();if(this.modifiedTexturesCount===0&&typeof f=="function"){f(this)}};HomePieceOfFurniture3D.prototype.getModelBox=function(a){var c=new Appearance3D();c.setDiffuseColor(a);c.setAmbientColor(vec3.scale(vec3.create(),a,0.7));var b=new Box3D(0.5,0.5,0.5,c);b.setUserData(HomePieceOfFurniture3D.DEFAULT_BOX);return b};HomePieceOfFurniture3D.prototype.setColorAndTexture=function(s,u,o,t,c,h,x,l,A,d,z){if(s instanceof Group3D){var e=s.getChildren();for(var w=0;w<e.length;w++){this.setColorAndTexture(e[w],u,o,t,c,h,x,l,A,d,z)}}else{if(s instanceof Link3D){this.setColorAndTexture(s.getSharedGroup(),u,o,t,c,h,x,l,A,d,z)}else{if(s instanceof Shape3D){var b=s;var v=b.getName();var n=b.getAppearance();if(n===null){n=new Appearance3D();s.setAppearance(n)}if(z.indexOf(n)===-1){var a=null;var y=u!==null;var q=!y&&o!==null;var g=!y&&!q&&c!==null&&c.length>0;var k=y||q||g||t!==null||h||x;var r=v!==null&&v.indexOf(ModelManager.WINDOW_PANE_SHAPE_PREFIX)===0;if(!r&&k||r&&g){if(n.defaultAppearance===undefined){n.defaultAppearance=n.clone()}a=n.defaultAppearance}var f=0;if(k){f=t!==null?t:(n.getSpecularColor()!==undefined&&n.getShininess()!==undefined?n.getShininess()/128:0)}if(y){if(r){this.restoreDefaultAppearance(n,null)}else{this.updateAppearanceMaterial(n,u,u,f);if(a.getTransparency()!==undefined){n.setTransparency(a.getTransparency())}if(a.getCullFace()!==undefined){n.setCullFace(a.getCullFace())}n.setTextureCoordinatesGeneration(a.getTextureCoordinatesGeneration());n.setTextureImage(null)}}else{if(q){if(r){this.restoreDefaultAppearance(n,null)}else{n.setTextureCoordinatesGeneration(this.getTextureCoordinates(n,o,A,d));this.updateTextureTransform(n,o,true);this.updateAppearanceMaterial(n,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,f);TextureManager.getInstance().loadTexture(o.getImage(),0,typeof l=="function"?false:l,this.getTextureObserver(n,h,x,l))}}else{if(g){var p=false;for(var w=0;w<c.length;w++){var m=c[w];if(m!==null&&(m.getKey()!=null&&m.getKey()==n.getName()||m.getKey()==null&&m.getName()==n.getName())){if(m.getShininess()!==null){f=m.getShininess()}u=m.getColor();if(u!==null&&(u&4278190080)!=0){this.updateAppearanceMaterial(n,u,u,f);if(a.getTransparency()!==undefined){n.setTransparency(a.getTransparency())}if(a.getCullFace()!==undefined){n.setCullFace(a.getCullFace())}n.setTextureImage(null)}else{if(u===null&&m.getTexture()!==null){var j=m.getTexture();if(this.isTexturesCoordinatesDefined(b)){this.restoreDefaultTextureCoordinatesGeneration(n);this.updateTextureTransform(n,j)}else{n.setTextureCoordinatesGeneration(this.getTextureCoordinates(n,m.getTexture(),A,d));this.updateTextureTransform(n,j,true)}this.updateAppearanceMaterial(n,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,f);var j=m.getTexture();TextureManager.getInstance().loadTexture(j.getImage(),0,typeof l=="function"?false:l,this.getTextureObserver(n,h,x,l))}else{this.restoreDefaultAppearance(n,m.getShininess())}}p=true;break}}if(!p){this.restoreDefaultAppearance(n,null)}}else{this.restoreDefaultAppearance(n,t)}}}this.setCullFace(n,h,x);z.push(n)}}}}};HomePieceOfFurniture3D.prototype.getTextureObserver=function(a,d,e,c){var b=this;this.modifiedTexturesCount++;return{textureUpdated:function(f){if(TextureManager.getInstance().isTextureTransparent(f)){a.setCullFace(Appearance3D.CULL_NONE)}else{var g=a.defaultAppearance;if(g!==null&&g.getCullFace()!==null){a.setCullFace(g.getCullFace())}}if(a.getTextureImage()!==f){a.setTextureImage(f)}b.setCullFace(a,d,e);if(--b.modifiedTexturesCount===0&&typeof c=="function"){c(b)}},textureError:function(f){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}}};HomePieceOfFurniture3D.prototype.getTextureCoordinates=function(g,h,d,l){var e=vec3.create();l.getLower(e);var m=vec3.create();l.getUpper(m);var a=ModelManager.getInstance().getMinimumSize();var j=d[0]/Math.max(m[0]-e[0],a);var k=-e[0]*j;var c=d[1]/Math.max(m[1]-e[1],a);var b=d[2]/Math.max(m[2]-e[2],a);var f=-e[1]*c+m[2]*b;return{planeS:vec4.fromValues(j,0,0,k),planeT:vec4.fromValues(0,c,-b,f)}};HomePieceOfFurniture3D.prototype.isTexturesCoordinatesDefined=function(a){var c=a.getGeometries();for(var b=0,d=c.length;b<d;b++){if(!c[b].hasTextureCoordinates()){return false}}return true};HomePieceOfFurniture3D.prototype.setCullFace=function(a,d,e){if(a.getCullFace()!==Appearance3D.CULL_NONE){var c=a.getCullFace()!==undefined?a.getCullFace():Appearance3D.CULL_BACK;var b=a.defaultCullFace;if(b===undefined){a.defaultCullFace=(b=c)}a.setCullFace((d^e^b===Appearance3D.CULL_FRONT)?Appearance3D.CULL_FRONT:Appearance3D.CULL_BACK)}};HomePieceOfFurniture3D.prototype.restoreDefaultAppearance=function(a,b){if(a.defaultAppearance!==undefined){var c=a.defaultAppearance;if(c.getAmbientColor()!==undefined){a.setAmbientColor(c.getAmbientColor())}if(c.getDiffuseColor()!==undefined){a.setDiffuseColor(c.getDiffuseColor());if(b!==null){a.setSpecularColor(vec3.fromValues(b,b,b));a.setShininess(b*128)}else{a.setSpecularColor(c.getSpecularColor());a.setShininess(c.getShininess())}}if(c.getTransparency()!==undefined){a.setTransparency(c.getTransparency())}if(a.getCullFace()!==undefined){a.setCullFace(c.getCullFace())}if(c.getTextureCoordinatesGeneration()!==undefined){a.setTextureCoordinatesGeneration(c.getTextureCoordinatesGeneration())}if(a.getTextureImage()!==undefined){a.setTextureImage(c.getTextureImage())}}};HomePieceOfFurniture3D.prototype.restoreDefaultTextureCoordinatesGeneration=function(a){if(a.defaultAppearance!==undefined){var b=a.defaultAppearance;if(b.getTextureCoordinatesGeneration()!==undefined){a.setTextureCoordinatesGeneration(b.getTextureCoordinatesGeneration())}}};HomePieceOfFurniture3D.prototype.setVisible=function(c,b,k){if(c instanceof Group3D){var a=c.getChildren();for(var e=0;e<a.length;e++){this.setVisible(a[e],b,k)}}else{if(c instanceof Link3D){this.setVisible(c.getSharedGroup(),b,k)}else{if(c instanceof Shape3D){var h=c;var f=h.getAppearance();if(f===null){f=new Appearance3D();c.setAppearance(f)}var j=h.getName();if(b&&j!==null&&j.indexOf(ModelManager.LIGHT_SHAPE_PREFIX)===0&&this.home!==null&&!this.isSelected(this.home.getSelectedItems())&&(typeof HomeLight==="undefined"||this.getUserData() instanceof HomeLight)){b=false}if(b&&k!==null){for(var e=0;e<k.length;e++){var g=k[e];if(g!==null&&g.getName()==f.getName()){var d=g.getColor();b=d===null||(d&4278190080)!==0;break}}}f.setVisible(b)}}}};HomePieceOfFurniture3D.prototype.isVisible=function(){var a=this.getUserData();return a.isVisible()&&(a.getLevel()===null||a.getLevel().isViewableAndVisible())};HomePieceOfFurniture3D.prototype.isSelected=function(c){for(var a=0;a<c.length;a++){var b=c[a];if(b===this.getUserData()||(b instanceof HomeFurnitureGroup&&this.isSelected(b.getFurniture()))){return true}}return false};HomePieceOfFurniture3D.prototype.setBackFaceNormalFlip=function(d,e){if(d instanceof Group3D){var c=d.getChildren();for(var b=0;b<c.length;b++){this.setBackFaceNormalFlip(c[b],e)}}else{if(d instanceof Link3D){this.setBackFaceNormalFlip(d.getSharedGroup(),e)}else{if(d instanceof Shape3D){var a=d.getAppearance();if(a===null){a=new Appearance3D();d.setAppearance(a)}a.setBackFaceNormalFlip(e^a.getCullFace()===Appearance3D.CULL_FRONT)}}}};HomePieceOfFurniture3D.prototype.setTransparentShapeNotPickable=function(d){if(d instanceof Group3D){var c=d.getChildren();for(var b=0;b<c.length;b++){this.setTransparentShapeNotPickable(c[b])}}else{if(d instanceof Link3D){this.setTransparentShapeNotPickable(d.getSharedGroup())}else{if(d instanceof Shape3D){var a=d.getAppearance();if(a!==null&&a.getTransparency()>0){d.setPickable(false)}}}}};function Room3D(c,d,a,b){Object3DBranch.call(this);if(a===undefined){a=false;b=false}this.setUserData(c);this.home=d;this.addChild(this.createRoomPartShape());this.addChild(this.createRoomPartShape());this.updateRoomGeometry();this.updateRoomAppearance(b);if(a){this.removeChild(Room3D.CEILING_PART)}}Room3D.prototype=Object.create(Object3DBranch.prototype);Room3D.prototype.constructor=Room3D;Room3D.FLOOR_PART=0;Room3D.CEILING_PART=1;Room3D.prototype.createRoomPartShape=function(){var b=new Shape3D();b.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);var a=new Appearance3D();b.setAppearance(a);this.updateAppearanceMaterial(a,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0);return b};Room3D.prototype.update=function(){this.updateRoomGeometry();this.updateRoomAppearance(false)};Room3D.prototype.updateRoomGeometry=function(){this.updateRoomPartGeometry(Room3D.FLOOR_PART,this.getUserData().getFloorTexture());this.updateRoomPartGeometry(Room3D.CEILING_PART,this.getUserData().getCeilingTexture());var a=this.getUserData();this.setPickable(this.home.getEnvironment().getWallsAlpha()==0||a.getLevel()==null||a.getLevel().getElevation()<=0)};Room3D.prototype.updateRoomPartGeometry=function(a,e){var f=this.getChild(a);var d=f.getGeometries().length;var g=this.getUserData();if(g.getLevel()==null||g.getLevel().isViewableAndVisible()){var c=this.createRoomGeometries(a,e);for(var b=0;b<c.length;b++){f.addGeometry(c[b])}}for(var b=d-1;b>=0;b--){f.removeGeometry(b)}};Room3D.prototype.createRoomGeometries=function(P,n){var A=this.getUserData();var H=A.getPoints();if((P===Room3D.FLOOR_PART&&A.isFloorVisible()||P===Room3D.CEILING_PART&&A.isCeilingVisible())&&H.length>2){var G=A.getLevel();var o=this.home.getLevels();var D=this.isLastLevel(G,o);var q;var m;if(G!=null){m=G.getElevation();q=m-G.getFloorThickness()}else{m=0;q=0}var c;if(o.length===0){c=0}else{c=o[0].getElevation()}var x=P===Room3D.FLOOR_PART&&G!==null&&m!==c;var k=[];var f=[];var J=this.home.getRooms();for(var S=0;S<J.length;S++){var v=J[S];var l=v.getLevel();if(l===null||l.isViewableAndVisible()){if(A===v||G===l&&(P===Room3D.FLOOR_PART&&v.isFloorVisible()||P===Room3D.CEILING_PART&&v.isCeilingVisible())||G!=null&&l!=null&&(P===Room3D.FLOOR_PART&&v.isFloorVisible()&&Math.abs(m-l.getElevation())<0.0001||P===Room3D.CEILING_PART&&v.isCeilingVisible()&&!D&&!this.isLastLevel(l,o)&&Math.abs(m+G.getHeight()-(l.getElevation()+l.getHeight()))<0.0001)){k.push(v)}else{if(x&&l!=null&&v.isCeilingVisible()&&!this.isLastLevel(l,o)&&Math.abs(q-(l.getElevation()+l.getHeight()))<0.0001){f.push(v)}}}}if(G!=null){k.sort(function(Z,Y){var j=(Z.getLevel().getElevation()-Y.getLevel().getElevation());if(j!==0){return j}else{return Z.getLevel().getElevationIndex()-Y.getLevel().getElevationIndex()}})}var s;if(G===null||P===Room3D.CEILING_PART&&D){s=[]}else{s=this.getVisibleStaircases(this.home.getFurniture(),P,G,G.getElevation()===c)}var X=true;if(P===Room3D.CEILING_PART&&(G===null||D)){var z=this.getRoomHeightAt(H[0][0],H[0][1]);for(var S=1;S<H.length&&X;S++){X=this.getRoomHeightAt(H[S][0],H[S][1])===z}}var d;var W;var e;var E;if(!A.isSingular()||X&&(k[k.length-1]!==A||s.length>0)){E=new java.awt.geom.Area(this.getShape(H));if((k.indexOf(A)>=0)){for(var S=k.length-1;S>0&&k[S]!==A;S--){var a=k[S];E.subtract(new java.awt.geom.Area(this.getShape(a.getPoints())))}}this.removeStaircasesFromArea(s,E);d=[];W=[];e=this.getAreaPoints(E,d,W,1,P===Room3D.CEILING_PART)}else{var O=A.isClockwise();if(O&&P===Room3D.FLOOR_PART||!O&&P===Room3D.CEILING_PART){H=this.getReversedArray(H)}e=d=[H];W=[];E=null}var g=[];var r=this.home.getEnvironment().getSubpartSizeUnderLight();if(e.length!==0){var b=[];var y=true;for(var S=0;S<e.length;S++){var K=e[S];var u=new Array(K.length);for(var R=0;R<K.length;R++){u[R]=P===Room3D.FLOOR_PART?m:this.getRoomHeightAt(K[R][0],K[R][1]);if(y&&R>0){y=u[R]===u[R-1]}}b.push(u)}if(y&&r>0){for(var R=0;R<e.length;R++){var K=e[R];var U=Number.MAX_VALUE;var t=Number.MIN_VALUE;var N=Number.MAX_VALUE;var h=Number.MIN_VALUE;for(var S=0;S<K.length;S++){var C=K[S];U=Math.min(U,C[0]);t=Math.max(t,C[0]);N=Math.min(N,C[1]);h=Math.max(h,C[1])}var w=new java.awt.geom.Area(this.getShape(K));for(var I=U;I<t;I+=r){for(var M=N;M<h;M+=r){var V=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(I,M,r,r));V.intersect(w);if(!V.isEmpty()){var B=this.getAreaPoints(V,1,P===Room3D.CEILING_PART);if(!(B.length==0)){g.push(this.computeRoomPartGeometry(B,null,G,b[S][0],q,P===Room3D.FLOOR_PART,false,n))}}}}}}else{g.push(this.computeRoomPartGeometry(e,b,G,m,q,P===Room3D.FLOOR_PART,false,n))}if(G!=null&&P===Room3D.FLOOR_PART&&G.getElevation()!==c){g.push(this.computeRoomBorderGeometry(d,W,G,m,n))}}if(x){var p;if(E!=null||f.length>0){var Q=E!=null?E:new java.awt.geom.Area(this.getShape(H));for(var S=0;S<f.length;S++){var a=f[S];Q.subtract(new java.awt.geom.Area(this.getShape(a.getPoints())))}p=this.getAreaPoints(Q,1,true)}else{p=[this.getReversedArray(H)]}if(p.length!==0){if(r>0){for(var S=0;S<p.length;S++){var F=p[S];var U=Number.MAX_VALUE;var t=Number.MIN_VALUE;var N=Number.MAX_VALUE;var h=Number.MIN_VALUE;for(var R=0;R<F.length;R++){var C=F[R];U=Math.min(U,C[0]);t=Math.max(t,C[0]);N=Math.min(N,C[1]);h=Math.max(h,C[1])}var L=new java.awt.geom.Area(this.getShape(F));for(var I=U;I<t;I+=r){for(var M=N;M<h;M+=r){var T=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(I,M,r,r));T.intersect(L);if(!T.isEmpty()){var B=this.getAreaPoints(T,1,true);if(B.length!==0){g.push(this.computeRoomPartGeometry(B,null,G,m,q,true,true,n))}}}}}}else{g.push(this.computeRoomPartGeometry(p,null,G,m,q,true,true,n))}}}return g.slice(0)}else{return[]}};Room3D.prototype.computeRoomPartGeometry=function(v,t,b,g,u,m,s,h){var c=new Array(v.length);var f=0;for(var r=0;r<v.length;r++){var d=v[r];c[r]=d.length;f+=c[r]}var q=new Array(f);var r=0;for(var o=0;o<v.length;o++){var d=v[o];var a=t!=null?t[o]:null;for(var n=0;n<d.length;n++){var e=s?u:(a!=null?a[n]:g);q[r++]=vec3.fromValues(d[n][0],e,d[n][1])}}var l=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);l.setCoordinates(q);l.setStripCounts(c);if(h!=null){var p=new Array(f);r=0;for(var o=0;o<v.length;o++){var d=v[o];for(var n=0;n<d.length;n++){p[r++]=vec2.fromValues(d[n][0],m?-d[n][1]:d[n][1])}}l.setTextureCoordinates(p)}l.setGeneratedNormals(true);return l.getIndexedGeometryArray()};Room3D.prototype.computeRoomBorderGeometry=function(q,p,r,n,h){var a=0;for(var e=0;e<q.length;e++){a+=q[e].length}for(var e=0;e<p.length;e++){a+=p[e].length}a=a*4;var e=0;var o=new Array(a);var g=n-r.getFloorThickness();for(var f=0;f<q.length;f++){var k=q[f];for(var d=0;d<k.length;d++){o[e++]=vec3.fromValues(k[d][0],n,k[d][1]);o[e++]=vec3.fromValues(k[d][0],g,k[d][1]);var m=d<k.length-1?d+1:0;o[e++]=vec3.fromValues(k[m][0],g,k[m][1]);o[e++]=vec3.fromValues(k[m][0],n,k[m][1])}}for(var f=0;f<p.length;f++){var b=p[f];for(var d=0;d<b.length;d++){o[e++]=vec3.fromValues(b[d][0],n,b[d][1]);var m=d<b.length-1?d+1:0;o[e++]=vec3.fromValues(b[m][0],n,b[m][1]);o[e++]=vec3.fromValues(b[m][0],g,b[m][1]);o[e++]=vec3.fromValues(b[d][0],g,b[d][1])}}var c=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);c.setCoordinates(o);if(h!=null){var l=new Array(a);e=0;for(var f=0;f<q.length;f++){var k=q[f];for(var d=0;d<k.length;d++){l[e++]=vec2.fromValues(0,r.getFloorThickness());l[e++]=vec2.fromValues(0,0);var m=d<k.length-1?d+1:0;var s=java.awt.geom.Point2D.distance(k[d][0],k[d][1],k[m][0],k[m][1]);l[e++]=vec2.fromValues(s,0);l[e++]=vec2.fromValues(s,r.getFloorThickness())}}for(var f=0;f<p.length;f++){var b=p[f];for(var d=0;d<b.length;d++){l[e++]=vec2.fromValues(0,0);var m=d<b.length-1?d+1:0;var s=java.awt.geom.Point2D.distance(b[d][0],b[d][1],b[m][0],b[m][1]);l[e++]=vec2.fromValues(s,0);l[e++]=vec2.fromValues(s,r.getFloorThickness());l[e++]=vec2.fromValues(0,r.getFloorThickness())}}c.setTextureCoordinates(l)}c.setCreaseAngle(Math.PI/8);c.setGeneratedNormals(true);return c.getIndexedGeometryArray()};Room3D.prototype.removeStaircasesFromArea=function(b,d){var a=ModelManager.getInstance();for(var c=0;c<b.length;c++){var e=b[c];d.subtract(a.getAreaOnFloor(e))}};Room3D.prototype.getVisibleStaircases=function(f,b,d,g){var a=[];for(var c=0;c<f.length;c++){var e=f[c];if(e.isVisible()&&(e.getLevel()===null||e.getLevel().isViewableAndVisible())){if(e instanceof HomeFurnitureGroup){a.push.apply(a,this.getVisibleStaircases(e.getFurniture(),b,d,g))}else{if(e.getStaircaseCutOutShape()!=null&&"false"!=e.getStaircaseCutOutShape().toLowerCase()&&((b===Room3D.FLOOR_PART&&e.getGroundElevation()<d.getElevation()&&e.getGroundElevation()+e.getHeight()>=d.getElevation()-(g?0:d.getFloorThickness())||b===Room3D.CEILING_PART&&e.getGroundElevation()<d.getElevation()+d.getHeight()&&e.getGroundElevation()+e.getHeight()>=d.getElevation()+d.getHeight()))){a.push(e)}}}}return a};Room3D.prototype.getReversedArray=function(a){a=a.slice(0);return a.reverse()};Room3D.prototype.getRoomHeightAt=function(p,o){var F=Infinity;var C=this.getUserData();var g=C.getLevel();var n=g!==null?g.getElevation():0;var q=n+(g==null?this.home.getWallHeight():g.getHeight());var h=this.home.getLevels();if(g==null||this.isLastLevel(g,h)){var l=null;var E=null;var A=-1;var D=this.home.getWalls();for(var j=0;j<D.length;j++){var B=D[j];if((B.getLevel()===null||B.getLevel().isViewable())&&B.isAtLevel(g)){var w=B.getPoints();for(var z=0;z<w.length;z++){var d=java.awt.geom.Point2D.distanceSq(w[z][0],w[z][1],p,o);if(d<F){l=B;E=w;A=z;F=d}}}}if(l!=null){q=l.getLevel()==null?0:l.getLevel().getElevation();var s=l.getHeight();if(A===0||A===E.length-1){q+=s!=null?s:this.home.getWallHeight()}else{if(l.isTrapezoidal()){var t=l.getArcExtent();if(t==null||t===0||A===Math.floor(E.length/2)||A===Math.floor(E.length/2)-1){q+=l.getHeightAtEnd()}else{var f=l.getXArcCircleCenter();var r=l.getYArcCircleCenter();var c=E[A][0];var k=E[A][1];var u=java.awt.geom.Point2D.distance(f,r,c,k);var e=l.getXStart();var m=l.getYStart();var b=java.awt.geom.Point2D.distance(f,r,e,m);var a=(c-f)*(e-f)+(k-r)*(m-r);a/=(u*b);var v=Math.acos(a)*(t>0?1:(t<0?-1:0));q+=s+(l.getHeightAtEnd()-s)*v/t}}else{q+=(s!=null?s:this.home.getWallHeight())}}}}return q};Room3D.prototype.isLastLevel=function(b,a){return a.indexOf(b)===a.length-1};Room3D.prototype.updateRoomAppearance=function(c){var b=this.getUserData();var d=b.getLevel()==null||b.getLevel().getElevation()<=0;this.updateRoomPartAppearance(this.getChild(Room3D.FLOOR_PART).getAppearance(),b.getFloorTexture(),c,b.getFloorColor(),b.getFloorShininess(),b.isFloorVisible(),d);var a=b.getLevel()==null;this.updateRoomPartAppearance(this.getChild(Room3D.CEILING_PART).getAppearance(),b.getCeilingTexture(),c,b.getCeilingColor(),b.getCeilingShininess(),b.isCeilingVisible(),a)};Room3D.prototype.updateRoomPartAppearance=function(e,b,f,d,c,h,g){if(b==null){this.updateAppearanceMaterial(e,d,d,c);e.setTextureImage(null)}else{this.updateAppearanceMaterial(e,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,c);this.updateTextureTransform(e,b,true);TextureManager.getInstance().loadTexture(b.getImage(),f,{textureUpdated:function(j){e.setTextureImage(j)},textureError:function(j){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}if(!g){var a=this.home.getEnvironment().getWallsAlpha();e.setTransparency(a)}e.setVisible(h)};function Wall3D(b,e,d){Object3DBranch.call(this);this.setUserData(b);this.home=e;for(var c=0;c<8;c++){var a=new Group3D();a.addChild(this.createWallPartShape());this.addChild(a)}this.updateWallGeometry(d);this.updateWallAppearance(d)}Wall3D.prototype=Object.create(Object3DBranch.prototype);Wall3D.prototype.constructor=Wall3D;Wall3D.LEVEL_ELEVATION_SHIFT=0.1;Wall3D.FULL_FACE_CUT_OUT_AREA=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(-0.5,0.5,1,1));Wall3D.WALL_LEFT_SIDE=0;Wall3D.WALL_RIGHT_SIDE=1;Wall3D.rotatedModelsFrontAreas=[];Wall3D.prototype.createWallPartShape=function(){var b=new Shape3D();b.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);var a=new Appearance3D();b.setAppearance(a);this.updateAppearanceMaterial(a,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0);return b};Wall3D.prototype.update=function(){this.updateWallGeometry(false);this.updateWallAppearance(false)};Wall3D.prototype.updateWallGeometry=function(a){this.updateWallSideGeometry(Wall3D.WALL_LEFT_SIDE,a);this.updateWallSideGeometry(Wall3D.WALL_RIGHT_SIDE,a);this.setPickable(this.home.getEnvironment().getWallsAlpha()==0)};Wall3D.prototype.updateWallSideGeometry=function(b,l){var n=this.getUserData();var d;var a;if(b===Wall3D.WALL_LEFT_SIDE){d=n.getLeftSideTexture();a=n.getLeftSideBaseboard()}else{d=n.getRightSideTexture();a=n.getRightSideBaseboard()}var m=[this.getChild(b),this.getChild(b+2),this.getChild(b+4),this.getChild(b+6)];var g=new Array(m.length);var h=new Array(m.length);for(var f=0;f<m.length;f++){g[f]=m[f].getChild(0);h[f]=g[f].getGeometries().length}if(n.getLevel()==null||n.getLevel().isViewableAndVisible()){var o=[[],[],[],[]];this.createWallGeometries(o[0],o[2],o[3],b,null,d,l);if(a!=null){var c=a.getTexture();if(c===null&&a.getColor()===null){c=d}this.createWallGeometries(o[1],o[1],o[1],b,a,c,l)}for(var f=0;f<m.length;f++){for(var e=0;e<o[f].length;e++){var k=o[f][e];if(k!==null){g[f].addGeometry(k)}}}}for(var f=0;f<m.length;f++){for(var e=h[f]-1;e>=0;e--){g[f].removeGeometry(e)}}};Wall3D.prototype.createWallGeometries=function(x,W,N,ai,ag,ae,av){var aw=this.getUserData();var at=this.getShape(aw.getPoints());var af=this.getWallSidePoints(ai);var y=this.getShape(af);var K=ag==null?af:this.getWallBaseboardPoints(ai);var aq=this.getShape(K);var a=new java.awt.geom.Area(aq);var V=ai===Wall3D.WALL_LEFT_SIDE?K[0].slice(0):K[K.length-1].slice(0);var k=this.getWallElevation(ag!==null);var ab;var j;if(ag===null){ab=this.getWallTopElevationAtStart();j=this.getWallTopElevationAtEnd()}else{ab=j=this.getBaseboardTopElevation(ag)}var s=Math.max(ab,j);var O=Math.atan2(aw.getYEnd()-aw.getYStart(),aw.getXEnd()-aw.getXStart());var J=Math.cos(O);var P=Math.sin(O);var ak=J*aw.getXStart()+P*aw.getYStart();var g=J*aw.getXEnd()+P*aw.getYEnd();var R=aw.getArcExtent();var am=R!==null&&R!==0;var u;var b;if(ab===j){u=0;b=ab}else{u=(j-ab)/(g-ak);b=ab-u*ak}var z=[];var t=[];var o=this.getVisibleDoorsAndWindows(this.home.getFurniture());for(var H=0;H<o.length;H++){var an=o[H];var q=an.getGroundElevation();if(q+an.getHeight()>k&&q<s){var d=new java.awt.geom.Area(this.getShape(an.getPoints()));var S=new java.awt.geom.Area(at);S.intersect(d);if(!S.isEmpty()){var l=null;if(an.isParallelToWall(aw)){if(ag!==null){l=an.clone();l.setDepthInPlan(l.getDepth()+2*ag.getThickness())}if(typeof HomeDoorOrWindow!=="undefined"&&an instanceof HomeDoorOrWindow){if(an.isWallCutOutOnBothSides()){if(l===null){l=an.clone()}l.setDepthInPlan(l.getDepth()+4*aw.getThickness())}}}if(l!==null){d=new java.awt.geom.Area(this.getShape(l.getPoints()));S=new java.awt.geom.Area(aq);S.intersect(d)}else{S=new java.awt.geom.Area(y);S.intersect(d)}if(!S.isEmpty()&&(!aw.isTrapezoidal()||q<this.getMaxElevationAtWallIntersection(S,J,P,u,b))){z.push(new Wall3D.DoorOrWindowArea(S,[an]));t.push(an);a.subtract(d)}}}}if(z.length>1){for(var L=0;L<z.length;L++){var X=z[L];var ar=[];var p=0;for(var H=0;H<z.length;H++){var ac=z[H];if(X.getArea().isEmpty()){break}else{if(p>L){var aj=new java.awt.geom.Area(ac.getArea());aj.intersect(X.getArea());if(!aj.isEmpty()){ac.getArea().subtract(aj);X.getArea().subtract(aj);var m=(X.getDoorsOrWindows().slice(0));m.push.apply(m,ac.getDoorsOrWindows());ar.push(new Wall3D.DoorOrWindowArea(aj,m))}}}p++}z.push.apply(z,ar)}}var G=[];var e=null;for(var B=a.getPathIterator(null);!B.isDone();B.next()){var aa=[0,0];if(B.currentSegment(aa)===java.awt.geom.PathIterator.SEG_CLOSE){if(G.length>2){if(G[0][0]===G[G.length-1][0]&&G[0][1]===G[G.length-1][1]){G.splice(G.length-1,1)}if(G.length>2){var r=G.slice(0);W.push(this.createVerticalPartGeometry(aw,r,k,J,P,u,b,ag,ae,V,ai));x.push(this.createHorizontalPartGeometry(r,k,true,am));N.push(this.createTopPartGeometry(r,J,P,u,b,am))}}G.length=0;e=null}else{if(e===null||aa[0]!==e[0]||aa[1]!==e[1]){G.push(aa);e=aa}}}var U=aw.getLevel();e=null;for(var ap=0;ap<z.length;ap++){var X=z[ap];if(!X.getArea().isEmpty()){for(var B=X.getArea().getPathIterator(null);!B.isDone();B.next()){var aa=[0,0];if(B.currentSegment(aa)===java.awt.geom.PathIterator.SEG_CLOSE){if(G[0][0]===G[G.length-1][0]&&G[0][1]===G[G.length-1][1]){G.splice(G.length-1,1)}if(G.length>2){var r=G.slice(0);var m=X.getDoorsOrWindows();if(m.length>1){m.sort(function(aA,ay){var ax=aA.getGroundElevation();var az=ay.getGroundElevation();if(ax<az){return -1}else{if(ax>az){return 1}else{return 0}}})}var n=m[0];var C=n.getGroundElevation();if(C>k){if(U!=null&&U.getElevation()!==k&&n.getElevation()<Wall3D.LEVEL_ELEVATION_SHIFT){C-=Wall3D.LEVEL_ELEVATION_SHIFT}W.push(this.createVerticalPartGeometry(aw,r,k,J,P,0,C,ag,ae,V,ai));x.push(this.createHorizontalPartGeometry(r,k,true,am));W.push(this.createHorizontalPartGeometry(r,C,false,am))}for(var H=0;H<m.length-1;){var A=m[H];var T=A.getGroundElevation();var E=m[++H];var Z=E.getGroundElevation();while((T+A.getHeight()>=Z+E.getHeight()&&++H<m.length)){E=m[H]}if(H<m.length&&T+A.getHeight()<Z){W.push(this.createVerticalPartGeometry(aw,r,T+A.getHeight(),J,P,0,Z,ag,ae,V,ai));W.push(this.createHorizontalPartGeometry(r,T+A.getHeight(),true,am));W.push(this.createHorizontalPartGeometry(r,Z,false,am))}}var Q=m[m.length-1];var f=Q.getGroundElevation();for(var H=m.length-2;H>=0;H--){var v=m[H];if(v.getGroundElevation()+v.getHeight()>f+Q.getHeight()){Q=v}}var ad=f+Q.getHeight();var ah=true;for(var H=0;H<r.length;H++){var D=J*r[H][0]+P*r[H][1];var F=u*D+b;if(ad>F){if(u===0||am){ah=false;break}var c=(ad-F)/u;r[H][0]+=(c*J);r[H][1]+=(c*P)}}if(ah){W.push(this.createVerticalPartGeometry(aw,r,ad,J,P,u,b,ag,ae,V,ai));W.push(this.createHorizontalPartGeometry(r,ad,true,am));N.push(this.createTopPartGeometry(r,J,P,u,b,am))}}G.length=0;e=null}else{if(e==null||aa[0]!==e[0]||aa[1]!==e[1]){G.push(aa);e=aa}}}}}if(!am&&t.length>0){var M=Math.PI/720;var au=[];for(var H=0;H<t.length;H++){var an=t[H];if(typeof HomeDoorOrWindow!=="undefined"&&an instanceof HomeDoorOrWindow&&(PieceOfFurniture.DEFAULT_CUT_OUT_SHAPE!=an.getCutOutShape()||an.getWallWidth()!==1||an.getWallLeft()!==0||an.getWallHeight()!==1||an.getWallTop()!==0)){var al=Math.abs(O-an.getAngle())%(2*Math.PI);if(al<M||al>2*Math.PI-M||Math.abs(al-Math.PI)<M){var h=Math.abs(al-Math.PI)<M?1:-1;var w=Wall3D.getRotatedModelFrontArea(an);if(w!==null&&(au.length===0||!av)){this.createGeometriesSurroundingDoorOrWindow(an,w,h,aw,W,N,K,k,J,P,u,b,ae,V,ai)}else{au.push(an)}}}}if(au.length>0){var I=ModelManager.getInstance();au=au.slice(0);var ao=this;for(var H=0;H<au.length;H++){var Y={doorOrWindow:au[H],modelUpdated:function(aC){var az=Wall3D.getRotatedModelFrontArea(this.doorOrWindow);var ay;if(az===null){var aA=new TransformGroup3D(I.getRotationTransformation(this.doorOrWindow.getModelRotation()));aA.addChild(aC);ay=I.getFrontArea(this.doorOrWindow.getCutOutShape(),aA);Wall3D.rotatedModelsFrontAreas.push({model:this.doorOrWindow.getModel(),modelRotation:this.doorOrWindow.getModelRotation(),cutOutShape:this.doorOrWindow.getCutOutShape(),frontArea:ay})}var ax=Math.abs(O-this.doorOrWindow.getAngle())%(2*Math.PI);var aB=Math.abs(ax-Math.PI)<M?1:-1;if(av){ao.createGeometriesSurroundingDoorOrWindow(this.doorOrWindow,ay,aB,aw,W,N,K,k,J,P,u,b,ae,V,ai)}else{au.splice(au.indexOf(this.doorOrWindow),1);if(au.length===0&&this.baseboard==null){setTimeout(function(){ao.updateWallSideGeometry(ai,av)},0)}}},modelError:function(ax){if(Wall3D.getRotatedModelFrontArea(this.doorOrWindow)===null){Wall3D.rotatedModelsFrontAreas.push({model:this.doorOrWindow.getModel(),modelRotation:this.doorOrWindow.getModelRotation(),cutOutShape:this.doorOrWindow.getCutOutShape(),frontArea:Wall3D.FULL_FACE_CUT_OUT_AREA})}if(!av){au.splice(au.indexOf(this.doorOrWindow),1)}}};I.loadModel(au[H].getModel(),av,Y)}}}};Wall3D.getRotatedModelFrontArea=function(c){var a=null;for(var b=0;b<Wall3D.rotatedModelsFrontAreas.length;b++){if(Wall3D.rotatedModelsFrontAreas[b].model.equals(c.getModel())&&Object3DBranch.areModelRotationsEqual(Wall3D.rotatedModelsFrontAreas[b].modelRotation,c.getModelRotation())&&Wall3D.rotatedModelsFrontAreas[b].cutOutShape==c.getCutOutShape()){return Wall3D.rotatedModelsFrontAreas[b].frontArea}}return null};Wall3D.prototype.getVisibleDoorsAndWindows=function(d){var c=[];for(var a=0;a<d.length;a++){var b=d[a];if(b.isVisible()&&(b.getLevel()==null||b.getLevel().isViewableAndVisible())){if(b instanceof HomeFurnitureGroup){c.push.apply(c,this.getVisibleDoorsAndWindows(b.getFurniture()))}else{if(b.isDoorOrWindow()){c.push(b)}}}}return c};Wall3D.prototype.getWallSidePoints=function(c){var a=this.getUserData();var b=a.getPoints();if(c===Wall3D.WALL_LEFT_SIDE){for(var d=(b.length/2|0);d<b.length;d++){b[d][0]=(b[d][0]+b[b.length-d-1][0])/2;b[d][1]=(b[d][1]+b[b.length-d-1][1])/2}}else{for(var d=0,e=(b.length/2|0);d<e;d++){b[d][0]=(b[d][0]+b[b.length-d-1][0])/2;b[d][1]=(b[d][1]+b[b.length-d-1][1])/2}}return b};Wall3D.prototype.getWallBaseboardPoints=function(c){var a=this.getUserData();var e=a.getPoints$boolean(true);var b=a.getPoints();if(c===Wall3D.WALL_LEFT_SIDE){for(var d=Math.floor(e.length/2);d<e.length;d++){e[d]=b[b.length-d-1]}}else{for(var d=0,f=Math.floor(b.length/2);d<f;d++){e[d]=b[b.length-d-1]}}return e};Wall3D.prototype.createVerticalPartGeometry=function(m,L,ab,D,B,T,q,b,u,ad,ac){var x=this.home.getEnvironment().getSubpartSizeUnderLight();var e=m.getArcExtent();if((e===null||e===0)&&x>0){var M=[];M.push(L[0]);for(var X=1;X<L.length;X++){var z=java.awt.geom.Point2D.distance(L[X-1][0],L[X-1][1],L[X][0],L[X][1])-x/2;var t=Math.atan2(L[X][1]-L[X-1][1],L[X][0]-L[X-1][0]);var C=Math.cos(t);var l=Math.sin(t);for(var aa=0;aa<z;aa+=x){M.push([(L[X-1][0]+aa*C),(L[X-1][1]+aa*l)])}M.push(L[X])}L=M.slice(0)}var a=new Array(L.length);var g=new Array(L.length);var E=new Array(L.length);var k=m.getXStart();var I=m.getYStart();var s=m.getXEnd();var O=m.getYEnd();var W=null;var H=0;var S=0;if(e!==null&&e!==0){W=[m.getXArcCircleCenter(),m.getYArcCircleCenter()];H=java.awt.geom.Point2D.distance(W[0],W[1],k,I);S=Math.fround(Math.atan2(ad[1]-W[1],ad[0]-W[0]))}for(var X=0;X<L.length;X++){a[X]=vec3.fromValues(L[X][0],ab,L[X][1]);var o=this.getWallPointElevation(L[X][0],L[X][1],D,B,T,q);g[X]=vec3.fromValues(L[X][0],o,L[X][1])}var p=new Array(L.length);for(var X=0;X<L.length;X++){if(W===null){p[X]=java.awt.geom.Line2D.ptLineDistSq(k,I,s,O,a[X][0],a[X][2])}else{p[X]=H-java.awt.geom.Point2D.distance(W[0],W[1],a[X][0],a[X][2]);p[X]*=p[X]}}var ae=L.length;var h=new Array(L.length);if(b===null){for(var X=0;X<L.length-1;X++){h[X]=p[X]>0.001||p[X+1]>0.001;if(!h[X]){ae--}}h[h.length-1]=p[0]>0.001||p[L.length-1]>0.001;if(!h[h.length-1]){ae--}if(ae===0){return null}}else{for(var X=0;X<h.length;X++){h[X]=true}}var n=[];for(var G=0;G<L.length;G++){if(h[G]){var K=ab;var w=a[G];var r=(G+1)%L.length;var v=a[r];if(x>0){for(var U=Math.min(g[G][1],g[r][1])-x/2;K<U;K+=x){n.push(w);n.push(v);w=vec3.fromValues(a[G][0],K,a[G][2]);v=vec3.fromValues(a[r][0],K,a[r][2]);n.push(v);n.push(w)}}n.push(w);n.push(v);n.push(g[r]);n.push(g[G])}}var P=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);P.setCoordinates(n.slice(0));if(u!==null){var Q;if(b!==null){Q=m.getThickness()/2+b.getThickness();Q*=Q}else{Q=(m.getThickness()*m.getThickness())/4}var Z=new Array(n.length);var A=vec2.fromValues(0,ab);var V=0;var R=W===null?m.getThickness()/10000:Q/4;for(var G=0;G<L.length;G++){if(h[G]){var r=(G+1)%L.length;var N;var J;if(Math.abs(p[G]-Q)<R&&Math.abs(p[r]-Q)<R){var f;var F;if(W===null){f=java.awt.geom.Point2D.distance(ad[0],ad[1],L[G][0],L[G][1]);F=java.awt.geom.Point2D.distance(ad[0],ad[1],L[r][0],L[r][1])}else{if(E[G]===undefined){var c=Math.fround(Math.atan2(L[G][1]-W[1],L[G][0]-W[0]));c=this.adjustAngleOnReferencePointAngle(c,S,e);E[G]=(c-S)*H}if(E[r]===undefined){var c=Math.fround(Math.atan2(L[r][1]-W[1],L[r][0]-W[0]));c=this.adjustAngleOnReferencePointAngle(c,S,e);E[r]=(c-S)*H}f=E[G];F=E[r]}if(ac===Wall3D.WALL_LEFT_SIDE&&u.isLeftToRightOriented()){f=-f;F=-F}N=vec2.fromValues(f,ab);J=vec2.fromValues(F,ab)}else{N=A;var Y=java.awt.geom.Point2D.distance(L[G][0],L[G][1],L[r][0],L[r][1]);J=vec2.fromValues(Y,ab)}if(x>0){var K=ab;for(var U=Math.min(g[G][1],g[r][1])-x/2;K<U;K+=x){Z[V++]=N;Z[V++]=J;N=vec2.fromValues(N[0],K);J=vec2.fromValues(J[0],K);Z[V++]=J;Z[V++]=N}}Z[V++]=N;Z[V++]=J;Z[V++]=vec2.fromValues(J[0],g[r][1]);Z[V++]=vec2.fromValues(N[0],g[G][1])}}P.setTextureCoordinates(Z)}if(W===null){P.setCreaseAngle(0)}P.setGeneratedNormals(true);return P.getIndexedGeometryArray()};Wall3D.prototype.getMaxElevationAtWallIntersection=function(b,a,c,e,f){var g=-Infinity;for(var d=b.getPathIterator(null);!d.isDone();d.next()){var h=[0,0];if(d.currentSegment(h)!==java.awt.geom.PathIterator.SEG_CLOSE){g=Math.max(g,this.getWallPointElevation(h[0],h[1],a,c,e,f))}}return g};Wall3D.prototype.getWallPointElevation=function(e,g,a,b,c,d){var f=a*e+b*g;return(c*f+d)};Wall3D.prototype.adjustAngleOnReferencePointAngle=function(a,b,c){if(c>0){if((b>0&&(a<0||a<b))||(b<0&&a<b)){a+=2*Math.PI}}else{if((b<0&&(a>0||b<a))||(b>0&&b<a)){a-=2*Math.PI}}return a};Wall3D.prototype.createHorizontalPartGeometry=function(c,g,f,d){var e=new Array(c.length);for(var b=0;b<c.length;b++){e[b]=vec3.fromValues(c[b][0],g,c[b][1])}var a=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);a.setCoordinates(f?e.reverse():e);a.setStripCounts([e.length]);if(d){a.setCreaseAngle(0)}a.setGeneratedNormals(true);return a.getIndexedGeometryArray()};Wall3D.prototype.createTopPartGeometry=function(k,b,g,d,c,l){var j=new Array(k.length);for(var f=0;f<k.length;f++){var h=b*k[f][0]+g*k[f][1];var a=(d*h+c);j[f]=vec3.fromValues(k[f][0],a,k[f][1])}var e=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);e.setCoordinates(j);e.setStripCounts([j.length]);if(l){e.setCreaseAngle(0)}e.setGeneratedNormals(true);return e.getIndexedGeometryArray()};Wall3D.prototype.createGeometriesSurroundingDoorOrWindow=function(N,b,L,n,O,c,v,X,C,A,Y,r,u,ai,ah){if(N.getModelTransformations()!==null){b=new java.awt.geom.Area(b);b.transform(java.awt.geom.AffineTransform.getTranslateInstance(0.5,0.5));b.transform(java.awt.geom.AffineTransform.getScaleInstance(N.getWidth()*N.getWallWidth(),N.getHeight()*N.getWallHeight()));b.transform(java.awt.geom.AffineTransform.getTranslateInstance(N.getWallLeft()*N.getWidth(),(1-N.getWallHeight()-N.getWallTop())*N.getHeight()));b.transform(java.awt.geom.AffineTransform.getScaleInstance(1/N.getWidth(),1/N.getHeight()));b.transform(java.awt.geom.AffineTransform.getTranslateInstance(-0.5,-0.5))}var h=new java.awt.geom.Area(Wall3D.FULL_FACE_CUT_OUT_AREA);h.subtract(b);if(!h.isEmpty()){var y=N.getDepth();var k=(N.getX()-L*y/2*Math.sin(N.getAngle()));var t=(N.getY()+L*y/2*Math.cos(N.getAngle()));var aa=ah===Wall3D.WALL_LEFT_SIDE?v[0]:v[v.length-1];var W=ah===Wall3D.WALL_LEFT_SIDE?v[(v.length/2|0)-1]:v[(v.length/2|0)];var I=java.awt.geom.Line2D.ptLineDist(aa[0],aa[1],W[0],W[1],k,t);var R=java.awt.geom.Line2D.relativeCCW(aa[0],aa[1],W[0],W[1],k,t);var S=L*(0.5-R*I/y);var p=ModelManager.getInstance().getPieceOfFurnitureNormalizedModelTransformation(N,null);var e=mat4.create();mat4.fromTranslation(e,vec3.fromValues(0,0,S));mat4.mul(p,p,e);var E=mat4.create();mat4.invert(E,p);var w=new java.awt.geom.GeneralPath();var M=vec3.fromValues(aa[0],X,aa[1]);vec3.transformMat4(M,M,E);w.moveTo(M[0],M[1]);M=vec3.fromValues(W[0],X,W[1]);vec3.transformMat4(M,M,E);w.lineTo(M[0],M[1]);var d=vec3.fromValues(W[0],this.getWallPointElevation(W[0],W[1],C,A,Y,r),W[1]);vec3.transformMat4(d,d,E);w.lineTo(d[0],d[1]);var a=vec3.fromValues(aa[0],this.getWallPointElevation(aa[0],aa[1],C,A,Y,r),aa[1]);vec3.transformMat4(a,a,E);w.lineTo(a[0],a[1]);w.closePath();var T=new java.awt.geom.GeneralPath();T.moveTo(-0.5,-0.5);T.lineTo(-0.5,0.5);T.lineTo(0.5,0.5);T.lineTo(0.5,-0.5);T.closePath();var H=new java.awt.geom.Area(T);H.intersect(new java.awt.geom.Area(w));H.subtract(b);var q=0.5/(Math.max(N.getWidth(),N.getHeight()));if(!H.isEmpty()){var ac=L>0!==(ah===Wall3D.WALL_RIGHT_SIDE)!==N.isModelMirrored();var x=this.getAreaPoints(H,q,ac);if(!(x.length===0)){var V=new Array(x.length);var ae=0;for(var ab=0;ab<x.length;ab++){var f=x[ab];V[ab]=f.length+1;ae+=V[ab]}var l=n.getThickness()/2;var F=l*A;var aj=-l*C;if(ah===Wall3D.WALL_LEFT_SIDE){F*=-1;aj*=-1}var m=new Array(ae);var z=([]);var B=([]);var af;var D;if(u!=null){af=new Array(m.length);D=[]}else{af=null;D=null}var ab=0;for(var G=0;G<x.length;G++){var f=x[G];var K=vec3.fromValues(f[0][0],f[0][1],0);vec3.transformMat4(K,K,p);var J=null;if(u!=null){var ad=java.awt.geom.Point2D.distance(ai[0],ai[1],K[0],K[2]);if(ah===Wall3D.WALL_LEFT_SIDE&&u.isLeftToRightOriented()){ad=-ad}J=vec2.fromValues(ad,K[1])}var Q=java.awt.geom.Line2D.ptLineDistSq(d[0],d[1],a[0],a[1],f[0][0],f[0][1]);for(var Z=0;Z<f.length;Z++,ab++){m[ab]=K;if(u!=null){af[ab]=J}var ag=Z<f.length-1?Z+1:0;var o;var g=java.awt.geom.Line2D.ptLineDistSq(d[0],d[1],a[0],a[1],f[ag][0],f[ag][1]);if(Q<1e-10&&g<1e-10){o=B}else{o=z}var s=vec3.fromValues(f[ag][0],f[ag][1],0);vec3.transformMat4(s,s,p);o.push(K);o.push(vec3.fromValues(K[0]+F,K[1],K[2]+aj));o.push(vec3.fromValues(s[0]+F,s[1],s[2]+aj));o.push(s);var P=null;if(u!=null){var ad=java.awt.geom.Point2D.distance(ai[0],ai[1],s[0],s[2]);if(ah===Wall3D.WALL_LEFT_SIDE&&u.isLeftToRightOriented()){ad=-ad}P=vec2.fromValues(ad,s[1]);if(o===z){D.push(J);D.push(J);D.push(P);D.push(P)}}Q=g;K=s;J=P}m[ab]=K;if(u!=null){af[ab]=J}ab++}var U=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);U.setStripCounts(V);U.setCoordinates(m);if(u!==null){U.setTextureCoordinates(af)}U.setGeneratedNormals(true);O.push(U.getIndexedGeometryArray());if(z.length>0){U=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);U.setCoordinates(z.slice(0));if(u!==null){U.setTextureCoordinates(D.slice(0))}U.setCreaseAngle(Math.PI/2);U.setGeneratedNormals(true);O.push(U.getIndexedGeometryArray())}if(B.length>0){U=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);U.setCoordinates(B.slice(0));U.setGeneratedNormals(true);c.push(U.getIndexedGeometryArray())}}}}};Wall3D.prototype.getWallElevation=function(b){var a=this.getUserData();var d=a.getLevel();if(d===null){return 0}else{if(b){return d.getElevation()}else{var c=this.getFloorThicknessBottomWall();if(c>0){c-=Wall3D.LEVEL_ELEVATION_SHIFT}return d.getElevation()-c}}};Wall3D.prototype.getFloorThicknessBottomWall=function(){var a=this.getUserData();var c=a.getLevel();if(c==null){return 0}else{var b=this.home.getLevels();if(!(b.length===0)&&b[0].getElevation()===c.getElevation()){return 0}else{return c.getFloorThickness()}}};Wall3D.prototype.getWallTopElevationAtStart=function(){var a=this.getUserData().getHeight();var b;if(a!==null){b=a+this.getWallElevation(false)+this.getFloorThicknessBottomWall()}else{b=this.home.getWallHeight()+this.getWallElevation(false)+this.getFloorThicknessBottomWall()}return b+this.getTopElevationShift()};Wall3D.prototype.getTopElevationShift=function(){var b=this.getUserData().getLevel();if(b!==null){var a=this.home.getLevels();if(a[a.length-1]!==b){return Wall3D.LEVEL_ELEVATION_SHIFT}}return 0};Wall3D.prototype.getWallTopElevationAtEnd=function(){var a=this.getUserData();if(a.isTrapezoidal()){return a.getHeightAtEnd()+this.getWallElevation(false)+this.getFloorThicknessBottomWall()+this.getTopElevationShift()}else{return this.getWallTopElevationAtStart()}};Wall3D.prototype.getBaseboardTopElevation=function(a){return a.getHeight()+this.getWallElevation(true)};Wall3D.prototype.updateWallAppearance=function(e){var h=this.getUserData();var b=h.getTopColor();var k=[this.getChild(0),this.getChild(2),this.getChild(4),this.getChild(6)];var a=[this.getChild(1),this.getChild(3),this.getChild(5),this.getChild(7)];for(var f=0;f<k.length;f++){if(f===1){var c=h.getLeftSideBaseboard();if(c!=null){var g=c.getTexture();var d=c.getColor();if(d===null&&g===null){g=h.getLeftSideTexture();d=h.getLeftSideColor()}this.updateFilledWallSideAppearance(k[f].getChild(0).getAppearance(),g,e,d,h.getLeftSideShininess())}var j=h.getRightSideBaseboard();if(j!=null){var g=j.getTexture();var d=j.getColor();if(d==null&&g==null){g=h.getRightSideTexture();d=h.getRightSideColor()}this.updateFilledWallSideAppearance(a[f].getChild(0).getAppearance(),g,e,d,h.getRightSideShininess())}}else{if(f!==3||b==null){this.updateFilledWallSideAppearance(k[f].getChild(0).getAppearance(),h.getLeftSideTexture(),e,h.getLeftSideColor(),h.getLeftSideShininess());this.updateFilledWallSideAppearance(a[f].getChild(0).getAppearance(),h.getRightSideTexture(),e,h.getRightSideColor(),h.getRightSideShininess())}else{this.updateFilledWallSideAppearance(k[f].getChild(0).getAppearance(),null,e,b,0);this.updateFilledWallSideAppearance(a[f].getChild(0).getAppearance(),null,e,b,0)}}}};Wall3D.prototype.updateFilledWallSideAppearance=function(g,a,e,c,b){if(a==null){this.updateAppearanceMaterial(g,c,c,b);g.setTextureImage(null)}else{this.updateAppearanceMaterial(g,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,b);this.updateTextureTransform(g,a,true);var d=this;TextureManager.getInstance().loadTexture(a.getImage(),e,{textureUpdated:function(h){g.setTextureImage(h)},textureError:function(h){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}var f=this.home.getEnvironment().getWallsAlpha();g.setTransparency(f)};Wall3D.DoorOrWindowArea=function(a,b){this.area=a;this.doorsOrWindows=b};Wall3D.DoorOrWindowArea.prototype.getArea=function(){return this.area};Wall3D.DoorOrWindowArea.prototype.getDoorsOrWindows=function(){return this.doorsOrWindows};function Ground3D(h,l,k,a,e,b){Object3DBranch.call(this);this.setUserData(h);this.originX=l;this.originY=k;this.width=a;this.depth=e;var c=new Appearance3D();var f=new Shape3D();f.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);f.setAppearance(c);this.addChild(f);var j=new Appearance3D();this.updateAppearanceMaterial(j,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_COLOR,0);j.setCullFace(Appearance3D.CULL_NONE);var g=new TransformGroup3D();g.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);var d=new Shape3D(new IndexedTriangleArray3D([vec3.fromValues(-0.5,0,-0.5),vec3.fromValues(-0.5,0,0.5),vec3.fromValues(0.5,0,0.5),vec3.fromValues(0.5,0,-0.5)],[0,1,2,0,2,3],[vec2.fromValues(0,0),vec2.fromValues(1,0),vec2.fromValues(1,1),vec2.fromValues(0,1)],[3,0,1,3,1,2],[vec3.fromValues(0,1,0)],[0,0,0,0,0,0]),j);g.addChild(d);this.addChild(g);this.update(b)}Ground3D.prototype=Object.create(Object3DBranch.prototype);Ground3D.prototype.constructor=Ground3D;Ground3D.prototype.update=function(c){if(c===undefined){c=false}var g=this.getUserData();var f=this.getChild(1);var d=f.getChild(0);var j=d.getAppearance();var h=null;if(g.getEnvironment().isBackgroundImageVisibleOnGround3D()){var k=g.getLevels();if(k.length>0){for(var e=k.length-1;e>=0;e--){var a=k[e];if(a.getElevation()==0&&a.isViewableAndVisible()&&a.getBackgroundImage()!==null&&a.getBackgroundImage().isVisible()){h=a.getBackgroundImage();break}}}else{if(g.getBackgroundImage()!==null&&g.getBackgroundImage().isVisible()){h=g.getBackgroundImage()}}}if(h!==null){var b=this;TextureManager.getInstance().loadTexture(h.getImage(),c,{textureUpdated:function(p){var q=h.getScale();var n=q*p.width;var l=q*p.height;var m=mat4.create();mat4.scale(m,m,vec3.fromValues(n,1,l));var o=mat4.create();mat4.fromTranslation(o,vec3.fromValues(n/2-h.getXOrigin(),0,l/2-h.getYOrigin()));mat4.mul(m,o,m);j.setTextureImage(p);f.setTransform(m);b.updateGround(c,new java.awt.geom.Rectangle2D.Float(-h.getXOrigin(),-h.getYOrigin(),n,l))},textureError:function(l){return this.textureUpdated(TextureManager.getInstance().getErrorImage())},progression:function(m,n,l){}});j.setVisible(true)}else{j.setVisible(false);this.updateGround(c,null)}};Ground3D.prototype.updateGround=function(r,K){var p=this.getUserData();var e=this.getChild(0);var d=e.getGeometries().length;var w=e.getAppearance();var v=p.getEnvironment().getGroundTexture();if(v===null){var s=p.getEnvironment().getGroundColor();this.updateAppearanceMaterial(w,s,s,0);w.setTextureImage(null)}else{this.updateAppearanceMaterial(w,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_COLOR,0);this.updateTextureTransform(w,v,true);TextureManager.getInstance().loadTexture(v.getImage(),r,{textureUpdated:function(j){w.setTextureImage(j)},textureError:function(j){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}var n=new java.awt.geom.Area();if(K!==null){n.add(new java.awt.geom.Area(K))}var a=[];var D=p.getRooms();for(var H=0;H<D.length;H++){var y=D[H];var B=y.getLevel();if((B===null||B.isViewable())&&y.isFloorVisible()){var f=y.getPoints();if(f.length>2){var h=new java.awt.geom.Area(this.getShape(f));var g=B!==null&&B.getElevation()<0?this.getUndergroundAreas(a,B):null;if(B===null||(B.getElevation()<=0&&B.isViewableAndVisible())){n.add(h);if(g!==null){g.roomArea.add(h)}}if(g!==null){g.undergroundArea.add(h)}}}}this.updateUndergroundAreasDugByFurniture(a,p.getFurniture());var t=p.getWalls();for(var H=0;H<t.length;H++){var q=t[H];var o=q.getLevel();if(o!==null&&o.isViewable()&&o.getElevation()<0){var g=this.getUndergroundAreas(a,o);g.wallArea.add(new java.awt.geom.Area(this.getShape(q.getPoints())))}}var u=a;for(var H=0;H<u.length;H++){var g=u[H];var b=this.getPoints(g.wallArea);for(var G=0;G<b.length;G++){var C=b[G];if(!new Room(C).isClockwise()){g.undergroundArea.add(new java.awt.geom.Area(this.getShape(C)))}}}u.sort(function(j,k){return -(j.level.getElevation()-k.level.getElevation())});for(var H=0;H<u.length;H++){var g=u[H];var l=g.level;var z=g.undergroundArea;var J=z.clone();g.undergroundSideArea.add(z.clone());for(var G=0;G<u.length;G++){var c=u[G];if(c.level.getElevation()<l.getElevation()){var b=this.getPoints(c.undergroundArea);for(var F=0;F<b.length;F++){var C=b[F];if(!new Room(C).isClockwise()){var L=new java.awt.geom.Area(this.getShape(C));z.subtract(L);g.undergroundSideArea.add(L)}}}}var b=this.getPoints(z);for(var G=0;G<b.length;G++){var C=b[G];if(new Room(C).isClockwise()){var I=new java.awt.geom.Area(this.getShape(C));I.exclusiveOr(J);I.subtract(J);g.upperLevelArea.add(I)}else{n.add(new java.awt.geom.Area(this.getShape(C)))}}}for(var H=0;H<u.length;H++){var g=u[H];var h=g.roomArea;if(h!==null){g.undergroundArea.subtract(h)}}var E=new java.awt.geom.Area(this.getShape([[this.originX,this.originY],[this.originX,this.originY+this.depth],[this.originX+this.width,this.originY+this.depth],[this.originX+this.width,this.originY]]));var A=n.getBounds2D();if(!E.getBounds2D().equals(A)){var x=E;if(n.isEmpty()){A=new java.awt.geom.Rectangle2D.Float(Math.max(-5000,this.originX),Math.max(-5000,this.originY),0,0);A.add(Math.min(5000,this.originX+this.width),Math.min(5000,this.originY+this.depth))}else{A.add(Math.max(A.getMinX()-5000,this.originX),Math.max(A.getMinY()-5000,this.originY));A.add(Math.min(A.getMaxX()+5000,this.originX+this.width),Math.min(A.getMaxY()+5000,this.originY+this.depth))}E=new java.awt.geom.Area(A);x.subtract(E);this.addAreaGeometry(e,v,x,0)}E.subtract(n);u.splice(0,0,new Ground3D.LevelAreas(new Level("Ground",0,0,0),E));var M=0;for(var H=0;H<u.length;H++){var g=u[H];var m=g.level.getElevation();this.addAreaGeometry(e,v,g.undergroundArea,m);if(M-m>0){var b=this.getPoints(g.undergroundSideArea);for(var G=0;G<b.length;G++){var C=b[G];this.addAreaSidesGeometry(e,v,C,m,M-m)}this.addAreaGeometry(e,v,g.upperLevelArea,M)}M=m}for(var H=d-1;H>=0;H--){e.removeGeometry(H)}};Ground3D.prototype.getPoints=function(d){var f=[];var e=[];var a=null;for(var c=d.getPathIterator(null,1);!c.isDone();c.next()){var b=[0,0];if(c.currentSegment(b)===java.awt.geom.PathIterator.SEG_CLOSE){if(e[0][0]===a[0]&&e[0][1]===a[1]){e.splice(e.length-1,1)}if(e.length>2){f.push(e.slice(0))}e.length=0;a=null}else{if(a===null||b[0]!==a[0]||b[1]!==a[1]){e.push(b)}a=b}}return f};Ground3D.prototype.getUndergroundAreas=function(a,d){var c=null;for(var b=0;b<a.length;b++){if(a[b].level===d){c=a[b];break}}if(c===null){a.push(c=new Ground3D.LevelAreas(d))}return c};Ground3D.prototype.updateUndergroundAreasDugByFurniture=function(a,e){for(var c=0;c<e.length;c++){var d=e[c];var b=d.getLevel();if(d.getGroundElevation()<0&&d.isVisible()&&b!==null&&b.isViewable()&&b.getElevation()<0){if(d instanceof HomeFurnitureGroup){this.updateUndergroundAreasDugByFurniture(a,d.getFurniture())}else{var f=this.getUndergroundAreas(a,b);if(d.getStaircaseCutOutShape()===null){f.undergroundArea.add(new java.awt.geom.Area(this.getShape(d.getPoints())))}else{f.undergroundArea.add(ModelManager.getInstance().getAreaOnFloor(d))}}}}};Ground3D.prototype.addAreaGeometry=function(h,c,b,q){var n=this.getAreaPoints(b,1,false);if(n.length!==0){var a=0;var l=new Array(n.length);for(var f=0;f<l.length;f++){l[f]=n[f].length;a+=l[f]}var k=new Array(a);var m=c!==null?new Array(a):null;var e=0;for(var g=0;g<n.length;g++){var p=n[g];for(var f=0;f<p.length;f++,e++){var o=p[f];k[e]=vec3.fromValues(o[0],q,o[1]);if(c!==null){m[e]=vec2.fromValues(o[0]-this.originX,this.originY-o[1])}}}var d=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);d.setCoordinates(k);if(c!==null){d.setTextureCoordinates(m)}d.setStripCounts(l);d.setCreaseAngle(0);d.setGeneratedNormals(true);h.addGeometry(d.getIndexedGeometryArray())}};Ground3D.prototype.addAreaSidesGeometry=function(f,b,m,o,h){var g=new Array(m.length*4);var k=b!==null?new Array(g.length):null;for(var e=0,d=0;e<m.length;e++){var n=m[e];var l=m[e<m.length-1?e+1:0];g[d++]=vec3.fromValues(n[0],o,n[1]);g[d++]=vec3.fromValues(n[0],o+h,n[1]);g[d++]=vec3.fromValues(l[0],o+h,l[1]);g[d++]=vec3.fromValues(l[0],o,l[1]);if(b!==null){var a=java.awt.geom.Point2D.distance(n[0],n[1],l[0],l[1]);k[d-4]=vec2.fromValues(n[0],o);k[d-3]=vec2.fromValues(n[0],o+h);k[d-2]=vec2.fromValues(n[0]-a,o+h);k[d-1]=vec2.fromValues(n[0]-a,o)}}var c=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);c.setCoordinates(g);if(b!==null){c.setTextureCoordinates(k)}c.setCreaseAngle(0);c.setGeneratedNormals(true);f.addGeometry(c.getIndexedGeometryArray())};Ground3D.LevelAreas=function(b,a){if(a===undefined){a=new java.awt.geom.Area()}this.level=b;this.undergroundArea=a;this.roomArea=new java.awt.geom.Area();this.wallArea=new java.awt.geom.Area();this.undergroundSideArea=new java.awt.geom.Area();this.upperLevelArea=new java.awt.geom.Area()};function Polyline3D(a,c,b){Object3DBranch.call(this);this.setUserData(a);if(Polyline3D.ARROW===null){Polyline3D.ARROW=new java.awt.geom.GeneralPath();Polyline3D.ARROW.moveTo(-5,-2);Polyline3D.ARROW.lineTo(0,0);Polyline3D.ARROW.lineTo(-5,2)}this.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);this.update()}Polyline3D.prototype=Object.create(Object3DBranch.prototype);Polyline3D.prototype.constructor=Polyline3D;Polyline3D.ARROW=null;Polyline3D.prototype.update=function(){var v=this.getUserData();if(v.isVisibleIn3D()&&(v.getLevel()==null||v.getLevel().isViewableAndVisible())){var n=ShapeTools.getStroke(v.getThickness(),v.getCapStyle(),v.getJoinStyle(),v.getDashStyle()!==Polyline.DashStyle.SOLID?v.getDashPattern():null,v.getDashOffset());var f=ShapeTools.getPolylineShape(v.getPoints(),v.getJoinStyle()===Polyline.JoinStyle.CURVED,v.isClosedPath());var r=null;var q=null;var a=null;var g=null;for(var k=f.getPathIterator(null,0.5);!k.isDone();k.next()){var b=[0,0];if(k.currentSegment(b)!==java.awt.geom.PathIterator.SEG_CLOSE){if(r===null){r=b}else{if(q===null){q=b}}a=g;g=b}}var E=Math.atan2(r[1]-q[1],r[0]-q[0]);var h=Math.atan2(g[1]-a[1],g[0]-a[0]);var d=v.getCapStyle()!==Polyline.CapStyle.BUTT?v.getThickness()/2:0;var A=[this.getArrowShape(r,E,v.getStartArrowStyle(),v.getThickness(),d),this.getArrowShape(g,h,v.getEndArrowStyle(),v.getThickness(),d),n.createStrokedShape(f)];var F=new java.awt.geom.Area();for(var C=0;C<A.length;C++){var e=A[C];if(e!=null){F.add(new java.awt.geom.Area(e))}}var l=[];var D=this.getAreaPoints(F,0.5,false);var m=new Array(D.length);var c=0;for(var C=0;C<D.length;C++){var B=D[C];for(var z=0;z<B.length;z++){var y=B[z];l.push(vec3.fromValues(y[0],0,y[1]))}m[C]=l.length-c;c=l.length}var x=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);x.setCoordinates(l.slice(0));var u=new Array(l.length);var G=vec3.fromValues(0,1,0);for(var C=0;C<l.length;C++){u[C]=G}x.setNormals(u);x.setStripCounts(m);var w=x.getIndexedGeometryArray();if(this.getChildren().length===0){var o=new BranchGroup3D();var p=new TransformGroup3D();p.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);o.addChild(p);var t=new Appearance3D();this.updateAppearanceMaterial(t,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0);t.setCullFace(Appearance3D.CULL_NONE);var e=new Shape3D(w,t);e.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);p.addChild(e);this.addChild(o)}else{var e=this.getChild(0).getChild(0).getChild(0);e.removeGeometry(0);e.addGeometry(w)}var p=this.getChild(0).getChild(0);var s=mat4.create();mat4.fromTranslation(s,vec3.fromValues(0,v.getGroundElevation()+(v.getElevation()<0.05?0.05:0),0));p.setTransform(s);this.updateAppearanceMaterial(p.getChild(0).getAppearance(),v.getColor(),v.getColor(),0)}else{this.removeAllChildren()}};Polyline3D.prototype.getArrowShape=function(k,c,g,j,a){if(g!=null&&g!==Polyline.ArrowStyle.NONE){var b=java.awt.geom.AffineTransform.getTranslateInstance(k[0],k[1]);b.rotate(c);b.translate(a,0);var d=Math.pow(j,0.66)*2;b.scale(d,d);var f=new java.awt.geom.GeneralPath();switch(g){case Polyline.ArrowStyle.DISC:f.append(new java.awt.geom.Ellipse2D.Float(-3.5,-2,4,4),false);break;case Polyline.ArrowStyle.OPEN:var h=new java.awt.BasicStroke((j/d/0.9),java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_MITER);f.append(h.createStrokedShape(Polyline3D.ARROW).getPathIterator(java.awt.geom.AffineTransform.getScaleInstance(0.9,0.9),0),false);break;case Polyline.ArrowStyle.DELTA:var e=new java.awt.geom.GeneralPath(Polyline3D.ARROW);e.closePath();f.append(e.getPathIterator(java.awt.geom.AffineTransform.getTranslateInstance(1.65,0),0),false);break;default:return null}return f.createTransformedShape(b)}return null};function Label3D(a,c,b){Object3DBranch.call(this);this.setUserData(a);this.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);this.update()}Label3D.prototype=Object.create(Object3DBranch.prototype);Label3D.prototype.constructor=Label3D;Label3D.dummyContext=document.createElement("canvas").getContext("2d");Label3D.prototype.update=function(){var n=this.getUserData();var o=n.getPitch();var C=n.getStyle();if(o!=null&&C!=null&&(n.getLevel()==null||n.getLevel().isViewableAndVisible())){var t=n.getText();var z=n.getColor();var I=n.getOutlineColor();if(t!=this.text||(C==null&&this.style!=null)||(C!=null&&!C.equals(this.style))||(z==null&&this.color!=null)||(z!=null&&z!==this.color)){var h="";if(C.isBold()){h="bold "}if(C.isItalic()){h+="italic "}var u=C.getFontName();if(u===null){u="sans-serif"}var f=50;var x=f;if(["Times","Serif","Helvetica"].indexOf(u)===-1){x*=1.18}var l=f/C.getFontSize();var F=0.23*x;var v=h+" "+f+"px "+u;Label3D.dummyContext.font=v;var b=t.replace(/\n*$/,"").split("\n");var J=new Array(b.length);var g=-Infinity;var j=-F+x*b.length;for(var A=0;A<b.length;A++){J[A]=Label3D.dummyContext.measureText(b[A]).width;if(C.isItalic()){J[A]+=x*0.154}g=Math.max(J[A],g)}var a=x*b.length;var E=Math.sqrt(g/a);var E=Math.sqrt(g/a);var y;var w;var H;if(E>1){y=Math.ceil(Math.max(255*E,Math.min(g,511*E)));H=y/g;w=Math.ceil(H*a)}else{w=Math.ceil(Math.max(255*E,Math.min(a,511/E)));H=w/a;y=Math.ceil(H*g)}if(y>0&&w>0){var G=document.createElement("canvas");G.width=Appearance3D.getNextHighestPowerOfTwo(y)/2;G.height=Appearance3D.getNextHighestPowerOfTwo(w)/2;G.transparent=true;var e=G.getContext("2d");e.scale(H/y*G.width,H/w*G.height);e.translate(0,j);e.font=v;if(z!==null){e.fillStyle="rgb("+((z>>>16)&255)+","+((z>>>8)&255)+","+(z&255)+")"}if(I!==null){e.strokeStyle="rgb("+((I>>>16)&255)+","+((I>>>8)&255)+","+(I&255)+")"}for(var A=b.length-1;A>=0;A--){var q=b[A];var B;if(C.getAlignment()===TextStyle.Alignment.LEFT){B=0}else{if(C.getAlignment()===TextStyle.Alignment.RIGHT){B=g-J[A]}else{B=(g-J[A])/2}}e.translate(B,0);e.fillText(q,0,0);if(I!==null){e.strokeText(q,0,0)}e.translate(-B,-x)}var d=mat4.create();mat4.scale(d,d,vec3.fromValues(g/l,1,a/l));this.baseLineTransform=mat4.create();var B;if(C.getAlignment()==TextStyle.Alignment.LEFT){B=g/2}else{if(C.getAlignment()==TextStyle.Alignment.RIGHT){B=-g/2}else{B=0}}mat4.fromTranslation(this.baseLineTransform,vec3.fromValues(B/l,0,(a/2-j)/l));mat4.mul(this.baseLineTransform,this.baseLineTransform,d);this.texture=G;this.text=t;this.style=C;this.color=z}else{this.clear()}}if(this.texture!==null){if(this.getChildren().length===0){var m=new BranchGroup3D();var p=new TransformGroup3D();p.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);m.addChild(p);var s=new Appearance3D();this.updateAppearanceMaterial(s,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0);s.setCullFace(Appearance3D.CULL_NONE);var c=new Shape3D(new IndexedTriangleArray3D([vec3.fromValues(-0.5,0,-0.5),vec3.fromValues(-0.5,0,0.5),vec3.fromValues(0.5,0,0.5),vec3.fromValues(0.5,0,-0.5)],[0,1,2,0,2,3],[vec2.fromValues(0,0),vec2.fromValues(1,0),vec2.fromValues(1,1),vec2.fromValues(0,1)],[3,0,1,3,1,2],[vec3.fromValues(0,1,0)],[0,0,0,0,0,0]),s);p.addChild(c);this.addChild(m)}var p=this.getChild(0).getChild(0);var D=mat4.create();mat4.fromXRotation(D,o);mat4.mul(D,D,this.baseLineTransform);var k=mat4.create();mat4.fromYRotation(k,-n.getAngle());mat4.mul(k,k,D);var r=mat4.create();mat4.fromTranslation(r,vec3.fromValues(n.getX(),n.getGroundElevation()+(o==0&&n.getElevation()<0.1?0.1:0),n.getY()));mat4.mul(r,r,k);p.setTransform(r);p.getChild(0).getAppearance().setTextureImage(this.texture)}}else{this.clear()}};Label3D.prototype.clear=function(){this.removeAllChildren();this.text=null;this.style=null;this.color=null;this.texture=null;this.baseLineTransform=null};function TextureManager(){this.loadedTextureImages={};this.loadingTextureObservers={}}TextureManager.READING_TEXTURE="Reading texture";TextureManager.instance=null;TextureManager.getInstance=function(){if(TextureManager.instance==null){TextureManager.instance=new TextureManager()}return TextureManager.instance};TextureManager.prototype.clear=function(){this.loadedTextureImages={};this.loadingTextureObservers={}};TextureManager.prototype.loadTexture=function(d,g,b,c){if(b===undefined){c=g;g=0;b=false}else{if(c===undefined){c=b;b=false}}var f=d.getURL();if(f in this.loadedTextureImages){if(c.textureUpdated!==undefined){c.textureUpdated(this.loadedTextureImages[f])}}else{if(b){var a=this;this.load(f,b,{textureLoaded:function(h){a.loadedTextureImages[f]=h;if(c.textureUpdated!==undefined){c.textureUpdated(h)}},textureError:function(h){if(c.textureError!==undefined){c.textureError(h)}},progression:function(j,k,h){if(c.progression!==undefined){c.progression(j,k,h)}}})}else{if(f in this.loadingTextureObservers){this.loadingTextureObservers[f].push(c)}else{var e=[];e.push(c);this.loadingTextureObservers[f]=e;var a=this;this.load(f,b,{textureLoaded:function(h){var k=a.loadingTextureObservers[f];if(k){delete a.loadingTextureObservers[f];a.loadedTextureImages[f]=h;for(var j=0;j<k.length;j++){if(k[j].textureUpdated!==undefined){k[j].textureUpdated(h)}}}},textureError:function(h){var k=a.loadingTextureObservers[f];if(k){delete a.loadingTextureObservers[f];for(var j=0;j<k.length;j++){if(k[j].textureError!==undefined){k[j].textureError(h)}}}},progression:function(j,l,h){var m=a.loadingTextureObservers[f];if(m){for(var k=0;k<m.length;k++){if(m[k].progression!==undefined){m[k].progression(j,l,h)}}}}})}}}};TextureManager.prototype.load=function(b,a,d){d.progression(TextureManager.READING_TEXTURE,b,0);var h=new Image();h.crossOrigin="anonymous";h.url=b;var e=function(k){h.removeEventListener("load",j);h.removeEventListener("error",e);d.textureError("Can't load "+b)};var j=function(){h.removeEventListener("load",j);h.removeEventListener("error",e);d.progression(TextureManager.READING_TEXTURE,b,1);d.textureLoaded(h)};if(b.indexOf("jar:")===0){var g=b.indexOf("!/");var c=decodeURIComponent(b.substring(g+2));var f=b.substring(4,g);ZIPTools.getZIP(f,a,{zipReady:function(m){try{h.addEventListener("load",j);h.addEventListener("error",e);var k=m.file(c);var o=k.asBinary();var n=btoa(o);h.transparent=ZIPTools.isTransparentImage(o);h.src="data:image;base64,"+n;if(h.width!==0||a){j()}}catch(l){this.zipError(l)}},zipError:function(k){d.textureError("Can't load "+f)},progression:function(l,m,k){d.progression(l,m,k)}})}else{h.addEventListener("load",j);h.addEventListener("error",e);h.src=b;if(h.width!==0){h.removeEventListener("load",j);h.removeEventListener("error",e);d.progression(TextureManager.READING_TEXTURE,b,1);d.textureLoaded(h)}}};TextureManager.prototype.isTextureTransparent=function(a){return a.transparent===true};TextureManager.prototype.getRotatedTextureWidth=function(a){var b=a.getAngle();if(b!==0){return Math.round(Math.abs(a.getWidth()*Math.cos(b))+Math.abs(a.getHeight()*Math.sin(b)))}else{return a.getWidth()}};TextureManager.prototype.getRotatedTextureHeight=function(a){var b=a.getAngle();if(b!==0){return Math.round(Math.abs(a.getWidth()*Math.sin(b))+Math.abs(a.getHeight()*Math.cos(b)))}else{return a.getHeight()}};TextureManager.prototype.getErrorImage=function(){if(TextureManager.errorImage===undefined){TextureManager.errorImage=this.getColoredImage("#FF0000")}return TextureManager.errorImage};TextureManager.prototype.getWaitImage=function(){if(TextureManager.waitImage===undefined){TextureManager.waitImage=this.getColoredImage("#FFFFFF")}return TextureManager.waitImage};TextureManager.prototype.getColoredImage=function(b){var c=document.createElement("canvas");c.width=2;c.height=2;var d=c.getContext("2d");d.fillStyle=b;d.fillRect(0,0,2,2);var e=c.toDataURL();var a=new Image();a.url=e;a.src=e;return a};var LengthUnit={};LengthUnit.getMagnetizedMeterLength=function(d,a){a*=2;var b=1/10;if(a>100){b=100}else{if(a>10){b=10}else{if(a>5){b=5}else{if(a>1){b=1}else{if(a>0.5){b=0.5}}}}}var c=Math.round(d/b)*b;if(c===0&&d>0){return d}else{return c}};LengthUnit.getMagnetizedInchLength=function(d,a){a=LengthUnit.centimeterToInch(a)*2;var b=1/8;if(a>6){b=6}else{if(a>3){b=3}else{if(a>1){b=1}else{if(a>0.5){b=0.5}else{if(a>0.25){b=0.25}}}}}var c=LengthUnit.inchToCentimeter(Math.round(LengthUnit.centimeterToInch(d)/b)*b);if(c===0&&d>0){return d}else{return c}};LengthUnit.centimeterToInch=function(a){return a/2.54};LengthUnit.centimeterToFoot=function(a){return a/2.54/12};LengthUnit.inchToCentimeter=function(a){return a*2.54};LengthUnit.footToCentimeter=function(a){return a*2.54*12};LengthUnit.nameOf=function(c){if(c!=null){var d=Object.keys(LengthUnit);for(var a=0;a<d.length;a++){var b=d[a];if(LengthUnit[b]==c){return b}}}return null};LengthUnit.valueOf=function(a){return LengthUnit[a]};LengthUnit.MILLIMETER={formatLocale:null};LengthUnit.MILLIMETER.name=function(){return LengthUnit.nameOf(this)};LengthUnit.MILLIMETER.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormatWithUnit};LengthUnit.MILLIMETER.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.MILLIMETER.getFormat=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.MILLIMETER.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.MILLIMETER.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var b=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(b,"millimeterUnit");this.lengthFormatWithUnit=new MeterFamilyFormat("0",10,this.unitName);this.lengthFormat=new MeterFamilyFormat("0",10);var a=CoreTools.getStringFromKey(b,"squareMeterUnit");this.areaFormatWithUnit=new SquareMeterAreaFormatWithUnit(a)}};LengthUnit.MILLIMETER.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedMeterLength(b,a)};LengthUnit.MILLIMETER.getMinimumLength=function(){return 0.1};LengthUnit.MILLIMETER.getMaximumLength=function(){return 100000};LengthUnit.MILLIMETER.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.MILLIMETER.getStepSize=function(){return 0.5};LengthUnit.MILLIMETER.centimeterToUnit=function(a){return a*10};LengthUnit.MILLIMETER.unitToCentimeter=function(a){return a/10};LengthUnit.CENTIMETER={formatLocale:null};LengthUnit.CENTIMETER.name=function(){return LengthUnit.nameOf(this)};LengthUnit.CENTIMETER.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormatWithUnit};LengthUnit.CENTIMETER.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.CENTIMETER.getFormat=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.CENTIMETER.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.CENTIMETER.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var b=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(b,"centimeterUnit");this.lengthFormatWithUnit=new MeterFamilyFormat("0.#",1,this.unitName);this.lengthFormat=new MeterFamilyFormat("0.#",1);var a=CoreTools.getStringFromKey(b,"squareMeterUnit");this.areaFormatWithUnit=new SquareMeterAreaFormatWithUnit(a)}};LengthUnit.CENTIMETER.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedMeterLength(b,a)};LengthUnit.CENTIMETER.getMinimumLength=function(){return 0.1};LengthUnit.CENTIMETER.getMaximumLength=function(){return 100000};LengthUnit.CENTIMETER.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.CENTIMETER.getStepSize=function(){return 0.5};LengthUnit.CENTIMETER.centimeterToUnit=function(a){return a};LengthUnit.CENTIMETER.unitToCentimeter=function(a){return a};LengthUnit.METER={formatLocale:null};LengthUnit.METER.name=function(){return LengthUnit.nameOf(this)};LengthUnit.METER.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormatWithUnit};LengthUnit.METER.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.METER.getFormat=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.METER.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.METER.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var b=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(b,"meterUnit");this.lengthFormatWithUnit=new MeterFamilyFormat("0.00#",0.01,this.unitName);this.lengthFormat=new MeterFamilyFormat("0.00#",0.01);var a=CoreTools.getStringFromKey(b,"squareMeterUnit");this.areaFormatWithUnit=new SquareMeterAreaFormatWithUnit(a)}};LengthUnit.METER.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedMeterLength(b,a)};LengthUnit.METER.getMinimumLength=function(){return 0.1};LengthUnit.METER.getMaximumLength=function(){return 100000};LengthUnit.METER.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.METER.getStepSize=function(){return 0.5};LengthUnit.METER.centimeterToUnit=function(a){return a/100};LengthUnit.METER.unitToCentimeter=function(a){return a*100};LengthUnit.INCH={formatLocale:null};LengthUnit.INCH.name=function(){return LengthUnit.nameOf(this)};LengthUnit.INCH.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.INCH.getFormat=function(){return this.getFormatWithUnit()};LengthUnit.INCH.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.INCH.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.INCH.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var c=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(c,"inchUnit");var a=CoreTools.getStringFromKey(c,"footInchSeparator");this.lengthFormat=new InchFormat(a);var b=CoreTools.getStringFromKey(c,"squareFootUnit");this.areaFormatWithUnit=new SquareFootAreaFormatWithUnit("0",b)}};LengthUnit.INCH.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedInchLength(b,a)};LengthUnit.INCH.getMinimumLength=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.INCH.getMaximumLength=function(){return LengthUnit.inchToCentimeter(99974.4)};LengthUnit.INCH.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.INCH.getStepSize=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.INCH.centimeterToUnit=function(a){return LengthUnit.centimeterToInch(a)};LengthUnit.INCH.unitToCentimeter=function(a){return LengthUnit.inchToCentimeter(a)};LengthUnit.INCH_DECIMALS={formatLocale:null};LengthUnit.INCH_DECIMALS.name=function(){return LengthUnit.nameOf(this)};LengthUnit.INCH_DECIMALS.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormatWithUnit};LengthUnit.INCH_DECIMALS.getFormat=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.INCH_DECIMALS.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.INCH_DECIMALS.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.INCH_DECIMALS.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var b=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(b,"inchUnit");this.lengthFormat=new InchDecimalsFormat("0.###");this.lengthFormatWithUnit=new InchDecimalsFormat("0.###",'"');var a=CoreTools.getStringFromKey(b,"squareFootUnit");this.areaFormatWithUnit=new SquareFootAreaFormatWithUnit("0.##",a)}};LengthUnit.INCH_DECIMALS.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedInchLength(b,a)};LengthUnit.INCH_DECIMALS.getMinimumLength=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.INCH_DECIMALS.getMaximumLength=function(){return LengthUnit.inchToCentimeter(99974.4)};LengthUnit.INCH_DECIMALS.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.INCH_DECIMALS.getStepSize=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.INCH_DECIMALS.centimeterToUnit=function(a){return centimeterToInch(a)};LengthUnit.INCH_DECIMALS.unitToCentimeter=function(a){return LengthUnit.inchToCentimeter(a)};function MeterFamilyFormat(c,a,b){DecimalFormat.call(this,c);this.setGroupingUsed(true);this.unitMultiplier=a;this.unit=b}MeterFamilyFormat.prototype=Object.create(DecimalFormat.prototype);MeterFamilyFormat.prototype.constructor=MeterFamilyFormat;MeterFamilyFormat.prototype.format=function(a){var b=DecimalFormat.prototype.format.call(this,a*this.unitMultiplier);return b+(this.unit?" "+this.unit:"")};MeterFamilyFormat.prototype.parse=function(c,b){var a=DecimalFormat.prototype.parse.call(this,c,b);if(a===null){return null}else{return a/this.unitMultiplier}};function SquareMeterAreaFormatWithUnit(a){DecimalFormat.call(this,"0.##");this.setGroupingUsed(true);this.squareMeterUnit=a}SquareMeterAreaFormatWithUnit.prototype=Object.create(DecimalFormat.prototype);SquareMeterAreaFormatWithUnit.prototype.constructor=SquareMeterAreaFormatWithUnit;SquareMeterAreaFormatWithUnit.prototype.format=function(a){var b=DecimalFormat.prototype.format.call(this,a/10000);return b+(this.squareMeterUnit?" "+this.squareMeterUnit:"")};var inchFractionCharacters=["\u215b","\u00bc","\u215c","\u00bd","\u215d","\u00be","\u215e"];function InchFormat(a){DecimalFormat.call(this,"0.###");this.setGroupingUsed(true);this.footInchSeparator=a}InchFormat.prototype=Object.create(DecimalFormat.prototype);InchFormat.prototype.constructor=InchFormat;InchFormat.prototype.format=function(f){var g=Math.abs(f);var b=Math.floor(LengthUnit.centimeterToFoot(g));var e=LengthUnit.centimeterToInch(g-LengthUnit.footToCentimeter(b));if(e>=11.9375){b++;e-=12}var j=f>=0?"":"-";var a=DecimalFormat.prototype.format.call(this,b);if(e>=0.0005){var c=Math.floor(e);var d=e-c;var h=Math.round(d*8);j+=a;if(h===0||h===8){j+="'";j+=Math.round(e*8)/8;j+='"'}else{j+="'";j+=c;j+=inchFractionCharacters[h-1];j+='"'}}else{j+=a;j+="'"}return j};var inchFractionStrings=["1/8","1/4","3/8","1/2","5/8","3/4","7/8"];InchFormat.prototype.parse=function(o,k){var m=0;var n=new ParsePosition(k.getIndex());this.skipWhiteSpaces(o,n);var f=NumberFormat.getIntegerInstance();var d=o.indexOf("'",k.getIndex());var e=n.getIndex()<o.length&&o.charAt(n.getIndex())==="-";var h=false;if(d!==-1){var b=f.parse(o,n);if(b===null){k.setErrorIndex(n.getErrorIndex());return null}this.skipWhiteSpaces(o,n);if(n.getIndex()===d){m=LengthUnit.footToCentimeter(b);h=true;n=new ParsePosition(d+1);this.skipWhiteSpaces(o,n);if(n.getIndex()<o.length&&this.footInchSeparator.indexOf(o.charAt(n.getIndex()))>=0){n.setIndex(n.getIndex()+1);this.skipWhiteSpaces(o,n)}if(n.getIndex()===o.length){k.setIndex(o.length);return m}}else{if(this.decimalSeparator===o.charAt(n.getIndex())){var p=new ParsePosition(k.getIndex());if(DecimalFormat.prototype.parse.call(this,o,p)!==null&&p.getIndex()===d){k.setErrorIndex(n.getErrorIndex());return null}}n.setIndex(k.getIndex())}}var c=DecimalFormat.prototype.parse.call(this,o,n);if(c===null){if(h){k.setIndex(n.getIndex());return m}else{k.setErrorIndex(n.getErrorIndex());return null}}if(e){if(d===-1){m=LengthUnit.inchToCentimeter(c)}else{m-=LengthUnit.inchToCentimeter(c)}}else{m+=LengthUnit.inchToCentimeter(c)}this.skipWhiteSpaces(o,n);if(n.getIndex()===o.length){k.setIndex(o.length);return m}if(o.charAt(n.getIndex())==='"'){k.setIndex(n.getIndex()+1);return m}var a=o.charAt(n.getIndex());var j=o.length-n.getIndex()>=3?o.substring(n.getIndex(),n.getIndex()+3):null;for(var g=0;g<inchFractionCharacters.length;g++){if(inchFractionCharacters[g]===a||inchFractionStrings[g]==j){var l=o.lastIndexOf(this.decimalSeparator,n.getIndex()-1);if(l>d){return null}else{if(e){m-=LengthUnit.inchToCentimeter((g+1)/8)}else{m+=LengthUnit.inchToCentimeter((g+1)/8)}k.setIndex(n.getIndex()+(inchFractionCharacters[g]===a?1:3));this.skipWhiteSpaces(o,k);if(k.getIndex()<o.length&&o.charAt(k.getIndex())==='"'){k.setIndex(k.getIndex()+1)}return m}}}k.setIndex(n.getIndex());return m};InchFormat.prototype.skipWhiteSpaces=function(b,a){while(a.getIndex()<b.length&&/\s/.test(b.charAt(a.getIndex()))){a.setIndex(a.getIndex()+1)}};function SquareFootAreaFormatWithUnit(b,a){DecimalFormat.call(this,b);this.setGroupingUsed(true);this.unit=a}SquareFootAreaFormatWithUnit.prototype=Object.create(DecimalFormat.prototype);SquareFootAreaFormatWithUnit.prototype.constructor=SquareFootAreaFormatWithUnit;SquareFootAreaFormatWithUnit.prototype.format=function(a){var b=DecimalFormat.prototype.format.call(this,a/929.0304);return b+(this.unit?" "+this.unit:"")};function InchDecimalsFormat(b,a){DecimalFormat.call(this,b);this.setGroupingUsed(true);this.unit=a}InchDecimalsFormat.prototype=Object.create(DecimalFormat.prototype);InchDecimalsFormat.prototype.constructor=InchDecimalsFormat;InchDecimalsFormat.prototype.format=function(a){var b=DecimalFormat.prototype.format.call(this,LengthUnit.centimeterToInch(a));return b+(this.unit?this.unit:"")};InchDecimalsFormat.prototype.parse=function(e,a){var d=new ParsePosition(a.getIndex());this.skipWhiteSpaces(e,d);var c=DecimalFormat.prototype.parse.call(this,e,d);if(c===null){a.setErrorIndex(d.getErrorIndex());return null}var b=LengthUnit.inchToCentimeter(c);this.skipWhiteSpaces(e,d);if(d.getIndex()<e.length&&e.charAt(d.getIndex())==='"'){a.setIndex(d.getIndex()+1)}else{a.setIndex(d.getIndex())}return b};InchDecimalsFormat.prototype.skipWhiteSpaces=function(b,a){while(a.getIndex()<b.length&&/\s/.test(b.charAt(a.getIndex()))){a.setIndex(a.getIndex()+1)}};function UserPreferences(){this.propertyChangeSupport=new PropertyChangeSupport(this);this.initSupportedLanguages(UserPreferences.DEFAULT_SUPPORTED_LANGUAGES);this.resourceBundles=[];this.furnitureCatalogResourceBundles=[];this.texturesCatalogResourceBundles=[];this.furnitureCatalog=null;this.texturesCatalog=null;this.patternsCatalog=null;this.currency=null;this.valueAddedTaxEnabled=false;this.defaultValueAddedTaxPercentage=null;this.unit=null;this.furnitureCatalogViewedInTree=false;this.aerialViewCenteredOnSelectionEnabled=false;this.observerCameraSelectedAtChange=true;this.navigationPanelVisible=true;this.magnetismEnabled=true;this.rulersVisible=true;this.gridVisible=true;this.defaultFontName=null;this.furnitureViewedFromTop=true;this.furnitureModelIconSize=128;this.roomFloorColoredOrTextured=true;this.wallPattern=null;this.newWallPattern=null;this.newWallThickness=7.5;this.newWallHeight=250;this.newWallBaseboardThickness=1;this.newWallBaseboardHeight=7;this.newRoomFloorColor=null;this.newFloorThickness=12;this.recentHomes=[];this.autoSaveDelayForRecovery;this.autoCompletionStrings={};this.recentColors=[];this.recentTextures=[];this.homeExamples=[];this.ignoredActionTips={}}UserPreferences.DEFAULT_SUPPORTED_LANGUAGES=["bg","cs","de","el","en","es","fr","it","ja","hu","nl","pl","pt","ru","sv","vi","zh_CN","zh_TW"];UserPreferences.DEFAULT_TEXT_STYLE=new TextStyle(18);UserPreferences.DEFAULT_ROOM_TEXT_STYLE=new TextStyle(24);UserPreferences.prototype.initSupportedLanguages=function(a){this.supportedLanguages=a;if(!this.language||this.supportedLanguages.indexOf(this.language)===-1){var d=Locale.getDefault();if(d===null){d="en"}this.defaultCountry="";var e=d;if(d.indexOf("_")>0){this.defaultCountry=d.substring(d.indexOf("_")+1,d.length);e=this.language?this.language.substring(0,this.language.indexOf("_")):d.substring(0,d.indexOf("_"))}for(var b=0;b<this.supportedLanguages.length;b++){var c=this.supportedLanguages[b];if(this.defaultCountry!=""&&c==e+"_"+this.defaultCountry||this.defaultCountry==""&&c==e){this.language=c;break}else{if(this.language===undefined&&c.indexOf(e)===0){this.language=c}}}if(this.language===undefined){this.language="en"}this.updateDefaultLocale()}};UserPreferences.prototype.updateDefaultLocale=function(){if(this.language.indexOf("_")!==-1||this.defaultCountry==""){Locale.setDefault(this.language)}else{Locale.setDefault(this.language+"_"+this.defaultCountry)}};UserPreferences.prototype.write=function(){};UserPreferences.prototype.addPropertyChangeListener=function(a){this.propertyChangeSupport.addPropertyChangeListener(a)};UserPreferences.prototype.removePropertyChangeListener=function(a){this.propertyChangeSupport.removePropertyChangeListener(a)};UserPreferences.prototype.addPropertyChangeListener=function(b,a){this.propertyChangeSupport.addPropertyChangeListener(b,a)};UserPreferences.prototype.removePropertyChangeListener=function(b,a){this.propertyChangeSupport.removePropertyChangeListener(b,a)};UserPreferences.prototype.getFurnitureCatalog=function(){return this.furnitureCatalog};UserPreferences.prototype.setFurnitureCatalog=function(a){this.furnitureCatalog=a};UserPreferences.prototype.getTexturesCatalog=function(){return this.texturesCatalog};UserPreferences.prototype.setTexturesCatalog=function(a){this.texturesCatalog=a};UserPreferences.prototype.getPatternsCatalog=function(){return this.patternsCatalog};UserPreferences.prototype.setPatternsCatalog=function(a){this.patternsCatalog=a};UserPreferences.prototype.getLengthUnit=function(){return this.unit};UserPreferences.prototype.setUnit=function(a){if(this.unit!==a){var b=this.unit;this.unit=a;this.propertyChangeSupport.firePropertyChange("UNIT",b,a)}};UserPreferences.prototype.getLanguage=function(){return this.language};UserPreferences.prototype.setLanguage=function(b){if(b!=this.language&&this.isLanguageEditable()){var a=this.language;this.language=b;this.updateDefaultLocale();this.resourceBundles=[];this.furnitureCatalogResourceBundles=[];this.texturesCatalogResourceBundles=[];this.propertyChangeSupport.firePropertyChange("LANGUAGE",a,b)}};UserPreferences.prototype.isLanguageEditable=function(){return true};UserPreferences.prototype.getDefaultSupportedLanguages=function(){return UserPreferences.DEFAULT_SUPPORTED_LANGUAGES.slice(0)};UserPreferences.prototype.getSupportedLanguages=function(){return this.supportedLanguages.slice(0)};UserPreferences.prototype.setSupportedLanguages=function(a){if(this.supportedLanguages!=a){var c=this.supportedLanguages;var b=this.language;this.initSupportedLanguages(a.slice(0));this.propertyChangeSupport.firePropertyChange("SUPPORTED_LANGUAGES",c,a);if(b!=this.language){this.propertyChangeSupport.firePropertyChange("LANGUAGE",b,language)}}};UserPreferences.prototype.getLocalizedString=function(a,c,e){this.getResourceBundles(a);if(a=="DefaultFurnitureCatalog"){return CoreTools.getStringFromKey.apply(null,[this.furnitureCatalogResourceBundles,c].concat(Array.prototype.slice.call(arguments,2)))}else{if(a=="DefaultTexturesCatalog"){return CoreTools.getStringFromKey.apply(null,[this.texturesCatalogResourceBundles,c].concat(Array.prototype.slice.call(arguments,2)))}else{if(a.__class){var d=a.__class.split(".");a=d[d.length-1]}var b=a+"."+c;return CoreTools.getStringFromKey.apply(null,[this.resourceBundles,b].concat(Array.prototype.slice.call(arguments,2)))}}};UserPreferences.prototype.getLocalizedStringKeys=function(c){if(resourceClass=="DefaultFurnitureCatalog"){var b={};for(var a=0;a<resourceBundles.length;a++){if(resourceBundles[a]!=null){CoreTools.merge(b,resourceBundles[a])}}return Object.getOwnPropertyNames(b)}else{throw new IllegalArgumentException("unsupported family")}};UserPreferences.prototype.getResourceBundles=function(a){if(a=="DefaultFurnitureCatalog"){if(this.furnitureCatalogResourceBundles.length==0){this.furnitureCatalogResourceBundles=CoreTools.loadResourceBundles("resources/DefaultFurnitureCatalog",Locale.getDefault())}return this.furnitureCatalogResourceBundles}else{if(a=="DefaultTexturesCatalog"){if(this.texturesCatalogResourceBundles.length==0){this.texturesCatalogResourceBundles=CoreTools.loadResourceBundles("resources/DefaultTexturesCatalog",Locale.getDefault())}return this.texturesCatalogResourceBundles}else{if(this.resourceBundles.length==0){this.resourceBundles=CoreTools.loadResourceBundles("resources/localization",Locale.getDefault())}return this.resourceBundles}}};UserPreferences.prototype.getCurrency=function(){return this.currency};UserPreferences.prototype.setCurrency=function(a){if(a!=this.currency){var b=this.currency;this.currency=a;this.propertyChangeSupport.firePropertyChange("CURRENCY",b,a)}};UserPreferences.prototype.isValueAddedTaxEnabled=function(){return this.valueAddedTaxEnabled};UserPreferences.prototype.setValueAddedTaxEnabled=function(a){if(this.valueAddedTaxEnabled!==a){this.valueAddedTaxEnabled=a;this.propertyChangeSupport.firePropertyChange("VALUE_ADDED_TAX_ENABLED",!a,a)}};UserPreferences.prototype.getDefaultValueAddedTaxPercentage=function(){return this.defaultValueAddedTaxPercentage};UserPreferences.prototype.setDefaultValueAddedTaxPercentage=function(b){if(b!==this.defaultValueAddedTaxPercentage&&(b==null||this.defaultValueAddedTaxPercentage==null||!b.eq(this.defaultValueAddedTaxPercentage))){var a=this.defaultValueAddedTaxPercentage;this.defaultValueAddedTaxPercentage=b;this.propertyChangeSupport.firePropertyChange("DEFAULT_VALUE_ADDED_TAX_PERCENTAGE",a,b)}};UserPreferences.prototype.isFurnitureCatalogViewedInTree=function(){return this.furnitureCatalogViewedInTree};UserPreferences.prototype.setFurnitureCatalogViewedInTree=function(a){if(this.furnitureCatalogViewedInTree!==a){this.furnitureCatalogViewedInTree=a;this.propertyChangeSupport.firePropertyChange("FURNITURE_CATALOG_VIEWED_IN_TREE",!a,a)}};UserPreferences.prototype.isNavigationPanelVisible=function(){return this.navigationPanelVisible};UserPreferences.prototype.setNavigationPanelVisible=function(a){if(this.navigationPanelVisible!==a){this.navigationPanelVisible=a;this.propertyChangeSupport.firePropertyChange("NAVIGATION_PANEL_VISIBLE",!a,a)}};UserPreferences.prototype.setAerialViewCenteredOnSelectionEnabled=function(a){if(a!==this.aerialViewCenteredOnSelectionEnabled){this.aerialViewCenteredOnSelectionEnabled=a;this.propertyChangeSupport.firePropertyChange("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",!a,a)}};UserPreferences.prototype.isAerialViewCenteredOnSelectionEnabled=function(){return this.aerialViewCenteredOnSelectionEnabled};UserPreferences.prototype.setObserverCameraSelectedAtChange=function(a){if(a!==this.observerCameraSelectedAtChange){this.observerCameraSelectedAtChange=a;this.propertyChangeSupport.firePropertyChange("OBSERVER_CAMERA_SELECTED_AT_CHANGE",!a,a)}};UserPreferences.prototype.isObserverCameraSelectedAtChange=function(){return this.observerCameraSelectedAtChange};UserPreferences.prototype.isMagnetismEnabled=function(){return this.magnetismEnabled};UserPreferences.prototype.setMagnetismEnabled=function(a){if(this.magnetismEnabled!==a){this.magnetismEnabled=a;this.propertyChangeSupport.firePropertyChange("MAGNETISM_ENABLED",!a,a)}};UserPreferences.prototype.isRulersVisible=function(){return this.rulersVisible};UserPreferences.prototype.setRulersVisible=function(a){if(this.rulersVisible!==a){this.rulersVisible=a;this.propertyChangeSupport.firePropertyChange("RULERS_VISIBLE",!a,a)}};UserPreferences.prototype.isGridVisible=function(){return this.gridVisible};UserPreferences.prototype.setGridVisible=function(a){if(this.gridVisible!==a){this.gridVisible=a;this.propertyChangeSupport.firePropertyChange("GRID_VISIBLE",!a,a)}};UserPreferences.prototype.getDefaultFontName=function(){return this.defaultFontName};UserPreferences.prototype.setDefaultFontName=function(b){if(b!=this.defaultFontName){var a=this.defaultFontName;this.defaultFontName=b;this.propertyChangeSupport.firePropertyChange("DEFAULT_FONT_NAME",a,b)}};UserPreferences.prototype.isFurnitureViewedFromTop=function(){return this.furnitureViewedFromTop};UserPreferences.prototype.setFurnitureViewedFromTop=function(a){if(this.furnitureViewedFromTop!==a){this.furnitureViewedFromTop=a;this.propertyChangeSupport.firePropertyChange("FURNITURE_VIEWED_FROM_TOP",!a,a)}};UserPreferences.prototype.getFurnitureModelIconSize=function(){return this.furnitureModelIconSize};UserPreferences.prototype.setFurnitureModelIconSize=function(a){if(a!==this.furnitureModelIconSize){var b=this.furnitureModelIconSize;this.furnitureModelIconSize=a;this.propertyChangeSupport.firePropertyChange("FURNITURE_MODEL_ICON_SIZE",b,a)}};UserPreferences.prototype.isRoomFloorColoredOrTextured=function(){return this.roomFloorColoredOrTextured};UserPreferences.prototype.setFloorColoredOrTextured=function(a){if(this.roomFloorColoredOrTextured!==a){this.roomFloorColoredOrTextured=a;this.propertyChangeSupport.firePropertyChange("ROOM_FLOOR_COLORED_OR_TEXTURED",!a,a)}};UserPreferences.prototype.getWallPattern=function(){return this.wallPattern};UserPreferences.prototype.setWallPattern=function(a){if(this.wallPattern!==a){var b=this.wallPattern;this.wallPattern=a;this.propertyChangeSupport.firePropertyChange("WALL_PATTERN",b,a)}};UserPreferences.prototype.getNewWallPattern=function(){return this.newWallPattern};UserPreferences.prototype.setNewWallPattern=function(a){if(this.newWallPattern!==a){var b=this.newWallPattern;this.newWallPattern=a;this.propertyChangeSupport.firePropertyChange("NEW_WALL_PATTERN",b,a)}};UserPreferences.prototype.getNewWallThickness=function(){return this.newWallThickness};UserPreferences.prototype.setNewWallThickness=function(b){if(this.newWallThickness!==b){var a=this.newWallThickness;this.newWallThickness=b;this.propertyChangeSupport.firePropertyChange("NEW_WALL_THICKNESS",a,b)}};UserPreferences.prototype.getNewWallHeight=function(){return this.newWallHeight};UserPreferences.prototype.setNewWallHeight=function(a){if(this.newWallHeight!==a){var b=this.newWallHeight;this.newWallHeight=a;this.propertyChangeSupport.firePropertyChange("NEW_WALL_HEIGHT",b,a)}};UserPreferences.prototype.getNewWallBaseboardThickness=function(){return this.newWallBaseboardThickness};UserPreferences.prototype.setNewWallBaseboardThickness=function(b){if(this.newWallBaseboardThickness!==b){var a=this.newWallBaseboardThickness;this.newWallBaseboardThickness=b;this.propertyChangeSupport.firePropertyChange("NEW_WALL_SIDEBOARD_THICKNESS",a,b)}};UserPreferences.prototype.getNewWallBaseboardHeight=function(){return this.newWallBaseboardHeight};UserPreferences.prototype.setNewWallBaseboardHeight=function(a){if(this.newWallBaseboardHeight!==a){var b=this.newWallBaseboardHeight;this.newWallBaseboardHeight=a;this.propertyChangeSupport.firePropertyChange("NEW_WALL_SIDEBOARD_HEIGHT",b,a)}};UserPreferences.prototype.getNewRoomFloorColor=function(){return this.newRoomFloorColor};UserPreferences.prototype.setNewRoomFloorColor=function(b){if(this.newRoomFloorColor!==b){var a=this.newRoomFloorColor;this.newRoomFloorColor=b;this.propertyChangeSupport.firePropertyChange("NEW_ROOM_FLOOR_COLOR",a,b)}};UserPreferences.prototype.getNewFloorThickness=function(){return this.newFloorThickness};UserPreferences.prototype.setNewFloorThickness=function(a){if(this.newFloorThickness!==a){var b=this.newFloorThickness;this.newFloorThickness=a;this.propertyChangeSupport.firePropertyChange("NEW_FLOOR_THICKNESS",b,a)}};UserPreferences.prototype.getAutoSaveDelayForRecovery=function(){return this.autoSaveDelayForRecovery};UserPreferences.prototype.setAutoSaveDelayForRecovery=function(b){if(this.autoSaveDelayForRecovery!==b){var a=this.autoSaveDelayForRecovery;this.autoSaveDelayForRecovery=b;this.propertyChangeSupport.firePropertyChange("AUTO_SAVE_DELAY_FOR_RECOVERY",a,b)}};UserPreferences.prototype.getRecentHomes=function(){return this.recentHomes.slice(0)};UserPreferences.prototype.setRecentHomes=function(b){if(b!=this.recentHomes){var a=this.recentHomes;this.recentHomes=b.slice(0);this.propertyChangeSupport.firePropertyChange("RECENT_HOMES",a,this.getRecentHomes())}};UserPreferences.prototype.getRecentHomesMaxCount=function(){return 10};UserPreferences.prototype.getStoredCamerasMaxCount=function(){return 50};UserPreferences.prototype.setActionTipIgnored=function(a){this.propertyChangeSupport.firePropertyChange("IGNORED_ACTION_TIP",null,a)};UserPreferences.prototype.isActionTipIgnored=function(a){return true};UserPreferences.prototype.resetIgnoredActionTips=function(){this.propertyChangeSupport.firePropertyChange("IGNORED_ACTION_TIP",null,null)};UserPreferences.prototype.getDefaultTextStyle=function(a){if(a.name=="Room"){return UserPreferences.DEFAULT_ROOM_TEXT_STYLE}else{return UserPreferences.DEFAULT_TEXT_STYLE}};UserPreferences.prototype.getAutoCompletionStrings=function(b){var a=this.autoCompletionStrings.get(b);if(a!==undefined){return a.slice(0)}else{return[]}};UserPreferences.prototype.addAutoCompletionString=function(c,b){if(b!==null&&b.length>0){var a=this.autoCompletionStrings[c];if(a===undefined){a=[]}else{if(a.indexOf(b)<0){a=a.slice(0)}else{return}}a.splice(0,0,b);this.setAutoCompletionStrings(c,a)}};UserPreferences.prototype.setAutoCompletionStrings=function(b,c){var a=this.autoCompletionStrings[b];if(c!=a){this.autoCompletionStrings[b]=c.slice(0);this.propertyChangeSupport.firePropertyChange("AUTO_COMPLETION_STRINGS",null,b)}};UserPreferences.prototype.getAutoCompletedProperties=function(){if(this.autoCompletionStrings!==null){return Object.keys(this.autoCompletionStrings)}else{return[]}};UserPreferences.prototype.getRecentColors=function(){return this.recentColors};UserPreferences.prototype.setRecentColors=function(a){if(a!=this.recentColors){var b=this.recentColors;this.recentColors=a.slice(0);this.propertyChangeSupport.firePropertyChange("RECENT_COLORS",b,this.getRecentColors())}};UserPreferences.prototype.getRecentTextures=function(){return this.recentTextures};UserPreferences.prototype.setRecentTextures=function(b){if(b!=this.recentTextures){var a=this.recentTextures;this.recentTextures=b.slice(0);this.propertyChangeSupport.firePropertyChange("RECENT_TEXTURES",a,this.getRecentTextures())}};UserPreferences.prototype.setHomeExamples=function(a){if(a!=this.homeExamples){var b=this.homeExamples;this.homeExamples=a.slice(0);this.propertyChangeSupport.firePropertyChange("HOME_EXAMPLES",b,this.getHomeExamples())}};UserPreferences.prototype.getHomeExamples=function(){return this.homeExamples};UserPreferences.prototype.isCheckUpdatesEnabled=function(){};UserPreferences.prototype.setCheckUpdatesEnabled=function(a){};UserPreferences.prototype.isImportedImageResizedWithoutPrompting=function(){return true};function DefaultUserPreferences(b,a,f,d){UserPreferences.call(this);this.furnitureCatalogUrls=b;this.furnitureResourcesUrlBase=a;this.texturesCatalogUrls=f;this.texturesResourcesUrlBase=d;var c=[];c.push(new DefaultPatternTexture("foreground"));c.push(new DefaultPatternTexture("reversedHatchUp"));c.push(new DefaultPatternTexture("reversedHatchDown"));c.push(new DefaultPatternTexture("reversedCrossHatch"));c.push(new DefaultPatternTexture("background"));c.push(new DefaultPatternTexture("hatchUp"));c.push(new DefaultPatternTexture("hatchDown"));c.push(new DefaultPatternTexture("crossHatch"));var e=new PatternsCatalog(c);this.setPatternsCatalog(e);this.setFurnitureCatalog(typeof DefaultFurnitureCatalog==="function"?(Array.isArray(b)?new DefaultFurnitureCatalog(b,a):new DefaultFurnitureCatalog(this)):new FurnitureCatalog());this.setTexturesCatalog(typeof DefaultTexturesCatalog==="function"?(Array.isArray(f)?new DefaultTexturesCatalog(f,d):new DefaultTexturesCatalog(this)):new TexturesCatalog());if(Locale.getDefault()=="en_US"){this.setUnit(LengthUnit.INCH);this.setNewWallThickness(7.62);this.setNewWallHeight(243.84);this.setNewWallBaseboardThickness(0.9525);this.setNewWallBaseboardHeight(6.35)}else{this.setUnit(LengthUnit.CENTIMETER);this.setNewWallThickness(7.5);this.setNewWallHeight(250);this.setNewWallBaseboardThickness(1);this.setNewWallBaseboardHeight(7)}this.setNavigationPanelVisible(false);this.setWallPattern(e.getPattern("hatchUp"));this.setNewWallPattern(this.getWallPattern());this.setAerialViewCenteredOnSelectionEnabled(true)}DefaultUserPreferences.prototype=Object.create(UserPreferences.prototype);DefaultUserPreferences.prototype.constructor=DefaultUserPreferences;DefaultUserPreferences.prototype.write=function(){UserPreferences.prototype.write.call(this)};function DefaultPatternTexture(a){this.name=a;this.image=new URLContent(ZIPTools.getScriptFolder()+"/resources/patterns/"+this.name+".png")}DefaultPatternTexture.__class="com.eteks.sweethome3d.io.DefaultPatternTexture";DefaultPatternTexture.__interfaces=["com.eteks.sweethome3d.model.TextureImage"];DefaultPatternTexture.__transients=["image"];DefaultPatternTexture.prototype.getName=function(){return this.name};DefaultPatternTexture.prototype.getCreator=function(){return null};DefaultPatternTexture.prototype.getImage=function(){return this.image};DefaultPatternTexture.prototype.getWidth=function(){return 10};DefaultPatternTexture.prototype.getHeight=function(){return 10};DefaultPatternTexture.prototype.equals=function(b){if(b===this){return true}else{if(b instanceof DefaultPatternTexture){var a=b;return a.name==this.name}else{return false}}};function RecordedUserPreferences(c){UserPreferences.call(this);if(c!==undefined){this.furnitureCatalogUrls=c.furnitureCatalogURLs;this.furnitureResourcesUrlBase=c.furnitureResourcesURLBase;this.texturesCatalogUrls=c.texturesCatalogURLs;this.texturesResourcesUrlBase=c.texturesResourcesURLBase;this.writePreferencesUrl=c.writePreferencesURL;this.readPreferencesUrl=c.readPreferencesURL;this.writeResourceUrl=c.writeResourceURL;this.readResourceUrl=c.readResourceURL;this.writingObserver=c.writingObserver}var b;if(c!==undefined&&c.userLanguage!==undefined){b=c.userLanguage}else{b=this.getLanguage()}var a=this.getProperties();this.updatePreferencesFromProperties(a,b);this.uploadingBlobs={}}RecordedUserPreferences.prototype=Object.create(UserPreferences.prototype);RecordedUserPreferences.prototype.constructor=RecordedUserPreferences;RecordedUserPreferences.LANGUAGE="language";RecordedUserPreferences.UNIT="unit";RecordedUserPreferences.CURRENCY="currency";RecordedUserPreferences.VALUE_ADDED_TAX_ENABLED="valueAddedTaxEnabled";RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE="defaultValueAddedTaxPercentage";RecordedUserPreferences.FURNITURE_CATALOG_VIEWED_IN_TREE="furnitureCatalogViewedInTree";RecordedUserPreferences.NAVIGATION_PANEL_VISIBLE="navigationPanelVisible";RecordedUserPreferences.AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED="aerialViewCenteredOnSelectionEnabled";RecordedUserPreferences.OBSERVER_CAMERA_SELECTED_AT_CHANGE="observerCameraSelectedAtChange";RecordedUserPreferences.MAGNETISM_ENABLED="magnetismEnabled";RecordedUserPreferences.RULERS_VISIBLE="rulersVisible";RecordedUserPreferences.GRID_VISIBLE="gridVisible";RecordedUserPreferences.DEFAULT_FONT_NAME="defaultFontName";RecordedUserPreferences.FURNITURE_VIEWED_FROM_TOP="furnitureViewedFromTop";RecordedUserPreferences.FURNITURE_MODEL_ICON_SIZE="furnitureModelIconSize";RecordedUserPreferences.ROOM_FLOOR_COLORED_OR_TEXTURED="roomFloorColoredOrTextured";RecordedUserPreferences.WALL_PATTERN="wallPattern";RecordedUserPreferences.NEW_WALL_PATTERN="newWallPattern";RecordedUserPreferences.NEW_WALL_THICKNESS="newWallThickness";RecordedUserPreferences.NEW_WALL_HEIGHT="newHomeWallHeight";RecordedUserPreferences.NEW_FLOOR_THICKNESS="newFloorThickness";RecordedUserPreferences.NEW_WALL_BASEBOARD_THICKNESS="newWallBaseboardThickness";RecordedUserPreferences.NEW_WALL_BASEBOARD_HEIGHT="newWallBaseboardHeight";RecordedUserPreferences.RECENT_HOMES="recentHomes#";RecordedUserPreferences.IGNORED_ACTION_TIP="ignoredActionTip#";RecordedUserPreferences.TEXTURE_NAME="textureName#";RecordedUserPreferences.TEXTURE_CREATOR="textureCreator#";RecordedUserPreferences.TEXTURE_CATEGORY="textureCategory#";RecordedUserPreferences.TEXTURE_IMAGE="textureImage#";RecordedUserPreferences.TEXTURE_WIDTH="textureWidth#";RecordedUserPreferences.TEXTURE_HEIGHT="textureHeight#";RecordedUserPreferences.prototype.getProperty=function(b,c,a){if(b[c]===undefined||b[c]===null){return a}return b[c]};RecordedUserPreferences.prototype.setProperty=function(b,c,a){b[c]=a};RecordedUserPreferences.prototype.removeProperty=function(a,b){delete a[b]};RecordedUserPreferences.prototype.updatePreferencesFromProperties=function(k,n){this.setLanguage(this.getProperty(k,RecordedUserPreferences.LANGUAGE,n));this.setFurnitureCatalog(new FurnitureCatalog());this.setTexturesCatalog(new TexturesCatalog());this.updateDefaultCatalogs();this.readModifiableTexturesCatalog(k);var h=new DefaultUserPreferences(this.furnitureCatalogUrls,this.furnitureResourcesUrlBase,this.texturesCatalogUrls,this.texturesResourcesUrlBase);h.setLanguage(this.getLanguage());var d=h.getPatternsCatalog();this.setPatternsCatalog(d);var o=LengthUnit[this.getProperty(k,RecordedUserPreferences.UNIT)];if(!o){o=h.getLengthUnit()}this.setUnit(o);this.setCurrency(this.getProperty(k,RecordedUserPreferences.CURRENCY,h.getCurrency()));this.setValueAddedTaxEnabled(this.getProperty(k,RecordedUserPreferences.VALUE_ADDED_TAX_ENABLED,""+h.isValueAddedTaxEnabled())=="true");var p=this.getProperty(k,RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE);var e=h.getDefaultValueAddedTaxPercentage();if(p!==null){try{e=new Big(p)}catch(l){}}this.setDefaultValueAddedTaxPercentage(e);this.setFurnitureCatalogViewedInTree(this.getProperty(k,RecordedUserPreferences.FURNITURE_CATALOG_VIEWED_IN_TREE,""+h.isFurnitureCatalogViewedInTree())=="true");this.setNavigationPanelVisible(this.getProperty(k,RecordedUserPreferences.NAVIGATION_PANEL_VISIBLE,""+h.isNavigationPanelVisible())=="true");this.setAerialViewCenteredOnSelectionEnabled(this.getProperty(k,RecordedUserPreferences.AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED,""+h.isAerialViewCenteredOnSelectionEnabled())=="true");this.setObserverCameraSelectedAtChange(this.getProperty(k,RecordedUserPreferences.OBSERVER_CAMERA_SELECTED_AT_CHANGE,""+h.isObserverCameraSelectedAtChange())=="true");this.setMagnetismEnabled(this.getProperty(k,RecordedUserPreferences.MAGNETISM_ENABLED,"true")=="true");this.setRulersVisible(this.getProperty(k,RecordedUserPreferences.RULERS_VISIBLE,""+h.isMagnetismEnabled())=="true");this.setGridVisible(this.getProperty(k,RecordedUserPreferences.GRID_VISIBLE,""+h.isGridVisible())=="true");this.setDefaultFontName(this.getProperty(k,RecordedUserPreferences.DEFAULT_FONT_NAME,h.getDefaultFontName()));this.setFurnitureViewedFromTop(this.getProperty(k,RecordedUserPreferences.FURNITURE_VIEWED_FROM_TOP,""+h.isFurnitureViewedFromTop())=="true");this.setFurnitureModelIconSize(parseInt(this.getProperty(k,RecordedUserPreferences.FURNITURE_MODEL_ICON_SIZE,""+h.getFurnitureModelIconSize())));this.setFloorColoredOrTextured(this.getProperty(k,RecordedUserPreferences.ROOM_FLOOR_COLORED_OR_TEXTURED,""+h.isRoomFloorColoredOrTextured())=="true");try{this.setWallPattern(d.getPattern(this.getProperty(k,RecordedUserPreferences.WALL_PATTERN,h.getWallPattern().getName())))}catch(l){this.setWallPattern(h.getWallPattern())}try{if(h.getNewWallPattern()!=null){this.setNewWallPattern(d.getPattern(this.getProperty(k,RecordedUserPreferences.NEW_WALL_PATTERN,h.getNewWallPattern().getName())))}}catch(l){}this.setNewWallThickness(parseFloat(this.getProperty(k,RecordedUserPreferences.NEW_WALL_THICKNESS,""+h.getNewWallThickness())));this.setNewWallHeight(parseFloat(this.getProperty(k,RecordedUserPreferences.NEW_WALL_HEIGHT,""+h.getNewWallHeight())));this.setNewWallBaseboardThickness(h.getNewWallBaseboardThickness());this.setNewWallBaseboardHeight(h.getNewWallBaseboardHeight());this.setNewWallBaseboardThickness(parseFloat(this.getProperty(k,RecordedUserPreferences.NEW_WALL_BASEBOARD_THICKNESS,""+h.getNewWallBaseboardThickness())));this.setNewWallBaseboardHeight(parseFloat(this.getProperty(k,RecordedUserPreferences.NEW_WALL_BASEBOARD_HEIGHT,""+h.getNewWallBaseboardHeight())));this.setNewFloorThickness(parseFloat(this.getProperty(k,RecordedUserPreferences.NEW_FLOOR_THICKNESS,""+h.getNewFloorThickness())));var a=[];for(var f=1;f<=this.getRecentHomesMaxCount();f++){var c=this.getProperty(k,RecordedUserPreferences.RECENT_HOMES+f);if(c!=null){a.push(c)}}this.setRecentHomes(a);for(var f=1;;f++){var q=this.getProperty(k,RecordedUserPreferences.IGNORED_ACTION_TIP+f,"");if(q.length==0){break}else{this.ignoredActionTips[q]=true}}var g=this;this.addPropertyChangeListener("LANGUAGE",function(){g.updateDefaultCatalogs()});var j=function(){g.writtenPropertiesUpdated=true};var m=["LANGUAGE","UNIT","CURRENCY","VALUE_ADDED_TAX_ENABLED","DEFAULT_VALUE_ADDED_TAX_PERCENTAGE","FURNITURE_CATALOG_VIEWED_IN_TREE","NAVIGATION_PANEL_VISIBLE","DEFAULT_FONT_NAME","AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED","OBSERVER_CAMERA_SELECTED_AT_CHANGE","MAGNETISM_ENABLED","GRID_VISIBLE","FURNITURE_VIEWED_FROM_TOP","FURNITURE_MODEL_ICON_SIZE","ROOM_FLOOR_COLORED_OR_TEXTURED","NEW_WALL_PATTERN","NEW_WALL_THICKNESS","NEW_WALL_HEIGHT","NEW_WALL_BASEBOARD_THICKNESS","NEW_WALL_BASEBOARD_HEIGHT","NEW_FLOOR_THICKNESS"];for(var f=0;f<m.length;f++){var b=m[f];this.addPropertyChangeListener(b,j)}this.getTexturesCatalog().addTexturesListener(j)};RecordedUserPreferences.prototype.getProperties=function(){if(this.properties===undefined){this.properties={};if(this.readPreferencesUrl){this.readPreferences(this.properties)}}return this.properties};RecordedUserPreferences.prototype.readPreferences=function(c){try{var e=null;var d=new XMLHttpRequest();var f=this.readPreferencesUrl.indexOf("?")!=-1?"&":"?";d.open("GET",this.readPreferencesUrl+f+"requestId="+UUID.randomUUID(),false);d.addEventListener("load",function(){e=d.responseText});d.send();if(e){var g=JSON.parse(e);for(var b in g){c[b]=g[b]}}}catch(a){}};RecordedUserPreferences.prototype.updateDefaultCatalogs=function(){var f=this.getFurnitureCatalog();for(var d=f.getCategories().length-1;d>=0;d--){var a=f.getCategory(d);for(var c=a.getFurniture().length-1;c>=0;c--){var k=a.getPieceOfFurniture(c);if(!k.isModifiable()){f["delete"](k)}}}var b=typeof DefaultFurnitureCatalog==="function"?(Array.isArray(this.furnitureCatalogUrls)?new DefaultFurnitureCatalog(this.furnitureCatalogUrls,this.furnitureResourcesUrlBase):new DefaultFurnitureCatalog(this)):new FurnitureCatalog();for(var d=0;d<b.getCategories().length;d++){var a=b.getCategory(d);for(var c=0;c<a.getFurniture().length;c++){var k=a.getPieceOfFurniture(c);f.add(a,k)}}var e=this.getTexturesCatalog();for(var d=e.getCategories().length-1;d>=0;d--){var a=e.getCategory(d);for(var c=a.getTextures().length-1;c>=0;c--){var g=a.getTexture(c);if(!g.isModifiable()){e["delete"](g)}}}var h=typeof DefaultTexturesCatalog==="function"?(Array.isArray(this.texturesCatalogUrls)?new DefaultTexturesCatalog(this.texturesCatalogUrls,this.texturesResourcesUrlBase):new DefaultTexturesCatalog(this)):new TexturesCatalog();for(var d=0;d<h.getCategories().length;d++){var a=h.getCategory(d);for(var c=0;c<a.getTextures().length;c++){var g=a.getTexture(c);e.add(a,g)}}};RecordedUserPreferences.prototype.readModifiableTexturesCatalog=function(b){var c;for(var a=1;(c=this.readModifiableTexture(b,a))!=null;a++){if(c.getImage().getURL()!=""){var d=this.readModifiableTextureCategory(b,a);this.getTexturesCatalog().add(d,c)}}};RecordedUserPreferences.prototype.readModifiableTexture=function(d,c){var b=this.getProperty(d,RecordedUserPreferences.TEXTURE_NAME+c,null);if(b==null){return null}var g=new URLContent(this.getProperty(d,RecordedUserPreferences.TEXTURE_IMAGE+c,""));var f=parseFloat(this.getProperty(d,RecordedUserPreferences.TEXTURE_WIDTH+c,"0.1"));var a=parseFloat(this.getProperty(d,RecordedUserPreferences.TEXTURE_HEIGHT+c,"0.1"));var e=this.getProperty(d,RecordedUserPreferences.TEXTURE_CREATOR+c,null);return new CatalogTexture(null,b,g,f,a,e,true)};RecordedUserPreferences.prototype.readModifiableTextureCategory=function(b,a){var c=this.getProperty(b,RecordedUserPreferences.TEXTURE_CATEGORY+a,"");return new TexturesCategory(c)};RecordedUserPreferences.prototype.write=function(){UserPreferences.prototype.write.call(this);if(this.writtenPropertiesUpdated){var g=this.getProperties();this.writeModifiableTexturesCatalog(g);this.setProperty(g,RecordedUserPreferences.LANGUAGE,this.getLanguage());this.setProperty(g,RecordedUserPreferences.UNIT,this.getLengthUnit().name());var h=this.getCurrency();if(h===null){this.removeProperty(g,RecordedUserPreferences.CURRENCY)}else{this.setProperty(g,RecordedUserPreferences.CURRENCY,h)}this.setProperty(g,RecordedUserPreferences.VALUE_ADDED_TAX_ENABLED,""+this.isValueAddedTaxEnabled());var c=this.getDefaultValueAddedTaxPercentage();if(c===null){this.removeProperty(g,RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE)}else{this.setProperty(g,RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE,c.toString())}this.setProperty(g,RecordedUserPreferences.FURNITURE_CATALOG_VIEWED_IN_TREE,""+this.isFurnitureCatalogViewedInTree());this.setProperty(g,RecordedUserPreferences.NAVIGATION_PANEL_VISIBLE,""+this.isNavigationPanelVisible());this.setProperty(g,RecordedUserPreferences.AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED,""+this.isAerialViewCenteredOnSelectionEnabled());this.setProperty(g,RecordedUserPreferences.OBSERVER_CAMERA_SELECTED_AT_CHANGE,""+this.isObserverCameraSelectedAtChange());this.setProperty(g,RecordedUserPreferences.MAGNETISM_ENABLED,""+this.isMagnetismEnabled());this.setProperty(g,RecordedUserPreferences.RULERS_VISIBLE,""+this.isRulersVisible());this.setProperty(g,RecordedUserPreferences.GRID_VISIBLE,""+this.isGridVisible());var b=this.getDefaultFontName();if(b==null){this.removeProperty(g,RecordedUserPreferences.DEFAULT_FONT_NAME)}else{this.setProperty(g,RecordedUserPreferences.DEFAULT_FONT_NAME,b)}this.setProperty(g,RecordedUserPreferences.FURNITURE_VIEWED_FROM_TOP,""+this.isFurnitureViewedFromTop());this.setProperty(g,RecordedUserPreferences.FURNITURE_MODEL_ICON_SIZE,""+this.getFurnitureModelIconSize());this.setProperty(g,RecordedUserPreferences.ROOM_FLOOR_COLORED_OR_TEXTURED,""+this.isRoomFloorColoredOrTextured());this.setProperty(g,RecordedUserPreferences.WALL_PATTERN,this.getWallPattern().getName());var k=this.getNewWallPattern();if(k!=null){this.setProperty(g,RecordedUserPreferences.NEW_WALL_PATTERN,k.getName())}this.setProperty(g,RecordedUserPreferences.NEW_WALL_THICKNESS,""+this.getNewWallThickness());this.setProperty(g,RecordedUserPreferences.NEW_WALL_HEIGHT,""+this.getNewWallHeight());this.setProperty(g,RecordedUserPreferences.NEW_WALL_BASEBOARD_THICKNESS,""+this.getNewWallBaseboardThickness());this.setProperty(g,RecordedUserPreferences.NEW_WALL_BASEBOARD_HEIGHT,""+this.getNewWallBaseboardHeight());this.setProperty(g,RecordedUserPreferences.NEW_FLOOR_THICKNESS,""+this.getNewFloorThickness());var a=this.getRecentHomes();for(var d=0;d<a.length&&d<this.getRecentHomesMaxCount();d++){this.setProperty(g,RecordedUserPreferences.RECENT_HOMES+(d+1),a[d])}var f=Object.keys(this.ignoredActionTips);for(var d=0;d<f.length;d++){var j=f[d];if(this.ignoredActionTips[j]){this.setProperty(g,RecordedUserPreferences.IGNORED_ACTION_TIP+(d+1),j)}}if(Object.keys(this.uploadingBlobs).length>0){var e=this;setTimeout(function(){e.write()},1000)}else{this.writtenPropertiesUpdated=false;this.writePreferences(g)}}};RecordedUserPreferences.prototype.writePreferences=function(d){if(this.writePreferencesUrl){var c=this;if(this.writingPreferences){setTimeout(function(){c.writePreferences(d)},100)}else{this.writingPreferences=true;var b=JSON.stringify(d);var e=new XMLHttpRequest();var f=this.writePreferencesUrl.indexOf("?")!=-1?"&":"?";var a=function(h,j){if(c.writingObserver!==undefined&&c.writingObserver.writeFailed){c.writingObserver.writeFailed(d,h,j)}setTimeout(function(){delete c.writingPreferences;c.writePreferences(d)},10000)};e.open("POST",this.writePreferencesUrl+f+"updateId="+UUID.randomUUID(),true);e.addEventListener("load",function(h){if(e.readyState===XMLHttpRequest.DONE){if(e.status===200){if(c.writingObserver!==undefined&&c.writingObserver.writeSucceeded){c.writingObserver.writeSucceeded(d)}setTimeout(function(){delete c.writingPreferences},500)}else{a(e.status,e.responseText)}}});var g=function(h){a(0,h)};e.addEventListener("error",g);e.addEventListener("timeout",g);e.send(b)}}};RecordedUserPreferences.prototype.setActionTipIgnored=function(a){this.ignoredActionTips[a]=true;UserPreferences.prototype.setActionTipIgnored.call(this,a)};RecordedUserPreferences.prototype.isActionTipIgnored=function(a){var b=this.ignoredActionTips[a];return b===true};RecordedUserPreferences.prototype.resetIgnoredActionTips=function(){var b=Object.keys(this.ignoredActionTips);for(var a=0;a<b.length;a++){this.ignoredActionTips[b[a]]=false}UserPreferences.prototype.resetIgnoredActionTips.call(this)};RecordedUserPreferences.prototype.addLanguageLibrary=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.languageLibraryExists=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.furnitureLibraryExists=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.addFurnitureLibrary=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.texturesLibraryExists=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.addTexturesLibrary=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.getLibraries=function(){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.writeModifiableTexturesCatalog=function(k){if(this.writeResourceUrl&&this.readResourceUrl){var g=1;var e=this.getTexturesCatalog();var d=this;for(var b=0;b<e.getCategoriesCount();b++){var h=e.getCategory(b);for(var a=0;a<h.getTexturesCount();a++){var n=h.getTexture(a);var l=n.getImage();if(n.isModifiable()&&l instanceof URLContent){this.setProperty(k,RecordedUserPreferences.TEXTURE_NAME+g,n.getName());this.setProperty(k,RecordedUserPreferences.TEXTURE_CATEGORY+g,h.getName());this.setProperty(k,RecordedUserPreferences.TEXTURE_WIDTH+g,n.getWidth());this.setProperty(k,RecordedUserPreferences.TEXTURE_HEIGHT+g,n.getHeight());if(n.getCreator()!=null){this.setProperty(k,RecordedUserPreferences.TEXTURE_CREATOR+g,n.getCreator())}else{this.removeProperty(k,RecordedUserPreferences.TEXTURE_CREATOR+g)}if(l instanceof BlobURLContent){var p=l.getSavedContent();if(p===null){var o=this.uploadingBlobs[l.getURL()];if(o===undefined){var f=UUID.randomUUID();var c=l.getBlob().type=="image/png"?"png":"jpg";o=f+"."+c;this.uploadingBlobs[l.getURL()]=o;var m=function(q,s){if(q.getSavedContent()===null){var j=d.uploadingBlobs[q.getURL()];var r=new URLContent(CoreTools.format(d.readResourceUrl.replace(/(%[^s])/g,"%$1"),encodeURIComponent(j)));q.setSavedContent(r)}delete d.uploadingBlobs[q.getURL()];d.setProperty(k,RecordedUserPreferences.TEXTURE_IMAGE+g,q.getSavedContent().getURL())};this.writeResource(l,o,g,m)}}else{delete d.uploadingBlobs[l.getURL()];this.setProperty(k,RecordedUserPreferences.TEXTURE_IMAGE+g,p.getURL())}}else{if(l instanceof URLContent){this.setProperty(k,RecordedUserPreferences.TEXTURE_IMAGE+g,l.getURL())}}g++}}}for(;this.getProperty(k,RecordedUserPreferences.TEXTURE_NAME+g,null)!=null;g++){this.removeProperty(k,RecordedUserPreferences.TEXTURE_NAME+g);this.removeProperty(k,RecordedUserPreferences.TEXTURE_IMAGE+g);this.removeProperty(k,RecordedUserPreferences.TEXTURE_CATEGORY+g);this.removeProperty(k,RecordedUserPreferences.TEXTURE_WIDTH+g);this.removeProperty(k,RecordedUserPreferences.TEXTURE_HEIGHT+g);this.removeProperty(k,RecordedUserPreferences.TEXTURE_CREATOR+g)}}};RecordedUserPreferences.prototype.writeResource=function(a,j,d,e){var f=CoreTools.format(this.writeResourceUrl.replace(/(%[^s])/g,"%$1"),encodeURIComponent(j));var b=new XMLHttpRequest();var c=this;var h=function(k,l){if(c.writingObserver!==undefined&&c.writingObserver.writeFailed){c.writingObserver.writeFailed(a.getBlob(),k,l);setTimeout(function(){if(a.getSavedContent()===null){c.writeResource(a,j,d,e)}else{e(a,d)}},10000)}};b.open("POST",f,true);b.addEventListener("load",function(k){if(b.readyState===XMLHttpRequest.DONE){if(b.status===200){if(c.writingObserver!==undefined&&c.writingObserver.writeSucceeded){c.writingObserver.writeSucceeded(a.getBlob())}e(a,d)}else{h(b.status,b.responseText)}}});var g=function(k){h(0,k)};b.addEventListener("error",g);b.addEventListener("timeout",g);b.send(a.getBlob())};function HomeRecorder(){}HomeRecorder.READING_HOME="Reading home";HomeRecorder.PARSING_HOME="Parsing home";HomeRecorder.prototype.readHome=function(d,c){c.progression(HomeRecorder.READING_HOME,d,0);var b="Home.xml";if(d.indexOf("jar:")===0){var e=d.indexOf("!/");b=d.substring(e+2);d=d.substring(4,e)}var a=this;ZIPTools.getZIP(d,{zipReady:function(g){try{var h=g.file(b);if(h!==null){a.parseHomeXMLEntry(g.file(b),g,d,c)}else{this.zipError("No "+b+" entry in "+d)}}catch(f){this.zipError(f)}},zipError:function(f){if(c.homeError!==undefined){c.homeError(f)}},progression:function(g,h,f){if(c.progression!==undefined){c.progression(HomeRecorder.READING_HOME,d,f)}}})};HomeRecorder.prototype.parseHomeXMLEntry=function(h,e,f,b){var g=h.asText();b.progression(HomeRecorder.READING_HOME,h.name,1);b.progression(HomeRecorder.PARSING_HOME,h.name,0);var d=this.getHomeXMLHandler();d.homeUrl=f;var a=new SAXParser(d,d,d,d,d);try{g=g.replace(/\'/g,'"');a.parseString(g);b.homeLoaded(d.getHome())}catch(c){b.homeError(c)}b.progression(HomeRecorder.PARSING_HOME,h.name,1)};HomeRecorder.prototype.getHomeXMLHandler=function(){return new HomeXMLHandler()};function ResourceAction(d,a,f,e,c,h,g){AbstractAction.call(this);if(e===undefined){g=h;h=c;c=e;e=false}this.putValue(ResourceAction.RESOURCE_CLASS,a);this.putValue(ResourceAction.RESOURCE_PREFIX,f);this.putValue(ResourceAction.VISIBLE,true);this.readActionProperties(d,a,f);this.setEnabled(e);this.controller=c;this.controllerMethod=h;this.parameters=g;var b=this;d.addPropertyChangeListener("LANGUAGE",{propertyChange:function(j){if(b==null){(j.getSource()).removePropertyChangeListener("LANGUAGE",this)}else{b.readActionProperties(j.getSource(),b.getValue(ResourceAction.RESOURCE_CLASS),b.getValue(ResourceAction.RESOURCE_PREFIX))}}});return this}ResourceAction.prototype=Object.create(AbstractAction.prototype);ResourceAction.prototype.constructor=ResourceAction;ResourceAction.RESOURCE_CLASS="ResourceClass";ResourceAction.RESOURCE_PREFIX="ResourcePrefix";ResourceAction.VISIBLE="Visible";ResourceAction.POPUP="Popup";ResourceAction.TOGGLE_BUTTON_GROUP="ToggleButtonGroup";ResourceAction.TOOL_BAR_ICON="ToolBarIcon";ResourceAction.prototype.readActionProperties=function(e,a,d){var g=d+".";this.putValue(AbstractAction.NAME,this.getOptionalString(e,a,g+AbstractAction.NAME,true));this.putValue(AbstractAction.DEFAULT,this.getValue(AbstractAction.NAME));this.putValue(ResourceAction.POPUP,this.getOptionalString(e,a,g+ResourceAction.POPUP,true));this.putValue(AbstractAction.SHORT_DESCRIPTION,this.getOptionalString(e,a,g+AbstractAction.SHORT_DESCRIPTION,false));this.putValue(AbstractAction.LONG_DESCRIPTION,this.getOptionalString(e,a,g+AbstractAction.LONG_DESCRIPTION,false));var j=this.getOptionalString(e,a,g+AbstractAction.SMALL_ICON,false);if(j!=null){this.putValue(AbstractAction.SMALL_ICON,j)}var f=this.getOptionalString(e,a,g+ResourceAction.TOOL_BAR_ICON,false);if(f!=null){this.putValue(ResourceAction.TOOL_BAR_ICON,f)}var c=g+AbstractAction.ACCELERATOR_KEY;var b=this.getOptionalString(e,a,c+"."+OperatingSystem.getName(),false);if(b==null){b=this.getOptionalString(e,a,c,false)}if(b!=null){this.putValue(AbstractAction.ACCELERATOR_KEY,b)}var h=this.getOptionalString(e,a,g+AbstractAction.MNEMONIC_KEY,false);if(h!=null){this.putValue(AbstractAction.MNEMONIC_KEY,h)}};ResourceAction.prototype.getOptionalString=function(b,a,e,c){try{var f=c?ResourceAction.getLocalizedLabelText(b,a,e):b.getLocalizedString(a,e);if(f!=null&&f.length>0){return f}else{return null}}catch(d){return null}};ResourceAction.getLocalizedLabelText=function(f,d,k,h){var j=f.getLocalizedString(d,k,h);var e=Locale.getDefault();if((e.indexOf("zh")==0||e.indexOf("ja")==0||e.indexOf("ko")==0||e.indexOf("uk")==0)){var b=j.indexOf("(");if(b!==-1){var a=j.indexOf(")");if(b===a-2){var g=j.charAt(b+1);if(g>="A"&&g<="Z"){j=j.substring(0,b)+j.substring(a+1)}}}}return j};ResourceAction.prototype.actionPerformed=function(a){if(this.controller!=null&&this.controllerMethod!=null){return this.controller[this.controllerMethod].apply(this.controller,this.parameters)}else{AbstractAction.prototype.actionPerformed.call(this,a)}};function PlanComponent(k,g,b,d,c){var j=this;this.pointerType=View.PointerType.MOUSE;this.canvasNeededRepaint=false;this.container=document.getElementById(k);var h=window.getComputedStyle(this.container);this.font=[h.fontStyle,h.fontSize,h.fontFamily].join(" ");if(h.position!="absolute"){this.container.style.position="relative"}if(this.container instanceof HTMLCanvasElement){this.canvas=this.view=this.container;this.canvas.width=this.canvas.clientWidth;this.canvas.height=this.canvas.clientHeight}else{this.canvas=document.createElement("canvas");this.canvas.setAttribute("id",k+".canvas");this.canvas.style.width="100%";this.canvas.style.height="100%";this.canvas.style.backgroundColor=h.backgroundColor;this.canvas.style.color=h.color;this.canvas.style.font=h.font;this.scrollPane=document.createElement("div");this.scrollPane.setAttribute("id",k+".scrollPane");this.scrollPane.style.width="100%";this.scrollPane.style.height="100%";if(this.container.style.overflow){this.scrollPane.style.overflow=this.container.style.overflow}else{this.scrollPane.style.overflow="scroll"}this.view=document.createElement("div");this.view.setAttribute("id",k+".view");this.container.appendChild(this.scrollPane);this.container.appendChild(this.canvas);this.scrollPane.appendChild(this.view);this.canvas.style.position="absolute";this.canvas.style.left="0px";this.canvas.style.top="0px";this.scrollPane.style.position="absolute";this.scrollPane.style.left="0px";this.scrollPane.style.top="0px";this.scrollPane.addEventListener("scroll",function(e){j.repaint()})}window.addEventListener("resize",function(){j.revalidate()});this.tooltip=document.createElement("div");this.tooltip.style.position="absolute";this.tooltip.style.visibility="hidden";this.tooltip.style.backgroundColor=ColorTools.toRGBAStyle(this.getBackground(),0.7);this.tooltip.style.borderWidth="2px";this.tooltip.style.paddingLeft="2px";this.tooltip.style.borderStyle="solid";this.tooltip.style.whiteSpace="nowrap";this.tooltip.style.borderColor=ColorTools.toRGBAStyle(this.getForeground(),0.7);this.tooltip.style.font=this.font;this.tooltip.style.color=this.canvas.style.color;this.tooltip.style.zIndex=3;document.body.appendChild(this.tooltip);this.touchOverlay=document.createElement("div");this.touchOverlay.id="touch-overlay-timer";this.touchOverlay.style.position="absolute";this.touchOverlay.style.top="0px";this.touchOverlay.style.left="0px";this.touchOverlay.innerHTML='<div id="touch-overlay-timer-content"></div><div id="touch-overlay-timer-bg"></div><div id="touch-overlay-timer-hidder"></div><div id="touch-overlay-timer-loader1"></div><div id="touch-overlay-timer-loader2"></div>';document.body.appendChild(this.touchOverlay);for(var a=0;a<this.touchOverlay.children.length;a++){var f=this.touchOverlay.children.item(a);if(f.id.indexOf("loader")!==-1){f.style.borderTopColor=this.getSelectionColor();f.style.borderRightColor=this.getSelectionColor()}if(f.id=="touch-overlay-timer-content"){f.style.color=this.getForeground()}f.style.animationDuration=(PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY)+"ms"}this.resolutionScale=this.scrollPane?PlanComponent.HIDPI_SCALE_FACTOR:1;this.selectedItemsOutlinePainted=true;this.backgroundPainted=true;this.planBoundsCacheValid=false;this.home=g;this.preferences=b;if(c==null){c=d;d=new Object3DBranchFactory()}this.object3dFactory=d;this.setOpaque(true);this.addModelListeners(g,b,c);if(c!=null){this.addMouseListeners(c);this.addFocusListener(c);this.addControllerListener(c);this.createActions(c);this.installDefaultKeyboardActions()}this.rotationCursor=PlanComponent.createCustomCursor("rotation","alias");this.elevationCursor=PlanComponent.createCustomCursor("elevation","row-resize");this.heightCursor=PlanComponent.createCustomCursor("height","ns-resize");this.powerCursor=PlanComponent.createCustomCursor("power","cell");this.resizeCursor=PlanComponent.createCustomCursor("resize","ew-resize");this.moveCursor=PlanComponent.createCustomCursor("move","move");this.panningCursor=PlanComponent.createCustomCursor("panning","move");this.duplicationCursor="copy";this.patternImagesCache={};this.setScale(0.5)}PlanComponent.__interfaces=["com.eteks.sweethome3d.viewcontroller.PlanView","com.eteks.sweethome3d.viewcontroller.View","com.eteks.sweethome3d.viewcontroller.ExportableView","com.eteks.sweethome3d.viewcontroller.TransferableView"];PlanComponent.initStatics=function(){PlanComponent.MARGIN=40;PlanComponent.INDICATOR_STROKE=new java.awt.BasicStroke(1.5);PlanComponent.POINT_STROKE=new java.awt.BasicStroke(2);PlanComponent.WALL_STROKE_WIDTH=1.5;PlanComponent.BORDER_STROKE_WIDTH=1;PlanComponent.ALIGNMENT_LINE_OFFSET=25;PlanComponent.ERROR_TEXTURE_IMAGE=null;PlanComponent.WAIT_TEXTURE_IMAGE=null;PlanComponent.HIDPI_SCALE_FACTOR=2;PlanComponent.POINT_INDICATOR=new java.awt.geom.Ellipse2D.Float(-1.5,-1.5,3,3);PlanComponent.FURNITURE_ROTATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.FURNITURE_ROTATION_INDICATOR.append(PlanComponent.POINT_INDICATOR,false);PlanComponent.FURNITURE_ROTATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-8,-8,16,16,45,180,java.awt.geom.Arc2D.OPEN),false);PlanComponent.FURNITURE_ROTATION_INDICATOR.moveTo(2.66,-5.66);PlanComponent.FURNITURE_ROTATION_INDICATOR.lineTo(5.66,-5.66);PlanComponent.FURNITURE_ROTATION_INDICATOR.lineTo(4,-8.3);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.append(PlanComponent.POINT_INDICATOR,false);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.moveTo(-4.5,0);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-5.2,0);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.moveTo(-9,0);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-10,0);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-12,-8,5,16,200,320,java.awt.geom.Arc2D.OPEN),false);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.moveTo(-10,-4.5);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-12.3,-2);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-12.8,-5.8);var d=java.awt.geom.AffineTransform.getRotateInstance(-Math.PI/2);d.concatenate(java.awt.geom.AffineTransform.getScaleInstance(1,-1));PlanComponent.FURNITURE_ROLL_ROTATION_INDICATOR=PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.createTransformedShape(d);PlanComponent.ELEVATION_POINT_INDICATOR=new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3);PlanComponent.ELEVATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.ELEVATION_INDICATOR.moveTo(0,-5);PlanComponent.ELEVATION_INDICATOR.lineTo(0,5);PlanComponent.ELEVATION_INDICATOR.moveTo(-2.5,5);PlanComponent.ELEVATION_INDICATOR.lineTo(2.5,5);PlanComponent.ELEVATION_INDICATOR.moveTo(-1.2,1.5);PlanComponent.ELEVATION_INDICATOR.lineTo(0,4.5);PlanComponent.ELEVATION_INDICATOR.lineTo(1.2,1.5);PlanComponent.FURNITURE_HEIGHT_POINT_INDICATOR=new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3);PlanComponent.FURNITURE_HEIGHT_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(0,-6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(0,6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-2.5,-6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(2.5,-6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-2.5,6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(2.5,6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-1.2,-2.5);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(0,-5.5);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(1.2,-2.5);PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-1.2,2.5);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(0,5.5);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(1.2,2.5);PlanComponent.LIGHT_POWER_POINT_INDICATOR=new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3);PlanComponent.LIGHT_POWER_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.LIGHT_POWER_INDICATOR.moveTo(-8,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-6,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-6,-1);PlanComponent.LIGHT_POWER_INDICATOR.closePath();PlanComponent.LIGHT_POWER_INDICATOR.moveTo(-3,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-1,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-1,-2.5);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-3,-1.8);PlanComponent.LIGHT_POWER_INDICATOR.closePath();PlanComponent.LIGHT_POWER_INDICATOR.moveTo(2,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(4,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(4,-3.5);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(2,-2.8);PlanComponent.LIGHT_POWER_INDICATOR.closePath();PlanComponent.FURNITURE_RESIZE_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.FURNITURE_RESIZE_INDICATOR.append(new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3),false);PlanComponent.FURNITURE_RESIZE_INDICATOR.moveTo(5,-4);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(7,-4);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(7,7);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(-4,7);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(-4,5);PlanComponent.FURNITURE_RESIZE_INDICATOR.moveTo(3.5,3.5);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(9,9);PlanComponent.FURNITURE_RESIZE_INDICATOR.moveTo(7,9.5);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(10,10);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(9.5,7);PlanComponent.WALL_ORIENTATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.WALL_ORIENTATION_INDICATOR.moveTo(-4,-4);PlanComponent.WALL_ORIENTATION_INDICATOR.lineTo(4,0);PlanComponent.WALL_ORIENTATION_INDICATOR.lineTo(-4,4);PlanComponent.WALL_POINT=new java.awt.geom.Ellipse2D.Float(-3,-3,6,6);PlanComponent.WALL_ARC_EXTENT_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.WALL_ARC_EXTENT_INDICATOR.append(new java.awt.geom.Arc2D.Float(-4,1,8,5,210,120,java.awt.geom.Arc2D.OPEN),false);PlanComponent.WALL_ARC_EXTENT_INDICATOR.moveTo(0,6);PlanComponent.WALL_ARC_EXTENT_INDICATOR.lineTo(0,11);PlanComponent.WALL_ARC_EXTENT_INDICATOR.moveTo(-1.8,8.7);PlanComponent.WALL_ARC_EXTENT_INDICATOR.lineTo(0,12);PlanComponent.WALL_ARC_EXTENT_INDICATOR.lineTo(1.8,8.7);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.moveTo(5,-2);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(5,2);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.moveTo(6,0);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(11,0);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.moveTo(8.7,-1.8);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(12,0);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(8.7,1.8);d=java.awt.geom.AffineTransform.getRotateInstance(-Math.PI/4);PlanComponent.CAMERA_YAW_ROTATION_INDICATOR=PlanComponent.FURNITURE_ROTATION_INDICATOR.createTransformedShape(d);d=java.awt.geom.AffineTransform.getRotateInstance(Math.PI);PlanComponent.CAMERA_PITCH_ROTATION_INDICATOR=PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.createTransformedShape(d);PlanComponent.CAMERA_ELEVATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.CAMERA_ELEVATION_INDICATOR.moveTo(0,-4);PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(0,4);PlanComponent.CAMERA_ELEVATION_INDICATOR.moveTo(-2.5,4);PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(2.5,4);PlanComponent.CAMERA_ELEVATION_INDICATOR.moveTo(-1.2,0.5);PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(0,3.5);PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(1.2,0.5);var g=new java.awt.geom.GeneralPath();g.append(new java.awt.geom.Ellipse2D.Float(-0.5,-0.425,1,0.85),false);g.append(new java.awt.geom.Ellipse2D.Float(-0.5,-0.3,0.24,0.6),false);g.append(new java.awt.geom.Ellipse2D.Float(0.26,-0.3,0.24,0.6),false);PlanComponent.CAMERA_BODY=new java.awt.geom.Area(g);var b=new java.awt.geom.GeneralPath();b.append(new java.awt.geom.Ellipse2D.Float(-0.18,-0.45,0.36,1),false);b.moveTo(-0.04,0.55);b.lineTo(0,0.65);b.lineTo(0.04,0.55);b.closePath();PlanComponent.CAMERA_HEAD=new java.awt.geom.Area(b);PlanComponent.DIMENSION_LINE_END=new java.awt.geom.GeneralPath();PlanComponent.DIMENSION_LINE_END.moveTo(-5,5);PlanComponent.DIMENSION_LINE_END.lineTo(5,-5);PlanComponent.DIMENSION_LINE_END.moveTo(0,5);PlanComponent.DIMENSION_LINE_END.lineTo(0,-5);PlanComponent.TEXT_LOCATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.TEXT_LOCATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-2,0,4,4,190,160,java.awt.geom.Arc2D.CHORD),false);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(0,4);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(0,12);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(-1.2,8.5);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(0,11.5);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(1.2,8.5);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(2,3);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(9,6);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(6,6.5);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(10,7);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(7.5,3.5);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(-2,3);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(-9,6);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(-6,6.5);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(-10,7);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(-7.5,3.5);PlanComponent.TEXT_ANGLE_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.TEXT_ANGLE_INDICATOR.append(new java.awt.geom.Arc2D.Float(-1.25,-1.25,2.5,2.5,10,160,java.awt.geom.Arc2D.CHORD),false);PlanComponent.TEXT_ANGLE_INDICATOR.append(new java.awt.geom.Arc2D.Float(-8,-8,16,16,30,120,java.awt.geom.Arc2D.OPEN),false);PlanComponent.TEXT_ANGLE_INDICATOR.moveTo(4,-5.2);PlanComponent.TEXT_ANGLE_INDICATOR.lineTo(6.9,-4);PlanComponent.TEXT_ANGLE_INDICATOR.lineTo(5.8,-7);PlanComponent.LABEL_CENTER_INDICATOR=new java.awt.geom.Ellipse2D.Float(-1,-1,2,2);PlanComponent.COMPASS_DISC=new java.awt.geom.Ellipse2D.Float(-0.5,-0.5,1,1);var f=new java.awt.BasicStroke(0.01);PlanComponent.COMPASS=new java.awt.geom.GeneralPath(f.createStrokedShape(PlanComponent.COMPASS_DISC));PlanComponent.COMPASS.append(f.createStrokedShape(new java.awt.geom.Line2D.Float(-0.6,0,-0.5,0)),false);PlanComponent.COMPASS.append(f.createStrokedShape(new java.awt.geom.Line2D.Float(0.6,0,0.5,0)),false);PlanComponent.COMPASS.append(f.createStrokedShape(new java.awt.geom.Line2D.Float(0,0.6,0,0.5)),false);f=new java.awt.BasicStroke(0.04,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND);PlanComponent.COMPASS.append(f.createStrokedShape(new java.awt.geom.Line2D.Float(0,0,0,0)),false);var e=new java.awt.geom.GeneralPath();e.moveTo(0,-0.47);e.lineTo(0.15,0.46);e.lineTo(0,0.32);e.lineTo(-0.15,0.46);e.closePath();f=new java.awt.BasicStroke(0.03);PlanComponent.COMPASS.append(f.createStrokedShape(e),false);var a=new java.awt.geom.GeneralPath();a.moveTo(-0.07,-0.55);a.lineTo(-0.07,-0.69);a.lineTo(0.07,-0.56);a.lineTo(0.07,-0.7);PlanComponent.COMPASS.append(f.createStrokedShape(a),false);PlanComponent.COMPASS_ROTATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.COMPASS_ROTATION_INDICATOR.append(PlanComponent.POINT_INDICATOR,false);PlanComponent.COMPASS_ROTATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-8,-7,16,16,210,120,java.awt.geom.Arc2D.OPEN),false);PlanComponent.COMPASS_ROTATION_INDICATOR.moveTo(4,5.66);PlanComponent.COMPASS_ROTATION_INDICATOR.lineTo(7,5.66);PlanComponent.COMPASS_ROTATION_INDICATOR.lineTo(5.6,8.3);PlanComponent.COMPASS_RESIZE_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.COMPASS_RESIZE_INDICATOR.append(new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3),false);PlanComponent.COMPASS_RESIZE_INDICATOR.moveTo(4,-6);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(6,-6);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(6,6);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(4,6);PlanComponent.COMPASS_RESIZE_INDICATOR.moveTo(5,0);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(9,0);PlanComponent.COMPASS_RESIZE_INDICATOR.moveTo(9,-1.5);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(12,0);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(9,1.5);PlanComponent.ARROW=new java.awt.geom.GeneralPath();PlanComponent.ARROW.moveTo(-5,-2);PlanComponent.ARROW.lineTo(0,0);PlanComponent.ARROW.lineTo(-5,2);PlanComponent.ERROR_TEXTURE_IMAGE=TextureManager.getInstance().getErrorImage();PlanComponent.WAIT_TEXTURE_IMAGE=TextureManager.getInstance().getWaitImage();PlanComponent.WEBGL_AVAILABLE=true;var c=document.createElement("canvas");var h=c.getContext("webgl");if(!h){h=c.getContext("experimental-webgl");if(!h){PlanComponent.WEBGL_AVAILABLE=false}}PlanComponent.LONG_TOUCH_DELAY=200;PlanComponent.LONG_TOUCH_DELAY_WHEN_DRAGGING=400;PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY=800;PlanComponent.DOUBLE_TOUCH_DELAY=500};PlanComponent.initStatics();PlanComponent.PaintMode={};PlanComponent.PaintMode[PlanComponent.PaintMode.PAINT=0]="PAINT";PlanComponent.PaintMode[PlanComponent.PaintMode.PRINT=1]="PRINT";PlanComponent.PaintMode[PlanComponent.PaintMode.CLIPBOARD=2]="CLIPBOARD";PlanComponent.PaintMode[PlanComponent.PaintMode.EXPORT=3]="EXPORT";PlanComponent.ActionType={};PlanComponent.ActionType[PlanComponent.ActionType.DELETE_SELECTION=0]="DELETE_SELECTION";PlanComponent.ActionType[PlanComponent.ActionType.ESCAPE=1]="ESCAPE";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_LEFT=2]="MOVE_SELECTION_LEFT";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_UP=3]="MOVE_SELECTION_UP";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_DOWN=4]="MOVE_SELECTION_DOWN";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_RIGHT=5]="MOVE_SELECTION_RIGHT";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_LEFT=6]="MOVE_SELECTION_FAST_LEFT";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_UP=7]="MOVE_SELECTION_FAST_UP";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_DOWN=8]="MOVE_SELECTION_FAST_DOWN";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_RIGHT=9]="MOVE_SELECTION_FAST_RIGHT";PlanComponent.ActionType[PlanComponent.ActionType.TOGGLE_MAGNETISM_ON=10]="TOGGLE_MAGNETISM_ON";PlanComponent.ActionType[PlanComponent.ActionType.TOGGLE_MAGNETISM_OFF=11]="TOGGLE_MAGNETISM_OFF";PlanComponent.ActionType[PlanComponent.ActionType.ACTIVATE_ALIGNMENT=12]="ACTIVATE_ALIGNMENT";PlanComponent.ActionType[PlanComponent.ActionType.DEACTIVATE_ALIGNMENT=13]="DEACTIVATE_ALIGNMENT";PlanComponent.ActionType[PlanComponent.ActionType.ACTIVATE_DUPLICATION=14]="ACTIVATE_DUPLICATION";PlanComponent.ActionType[PlanComponent.ActionType.DEACTIVATE_DUPLICATION=15]="DEACTIVATE_DUPLICATION";PlanComponent.ActionType[PlanComponent.ActionType.ACTIVATE_EDITIION=16]="ACTIVATE_EDITIION";PlanComponent.ActionType[PlanComponent.ActionType.DEACTIVATE_EDITIION=17]="DEACTIVATE_EDITIION";PlanComponent.IndicatorType=function(a){this.name=a};PlanComponent.IndicatorType.prototype.name=function(){return this.name};PlanComponent.IndicatorType.prototype.toString=function(){return this.name};PlanComponent.IndicatorType.ROTATE=new PlanComponent.IndicatorType("ROTATE");PlanComponent.IndicatorType.RESIZE=new PlanComponent.IndicatorType("RESIZE");PlanComponent.IndicatorType.ELEVATE=new PlanComponent.IndicatorType("ELEVATE");PlanComponent.IndicatorType.RESIZE_HEIGHT=new PlanComponent.IndicatorType("RESIZE_HEIGHT");PlanComponent.IndicatorType.CHANGE_POWER=new PlanComponent.IndicatorType("CHANGE_POWER");PlanComponent.IndicatorType.MOVE_TEXT=new PlanComponent.IndicatorType("MOVE_TEXT");PlanComponent.IndicatorType.ROTATE_TEXT=new PlanComponent.IndicatorType("ROTATE_TEXT");PlanComponent.IndicatorType.ROTATE_PITCH=new PlanComponent.IndicatorType("ROTATE_PITCH");PlanComponent.IndicatorType.ROTATE_ROLL=new PlanComponent.IndicatorType("ROTATE_ROLL");PlanComponent.IndicatorType.ARC_EXTENT=new PlanComponent.IndicatorType("ARC_EXTENT");PlanComponent.prototype.getHTMLElement=function(){return this.container};PlanComponent.prototype.addModelListeners=function(k,e,f){var l=this;var j=function(p){if(l.furnitureTopViewIconKeys!=null&&("MODEL"==p.getPropertyName()||"MODEL_ROTATION"==p.getPropertyName()||"BACK_FACE_SHOWN"==p.getPropertyName()||"MODEL_TRANSFORMATIONS"==p.getPropertyName()||"ROLL"==p.getPropertyName()||"PITCH"==p.getPropertyName()||("WIDTH_IN_PLAN"==p.getPropertyName()||"DEPTH_IN_PLAN"==p.getPropertyName()||"HEIGHT_IN_PLAN"==p.getPropertyName())&&(p.getSource().isHorizontallyRotated()||p.getSource().getTexture()!=null)||"MODEL_MIRRORED"==p.getPropertyName()&&p.getSource().getRoll()!=0)){if("HEIGHT_IN_PLAN"==p.getPropertyName()){l.sortedLevelFurniture=null}if(!(p.getSource() instanceof HomeFurnitureGroup)){if(f==null||!f.isModificationState()){l.removeTopViewIconFromCache(p.getSource())}else{if(l.invalidFurnitureTopViewIcons==null){l.invalidFurnitureTopViewIcons=[];var o=function(q){for(var r=0;r<l.invalidFurnitureTopViewIcons.length;r++){l.removeTopViewIconFromCache(l.invalidFurnitureTopViewIcons[r])}l.invalidFurnitureTopViewIcons=null;l.repaint();f.removePropertyChangeListener("MODIFICATION_STATE",o)};f.addPropertyChangeListener("MODIFICATION_STATE",o)}if(l.invalidFurnitureTopViewIcons.indexOf(p.getSource())<0){l.invalidFurnitureTopViewIcons.push(p.getSource())}}}l.revalidate()}else{if(l.furnitureTopViewIconKeys!=null&&("PLAN_ICON"==p.getPropertyName()||"COLOR"==p.getPropertyName()||"TEXTURE"==p.getPropertyName()||"MODEL_MATERIALS"==p.getPropertyName()||"SHININESS"==p.getPropertyName())){l.removeTopViewIconFromCache(p.getSource());l.repaint()}else{if("ELEVATION"==p.getPropertyName()||"LEVEL"==p.getPropertyName()||"HEIGHT_IN_PLAN"==p.getPropertyName()){l.sortedLevelFurniture=null;l.repaint()}else{if("ICON"==p.getPropertyName()||"WALL_CUT_OUT_ON_BOTH_SIDES"==p.getPropertyName()){l.repaint()}else{if(l.doorOrWindowWallThicknessAreasCache!=null&&("WIDTH"==p.getPropertyName()||"DEPTH"==p.getPropertyName()||"ANGLE"==p.getPropertyName()||"MODEL_MIRRORED"==p.getPropertyName()||"X"==p.getPropertyName()||"Y"==p.getPropertyName()||"LEVEL"==p.getPropertyName()||"WALL_THICKNESS"==p.getPropertyName()||"WALL_DISTANCE"==p.getPropertyName()||"WALL_WIDTH"==p.getPropertyName()||"WALL_LEFT"==p.getPropertyName()||"CUT_OUT_SHAPE"==p.getPropertyName())&&CoreTools.removeFromMap(l.doorOrWindowWallThicknessAreasCache,p.getSource())!=null){l.revalidate()}else{l.revalidate()}}}}}};if(k.getFurniture()!=null){k.getFurniture().forEach(function(o){o.addPropertyChangeListener(j);if(o instanceof HomeFurnitureGroup){o.getAllFurniture().forEach(function(p){p.addPropertyChangeListener(j)})}})}var b=function(o){o.removePropertyChangeListener(j);l.removeTopViewIconFromCache(o);if(o instanceof HomeDoorOrWindow&&l.doorOrWindowWallThicknessAreasCache!=null){CoreTools.removeFromMap(l.doorOrWindowWallThicknessAreasCache,o)}};k.addFurnitureListener(function(p){var o=p.getItem();if(p.getType()===CollectionEvent.Type.ADD){o.addPropertyChangeListener(j);if(o instanceof HomeFurnitureGroup){o.getAllFurniture().forEach(function(q){q.addPropertyChangeListener(j)})}}else{if(p.getType()===CollectionEvent.Type.DELETE){b(o);if(o instanceof HomeFurnitureGroup){o.getAllFurniture().forEach(function(q){b(q)})}}}l.sortedLevelFurniture=null;l.revalidate()});var c=function(p){var o=p.getPropertyName();if("X_START"==o||"X_END"==o||"Y_START"==o||"Y_END"==o||"WALL_AT_START"==o||"WALL_AT_END"==o||"THICKNESS"==o||"ARC_EXTENT"==o||"PATTERN"==o){if(l.home.isAllLevelsSelection()){l.otherLevelsWallAreaCache=null;l.otherLevelsWallsCache=null}l.wallAreasCache=null;l.doorOrWindowWallThicknessAreasCache=null;l.revalidate()}else{if("LEVEL"==o||"HEIGHT"==o||"HEIGHT_AT_END"==o){l.otherLevelsWallAreaCache=null;l.otherLevelsWallsCache=null;l.wallAreasCache=null;l.repaint()}}};if(k.getWalls()!=null){k.getWalls().forEach(function(o){o.addPropertyChangeListener(c)})}k.addWallsListener(function(o){if(o.getType()===CollectionEvent.Type.ADD){o.getItem().addPropertyChangeListener(c)}else{if(o.getType()===CollectionEvent.Type.DELETE){o.getItem().removePropertyChangeListener(c)}}l.otherLevelsWallAreaCache=null;l.otherLevelsWallsCache=null;l.wallAreasCache=null;l.doorOrWindowWallThicknessAreasCache=null;l.revalidate()});var m=function(p){var o=p.getPropertyName();if("POINTS"==o||"NAME"==o||"NAME_X_OFFSET"==o||"NAME_Y_OFFSET"==o||"NAME_STYLE"==o||"NAME_ANGLE"==o||"AREA_VISIBLE"==o||"AREA_X_OFFSET"==o||"AREA_Y_OFFSET"==o||"AREA_STYLE"==o||"AREA_ANGLE"==o){l.sortedLevelRooms=null;l.otherLevelsRoomAreaCache=null;l.otherLevelsRoomsCache=null;l.revalidate()}else{if(l.preferences.isRoomFloorColoredOrTextured()&&("FLOOR_COLOR"==o||"FLOOR_TEXTURE"==o||"FLOOR_VISIBLE"==o)){l.repaint()}}};if(k.getRooms()!=null){k.getRooms().forEach(function(o){return o.addPropertyChangeListener(m)})}k.addRoomsListener(function(o){if(o.getType()===CollectionEvent.Type.ADD){o.getItem().addPropertyChangeListener(m)}else{if(o.getType()===CollectionEvent.Type.DELETE){o.getItem().removePropertyChangeListener(m)}}l.sortedLevelRooms=null;l.otherLevelsRoomAreaCache=null;l.otherLevelsRoomsCache=null;l.revalidate()});var h=function(p){var o=p.getPropertyName();if("COLOR"==o||"DASH_STYLE"==o){l.repaint()}else{l.revalidate()}};if(k.getPolylines()!=null){k.getPolylines().forEach(function(o){return o.addPropertyChangeListener(h)})}k.addPolylinesListener(function(o){if(o.getType()===CollectionEvent.Type.ADD){o.getItem().addPropertyChangeListener(h)}else{if(o.getType()===CollectionEvent.Type.DELETE){o.getItem().removePropertyChangeListener(h)}}l.revalidate()});var g=function(o){return l.revalidate()};if(k.getDimensionLines()!=null){k.getDimensionLines().forEach(function(o){return o.addPropertyChangeListener(g)})}k.addDimensionLinesListener(function(o){if(o.getType()===CollectionEvent.Type.ADD){o.getItem().addPropertyChangeListener(g)}else{if(o.getType()===CollectionEvent.Type.DELETE){o.getItem().removePropertyChangeListener(g)}}l.revalidate()});var a=function(o){return l.revalidate()};if(k.getLabels()!=null){k.getLabels().forEach(function(o){return o.addPropertyChangeListener(a)})}k.addLabelsListener(function(o){if(o.getType()===CollectionEvent.Type.ADD){o.getItem().addPropertyChangeListener(a)}else{if(o.getType()===CollectionEvent.Type.DELETE){o.getItem().removePropertyChangeListener(a)}}l.revalidate()});var d=function(p){var o=p.getPropertyName();if("BACKGROUND_IMAGE"==o){l.backgroundImageCache=null;l.revalidate()}else{if("ELEVATION"==o||"ELEVATION_INDEX"==o||"VIEWABLE"==o){l.backgroundImageCache=null;l.otherLevelsWallAreaCache=null;l.otherLevelsWallsCache=null;l.otherLevelsRoomAreaCache=null;l.otherLevelsRoomsCache=null;l.wallAreasCache=null;l.doorOrWindowWallThicknessAreasCache=null;l.sortedLevelFurniture=null;l.sortedLevelRooms=null;l.repaint()}}};if(k.getLevels()!=null){k.getLevels().forEach(function(o){return o.addPropertyChangeListener(d)})}k.addLevelsListener(function(o){var p=o.getItem();if(o.getType()===CollectionEvent.Type.ADD){p.addPropertyChangeListener(d)}else{if(o.getType()===CollectionEvent.Type.DELETE){p.removePropertyChangeListener(d)}}l.revalidate()});k.addPropertyChangeListener("CAMERA",function(o){return l.revalidate()});k.getObserverCamera().addPropertyChangeListener(function(p){var o=p.getPropertyName();if("X"==o||"Y"==o||"FIELD_OF_VIEW"==o||"YAW"==o||"WIDTH"==o||"DEPTH"==o||"HEIGHT"==o){l.revalidate()}});k.getCompass().addPropertyChangeListener(function(p){var o=p.getPropertyName();if("X"==o||"Y"==o||"NORTH_DIRECTION"==o||"DIAMETER"==o||"VISIBLE"==o){l.revalidate()}});k.addSelectionListener({selectionChanged:function(o){return l.repaint()}});k.addPropertyChangeListener("BACKGROUND_IMAGE",function(o){l.backgroundImageCache=null;l.repaint()});k.addPropertyChangeListener("SELECTED_LEVEL",function(o){l.backgroundImageCache=null;l.otherLevelsWallAreaCache=null;l.otherLevelsWallsCache=null;l.otherLevelsRoomAreaCache=null;l.otherLevelsRoomsCache=null;l.wallAreasCache=null;l.doorOrWindowWallThicknessAreasCache=null;l.sortedLevelRooms=null;l.sortedLevelFurniture=null;l.repaint()});var n=new PlanComponent.UserPreferencesChangeListener(this);e.addPropertyChangeListener("UNIT",n);e.addPropertyChangeListener("LANGUAGE",n);e.addPropertyChangeListener("GRID_VISIBLE",n);e.addPropertyChangeListener("DEFAULT_FONT_NAME",n);e.addPropertyChangeListener("FURNITURE_VIEWED_FROM_TOP",n);e.addPropertyChangeListener("FURNITURE_MODEL_ICON_SIZE",n);e.addPropertyChangeListener("ROOM_FLOOR_COLORED_OR_TEXTURED",n);e.addPropertyChangeListener("WALL_PATTERN",n)};PlanComponent.UserPreferencesChangeListener=function(a){this.planComponent=a};PlanComponent.UserPreferencesChangeListener.prototype.propertyChange=function(b){var d=this.planComponent;var a=b.getSource();var c=b.getPropertyName();if(d==null){a.removePropertyChangeListener(c,this)}else{switch((c)){case"LANGUAGE":case"UNIT":if(d.horizontalRuler!=null){d.horizontalRuler.repaint()}if(d.verticalRuler!=null){d.verticalRuler.repaint()}break;case"DEFAULT_FONT_NAME":d.fonts=null;d.fontsMetrics=null;d.revalidate();break;case"WALL_PATTERN":d.wallAreasCache=null;break;case"FURNITURE_VIEWED_FROM_TOP":if(d.furnitureTopViewIconKeys!=null&&!a.isFurnitureViewedFromTop()){d.furnitureTopViewIconKeys=null;d.furnitureTopViewIconsCache=null}break;case"FURNITURE_MODEL_ICON_SIZE":d.furnitureTopViewIconKeys=null;d.furnitureTopViewIconsCache=null;break;default:break}d.repaint()}};PlanComponent.prototype.removeTopViewIconFromCache=function(c){if(this.furnitureTopViewIconKeys!=null){var e=CoreTools.removeFromMap(this.furnitureTopViewIconKeys,c);if(e!=null){var d=CoreTools.valuesFromMap(this.furnitureTopViewIconKeys);var b=false;for(var a=0;a<d.length;a++){if(d[a].hashCode===e.hashCode&&d[a].equals(e)){b=true}}if(!b){CoreTools.removeFromMap(this.furnitureTopViewIconsCache,e)}}}};PlanComponent.prototype.isEnabled=function(){return true};PlanComponent.prototype.revalidate=function(){this.invalidate(true);this.validate();this.repaint()};PlanComponent.prototype.invalidate=function(a){if(a){var b=this.planBoundsCacheValid;if(!this.invalidPlanBounds){this.invalidPlanBounds=this.getPlanBounds().getBounds2D()}if(b){this.planBoundsCacheValid=false}}};PlanComponent.prototype.validate=function(){if(this.invalidPlanBounds!=null){var e=this.getPreferredSize();if(this.isScrolled()){this.view.style.width=e.width+"px";this.view.style.height=e.height+"px";if(this.canvas.width!==this.scrollPane.clientWidth*this.resolutionScale||this.canvas.height!==this.scrollPane.clientHeight*this.resolutionScale){this.canvas.width=this.scrollPane.clientWidth*this.resolutionScale;this.canvas.height=this.scrollPane.clientHeight*this.resolutionScale;this.canvas.style.width=this.scrollPane.clientWidth+"px";this.canvas.style.height=this.scrollPane.clientHeight+"px"}var d=this.getPlanBounds().getMinX();var c=this.getPlanBounds().getMinY();if(d<this.invalidPlanBounds.getMinX()||c<this.invalidPlanBounds.getMinY()){if(this.scrollPane.clientWidth<this.view.clientWidth||this.scrollPane.clientHeight<this.view.clientHeight.height){var b=this.convertLengthToPixel(this.invalidPlanBounds.getMinX()-d);var a=this.convertLengthToPixel(this.invalidPlanBounds.getMinY()-c);this.scrollPane.scrollLeft+=b;this.scrollPane.scrollTop+=a}}}else{if(this.canvas.width!==this.canvas.clientWidth||this.canvas.height!==this.canvas.clientHeight){this.canvas.width=this.canvas.clientWidth;this.canvas.height=this.canvas.clientHeight}}}delete this.invalidPlanBounds};PlanComponent.prototype.isScrolled=function(){return this.scrollPane!==undefined};PlanComponent.prototype.addMouseListeners=function(a){var c=this;var b={initialPointerLocation:null,lastPointerLocation:null,touchEventType:false,pointerTouches:{},lastEventType:null,lastTargetTouches:[],distanceLastPinch:null,panningAfterPinch:false,firstTouchStartedTimeStamp:0,longTouchStartTime:0,autoScroll:null,longTouch:null,longTouchWhenDragged:false,actionStartedInPlanComponent:false,contextMenuEventType:false,mousePressed:function(d){if(!b.touchEventType&&!b.contextMenuEventType&&c.isEnabled()&&d.button===0){b.updateCoordinates(d,"mousePressed");b.autoScroll=null;b.initialPointerLocation=[d.canvasX,d.canvasY];b.lastPointerLocation=[d.canvasX,d.canvasY];b.actionStartedInPlanComponent=true;a.pressMouse(c.convertXPixelToModel(d.canvasX),c.convertYPixelToModel(d.canvasY),d.clickCount,b.isShiftDown(d),b.isAlignmentActivated(d),b.isDuplicationActivated(d),b.isMagnetismToggled(d))}d.stopPropagation()},isShiftDown:function(d){return d.shiftKey&&!d.altKey&&!d.ctrlKey&&!d.metaKey},isAlignmentActivated:function(d){return OperatingSystem.isWindows()||OperatingSystem.isMacOSX()?d.shiftKey:d.shiftKey&&!d.altKey},isDuplicationActivated:function(d){return OperatingSystem.isMacOSX()?d.altKey:d.ctrlKey},isMagnetismToggled:function(d){return OperatingSystem.isWindows()?d.altKey:(OperatingSystem.isMacOSX()?d.metaKey:d.shiftKey&&d.altKey)},mouseDoubleClicked:function(d){b.updateCoordinates(d,"mouseDoubleClicked");b.mousePressed(d)},windowMouseMoved:function(d){if(!b.touchEventType&&!b.contextMenuEventType){b.updateCoordinates(d,"mouseMoved");if(b.lastPointerLocation!=null){if(b.autoScroll==null&&!b.isInCanvas(d)){b.autoScroll=setInterval(function(){if(b.actionStartedInPlanComponent){var e=document.createEvent("Event");e.initEvent("mousemove",true,true);e.clientX=d.clientX;e.clientY=d.clientY;window.dispatchEvent(e)}else{clearInterval(b.autoScroll);b.autoScroll=null}},10)}if(b.autoScroll!=null&&b.isInCanvas(d)){clearInterval(b.autoScroll);b.autoScroll=null}b.lastPointerLocation=[d.canvasX,d.canvasY]}if(b.initialPointerLocation!=null&&!(b.initialPointerLocation[0]===d.canvasX&&b.initialPointerLocation[1]===d.canvasY)){b.initialPointerLocation=null}if(b.initialPointerLocation==null&&(d.buttons===0&&b.isInCanvas(d)||b.actionStartedInPlanComponent)){if(c.isEnabled()){a.moveMouse(c.convertXPixelToModel(d.canvasX),c.convertYPixelToModel(d.canvasY))}}}},windowMouseReleased:function(d){if(!b.touchEventType){if(b.lastPointerLocation!=null){if(b.autoScroll!=null){clearInterval(b.autoScroll);b.autoScroll=null}if(b.actionStartedInPlanComponent&&c.isEnabled()&&d.button===0){if(b.contextMenuEventType){a.releaseMouse(c.convertXPixelToModel(b.initialPointerLocation[0]),c.convertYPixelToModel(b.initialPointerLocation[1]))}else{b.updateCoordinates(d,"mouseReleased");a.releaseMouse(c.convertXPixelToModel(d.canvasX),c.convertYPixelToModel(d.canvasY))}}b.initialPointerLocation=null;b.lastPointerLocation=null;b.actionStartedInPlanComponent=false}}b.contextMenuEventType=false},pointerPressed:function(d){if(d.pointerType=="mouse"){b.mousePressed(d)}else{b.copyPointerToTargetTouches(d,false);b.touchStarted(d)}},pointerMousePressed:function(d){d.stopPropagation()},windowPointerMoved:function(d){if(d.pointerType=="mouse"){b.windowMouseMoved(d)}else{b.copyPointerToTargetTouches(d,false);b.touchMoved(d)}},windowPointerReleased:function(d){if(d.pointerType=="mouse"){b.windowMouseReleased(d)}else{d.preventDefault();b.copyPointerToTargetTouches(d,true);b.touchEnded(d)}},contextMenuDisplayed:function(d){b.contextMenuEventType=true},touchStarted:function(e){b.touchEventType=e.pointerType===undefined;if(c.isEnabled()){e.preventDefault();if(document.activeElement!=c.container){c.container.focus()}b.updateCoordinates(e,"touchStarted");b.autoScroll=null;if(b.longTouch!=null){clearTimeout(b.longTouch);b.longTouch=null;c.stopLongTouchAnimation()}if(e.targetTouches.length===1){var d=1;if(b.initialPointerLocation!=null&&b.distance(e.canvasX,e.canvasY,b.initialPointerLocation[0],b.initialPointerLocation[1])<5&&e.timeStamp-b.firstTouchStartedTimeStamp<=PlanComponent.DOUBLE_TOUCH_DELAY){d=2;b.firstTouchStartedTimeStamp=0;b.initialPointerLocation=null}else{b.firstTouchStartedTimeStamp=e.timeStamp;b.initialPointerLocation=[e.canvasX,e.canvasY]}b.distanceLastPinch=null;b.lastPointerLocation=[e.canvasX,e.canvasY];b.actionStartedInPlanComponent=true;b.longTouchWhenDragged=false;if(a.getMode()!==PlanController.Mode.PANNING&&d==1){var f=a.getMode()===PlanController.Mode.SELECTION?"&#x21EA;":(a.getMode()===PlanController.Mode.POLYLINE_CREATION&&!a.isModificationState()?"S":"2");b.longTouch=setTimeout(function(){c.startLongTouchAnimation(e.canvasX,e.canvasY,f,function(){if(a.getMode()===PlanController.Mode.SELECTION){a.setAlignmentActivated(true)}else{if(a.getMode()===PlanController.Mode.POLYLINE_CREATION){a.setDuplicationActivated(true)}}})},PlanComponent.LONG_TOUCH_DELAY);b.longTouchStartTime=Date.now()}a.pressMouse(c.convertXPixelToModel(e.canvasX),c.convertYPixelToModel(e.canvasY),d,b.isShiftDown(e),b.isAlignmentActivated(e),b.isDuplicationActivated(e),b.isMagnetismToggled(e),View.PointerType.TOUCH)}else{if(b.autoScroll!=null){clearInterval(b.autoScroll);b.autoScroll=null}a.escape();if(e.targetTouches.length===2){b.actionStartedInPlanComponent=true;b.initialPointerLocation=null;b.distanceLastPinch=b.distance(e.targetTouches[0].clientX,e.targetTouches[0].clientY,e.targetTouches[1].clientX,e.targetTouches[1].clientY)}}}},touchMoved:function(j){if(b.actionStartedInPlanComponent&&c.isEnabled()){j.preventDefault();j.stopPropagation();if(b.updateCoordinates(j,"touchMoved")){c.stopIndicatorAnimation();b.initialPointerLocation=null;if(j.targetTouches.length==1){if(b.lastPointerLocation!=null){if(b.autoScroll!=null&&b.isInCanvas(j)){clearInterval(b.autoScroll);b.autoScroll=null}if(b.autoScroll==null&&!b.isInCanvas(j)&&a.getMode()!==PlanController.Mode.PANNING&&b.lastPointerLocation!=null){b.autoScroll=setInterval(function(){if(b.actionStartedInPlanComponent){b.touchMoved(j)}else{clearInterval(b.autoScroll);b.autoScroll=null}},10)}}if(b.longTouch!=null){clearTimeout(b.longTouch);b.longTouch=null;c.stopLongTouchAnimation()}b.lastPointerLocation=[j.canvasX,j.canvasY];a.moveMouse(c.convertXPixelToModel(j.canvasX),c.convertYPixelToModel(j.canvasY));if(!b.autoScroll&&a.getMode()!==PlanController.Mode.PANNING&&a.getMode()!==PlanController.Mode.SELECTION){b.longTouch=setTimeout(function(){b.longTouchWhenDragged=true;c.startLongTouchAnimation(j.canvasX,j.canvasY,"2")},PlanComponent.LONG_TOUCH_DELAY_WHEN_DRAGGING);b.longTouchStartTime=Date.now()}}else{if(j.targetTouches.length==2&&b.distanceLastPinch!=null){var m=b.distance(j.targetTouches[0].clientX,j.targetTouches[0].clientY,j.targetTouches[1].clientX,j.targetTouches[1].clientY);var g=m/b.distanceLastPinch;var k=c.canvas.getBoundingClientRect();var l=c.convertXPixelToModel((j.targetTouches[0].clientX+j.targetTouches[1].clientX)/2-k.left);var h=c.convertYPixelToModel((j.targetTouches[0].clientY+j.targetTouches[1].clientY)/2-k.top);var f=c.getScale();a.zoom(g);b.distanceLastPinch=m;if(c.isScrolled()&&c.getScale()!==f){c.scrollPane.scrollLeft=0;c.scrollPane.scrollTop=0;var e=(j.targetTouches[0].clientX+j.targetTouches[1].clientX)/2-k.left-c.convertXModelToPixel(l);var d=(j.targetTouches[0].clientY+j.targetTouches[1].clientY)/2-k.top-c.convertYModelToPixel(h);c.moveView(-c.convertPixelToLength(e),-c.convertPixelToLength(d))}}}}}},touchEnded:function(f){if(b.actionStartedInPlanComponent&&c.isEnabled()){b.updateCoordinates(f,"touchEnded");if(b.panningAfterPinch){a.setMode(PlanController.Mode.SELECTION);b.panningAfterPinch=false}if(f.targetTouches.length==0){if(b.autoScroll!=null){clearInterval(b.autoScroll);b.autoScroll=null}if(b.longTouch!=null){clearTimeout(b.longTouch);b.longTouch=null;c.stopLongTouchAnimation()}var e=c.convertXPixelToModel(b.lastPointerLocation[0]);var d=c.convertYPixelToModel(b.lastPointerLocation[1]);a.releaseMouse(e,d);if(a.getMode()!==PlanController.Mode.SELECTION){if(b.isLongTouch(true)&&b.longTouchWhenDragged){a.pressMouse(e,d,1,false,false,false,false,View.PointerType.TOUCH);a.releaseMouse(e,d);a.pressMouse(e,d,2,false,false,false,false,View.PointerType.TOUCH);a.releaseMouse(e,d)}else{if(b.isLongTouch()&&b.initialPointerLocation!=null){a.pressMouse(e,d,2,false,false,false,false,View.PointerType.TOUCH);a.releaseMouse(e,d)}}}if(b.isLongTouch()){f.preventDefault()}c.stopIndicatorAnimation();b.actionStartedInPlanComponent=false}else{if(f.targetTouches.length==1){if(a.getMode()===PlanController.Mode.SELECTION){a.setMode(PlanController.Mode.PANNING);a.pressMouse(c.convertXPixelToModel(f.canvasX),c.convertYPixelToModel(f.canvasY),1,false,false,false,false,View.PointerType.TOUCH);b.panningAfterPinch=true}}else{if(f.targetTouches.length==2&&b.distanceLastPinch!=null){b.distanceLastPinch=b.distance(f.targetTouches[0].clientX,f.targetTouches[0].clientY,f.targetTouches[1].clientX,f.targetTouches[1].clientY)}}}c.lastTouchX=undefined;c.lastTouchY=undefined}},copyPointerToTargetTouches:function(f,d){if(d){f.changedTouches=[b.pointerTouches[f.pointerId]];delete b.pointerTouches[f.pointerId]}else{b.pointerTouches[f.pointerId]={clientX:f.clientX,clientY:f.clientY}}f.targetTouches=[];for(var e in b.pointerTouches){if(b.pointerTouches.hasOwnProperty(e)){f.targetTouches.push(b.pointerTouches[e])}}},updateCoordinates:function(h,f){c.lastTouchX=undefined;c.lastTouchY=undefined;var g=c.canvas.getBoundingClientRect();var d=true;if(f.indexOf("touch")===0){c.pointerType=View.PointerType.TOUCH;var k=b.lastEventType=="touchStarted"?5:1.5;var j;if(h.targetTouches.length===1&&f=="touchMoved"&&b.distance(b.lastTargetTouches[0].clientX,b.lastTargetTouches[0].clientY,h.targetTouches[0].clientX,h.targetTouches[0].clientY)<k||h.targetTouches.length===0&&f=="touchEnded"&&b.distance(b.lastTargetTouches[0].clientX,b.lastTargetTouches[0].clientY,h.changedTouches[0].clientX,h.changedTouches[0].clientY)<k){j=b.lastTargetTouches;d=false}else{if(h.targetTouches.length==0){j=h.changedTouches}else{j=h.targetTouches}b.lastEventType=f}if(j.length==1){h.canvasX=j[0].clientX-g.left;h.canvasY=j[0].clientY-g.top;c.lastTouchX=h.canvasX;c.lastTouchY=h.canvasY}h.clickCount=1;if(d){b.lastTargetTouches=[];for(var e=0;j[e]!==undefined;e++){b.lastTargetTouches.push({clientX:j[e].clientX,clientY:j[e].clientY})}}}else{c.pointerType=View.PointerType.MOUSE;h.canvasX=h.clientX-g.left;h.canvasY=h.clientY-g.top}if(h.clickCount===undefined){if(f=="mouseDoubleClicked"){h.clickCount=2}else{if(f=="mousePressed"||f=="mouseReleased"){h.clickCount=1}else{h.clickCount=0}}}if(f=="mouseWheelMoved"){h.wheelRotation=(h.deltaY!==undefined?h.deltaX+h.deltaY:-h.wheelDelta)/4}return d},isLongTouch:function(d){return Date.now()-b.longTouchStartTime>((d?PlanComponent.LONG_TOUCH_DELAY_WHEN_DRAGGING:PlanComponent.LONG_TOUCH_DELAY)+PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY)},distance:function(e,g,d,f){return Math.sqrt(Math.pow(d-e,2)+Math.pow(f-g,2))},isInCanvas:function(d){return d.canvasX>=0&&d.canvasX<c.canvas.clientWidth&&d.canvasY>=0&&d.canvasY<c.canvas.clientHeight},mouseWheelMoved:function(f){f.preventDefault();b.updateCoordinates(f,"mouseWheelMoved");var g=OperatingSystem.isMacOSX()?f.metaKey:f.ctrlKey;if(g){var d=c.convertXPixelToModel(f.canvasX);var k=c.convertYPixelToModel(f.canvasY);var e=c.getScale();a.zoom(f.wheelRotation<0?Math.pow(1.05,-f.wheelRotation):Math.pow(0.95,f.wheelRotation));if(c.isScrolled()&&c.getScale()!==e){c.scrollPane.scrollLeft=0;c.scrollPane.scrollTop=0;var j=f.canvasX-c.convertXModelToPixel(d);var h=f.canvasY-c.convertYModelToPixel(k);c.moveView(-c.convertPixelToLength(j),-c.convertPixelToLength(h))}}else{c.moveView(f.shiftKey?c.convertPixelToLength(f.wheelRotation):0,f.shiftKey?0:c.convertPixelToLength(f.wheelRotation))}}};if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){this.canvas.addEventListener("pointerdown",b.pointerPressed);this.canvas.addEventListener("mousedown",b.pointerMousePressed);this.canvas.addEventListener("dblclick",b.mouseDoubleClicked);window.addEventListener("pointermove",b.windowPointerMoved);window.addEventListener("pointerup",b.windowPointerReleased)}else{this.canvas.addEventListener("touchstart",b.touchStarted);this.canvas.addEventListener("touchmove",b.touchMoved);this.canvas.addEventListener("touchend",b.touchEnded);this.canvas.addEventListener("mousedown",b.mousePressed);this.canvas.addEventListener("dblclick",b.mouseDoubleClicked);window.addEventListener("mousemove",b.windowMouseMoved);window.addEventListener("mouseup",b.windowMouseReleased)}this.canvas.addEventListener("contextmenu",b.contextMenuDisplayed);this.canvas.addEventListener("mousewheel",b.mouseWheelMoved);this.mouseListener=b};PlanComponent.prototype.startLongTouchAnimation=function(a,e,d,c){this.touchOverlay.style.visibility="visible";if(d=="&#x21EA;"){document.getElementById("touch-overlay-timer-content").innerHTML="<span style='font-weight: bold; font-family: sans-serif; font-size: 140%; line-height: 90%'>&#x21EA;</span>"}else{document.getElementById("touch-overlay-timer-content").innerHTML="<span style='font-weight: bold; font-family: sans-serif'>"+d+"</span>"}this.touchOverlay.style.left=(this.canvas.getBoundingClientRect().left+a-this.touchOverlay.clientWidth/2)+"px";this.touchOverlay.style.top=(this.canvas.getBoundingClientRect().top+e-this.touchOverlay.clientHeight-40)+"px";if(this.tooltip.style.visibility=="visible"){this.tooltip.style.marginTop=-(this.tooltip.clientHeight+70)+"px"}for(var b=0;b<this.touchOverlay.children.length;b++){this.touchOverlay.children.item(b).classList.remove("indicator");this.touchOverlay.children.item(b).classList.add("animated")}if(c!==undefined){this.longTouchAnimationPostTask=setTimeout(c,PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY)}};PlanComponent.prototype.stopLongTouchAnimation=function(a,c){this.touchOverlay.style.visibility="hidden";for(var b=0;b<this.touchOverlay.children.length;b++){this.touchOverlay.children.item(b).classList.remove("animated");this.touchOverlay.children.item(b).classList.remove("indicator")}if(this.longTouchAnimationPostTask!==undefined){clearTimeout(this.longTouchAnimationPostTask);delete this.longTouchAnimationPostTask}};PlanComponent.prototype.startIndicatorAnimation=function(a,d,b){if(b=="default"||b=="selection"){this.touchOverlay.style.visibility="hidden"}else{this.touchOverlay.style.visibility="visible";document.getElementById("touch-overlay-timer-content").innerHTML='<img src="'+ZIPTools.getScriptFolder()+"resources/cursors/"+b+'32x32.png"/>';this.touchOverlay.style.left=(this.canvas.getBoundingClientRect().left+a-this.touchOverlay.clientWidth/2)+"px";this.touchOverlay.style.top=(this.canvas.getBoundingClientRect().top+d-this.touchOverlay.clientHeight-40)+"px";if(this.tooltip.style.visibility=="visible"){this.tooltip.style.marginTop=-(this.tooltip.clientHeight+65)+"px"}for(var c=0;c<this.touchOverlay.children.length;c++){this.touchOverlay.children.item(c).classList.remove("animated");this.touchOverlay.children.item(c).classList.add("indicator")}}};PlanComponent.prototype.stopIndicatorAnimation=function(){this.touchOverlay.style.visibility="hidden";for(var a=0;a<this.touchOverlay.children.length;a++){this.touchOverlay.children.item(a).classList.remove("animated");this.touchOverlay.children.item(a).classList.remove("indicator")}};PlanComponent.prototype.addFocusListener=function(a){var b=this;this.container.addEventListener("focusout",function(){b.mouseListener.lastPointerLocation=null;b.mouseListener.actionStartedInPlanComponent=false;a.escape()})};PlanComponent.prototype.addControllerListener=function(a){var b=this;a.addPropertyChangeListener("BASE_PLAN_MODIFICATION_STATE",function(g){var e=a.isBasePlanModificationState();if(e){if(a.getMode()!==PlanController.Mode.WALL_CREATION){var c=b.draggedItemsFeedback!=null?b.draggedItemsFeedback:b.home.getSelectedItems();for(var d=0;d<c.length;d++){var f=c[d];if(!(f instanceof Wall)&&!((f instanceof HomePieceOfFurniture)&&f.isDoorOrWindow())){e=false}}}}if(b.wallsDoorsOrWindowsModification!==e){b.wallsDoorsOrWindowsModification=e;b.repaint()}})};PlanComponent.prototype.installDefaultKeyboardActions=function(){var a=this;this.inputMap={"pressed DELETE":"DELETE_SELECTION","pressed BACK_SPACE":"DELETE_SELECTION","pressed ESCAPE":"ESCAPE","shift pressed ESCAPE":"ESCAPE","pressed LEFT":"MOVE_SELECTION_LEFT","shift pressed LEFT":"MOVE_SELECTION_FAST_LEFT","pressed UP":"MOVE_SELECTION_UP","shift pressed UP":"MOVE_SELECTION_FAST_UP","pressed DOWN":"MOVE_SELECTION_DOWN","shift pressed DOWN":"MOVE_SELECTION_FAST_DOWN","pressed RIGHT":"MOVE_SELECTION_RIGHT","shift pressed RIGHT":"MOVE_SELECTION_FAST_RIGHT","pressed ENTER":"ACTIVATE_EDITIION","shift pressed ENTER":"ACTIVATE_EDITIION"};if(OperatingSystem.isMacOSX()){CoreTools.merge(this.inputMap,{"alt pressed ALT":"ACTIVATE_DUPLICATION","released ALT":"DEACTIVATE_DUPLICATION","shift alt pressed ALT":"ACTIVATE_DUPLICATION","shift released ALT":"DEACTIVATE_DUPLICATION","meta alt pressed ALT":"ACTIVATE_DUPLICATION","meta released ALT":"DEACTIVATE_DUPLICATION","shift meta alt pressed ALT":"ACTIVATE_DUPLICATION","shift meta released ALT":"DEACTIVATE_DUPLICATION","alt pressed ESCAPE":"ESCAPE","alt pressed ENTER":"ACTIVATE_EDITIION"})}else{CoreTools.merge(this.inputMap,{"control pressed CONTROL":"ACTIVATE_DUPLICATION","released CONTROL":"DEACTIVATE_DUPLICATION","shift control pressed CONTROL":"ACTIVATE_DUPLICATION","shift released CONTROL":"DEACTIVATE_DUPLICATION","meta control pressed CONTROL":"ACTIVATE_DUPLICATION","meta released CONTROL":"DEACTIVATE_DUPLICATION","shift meta control pressed CONTROL":"ACTIVATE_DUPLICATION","shift meta released CONTROL":"DEACTIVATE_DUPLICATION","control pressed ESCAPE":"ESCAPE","control pressed ENTER":"ACTIVATE_EDITIION"})}if(OperatingSystem.isWindows()){CoreTools.merge(this.inputMap,{"alt pressed ALT":"TOGGLE_MAGNETISM_ON","released ALT":"TOGGLE_MAGNETISM_OFF","shift alt pressed ALT":"TOGGLE_MAGNETISM_ON","shift released ALT":"TOGGLE_MAGNETISM_OFF","control alt pressed ALT":"TOGGLE_MAGNETISM_ON","control released ALT":"TOGGLE_MAGNETISM_OFF","shift control alt pressed ALT":"TOGGLE_MAGNETISM_ON","shift control released ALT":"TOGGLE_MAGNETISM_OFF","alt pressed ESCAPE":"ESCAPE","alt pressed ENTER":"ACTIVATE_EDITIION"})}else{if(OperatingSystem.isMacOSX()){CoreTools.merge(this.inputMap,{"meta pressed META":"TOGGLE_MAGNETISM_ON","released META":"TOGGLE_MAGNETISM_OFF","shift meta pressed META":"TOGGLE_MAGNETISM_ON","shift released META":"TOGGLE_MAGNETISM_OFF","alt meta pressed META":"TOGGLE_MAGNETISM_ON","alt released META":"TOGGLE_MAGNETISM_OFF","shift alt meta pressed META":"TOGGLE_MAGNETISM_ON","shift alt released META":"TOGGLE_MAGNETISM_OFF","meta pressed ESCAPE":"ESCAPE","meta pressed ENTER":"ACTIVATE_EDITIION"})}else{CoreTools.merge(this.inputMap,{"shift alt pressed ALT":"TOGGLE_MAGNETISM_ON","alt shift pressed SHIFT":"TOGGLE_MAGNETISM_ON","alt released SHIFT":"TOGGLE_MAGNETISM_OFF","shift released ALT":"TOGGLE_MAGNETISM_OFF","control shift alt pressed ALT":"TOGGLE_MAGNETISM_ON","control alt shift pressed SHIFT":"TOGGLE_MAGNETISM_ON","control alt released SHIFT":"TOGGLE_MAGNETISM_OFF","control shift released ALT":"TOGGLE_MAGNETISM_OFF","alt shift pressed ESCAPE":"ESCAPE","alt shift  pressed ENTER":"ACTIVATE_EDITIION","control alt shift pressed ESCAPE":"ESCAPE","control alt shift pressed ENTER":"ACTIVATE_EDITIION"})}}CoreTools.merge(this.inputMap,{"shift pressed SHIFT":"ACTIVATE_ALIGNMENT","released SHIFT":"DEACTIVATE_ALIGNMENT"});if(OperatingSystem.isWindows()){CoreTools.merge(this.inputMap,{"control shift pressed SHIFT":"ACTIVATE_ALIGNMENT","control released SHIFT":"DEACTIVATE_ALIGNMENT","alt shift pressed SHIFT":"ACTIVATE_ALIGNMENT","alt released SHIFT":"DEACTIVATE_ALIGNMENT"})}else{if(OperatingSystem.isMacOSX()){CoreTools.merge(this.inputMap,{"alt shift pressed SHIFT":"ACTIVATE_ALIGNMENT","alt released SHIFT":"DEACTIVATE_ALIGNMENT","meta shift pressed SHIFT":"ACTIVATE_ALIGNMENT","meta released SHIFT":"DEACTIVATE_ALIGNMENT"})}else{CoreTools.merge(this.inputMap,{"control shift pressed SHIFT":"ACTIVATE_ALIGNMENT","control released SHIFT":"DEACTIVATE_ALIGNMENT","shift released ALT":"ACTIVATE_ALIGNMENT","control shift released ALT":"ACTIVATE_ALIGNMENT"})}}this.container.addEventListener("keydown",function(b){return a.callAction(b,"keydown")},true);this.container.addEventListener("keyup",function(b){return a.callAction(b,"keyup")},true)};PlanComponent.prototype.callAction=function(a,e){var d=KeyStroke.getKeyStrokeForEvent(a,e);if(d!==undefined){var c=this.inputMap[d];if(c!==undefined){var b=this.actionMap[c];if(b!==undefined){b.actionPerformed(a)}a.stopPropagation()}}};PlanComponent.prototype.installEditionKeyboardActions=function(){this.inputMap={ESCAPE:"ESCAPE","shift ESCAPE":"ESCAPE",ENTER:"DEACTIVATE_EDITIION","shift ENTER":"DEACTIVATE_EDITIION"};if(OperatingSystem.isMacOSX()){CoreTools.merge(this.inputMap,{"alt ESCAPE":"ESCAPE","alt ENTER":"DEACTIVATE_EDITIION","alt shift ENTER":"DEACTIVATE_EDITIION","alt pressed ALT":"ACTIVATE_DUPLICATION","released ALT":"DEACTIVATE_DUPLICATION","shift alt pressed ALT":"ACTIVATE_DUPLICATION","shift released ALT":"DEACTIVATE_DUPLICATION"})}else{CoreTools.merge(this.inputMap,{"control ESCAPE":"ESCAPE","control ENTER":"DEACTIVATE_EDITIION","control shift ENTER":"DEACTIVATE_EDITIION","control pressed CONTROL":"ACTIVATE_DUPLICATION","released CONTROL":"DEACTIVATE_DUPLICATION","shift control pressed CONTROL":"ACTIVATE_DUPLICATION","shift released CONTROL":"DEACTIVATE_DUPLICATION"})}};PlanComponent.prototype.createActions=function(a){var g=this;function f(j,h){this.dx=j;this.dy=h}f.prototype.actionPerformed=function(h){a.moveSelection(this.dx/g.getScale(),this.dy/g.getScale())};function c(h){this.toggle=h}c.prototype.actionPerformed=function(h){a.toggleMagnetism(this.toggle)};function e(h){this.alignmentActivated=h}e.prototype.actionPerformed=function(h){a.setAlignmentActivated(this.alignmentActivated)};function b(h){this.duplicationActivated=h}b.prototype.actionPerformed=function(h){a.setDuplicationActivated(this.duplicationActivated)};function d(h){this.editionActivated=h}d.prototype.actionPerformed=function(h){a.setEditionActivated(this.editionActivated)};this.actionMap={DELETE_SELECTION:{actionPerformed:function(){a.deleteSelection()}},ESCAPE:{actionPerformed:function(){a.escape()}},MOVE_SELECTION_LEFT:new f(-1,0),MOVE_SELECTION_FAST_LEFT:new f(-10,0),MOVE_SELECTION_UP:new f(0,-1),MOVE_SELECTION_FAST_UP:new f(0,-10),MOVE_SELECTION_DOWN:new f(0,1),MOVE_SELECTION_FAST_DOWN:new f(0,10),MOVE_SELECTION_RIGHT:new f(1,0),MOVE_SELECTION_FAST_RIGHT:new f(10,0),TOGGLE_MAGNETISM_ON:new c(true),TOGGLE_MAGNETISM_OFF:new c(false),ACTIVATE_ALIGNMENT:new e(true),DEACTIVATE_ALIGNMENT:new e(false),ACTIVATE_DUPLICATION:new b(true),DEACTIVATE_DUPLICATION:new b(false),ACTIVATE_EDITIION:new d(true),DEACTIVATE_EDITIION:new d(false)}};PlanComponent.createCustomCursor=function(a,b){if(OperatingSystem.isInternetExplorer()){return b}else{return'url("'+ZIPTools.getScriptFolder()+"/resources/cursors/"+a+"16x16"+(OperatingSystem.isMacOSX()?"-macosx":"")+'.png") 8 8, '+b}};PlanComponent.prototype.getPreferredSize=function(){var a=this.getInsets();var b=this.getPlanBounds();return{width:this.convertLengthToPixel(b.getWidth()+PlanComponent.MARGIN*2)+a.left+a.right,height:this.convertLengthToPixel(b.getHeight()+PlanComponent.MARGIN*2)+a.top+a.bottom}};PlanComponent.prototype.getInsets=function(){return{top:0,bottom:0,left:0,right:0}};PlanComponent.prototype.getWidth=function(){return this.view.clientWidth};PlanComponent.prototype.getHeight=function(){return this.view.clientHeight};PlanComponent.prototype.getPlanBounds=function(){var d=this;if(!this.planBoundsCacheValid){if(this.planBoundsCache==null){this.planBoundsCache=new java.awt.geom.Rectangle2D.Float(0,0,1000,1000)}if(this.backgroundImageCache!=null){var c=this.home.getBackgroundImage();if(c!=null){this.planBoundsCache.add(-c.getXOrigin(),-c.getYOrigin());this.planBoundsCache.add(this.backgroundImageCache.width*c.getScale()-c.getXOrigin(),this.backgroundImageCache.height*c.getScale()-c.getYOrigin())}this.home.getLevels().forEach(function(f){var e=f.getBackgroundImage();if(e!=null){d.planBoundsCache.add(-e.getXOrigin(),-e.getYOrigin());d.planBoundsCache.add(d.backgroundImageCache.width*e.getScale()-e.getXOrigin(),d.backgroundImageCache.height*e.getScale()-e.getYOrigin())}})}var b=this.getGraphics();if(b!=null){this.setRenderingHints(b)}var a=this.getItemsBounds(b,this.getPaintedItems());if(a!=null){this.planBoundsCache.add(a)}this.home.getObserverCamera().getPoints().forEach(function(e){return d.planBoundsCache.add(e[0],e[1])});this.planBoundsCacheValid=true}return this.planBoundsCache};PlanComponent.prototype.getPaintedItems=function(){return this.home.getSelectableViewableItems()};PlanComponent.prototype.getItemsBounds=function(f,a){var b=null;for(var c=0;c<a.length;c++){var e=a[c];var d=this.getItemBounds(f,e);if(b==null){b=d}else{b.add(d)}}return b};PlanComponent.prototype.getItemBounds=function(y,D){var d=this;var w=D.getPoints();var o=new java.awt.geom.Rectangle2D.Float(w[0][0],w[0][1],0,0);for(var x=1;x<w.length;x++){o.add(w[x][0],w[x][1])}var c;if(y!=null){c=y.getFont()}else{c=this.getFont()}if(D instanceof Room){var C=D;var t=C.getXCenter();var A=C.getYCenter();var E=C.getName();if(E!=null&&E.length>0){this.addTextBounds(C.constructor,E,C.getNameStyle(),t+C.getNameXOffset(),A+C.getNameYOffset(),C.getNameAngle(),o)}if(C.isAreaVisible()){var B=C.getArea();if(B>0.01){var r=this.preferences.getLengthUnit().getAreaFormatWithUnit().format(B);this.addTextBounds(C.constructor,r,C.getAreaStyle(),t+C.getAreaXOffset(),A+C.getAreaYOffset(),C.getAreaAngle(),o)}}}else{if(D instanceof Polyline){var s=D;return ShapeTools.getPolylineShape(s.getPoints(),s.getJoinStyle()===Polyline.JoinStyle.CURVED,s.isClosedPath()).getBounds2D()}else{if(D instanceof HomePieceOfFurniture){if(D!=null&&D instanceof HomeDoorOrWindow){var F=D;F.getSashes().forEach(function(g){o.add(d.getDoorOrWindowSashShape(F,g).getBounds2D())})}else{if(D instanceof HomeFurnitureGroup){o.add(this.getItemsBounds(y,D.getFurniture()))}}var e=D;var n=e.getName();if(e.isVisible()&&e.isNameVisible()&&n.length>0){this.addTextBounds(e.constructor,n,e.getNameStyle(),e.getX()+e.getNameXOffset(),e.getY()+e.getNameYOffset(),e.getNameAngle(),o)}}else{if(D instanceof DimensionLine){var k=D;var j=k.getLength();var f=this.preferences.getLengthUnit().getFormat().format(j);var u=k.getLengthStyle();if(u==null){u=this.preferences.getDefaultTextStyle(k.constructor)}var l=this.getFontMetrics(c,u);var p=l.getStringBounds(f);var z=Math.atan2(k.getYEnd()-k.getYStart(),k.getXEnd()-k.getXStart());var q=java.awt.geom.AffineTransform.getTranslateInstance(k.getXStart(),k.getYStart());q.rotate(z);q.translate(0,k.getOffset());q.translate((j-p.getWidth())/2,k.getOffset()<=0?-l.getDescent()-1:l.getAscent()+1);var v=new java.awt.geom.GeneralPath(p);for(var h=v.getPathIterator(q);!h.isDone();h.next()){var b=[0,0];if(h.currentSegment(b)!==java.awt.geom.PathIterator.SEG_CLOSE){o.add(b[0],b[1])}}q.setToTranslation(k.getXStart(),k.getYStart());q.rotate(z);q.translate(0,k.getOffset());for(var h=PlanComponent.DIMENSION_LINE_END.getPathIterator(q);!h.isDone();h.next()){var b=[0,0];if(h.currentSegment(b)!==java.awt.geom.PathIterator.SEG_CLOSE){o.add(b[0],b[1])}}q.translate(j,0);for(var h=PlanComponent.DIMENSION_LINE_END.getPathIterator(q);!h.isDone();h.next()){var b=[0,0];if(h.currentSegment(b)!==java.awt.geom.PathIterator.SEG_CLOSE){o.add(b[0],b[1])}}}else{if(D instanceof Label){var m=D;this.addTextBounds(m.constructor,m.getText(),m.getStyle(),m.getX(),m.getY(),m.getAngle(),o)}else{if(D instanceof Compass){var a=D;var q=java.awt.geom.AffineTransform.getTranslateInstance(a.getX(),a.getY());q.scale(a.getDiameter(),a.getDiameter());q.rotate(a.getNorthDirection());return PlanComponent.COMPASS.createTransformedShape(q).getBounds2D()}}}}}}return o};PlanComponent.prototype.addTextBounds=function(b,f,c,a,g,e,d){if(c==null){c=this.preferences.getDefaultTextStyle(b)}this.getTextBounds(f,c,a,g,e).forEach(function(h){return d.add(h[0],h[1])})};PlanComponent.prototype.getTextBounds=function(m,p,k,j,r){var e=this.getFontMetrics(this.getFont(),p);var n=null;var b=m.replace(/\n*$/,"").split("\n");var q=this.getGraphics();if(q!=null){this.setRenderingHints(q)}for(var o=0;o<b.length;o++){var t=e.getStringBounds(b[o]);if(n==null||n.getWidth()<t.getWidth()){n=t}}var d=n.getWidth();var v;if(p.getAlignment()===TextStyle.Alignment.LEFT){v=0}else{if(p.getAlignment()===TextStyle.Alignment.RIGHT){v=-d}else{v=-d/2}}if(r===0){var u=(j+n.getY());var s=(u+n.getHeight());u-=(n.getHeight()*(b.length-1));return[[k+v,u],[k+v+d,u],[k+v+d,s],[k+v,s]]}else{n.add(n.getX(),n.getY()-n.getHeight()*(b.length-1));var l=new java.awt.geom.AffineTransform();l.translate(k,j);l.rotate(r);l.translate(v,0);var c=new java.awt.geom.GeneralPath(n);var f=[];for(var h=c.getPathIterator(l);!h.isDone();h.next()){var a=[0,0];if(h.currentSegment(a)!==java.awt.geom.PathIterator.SEG_CLOSE){f.push(a)}}return f.slice(0)}};PlanComponent.prototype.getFont=function(d,f){if(d==null&&f==null){return this.font}if(this.fonts==null){this.fonts={}}var b=CoreTools.getFromMap(this.fonts,f);if(b==null){var e="normal";var a="normal";if(f.isBold()){a="bold"}if(f.isItalic()){e="italic"}if(d==null||this.preferences.getDefaultFontName()!=null||f.getFontName()!=null){var c=f.getFontName();if(c==null){c=this.preferences.getDefaultFontName()}if(c==null){c=new Font(this.font).family}d=new Font({style:e,weight:a,size:"10px",family:c}).toString()}b=new Font({style:e,weight:a,size:f.getFontSize()+"px",family:new Font(d).family}).toString();CoreTools.putToMap(this.fonts,f,b)}return b};PlanComponent.prototype.setFont=function(a){this.font=a};PlanComponent.prototype.getFontMetrics=function(b,c){if(c==null){return new FontMetrics(b)}if(this.fontsMetrics==null){this.fontsMetrics={}}var a=CoreTools.getFromMap(this.fontsMetrics,c);if(a==null){a=this.getFontMetrics(this.getFont(b,c));CoreTools.putToMap(this.fontsMetrics,c,a)}return a};PlanComponent.prototype.setBackgroundPainted=function(a){if(this.backgroundPainted!==a){this.backgroundPainted=a;this.repaint()}};PlanComponent.prototype.isBackgroundPainted=function(){return this.backgroundPainted};PlanComponent.prototype.setSelectedItemsOutlinePainted=function(a){if(this.selectedItemsOutlinePainted!==a){this.selectedItemsOutlinePainted=a;this.repaint()}};PlanComponent.prototype.isSelectedItemsOutlinePainted=function(){return this.selectedItemsOutlinePainted};PlanComponent.prototype.repaint=function(){var a=this;if(!this.canvasNeededRepaint){this.canvasNeededRepaint=true;requestAnimationFrame(function(){if(a.canvasNeededRepaint){a.canvasNeededRepaint=false;a.paintComponent(a.getGraphics())}})}};PlanComponent.prototype.getGraphics=function(){if(!this.graphics){this.graphics=new Graphics2D(this.canvas)}return this.graphics};PlanComponent.prototype.paintComponent=function(b){b.setTransform(new java.awt.geom.AffineTransform());b.clear();if(this.backgroundPainted){this.paintBackground(b,this.getBackgroundColor(PlanComponent.PaintMode.PAINT))}var a=this.getInsets();var d=this.getPlanBounds();var c=this.getScale()*this.resolutionScale;if(this.isScrolled()){b.translate(-this.scrollPane.scrollLeft*this.resolutionScale,-this.scrollPane.scrollTop*this.resolutionScale)}b.translate(a.left*this.resolutionScale+(PlanComponent.MARGIN-d.getMinX())*c,a.top*this.resolutionScale+(PlanComponent.MARGIN-d.getMinY())*c);b.scale(c,c);this.setRenderingHints(b);if(this.drawPlanBounds){b.setColor("#FF0000");b.draw(d)}this.paintContent(b,this.getScale(),PlanComponent.PaintMode.PAINT);b.dispose()};PlanComponent.prototype.getPrintPreferredScale=function(b,a){return 1};PlanComponent.prototype.getStrokeWidth=function(b,a){var c;if(Wall===b||Room===b){c=PlanComponent.WALL_STROKE_WIDTH}else{c=PlanComponent.BORDER_STROKE_WIDTH}if(a===PlanComponent.PaintMode.PRINT){c*=0.5}return c};PlanComponent.prototype.createTransferData=function(a){if(a===TransferableView.DataType.PLAN_IMAGE){return this.getClipboardImage()}else{return null}};PlanComponent.prototype.getClipboardImage=function(){throw new UnsupportedOperationException("Not implemented")};PlanComponent.prototype.isFormatTypeSupported=function(a){return false};PlanComponent.prototype.exportData=function(a,c,b){throw new UnsupportedOperationException("Unsupported format "+c)};PlanComponent.prototype.setRenderingHints=function(a){};PlanComponent.prototype.paintBackground=function(b,a){if(this.isOpaque()){b.setColor(a);b.fillRect(0,0,this.canvas.width,this.canvas.height)}};PlanComponent.prototype.isOpaque=function(){return this.opaque===true};PlanComponent.prototype.setOpaque=function(a){this.opaque=a};PlanComponent.prototype.paintBackgroundImage=function(a,g){var j=this.home.getSelectedLevel();var k=null;if(j!=null){var l=this.home.getLevels();for(var e=l.length-1;e>=0;e--){var c=l[e];if(c.getElevation()===j.getElevation()&&c.getElevationIndex()<=j.getElevationIndex()&&c.isViewable()&&c.getBackgroundImage()!=null&&c.getBackgroundImage().isVisible()){k=c;break}}}var h=k==null?this.home.getBackgroundImage():k.getBackgroundImage();if(h!=null&&h.isVisible()){var d=a.getTransform();a.translate(-h.getXOrigin(),-h.getYOrigin());var b=h.getScale();a.scale(b,b);var f=this.setTransparency(a,0.7);a.drawImage(this.backgroundImageCache!=null?this.backgroundImageCache:this.readBackgroundImage(h.getImage()),0,0);a.setAlpha(f);a.setTransform(d);return true}return false};PlanComponent.prototype.getForegroundColor=function(a){if(a===PlanComponent.PaintMode.PAINT){return this.getForeground()}else{return"#000000"}};PlanComponent.prototype.getForeground=function(){if(this.foreground==null){this.foreground=ColorTools.styleToHexadecimalString(window.getComputedStyle(this.canvas).color)}return this.foreground};PlanComponent.prototype.getBackgroundColor=function(a){if(a===PlanComponent.PaintMode.PAINT){return this.getBackground()}else{return"#FFFFFF"}};PlanComponent.prototype.getBackground=function(){if(this.background==null){this.background=ColorTools.styleToHexadecimalString(window.getComputedStyle(this.canvas).backgroundColor)}return this.background};PlanComponent.prototype.readBackgroundImage=function(b){var a=this;if(this.backgroundImageCache!=PlanComponent.WAIT_TEXTURE_IMAGE&&this.backgroundImageCache!=PlanComponent.ERROR_TEXTURE_IMAGE){this.backgroundImageCache=PlanComponent.WAIT_TEXTURE_IMAGE;TextureManager.getInstance().loadTexture(b,{textureUpdated:function(c){a.backgroundImageCache=c;a.repaint()},textureError:function(){a.backgroundImageCache=PlanComponent.ERROR_TEXTURE_IMAGE;a.repaint()}})}return this.backgroundImageCache};PlanComponent.prototype.paintOtherLevels=function(j,p,e,m){var c=this;var f=this.home.getLevels();var r=this.home.getSelectedLevel();if(f.length&&r!=null){var o=f[0].getElevation()===r.getElevation();var b=null;if(this.otherLevelsRoomsCache==null||this.otherLevelsWallsCache==null){var q=f.indexOf(r);b=[];if(o){var a=q;while(++a<f.length&&f[a].getElevation()===r.getElevation()){}if(a<f.length){var d=f[a];var k=d.getElevation();do{if(d.isViewable()){b.push(d)}}while(++a<f.length&&(d=f[a]).getElevation()===k)}}else{var s=q;while(--s>=0&&f[s].getElevation()===r.getElevation()){}if(s>=0){var t=f[s];var h=t.getElevation();do{if(t.isViewable()){b.push(t)}}while(--s>=0&&(t=f[s]).getElevation()===h)}}if(this.otherLevelsRoomsCache==null){if(b.length!==0){var n=[];this.home.getRooms().forEach(function(u){b.forEach(function(v){if(u.getLevel()===v&&(o&&u.isFloorVisible()||!o&&u.isCeilingVisible())){n.push(u)}})});if(n.length>0){this.otherLevelsRoomAreaCache=this.getItemsArea(n);this.otherLevelsRoomsCache=n}}if(this.otherLevelsRoomsCache==null){this.otherLevelsRoomsCache=[]}}if(this.otherLevelsWallsCache==null){if(b.length!==0){var g=[];this.home.getWalls().forEach(function(u){if(!c.isViewableAtSelectedLevel(u)){b.forEach(function(v){if(u.getLevel()===v){g.push(u)}})}});if(g.length>0){this.otherLevelsWallAreaCache=this.getItemsArea(g);this.otherLevelsWallsCache=g}}}if(this.otherLevelsWallsCache==null){this.otherLevelsWallsCache=[]}}if(this.otherLevelsRoomsCache.length!==0){var l=this.setTransparency(j,this.preferences.isGridVisible()?0.2:0.1);j.setPaint("#808080");j.fill(this.otherLevelsRoomAreaCache);j.setAlpha(l)}if(this.otherLevelsWallsCache.length!==0){var l=this.setTransparency(j,this.preferences.isGridVisible()?0.2:0.1);this.fillAndDrawWallsArea(j,this.otherLevelsWallAreaCache,p,this.getWallPaint(j,p,e,m,this.preferences.getNewWallPattern()),m,PlanComponent.PaintMode.PAINT);j.setAlpha(l)}}};PlanComponent.prototype.setTransparency=function(b,c){var a=b.getAlpha();b.setAlpha(c);return a};PlanComponent.prototype.paintGrid=function(b,g){var e=this.getGridSize(g);var h=this.getMainGridSize(g);var a=this.getPlanBounds();var c=a.getMinX()-PlanComponent.MARGIN;var j=a.getMinY()-PlanComponent.MARGIN;var f=this.convertXPixelToModel(Math.max(this.getWidth(),this.canvas.clientWidth));var d=this.convertYPixelToModel(Math.max(this.getHeight(),this.canvas.clientHeight));this.paintGridLines(b,g,c,f,j,d,e,h)};PlanComponent.prototype.paintGridLines=function(a,h,b,e,k,c,d,j){a.setColor(this.getGridColor());a.setStroke(new java.awt.BasicStroke(0.5/h));for(var g=((b/d)|0)*d;g<e;g+=d){a.draw(new java.awt.geom.Line2D.Double(g,k,g,c))}for(var f=((k/d)|0)*d;f<c;f+=d){a.draw(new java.awt.geom.Line2D.Double(b,f,e,f))}if(j!==d){a.setStroke(new java.awt.BasicStroke(1.5/h,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL));for(var g=((b/j)|0)*j;g<e;g+=j){a.draw(new java.awt.geom.Line2D.Double(g,k,g,c))}for(var f=((k/j)|0)*j;f<c;f+=j){a.draw(new java.awt.geom.Line2D.Double(b,f,e,f))}}};PlanComponent.prototype.getGridColor=function(){if(this.gridColor==null){var a=ColorTools.styleToInteger(window.getComputedStyle(this.canvas).backgroundColor);var b=ColorTools.styleToInteger(window.getComputedStyle(this.canvas).color);var c=((((a&255)+(b&255)+(a&65280)+(b&65280)+(a&16711680)+(b&16711680))/6)|0)&255;this.gridColor=ColorTools.integerToHexadecimalString(c+(c<<8)+(c<<16))}return this.gridColor};PlanComponent.prototype.getMainGridSize=function(b){var e;var a=this.preferences.getLengthUnit();if(a===LengthUnit.INCH||a===LengthUnit.INCH_DECIMALS){var f=2.54*12;e=[f,3*f,6*f,12*f,24*f,48*f,96*f,192*f,384*f]}else{e=[100,200,500,1000,2000,5000,10000]}var c=e[0];for(var d=1;d<e.length&&c*b<50;d++){c=e[d]}return c};PlanComponent.prototype.getGridSize=function(c){var e;var b=this.preferences.getLengthUnit();if(b===LengthUnit.INCH||b===LengthUnit.INCH_DECIMALS){var f=2.54*12;e=[2.54,5.08,7.62,15.24,f,3*f,6*f,12*f,24*f,48*f,96*f,192*f,384*f]}else{e=[1,2,5,10,20,50,100,200,500,1000,2000,5000,10000]}var a=e[0];for(var d=1;d<e.length&&a*c<10;d++){a=e[d]}return a};PlanComponent.prototype.paintContent=function(a,d,g){var m=this.getBackgroundColor(g);var j=this.getForegroundColor(g);if(this.backgroundPainted){this.paintBackgroundImage(a,g);if(g===PlanComponent.PaintMode.PAINT){this.paintOtherLevels(a,d,m,j);if(this.preferences.isGridVisible()){this.paintGrid(a,d)}}}this.paintHomeItems(a,d,m,j,g);if(g===PlanComponent.PaintMode.PAINT){var c=this.home.getSelectedItems();var l=this.getSelectionColor();var e=this.getFurnitureOutlineColor();var n=ColorTools.toRGBAStyle(l,0.5);var b=new java.awt.BasicStroke(6/d,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND);var f=new java.awt.BasicStroke(4/d,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND);var k=new java.awt.BasicStroke(1/d,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.JOIN_BEVEL,0,[20/d,5/d,5/d,5/d],4/d);this.paintCamera(a,c,n,b,l,d,m,j);if(this.alignedObjectClass!=null){if(Wall===this.alignedObjectClass){this.paintWallAlignmentFeedback(a,this.alignedObjectFeedback,this.locationFeeback,this.showPointFeedback,l,k,d,n,b)}else{if(Room===this.alignedObjectClass){this.paintRoomAlignmentFeedback(a,this.alignedObjectFeedback,this.locationFeeback,this.showPointFeedback,l,k,d,n,b)}else{if(Polyline===this.alignedObjectClass){if(this.showPointFeedback){this.paintPointFeedback(a,this.locationFeeback,l,d,n,b)}}else{if(DimensionLine===this.alignedObjectClass){this.paintDimensionLineAlignmentFeedback(a,this.alignedObjectFeedback,this.locationFeeback,this.showPointFeedback,l,k,d,n,b)}}}}}if(this.centerAngleFeedback!=null){this.paintAngleFeedback(a,this.centerAngleFeedback,this.point1AngleFeedback,this.point2AngleFeedback,d,l)}if(this.dimensionLinesFeedback!=null){var h=[];this.paintDimensionLines(a,this.dimensionLinesFeedback,h,null,null,null,k,d,m,l,g,true)}if(this.draggedItemsFeedback!=null){this.paintDimensionLines(a,Home.getDimensionLinesSubList(this.draggedItemsFeedback),this.draggedItemsFeedback,n,f,null,k,d,m,j,g,false);this.paintLabels(a,Home.getLabelsSubList(this.draggedItemsFeedback),this.draggedItemsFeedback,n,f,null,d,j,g);this.paintRoomsOutline(a,this.draggedItemsFeedback,n,b,null,d,j);this.paintWallsOutline(a,this.draggedItemsFeedback,n,b,null,d,j);this.paintFurniture(a,Home.getFurnitureSubList(this.draggedItemsFeedback),c,d,null,j,e,g,false);this.paintFurnitureOutline(a,this.draggedItemsFeedback,n,b,null,d,j)}this.paintRectangleFeedback(a,l,d)}};PlanComponent.prototype.paintHomeItems=function(a,d,l,g,f){var h=this;var c=this.home.getSelectedItems();if(this.sortedLevelFurniture==null){this.sortedLevelFurniture=[];this.home.getFurniture().forEach(function(n){if(h.isViewableAtSelectedLevel(n)){h.sortedLevelFurniture.push(n)}});CoreTools.sortArray(this.sortedLevelFurniture,{compare:function(o,n){return(o.getGroundElevation()-n.getGroundElevation())}})}var k=this.getSelectionColor();var m=ColorTools.toRGBAStyle(k,0.5);var b=new java.awt.BasicStroke(6/d,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND);var e=new java.awt.BasicStroke(4/d,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND);var j=new java.awt.BasicStroke(1/d,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.JOIN_BEVEL,0,[20/d,5/d,5/d,5/d],4/d);this.paintCompass(a,c,d,g,f);this.paintRooms(a,c,d,g,f);this.paintWalls(a,c,d,l,g,f);this.paintFurniture(a,this.sortedLevelFurniture,c,d,l,g,this.getFurnitureOutlineColor(),f,true);this.paintPolylines(a,this.home.getPolylines(),c,m,k,d,g,f);this.paintDimensionLines(a,this.home.getDimensionLines(),c,m,e,k,j,d,l,g,f,false);this.paintRoomsNameAndArea(a,c,d,g,f);this.paintFurnitureName(a,this.sortedLevelFurniture,c,d,g,f);this.paintLabels(a,this.home.getLabels(),c,m,e,k,d,g,f);if(f===PlanComponent.PaintMode.PAINT&&this.selectedItemsOutlinePainted){this.paintCompassOutline(a,c,m,b,k,d,g);this.paintRoomsOutline(a,c,m,b,k,d,g);this.paintWallsOutline(a,c,m,b,k,d,g);this.paintFurnitureOutline(a,c,m,b,k,d,g)}};PlanComponent.prototype.getSelectionColor=function(){return PlanComponent.getDefaultSelectionColor(this)};PlanComponent.getDefaultSelectionColor=function(b){if(PlanComponent.DEFAULT_SELECTION_COLOR==null){var a=window.getComputedStyle(b.container,"::selection").backgroundColor;if(a.indexOf("rgb")===-1||ColorTools.isTransparent(a)||a==window.getComputedStyle(b.container).backgroundColor){b.container.style.color="Highlight";a=window.getComputedStyle(b.container).color}if(a.indexOf("rgb")===-1||ColorTools.isTransparent(a)||a==window.getComputedStyle(b.container).backgroundColor){PlanComponent.DEFAULT_SELECTION_COLOR="#0042E0"}else{PlanComponent.DEFAULT_SELECTION_COLOR=ColorTools.styleToHexadecimalString(a)}}return PlanComponent.DEFAULT_SELECTION_COLOR};PlanComponent.prototype.getFurnitureOutlineColor=function(){return ColorTools.toRGBAStyle(this.getForeground(),0.33)};PlanComponent.prototype.paintRooms=function(p,n,u,s,w){var b=this;if(this.sortedLevelRooms==null){this.sortedLevelRooms=[];this.home.getRooms().forEach(function(B){if(b.isViewableAtSelectedLevel(B)){b.sortedLevelRooms.push(B)}});CoreTools.sortArray(this.sortedLevelRooms,{compare:function(C,B){if(C.isFloorVisible()===B.isFloorVisible()&&C.isCeilingVisible()===B.isCeilingVisible()){return 0}else{if(!B.isFloorVisible()||B.isCeilingVisible()){return 1}else{return -1}}}})}var v=w===PlanComponent.PaintMode.PRINT?"#000000":"#808080";p.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Room,w)/u));for(var t=0;t<this.sortedLevelRooms.length;t++){var x=b.sortedLevelRooms[t];var A=n.indexOf(x)>=0;if(w!==PlanComponent.PaintMode.CLIPBOARD||A){p.setPaint(v);var e=0;var k=1;var h=1;var m=0;var l=0;var c=null;if(b.preferences.isRoomFloorColoredOrTextured()&&x.isFloorVisible()){if(x.getFloorColor()!=null){p.setPaint(ColorTools.integerToHexadecimalString(x.getFloorColor()))}else{c=x.getFloorTexture();if(c!=null){if(b.floorTextureImagesCache==null){b.floorTextureImagesCache={}}var y=b.floorTextureImagesCache[c.getImage().getURL()];if(y==null){y=PlanComponent.WAIT_TEXTURE_IMAGE;b.floorTextureImagesCache[c.getImage().getURL()]=y;var f=w!==PlanComponent.PaintMode.PAINT;TextureManager.getInstance().loadTexture(c.getImage(),f,{floorTexture:c,textureUpdated:function(B){b.floorTextureImagesCache[this.floorTexture.getImage().getURL()]=B;if(!f){b.repaint()}},textureError:function(){b.floorTextureImagesCache[this.floorTexture.getImage().getURL()]=PlanComponent.ERROR_TEXTURE_IMAGE},progression:function(){}})}var a=c.getWidth();var r=c.getHeight();if(a===-1||r===-1){a=100;r=100}var j=c.getScale();k=(a*j)/y.width;h=(r*j)/y.height;e=c.getAngle();var z=Math.cos(e);var d=Math.sin(e);m=(c.getXOffset()*y.width*z-c.getYOffset()*y.height*d);l=(-c.getXOffset()*y.width*d-c.getYOffset()*y.height*z);p.setPaint(p.createPattern(y))}}}var q=b.setTransparency(p,0.75);var o=null;if(c!=null){p.scale(k,h);p.rotate(e,0,0);p.translate(m,l);o=java.awt.geom.AffineTransform.getTranslateInstance(-m,-l);o.rotate(-e,0,0);o.scale(1/k,1/h)}var g=ShapeTools.getShape(x.getPoints(),true,o);b.fillShape(p,g,w);if(c!=null){p.translate(-m,-l);p.rotate(-e,0,0);p.scale(1/k,1/h);g=ShapeTools.getShape(x.getPoints(),true)}p.setAlpha(q);p.setPaint(s);p.draw(g)}}};PlanComponent.prototype.fillShape=function(b,a,c){b.fill(a)};PlanComponent.isTextureManagerAvailable=function(){return true};PlanComponent.prototype.paintRoomsNameAndArea=function(b,g,f,a,e){var d=this;b.setPaint(a);var c=b.getFont();this.sortedLevelRooms.forEach(function(n){var o=(g.indexOf(n)>=0);if(e!==PlanComponent.PaintMode.CLIPBOARD||o){var k=n.getXCenter();var m=n.getYCenter();var h=n.getName();if(h!=null){h=h.trim();if(h.length>0){d.paintText(b,n.constructor,h,n.getNameStyle(),null,k+n.getNameXOffset(),m+n.getNameYOffset(),n.getNameAngle(),c)}}if(n.isAreaVisible()){var l=n.getArea();if(l>0.01){var j=d.preferences.getLengthUnit().getAreaFormatWithUnit().format(l);d.paintText(b,n.constructor,j,n.getAreaStyle(),null,k+n.getAreaXOffset(),m+n.getAreaYOffset(),n.getAreaAngle(),c)}}}});b.setFont(c)};PlanComponent.prototype.paintText=function(k,o,j,r,u,g,f,s,m){var t=k.getTransform();k.translate(g,f);k.rotate(s);if(r==null){r=this.preferences.getDefaultTextStyle(o)}var d=this.getFontMetrics(m,r);var b=j.replace(/\n*$/,"").split("\n");var v=new Array(b.length);var c=-3.4028235e+38;for(var p=0;p<b.length;p++){v[p]=d.getStringBounds(b[p]).getWidth();c=Math.max(v[p],c)}var e=null;var l;if(u!=null){e=new java.awt.BasicStroke(r.getFontSize()*0.05);var a=r.deriveStyle$float(r.getFontSize()-e.getLineWidth());l=this.getFont(m,a);k.setStroke(e)}else{l=this.getFont(m,r)}k.setFont(l);for(var p=b.length-1;p>=0;p--){var h=b[p];var q=void 0;if(r.getAlignment()===TextStyle.Alignment.LEFT){q=0}else{if(r.getAlignment()===TextStyle.Alignment.RIGHT){q=-v[p]}else{q=-v[p]/2}}if(u!=null){q+=e.getLineWidth()/2}k.translate(q,0);if(u!=null){var n=k.getColor();k.setColor(ColorTools.integerToHexadecimalString(u));k.drawStringOutline(h,0,0);k.setColor(n)}k.drawString(h,0,0);k.translate(-q,-d.getHeight())}k.setTransform(t)};PlanComponent.prototype.paintRoomsOutline=function(b,k,n,d,m,h,l){var g=Home.getRoomsSubList(k);var c=b.getTransform();var f=1/h;for(var j=0;j<g.length;j++){var a=g[j];if(this.isViewableAtSelectedLevel(a)){b.setPaint(n);b.setStroke(d);b.draw(ShapeTools.getShape(a.getPoints(),true,null));if(m!=null){b.setPaint(m);a.getPoints().forEach(function(o){b.translate(o[0],o[1]);b.scale(f,f);b.setStroke(PlanComponent.POINT_STROKE);b.fill(PlanComponent.WALL_POINT);b.setTransform(c)})}}}b.setPaint(l);b.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Room,PlanComponent.PaintMode.PAINT)/h));for(var j=0;j<g.length;j++){var a=g[j];if(this.isViewableAtSelectedLevel(a)){b.draw(ShapeTools.getShape(a.getPoints(),true,null))}}if(k.length===1&&g.length===1&&m!=null){var e=g[0];if(this.isViewableAtSelectedLevel(e)){b.setPaint(m);this.paintPointsResizeIndicators(b,e,m,h,true,0,0,true);this.paintRoomNameOffsetIndicator(b,e,m,h);this.paintRoomAreaOffsetIndicator(b,e,m,h)}}};PlanComponent.prototype.paintPointsResizeIndicators=function(j,u,w,q,s,x,b,g){if(this.resizeIndicatorVisible){j.setPaint(w);j.setStroke(PlanComponent.INDICATOR_STROKE);var v=j.getTransform();var a=1/q;var o=u.getPoints();var c=this.getIndicator(u,PlanComponent.IndicatorType.RESIZE);for(var p=0;p<o.length;p++){var n=o[p];j.translate(n[0],n[1]);j.scale(a,a);var k=p===0?o[o.length-1]:o[p-1];var r=p===o.length-1?o[0]:o[p+1];var t=void 0;if(s||(p>0&&p<o.length-1)){var m=java.awt.geom.Point2D.distance(k[0],k[1],n[0],n[1]);var e=(n[1]-k[1])/m;var h=(k[0]-n[0])/m;var l=java.awt.geom.Point2D.distance(r[0],r[1],n[0],n[1]);var d=(r[1]-n[1])/l;var f=(n[0]-r[0])/l;t=Math.atan2(h+f,e+d);if(g&&u.containsPoint(n[0]+Math.cos(t),n[1]+Math.sin(t),0.001)||!g&&(e*f-h*d)<0){t+=Math.PI}}else{if(p===0){t=x}else{t=b}}j.rotate(t);j.draw(c);j.setTransform(v)}}};PlanComponent.prototype.getIndicator=function(b,a){if(PlanComponent.IndicatorType.RESIZE===a){if(b instanceof HomePieceOfFurniture){return PlanComponent.FURNITURE_RESIZE_INDICATOR}else{if(b instanceof Compass){return PlanComponent.COMPASS_RESIZE_INDICATOR}else{return PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR}}}else{if(PlanComponent.IndicatorType.ROTATE===a){if(b instanceof HomePieceOfFurniture){return PlanComponent.FURNITURE_ROTATION_INDICATOR}else{if(b instanceof Compass){return PlanComponent.COMPASS_ROTATION_INDICATOR}else{if(b instanceof Camera){return PlanComponent.CAMERA_YAW_ROTATION_INDICATOR}}}}else{if(PlanComponent.IndicatorType.ELEVATE===a){if(b instanceof Camera){return PlanComponent.CAMERA_ELEVATION_INDICATOR}else{return PlanComponent.ELEVATION_INDICATOR}}else{if(PlanComponent.IndicatorType.RESIZE_HEIGHT===a){if(b instanceof HomePieceOfFurniture){return PlanComponent.FURNITURE_HEIGHT_INDICATOR}}else{if(PlanComponent.IndicatorType.CHANGE_POWER===a){if(b instanceof HomeLight){return PlanComponent.LIGHT_POWER_INDICATOR}}else{if(PlanComponent.IndicatorType.MOVE_TEXT===a){return PlanComponent.TEXT_LOCATION_INDICATOR}else{if(PlanComponent.IndicatorType.ROTATE_TEXT===a){return PlanComponent.TEXT_ANGLE_INDICATOR}else{if(PlanComponent.IndicatorType.ROTATE_PITCH===a){if(b instanceof HomePieceOfFurniture){return PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR}else{if(b instanceof Camera){return PlanComponent.CAMERA_PITCH_ROTATION_INDICATOR}}}else{if(PlanComponent.IndicatorType.ROTATE_ROLL===a){if(b instanceof HomePieceOfFurniture){return PlanComponent.FURNITURE_ROLL_ROTATION_INDICATOR}}else{if(PlanComponent.IndicatorType.ARC_EXTENT===a){if(b instanceof Wall){return PlanComponent.WALL_ARC_EXTENT_INDICATOR}}}}}}}}}}}return null};PlanComponent.prototype.paintRoomNameOffsetIndicator=function(c,f,b,e){if(this.resizeIndicatorVisible&&f.getName()!=null&&f.getName().trim().length>0){var d=f.getXCenter()+f.getNameXOffset();var a=f.getYCenter()+f.getNameYOffset();this.paintTextIndicators(c,f,this.getLineCount(f.getName()),f.getNameStyle(),d,a,f.getNameAngle(),b,e)}};PlanComponent.prototype.paintRoomAreaOffsetIndicator=function(c,f,a,e){if(this.resizeIndicatorVisible&&f.isAreaVisible()&&f.getArea()>0.01){var d=f.getXCenter()+f.getAreaXOffset();var b=f.getYCenter()+f.getAreaYOffset();this.paintTextIndicators(c,f,1,f.getAreaStyle(),d,b,f.getAreaAngle(),a,e)}};PlanComponent.prototype.paintTextIndicators=function(b,m,l,c,k,h,e,j,g){if(this.resizeIndicatorVisible){b.setPaint(j);b.setStroke(PlanComponent.INDICATOR_STROKE);var d=b.getTransform();var f=1/g;b.translate(k,h);b.rotate(e);b.scale(f,f);if(m instanceof Label){b.draw(PlanComponent.LABEL_CENTER_INDICATOR)}else{b.draw(this.getIndicator(null,PlanComponent.IndicatorType.MOVE_TEXT))}if(c==null){c=this.preferences.getDefaultTextStyle(m)}var a=this.getFontMetrics(b.getFont(),c);b.setTransform(d);b.translate(k,h);b.rotate(e);b.translate(0,-a.getHeight()*(l-1)-a.getAscent()*(m instanceof Label?1:0.85));b.scale(f,f);b.draw(this.getIndicator(null,PlanComponent.IndicatorType.ROTATE_TEXT));b.setTransform(d)}};PlanComponent.prototype.getLineCount=function(c){var a=1;var b=c.length-1;while(b>=0&&c.charAt(b)=="\n"){b--}for(;b>=0;b--){if(c.charAt(b)=="\n"){a++}}return a};PlanComponent.prototype.paintWalls=function(a,e,f,n,m,k){var c;var l;if(k!==PlanComponent.PaintMode.CLIPBOARD){l=this.getWallAreas()}else{c=Home.getWallsSubList(e);l=this.getWallAreas(this.getDrawableWallsInSelectedLevel(c))}var j=k===PlanComponent.PaintMode.PRINT?f/72*150:f;var b=null;if(k===PlanComponent.PaintMode.PAINT&&this.backgroundPainted&&this.backgroundImageCache!=null&&this.wallsDoorsOrWindowsModification){b=this.setTransparency(a,0.5)}var o=l.entries==null?[]:l.entries;for(var g=0;g<o.length;g++){var h=o[g];var d=h.getKey()[0].getPattern();this.fillAndDrawWallsArea(a,h.getValue(),f,this.getWallPaint(a,j,n,m,d!=null?d:this.preferences.getWallPattern()),m,k)}if(b!=null){a.setAlpha(b)}};PlanComponent.prototype.fillAndDrawWallsArea=function(b,d,g,c,e,f){b.setPaint(c);var a=1/g;b.scale(a,a);var h=d.clone();h.transform(java.awt.geom.AffineTransform.getScaleInstance(1/a,1/a));this.fillShape(b,h,f);b.scale(1/a,1/a);b.setPaint(e);b.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Wall,f)/g));b.draw(d)};PlanComponent.prototype.paintWallsOutline=function(l,n,m,h,w,t,q){var a=1/t;var x=Home.getWallsSubList(n);var v=l.getTransform();for(var s=0;s<x.length;s++){var u=x[s];if(this.isViewableAtSelectedLevel(u)){l.setPaint(m);l.setStroke(h);l.draw(ShapeTools.getShape(u.getPoints(),true,null));if(w!=null){l.translate(u.getXStart(),u.getYStart());l.scale(a,a);l.setPaint(w);l.setStroke(PlanComponent.POINT_STROKE);l.fill(PlanComponent.WALL_POINT);var r=u.getArcExtent();var b=void 0;var f=void 0;var d=0;var k=0;var p=0;var c=u.getStartPointToEndPointDistance();var j=Math.atan2(u.getYEnd()-u.getYStart(),u.getXEnd()-u.getXStart());if(r!=null&&r!==0){d=u.getXArcCircleCenter();k=u.getYArcCircleCenter();p=java.awt.geom.Point2D.distance(u.getXStart(),u.getYStart(),d,k);f=p*Math.abs(r)*t;b=Math.atan2(k-u.getYStart(),d-u.getXStart())+(r>0?-Math.PI/2:Math.PI/2)}else{f=c*t;b=j}if(f<30){l.rotate(j);if(r!=null){var o=Math.abs(r)>Math.PI?-(Math.PI+r)/2:(Math.PI-r)/2;var g=(Math.tan(o)*c/2);l.translate(c*t/2,(g-p*(Math.abs(j)>Math.PI/2?-1:1))*t)}else{l.translate(f/2,0)}}else{l.rotate(b);l.translate(8,0)}l.draw(PlanComponent.WALL_ORIENTATION_INDICATOR);l.setTransform(v);l.translate(u.getXEnd(),u.getYEnd());l.scale(a,a);l.fill(PlanComponent.WALL_POINT);if(f>=30){if(r!=null){b+=r}l.rotate(b);l.translate(-10,0);l.draw(PlanComponent.WALL_ORIENTATION_INDICATOR)}l.setTransform(v)}}}l.setPaint(q);l.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Wall,PlanComponent.PaintMode.PAINT)/t));var e=CoreTools.valuesFromMap(this.getWallAreas(this.getDrawableWallsInSelectedLevel(x)));for(var s=0;s<e.length;s++){l.draw(e[s])}if(n.length===1&&x.length===1&&w!=null){var u=x[0];if(this.isViewableAtSelectedLevel(u)){this.paintWallResizeIndicators(l,u,w,t)}}};PlanComponent.prototype.isViewableAtSelectedLevel=function(a){var b=a.getLevel();return b==null||(b.isViewable()&&a.isAtLevel(this.home.getSelectedLevel()))};PlanComponent.prototype.paintWallResizeIndicators=function(a,j,h,f){if(this.resizeIndicatorVisible){a.setPaint(h);a.setStroke(PlanComponent.INDICATOR_STROKE);var b=a.getTransform();var e=1/f;var l=j.getPoints();var d=(l.length/4|0);var k=Math.atan2(j.getYEnd()-j.getYStart(),j.getXEnd()-j.getXStart());if(l.length%4===0){a.translate((l[d-1][0]+l[d][0])/2,(l[d-1][1]+l[d][1])/2)}else{a.translate(l[d][0],l[d][1])}a.scale(e,e);a.rotate(k+Math.PI);a.draw(this.getIndicator(j,PlanComponent.IndicatorType.ARC_EXTENT));a.setTransform(b);var c=j.getArcExtent();var g=void 0;if(c!=null&&c!==0){g=Math.atan2(j.getYArcCircleCenter()-j.getYEnd(),j.getXArcCircleCenter()-j.getXEnd())+(c>0?-Math.PI/2:Math.PI/2)}else{g=k}a.translate(j.getXEnd(),j.getYEnd());a.scale(e,e);a.rotate(g);a.draw(this.getIndicator(j,PlanComponent.IndicatorType.RESIZE));a.setTransform(b);if(c!=null){g+=Math.PI-c}else{g+=Math.PI}a.translate(j.getXStart(),j.getYStart());a.scale(e,e);a.rotate(g);a.draw(this.getIndicator(j,PlanComponent.IndicatorType.RESIZE));a.setTransform(b)}};PlanComponent.prototype.getDrawableWallsInSelectedLevel=function(c){var b=[];for(var d=0;d<c.length;d++){var a=c[d];if(this.isViewableAtSelectedLevel(a)){b.push(a)}}return b};PlanComponent.prototype.getWallAreas=function(c){var h=this;if(c===undefined){if(this.wallAreasCache==null){return this.wallAreasCache=this.getWallAreas(this.getDrawableWallsInSelectedLevel(this.home.getWalls()))}else{return this.wallAreasCache}}else{if(c.length===0){return{}}var f=c[0].getPattern();var b=true;for(var d=0;d<c.length;d++){if(f!==c[d].getPattern()){b=false;break}}var a={};if(b){CoreTools.putToMap(a,c,this.getItemsArea(c))}else{var g={};c.forEach(function(j){var k=j.getPattern();if(k==null){k=h.preferences.getWallPattern()}var l=CoreTools.getFromMap(g,k);if(l==null){l=[];CoreTools.putToMap(g,k,l)}l.push(j)});var c=CoreTools.valuesFromMap(g);for(var d=0;d<c.length;d++){var e=c[d];CoreTools.putToMap(a,e,this.getItemsArea(e))}}return a}};PlanComponent.prototype.getItemsArea=function(a){var b=new java.awt.geom.Area();a.forEach(function(c){b.add(new java.awt.geom.Area(ShapeTools.getShape(c.getPoints(),true,null)))});return b};PlanComponent.prototype.makePatternImage=function(e,j,l){var d=document.createElement("canvas");d.width=e.width;d.height=e.height;var c=d.getContext("2d");c.fillStyle="#FFFFFF";c.fillRect(0,0,d.width,d.height);c.drawImage(e,0,0);var a=c.getImageData(0,0,e.width,e.height).data;var k=ColorTools.hexadecimalStringToInteger(l);var b=ColorTools.hexadecimalStringToInteger(j);var g=c.createImageData(e.width,e.height);for(var f=0;f<a.length;f+=4){g.data[f+3]=255;if(a[f]===255&&a[f+1]===255&&a[f+2]===255){g.data[f]=(k&16711680)>>16;g.data[f+1]=(k&65280)>>8;g.data[f+2]=k&255}else{if(a[f]===0&&a[f+1]===0&&a[f+2]===0){g.data[f]=(b&16711680)>>16;g.data[f+1]=(b&65280)>>8;g.data[f+2]=b&255}else{var h=1-(a[f]+a[f+1]+a[f+2])/3/255;g.data[f]=Math.min(255,((b&16711680)>>16)*h+((k&16711680)>>16)*(1-h));g.data[f+1]=Math.min(255,((b&65280)>>8)*h+((k&65280)>>8)*(1-h));g.data[f+2]=Math.min(255,(b&255)*h+(k&255)*(1-h))}}}c.putImageData(g,0,0);e.src=d.toDataURL();return e};PlanComponent.prototype.getWallPaint=function(d,f,c,b,a){var e=this;var g=this.patternImagesCache[a.getImage().getURL()];if(g==null||c!=this.wallsPatternBackgroundCache||b!=this.wallsPatternForegroundCache){g=TextureManager.getInstance().getWaitImage();this.patternImagesCache[a.getImage().getURL()]=g;TextureManager.getInstance().loadTexture(a.getImage(),false,{textureUpdated:function(h){e.patternImagesCache[a.getImage().getURL()]=e.makePatternImage(h,e.getForeground(),e.getBackground());e.repaint()},textureError:function(){e.patternImagesCache[a.getImage().getURL()]=PlanComponent.ERROR_TEXTURE_IMAGE},progression:function(){}});this.wallsPatternBackgroundCache=c;this.wallsPatternForegroundCache=b}return d.createPattern(g)};PlanComponent.prototype.paintFurniture=function(l,m,k,t,h,q,g,u,e){if(!(m.length==0)){var p=new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,u)/t);var c=null;for(var s=0;s<m.length;s++){var d=m[s];if(d.isVisible()){var a=(k.indexOf((d))>=0);if(d instanceof HomeFurnitureGroup){var j=(d).getFurniture();var r=[];this.paintFurniture(l,j,a?j:r,t,h,q,g,u,e)}else{if(u!==PlanComponent.PaintMode.CLIPBOARD||a){var b=ShapeTools.getShape(d.getPoints(),true,null);var n=void 0;if(d instanceof HomeDoorOrWindow){var o=d;n=this.getDoorOrWindowWallPartShape(o);if(this.draggedItemsFeedback==null||!(this.draggedItemsFeedback.indexOf((d))>=0)){this.paintDoorOrWindowWallThicknessArea(l,o,t,h,q,u)}this.paintDoorOrWindowSashes(l,o,t,q,u)}else{n=b}var f=void 0;if(this.preferences.isFurnitureViewedFromTop()){if(d.getPlanIcon()!=null||(d instanceof HomeDoorOrWindow)){f=true}else{c=PlanComponent.WEBGL_AVAILABLE;f=c}}else{f=false}if(e&&f){if(d instanceof HomeDoorOrWindow){l.setPaint(h);l.fill(n);l.setPaint(q);l.setStroke(p);l.draw(n)}else{this.paintPieceOfFurnitureTop(l,d,n,p,t,h,q,u)}if(u===PlanComponent.PaintMode.PAINT){l.setStroke(p);l.setPaint(g);l.draw(b)}}else{if(e){this.paintPieceOfFurnitureIcon(l,d,null,n,t,h,u)}l.setPaint(q);l.setStroke(p);l.draw(n);if((d instanceof HomeDoorOrWindow)&&u===PlanComponent.PaintMode.PAINT){l.setPaint(g);l.draw(b)}}}}}}}};PlanComponent.prototype.getDoorOrWindowWallPartShape=function(a){var e=this.getDoorOrWindowRectangle(a,true);var b=java.awt.geom.AffineTransform.getRotateInstance(a.getAngle(),a.getX(),a.getY());var c=e.getPathIterator(b);var d=new java.awt.geom.GeneralPath();d.append(c,false);return d};PlanComponent.prototype.getDoorOrWindowRectangle=function(l,f){var d=l.getDepth()*(f?l.getWallThickness():1);var k=l.getDepth()*(f?l.getWallDistance():0);var e=l.getCutOutShape();var b=l.getWidth();var h=l.getWallWidth()*b;var j=l.getX()-b/2;j+=l.isModelMirrored()?(1-l.getWallLeft()-l.getWallWidth())*b:l.getWallLeft()*b;if(e!=null&&PieceOfFurniture.DEFAULT_CUT_OUT_SHAPE!=e){var g=ShapeTools.getShape(e);var a=g.getBounds2D();if(l.isModelMirrored()){j+=(1-a.getX()-a.getWidth())*h}else{j+=a.getX()*h}h*=a.getWidth()}var c=new java.awt.geom.Rectangle2D.Float(j,l.getY()-l.getDepth()/2+k,h,d);return c};PlanComponent.prototype.paintDoorOrWindowWallThicknessArea=function(j,l,p,d,m,s){if(l.isWallCutOutOnBothSides()){var h=null;if(this.doorOrWindowWallThicknessAreasCache!=null){h=CoreTools.getFromMap(this.doorOrWindowWallThicknessAreasCache,l)}if(h==null){var c=this.getDoorOrWindowRectangle(l,false);var n=java.awt.geom.AffineTransform.getRotateInstance(l.getAngle(),l.getX(),l.getY());var e=c.getPathIterator(n);var g=new java.awt.geom.GeneralPath();g.append(e,false);var b=new java.awt.geom.Area(g);h=new java.awt.geom.Area();var t=this.home.getWalls();for(var o=0;o<t.length;o++){var r=t[o];if(r.isAtLevel(l.getLevel())&&l.isParallelToWall(r)){var q=ShapeTools.getShape(r.getPoints(),true,null);var a=new java.awt.geom.Area(q);a.intersect(b);if(!a.isEmpty()){var f=new java.awt.geom.Rectangle2D.Float(c.getX(),c.getY()-2*r.getThickness(),c.getWidth(),c.getWidth()+4*r.getThickness());e=f.getPathIterator(n);var k=new java.awt.geom.GeneralPath();k.append(e,false);a=new java.awt.geom.Area(q);a.intersect(new java.awt.geom.Area(k));h.add(a)}}}}if(this.doorOrWindowWallThicknessAreasCache==null){this.doorOrWindowWallThicknessAreasCache={}}CoreTools.putToMap(this.doorOrWindowWallThicknessAreasCache,l,h);j.setPaint(d);j.fill(h);j.setPaint(m);j.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,s)/p));j.draw(h)}};PlanComponent.prototype.paintDoorOrWindowSashes=function(e,b,h,a,g){var f=new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,g)/h);e.setPaint(a);e.setStroke(f);var c=b.getSashes();for(var d=0;d<c.length;d++){e.draw(this.getDoorOrWindowSashShape(b,c[d]))}};PlanComponent.prototype.getDoorOrWindowSashShape=function(l,g){var h=l.isModelMirrored()?-1:1;var c=h*g.getXAxis()*l.getWidth();var a=g.getYAxis()*l.getDepth();var f=g.getWidth()*l.getWidth();var j=g.getStartAngle()*180/Math.PI;if(l.isModelMirrored()){j=180-j}var d=h*((g.getEndAngle()-g.getStartAngle())*180/Math.PI);var b=new java.awt.geom.Arc2D.Float(c-f,a-f,2*f,2*f,j,d,java.awt.geom.Arc2D.PIE);var k=java.awt.geom.AffineTransform.getTranslateInstance(l.getX(),l.getY());k.rotate(l.getAngle());k.translate(h*-l.getWidth()/2,-l.getDepth()/2);var e=b.getPathIterator(k);var m=new java.awt.geom.GeneralPath();m.append(e,false);return m};PlanComponent.prototype.paintFurnitureName=function(a,h,d,e,j,g){var k=a.getFont();a.setPaint(j);for(var f=0;f<h.length;f++){var n=h[f];if(n.isVisible()){var l=(d.indexOf((n))>=0);if(n instanceof HomeFurnitureGroup){var c=(n).getFurniture();var m=[];this.paintFurnitureName(a,c,l?c:m,e,j,g)}if(n.isNameVisible()&&(g!==PlanComponent.PaintMode.CLIPBOARD||l)){var b=n.getName().trim();if(b.length>0){this.paintText(a,n.constructor,b,n.getNameStyle(),null,n.getX()+n.getNameXOffset(),n.getY()+n.getNameYOffset(),n.getNameAngle(),k)}}}}a.setFont(k)};PlanComponent.prototype.paintFurnitureOutline=function(k,p,n,j,v,t,r){var a=this;var q=new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,PlanComponent.PaintMode.PAINT)/t);var e=new java.awt.BasicStroke(4*this.getStrokeWidth(HomePieceOfFurniture,PlanComponent.PaintMode.PAINT)/t,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_MITER);var l=Home.getFurnitureSubList(p);var o=[];var y=null;var f=new java.awt.BasicStroke(15/t,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.JOIN_ROUND);var u=null;var w=null;var h=this.home.getFurniture();for(var s=0;s<l.length;s++){var c=l[s];if(c.isVisible()&&this.isViewableAtSelectedLevel(c)){var b=this.getPieceOfFurnitureInHomeFurniture(c,h);if(b!==c){var g=null;if(u!==b){var x=ShapeTools.getShape(b.getPoints(),true,null);g=new java.awt.geom.Area(x);g.add(new java.awt.geom.Area(f.createStrokedShape(x)))}var d=new java.awt.geom.Area(ShapeTools.getShape(c.getPoints(),true,null));if(y==null){y=g;w=d}else{if(u!==b){y.add(g)}w.add(d)}u=b}o.push(c)}}if(y!=null){y.subtract(w);var m=this.setTransparency(k,0.6);k.setPaint(n);k.fill(y);k.setAlpha(m)}o.forEach(function(B){var A=B.getPoints();var z=ShapeTools.getShape(A,true,null);k.setPaint(n);k.setStroke(j);k.draw(z);k.setPaint(r);k.setStroke(q);k.draw(z);k.setStroke(e);k.draw(new java.awt.geom.Line2D.Float(A[2][0],A[2][1],A[3][0],A[3][1]));if(p.length===1&&v!=null){a.paintPieceOfFurnitureIndicators(k,B,v,t)}})};PlanComponent.prototype.getPieceOfFurnitureInHomeFurniture=function(c,a){if(!(a.indexOf((c))>=0)){for(var b=0;b<a.length;b++){var d=a[b];if((d instanceof HomeFurnitureGroup)&&((d).getAllFurniture().indexOf((c))>=0)){return d}}}return c};PlanComponent.prototype.paintPieceOfFurnitureIcon=function(b,n,j,m,f,k){var h=this;if(j==null){if(this.furnitureIconsCache==null){this.furnitureIconsCache={}}var e=this.furnitureIconsCache[n.icon.getURL()];if(e==null){e=TextureManager.getInstance().getWaitImage();TextureManager.getInstance().loadTexture(n.icon,{textureUpdated:function(o){h.furnitureIconsCache[n.icon.getURL()]=o;h.repaint()},textureError:function(){h.furnitureIconsCache[n.icon.getURL()]=TextureManager.getInstance().getErrorImage();h.repaint()}})}j=new PlanComponent.PieceOfFurnitureTopViewIcon(e)}b.setPaint(k);b.fill(m);var c=b.getTransform();var a=m.getBounds2D();b.translate(a.getCenterX(),a.getCenterY());var d=n.getDepthInPlan();if(n instanceof HomeDoorOrWindow){d*=n.getWallThickness()}var l=Math.min(n.getWidthInPlan(),d);var g=Math.min(1/f,l/j.getIconHeight());if(n.isModelMirrored()){b.scale(-g,g)}else{b.scale(g,g)}j.paintIcon(b,-j.getIconWidth()/2,-j.getIconHeight()/2);b.setTransform(c)};PlanComponent.prototype.paintPieceOfFurnitureTop=function(b,q,p,f,h,n,l,k){if(this.furnitureTopViewIconKeys==null){this.furnitureTopViewIconKeys={};this.furnitureTopViewIconsCache={}}var g=CoreTools.getFromMap(this.furnitureTopViewIconKeys,q);var m;if(g==null){g=new PlanComponent.HomePieceOfFurnitureTopViewIconKey(q.clone());m=CoreTools.getFromMap(this.furnitureTopViewIconsCache,g);if(m==null||m.isWaitIcon()&&k!==PlanComponent.PaintMode.PAINT){var e=k===PlanComponent.PaintMode.PAINT?this:null;if(q.getPlanIcon()!=null){m=new PlanComponent.PieceOfFurniturePlanIcon(q,e)}else{m=new PlanComponent.PieceOfFurnitureModelIcon(q,this.object3dFactory,e,this.preferences.getFurnitureModelIconSize())}CoreTools.putToMap(this.furnitureTopViewIconsCache,g,m)}else{for(var j=0;j<this.furnitureTopViewIconsCache.entries.length;j++){var o=this.furnitureTopViewIconsCache.entries[j].key;if(o.equals(g)){g=o;break}}}CoreTools.putToMap(this.furnitureTopViewIconKeys,q,g)}else{m=CoreTools.getFromMap(this.furnitureTopViewIconsCache,g)}if(m.isWaitIcon()||m.isErrorIcon()){this.paintPieceOfFurnitureIcon(b,q,m,p,h,n);b.setPaint(l);b.setStroke(f);b.draw(p)}else{var c=b.getTransform();var a=p.getBounds2D();b.translate(a.getCenterX(),a.getCenterY());b.rotate(q.getAngle());var d=q.getDepthInPlan();if(q.isModelMirrored()&&q.getRoll()==0){b.scale(-q.getWidthInPlan()/m.getIconWidth(),d/m.getIconHeight())}else{b.scale(q.getWidthInPlan()/m.getIconWidth(),d/m.getIconHeight())}m.paintIcon(b,(-m.getIconWidth()/2|0),(-m.getIconHeight()/2|0));b.setTransform(c)}};PlanComponent.prototype.paintPieceOfFurnitureIndicators=function(a,r,n,j){if(this.resizeIndicatorVisible){a.setPaint(n);a.setStroke(PlanComponent.INDICATOR_STROKE);var d=a.getTransform();var k=r.getPoints();var h=1/j;var b=r.getAngle();var g=this.getIndicator(r,PlanComponent.IndicatorType.ROTATE);if(g!=null){a.translate(k[0][0],k[0][1]);a.scale(h,h);a.rotate(b);a.draw(g);a.setTransform(d)}var e=this.getIndicator(r,PlanComponent.IndicatorType.ELEVATE);if(e!=null){a.translate(k[1][0],k[1][1]);a.scale(h,h);a.rotate(b);a.draw(PlanComponent.ELEVATION_POINT_INDICATOR);a.translate(6.5,-6.5);a.rotate(-b);a.draw(e);a.setTransform(d)}a.translate(k[3][0],k[3][1]);a.scale(h,h);a.rotate(b);if(r.getPitch()!==0&&this.isFurnitureSizeInPlanSupported()){var m=this.getIndicator(r,PlanComponent.IndicatorType.ROTATE_PITCH);if(m!=null){a.draw(m)}}else{if(r.getRoll()!==0&&this.isFurnitureSizeInPlanSupported()){var o=this.getIndicator(r,PlanComponent.IndicatorType.ROTATE_ROLL);if(o!=null){a.draw(o)}}else{if(r instanceof HomeLight){var l=this.getIndicator(r,PlanComponent.IndicatorType.CHANGE_POWER);if(l!=null){a.draw(PlanComponent.LIGHT_POWER_POINT_INDICATOR);a.translate(-7.5,7.5);a.rotate(-b);a.draw(l)}}else{if(r.isResizable()&&!r.isHorizontallyRotated()){var f=this.getIndicator(r,PlanComponent.IndicatorType.RESIZE_HEIGHT);if(f!=null){a.draw(PlanComponent.FURNITURE_HEIGHT_POINT_INDICATOR);a.translate(-7.5,7.5);a.rotate(-b);a.draw(f)}}}}}a.setTransform(d);if(r.isResizable()){var c=this.getIndicator(r,PlanComponent.IndicatorType.RESIZE);if(c!=null){a.translate(k[2][0],k[2][1]);a.scale(h,h);a.rotate(b);a.draw(c);a.setTransform(d)}}if(r.isNameVisible()&&r.getName().trim().length>0){var q=r.getX()+r.getNameXOffset();var p=r.getY()+r.getNameYOffset();this.paintTextIndicators(a,r,this.getLineCount(r.getName()),r.getNameStyle(),q,p,r.getNameAngle(),n,j)}}};PlanComponent.prototype.paintPolylines=function(o,j,l,p,x,u,s,v){for(var t=0;t<j.length;t++){var q=j[t];if(this.isViewableAtSelectedLevel(q)){var r=(l.indexOf((q))>=0);if(v!==PlanComponent.PaintMode.CLIPBOARD||r){o.setPaint(ColorTools.integerToHexadecimalString(q.getColor()));var d=q.getThickness();o.setStroke(ShapeTools.getStroke(d,q.getCapStyle(),q.getJoinStyle(),q.getDashStyle()!==Polyline.DashStyle.SOLID?q.getDashPattern():null,q.getDashOffset()));var f=ShapeTools.getPolylineShape(q.getPoints(),q.getJoinStyle()===Polyline.JoinStyle.CURVED,q.isClosedPath());o.draw(f);var n=null;var m=null;var c=null;var g=null;for(var k=f.getPathIterator(null,0.5);!k.isDone();k.next()){var b=[0,0];if(k.currentSegment(b)!==java.awt.geom.PathIterator.SEG_CLOSE){if(n==null){n=b}else{if(m==null){m=b}}c=g;g=b}}var w=Math.atan2(n[1]-m[1],n[0]-m[0]);var h=Math.atan2(g[1]-c[1],g[0]-c[0]);var e=q.getCapStyle()!==Polyline.CapStyle.BUTT?d/2:0;this.paintArrow(o,n,w,q.getStartArrowStyle(),d,e);this.paintArrow(o,g,h,q.getEndArrowStyle(),d,e);if(r&&v===PlanComponent.PaintMode.PAINT){o.setPaint(p);o.setStroke(ShapeTools.getStroke(d+4/u,q.getCapStyle(),q.getJoinStyle(),null));o.draw(f);if(l.length===1&&x!=null){var a=l[0];if(this.isViewableAtSelectedLevel(a)){o.setPaint(x);this.paintPointsResizeIndicators(o,a,x,u,a.isClosedPath(),w,h,false)}}}}}}};PlanComponent.prototype.paintArrow=function(d,a,g,b,c,e){if(b!=null&&b!==Polyline.ArrowStyle.NONE){var h=d.getTransform();d.translate(a[0],a[1]);d.rotate(g);d.translate(e,0);var f=Math.pow(c,0.66)*2;d.scale(f,f);switch((b)){case Polyline.ArrowStyle.DISC:d.fill(new java.awt.geom.Ellipse2D.Float(-3.5,-2,4,4));break;case Polyline.ArrowStyle.OPEN:d.scale(0.9,0.9);d.setStroke(new java.awt.BasicStroke((c/f/0.9),java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_MITER));d.draw(PlanComponent.ARROW);break;case Polyline.ArrowStyle.DELTA:d.translate(1.65,0);d.fill(PlanComponent.ARROW);break;default:break}d.setTransform(h)}};PlanComponent.prototype.paintDimensionLines=function(a,f,d,o,c,m,p,e,n,h,g,b){var l=this;if(g===PlanComponent.PaintMode.CLIPBOARD){f=Home.getDimensionLinesSubList(d)}a.setPaint(h);a.setColor(h);var k=new java.awt.BasicStroke(this.getStrokeWidth(DimensionLine,g)/e);var j=a.getFont();f.forEach(function(w){if(l.isViewableAtSelectedLevel(w)){var r=a.getTransform();var t=Math.atan2(w.getYEnd()-w.getYStart(),w.getXEnd()-w.getXStart());var z=w.getLength();a.translate(w.getXStart(),w.getYStart());a.rotate(t);a.translate(0,w.getOffset());if(g===PlanComponent.PaintMode.PAINT&&l.selectedItemsOutlinePainted&&(d.indexOf((w))>=0)){a.setPaint(o);a.setStroke(c);a.draw(new java.awt.geom.Line2D.Float(0,0,z,0));a.draw(PlanComponent.DIMENSION_LINE_END);a.translate(z,0);a.draw(PlanComponent.DIMENSION_LINE_END);a.translate(-z,0);a.draw(new java.awt.geom.Line2D.Float(0,-w.getOffset(),0,-5));a.draw(new java.awt.geom.Line2D.Float(z,-w.getOffset(),z,-5));a.setPaint(h)}a.setStroke(k);a.draw(new java.awt.geom.Line2D.Float(0,0,z,0));a.draw(PlanComponent.DIMENSION_LINE_END);a.translate(z,0);a.draw(PlanComponent.DIMENSION_LINE_END);a.translate(-z,0);a.setStroke(p);a.draw(new java.awt.geom.Line2D.Float(0,-w.getOffset(),0,-5));a.draw(new java.awt.geom.Line2D.Float(z,-w.getOffset(),z,-5));var A=l.preferences.getLengthUnit().getFormat().format(z);var y=w.getLengthStyle();if(y==null){y=l.preferences.getDefaultTextStyle(w.constructor)}if(b&&l.getFont()!=null){y=y.deriveStyle$float(parseInt(new Font(l.getFont()).size)/e)}var s=l.getFont(j,y);var u=l.getFontMetrics(s,y);var v=u.getStringBounds(A,a);var x=u.getAscent();a.translate((z-v.getWidth())/2,w.getOffset()<=0?-u.getDescent()-1:x+1);a.setFont(s);if(b){a.setColor(n);var q=l.setTransparency(a,0.7);a.setStroke(new java.awt.BasicStroke(4/e,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.CAP_ROUND));a.drawStringOutline(A,0,0);a.setAlpha(q);a.setColor(h)}a.drawString(A,0,0);a.setTransform(r)}});a.setFont(j);if(d.length===1&&(d[0] instanceof DimensionLine)&&g===PlanComponent.PaintMode.PAINT&&m!=null){this.paintDimensionLineResizeIndicator(a,d[0],m,e)}};PlanComponent.prototype.paintDimensionLineResizeIndicator=function(c,a,b,f){if(this.resizeIndicatorVisible){c.setPaint(b);c.setStroke(PlanComponent.INDICATOR_STROKE);var e=Math.atan2(a.getYEnd()-a.getYStart(),a.getXEnd()-a.getXStart());var g=c.getTransform();var h=1/f;c.translate(a.getXStart(),a.getYStart());c.rotate(e);c.translate(0,a.getOffset());c.rotate(Math.PI);c.scale(h,h);var d=this.getIndicator(a,PlanComponent.IndicatorType.RESIZE);c.draw(d);c.setTransform(g);c.translate(a.getXEnd(),a.getYEnd());c.rotate(e);c.translate(0,a.getOffset());c.scale(h,h);c.draw(d);c.setTransform(g);c.translate((a.getXStart()+a.getXEnd())/2,(a.getYStart()+a.getYEnd())/2);c.rotate(e);c.translate(0,a.getOffset());c.rotate(a.getOffset()<=0?Math.PI/2:-Math.PI/2);c.scale(h,h);c.draw(d);c.setTransform(g)}};PlanComponent.prototype.paintLabels=function(m,w,h,n,j,x,t,p,u){var k=m.getFont();for(var s=0;s<w.length;s++){var f=w[s];if(this.isViewableAtSelectedLevel(f)){var d=(h.indexOf((f))>=0);if(u!==PlanComponent.PaintMode.CLIPBOARD||d){var e=f.getText();var g=f.getX();var l=f.getY();var b=f.getAngle();var a=f.getStyle();if(a==null){a=this.preferences.getDefaultTextStyle(f.constructor)}if(a.getFontName()==null&&this.getFont()!=null){a=a.deriveStyle(new Font(this.getFont()).family)}var q=f.getColor();m.setPaint(q!=null?ColorTools.integerToHexadecimalString(q):p);this.paintText(m,f.constructor,e,a,f.getOutlineColor(),g,l,b,k);if(u===PlanComponent.PaintMode.PAINT&&this.selectedItemsOutlinePainted&&d){m.setPaint(n);m.setStroke(j);var r=this.getTextBounds(e,a,g,l,b);m.draw(ShapeTools.getShape(r,true,null));m.setPaint(p);if(x!=null&&h.length===1&&h[0]===f){this.paintTextIndicators(m,f,this.getLineCount(e),a,g,l,b,x,t);if(this.resizeIndicatorVisible&&f.getPitch()!=null){var o=this.getIndicator(f,PlanComponent.IndicatorType.ELEVATE);if(o!=null){var v=m.getTransform();if(a.getAlignment()===TextStyle.Alignment.LEFT){m.translate(r[3][0],r[3][1])}else{if(a.getAlignment()===TextStyle.Alignment.RIGHT){m.translate(r[2][0],r[2][1])}else{m.translate((r[2][0]+r[3][0])/2,(r[2][1]+r[3][1])/2)}}var c=1/t;m.scale(c,c);m.rotate(f.getAngle());m.draw(PlanComponent.ELEVATION_POINT_INDICATOR);m.translate(0,10);m.rotate(-f.getAngle());m.draw(o);m.setTransform(v)}}}}}}}m.setFont(k)};PlanComponent.prototype.paintCompass=function(b,h,f,a,e){var d=this.home.getCompass();if(d.isVisible()&&(e!==PlanComponent.PaintMode.CLIPBOARD||h.indexOf(d)>=0)){var g=b.getTransform();b.translate(d.getX(),d.getY());b.rotate(d.getNorthDirection());var c=d.getDiameter();b.scale(c,c);b.setColor(a);b.fill(PlanComponent.COMPASS);b.setTransform(g)}};PlanComponent.prototype.paintCompassOutline=function(a,f,k,d,h,e,g){var c=this.home.getCompass();if((f.indexOf(c)>=0)&&c.isVisible()){var b=a.getTransform();a.translate(c.getX(),c.getY());a.rotate(c.getNorthDirection());var j=c.getDiameter();a.scale(j,j);a.setPaint(k);a.setStroke(new java.awt.BasicStroke((5.5+e)/j/e));a.draw(PlanComponent.COMPASS_DISC);a.setColor(g);a.setStroke(new java.awt.BasicStroke(1/j/e));a.draw(PlanComponent.COMPASS_DISC);a.setTransform(b);if(f.length===1&&f[0]===c){a.setPaint(h);this.paintCompassIndicators(a,c,h,e)}}};PlanComponent.prototype.paintCompassIndicators=function(c,d,a,e){if(this.resizeIndicatorVisible){c.setPaint(a);c.setStroke(PlanComponent.INDICATOR_STROKE);var f=c.getTransform();var b=d.getPoints();var g=1/e;c.translate((b[2][0]+b[3][0])/2,(b[2][1]+b[3][1])/2);c.scale(g,g);c.rotate(d.getNorthDirection());c.draw(this.getIndicator(d,PlanComponent.IndicatorType.ROTATE));c.setTransform(f);c.translate((b[1][0]+b[2][0])/2,(b[1][1]+b[2][1])/2);c.scale(g,g);c.rotate(d.getNorthDirection());c.draw(this.getIndicator(d,PlanComponent.IndicatorType.RESIZE));c.setTransform(f)}};PlanComponent.prototype.paintWallAlignmentFeedback=function(a,e,o,p,c,b,h,j,d){var m=this;if(o!=null){var g=0.5/h;var n=o.getX();var l=o.getY();var k=Infinity;var f=Infinity;this.getViewedItems(this.home.getWalls(),this.otherLevelsWallsCache).forEach(function(r){if(r!==e){if(Math.abs(n-r.getXStart())<g&&(e==null||!m.equalsWallPoint(r.getXStart(),r.getYStart(),e))){if(Math.abs(f)>Math.abs(l-r.getYStart())){f=l-r.getYStart()}}else{if(Math.abs(n-r.getXEnd())<g&&(e==null||!m.equalsWallPoint(r.getXEnd(),r.getYEnd(),e))){if(Math.abs(f)>Math.abs(l-r.getYEnd())){f=l-r.getYEnd()}}}if(Math.abs(l-r.getYStart())<g&&(e==null||!m.equalsWallPoint(r.getXStart(),r.getYStart(),e))){if(Math.abs(k)>Math.abs(n-r.getXStart())){k=n-r.getXStart()}}else{if(Math.abs(l-r.getYEnd())<g&&(e==null||!m.equalsWallPoint(r.getXEnd(),r.getYEnd(),e))){if(Math.abs(k)>Math.abs(n-r.getXEnd())){k=n-r.getXEnd()}}}var s=r.getPoints();s=[s[0],s[(s.length/2|0)-1],s[(s.length/2|0)],s[s.length-1]];for(var t=0;t<s.length;t++){if(Math.abs(n-s[t][0])<g&&(e==null||!m.equalsWallPoint(s[t][0],s[t][1],e))){if(Math.abs(f)>Math.abs(l-s[t][1])){f=l-s[t][1]}}if(Math.abs(l-s[t][1])<g&&(e==null||!m.equalsWallPoint(s[t][0],s[t][1],e))){if(Math.abs(k)>Math.abs(n-s[t][0])){k=n-s[t][0]}}}}});a.setPaint(c);a.setStroke(b);var q=this.pointerType===View.PointerType.TOUCH?PlanComponent.ALIGNMENT_LINE_OFFSET*2:PlanComponent.ALIGNMENT_LINE_OFFSET;if(k!==Infinity){if(k>0){a.draw(new java.awt.geom.Line2D.Float(n+q/h,l,n-k-q/h,l))}else{a.draw(new java.awt.geom.Line2D.Float(n-q/h,l,n-k+q/h,l))}}if(f!==Infinity){if(f>0){a.draw(new java.awt.geom.Line2D.Float(n,l+q/h,n,l-f-q/h))}else{a.draw(new java.awt.geom.Line2D.Float(n,l-q/h,n,l-f+q/h))}}if(p){this.paintPointFeedback(a,o,c,h,j,d)}}};PlanComponent.prototype.getViewedItems=function(e,c){var b=[];if(c!=null){b.push.apply(b,c)}for(var d=0;d<e.length;d++){var a=e[d];if(this.isViewableAtSelectedLevel(a)){b.push(a)}}return b};PlanComponent.prototype.paintPointFeedback=function(f,e,c,h,b,d){f.setPaint(b);f.setStroke(d);var a=this.pointerType===View.PointerType.TOUCH?20:10;var g=new java.awt.geom.Ellipse2D.Float(e.getX()-a/h,e.getY()-a/h,2*a/h,2*a/h);f.fill(g);f.setPaint(c);f.setStroke(new java.awt.BasicStroke(1/h));f.draw(g);f.draw(new java.awt.geom.Line2D.Float(e.getX(),e.getY()-a/h,e.getX(),e.getY()+a/h));f.draw(new java.awt.geom.Line2D.Float(e.getX()-a/h,e.getY(),e.getX()+a/h,e.getY()))};PlanComponent.prototype.equalsWallPoint=function(b,c,a){return b===a.getXStart()&&c===a.getYStart()||b===a.getXEnd()&&c===a.getYEnd()};PlanComponent.prototype.paintRoomAlignmentFeedback=function(a,g,n,o,c,b,f,k,d){if(n!=null){var e=0.5/f;var m=n.getX();var l=n.getY();var h=Infinity;var j=Infinity;this.getViewedItems(this.home.getRooms(),this.otherLevelsRoomsCache).forEach(function(t){var q=t.getPoints();var s=-1;if(t===g){for(var r=0;r<q.length;r++){if(q[r][0]===m&&q[r][1]===l){s=r;break}}}for(var r=0;r<q.length;r++){if(s===-1||(r!==s&&q.length>2)){if(Math.abs(m-q[r][0])<e&&Math.abs(j)>Math.abs(l-q[r][1])){j=l-q[r][1]}if(Math.abs(l-q[r][1])<e&&Math.abs(h)>Math.abs(m-q[r][0])){h=m-q[r][0]}}}});this.getViewedItems(this.home.getWalls(),this.otherLevelsWallsCache).forEach(function(q){var r=q.getPoints();r=[r[0],r[(r.length/2|0)-1],r[(r.length/2|0)],r[r.length-1]];for(var s=0;s<r.length;s++){if(Math.abs(m-r[s][0])<e&&Math.abs(j)>Math.abs(l-r[s][1])){j=l-r[s][1]}if(Math.abs(l-r[s][1])<e&&Math.abs(h)>Math.abs(m-r[s][0])){h=m-r[s][0]}}});a.setPaint(c);a.setStroke(b);var p=this.pointerType===View.PointerType.TOUCH?PlanComponent.ALIGNMENT_LINE_OFFSET*2:PlanComponent.ALIGNMENT_LINE_OFFSET;if(h!==Infinity){if(h>0){a.draw(new java.awt.geom.Line2D.Float(m+p/f,l,m-h-p/f,l))}else{a.draw(new java.awt.geom.Line2D.Float(m-p/f,l,m-h+p/f,l))}}if(j!==Infinity){if(j>0){a.draw(new java.awt.geom.Line2D.Float(m,l+p/f,m,l-j-p/f))}else{a.draw(new java.awt.geom.Line2D.Float(m,l-p/f,m,l-j+p/f))}}if(o){this.paintPointFeedback(a,n,c,f,k,d)}}};PlanComponent.prototype.paintDimensionLineAlignmentFeedback=function(a,p,n,o,c,b,f,j,d){var l=this;if(n!=null){var e=0.5/f;var m=n.getX();var k=n.getY();var g=Infinity;var h=Infinity;this.getViewedItems(this.home.getRooms(),this.otherLevelsRoomsCache).forEach(function(t){var r=t.getPoints();for(var s=0;s<r.length;s++){if(Math.abs(m-r[s][0])<e&&Math.abs(h)>Math.abs(k-r[s][1])){h=k-r[s][1]}if(Math.abs(k-r[s][1])<e&&Math.abs(g)>Math.abs(m-r[s][0])){g=m-r[s][0]}}});this.home.getDimensionLines().forEach(function(r){if(l.isViewableAtSelectedLevel(r)&&r!==p){if(Math.abs(m-r.getXStart())<e&&(p==null||!l.equalsDimensionLinePoint(r.getXStart(),r.getYStart(),p))){if(Math.abs(h)>Math.abs(k-r.getYStart())){h=k-r.getYStart()}}else{if(Math.abs(m-r.getXEnd())<e&&(p==null||!l.equalsDimensionLinePoint(r.getXEnd(),r.getYEnd(),p))){if(Math.abs(h)>Math.abs(k-r.getYEnd())){h=k-r.getYEnd()}}}if(Math.abs(k-r.getYStart())<e&&(p==null||!l.equalsDimensionLinePoint(r.getXStart(),r.getYStart(),p))){if(Math.abs(g)>Math.abs(m-r.getXStart())){g=m-r.getXStart()}}else{if(Math.abs(k-r.getYEnd())<e&&(p==null||!l.equalsDimensionLinePoint(r.getXEnd(),r.getYEnd(),p))){if(Math.abs(g)>Math.abs(m-r.getXEnd())){g=m-r.getXEnd()}}}}});this.getViewedItems(this.home.getWalls(),this.otherLevelsWallsCache).forEach(function(r){var s=r.getPoints();s=[s[0],s[(s.length/2|0)-1],s[(s.length/2|0)],s[s.length-1]];for(var t=0;t<s.length;t++){if(Math.abs(m-s[t][0])<e&&Math.abs(h)>Math.abs(k-s[t][1])){h=k-s[t][1]}if(Math.abs(k-s[t][1])<e&&Math.abs(g)>Math.abs(m-s[t][0])){g=m-s[t][0]}}});this.home.getFurniture().forEach(function(t){if(t.isVisible()&&l.isViewableAtSelectedLevel(t)){var r=t.getPoints();for(var s=0;s<r.length;s++){if(Math.abs(m-r[s][0])<e&&Math.abs(h)>Math.abs(k-r[s][1])){h=k-r[s][1]}if(Math.abs(k-r[s][1])<e&&Math.abs(g)>Math.abs(m-r[s][0])){g=m-r[s][0]}}}});a.setPaint(c);a.setStroke(b);var q=this.pointerType===View.PointerType.TOUCH?PlanComponent.ALIGNMENT_LINE_OFFSET*2:PlanComponent.ALIGNMENT_LINE_OFFSET;if(g!==Infinity){if(g>0){a.draw(new java.awt.geom.Line2D.Float(m+q/f,k,m-g-q/f,k))}else{a.draw(new java.awt.geom.Line2D.Float(m-q/f,k,m-g+q/f,k))}}if(h!==Infinity){if(h>0){a.draw(new java.awt.geom.Line2D.Float(m,k+q/f,m,k-h-q/f))}else{a.draw(new java.awt.geom.Line2D.Float(m,k-q/f,m,k-h+q/f))}}if(o){this.paintPointFeedback(a,n,c,f,j,d)}}};PlanComponent.prototype.equalsDimensionLinePoint=function(b,c,a){return b===a.getXStart()&&c===a.getYStart()||b===a.getXEnd()&&c===a.getYEnd()};PlanComponent.prototype.paintAngleFeedback=function(a,b,j,h,d,k){if(!j.equals(b)&&!h.equals(b)){a.setColor(k);a.setStroke(new java.awt.BasicStroke(1/d));var g=Math.atan2(b.getY()-j.getY(),j.getX()-b.getX());if(g<0){g=2*Math.PI+g}var e=Math.atan2(b.getY()-h.getY(),h.getX()-b.getX());if(e<0){e=2*Math.PI+e}var l=e-g;if(g>e){l=2*Math.PI+l}var c=a.getTransform();a.translate(b.getX(),b.getY());var f=20/d;a.draw(new java.awt.geom.Arc2D.Double(-f,-f,f*2,f*2,g*180/Math.PI,l*180/Math.PI,java.awt.geom.Arc2D.OPEN));f+=5/d;a.draw(new java.awt.geom.Line2D.Double(0,0,f*Math.cos(g),-f*Math.sin(g)));a.draw(new java.awt.geom.Line2D.Double(0,0,f*Math.cos(g+l),-f*Math.sin(g+l)));a.setTransform(c)}};PlanComponent.prototype.paintCamera=function(m,k,n,l,y,s,f,p){var r=this.home.getObserverCamera();if(r===this.home.getCamera()){var w=m.getTransform();m.translate(r.getX(),r.getY());m.rotate(r.getYaw());var q=r.getPoints();var e=java.awt.geom.Point2D.distance(q[0][0],q[0][1],q[3][0],q[3][1]);var z=java.awt.geom.Point2D.distance(q[0][0],q[0][1],q[1][0],q[1][1]);var v=java.awt.geom.AffineTransform.getScaleInstance(z,e);var b=new java.awt.geom.Area(PlanComponent.CAMERA_BODY).createTransformedArea(v);var u=new java.awt.geom.Area(PlanComponent.CAMERA_HEAD).createTransformedArea(v);m.setPaint(f);m.fill(b);m.setPaint(p);var h=new java.awt.BasicStroke(this.getStrokeWidth(ObserverCamera,PlanComponent.PaintMode.PAINT)/s);m.setStroke(h);m.draw(b);if(k.indexOf(r)>=0&&this.selectedItemsOutlinePainted){m.setPaint(n);m.setStroke(l);var d=new java.awt.geom.Area(b);d.add(new java.awt.geom.Area(u));m.draw(d)}m.setPaint(f);m.fill(u);m.setPaint(p);m.setStroke(h);m.draw(u);var a=Math.sin(r.getFieldOfView()/2);var c=Math.cos(r.getFieldOfView()/2);var o=(0.9*e*a);var t=(0.9*e*c);var x=(2.2*e*a);var j=(2.2*e*c);var g=new java.awt.geom.GeneralPath();g.moveTo(o,t);g.lineTo(x,j);g.moveTo(-o,t);g.lineTo(-x,j);m.draw(g);m.setTransform(w);if(k.length===1&&k[0]===r){this.paintCameraRotationIndicators(m,r,y,s)}}};PlanComponent.prototype.paintCameraRotationIndicators=function(b,c,a,f){if(this.resizeIndicatorVisible){b.setPaint(a);b.setStroke(PlanComponent.INDICATOR_STROKE);var g=b.getTransform();var d=c.getPoints();var h=1/f;b.translate((d[0][0]+d[3][0])/2,(d[0][1]+d[3][1])/2);b.scale(h,h);b.rotate(c.getYaw());b.draw(this.getIndicator(c,PlanComponent.IndicatorType.ROTATE));b.setTransform(g);b.translate((d[1][0]+d[2][0])/2,(d[1][1]+d[2][1])/2);b.scale(h,h);b.rotate(c.getYaw());b.draw(this.getIndicator(c,PlanComponent.IndicatorType.ROTATE_PITCH));b.setTransform(g);var e=this.getIndicator(c,PlanComponent.IndicatorType.ELEVATE);if(e!=null){b.translate((d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2);b.scale(h,h);b.draw(PlanComponent.POINT_INDICATOR);b.translate(Math.sin(c.getYaw())*8,-Math.cos(c.getYaw())*8);b.draw(e);b.setTransform(g)}}};PlanComponent.prototype.paintRectangleFeedback=function(a,c,b){if(this.rectangleFeedback!=null){a.setPaint(ColorTools.toRGBAStyle(c,0.125));a.fill(this.rectangleFeedback);a.setPaint(c);a.setStroke(new java.awt.BasicStroke(1/b));a.draw(this.rectangleFeedback)}};PlanComponent.prototype.setRectangleFeedback=function(b,d,a,c){this.rectangleFeedback=new java.awt.geom.Rectangle2D.Float(b,d,0,0);this.rectangleFeedback.add(a,c);this.repaint()};PlanComponent.prototype.makeSelectionVisible=function(){if(this.isScrolled()&&!this.selectionScrollUpdated){this.selectionScrollUpdated=true;var a=this;setTimeout(function(){a.selectionScrollUpdated=false;var c=a.getSelectionBounds(true);if(c!=null){var d=a.getShapePixelBounds(c);d=new java.awt.geom.Rectangle2D.Float(d.getX()-5,d.getY()-5,d.getWidth()+10,d.getHeight()+10);var b=new java.awt.geom.Rectangle2D.Float(0,0,a.scrollPane.clientWidth,a.scrollPane.clientHeight);if(!d.intersects(b)){a.scrollRectToVisible(d)}}})}};PlanComponent.prototype.scrollRectToVisible=function(c){if(this.isScrolled()){var b=0;var a=0;if(c.x<0){b=c.x}else{if(c.getX()+c.getWidth()>this.scrollPane.clientWidth){b=c.getX()+c.getWidth()-this.scrollPane.clientWidth}}if(c.y<0){a=c.y}else{if(c.getY()+c.getHeight()>this.scrollPane.clientHeight){a=c.getY()+c.getHeight()-this.scrollPane.clientHeight}}this.moveView(this.convertPixelToLength(b),this.convertPixelToLength(a))}};PlanComponent.prototype.getSelectionBounds=function(c){var b=this.getGraphics();if(b!=null){this.setRenderingHints(b)}if(c){return this.getItemsBounds(b,this.home.getSelectedItems())}else{var d=this.home.getSelectedItems().slice(0);var a=d.indexOf(this.home.getCamera());if(a>=0){d.splice(a,1)}return this.getItemsBounds(b,d)}};PlanComponent.prototype.makePointVisible=function(a,b){this.scrollRectToVisible(this.getShapePixelBounds(new java.awt.geom.Rectangle2D.Float(a,b,this.getPixelLength(),this.getPixelLength())))};PlanComponent.prototype.moveView=function(b,a){if(this.isScrolled()&&(b!=0||a!=0)){this.scrollPane.scrollLeft+=this.convertLengthToPixel(b);this.scrollPane.scrollTop+=this.convertLengthToPixel(a);this.repaint()}};PlanComponent.prototype.getScale=function(){return this.scale};PlanComponent.prototype.setScale=function(e){if(this.scale!==e){var b=0;var c=0;if(this.isScrolled()){b=this.convertXPixelToModel(this.scrollPane.clientWidth/2);c=this.convertYPixelToModel(this.scrollPane.clientHeight/2)}this.scale=e;this.revalidate();if(this.isScrolled()&&!isNaN(b)){var d=this.convertPixelToLength(this.scrollPane.clientWidth);var a=this.convertPixelToLength(this.scrollPane.clientHeight);this.scrollPane.scrollLeft+=this.convertXModelToPixel(b-d/2);this.scrollPane.scrollTop+=this.convertYModelToPixel(c-a/2)}}};PlanComponent.prototype.convertXPixelToModel=function(a){var b=this.getInsets();var c=this.getPlanBounds();return this.convertPixelToLength(a-b.left+(this.isScrolled()?this.scrollPane.scrollLeft:0))-PlanComponent.MARGIN+c.getMinX()};PlanComponent.prototype.convertYPixelToModel=function(c){var a=this.getInsets();var b=this.getPlanBounds();return this.convertPixelToLength(c-a.top+(this.isScrolled()?this.scrollPane.scrollTop:0))-PlanComponent.MARGIN+b.getMinY()};PlanComponent.prototype.convertPixelToLength=function(a){return a*this.getPixelLength()};PlanComponent.prototype.convertXModelToPixel=function(a){var b=this.getInsets();var c=this.getPlanBounds();return this.convertLengthToPixel(a-c.getMinX()+PlanComponent.MARGIN)+b.left-(this.isScrolled()?this.scrollPane.scrollLeft:0)};PlanComponent.prototype.convertYModelToPixel=function(c){var a=this.getInsets();var b=this.getPlanBounds();return this.convertLengthToPixel(c-b.getMinY()+PlanComponent.MARGIN)+a.top-(this.isScrolled()?this.scrollPane.scrollTop:0)};PlanComponent.prototype.convertLengthToPixel=function(a){return Math.round(a/this.getPixelLength())};PlanComponent.prototype.convertXModelToScreen=function(a){return this.canvas.getBoundingClientRect().left+this.convertXModelToPixel(a)};PlanComponent.prototype.convertYModelToScreen=function(a){return this.canvas.getBoundingClientRect().top+this.convertYModelToPixel(a)};PlanComponent.prototype.getPixelLength=function(){return 1/this.getScale()};PlanComponent.prototype.getShapePixelBounds=function(b){var a=b.getBounds2D();return new java.awt.geom.Rectangle2D.Float(this.convertXModelToPixel(a.getMinX()),this.convertYModelToPixel(a.getMinY()),this.convertLengthToPixel(a.getWidth()),this.convertLengthToPixel(a.getHeight()))};PlanComponent.prototype.setCursor=function(a){if(typeof a==="string"){this.canvas.style.cursor=a}else{switch(a){case PlanView.CursorType.ROTATION:case PlanView.CursorType.HEIGHT:case PlanView.CursorType.POWER:case PlanView.CursorType.ELEVATION:case PlanView.CursorType.RESIZE:if(this.mouseListener.longTouch!=null){clearTimeout(this.mouseListener.longTouch);this.mouseListener.longTouch=null;this.stopLongTouchAnimation()}case PlanView.CursorType.MOVE:if(this.lastTouchX&&this.lastTouchY){this.startIndicatorAnimation(this.lastTouchX,this.lastTouchY,PlanView.CursorType[a].toLowerCase())}break}switch(a){case PlanView.CursorType.DRAW:this.setCursor("crosshair");break;case PlanView.CursorType.ROTATION:this.setCursor(this.rotationCursor);break;case PlanView.CursorType.HEIGHT:this.setCursor(this.heightCursor);break;case PlanView.CursorType.POWER:this.setCursor(this.powerCursor);break;case PlanView.CursorType.ELEVATION:this.setCursor(this.elevationCursor);break;case PlanView.CursorType.RESIZE:this.setCursor(this.resizeCursor);break;case PlanView.CursorType.PANNING:this.setCursor(this.panningCursor);break;case PlanView.CursorType.DUPLICATION:this.setCursor(this.duplicationCursor);break;case PlanView.CursorType.MOVE:this.setCursor(this.moveCursor);break;case PlanView.CursorType.SELECTION:default:this.setCursor("default");break}}};PlanComponent.prototype.setToolTipFeedback=function(c,b,e){this.tooltip.style.width="";this.tooltip.style.marginLeft="";if(c.indexOf("<html>")===0){this.tooltip.style.textAlign="left"}else{this.tooltip.style.textAlign="center"}this.tooltip.innerHTML=c.replace("<html>","").replace("</html>","");var a=this.container.getBoundingClientRect();this.tooltip.style.left=a.left+this.convertXModelToPixel(b)+"px";this.tooltip.style.top=a.top+this.convertYModelToPixel(e)+"px";this.tooltip.style.marginTop=-(this.tooltip.clientHeight+(this.pointerType===View.PointerType.TOUCH?(this.touchOverlay.style.visibility=="visible"?65:50):20))+"px";var d=this.tooltip.clientWidth+10;this.tooltip.style.width=d+"px";this.tooltip.style.marginLeft=-d/2+"px";this.tooltip.style.visibility="visible"};PlanComponent.prototype.setToolTipEditedProperties=function(c,b,a,d){};PlanComponent.prototype.deleteToolTipFeedback=function(){this.tooltip.style.visibility="hidden";this.tooltip.style.width="";this.tooltip.style.marginLeft="";this.tooltip.style.marginTop=""};PlanComponent.prototype.setResizeIndicatorVisible=function(a){this.resizeIndicatorVisible=a;this.repaint()};PlanComponent.prototype.setAlignmentFeedback=function(b,c,a,e,d){this.alignedObjectClass=b;this.alignedObjectFeedback=c;this.locationFeeback=new java.awt.geom.Point2D.Float(a,e);this.showPointFeedback=d;this.repaint()};PlanComponent.prototype.setAngleFeedback=function(e,f,b,d,a,c){this.centerAngleFeedback=new java.awt.geom.Point2D.Float(e,f);this.point1AngleFeedback=new java.awt.geom.Point2D.Float(b,d);this.point2AngleFeedback=new java.awt.geom.Point2D.Float(a,c)};PlanComponent.prototype.setDraggedItemsFeedback=function(a){this.draggedItemsFeedback=a;this.repaint()};PlanComponent.prototype.setDimensionLinesFeedback=function(a){this.dimensionLinesFeedback=a;this.repaint()};PlanComponent.prototype.deleteFeedback=function(){this.deleteToolTipFeedback();this.rectangleFeedback=null;this.alignedObjectClass=null;this.alignedObjectFeedback=null;this.locationFeeback=null;this.centerAngleFeedback=null;this.point1AngleFeedback=null;this.point2AngleFeedback=null;this.draggedItemsFeedback=null;this.dimensionLinesFeedback=null;this.repaint()};PlanComponent.prototype.canImportDraggedItems=function(b,a,c){return true};PlanComponent.prototype.getPieceOfFurnitureSizeInPlan=function(a){if(a.getRoll()===0&&a.getPitch()===0){return[a.getWidth(),a.getDepth(),a.getHeight()]}else{if(!this.isFurnitureSizeInPlanSupported()){return null}else{return PlanComponent.PieceOfFurnitureModelIcon.computePieceOfFurnitureSizeInPlan(a,this.object3dFactory)}}};PlanComponent.prototype.isFurnitureSizeInPlanSupported=function(){return PlanComponent.WEBGL_AVAILABLE};PlanComponent.prototype.getHorizontalRuler=function(){throw new UnsupportedOperationException("No rulers")};PlanComponent.prototype.getVerticalRuler=function(){throw new UnsupportedOperationException("No rulers")};PlanComponent.PieceOfFurnitureTopViewIcon=function(a){this.image=a};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.getIconWidth=function(){return this.image.width};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.getIconHeight=function(){return this.image.height};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.paintIcon=function(b,a,c){b.drawImage(this.image,a,c)};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.isWaitIcon=function(){return this.image===TextureManager.getInstance().getWaitImage()};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.isErrorIcon=function(){return this.image===TextureManager.getInstance().getErrorImage()};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.setIcon=function(a){this.image=a};PlanComponent.PieceOfFurniturePlanIcon=function(c,a){PlanComponent.PieceOfFurnitureTopViewIcon.call(this,TextureManager.getInstance().getWaitImage());var b=this;TextureManager.getInstance().loadTexture(c.getPlanIcon(),false,{textureUpdated:function(d){b.setIcon(d);a.repaint()},textureError:function(d){b.setIcon(TextureManager.getInstance().getErrorImage());a.repaint()}})};PlanComponent.PieceOfFurniturePlanIcon.prototype=Object.create(PlanComponent.PieceOfFurnitureTopViewIcon.prototype);PlanComponent.PieceOfFurniturePlanIcon.prototype.constructor=PlanComponent.PieceOfFurniturePlanIcon;PlanComponent.PieceOfFurnitureModelIcon=function(e,b,d,a){PlanComponent.PieceOfFurnitureTopViewIcon.call(this,TextureManager.getInstance().getWaitImage());var c=this;ModelManager.getInstance().loadModel(e.getModel(),d===null,{modelUpdated:function(l){var g=e.clone();if(g.isResizable()&&e.getRoll()==0){g.setModelMirrored(false)}var j=g.getWidthInPlan();var f=g.getDepthInPlan();var h=g.getHeightInPlan();g.setX(0);g.setY(0);g.setElevation(-h/2);g.setLevel(null);g.setAngle(0);if(d!==null){var k=function(){b.createObject3D(null,g,function(m){c.createIcon(m,j,f,h,a,function(n){c.setIcon(n);d.repaint()})})};setTimeout(k,0)}else{c.setIcon(c.createIcon(b.createObject3D(null,g,true),j,f,h,a))}},modelError:function(f){c.setIcon(TextureManager.getInstance().getErrorImage());if(d!==null){d.repaint()}}})};PlanComponent.PieceOfFurnitureModelIcon.prototype=Object.create(PlanComponent.PieceOfFurnitureTopViewIcon.prototype);PlanComponent.PieceOfFurnitureModelIcon.prototype.constructor=PlanComponent.PieceOfFurnitureModelIcon;PlanComponent.PieceOfFurnitureModelIcon.prototype.getSceneRoot=function(a){if(!PlanComponent.PieceOfFurnitureModelIcon.canvas3D){var c=document.createElement("canvas");c.width=a;c.height=a;c.style.backgroundColor="rgba(0, 0, 0, 0)";var g=new HTMLCanvas3D(c);var e=mat4.create();mat4.fromXRotation(e,-Math.PI/2);g.setViewPlatformTransform(e);g.setProjectionPolicy(HTMLCanvas3D.PARALLEL_PROJECTION);g.setFrontClipDistance(-1.1);g.setBackClipDistance(1.1);var f=new BranchGroup3D();f.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);var b=[new DirectionalLight3D(vec3.fromValues(0.6,0.6,0.6),vec3.fromValues(1.5,-0.8,-1)),new DirectionalLight3D(vec3.fromValues(0.6,0.6,0.6),vec3.fromValues(-1.5,-0.8,-1)),new DirectionalLight3D(vec3.fromValues(0.6,0.6,0.6),vec3.fromValues(0,-0.8,1)),new AmbientLight3D(vec3.fromValues(0.2,0.2,0.2))];for(var d=0;d<b.length;d++){f.addChild(b[d])}g.setScene(f);PlanComponent.PieceOfFurnitureModelIcon.canvas3D=g}else{if(PlanComponent.PieceOfFurnitureModelIcon.canvas3D.getHTMLElement().width!==a){PlanComponent.PieceOfFurnitureModelIcon.canvas3D.clear();delete PlanComponent.PieceOfFurnitureModelIcon.canvas3D;return this.getSceneRoot(a)}}return PlanComponent.PieceOfFurnitureModelIcon.canvas3D.getScene()};PlanComponent.PieceOfFurnitureModelIcon.prototype.createIcon=function(k,n,b,g,j,e){var d=mat4.create();mat4.scale(d,d,vec3.fromValues(2/n,2/g,2/b));var c=new TransformGroup3D();c.setTransform(d);c.addChild(k);var f=new BranchGroup3D();f.addChild(c);var m=this.getSceneRoot(j);if(e){var a=Date.now();var h=function(){m.addChild(f);var o=PlanComponent.PieceOfFurnitureModelIcon.canvas3D.isLoadingCompleted();if(o||(Date.now()-a)>5000){PlanComponent.PieceOfFurnitureModelIcon.canvas3D.getImage(e)}m.removeChild(f);if(!o){setTimeout(h,0)}};h();return undefined}else{m.addChild(f);var l=PlanComponent.PieceOfFurnitureModelIcon.canvas3D.getImage();m.removeChild(f);return l}};PlanComponent.PieceOfFurnitureModelIcon.computePieceOfFurnitureSizeInPlan=function(f,b){var a=mat4.create();if(f.getPitch()!==0){mat4.fromXRotation(a,-f.getPitch())}if(f.getRoll()!==0){var c=mat4.create();mat4.fromZRotation(c,-f.getRoll());mat4.mul(a,a,c,a)}f=f.clone();f.setX(0);f.setY(0);f.setElevation(-f.getHeight()/2);f.setLevel(null);f.setAngle(0);f.setRoll(0);f.setPitch(0);f.setWidthInPlan(f.getWidth());f.setDepthInPlan(f.getDepth());f.setHeightInPlan(f.getHeight());var g=ModelManager.getInstance().getBounds(b.createObject3D(null,f,true),a);var d=vec3.create();g.getLower(d);var e=vec3.create();g.getUpper(e);return[Math.max(0.001,(e[0]-d[0])),Math.max(0.001,(e[2]-d[2])),Math.max(0.001,(e[1]-d[1]))]};PlanComponent.HomePieceOfFurnitureTopViewIconKey=function(a){this.piece=a;this.hashCode=(a.getPlanIcon()!=null?a.getPlanIcon().hashCode():a.getModel().hashCode())+(a.getColor()!=null?37*a.getColor():1234);if(a.isHorizontallyRotated()||a.getTexture()!=null){this.hashCode+=(a.getTexture()!=null?37*a.getTexture().hashCode():0)+37*(a.getWidthInPlan()|0)+37*(a.getDepthInPlan()|0)+37*(a.getHeightInPlan()|0)}if(a.getRoll()!=0){this.hashCode+=37*(a.isModelMirrored()?1231:1237)}if(a.getPlanIcon()!=null){this.hashCode+=37*(function(b){return(31*b[0][0]+31*b[0][1]+31*b[0][2]+37*b[1][0]+37*b[1][1]+37*b[1][2]+41*b[2][0]+41*b[2][1]+41*b[2][2])|0})(a.getModelRotation())+37*(a.isModelCenteredAtOrigin()?1:0)+37*(a.isBackFaceShown()?1:0)+37*((a.getPitch()*1000)|0)+37*((a.getRoll()*1000)|0)+37*(function(d){var b=0;if(d!=null){for(var c=0;c<d.length;c++){if(d[c]!=null){b+=37*d[c].hashCode()}}}return b|0})(a.getModelTransformations())+37*(function(d){var b=0;if(d!=null){for(var c=0;c<d.length;c++){if(d[c]!=null){b+=37*d[c].hashCode()}}}return b|0})(a.getModelMaterials())+(a.getShininess()!=null?37*((a.getShininess()*1000)|0):3456)}};PlanComponent.HomePieceOfFurnitureTopViewIconKey.prototype.equals=function(b){if(b instanceof PlanComponent.HomePieceOfFurnitureTopViewIconKey){var a=b.piece;return(this.piece.getPlanIcon()!=null?this.piece.getPlanIcon().equals(a.getPlanIcon()):this.piece.getModel().equals(a.getModel()))&&(this.piece.getColor()==a.getColor())&&(this.piece.getTexture()==a.getTexture()||this.piece.getTexture()!=null&&this.piece.getTexture().equals(a.getTexture()))&&(!this.piece.isHorizontallyRotated()&&!a.isHorizontallyRotated()&&this.piece.getTexture()==null&&a.getTexture()==null||this.piece.getWidthInPlan()==a.getWidthInPlan()&&this.piece.getDepthInPlan()==a.getDepthInPlan()&&this.piece.getHeightInPlan()==a.getHeightInPlan())&&(this.piece.getRoll()==0&&a.getRoll()==0||this.piece.isModelMirrored()==a.isModelMirrored())&&(this.piece.getPlanIcon()!=null||(function(d,c){return d[0][0]==c[0][0]&&d[0][1]==c[0][1]&&d[0][2]==c[0][2]&&d[1][0]==c[1][0]&&d[1][1]==c[1][1]&&d[1][2]==c[1][2]&&d[2][0]==c[2][0]&&d[2][1]==c[2][1]&&d[2][2]==c[2][2]})(this.piece.getModelRotation(),a.getModelRotation())&&this.piece.isModelCenteredAtOrigin()==a.isModelCenteredAtOrigin()&&this.piece.isBackFaceShown()==a.isBackFaceShown()&&this.piece.getPitch()==a.getPitch()&&this.piece.getRoll()==a.getRoll()&&(function(e,d){if(e===d){return true}if(e==null||d==null||e.length!==d.length){return false}for(var c=0;c<e.length;c++){if(e[c]!==d[c]&&(e[c]==null||!e[c].equals(d[c]))){return false}}return true})(this.piece.getModelTransformations(),a.getModelTransformations())&&(function(e,d){if(e===d){return true}if(e==null||d==null||e.length!==d.length){return false}for(var c=0;c<e.length;c++){if(e[c]!==d[c]&&(e[c]==null||!e[c].equals(d[c]))){return false}}return true})(this.piece.getModelMaterials(),a.getModelMaterials())&&this.piece.getShininess()==a.getShininess())}else{return false}};PlanComponent.HomePieceOfFurnitureTopViewIconKey.prototype.hashCode=function(){return this.hashCode};function HomePane(h,k,f,g){if(h!=null){this.container=document.getElementById(h)}if(!this.container){this.container=document.body}this.home=k;this.preferences=f;this.controller=g;this.clipboardEmpty=true;this.actionMap={};this.inputMap={};this.createActions(k,f,g);this.initActions(f);this.addHomeListener(k);this.addLevelVisibilityListener(k);this.addUserPreferencesListener(f);this.addPlanControllerListener(g.getPlanController());this.createToolBar(k,f);this.createPopupMenus(k,f);this.initSplitters();this.addOrientationChangeListener();var j=this;document.addEventListener("keydown",function(o){if(JSDialog.getTopMostDialog()!==null){return}var r=KeyStroke.getKeyStrokeForEvent(o);if(r!==undefined){for(var n in j.actionMap){var q=j.actionMap[n];if(q.isEnabled()&&q.getValue(AbstractAction.ACCELERATOR_KEY)==r){q.actionPerformed();o.stopPropagation();return}}var p=j.inputMap[r];if(p!==undefined){var q=j.actionMap[p];if(q!==undefined){q.actionPerformed(o)}o.stopPropagation()}}},true);var l=g.getPlanController().getView();setTimeout(function(){g.focusedViewChanged(l)});var e=k.getNumericProperty(HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY);var c=k.getNumericProperty(HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY);if(e!=null&&c!=null){l.scrollPane.scrollLeft=e|0;l.scrollPane.scrollTop=c|0}l.scrollPane.addEventListener("scroll",function(n){g.setHomeProperty(HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY,l.scrollPane.scrollLeft.toString());g.setHomeProperty(HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY,l.scrollPane.scrollTop.toString())});j.levelSelector=document.getElementById("level-selector");var a=function(){if(j.levelSelector){j.levelSelector.innerHTML="";if(k.getLevels().length<2){j.levelSelector.style.display="none"}else{for(var n=0;n<k.getLevels().length;n++){var o=document.createElement("option");o.value=n;o.innerHTML=k.getLevels()[n].getName();if(k.getLevels()[n]===k.getSelectedLevel()){o.selected="selected"}j.levelSelector.appendChild(o)}j.levelSelector.style.display="inline"}}};a();if(j.levelSelector){j.levelSelector.addEventListener("change",function(n){g.getPlanController().setSelectedLevel(k.getLevels()[parseInt(n.target.value)]);a()})}k.addPropertyChangeListener("SELECTED_LEVEL",function(){a()});var d=function(n){if("NAME"==n.getPropertyName()||"ELEVATION"==n.getPropertyName()||"ELEVATION_INDEX"==n.getPropertyName()){a()}};var m=k.getLevels();for(var b=0;b<m.length;b++){m[b].addPropertyChangeListener(d)}k.addLevelsListener(function(n){if(n.getType()===CollectionEvent.Type.ADD){n.getItem().addPropertyChangeListener(d)}else{if(n.getType()===CollectionEvent.Type.DELETE){n.getItem().removePropertyChangeListener(d)}}a()})}HomePane.__class="HomePane";HomePane.__interfaces=["com.eteks.sweethome3d.viewcontroller.HomeView","com.eteks.sweethome3d.viewcontroller.View"];HomePane.MAIN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.MainPaneDividerLocation";HomePane.CATALOG_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.CatalogPaneDividerLocation";HomePane.PLAN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanPaneDividerLocation";HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanViewportX";HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanViewportY";HomePane.FURNITURE_VIEWPORT_Y_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.FurnitureViewportY";HomePane.DETACHED_VIEW_VISUAL_PROPERTY=".detachedView";HomePane.DETACHED_VIEW_DIVIDER_LOCATION_VISUAL_PROPERTY=".detachedViewDividerLocation";HomePane.DETACHED_VIEW_X_VISUAL_PROPERTY=".detachedViewX";HomePane.DETACHED_VIEW_Y_VISUAL_PROPERTY=".detachedViewY";HomePane.DETACHED_VIEW_WIDTH_VISUAL_PROPERTY=".detachedViewWidth";HomePane.DETACHED_VIEW_HEIGHT_VISUAL_PROPERTY=".detachedViewHeight";HomePane.MenuActionType={};HomePane.MenuActionType[HomePane.MenuActionType.FILE_MENU=0]="FILE_MENU";HomePane.MenuActionType[HomePane.MenuActionType.EDIT_MENU=1]="EDIT_MENU";HomePane.MenuActionType[HomePane.MenuActionType.FURNITURE_MENU=2]="FURNITURE_MENU";HomePane.MenuActionType[HomePane.MenuActionType.PLAN_MENU=3]="PLAN_MENU";HomePane.MenuActionType[HomePane.MenuActionType.VIEW_3D_MENU=4]="VIEW_3D_MENU";HomePane.MenuActionType[HomePane.MenuActionType.HELP_MENU=5]="HELP_MENU";HomePane.MenuActionType[HomePane.MenuActionType.OPEN_RECENT_HOME_MENU=6]="OPEN_RECENT_HOME_MENU";HomePane.MenuActionType[HomePane.MenuActionType.ALIGN_OR_DISTRIBUTE_MENU=7]="ALIGN_OR_DISTRIBUTE_MENU";HomePane.MenuActionType[HomePane.MenuActionType.SORT_HOME_FURNITURE_MENU=8]="SORT_HOME_FURNITURE_MENU";HomePane.MenuActionType[HomePane.MenuActionType.DISPLAY_HOME_FURNITURE_PROPERTY_MENU=9]="DISPLAY_HOME_FURNITURE_PROPERTY_MENU";HomePane.MenuActionType[HomePane.MenuActionType.MODIFY_TEXT_STYLE=10]="MODIFY_TEXT_STYLE";HomePane.MenuActionType[HomePane.MenuActionType.GO_TO_POINT_OF_VIEW=11]="GO_TO_POINT_OF_VIEW";HomePane.MenuActionType[HomePane.MenuActionType.SELECT_OBJECT_MENU=12]="SELECT_OBJECT_MENU";HomePane.MenuActionType[HomePane.MenuActionType.TOGGLE_SELECTION_MENU=13]="TOGGLE_SELECTION_MENU";HomePane.prototype.getHTMLElement=function(){return this.container};HomePane.prototype.getActionMap=function(){return this.actionMap};HomePane.prototype.getAction=function(a){if(typeof a==="string"){return this.actionMap[a]}else{return this.actionMap[HomeView.ActionType[a]]}};HomePane.prototype.createActions=function(n,j,k){var d=HomeView.ActionType;this.createAction(d.NEW_HOME,j,k,"newHome");this.createAction(d.NEW_HOME_FROM_EXAMPLE,j,k,"newHomeFromExample");this.createAction(d.OPEN,j,k,"open");this.createAction(d.DELETE_RECENT_HOMES,j,k,"deleteRecentHomes");this.createAction(d.CLOSE,j,k,"close");this.createAction(d.SAVE,j,k,"save");this.createAction(d.SAVE_AS,j,k,"saveAs");this.createAction(d.SAVE_AND_COMPRESS,j,k,"saveAndCompress");this.createAction(d.PAGE_SETUP,j,k,"setupPage");this.createAction(d.PRINT_PREVIEW,j,k,"previewPrint");this.createAction(d.PRINT,j,k,"print");this.createAction(d.PRINT_TO_PDF,j,k,"printToPDF");this.createAction(d.PREFERENCES,j,k,"editPreferences");this.createAction(d.EXIT,j,k,"exit");this.createAction(d.UNDO,j,k,"undo");this.createAction(d.REDO,j,k,"redo");this.createClipboardAction(d.CUT,j,null,true);this.createClipboardAction(d.COPY,j,null,true);this.createClipboardAction(d.PASTE,j,null,false);this.createAction(d.PASTE_TO_GROUP,j,k,"pasteToGroup");this.createAction(d.PASTE_STYLE,j,k,"pasteStyle");this.createAction(d.DELETE,j,k,"delete");this.createAction(d.SELECT_ALL,j,k,"selectAll");this.createAction(d.ADD_HOME_FURNITURE,j,k,"addHomeFurniture");this.createAction(d.ADD_FURNITURE_TO_GROUP,j,k,"addFurnitureToGroup");var f=k.getFurnitureController();this.createAction(d.DELETE_HOME_FURNITURE,j,f,"deleteSelection");this.createAction(d.MODIFY_FURNITURE,j,k,"modifySelectedFurniture");this.createAction(d.GROUP_FURNITURE,j,f,"groupSelectedFurniture");this.createAction(d.UNGROUP_FURNITURE,j,f,"ungroupSelectedFurniture");this.createAction(d.ALIGN_FURNITURE_ON_TOP,j,f,"alignSelectedFurnitureOnTop");this.createAction(d.ALIGN_FURNITURE_ON_BOTTOM,j,f,"alignSelectedFurnitureOnBottom");this.createAction(d.ALIGN_FURNITURE_ON_LEFT,j,f,"alignSelectedFurnitureOnLeft");this.createAction(d.ALIGN_FURNITURE_ON_RIGHT,j,f,"alignSelectedFurnitureOnRight");this.createAction(d.ALIGN_FURNITURE_ON_FRONT_SIDE,j,f,"alignSelectedFurnitureOnFrontSide");this.createAction(d.ALIGN_FURNITURE_ON_BACK_SIDE,j,f,"alignSelectedFurnitureOnBackSide");this.createAction(d.ALIGN_FURNITURE_ON_LEFT_SIDE,j,f,"alignSelectedFurnitureOnLeftSide");this.createAction(d.ALIGN_FURNITURE_ON_RIGHT_SIDE,j,f,"alignSelectedFurnitureOnRightSide");this.createAction(d.ALIGN_FURNITURE_SIDE_BY_SIDE,j,f,"alignSelectedFurnitureSideBySide");this.createAction(d.DISTRIBUTE_FURNITURE_HORIZONTALLY,j,f,"distributeSelectedFurnitureHorizontally");this.createAction(d.DISTRIBUTE_FURNITURE_VERTICALLY,j,f,"distributeSelectedFurnitureVertically");this.createAction(d.RESET_FURNITURE_ELEVATION,j,f,"resetFurnitureElevation");var b=k.getHomeController3D();if(b.getView()!=null){this.createAction(d.IMPORT_FURNITURE,j,k,"importFurniture")}this.createAction(d.IMPORT_FURNITURE_LIBRARY,j,k,"importFurnitureLibrary");this.createAction(d.IMPORT_TEXTURE,j,k,"importTexture");this.createAction(d.IMPORT_TEXTURES_LIBRARY,j,k,"importTexturesLibrary");this.createAction(d.SORT_HOME_FURNITURE_BY_CATALOG_ID,j,f,"toggleFurnitureSort","CATALOG_ID");this.createAction(d.SORT_HOME_FURNITURE_BY_NAME,j,f,"toggleFurnitureSort","NAME");this.createAction(d.SORT_HOME_FURNITURE_BY_CREATOR,j,f,"toggleFurnitureSort","CREATOR");this.createAction(d.SORT_HOME_FURNITURE_BY_WIDTH,j,f,"toggleFurnitureSort","WIDTH");this.createAction(d.SORT_HOME_FURNITURE_BY_DEPTH,j,f,"toggleFurnitureSort","DEPTH");this.createAction(d.SORT_HOME_FURNITURE_BY_HEIGHT,j,f,"toggleFurnitureSort","HEIGHT");this.createAction(d.SORT_HOME_FURNITURE_BY_X,j,f,"toggleFurnitureSort","X");this.createAction(d.SORT_HOME_FURNITURE_BY_Y,j,f,"toggleFurnitureSort","Y");this.createAction(d.SORT_HOME_FURNITURE_BY_ELEVATION,j,f,"toggleFurnitureSort","ELEVATION");this.createAction(d.SORT_HOME_FURNITURE_BY_ANGLE,j,f,"toggleFurnitureSort","ANGLE");this.createAction(d.SORT_HOME_FURNITURE_BY_LEVEL,j,f,"toggleFurnitureSort","LEVEL");this.createAction(d.SORT_HOME_FURNITURE_BY_MODEL_SIZE,j,f,"toggleFurnitureSort","MODEL_SIZE");this.createAction(d.SORT_HOME_FURNITURE_BY_COLOR,j,f,"toggleFurnitureSort","COLOR");this.createAction(d.SORT_HOME_FURNITURE_BY_TEXTURE,j,f,"toggleFurnitureSort","TEXTURE");this.createAction(d.SORT_HOME_FURNITURE_BY_MOVABILITY,j,f,"toggleFurnitureSort","MOVABLE");this.createAction(d.SORT_HOME_FURNITURE_BY_TYPE,j,f,"toggleFurnitureSort","DOOR_OR_WINDOW");this.createAction(d.SORT_HOME_FURNITURE_BY_VISIBILITY,j,f,"toggleFurnitureSort","VISIBLE");this.createAction(d.SORT_HOME_FURNITURE_BY_PRICE,j,f,"toggleFurnitureSort","PRICE");this.createAction(d.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE,j,f,"toggleFurnitureSort","VALUE_ADDED_TAX_PERCENTAGE");this.createAction(d.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX,j,f,"toggleFurnitureSort","VALUE_ADDED_TAX");this.createAction(d.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED,j,f,"toggleFurnitureSort","PRICE_VALUE_ADDED_TAX_INCLUDED");this.createAction(d.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER,j,f,"toggleFurnitureSortOrder");this.createAction(d.DISPLAY_HOME_FURNITURE_CATALOG_ID,j,f,"toggleFurnitureVisibleProperty","CATALOG_ID");this.createAction(d.DISPLAY_HOME_FURNITURE_NAME,j,f,"toggleFurnitureVisibleProperty","NAME");this.createAction(d.DISPLAY_HOME_FURNITURE_CREATOR,j,f,"toggleFurnitureVisibleProperty","CREATOR");this.createAction(d.DISPLAY_HOME_FURNITURE_WIDTH,j,f,"toggleFurnitureVisibleProperty","WIDTH");this.createAction(d.DISPLAY_HOME_FURNITURE_DEPTH,j,f,"toggleFurnitureVisibleProperty","DEPTH");this.createAction(d.DISPLAY_HOME_FURNITURE_HEIGHT,j,f,"toggleFurnitureVisibleProperty","HEIGHT");this.createAction(d.DISPLAY_HOME_FURNITURE_X,j,f,"toggleFurnitureVisibleProperty","X");this.createAction(d.DISPLAY_HOME_FURNITURE_Y,j,f,"toggleFurnitureVisibleProperty","Y");this.createAction(d.DISPLAY_HOME_FURNITURE_ELEVATION,j,f,"toggleFurnitureVisibleProperty","ELEVATION");this.createAction(d.DISPLAY_HOME_FURNITURE_ANGLE,j,f,"toggleFurnitureVisibleProperty","ANGLE");this.createAction(d.DISPLAY_HOME_FURNITURE_LEVEL,j,f,"toggleFurnitureVisibleProperty","LEVEL");this.createAction(d.DISPLAY_HOME_FURNITURE_MODEL_SIZE,j,f,"toggleFurnitureVisibleProperty","MODEL_SIZE");this.createAction(d.DISPLAY_HOME_FURNITURE_COLOR,j,f,"toggleFurnitureVisibleProperty","COLOR");this.createAction(d.DISPLAY_HOME_FURNITURE_TEXTURE,j,f,"toggleFurnitureVisibleProperty","TEXTURE");this.createAction(d.DISPLAY_HOME_FURNITURE_MOVABLE,j,f,"toggleFurnitureVisibleProperty","MOVABLE");this.createAction(d.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW,j,f,"toggleFurnitureVisibleProperty","DOOR_OR_WINDOW");this.createAction(d.DISPLAY_HOME_FURNITURE_VISIBLE,j,f,"toggleFurnitureVisibleProperty","VISIBLE");this.createAction(d.DISPLAY_HOME_FURNITURE_PRICE,j,f,"toggleFurnitureVisibleProperty","PRICE");this.createAction(d.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE,j,f,"toggleFurnitureVisibleProperty","VALUE_ADDED_TAX_PERCENTAGE");this.createAction(d.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX,j,f,"toggleFurnitureVisibleProperty","VALUE_ADDED_TAX");this.createAction(d.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED,j,f,"toggleFurnitureVisibleProperty","PRICE_VALUE_ADDED_TAX_INCLUDED");this.createAction(d.EXPORT_TO_CSV,j,k,"exportToCSV");var o=k.getPlanController();if(o.getView()!=null){this.createAction(d.SELECT_ALL_AT_ALL_LEVELS,j,o,"selectAllAtAllLevels");var g=[];this.createToggleAction(d.SELECT,o.getMode()==PlanController.Mode.SELECTION,g,j,k,"setMode",PlanController.Mode.SELECTION);this.createToggleAction(d.PAN,o.getMode()==PlanController.Mode.PANNING,g,j,k,"setMode",PlanController.Mode.PANNING);this.createToggleAction(d.CREATE_WALLS,o.getMode()==PlanController.Mode.WALL_CREATION,g,j,k,"setMode",PlanController.Mode.WALL_CREATION);this.createToggleAction(d.CREATE_ROOMS,o.getMode()==PlanController.Mode.ROOM_CREATION,g,j,k,"setMode",PlanController.Mode.ROOM_CREATION);this.createToggleAction(d.CREATE_POLYLINES,o.getMode()==PlanController.Mode.POLYLINE_CREATION,g,j,k,"setMode",PlanController.Mode.POLYLINE_CREATION);this.createToggleAction(d.CREATE_DIMENSION_LINES,o.getMode()==PlanController.Mode.DIMENSION_LINE_CREATION,g,j,k,"setMode",PlanController.Mode.DIMENSION_LINE_CREATION);this.createToggleAction(d.CREATE_LABELS,o.getMode()==PlanController.Mode.LABEL_CREATION,g,j,k,"setMode",PlanController.Mode.LABEL_CREATION);this.createAction(d.DELETE_SELECTION,j,o,"deleteSelection");this.createAction(d.LOCK_BASE_PLAN,j,o,"lockBasePlan");this.createAction(d.UNLOCK_BASE_PLAN,j,o,"unlockBasePlan");this.createAction(d.ENABLE_MAGNETISM,j,k,"enableMagnetism");this.createAction(d.DISABLE_MAGNETISM,j,k,"disableMagnetism");this.createAction(d.FLIP_HORIZONTALLY,j,o,"flipHorizontally");this.createAction(d.FLIP_VERTICALLY,j,o,"flipVertically");this.createAction(d.MODIFY_COMPASS,j,o,"modifyCompass");this.createAction(d.MODIFY_WALL,j,o,"modifySelectedWalls");this.createAction(d.MODIFY_ROOM,j,o,"modifySelectedRooms");this.createAction(d.JOIN_WALLS,j,o,"joinSelectedWalls");this.createAction(d.REVERSE_WALL_DIRECTION,j,o,"reverseSelectedWallsDirection");this.createAction(d.SPLIT_WALL,j,o,"splitSelectedWall");this.createAction(d.ADD_ROOM_POINT,j);this.createAction(d.DELETE_ROOM_POINT,j);this.createAction(d.MODIFY_POLYLINE,j,o,"modifySelectedPolylines");this.createAction(d.MODIFY_LABEL,j,o,"modifySelectedLabels");this.createAction(d.INCREASE_TEXT_SIZE,j,o,"increaseTextSize");this.createAction(d.DECREASE_TEXT_SIZE,j,o,"decreaseTextSize");var c=this.createBoldStyleAction(d.TOGGLE_BOLD_STYLE,n,j,o,"toggleBoldStyle");var p=this.createItalicStyleToggleModel(d.TOGGLE_ITALIC_STYLE,n,j,o,"toggleItalicStyle");this.createAction(d.IMPORT_BACKGROUND_IMAGE,j,k,"importBackgroundImage");this.createAction(d.MODIFY_BACKGROUND_IMAGE,j,k,"modifyBackgroundImage");this.createAction(d.HIDE_BACKGROUND_IMAGE,j,k,"hideBackgroundImage");this.createAction(d.SHOW_BACKGROUND_IMAGE,j,k,"showBackgroundImage");this.createAction(d.DELETE_BACKGROUND_IMAGE,j,k,"deleteBackgroundImage");this.createAction(d.ADD_LEVEL,j,o,"addLevel");this.createAction(d.ADD_LEVEL_AT_SAME_ELEVATION,j,o,"addLevelAtSameElevation");this.createAction(d.MAKE_LEVEL_VIEWABLE,j,o,"toggleSelectedLevelViewability");this.createAction(d.MAKE_LEVEL_UNVIEWABLE,j,o,"toggleSelectedLevelViewability");this.createAction(d.MAKE_LEVEL_ONLY_VIEWABLE_ONE,j,o,"setSelectedLevelOnlyViewable");this.createAction(d.MAKE_ALL_LEVELS_VIEWABLE,j,o,"setAllLevelsViewable");this.createAction(d.MODIFY_LEVEL,j,o,"modifySelectedLevel");this.createAction(d.DELETE_LEVEL,j,o,"deleteSelectedLevel");this.createAction(d.ZOOM_IN,j,k,"zoomIn");this.createAction(d.ZOOM_OUT,j,k,"zoomOut");this.createAction(d.EXPORT_TO_SVG,j,k,"exportToSVG")}if(b.getView()!=null){this.createAction(d.SELECT_OBJECT,j);this.createAction(d.TOGGLE_SELECTION,j);var e=[];this.createToggleAction(d.VIEW_FROM_TOP,n.getCamera()==n.getTopCamera(),e,j,b,"viewFromTop");this.createToggleAction(d.VIEW_FROM_OBSERVER,n.getCamera()==n.getObserverCamera(),e,j,b,"viewFromObserver");this.createAction(d.MODIFY_OBSERVER,j,o,"modifyObserverCamera");this.createAction(d.STORE_POINT_OF_VIEW,j,k,"storeCamera");this.createAction(d.DELETE_POINTS_OF_VIEW,j,k,"deleteCameras");this.createAction(d.DETACH_3D_VIEW,j,k,"detachView",k.getHomeController3D().getView());this.createAction(d.ATTACH_3D_VIEW,j,k,"attachView",k.getHomeController3D().getView());var l=n.getEnvironment().isAllLevelsVisible();var h=[];this.createToggleAction(d.DISPLAY_ALL_LEVELS,l,h,j,b,"displayAllLevels");this.createToggleAction(d.DISPLAY_SELECTED_LEVEL,!l,h,j,b,"displaySelectedLevel");this.createAction(d.MODIFY_3D_ATTRIBUTES,j,b,"modifyAttributes");this.createAction(d.CREATE_PHOTO,j,k,"createPhoto");this.createAction(d.CREATE_PHOTOS_AT_POINTS_OF_VIEW,j,k,"createPhotos");this.createAction(d.CREATE_VIDEO,j,k,"createVideo");this.createAction(d.EXPORT_TO_OBJ,j,k,"exportToOBJ")}this.createAction(d.HELP,j,k,"help");this.createAction(d.ABOUT,j,k,"about");var a=new AbstractAction();a.putValue(AbstractAction.NAME,"SHOW_APPLICATION_MENU");a.putValue(ResourceAction.RESOURCE_PREFIX,"SHOW_APPLICATION_MENU");a.putValue(ResourceAction.TOOL_BAR_ICON,"menu.png");var m=this;a.actionPerformed=function(s){s.stopPropagation();s.preventDefault();var r=k.getPlanController().getView().getHTMLElement();var q=document.createEvent("Event");q.initEvent("contextmenu",true,true);q.clientX=m.showApplicationMenuButton.clientX+m.showApplicationMenuButton.clientWidth/2;q.clientY=m.showApplicationMenuButton.clientY+m.showApplicationMenuButton.clientHeight/2;m.showApplicationMenuButton.dispatchEvent(q)};this.getActionMap()["SHOW_APPLICATION_MENU"]=a};HomePane.prototype.createAction=function(c,b,a,h){var f=[];for(var e=4;e<arguments.length;e++){f[e-4]=arguments[e]}try{var g=new ResourceAction(b,HomePane,HomeView.ActionType[c],false,a,h,f);this.getActionMap()[HomeView.ActionType[c]]=g;return g}catch(d){console.error(d)}};HomePane.prototype.createToggleAction=function(b,d,h,f,g,a){var j=[];for(var e=6;e<arguments.length;e++){j[e-6]=arguments[e]}var c=this.createAction.apply(this,[b,f,g,a].concat(j));if(h!=null){h.push(c);c.putValue(ResourceAction.TOGGLE_BUTTON_GROUP,h);c.putValue(AbstractAction.SELECTED_KEY,d);c.addPropertyChangeListener(function(l){if(l.getPropertyName()==AbstractAction.SELECTED_KEY){if(l.getNewValue()){var m=l.getSource().getValue(ResourceAction.TOGGLE_BUTTON_GROUP);for(var k=0;k<m.length;k++){if(c!==m[k]&&m[k].getValue(AbstractAction.SELECTED_KEY)){m[k].putValue(AbstractAction.SELECTED_KEY,false)}}}else{l.getSource().putValue(AbstractAction.SELECTED_KEY,false)}}})}return c};HomePane.prototype.createClipboardAction=function(d,b,c,a){var e=this.createAction(d,b);var f=this;e.actionPerformed=function(g){if(a){f.clipboard=Home.duplicate(f.home.getSelectedItems());f.clipboardEmpty=false;f.controller.enablePasteAction()}switch(d){case HomeView.ActionType.CUT:f.controller.cut(f.home.getSelectedItems());break;case HomeView.ActionType.COPY:break;case HomeView.ActionType.PASTE:f.controller.paste(Home.duplicate(f.clipboard));break}return e}};HomePane.prototype.getMenuAction=function(a){return new ResourceAction(this.preferences,HomePane,HomePane.MenuActionType[a],true)};HomePane.prototype.addHomeListener=function(a){var b=this;a.addPropertyChangeListener("CAMERA",function(c){b.setToggleButtonModelSelected(HomeView.ActionType.VIEW_FROM_TOP,a.getCamera()==a.getTopCamera());b.setToggleButtonModelSelected(HomeView.ActionType.VIEW_FROM_OBSERVER,a.getCamera()==a.getObserverCamera())})};HomePane.prototype.setToggleButtonModelSelected=function(a,b){this.getAction(a).putValue(AbstractAction.SELECTED_KEY,b)};HomePane.prototype.addLevelVisibilityListener=function(a){var b=this;a.getEnvironment().addPropertyChangeListener("ALL_LEVELS_VISIBLE",function(d){var c=a.getEnvironment().isAllLevelsVisible();b.setToggleButtonModelSelected(HomeView.ActionType.DISPLAY_ALL_LEVELS,c);b.setToggleButtonModelSelected(HomeView.ActionType.DISPLAY_SELECTED_LEVEL,!c)})};HomePane.prototype.addUserPreferencesListener=function(a){var b=new HomePane.UserPreferencesChangeListener(this);a.addPropertyChangeListener("CURRENCY",b);a.addPropertyChangeListener("VALUE_ADDED_TAX_ENABLED",b)};HomePane.UserPreferencesChangeListener=function(a){this.homePane=a};HomePane.UserPreferencesChangeListener.prototype.propertyChange=function(b){var e=HomeView.ActionType;var d=this.homePane;var a=b.getSource();var c=b.getPropertyName();if(d==null){a.removePropertyChangeListener(c,this)}else{switch(c){case"CURRENCY":d.getAction(e.DISPLAY_HOME_FURNITURE_PRICE).putValue(ResourceAction.VISIBLE,b.getNewValue()!=null);d.getAction(e.SORT_HOME_FURNITURE_BY_PRICE).putValue(ResourceAction.VISIBLE,b.getNewValue()!=null);break;case"VALUE_ADDED_TAX_ENABLED":d.getAction(e.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);d.getAction(e.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);d.getAction(e.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);d.getAction(e.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);d.getAction(e.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);d.getAction(e.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);break}}};HomePane.prototype.initActions=function(a){this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_CATALOG_ID).putValue(ResourceAction.VISIBLE,false);this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_CATALOG_ID).putValue(ResourceAction.VISIBLE,false);this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE).putValue(ResourceAction.VISIBLE,a.getCurrency()!=null);this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE).putValue(ResourceAction.VISIBLE,a.getCurrency()!=null);this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled());this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled());this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled());this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled());this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled());this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled())};HomePane.prototype.addPlanControllerListener=function(a){var b=this;a.addPropertyChangeListener("MODE",function(c){var d=a.getMode();b.setToggleButtonModelSelected(HomeView.ActionType.SELECT,d==PlanController.Mode.SELECTION);b.setToggleButtonModelSelected(HomeView.ActionType.PAN,d==PlanController.Mode.PANNING);b.setToggleButtonModelSelected(HomeView.ActionType.CREATE_WALLS,d==PlanController.Mode.WALL_CREATION);b.setToggleButtonModelSelected(HomeView.ActionType.CREATE_ROOMS,d==PlanController.Mode.ROOM_CREATION);b.setToggleButtonModelSelected(HomeView.ActionType.CREATE_POLYLINES,d==PlanController.Mode.POLYLINE_CREATION);b.setToggleButtonModelSelected(HomeView.ActionType.CREATE_DIMENSION_LINES,d==PlanController.Mode.DIMENSION_LINE_CREATION);b.setToggleButtonModelSelected(HomeView.ActionType.CREATE_LABELS,d==PlanController.Mode.LABEL_CREATION)})};HomePane.prototype.addActionToMenu=function(a,b){var c=this.getAction(a);if(c!=null&&c.getValue(AbstractAction.NAME)!=null){b.addMenuItem(c)}};HomePane.prototype.createLockUnlockBasePlanButton=function(e,c){var b=this.getAction(HomeView.ActionType.UNLOCK_BASE_PLAN);var d=this.getAction(HomeView.ActionType.LOCK_BASE_PLAN);if(b!=null&&b.getValue(AbstractAction.NAME)!=null&&d.getValue(AbstractAction.NAME)!=null){var a=this.createToolBarButton(e.isBasePlanLocked()?b:d,c);e.addPropertyChangeListener("BASE_PLAN_LOCKED",function(){a.setAction(e.isBasePlanLocked()?b:d)});return a}else{return null}};HomePane.prototype.createEnableDisableMagnetismButton=function(d,c){var e=this.getAction(HomeView.ActionType.DISABLE_MAGNETISM);var b=this.getAction(HomeView.ActionType.ENABLE_MAGNETISM);if(e!==null&&e.getValue(AbstractAction.NAME)!==null&&b.getValue(AbstractAction.NAME)!==null){var a=this.createToolBarButton(d.isMagnetismEnabled()?e:b,c);d.addPropertyChangeListener("MAGNETISM_ENABLED",new HomePane.MagnetismChangeListener(this,a));return a}else{return null}};HomePane.MagnetismChangeListener=function MagnetismChangeListener(b,a){this.enableDisableMagnetismButton=a;this.homePane=b};HomePane.MagnetismChangeListener.prototype.propertyChange=function(b){var d=this.homePane;var a=b.getSource();var c=b.getPropertyName();if(d==null){a.removePropertyChangeListener(c,this)}else{this.enableDisableMagnetismButton.setAction(a.isMagnetismEnabled()?d.getAction(HomeView.ActionType.DISABLE_MAGNETISM):d.getAction(HomeView.ActionType.ENABLE_MAGNETISM))}};HomePane.prototype.createBoldStyleAction=function(c,e,b,a,f){var d=this.createAction(c,b,a,f);e.addSelectionListener({selectionChanged:function(k){var j=null;var l=e.getSelectedItems();for(var h=0;h<l.length;h++){item=l[h];var g;if(item instanceof Label){g=this.isItemTextBold("Label",item.getStyle())}else{if(item instanceof HomePieceOfFurniture&&item.isVisible()){g=this.isItemTextBold("HomePieceOfFurniture",item.getNameStyle())}else{if(item instanceof Room){g=this.isItemTextBold("Room",item.getNameStyle());if(g!=this.isItemTextBold("Room",item.getAreaStyle())){g=null}}else{if(item instanceof DimensionLine){g=this.isItemTextBold("DimensionLine",item.getLengthStyle())}else{continue}}}}if(j==null){j=g}else{if(g==null||j!=g){j=null;break}}}d.putValue(AbstractAction.SELECTED_KEY,j!=null&&j)},isItemTextBold:function(h,g){if(g==null){g=b.getDefaultTextStyle(h)}return g.isBold()}});return d};HomePane.prototype.createItalicStyleToggleModel=function(c,e,b,a,f){var d=this.createAction(c,b,a,f);e.addSelectionListener({selectionChanged:function(k){var h=null;var l=e.getSelectedItems();for(var j=0;j<l.length;j++){item=l[j];var g;if(item instanceof Label){g=this.isItemTextItalic("Label",item.getStyle())}else{if(item instanceof HomePieceOfFurniture&&item.isVisible()){g=this.isItemTextItalic("HomePieceOfFurniture",item.getNameStyle())}else{if(item instanceof Room){g=this.isItemTextItalic("Room",item.getNameStyle());if(g!=this.isItemTextItalic("Room",item.getAreaStyle())){g=null}}else{if(item instanceof DimensionLine){g=this.isItemTextItalic("DimensionLine",item.getLengthStyle())}else{continue}}}}if(h==null){h=g}else{if(g==null||h!=g){h=null;break}}}d.putValue(AbstractAction.SELECTED_KEY,h!=null&&h)},isItemTextItalic:function(h,g){if(g==null){g=b.getDefaultTextStyle(h)}return g.isItalic()}});return d};HomePane.prototype.createToolBar=function(e,d){var c=document.getElementById("home-pane-toolbar");this.addActionToToolBar("SHOW_APPLICATION_MENU",c);this.showApplicationMenuButton=c.children[c.children.length-1].lastChild;this.addSeparator(c);this.addToggleActionToToolBar(HomeView.ActionType.VIEW_FROM_TOP,c);this.addToggleActionToToolBar(HomeView.ActionType.VIEW_FROM_OBSERVER,c);this.addSeparator(c);this.addActionToToolBar(HomeView.ActionType.UNDO,c);this.addActionToToolBar(HomeView.ActionType.REDO,c);this.addSeparator(c);this.addActionToToolBar(HomeView.ActionType.DELETE_SELECTION,c);this.addActionToToolBar(HomeView.ActionType.CUT,c,"toolbar-optional");this.addActionToToolBar(HomeView.ActionType.COPY,c);this.addActionToToolBar(HomeView.ActionType.PASTE,c);this.addSeparator(c);this.addActionToToolBar(HomeView.ActionType.ADD_HOME_FURNITURE,c,"toolbar-optional");this.addSeparator(c);this.addToggleActionToToolBar(HomeView.ActionType.SELECT,c);this.addToggleActionToToolBar(HomeView.ActionType.PAN,c,"toolbar-optional");this.addToggleActionToToolBar(HomeView.ActionType.CREATE_WALLS,c);this.addToggleActionToToolBar(HomeView.ActionType.CREATE_ROOMS,c);this.addToggleActionToToolBar(HomeView.ActionType.CREATE_POLYLINES,c);this.addToggleActionToToolBar(HomeView.ActionType.CREATE_DIMENSION_LINES,c);this.addToggleActionToToolBar(HomeView.ActionType.CREATE_LABELS,c);this.addSeparator(c);var b=this.createEnableDisableMagnetismButton(d);if(b!==null){this.addButtonToToolBar(c,b)}var a=this.createLockUnlockBasePlanButton(e);if(a!==null){this.addButtonToToolBar(c,a)}this.addActionToToolBar(HomeView.ActionType.FLIP_HORIZONTALLY,c);this.addActionToToolBar(HomeView.ActionType.FLIP_VERTICALLY,c);this.addSeparator(c);this.addActionToToolBar(HomeView.ActionType.INCREASE_TEXT_SIZE,c);this.addActionToToolBar(HomeView.ActionType.DECREASE_TEXT_SIZE,c);this.addToggleActionToToolBar(HomeView.ActionType.TOGGLE_BOLD_STYLE,c);this.addToggleActionToToolBar(HomeView.ActionType.TOGGLE_ITALIC_STYLE,c);this.addSeparator(c);this.addActionToToolBar(HomeView.ActionType.ZOOM_IN,c,"toolbar-optional");this.addActionToToolBar(HomeView.ActionType.ZOOM_OUT,c,"toolbar-optional");this.addSeparator(c);this.addActionToToolBar(HomeView.ActionType.PREFERENCES,c);return c};HomePane.prototype.createPopupMenus=function(h,c){var a=HomeView.ActionType;var g=this;var e=this.controller;if(this.showApplicationMenuButton==null||!window.matchMedia("(hover: none), (pointer: coarse)").matches){var b=this.controller.getFurnitureCatalogController().getView();if(b!=null){new JSPopupMenu(this.preferences,b.getHTMLElement(),function(k){g.addActionToMenu(a.ADD_HOME_FURNITURE,k);g.addActionToMenu(a.ADD_FURNITURE_TO_GROUP,k)})}var d=this.controller.getFurnitureController().getView();if(d!=null){new JSPopupMenu(this.preferences,d.getHTMLElement(),function(k){g.addActionToMenu(a.CUT,k);g.addActionToMenu(a.COPY,k);g.addActionToMenu(a.PASTE,k);g.addActionToMenu(a.PASTE_TO_GROUP,k);g.addActionToMenu(a.PASTE_STYLE,k);k.addSeparator();g.addActionToMenu(a.MODIFY_FURNITURE,k);g.addActionToMenu(a.GROUP_FURNITURE,k);g.addActionToMenu(a.UNGROUP_FURNITURE,k);k.addSubMenu(g.getMenuAction(HomePane.MenuActionType.ALIGN_OR_DISTRIBUTE_MENU),function(l){g.addActionToMenu(a.ALIGN_FURNITURE_ON_TOP,l);g.addActionToMenu(a.ALIGN_FURNITURE_ON_BOTTOM,l);g.addActionToMenu(a.ALIGN_FURNITURE_ON_LEFT,l);g.addActionToMenu(a.ALIGN_FURNITURE_ON_RIGHT,l);g.addActionToMenu(a.ALIGN_FURNITURE_ON_FRONT_SIDE,l);g.addActionToMenu(a.ALIGN_FURNITURE_ON_BACK_SIDE,l);g.addActionToMenu(a.ALIGN_FURNITURE_ON_LEFT_SIDE,l);g.addActionToMenu(a.ALIGN_FURNITURE_ON_RIGHT_SIDE,l);g.addActionToMenu(a.ALIGN_FURNITURE_SIDE_BY_SIDE,l);g.addActionToMenu(a.DISTRIBUTE_FURNITURE_HORIZONTALLY,l);g.addActionToMenu(a.DISTRIBUTE_FURNITURE_VERTICALLY,l)});g.addActionToMenu(a.RESET_FURNITURE_ELEVATION,k);k.addSeparator();k.addSubMenu(g.getMenuAction(HomePane.MenuActionType.SORT_HOME_FURNITURE_MENU),function(m){var n=function(o,q){var p=g.getAction(o);if(p&&p.getValue(AbstractAction.NAME)&&p.getValue(ResourceAction.VISIBLE)){m.addRadioButtonItem(p.getValue(AbstractAction.NAME),function(){p.actionPerformed()},q==h.getFurnitureSortedProperty())}};n(a.SORT_HOME_FURNITURE_BY_CATALOG_ID,"CATALOG_ID");n(a.SORT_HOME_FURNITURE_BY_NAME,"NAME");n(a.SORT_HOME_FURNITURE_BY_CREATOR,"CREATOR");n(a.SORT_HOME_FURNITURE_BY_WIDTH,"WIDTH");n(a.SORT_HOME_FURNITURE_BY_DEPTH,"DEPTH");n(a.SORT_HOME_FURNITURE_BY_HEIGHT,"HEIGHT");n(a.SORT_HOME_FURNITURE_BY_X,"X");n(a.SORT_HOME_FURNITURE_BY_Y,"Y");n(a.SORT_HOME_FURNITURE_BY_ELEVATION,"ELEVATION");n(a.SORT_HOME_FURNITURE_BY_ANGLE,"ANGLE");n(a.SORT_HOME_FURNITURE_BY_LEVEL,"LEVEL");n(a.SORT_HOME_FURNITURE_BY_MODEL_SIZE,"MODEL_SIZE");n(a.SORT_HOME_FURNITURE_BY_COLOR,"COLOR");n(a.SORT_HOME_FURNITURE_BY_TEXTURE,"TEXTURE");n(a.SORT_HOME_FURNITURE_BY_MOVABILITY,"MOVABLE");n(a.SORT_HOME_FURNITURE_BY_TYPE,"DOOR_OR_WINDOW");n(a.SORT_HOME_FURNITURE_BY_VISIBILITY,"VISIBLE");n(a.SORT_HOME_FURNITURE_BY_PRICE,"PRICE");n(a.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE,"VALUE_ADDED_TAX_PERCENTAGE");n(a.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX,"VALUE_ADDED_TAX");n(a.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED,"PRICE_VALUE_ADDED_TAX_INCLUDED");m.addSeparator();var l=g.getAction(a.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER);if(l&&l.getValue(AbstractAction.NAME)&&l.getValue(ResourceAction.VISIBLE)){m.addCheckBoxItem(l.getValue(AbstractAction.NAME),function(){l.actionPerformed()},h.isFurnitureDescendingSorted())}});k.addSubMenu(g.getMenuAction(HomePane.MenuActionType.DISPLAY_HOME_FURNITURE_PROPERTY_MENU),function(l){var m=function(n,p){var o=g.getAction(n);if(o&&o.getValue(AbstractAction.NAME)&&o.getValue(ResourceAction.VISIBLE)){l.addCheckBoxItem(o.getValue(AbstractAction.NAME),function(){o.actionPerformed()},h.getFurnitureVisibleProperties().indexOf(p)>-1)}};m(a.DISPLAY_HOME_FURNITURE_CATALOG_ID,"CATALOG_ID");m(a.DISPLAY_HOME_FURNITURE_NAME,"NAME");m(a.DISPLAY_HOME_FURNITURE_CREATOR,"CREATOR");m(a.DISPLAY_HOME_FURNITURE_WIDTH,"WIDTH");m(a.DISPLAY_HOME_FURNITURE_DEPTH,"DEPTH");m(a.DISPLAY_HOME_FURNITURE_HEIGHT,"HEIGHT");m(a.DISPLAY_HOME_FURNITURE_X,"X");m(a.DISPLAY_HOME_FURNITURE_Y,"Y");m(a.DISPLAY_HOME_FURNITURE_ELEVATION,"ELEVATION");m(a.DISPLAY_HOME_FURNITURE_ANGLE,"ANGLE");m(a.DISPLAY_HOME_FURNITURE_LEVEL,"LEVEL");m(a.DISPLAY_HOME_FURNITURE_MODEL_SIZE,"MODEL_SIZE");m(a.DISPLAY_HOME_FURNITURE_COLOR,"COLOR");m(a.DISPLAY_HOME_FURNITURE_TEXTURE,"TEXTURE");m(a.DISPLAY_HOME_FURNITURE_MOVABLE,"MOVABLE");m(a.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW,"DOOR_OR_WINDOW");m(a.DISPLAY_HOME_FURNITURE_VISIBLE,"VISIBLE");m(a.DISPLAY_HOME_FURNITURE_PRICE,"PRICE");m(a.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE,"VALUE_ADDED_TAX_PERCENTAGE");m(a.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX,"VALUE_ADDED_TAX");m(a.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED,"PRICE_VALUE_ADDED_TAX_INCLUDED")})})}var f=this.controller.getPlanController().getView();if(f!=null){new JSPopupMenu(this.preferences,f.getHTMLElement(),function(k){g.addActionToMenu(a.UNDO,k);g.addActionToMenu(a.REDO,k);k.addSeparator();g.addActionToMenu(a.DELETE_SELECTION,k);g.addActionToMenu(a.CUT,k);g.addActionToMenu(a.COPY,k);g.addActionToMenu(a.PASTE,k);g.addActionToMenu(a.PASTE_STYLE,k);k.addSeparator();g.addActionToMenu(a.SELECT_ALL,k);g.addActionToMenu(a.SELECT_ALL_AT_ALL_LEVELS,k);k.addSeparator();g.addActionToMenu(a.MODIFY_FURNITURE,k);g.addActionToMenu(a.GROUP_FURNITURE,k);g.addActionToMenu(a.UNGROUP_FURNITURE,k);g.addActionToMenu(a.RESET_FURNITURE_ELEVATION,k);k.addSeparator();g.addActionToMenu(a.MODIFY_COMPASS,k);g.addActionToMenu(a.MODIFY_WALL,k);g.addActionToMenu(a.JOIN_WALLS,k);g.addActionToMenu(a.REVERSE_WALL_DIRECTION,k);g.addActionToMenu(a.SPLIT_WALL,k);g.addActionToMenu(a.MODIFY_ROOM,k);g.addActionToMenu(a.MODIFY_POLYLINE,k);g.addActionToMenu(a.MODIFY_LABEL,k);k.addSeparator();k.addSubMenu(g.getMenuAction(HomePane.MenuActionType.MODIFY_TEXT_STYLE),function(l){g.addActionToMenu(a.INCREASE_TEXT_SIZE,l);g.addActionToMenu(a.DECREASE_TEXT_SIZE,l);g.addActionToMenu(a.TOGGLE_BOLD_STYLE,l);g.addActionToMenu(a.TOGGLE_ITALIC_STYLE,l)});k.addSeparator();g.addActionToMenu(a.IMPORT_BACKGROUND_IMAGE,k);g.addActionToMenu(a.MODIFY_BACKGROUND_IMAGE,k);g.addActionToMenu(a.HIDE_BACKGROUND_IMAGE,k);g.addActionToMenu(a.SHOW_BACKGROUND_IMAGE,k);g.addActionToMenu(a.DELETE_BACKGROUND_IMAGE,k);k.addSeparator();g.addActionToMenu(a.ADD_LEVEL,k);g.addActionToMenu(a.ADD_LEVEL_AT_SAME_ELEVATION,k);g.addActionToMenu(a.MODIFY_LEVEL,k);g.addActionToMenu(a.DELETE_LEVEL,k)})}var j=this.controller.getHomeController3D().getView();if(j!=null){new JSPopupMenu(this.preferences,j.getHTMLElement(),function(k){g.addActionToMenu(a.VIEW_FROM_TOP,k);g.addActionToMenu(a.VIEW_FROM_OBSERVER,k);g.addActionToMenu(a.MODIFY_OBSERVER,k);g.addActionToMenu(a.STORE_POINT_OF_VIEW,k);var l=h.getStoredCameras();if(l.length>0){var m=g.getMenuAction(HomePane.MenuActionType.GO_TO_POINT_OF_VIEW);if(m.getValue(AbstractAction.NAME)!=null){k.addSubMenu(m,function(n){var p=function(r){n.addMenuItem(r.getName(),function(){e.getHomeController3D().goToCamera(r)})};var o=h.getStoredCameras();for(var q=0;q<o.length;q++){p(o[q])}})}g.addActionToMenu(a.DELETE_POINTS_OF_VIEW,k)}k.addSeparator();g.addActionToMenu(a.DISPLAY_ALL_LEVELS,k);g.addActionToMenu(a.DISPLAY_SELECTED_LEVEL,k);g.addActionToMenu(a.MODIFY_3D_ATTRIBUTES,k)})}}else{new JSPopupMenu(this.preferences,this.showApplicationMenuButton,function(k){g.addActionToMenu(a.DELETE_SELECTION,k);g.addActionToMenu(a.CUT,k);g.addActionToMenu(a.COPY,k);g.addActionToMenu(a.PASTE,k);g.addActionToMenu(a.PASTE_TO_GROUP,k);g.addActionToMenu(a.PASTE_STYLE,k);k.addSeparator();g.addActionToMenu(a.SELECT_ALL,k);g.addActionToMenu(a.SELECT_ALL_AT_ALL_LEVELS,k);k.addSeparator();g.addActionToMenu(a.ADD_HOME_FURNITURE,k);g.addActionToMenu(a.ADD_FURNITURE_TO_GROUP,k);k.addSeparator();g.addActionToMenu(a.MODIFY_FURNITURE,k);g.addActionToMenu(a.GROUP_FURNITURE,k);g.addActionToMenu(a.UNGROUP_FURNITURE,k);k.addSubMenu(g.getMenuAction(HomePane.MenuActionType.ALIGN_OR_DISTRIBUTE_MENU),function(n){g.addActionToMenu(a.ALIGN_FURNITURE_ON_TOP,n);g.addActionToMenu(a.ALIGN_FURNITURE_ON_BOTTOM,n);g.addActionToMenu(a.ALIGN_FURNITURE_ON_LEFT,n);g.addActionToMenu(a.ALIGN_FURNITURE_ON_RIGHT,n);g.addActionToMenu(a.ALIGN_FURNITURE_ON_FRONT_SIDE,n);g.addActionToMenu(a.ALIGN_FURNITURE_ON_BACK_SIDE,n);g.addActionToMenu(a.ALIGN_FURNITURE_ON_LEFT_SIDE,n);g.addActionToMenu(a.ALIGN_FURNITURE_ON_RIGHT_SIDE,n);g.addActionToMenu(a.ALIGN_FURNITURE_SIDE_BY_SIDE,n);g.addActionToMenu(a.DISTRIBUTE_FURNITURE_HORIZONTALLY,n);g.addActionToMenu(a.DISTRIBUTE_FURNITURE_VERTICALLY,n)});g.addActionToMenu(a.RESET_FURNITURE_ELEVATION,k);k.addSeparator();g.addActionToMenu(a.MODIFY_COMPASS,k);g.addActionToMenu(a.MODIFY_WALL,k);g.addActionToMenu(a.JOIN_WALLS,k);g.addActionToMenu(a.REVERSE_WALL_DIRECTION,k);g.addActionToMenu(a.SPLIT_WALL,k);g.addActionToMenu(a.MODIFY_ROOM,k);g.addActionToMenu(a.MODIFY_POLYLINE,k);g.addActionToMenu(a.MODIFY_LABEL,k);k.addSeparator();g.addActionToMenu(a.IMPORT_BACKGROUND_IMAGE,k);g.addActionToMenu(a.MODIFY_BACKGROUND_IMAGE,k);g.addActionToMenu(a.HIDE_BACKGROUND_IMAGE,k);g.addActionToMenu(a.SHOW_BACKGROUND_IMAGE,k);g.addActionToMenu(a.DELETE_BACKGROUND_IMAGE,k);k.addSeparator();g.addActionToMenu(a.ADD_LEVEL,k);g.addActionToMenu(a.ADD_LEVEL_AT_SAME_ELEVATION,k);g.addActionToMenu(a.MODIFY_LEVEL,k);g.addActionToMenu(a.DELETE_LEVEL,k);k.addSeparator();g.addActionToMenu(a.MODIFY_OBSERVER,k);g.addActionToMenu(a.STORE_POINT_OF_VIEW,k);var l=h.getStoredCameras();if(l.length>0){var m=g.getMenuAction(HomePane.MenuActionType.GO_TO_POINT_OF_VIEW);if(m.getValue(AbstractAction.NAME)!=null){k.addSubMenu(m,function(n){var p=function(r){n.addMenuItem(r.getName(),function(){e.getHomeController3D().goToCamera(r)})};var o=h.getStoredCameras();for(var q=0;q<o.length;q++){p(o[q])}})}g.addActionToMenu(a.DELETE_POINTS_OF_VIEW,k)}k.addSeparator();g.addActionToMenu(a.DISPLAY_ALL_LEVELS,k);g.addActionToMenu(a.DISPLAY_SELECTED_LEVEL,k);g.addActionToMenu(a.MODIFY_3D_ATTRIBUTES,k)})}};HomePane.prototype.initSplitters=function(){var g=this.home;var d=this.controller;var b=d.getFurnitureCatalogController().getView();var c=d.getFurnitureController().getView();var f=d.getPlanController().getView();var h=d.getHomeController3D().getView();var a=document.getElementById("furniture-plan-splitter");var e=document.getElementById("plan-3D-view-splitter");var j=document.getElementById("catalog-furniture-splitter");this.furniturePlanSplitter={element:a,homePropertyName:HomePane.MAIN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,firstGroupElement:document.getElementById("catalog-furniture-pane"),secondGroupElement:document.getElementById("plan-3D-view-pane"),isDisplayed:function(){return a&&a.clientWidth>0},resizeListener:function(k){f.revalidate();h.revalidate()}};this.plan3DViewSplitter={element:e,homePropertyName:HomePane.PLAN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,firstGroupElement:f.getHTMLElement(),secondGroupElement:h.getHTMLElement(),isDisplayed:function(){return e&&e.clientWidth>0&&f!=null&&h!=null},resizeListener:function(k){f.revalidate();h.revalidate()}};this.catalogFurnitureSplitter={element:j,homePropertyName:HomePane.CATALOG_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,firstGroupElement:b.getHTMLElement(),secondGroupElement:c.getHTMLElement(),isDisplayed:function(){return j&&j.clientWidth>0&&b!=null&&c!=null}};this.updateSplitters()};HomePane.prototype.updateSplitters=function(){var a=this.controller.getPlanController().getView();var c=this.controller.getHomeController3D().getView();var b=this.controller.getFurnitureCatalogController().getView();if(b!==null&&b.getHTMLElement().getBoundingClientRect().top>c.getHTMLElement().getBoundingClientRect().top+10){this.plan3DViewSplitter.firstGroupElement=c.getHTMLElement();this.plan3DViewSplitter.secondGroupElement=a.getHTMLElement()}else{this.plan3DViewSplitter.firstGroupElement=a.getHTMLElement();this.plan3DViewSplitter.secondGroupElement=c.getHTMLElement()}this.updateSplitter(this.plan3DViewSplitter);this.updateSplitter(this.furniturePlanSplitter);this.updateSplitter(this.catalogFurnitureSplitter)};HomePane.prototype.updateSplitter=function(c){c.element.style.display="";c.element.style.top="";c.element.style.left="";c.firstGroupElement.style.left="";c.firstGroupElement.style.top="";c.firstGroupElement.style.width="";c.firstGroupElement.style.height="";c.secondGroupElement.style.left="";c.secondGroupElement.style.top="";c.secondGroupElement.style.width="";c.secondGroupElement.style.height="";var g=c.isDisplayed();if(g){c.element.style.display="block"}else{c.element.style.display="none"}if(c.mouseListener!==undefined&&c.mouseListener.mousePressed){c.element.removeEventListener("mousedown",c.mouseListener.mousePressed,true);c.element.removeEventListener("touchstart",c.mouseListener.mousePressed,true);window.removeEventListener("resize",c.mouseListener.windowResized)}c.element.classList.remove("horizontal");c.element.classList.remove("vertical");var d=c.element.clientWidth>c.element.clientHeight;if(d){c.element.classList.add("horizontal")}else{c.element.classList.add("vertical")}var h=this.home.getNumericProperty(c.homePropertyName);var a=d?"top":"left";var f=d?"height":"width";var m=d?"clientHeight":"clientWidth";var e=d?"clientY":"clientX";var b=c.firstGroupElement.offsetParent;var k=d?"offsetTop":"offsetLeft";var l=b==document.body?c.firstGroupElement[k]-b[k]:0;var j=this;var n={getSplitterPosition:function(p){var o=p.touches&&p.touches.length>0?p.touches[0]:p;return o[e]-b[k]},setSplitterPosition:function(o){if(o<l){o=l}if(o>b[m]-c.element[m]){o=b[m]-c.element[m]}c.firstGroupElement.style[f]=(o-l)+"px";c.element.style[a]=o+"px";c.secondGroupElement.style[a]=(o+c.element[m])+"px";c.secondGroupElement.style[f]="calc(100% - "+(o+c.element[m])+"px)"},mouseDragged:function(o){o.stopImmediatePropagation();n.currentPosition=n.getSplitterPosition(o);n.setSplitterPosition(n.currentPosition);if(c.resizeListener!==undefined){c.resizeListener(n.currentPosition)}},mousePressed:function(o){o.preventDefault();o.stopImmediatePropagation();n.currentPosition=n.getSplitterPosition(o);c.element.classList.add("moving");window.addEventListener("mousemove",n.mouseDragged,true);window.addEventListener("touchmove",n.mouseDragged,true);window.addEventListener("mouseup",n.windowMouseReleased,true);window.addEventListener("touchend",n.windowMouseReleased,true)},windowMouseReleased:function(o){o.stopImmediatePropagation();c.element.classList.remove("moving");window.removeEventListener("mousemove",n.mouseDragged,true);window.removeEventListener("touchmove",n.mouseDragged,true);window.removeEventListener("mouseup",n.windowMouseReleased,true);window.removeEventListener("touchend",n.windowMouseReleased,true);j.controller.setHomeProperty(c.homePropertyName,n.currentPosition==null?null:n.currentPosition.toString());if(c.resizeListener!==undefined){c.resizeListener(n.currentPosition)}},windowResized:function(p){var o=window.getComputedStyle(c.element)[a];o=o.substring(0,o.length-2);if(o>b[m]-c.element[m]){n.setSplitterPosition(b[m]-c.element[m])}}};if(h!=null){if(g){n.setSplitterPosition(h)}if(c.resizeListener!==undefined){c.resizeListener(h)}}c.element.addEventListener("mousedown",n.mousePressed,true);c.element.addEventListener("touchstart",n.mousePressed,true);window.addEventListener("resize",n.windowResized);c.mouseListener=n};HomePane.prototype.addOrientationChangeListener=function(){var b=this;var a=function(d){var c=b.controller.getPlanController().getView();var f=b.controller.getHomeController3D().getView();if(c!=null&&f!=null){var e=document.getElementById("plan-3D-view-splitter");e.removeAttribute("style");c.getHTMLElement().removeAttribute("style");f.getHTMLElement().removeAttribute("style");c.revalidate();f.revalidate()}setTimeout(function(){b.updateSplitters()},100)};window.addEventListener("resize",function(c){if(window.matchMedia("(hover: none), (pointer: coarse)").matches){a(c)}})};HomePane.prototype.startToolBarButtonGroup=function(b){var a=document.createElement("span");b.appendChild(a);a.classList.add("toolbar-button-group")};HomePane.prototype.addButtonToToolBar=function(a,b){if(a.children.length===0){this.startToolBarButtonGroup(a)}a.children[a.children.length-1].appendChild(b)};HomePane.prototype.addToggleActionToToolBar=function(c,b,a){var e=this.getAction(c);if(e.getValue(AbstractAction.NAME)!=null){var d=this.createToolBarButton(e,a);if(e.getValue(AbstractAction.SELECTED_KEY)){d.classList.add("selected")}e.addPropertyChangeListener(function(f){if(f.getPropertyName()==AbstractAction.SELECTED_KEY){if(f.getNewValue()){d.classList.add("selected")}else{d.classList.remove("selected")}}});d.addEventListener("click",function(){var f=e.getValue(ResourceAction.TOGGLE_BUTTON_GROUP);e.putValue(AbstractAction.SELECTED_KEY,f?true:!e.getValue(AbstractAction.SELECTED_KEY))});this.addButtonToToolBar(b,d)}};HomePane.prototype.addActionToToolBar=function(c,b,a){var d=this.getAction(c);if(d.getValue(AbstractAction.NAME)!=null){this.addButtonToToolBar(b,this.createToolBarButton(d,a))}};HomePane.prototype.createToolBarButton=function(d,a){var b=document.createElement("button");b.id="toolbar-button-"+d.getValue(ResourceAction.RESOURCE_PREFIX);b.disabled=!d.isEnabled();b.tabIndex=-1;b.setAction=function(g){b.action=g;var e=g.getValue(ResourceAction.TOOL_BAR_ICON);if(!e){e=g.getValue(AbstractAction.SMALL_ICON)}b.style.backgroundImage="url('"+ZIPTools.getScriptFolder()+"/"+e+"')";b.style.backgroundPosition="center";b.style.backgroundRepeat="no-repeat";var f=g.getValue(AbstractAction.SHORT_DESCRIPTION);if(f){b.title=f}};b.setAction(d);b.classList.add("toolbar-button");if(d.getValue(ResourceAction.TOGGLE_BUTTON_GROUP)){b.classList.add("toggle")}b.action=d;b.addEventListener("click",function(e){this.action.actionPerformed(e)});var c={propertyChange:function(e){if(e.getPropertyName()=="enabled"){b.disabled=!e.getNewValue()}else{if(e.getPropertyName()==AbstractAction.SHORT_DESCRIPTION){b.title=e.getNewValue()}}}};d.addPropertyChangeListener(c);if(a){b.classList.add(a)}return b};HomePane.prototype.addSeparator=function(a){this.startToolBarButtonGroup(a)};HomePane.prototype.setEnabled=function(b,a){var c=this.getAction(b);if(c!=null){c.setEnabled(a)}};HomePane.prototype.setUndoRedoName=function(b,a){this.setNameAndShortDescription(HomeView.ActionType.UNDO,b!=null?b.replace(/^Undo/,this.preferences.getLocalizedString("AbstractUndoableEdit","undo.textAndMnemonic")):null);this.setNameAndShortDescription(HomeView.ActionType.REDO,a!=null?a.replace(/^Redo/,this.preferences.getLocalizedString("AbstractUndoableEdit","redo.textAndMnemonic")):null)};HomePane.prototype.setNameAndShortDescription=function(b,a){var c=this.getAction(b);if(c!=null){if(a==null){a=c.getValue(AbstractAction.DEFAULT)}c.putValue(AbstractAction.NAME,a);c.putValue(AbstractAction.SHORT_DESCRIPTION,a)}};HomePane.prototype.setTransferEnabled=function(c){var e=this.controller.getFurnitureCatalogController().getView();var b=this.controller.getFurnitureController().getView();var a=this.controller.getPlanController().getView();if(c){if(e!=null){if(this.furnitureCatalogDragAndDropListener==null){this.furnitureCatalogDragAndDropListener=this.createFurnitureCatalogMouseListener()}var d=e.getHTMLElement().querySelectorAll(".furniture");if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){for(i=0;i<d.length;i++){d[i].addEventListener("pointerdown",this.furnitureCatalogDragAndDropListener.pointerPressed)}e.getHTMLElement().addEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed);window.addEventListener("pointermove",this.furnitureCatalogDragAndDropListener.windowPointerMoved);window.addEventListener("pointerup",this.furnitureCatalogDragAndDropListener.windowPointerReleased)}else{for(i=0;i<d.length;i++){d[i].addEventListener("touchstart",this.furnitureCatalogDragAndDropListener.mousePressed)}window.addEventListener("touchmove",this.furnitureCatalogDragAndDropListener.mouseDragged);window.addEventListener("touchend",this.furnitureCatalogDragAndDropListener.windowMouseReleased);e.getHTMLElement().addEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed);window.addEventListener("mousemove",this.furnitureCatalogDragAndDropListener.mouseDragged);window.addEventListener("mouseup",this.furnitureCatalogDragAndDropListener.windowMouseReleased)}e.getHTMLElement().addEventListener("contextmenu",this.furnitureCatalogDragAndDropListener.contextMenuDisplayed)}}else{if(e!=null){var d=e.getHTMLElement().querySelectorAll(".furniture");if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){for(i=0;i<d.length;i++){d[i].removeEventListener("pointerdown",this.furnitureCatalogDragAndDropListener.pointerPressed)}e.getHTMLElement().removeEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed);window.removeEventListener("pointermove",this.furnitureCatalogDragAndDropListener.windowPointerMoved);window.removeEventListener("pointerup",this.furnitureCatalogDragAndDropListener.windowPointerReleased)}else{for(i=0;i<d.length;i++){d[i].removeEventListener("touchstart",this.furnitureCatalogDragAndDropListener.mousePressed)}window.removeEventListener("touchmove",this.furnitureCatalogDragAndDropListener.mouseDragged);window.removeEventListener("touchend",this.furnitureCatalogDragAndDropListener.windowMouseReleased);e.getHTMLElement().removeEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed);window.removeEventListener("mousemove",this.furnitureCatalogDragAndDropListener.mouseDragged);window.removeEventListener("mouseup",this.furnitureCatalogDragAndDropListener.windowMouseReleased)}e.getHTMLElement().removeEventListener("contextmenu",this.furnitureCatalogDragAndDropListener.contextMenuDisplayed)}}this.transferHandlerEnabled=c};HomePane.prototype.createFurnitureCatalogMouseListener=function(){var c=this;var b={selectedPiece:null,previousCursor:null,previousView:null,escaped:false,draggedImage:null,pointerTouches:{},actionStartedInFurnitureCatalog:false,contextMenuEventType:false,mousePressed:function(e){if(!b.contextMenuEventType&&(e.button===0||e.targetTouches)){if(!e.target.classList.contains("selected")){return}e.preventDefault();e.stopPropagation();var d=c.controller.getFurnitureCatalogController().getSelectedFurniture();if(d.length>0){b.selectedPiece=d[0];b.previousCursor=null;b.previousView=null;b.escaped=false;c.inputMap.ESCAPE="EscapeDragFromFurnitureCatalog"}b.actionStartedInFurnitureCatalog=true}},mouseDragged:function(k){if(!b.contextMenuEventType&&b.actionStartedInFurnitureCatalog&&((k.buttons&1)==1||k.targetTouches)&&b.selectedPiece!=null){k.preventDefault();k.stopPropagation();if(!b.escaped){if(b.draggedImage==null){var f=document.createElement("img");var e=c.controller.getFurnitureCatalogController().getView().getHTMLElement().querySelector(".furniture.selected .furniture-icon");f.src=e.src;var d=window.getComputedStyle(e);f.style.width=d.width;f.style.height=d.height;f.style.position="absolute";f.style.opacity=0.6;f.style.zIndex=4;b.draggedImage=f;document.body.appendChild(f)}b.draggedImage.style.left=b.getCoordinates(k).clientX+"px";b.draggedImage.style.top=b.getCoordinates(k).clientY+"px"}var m=c.home.getSelectedLevel();if(m==null||m.isViewable()){var g=[c.controller.getFurnitureController().createHomePieceOfFurniture(b.selectedPiece)];var l;var h=b.getPointInPlanView(k,g);if(h!=null){l=c.controller.getPlanController().getView()}else{l=c.controller.getFurnitureController().getView();h=b.getPointInFurnitureView(k)}if(b.previousView!=l){if(b.previousView!=null){if(b.previousView==c.controller.getPlanController().getView()&&!b.escaped){c.controller.getPlanController().stopDraggedItems()}var j=b.previousView;if(l&&typeof l.setCursor==="function"){l.setCursor(b.previousCursor)}b.previousCursor=null;b.previousView=null}if(l!=null){var j=l;b.previousCursor="default";b.previousView=l;if(!b.escaped){if(typeof l.setCursor==="function"){l.setCursor("copy")}if(l===c.controller.getPlanController().getView()){c.controller.getPlanController().startDraggedItems(g,h[0],h[1])}}}}else{if(h!=null){c.controller.getPlanController().moveMouse(h[0],h[1])}}}}},getPointInPlanView:function(g,e){var d=c.controller.getPlanController().getView();if(d!=null){var f=d.getHTMLElement().getBoundingClientRect();var h=b.getCoordinates(g);if(h.clientX>=f.left&&h.clientX<f.left+f.width&&h.clientY>=f.top&&h.clientY<f.top+f.height){return[d.convertXPixelToModel(h.clientX-f.left),d.convertYPixelToModel(h.clientY-f.top)]}}return null},getCoordinates:function(d){if(d.targetTouches){if(d.targetTouches.length===1){return{clientX:d.targetTouches[0].clientX,clientY:d.targetTouches[0].clientY}}else{if(d.targetTouches.length===0&&d.changedTouches.length===1){return{clientX:d.changedTouches[0].clientX,clientY:d.changedTouches[0].clientY}}}}return d},getPointInFurnitureView:function(f){var d=c.controller.getFurnitureController().getView();if(d!=null){var e=d.getHTMLElement().getBoundingClientRect();var g=b.getCoordinates(f);if(g.clientX>=e.left&&g.clientX<e.left+e.width&&g.clientY>=e.top&&g.clientY<e.top+e.height){return[0,0]}}return null},contextMenuDisplayed:function(d){b.contextMenuEventType=true},windowMouseReleased:function(f){if(b.draggedImage!=null){document.body.removeChild(b.draggedImage);b.draggedImage=null}if(!b.contextMenuEventType&&b.actionStartedInFurnitureCatalog){if((f.button===0||f.targetTouches)&&b.selectedPiece!=null){f.preventDefault();if(!b.escaped){var g=c.home.getSelectedLevel();if(g==null||g.isViewable()){var e=[c.controller.getFurnitureController().createHomePieceOfFurniture(b.selectedPiece)];var d;var h=b.getPointInPlanView(f,e);if(h!=null){c.controller.getPlanController().stopDraggedItems();d=c.controller.getPlanController().getView()}if(h!=null){c.controller.drop(e,d,h[0],h[1]);var d=b.previousView;if(d&&typeof d.setCursor==="function"){d.setCursor(this.previousCursor)}}}}}}b.selectedPiece=null;b.actionStartedInFurnitureCatalog=false;b.contextMenuEventType=false;delete c.inputMap.ESCAPE},pointerPressed:function(d){if(d.pointerType!="mouse"){b.copyPointerToTargetTouches(d);return}b.mousePressed(d)},windowPointerMoved:function(d){if(d.pointerType!="mouse"){b.copyPointerToTargetTouches(d);return}b.mouseDragged(d)},windowPointerReleased:function(d){if(d.pointerType!="mouse"){delete b.pointerTouches[d.pointerId];return}b.windowMouseReleased(d)},copyPointerToTargetTouches:function(e){b.pointerTouches[e.pointerId]={clientX:e.clientX,clientY:e.clientY};e.targetTouches=[];for(var d in b.pointerTouches){if(b.pointerTouches.hasOwnProperty(d)){e.targetTouches.push(b.pointerTouches[d])}}}};var a=new AbstractAction();a.actionPerformed=function(){if(!b.escaped){if(b.previousView!=null){if(b.previousView===c.controller.getPlanController().getView()){c.controller.getPlanController().stopDraggedItems()}if(b.previousCursor!=null&&typeof b.previousView.setCursor==="function"){b.previousView.setCursor(b.previousCursor)}}b.escaped=true;if(b.draggedImage!=null){document.body.removeChild(b.draggedImage);b.draggedImage=null}}};this.getActionMap()["EscapeDragFromFurnitureCatalog"]=a;return b};HomePane.prototype.detachView=function(a){};HomePane.prototype.attachView=function(a){};HomePane.prototype.showOpenDialog=function(){};HomePane.prototype.showNewHomeFromExampleDialog=function(){};HomePane.prototype.confirmOpenDamagedHome=function(a,c,b){return true};HomePane.prototype.showImportLanguageLibraryDialog=function(){};HomePane.prototype.confirmReplaceLanguageLibrary=function(a){return true};HomePane.prototype.showImportFurnitureLibraryDialog=function(){};HomePane.prototype.confirmReplaceFurnitureLibrary=function(a){return true};HomePane.prototype.showImportTexturesLibraryDialog=function(){};HomePane.prototype.confirmReplaceTexturesLibrary=function(a){return true};HomePane.prototype.confirmReplacePlugin=function(a){return true};HomePane.prototype.showSaveDialog=function(a){return null};HomePane.prototype.showError=function(a){alert(a)};HomePane.prototype.showMessage=function(a){alert(a)};HomePane.prototype.showActionTipMessage=function(a){return false};HomePane.prototype.confirmSave=function(a){return HomeView.SaveAnswer.CANCEL};HomePane.prototype.confirmSaveNewerHome=function(a){return false};HomePane.prototype.confirmExit=function(){return true};HomePane.prototype.showAboutDialog=function(){};HomePane.prototype.showUpdatesMessage=function(b,a){return false};HomePane.prototype.showPrintDialog=function(){return null};HomePane.prototype.showPrintToPDFDialog=function(a){return null};HomePane.prototype.printToPDF=function(a){};HomePane.prototype.showExportToCSVDialog=function(a){return null};HomePane.prototype.exportToCSV=function(a){};HomePane.prototype.showExportToSVGDialog=function(a){return null};HomePane.prototype.exportToSVG=function(a){};HomePane.prototype.showExportToOBJDialog=function(a){return null};HomePane.prototype.exportToOBJ=function(b,a){};HomePane.prototype.confirmDeleteCatalogSelection=function(){return true};HomePane.prototype.showStoreCameraDialog=function(a){return prompt(this.preferences.getLocalizedString("HomePane","showStoreCameraDialog.message"),a)};HomePane.prototype.showDeletedCamerasDialog=function(){var g=this;var a=this.home.getStoredCameras();function f(){JSDialog.call(this,g.preferences,"@{HomePane.showDeletedCamerasDialog.title}","<div>@{HomePane.confirmDeleteCameras.message}</div>",{applier:function(l){g.controller.getHomeController3D().deleteCameras(l.selectedCameras)}});var h=this;var k=this.findElement(".dialog-cancel-button");this.registerEventListener(k,"click",function(l){h.cancel()});var j=this.findElements(".dialog-ok-button");this.registerEventListener(j,"click",function(l){h.validate()})}f.prototype=Object.create(JSDialog.prototype);f.prototype.constructor=f;f.prototype.appendButtons=function(h){h.innerHTML=JSComponent.substituteWithLocale(this.preferences,"<button class='dialog-cancel-button'>@{HomePane.confirmDeleteCameras.cancel}</button><button class='dialog-ok-button'>@{HomePane.confirmDeleteCameras.delete}</button>")};var d="<div>@{HomePane.showDeletedCamerasDialog.message}</div><br />";for(var c=0;c<a.length;c++){d+="<div><label><input type='checkbox' value='"+c+"' />"+a[c].getName()+"</label></div>"}function e(){JSDialog.call(this,g.preferences,"@{HomePane.showDeletedCamerasDialog.title}",d,{applier:function(k){var n=k.findElements("input[type='checkbox']:checked");var o=[];for(var j=0;j<n.length;j++){var h=parseInt(n[j].value);var l=a[h];o.push(l)}if(o.length>0){var m=new f();m.selectedCameras=o;m.displayView()}}})}e.prototype=Object.create(JSDialog.prototype);e.prototype.constructor=e;var b=new e();b.displayView();return null};HomePane.prototype.isClipboardEmpty=function(){return this.clipboardEmpty};HomePane.prototype.getClipboardItems=function(){return this.clipboard};HomePane.prototype.invokeLater=function(a){setTimeout(a)};function DefaultFurnitureCatalog(a,c,b){FurnitureCatalog.call(this);this.libraries=[];var g=[];if(c===undefined){this.readDefaultFurnitureCatalogs(a,g)}else{b=c;c=a;if(c!=null){for(var d=0;d<c.length;d++){var f=c[d];var e=CoreTools.loadResourceBundles(f.substring(0,f.lastIndexOf(".json")),Locale.getDefault());this.readFurniture(e,f,b,g)}}}}DefaultFurnitureCatalog.prototype=Object.create(FurnitureCatalog.prototype);DefaultFurnitureCatalog.prototype.constructor=DefaultFurnitureCatalog;DefaultFurnitureCatalog.__class="com.eteks.sweethome3d.io.DefaultFurnitureCatalog";DefaultFurnitureCatalog.furnitureAdditionalKeys={};DefaultFurnitureCatalog.prototype.getLibraries=function(){return this.libraries.slice(0)};DefaultFurnitureCatalog.prototype.readDefaultFurnitureCatalogs=function(a,b){this.readFurnitureCatalog("DefaultFurnitureCatalog",a,b)};DefaultFurnitureCatalog.prototype.readFurnitureCatalog=function(b,a,c){this.readFurniture(a.getResourceBundles(b),null,null,c)};DefaultFurnitureCatalog.prototype.readFurniture=function(c,h,e,d){var f=0;while(true){var b=0;try{b=CoreTools.getStringFromKey(c,this.getKey("ignored",++f))}catch(g){b=null}if(b==null||!this.parseBoolean(b)){var j=b==null?this.readPieceOfFurniture(c,f,h,e):null;if(j==null){break}else{if(j.getId()!=null){if(d.indexOf(j.getId())!==-1){continue}else{d.push(j.getId())}}var a=this.readFurnitureCategory(c,f);this.add(a,j)}}}};DefaultFurnitureCatalog.prototype.getAdditionalProperties=function(b,h){var d=CoreTools.getFromMap(DefaultFurnitureCatalog.furnitureAdditionalKeys,b);if(d==null){d={};CoreTools.putToMap(DefaultFurnitureCatalog.furnitureAdditionalKeys,b,d);var o=CoreTools.getKeys(b);for(var g=0;g<o.length;g++){var n=o[g];var f=n.lastIndexOf("#");if(f!==-1&&f+1<n.length){try{var c=parseInt(n.substring(f+1));var e=n.substring(0,f);if(!this.isDefaultProperty(e)){var a=d[c.toString()];if(a==null){a=[];d[c.toString()]=a}a.push(e)}}catch(k){}}}}var m=d[h.toString()];if(m!=null){var j=null;var l=Object.getOwnPropertyNames(m).length-1;if(l===1){var n=m["0"];j={};j[n]=CoreTools.getStringFromKey(b,this.getKey(n,h))}else{j={};for(var g=0;g<l;g++){var n=m[g.toString()];j[n]=CoreTools.getStringFromKey(b,this.getKey(n,h))}}return j}else{return{}}};DefaultFurnitureCatalog.prototype.isDefaultProperty=function(b){try{DefaultFurnitureCatalog.PropertyKey.fromPrefix(b);return true}catch(a){return"ignored"==b}};DefaultFurnitureCatalog.prototype.readPieceOfFurniture=function(B,D,d,c){var t=null;try{t=CoreTools.getStringFromKey(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.NAME,D))}catch(L){return null}var E=this.getOptionalString(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.ID,D),null);var u=this.getOptionalString(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.DESCRIPTION,D),null);var S=this.getOptionalString(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.INFORMATION,D),null);var z=this.getOptionalString(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.TAGS,D),null);var A;if(z!=null){A=z.split(/\s*,\s*/)}else{A=[]}var n=this.getOptionalString(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.CREATION_DATE,D),null);var H=null;if(n!=null){try{var q=n.split(/-/);H=new Date(q[0],q[1],q[2]).getTime()}catch(L){throw new IllegalArgumentException("Can't parse date "+n,L)}}var O=this.getOptionalString(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.GRADE,D),null);var F=null;if(O!=null){F=parseFloat(O)}var p=this.getContent(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.ICON,D),this.getKey(DefaultFurnitureCatalog.PropertyKey.ICON_DIGEST,D),d,c,false,false);var j=this.getContent(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.PLAN_ICON,D),this.getKey(DefaultFurnitureCatalog.PropertyKey.PLAN_ICON_DIGEST,D),d,c,false,true);var P=this.getOptionalBoolean(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.MULTI_PART_MODEL,D),false);var f=this.getContent(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL,D),this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_DIGEST,D),d,c,P,false);var a=parseFloat(CoreTools.getStringFromKey(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.WIDTH,D)));var m=parseFloat(CoreTools.getStringFromKey(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.DEPTH,D)));var e=parseFloat(CoreTools.getStringFromKey(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.HEIGHT,D)));var l=this.getOptionalFloat(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.ELEVATION,D),0);var g=this.getOptionalFloat(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.DROP_ON_TOP_ELEVATION,D),e)/e;var x=this.parseBoolean(CoreTools.getStringFromKey(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.MOVABLE,D)));var G=this.parseBoolean(CoreTools.getStringFromKey(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW,D)));var J=this.getOptionalString(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.STAIRCASE_CUT_OUT_SHAPE,D),null);var T=this.getModelRotation(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_ROTATION,D));var R=this.getOptionalString(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_SIZE,D),null);var V=null;if(R!=null){V=parseInt(R)}var w=this.getOptionalString(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.CREATOR,D),null);var I=this.getOptionalBoolean(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.RESIZABLE,D),true);var o=this.getOptionalBoolean(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.DEFORMABLE,D),true);var k=this.getOptionalBoolean(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.TEXTURABLE,D),true);var s=this.getOptionalBoolean(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.HORIZONTALLY_ROTATABLE,D),true);var C=null;try{C=new Big(CoreTools.getStringFromKey(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.PRICE,D)))}catch(L){}var h=null;try{h=new Big(CoreTools.getStringFromKey(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.VALUE_ADDED_TAX_PERCENTAGE,D)))}catch(L){}var Q=this.getOptionalString(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.CURRENCY,D),null);var b=this.getAdditionalProperties(B,D);if(G){var U=this.getOptionalString(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_CUT_OUT_SHAPE,D),null);var K=this.getOptionalFloat(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WALL_THICKNESS,D),m)/m;var r=this.getOptionalFloat(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WALL_DISTANCE,D),0)/m;var v=this.getOptionalBoolean(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WALL_CUT_OUT_ON_BOTH_SIDES,D),true);var M=this.getOptionalBoolean(B,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WIDTH_DEPTH_DEFORMABLE,D),true);var N=this.getDoorOrWindowSashes(B,D,a,m);return new CatalogDoorOrWindow(E,t,u,S,A,H,F,p,j,f,a,m,e,l,g,x,U,K,r,v,M,N,T,false,V,w,I,o,k,C,h,Q,b)}else{var y=this.getLightSources(B,D,a,m,e);if(y!=null){return new CatalogLight(E,t,u,S,A,H,F,p,j,f,a,m,e,l,g,x,y,J,T,false,V,w,I,o,k,s,C,h,Q,b)}else{return new CatalogPieceOfFurniture(E,t,u,S,A,H,F,p,j,f,a,m,e,l,g,x,J,T,false,V,w,I,o,k,s,C,h,Q,b)}}};DefaultFurnitureCatalog.prototype.readFurnitureCategory=function(c,a){var b=CoreTools.getStringFromKey(c,this.getKey(DefaultFurnitureCatalog.PropertyKey.CATEGORY,a));return new FurnitureCategory(b)};DefaultFurnitureCatalog.prototype.getContent=function(c,a,d,j,k,h,g){var e=g?this.getOptionalString(c,a,null):CoreTools.getStringFromKey(c,a);if(g&&e==null){return null}var b=null;if(k!=null){b=k+e}else{b=e}if(e.indexOf("!/")>=0&&e.indexOf("jar:")!==0){b="jar:"+b}var f=new URLContent(b);return f};DefaultFurnitureCatalog.prototype.getModelRotation=function(e,d){try{var a=CoreTools.getStringFromKey(e,d);var b=a.split(" ",9);if(b.length===9){return[[parseFloat(b[0]),parseFloat(b[1]),parseFloat(b[2])],[parseFloat(b[3]),parseFloat(b[4]),parseFloat(b[5])],[parseFloat(b[6]),parseFloat(b[7]),parseFloat(b[8])]]}else{return null}}catch(c){return null}};DefaultFurnitureCatalog.prototype.getDoorOrWindowSashes=function(d,k,a,f){var e;var l=this.getOptionalString(d,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_X_AXIS,k),null);if(l!=null){var b=l.split(" ");var m=CoreTools.getStringFromKey(d,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_Y_AXIS,k)).split(" ");if(m.length!==b.length){throw new IllegalArgumentException("Expected "+b.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_Y_AXIS,k)+" key")}var j=CoreTools.getStringFromKey(d,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_WIDTH,k)).split(" ");if(j.length!==b.length){throw new IllegalArgumentException("Expected "+b.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_WIDTH,k)+" key")}var c=CoreTools.getStringFromKey(d,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_START_ANGLE,k)).split(" ");if(c.length!==b.length){throw new IllegalArgumentException("Expected "+b.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_START_ANGLE,k)+" key")}var h=CoreTools.getStringFromKey(d,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_END_ANGLE,k)).split(" ");if(h.length!==b.length){throw new IllegalArgumentException("Expected "+b.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_END_ANGLE,k)+" key")}e=new Array(b.length);for(var g=0;g<e.length;g++){e[g]=new Sash(parseFloat(b[g])/a,parseFloat(m[g])/f,parseFloat(j[g])/a,parseFloat(c[g])*Math.PI/180,parseFloat(h[g])*Math.PI/180)}}else{e=[]}return e};DefaultFurnitureCatalog.prototype.getLightSources=function(h,n,c,m,o){var b=null;var p=this.getOptionalString(h,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_X,n),null);if(p!=null){var g=p.split(" ");var f=CoreTools.getStringFromKey(h,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Y,n)).split(" ");if(f.length!==g.length){throw new IllegalArgumentException("Expected "+g.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Y,n)+" key")}var d=CoreTools.getStringFromKey(h,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Z,n)).split(" ");if(d.length!==g.length){throw new IllegalArgumentException("Expected "+g.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Z,n)+" key")}var k=CoreTools.getStringFromKey(h,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_COLOR,n)).split(" ");if(k.length!==g.length){throw new IllegalArgumentException("Expected "+g.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_COLOR,n)+" key")}var e=this.getOptionalString(h,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_DIAMETER,n),null);var a=null;if(e!=null){a=e.split(" ");if(a.length!==g.length){throw new IllegalArgumentException("Expected "+g.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_DIAMETER,n)+" key")}}else{a=null}b=new Array(g.length);for(var l=0;l<b.length;l++){var j=k[l].indexOf("#")===0?parseInt(k[l].substring(1),16):parseInt(k[l]);b[l]=new LightSource(parseFloat(g[l])/c,parseFloat(f[l])/m,parseFloat(d[l])/o,j,a!=null?parseFloat(a[l])/c:null)}}return b};DefaultFurnitureCatalog.prototype.getOptionalString=function(d,c,a){try{return CoreTools.getStringFromKey(d,c)}catch(b){return a}};DefaultFurnitureCatalog.prototype.getOptionalFloat=function(d,c,a){try{return parseFloat(CoreTools.getStringFromKey(d,c))}catch(b){return a}};DefaultFurnitureCatalog.prototype.getOptionalBoolean=function(d,c,a){try{return this.parseBoolean(CoreTools.getStringFromKey(d,c))}catch(b){return a}};DefaultFurnitureCatalog.prototype.parseBoolean=function(a){return"true"==a};DefaultFurnitureCatalog.prototype.getKey=function(b,a){return b+"#"+a};DefaultFurnitureCatalog.PropertyKey={ID:"id",NAME:"name",DESCRIPTION:"description",INFORMATION:"information",TAGS:"tags",CREATION_DATE:"creationDate",GRADE:"grade",CATEGORY:"category",ICON:"icon",ICON_DIGEST:"iconDigest",PLAN_ICON:"planIcon",PLAN_ICON_DIGEST:"planIconDigest",MODEL:"model",MODEL_SIZE:"modelSize",MODEL_DIGEST:"modelDigest",MULTI_PART_MODEL:"multiPartModel",WIDTH:"width",DEPTH:"depth",HEIGHT:"height",MOVABLE:"movable",DOOR_OR_WINDOW:"doorOrWindow",DOOR_OR_WINDOW_CUT_OUT_SHAPE:"doorOrWindowCutOutShape",DOOR_OR_WINDOW_WALL_THICKNESS:"doorOrWindowWallThickness",DOOR_OR_WINDOW_WALL_DISTANCE:"doorOrWindowWallDistance",DOOR_OR_WINDOW_WALL_CUT_OUT_ON_BOTH_SIDES:"doorOrWindowWallCutOutOnBothSides",DOOR_OR_WINDOW_WIDTH_DEPTH_DEFORMABLE:"doorOrWindowWidthDepthDeformable",DOOR_OR_WINDOW_SASH_X_AXIS:"doorOrWindowSashXAxis",DOOR_OR_WINDOW_SASH_Y_AXIS:"doorOrWindowSashYAxis",DOOR_OR_WINDOW_SASH_WIDTH:"doorOrWindowSashWidth",DOOR_OR_WINDOW_SASH_START_ANGLE:"doorOrWindowSashStartAngle",DOOR_OR_WINDOW_SASH_END_ANGLE:"doorOrWindowSashEndAngle",LIGHT_SOURCE_X:"lightSourceX",LIGHT_SOURCE_Y:"lightSourceY",LIGHT_SOURCE_Z:"lightSourceZ",LIGHT_SOURCE_COLOR:"lightSourceColor",LIGHT_SOURCE_DIAMETER:"lightSourceDiameter",STAIRCASE_CUT_OUT_SHAPE:"staircaseCutOutShape",ELEVATION:"elevation",DROP_ON_TOP_ELEVATION:"dropOnTopElevation",MODEL_ROTATION:"modelRotation",CREATOR:"creator",RESIZABLE:"resizable",DEFORMABLE:"deformable",TEXTURABLE:"texturable",HORIZONTALLY_ROTATABLE:"horizontallyRotatable",PRICE:"price",VALUE_ADDED_TAX_PERCENTAGE:"valueAddedTaxPercentage",CURRENCY:"currency",getKey:function(b,a){return b+"#"+a},fromPrefix:function(b){for(var a in DefaultFurnitureCatalog.PropertyKey){if(DefaultFurnitureCatalog.PropertyKey[a]==b){return a}}throw new IllegalArgumentException("Unknow prefix "+b)}};function DefaultTexturesCatalog(a,g,f){TexturesCatalog.call(this);this.libraries=[];var e=[];if(g===undefined){this.readDefaultTexturesCatalogs(a,e)}else{f=g;g=a;if(g!=null){for(var c=0;c<g.length;c++){var b=g[c];var d=CoreTools.loadResourceBundles(b.substring(0,b.lastIndexOf(".json")),Locale.getDefault());this.readTextures(d,b,f,e)}}}}DefaultTexturesCatalog.prototype=Object.create(TexturesCatalog.prototype);DefaultTexturesCatalog.prototype.constructor=DefaultTexturesCatalog;DefaultTexturesCatalog.__class="com.eteks.sweethome3d.io.DefaultTexturesCatalog";DefaultTexturesCatalog.texturesAdditionalKeys={};DefaultTexturesCatalog.prototype.getLibraries=function(){return this.libraries.slice(0)};DefaultTexturesCatalog.prototype.readDefaultTexturesCatalogs=function(a,b){this.readTexturesCatalog("DefaultTexturesCatalog",a,b)};DefaultTexturesCatalog.prototype.readTexturesCatalog=function(b,a,c){this.readTextures(a.getResourceBundles(b),null,null,c)};DefaultTexturesCatalog.prototype.readTextures=function(c,j,h,a){var d=0;while(true){var b=0;try{b=CoreTools.getStringFromKey(c,this.getKey("ignored",++d))}catch(g){b=null}if(b==null||!this.parseBoolean(b)){var f=b==null?this.readTexture(c,d,j,h):null;if(f==null){break}else{if(f.getId()!=null){if(a.indexOf(f.getId())!==-1){continue}else{a.push(f.getId())}}var e=this.readTexturesCategory(c,d);this.add(e,f)}}}};DefaultTexturesCatalog.prototype.readTexture=function(f,g,k,j){var a=null;try{a=CoreTools.getStringFromKey(f,this.getKey(DefaultTexturesCatalog.PropertyKey.NAME,g))}catch(h){return null}var e=this.getContent(f,this.getKey(DefaultTexturesCatalog.PropertyKey.IMAGE,g),this.getKey(DefaultTexturesCatalog.PropertyKey.ICON_DIGEST,g),k,j,false,false);var c=parseFloat(CoreTools.getStringFromKey(f,this.getKey(DefaultTexturesCatalog.PropertyKey.WIDTH,g)));var l=parseFloat(CoreTools.getStringFromKey(f,this.getKey(DefaultTexturesCatalog.PropertyKey.HEIGHT,g)));var d=this.getOptionalString(f,this.getKey(DefaultTexturesCatalog.PropertyKey.CREATOR,g),null);var b=this.getOptionalString(f,this.getKey(DefaultTexturesCatalog.PropertyKey.ID,g),null);return new CatalogTexture(b,a,e,c,l,d)};DefaultTexturesCatalog.prototype.readTexturesCategory=function(c,a){var b=CoreTools.getStringFromKey(c,this.getKey(DefaultTexturesCatalog.PropertyKey.CATEGORY,a));return new TexturesCategory(b)};DefaultTexturesCatalog.prototype.getContent=function(c,a,d,k,j,h,g){var e=CoreTools.getStringFromKey(c,a);var b=null;if(j!=null){b=j+e}else{b=e}var f=new URLContent(b);return f};DefaultTexturesCatalog.prototype.getOptionalString=function(d,c,a){try{return CoreTools.getStringFromKey(d,c)}catch(b){return a}};DefaultTexturesCatalog.prototype.getKey=function(a,b){return a+"#"+b};DefaultTexturesCatalog.PropertyKey={ID:"id",NAME:"name",CATEGORY:"category",IMAGE:"image",IMAGE_DIGEST:"imageDigest",WIDTH:"width",HEIGHT:"height",CREATOR:"creator",getKey:function(a,b){return a+"#"+b}};function FurnitureCatalogListPanel(c,b,d,a){this.container=document.getElementById(c);this.controller=a;this.preferences=d;this.createComponents(b,d,a)}FurnitureCatalogListPanel.prototype.getHTMLElement=function(){return this.container};FurnitureCatalogListPanel.prototype.createComponents=function(g,e,f){var d=this;var k=this.container.getElementsByClassName("furniture-catalog-list")[0];this.catalog=g;this.toolTipDiv=document.createElement("div");this.toolTipDiv.classList.add("furniture-tooltip");this.toolTipDiv.style.display="none";this.toolTipDiv.style.position="absolute";this.toolTipDiv.style.zIndex=10;document.body.appendChild(this.toolTipDiv);var a=document.createElement("div");a.id="furniture-filter";this.container.insertBefore(a,k);var b=document.createElement("select");var o=document.createElement("input");this.searchInput=o;var l=function(){var p=CoreTools.removeAccents(o.value.trim());d.filterCatalog(b.selectedIndex,function(q){if(p==""){return true}else{var r=q.getName()+"|"+q.getTags().join("|");if(q.getCreator()!==null){r+="|"+q.getCreator()}return RegExp(p,"i").test(CoreTools.removeAccents(r))}})};b.id="furniture-category-select";var j=document.createElement("option");var n=e.getLocalizedString("FurnitureCatalogListPanel","categoryFilterComboBox.noCategory");j.value=j.text=n;b.appendChild(j);for(var c=0;c<g.getCategories().length;c++){var h=document.createElement("option");h.value=h.text=g.getCategories()[c].getName();b.appendChild(h)}b.addEventListener("change",l);b.addEventListener("mousemove",function(p){d.hideTooltip();p.stopPropagation()});a.appendChild(b);o.setAttribute("type","text");o.id="furniture-search-field";o.placeholder=ResourceAction.getLocalizedLabelText(e,"FurnitureCatalogListPanel","searchLabel.text").replace(":","");o.addEventListener("input",l);o.addEventListener("mousemove",function(p){d.hideTooltip();p.stopPropagation()});k.addEventListener("click",function(q){var p=o.getBoundingClientRect();if(!(q.clientX>=p.left&&q.clientX<=p.right&&q.clientY>=p.top&&q.clientY<=p.bottom)){d.searchInput.blur()}});o.addEventListener("focusin",function(p){o.classList.remove("partly-expanded");if(!o.classList.contains("expanded")){o.classList.add("expanded");setTimeout(function(){if(o.value!=""){o.select()}if(document.body.scrollTop==0){window.scrollTo(0,d.container.getBoundingClientRect().top)}},100)}});o.addEventListener("focusout",function(p){if(o.classList.contains("expanded")){o.classList.remove("expanded");if(o.value.trim()!=""){o.classList.add("partly-expanded")}}});o.addEventListener("keydown",function(p){if(p.keyCode==27){o.value="";var p=document.createEvent("Event");p.initEvent("input",true,true);o.dispatchEvent(p)}});a.appendChild(o);this.resetFurnitureCatalog(g);var m;document.addEventListener("mousemove",function(p){var r=d.container.getBoundingClientRect();var q=p;if((q.clientX>=r.left)&&(q.clientX<r.left+d.container.clientWidth)&&(q.clientY>=r.top)&&(q.clientY<r.top+d.container.clientHeight)){if(d.toolTipDiv.style.display=="none"){if(d.showTooltipTimeOut){clearTimeout(d.showTooltipTimeOut)}d.showTooltipTimeOut=setTimeout(function(){if(d.currentFurnitureContainer!==undefined){m=d.currentFurnitureContainer;d.showTooltip(m,p)}},1000)}else{if(m!==d.currentFurnitureContainer){m=d.currentFurnitureContainer;d.showTooltip(m,p)}if(d.hideTooltipTimeOut){clearTimeout(d.hideTooltipTimeOut)}d.hideTooltipTimeOut=setTimeout(function(){d.hideTooltip()},3000)}}else{d.currentFurnitureContainer=undefined;d.hideTooltip()}});k.addEventListener("mouseleave",function(p){d.hideTooltip()});e.addPropertyChangeListener("LANGUAGE",function(r){var q=document.getElementById("furniture-search-field");q.placeholder=ResourceAction.getLocalizedLabelText(e,"FurnitureCatalogListPanel","searchLabel.text").replace(":","");var p=document.getElementById("furniture-category-select");var s=e.getLocalizedString("FurnitureCatalogListPanel","categoryFilterComboBox.noCategory");j.value=j.text=s});g.addFurnitureListener(function(v){var u=v.getItem().getCategory();var q=g.getCategories();var t=b.childNodes;if(q.indexOf(u)===-1){for(var s=0;s<t.length;s++){if(t[s].value==u.getName()){b.removeChild(t[s]);break}}}else{if(v.getType()===CollectionEvent.Type.ADD){var p=t.length;for(var s=1;s<t.length;s++){if(t[s].value==u.getName()){p=-1;break}else{if(t[s].value>u.getName()){p=s;break}}}if(p>=0){h=document.createElement("option");h.value=h.text=u.getName();if(p===t.length){b.appendChild(h)}else{b.insertBefore(h,t[p])}}}}if(!this.updater){var r=this;this.updater=function(){d.resetFurnitureCatalog(g);delete r.updater};setTimeout(this.updater,0)}})};FurnitureCatalogListPanel.prototype.findCategoryElements=function(c){var d=[];var a=this.container.getElementsByClassName("furniture-catalog-list")[0];for(var b=0;b<a.childNodes.length;b++){if(a.childNodes[b].category===c){d.push(a.childNodes[b])}}return d};FurnitureCatalogListPanel.prototype.filterCatalog=function(h,c){var b=this.container.getElementsByClassName("furniture-catalog-list")[0];for(var d=0;d<b.childNodes.length;d++){if(b.childNodes[d] instanceof HTMLElement&&b.childNodes[d].id!=="furniture-filter"){if(b.childNodes[d]._displayBackup===undefined){b.childNodes[d]._displayBackup=b.childNodes[d].style.display}b.childNodes[d].style.display="none"}}var a=h==null||h===0?this.catalog.getCategories():[this.catalog.getCategories()[h-1]];for(var d=0;d<a.length;d++){var e=a[d];var g=c==null?e.getFurniture():e.getFurniture().filter(c);if(g!=null&&g.length>0){var f=this.findCategoryElements(e);f.forEach(function(j){if(a.length>1&&(j.classList.contains("furniture-category-label")||j.classList.contains("furniture-category-separator"))){j.style.display=j._displayBackup}if(j.piece&&g.indexOf(j.piece)!==-1){j.style.display=j._displayBackup}})}}};FurnitureCatalogListPanel.prototype.resetFurnitureCatalog=function(g){var k=this.container.getElementsByClassName("furniture-catalog-list")[0];var c=k.getElementsByClassName("furniture-category-label");for(var f=c.length-1;f>=0;f--){k.removeChild(c[f])}c=k.getElementsByClassName("furniture");for(var f=c.length-1;f>=0;f--){k.removeChild(c[f])}c=k.getElementsByClassName("furniture-category-separator");for(var f=c.length-1;f>=0;f--){k.removeChild(c[f])}for(var f=0;f<g.getCategoriesCount();f++){var b=g.getCategories()[f];var a=document.createElement("div");a.className="furniture-category-label";a.innerHTML=b.getName();a.category=b;k.appendChild(a);for(var e=0;e<b.getFurnitureCount();e++){var l=b.getFurniture()[e];var h=document.createElement("div");h.pieceOfFurniture=l;h.className="furniture";h.innerHTML='<div class="furniture-label">'+l.getName()+"</div>";k.appendChild(h);this.createPieceOfFurniturePanel(h,l);h.category=b;h.piece=l}if(f<g.getCategoriesCount()-1){var d=document.createElement("div");d.className="furniture-category-separator";d.category=b;k.appendChild(d)}}};FurnitureCatalogListPanel.prototype.createPieceOfFurniturePanel=function(e,b){var d=this;e.addEventListener("mousemove",function(f){d.currentFurnitureContainer=e});e.addEventListener("mousedown",function(h){if(h.button===0){var g=d.container.querySelectorAll(".furniture");for(var f=0;f<g.length;f++){g[f].classList.remove("selected")}e.classList.add("selected");d.controller.setSelectedFurniture([b]);d.hideTooltip()}});var a=function(j){var f=e.getBoundingClientRect();if(j.touches.length===0&&j.changedTouches.length===1&&j.changedTouches[0].clientX>=f.left&&j.changedTouches[0].clientX<f.left+f.width&&j.changedTouches[0].clientY>=f.top&&j.changedTouches[0].clientY<f.top+f.height){var h=d.container.querySelectorAll(".furniture");for(var g=0;g<h.length;g++){h[g].classList.remove("selected")}e.classList.add("selected");d.controller.setSelectedFurniture([b])}};if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){e.addEventListener("pointerup",function(f){if(f.pointerType!="mouse"){f.touches=[];f.changedTouches=[{clientX:f.clientX,clientY:f.clientY}];a(f);f.preventDefault()}});e.addEventListener("pointerdown",function(f){if(f.pointerType!="mouse"){f.preventDefault()}});var c=function(f){f.preventDefault()};e.addEventListener("mousedown",c)}else{e.addEventListener("touchend",a)}TextureManager.getInstance().loadTexture(b.icon,{textureUpdated:function(f){f.classList.add("furniture-icon");e.appendChild(f)},textureError:function(f){console.error("Image cannot be loaded",f)}})};FurnitureCatalogListPanel.prototype.showTooltip=function(e,c){var d=e.querySelector("img.furniture-icon");if(d!==null){this.toolTipDiv.style.left=c.clientX+10;this.toolTipDiv.style.top=c.clientY+10;this.toolTipDiv.style.display="block";this.toolTipDiv.innerHTML=this.createCatalogItemTooltipText(e.pieceOfFurniture);var b=this.toolTipDiv.querySelector("img");b.src=d.src;var a=this.toolTipDiv.getBoundingClientRect();if(a.x<0){this.toolTipDiv.style.left=c.clientX+10-a.x}if(a.y<0){this.toolTipDiv.style.left=c.clientY+10-a.y}if(a.x+a.width>window.innerWidth){this.toolTipDiv.style.left=c.clientX+10-(a.x+a.width-window.innerWidth)}if(a.y+a.height>window.innerHeight){this.toolTipDiv.style.top=c.clientY+10-(a.y+a.height-window.innerHeight)}}else{this.hideTooltip()}};FurnitureCatalogListPanel.prototype.hideTooltip=function(){if(this.hideTooltipTimeOut){clearTimeout(this.hideTooltipTimeOut);this.hideTooltipTimeOut=undefined}if(this.showTooltipTimeOut){clearTimeout(this.showTooltipTimeOut);this.showTooltipTimeOut=undefined}if(this.toolTipDiv.style.display!="none"){this.toolTipDiv.style.display="none"}};FurnitureCatalogListPanel.prototype.createCatalogItemTooltipText=function(d){if(this.preferences!=null){var c=d.getCreator();var g=null;if(c!=null&&c.length>0){g=this.preferences.getLocalizedString("CatalogItemToolTip","tooltipCreator",c)}var f=this.preferences.getLengthUnit().getFormatWithUnit();var b=this.preferences.getLocalizedString("CatalogItemToolTip","tooltipPieceOfFurnitureDimensions",f.format(d.getWidth()),f.format(d.getDepth()),f.format(d.getHeight()));var e=null;if(d.getModelSize()!=null&&d.getModelSize()>0){e=this.preferences.getLocalizedString("CatalogItemToolTip","tooltipModelSize",Math.max(1,Math.round(d.getModelSize()/1000)))}}var a="<center>";a+="- <b>"+d.getCategory().getName()+"</b> -<br>";a+="<b>"+d.getName()+"</b>";if(b!=null){a+="<br>"+b}if(e!=null){a+="<br>"+e}if(g!=null){a+="<br>"+g}a+="<br/><img height='100px'/>";a+="</center>";return a};function FurnitureTablePanel(b,d,c,a){this.container=document.getElementById(b);this.preferences=c;this.controller=a;this.defaultDecimalFormat=new DecimalFormat();this.integerFormat=new IntegerFormat();this.treeTable=new JSTreeTable(this.container,this.preferences,this.createTableModel(d));this.addHomeListeners(d);this.addUserPreferencesListeners(d);this.updateData(d)}FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.ExpandedGroups";FurnitureTablePanel.prototype.getHTMLElement=function(){return this.container};FurnitureTablePanel.prototype.addHomeListeners=function(k){var a=this;var d=this.treeTable;k.addSelectionListener({selectionChanged:function(j){d.setSelectedRowsByValue(k.getSelectedItems())}});var c=function(){d.setModel(a.createTableModel(k))};k.addPropertyChangeListener("FURNITURE_SORTED_PROPERTY",c);k.addPropertyChangeListener("FURNITURE_DESCENDING_SORTED",c);k.addPropertyChangeListener("FURNITURE_VISIBLE_PROPERTIES",c);var l=function(){a.updateData(k)};var g=function(j){a.updatePieceOfFurnitureData(k,j.getSource(),j.getPropertyName())};var h=k.getFurniture();for(var f=0;f<h.length;f++){var n=h[f];n.addPropertyChangeListener(g);if(n instanceof HomeFurnitureGroup){var b=n.getAllFurniture();for(var e=0;e<b.length;e++){b[e].addPropertyChangeListener(g)}}}k.addFurnitureListener(function(r){l(k);var q=r.getItem();if(r.getType()==CollectionEvent.Type.ADD){q.addPropertyChangeListener(g);if(q instanceof HomeFurnitureGroup){var p=q.getAllFurniture();for(var o=0;o<p.length;o++){p[o].addPropertyChangeListener(g)}}}else{q.removePropertyChangeListener(g);if(q instanceof HomeFurnitureGroup){var p=q.getAllFurniture();for(var o=0;o<p.length;o++){p[o].removePropertyChangeListener(g)}}}});var m=k.getLevels();for(var f=0;f<m.length;f++){m[f].addPropertyChangeListener(l)}k.addLevelsListener(function(j){if(j.getType()==CollectionEvent.Type.ADD){j.getItem().addPropertyChangeListener(l)}else{j.getItem().removePropertyChangeListener(l)}})};FurnitureTablePanel.prototype.addUserPreferencesListeners=function(b){var a=this;this.preferences.addPropertyChangeListener(function(c){if(c.getPropertyName()=="UNIT"||c.getPropertyName()=="LANGUAGE"){a.treeTable.setModel(a.createTableModel(b))}})};FurnitureTablePanel.prototype.createTableModel=function(h){var d={CATALOG_ID:{name:"CATALOG_ID",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","catalogIdColumn"),defaultWidth:"4rem"},NAME:{name:"NAME",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","nameColumn"),defaultWidth:"14rem"},WIDTH:{name:"WIDTH",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","widthColumn")},DEPTH:{name:"DEPTH",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","depthColumn")},HEIGHT:{name:"HEIGHT",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","heightColumn")},MOVABLE:{name:"MOVABLE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","movableColumn")},DOOR_OR_WINDOW:{name:"DOOR_OR_WINDOW",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","doorOrWindowColumn")},COLOR:{name:"COLOR",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","colorColumn")},TEXTURE:{name:"TEXTURE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","textureColumn")},VISIBLE:{name:"VISIBLE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","visibleColumn")},X:{name:"X",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","xColumn")},Y:{name:"Y",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","yColumn")},ELEVATION:{name:"ELEVATION",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","elevationColumn")},ANGLE:{name:"ANGLE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","angleColumn")},MODEL_SIZE:{name:"MODEL_SIZE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","modelSizeColumn")},CREATOR:{name:"CREATOR",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","creatorColumn")},PRICE:{name:"PRICE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","priceColumn")},VALUE_ADDED_TAX:{name:"VALUE_ADDED_TAX",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","valueAddedTaxColumn")},VALUE_ADDED_TAX_PERCENTAGE:{name:"VALUE_ADDED_TAX_PERCENTAGE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","valueAddedTaxPercentageColumn")},PRICE_VALUE_ADDED_TAX_INCLUDED:{name:"PRICE_VALUE_ADDED_TAX_INCLUDED",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","priceValueAddedTaxIncludedColumn")},LEVEL:{name:"LEVEL",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","levelColumn")}};var m=[];var e=h.getFurnitureVisibleProperties();for(var g=0;g<e.length;g++){for(var f in d){if(e[g]==d[f].name){m.push(d[f])}}}var l=[];if(h.getVersion()>=5000){var c=h.getProperty(FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY);if(c!=null){l=[];var b=c.split(",");for(var g=0;g<b.length;g++){var k=parseInt(b[g]);if(!isNaN(k)){l.push(k)}}}}var a=this;return{columns:m,renderCell:function(o,n,j){return a.renderCell(o,n,j)},getValueComparator:function(j){if(j.columnName!=null){var n=HomePieceOfFurniture.getFurnitureComparator(j.columnName);if(j.direction=="desc"){return function(p,o){return n(o,p)}}else{return n}}else{return null}},selectionChanged:function(j){if(a.controller!==null){a.controller.setSelectedFurniture(j,false)}},rowDoubleClicked:function(j){if(a.controller!==null){a.controller.modifySelectedFurniture(j)}},expandedRowsChanged:function(n,j){if(a.controller!==null){a.storeExpandedRows(j,h,a.controller)}},sortChanged:function(j){if(a.controller!==null){a.controller.sortFurniture(j.columnName)}},initialState:{visibleColumnNames:h.getFurnitureVisibleProperties(),sort:{columnName:h.getFurnitureSortedProperty(),direction:h.isFurnitureDescendingSorted()?"desc":"asc"},expandedRowsIndices:l}}};FurnitureTablePanel.prototype.updateData=function(c){var a=[];var b=function(h,f){for(var e=0;e<h.length;e++){var g=h[e];var d={value:g};if(g instanceof HomeFurnitureGroup){d.children=[];b(g.getFurniture(),d.children)}f.push(d)}};b(c.getFurniture(),a);this.treeTable.setData(a)};FurnitureTablePanel.prototype.updatePieceOfFurnitureData=function(e,c,b){this.treeTable.updateRowData(c,b);var a=this;var d=function(j,f){for(var g=0;g<j.length;g++){if(j[g]===c){return true}else{if(j[g] instanceof HomeFurnitureGroup){var h=d(j[g].getFurniture(),f);if(h){a.treeTable.updateRowData(j[g],f)}return h}}}return false};if(b===undefined){d(e.getFurniture(),b)}if(b=="PRICE"||b=="VALUE_ADDED_TAX_PERCENTAGE"){d(e.getFurniture(),b);this.treeTable.updateRowData(c,"PRICE_VALUE_ADDED_TAX_INCLUDED");d(e.getFurniture(),"PRICE_VALUE_ADDED_TAX_INCLUDED")}if(b=="VALUE_ADDED_TAX_PERCENTAGE"){d(e.getFurniture(),b);this.treeTable.updateRowData(c,"VALUE_ADDED_TAX");d(e.getFurniture(),"VALUE_ADDED_TAX")}if(b=="CURRENCY"){this.treeTable.updateRowData(c,"PRICE");d(e.getFurniture(),"PRICE");this.treeTable.updateRowData(c,"PRICE_VALUE_ADDED_TAX_INCLUDED");d(e.getFurniture(),"PRICE_VALUE_ADDED_TAX_INCLUDED")}};FurnitureTablePanel.prototype.isRootPieceOfFurniture=function(c){var b=this.treeTable.getData();for(var a=0;a<b.length;a++){if(b[a].value==c){return true}}return false};FurnitureTablePanel.prototype.renderNumberCellValue=function(b,a,c){if(!c){c=this.defaultDecimalFormat}var d="";if(b!=null){d=c.format(b)}a.innerHTML=d;a.classList.add("number")};FurnitureTablePanel.prototype.renderSizeCellValue=function(b,a){this.renderNumberCellValue(b,a,this.preferences.getLengthUnit().getFormat())};FurnitureTablePanel.prototype.renderNameCell=function(e,a){while(a.firstChild){a.removeChild(a.firstChild)}a.classList.add("main","name");var d=document.createElement("span");d.setAttribute("icon",true);var c=e instanceof HomeFurnitureGroup?new URLContent(ZIPTools.getScriptFolder()+"/resources/groupIcon.png"):e.getIcon();TextureManager.getInstance().loadTexture(c,0,false,{textureUpdated:function(f){d.appendChild(f.cloneNode())},textureError:function(f){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}});a.appendChild(d);var b=document.createElement("span");b.textContent=e.getName();a.appendChild(b)};FurnitureTablePanel.prototype.renderColorCell=function(c,a){while(a.firstChild){a.removeChild(a.firstChild)}a.classList.add("color");if(c.getColor()!=null){var b=document.createElement("div");b.style.backgroundColor=ColorTools.integerToHexadecimalString(c.getColor());a.appendChild(b)}else{a.textContent="-"}};FurnitureTablePanel.prototype.renderTextureCell=function(b,a){while(a.firstChild){a.removeChild(a.firstChild)}a.classList.add("texture");if(b.getTexture()!=null){var c=document.createElement("div");TextureManager.getInstance().loadTexture(b.getTexture().getImage(),0,false,{textureUpdated:function(d){c.style.backgroundImage="url('"+d.src+"')"},textureError:function(d){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}});a.appendChild(c)}};FurnitureTablePanel.prototype.renderBooleanCell=function(e,a,c,b){while(a.firstChild){a.removeChild(a.firstChild)}a.classList.add("boolean");var d=document.createElement("input");d.type="checkbox";d.disabled=c!==true;d.checked=e===true;d.tabIndex=-1;if(b!==undefined){d.addEventListener("click",function(f){b(d.checked)},true)}a.appendChild(d)};FurnitureTablePanel.prototype.renderPriceCellValue=function(d,e,a){var b=d.getCurrency()==null?this.preferences.getCurrency():d.getCurrency();var c=NumberFormat.getCurrencyInstance();c.setCurrency(b);this.renderNumberCellValue(this.bigToNumber(e),a,c)};FurnitureTablePanel.prototype.bigToNumber=function(a){return a==null?null:parseFloat(a.valueOf())};FurnitureTablePanel.prototype.renderCreatorCell=function(k,h){var a=k.getCreator();if(a!=null){var e=k.getTexture();if(e!=null){var b=e.getCreator();if(b!=null&&a!=b){a+=", "+b}}else{var f=a;var j=k.getModelMaterials();if(j!=null){for(var c=0;c<j.length;c++){var d=j[c];if(d!=null){var g=d.getTexture();if(g!=null){var b=g.getCreator();if(b!=null&&f!=b&&a.indexOf(", "+b)==-1){a+=", "+b}}}}}}}h.textContent=a};FurnitureTablePanel.prototype.renderCell=function(d,c,a){switch(c){case"CATALOG_ID":a.textContent=d.getCatalogId();break;case"NAME":return this.renderNameCell(d,a);case"CREATOR":return this.renderCreatorCell(d,a);case"WIDTH":return this.renderSizeCellValue(d.getWidth(),a);case"DEPTH":return this.renderSizeCellValue(d.getDepth(),a);case"HEIGHT":return this.renderSizeCellValue(d.getHeight(),a);case"X":return this.renderSizeCellValue(d.getX(),a);case"Y":return this.renderSizeCellValue(d.getY(),a);case"ELEVATION":return this.renderSizeCellValue(d.getElevation(),a);case"ANGLE":var e=Math.round(Math.toDegrees(d.getAngle())+360)%360;return this.renderNumberCellValue(e,a,this.integerFormat);case"LEVEL":a.textContent=d!=null&&d.getLevel()!=null?d.getLevel().getName():"";break;case"MODEL_SIZE":var e=d!=null&&d.getModelSize()!=null&&d.getModelSize()>0?Math.max(1,Math.round(d.getModelSize()/1000)):null;return this.renderNumberCellValue(e,a,this.integerFormat);case"COLOR":return this.renderColorCell(d,a);case"TEXTURE":return this.renderTextureCell(d,a);case"MOVABLE":return this.renderBooleanCell(d.isMovable(),a);case"DOOR_OR_WINDOW":return this.renderBooleanCell(d.isDoorOrWindow(),a);case"VISIBLE":var b=this.controller;return this.renderBooleanCell(d.isVisible(),a,this.isRootPieceOfFurniture(d),function(f){if(b!==null){b.toggleSelectedFurnitureVisibility()}});case"PRICE":return this.renderPriceCellValue(d,d.getPrice(),a);case"VALUE_ADDED_TAX_PERCENTAGE":return this.renderNumberCellValue(d.getValueAddedTaxPercentage()!==null?this.bigToNumber(d.getValueAddedTaxPercentage())*100:null,a);case"VALUE_ADDED_TAX":return this.renderPriceCellValue(d,d.getValueAddedTax(),a);case"PRICE_VALUE_ADDED_TAX_INCLUDED":return this.renderPriceCellValue(d,d.getPriceValueAddedTaxIncluded(),a);default:a.textContent="-";break}};FurnitureTablePanel.prototype.storeExpandedRows=function(c,d,b){var a=c.join(",");if(d.getProperty(FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY)!=null||a.length>0){b.setHomeProperty(FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY,a)}};function JSComponent(a,c,d){this.preferences=a;if(c instanceof HTMLElement&&d===true){this.container=c}else{var b="";if(c!=null){b=typeof c=="string"?c:c.innerHTML}this.container=document.createElement("div");this.container.innerHTML=this.buildHtmlFromTemplate(b)}}JSComponent.prototype.getHTMLElement=function(){return this.container};JSComponent.prototype.getUserPreferences=function(){return this.preferences};JSComponent.isElementContained=function(b,c){if(b==null||c==null){return false}var a=b;do{if(a==c){return true}}while(a=a.parentElement);return false};JSComponent.substituteWithLocale=function(a,b){return b.replace(/\@\{([a-zA-Z0-9_.]+)\}/g,function(c,d){return ResourceAction.getLocalizedLabelText(a,d.substring(0,d.indexOf(".")),d.substring(d.indexOf(".")+1))})};JSComponent.prototype.buildHtmlFromTemplate=function(a){return JSComponent.substituteWithLocale(this.preferences,a)};JSComponent.prototype.getLocalizedLabelText=function(a,b,c){return ResourceAction.getLocalizedLabelText(this.preferences,a,b,c)};JSComponent.prototype.attachChildComponent=function(b,a){this.getElement(b).appendChild(a.getHTMLElement())};JSComponent.prototype.registerEventListener=function(e,a,d){if(e==null){return}if(e instanceof NodeList||e instanceof HTMLCollection){var f=new Array(e.length);for(var c=0;c<e.length;c++){f[c]=e[c]}e=f}if(!Array.isArray(e)){e=[e]}if(this.listeners==null){this.listeners=[]}for(var c=0;c<e.length;c++){var b=e[c];b.addEventListener(a,d,true)}this.listeners.push({listener:d,eventName:a,elements:e})};JSComponent.prototype.registerPropertyChangeListener=function(b,a,c){b.addPropertyChangeListener(a,c);this.listeners.push({listener:c,propertyName:a,object:b})};JSComponent.prototype.unregisterEventListeners=function(){if(Array.isArray(this.listeners)){for(var d=0;d<this.listeners.length;d++){var a=this.listeners[d];if(a.eventName!==undefined){for(var b=0;b<a.elements.length;b++){var c=a.elements[b];c.removeEventListener(a.eventName,a.listener)}}else{a.object.removePropertyChangeListener(a.propertyName,a.listener)}}}};JSComponent.prototype.getElement=function(a){var b=this.container.querySelector("[name='"+a+"']");if(b==null){b=this.container.querySelector("[data-name='"+a+"']")}return b};JSComponent.prototype.findElement=function(a){return this.container.querySelector(a)};JSComponent.prototype.findElements=function(a){return this.container.querySelectorAll(a)};JSComponent.prototype.dispose=function(){this.unregisterEventListeners()};JSComponent.createOptionElement=function(c,d,b){var a=document.createElement("option");a.value=c;a.textContent=d;if(b!==undefined){a.selected=b}return a};function JSDialog(a,e,c,d){JSComponent.call(this,a,c,d);var b=this;if(d!=null){this.applier=d.applier;this.disposer=d.disposer}this.getHTMLElement().classList.add("dialog-container");if(d.size){this.getHTMLElement().classList.add(d.size)}this.getHTMLElement()._dialogBoxInstance=this;document.body.appendChild(this.getHTMLElement());if(e!=null){this.setTitle(e)}this.getCloseButton().addEventListener("click",function(){b.cancel()});this.buttonsPanel=this.findElement(".dialog-buttons");if(OperatingSystem.isMacOSX()){this.buttonsPanel.classList.add("mac")}this.appendButtons(this.buttonsPanel);this.getHTMLElement().classList.add("buttons-"+this.buttonsPanel.querySelectorAll("button").length)}JSDialog.prototype=Object.create(JSComponent.prototype);JSDialog.prototype.constructor=JSDialog;JSDialog.prototype.appendButtons=function(a){var c;if(this.applier){c="<button class='dialog-ok-button default-capable'>@{OptionPane.okButton.textAndMnemonic}</button><button class='dialog-cancel-button'>@{OptionPane.cancelButton.textAndMnemonic}</button>"}else{c="<button class='dialog-cancel-button default-capable'>@{InternalFrameTitlePane.closeButtonAccessibleName}</button>"}a.innerHTML=JSComponent.substituteWithLocale(this.getUserPreferences(),c);var b=this;var d=this.findElement(".dialog-cancel-button");if(d){this.registerEventListener(d,"click",function(f){b.cancel()})}var e=this.findElement(".dialog-ok-button");if(e){this.registerEventListener(e,"click",function(f){b.validate()})}};JSDialog.closeTopMostDialog=function(){var a=JSDialog.getTopMostDialog();if(a!=null){a.close()}};JSDialog.getTopMostDialog=function(){var d=document.querySelectorAll(".dialog-container.visible");var a=null;if(d.length>0){for(var b=0;b<d.length;b++){var c=d[b]._dialogBoxInstance;if(a==null||a.displayIndex<=c.displayIndex){a=c}}}return a};JSDialog.prototype.buildHtmlFromTemplate=function(a){return JSComponent.substituteWithLocale(this.getUserPreferences(),'<div class="dialog-content">  <div class="dialog-top">    <span class="title"></span>    <span class="dialog-close-button">&times;</span>  </div>  <div class="dialog-body">'+JSComponent.prototype.buildHtmlFromTemplate.call(this,a)+'  </div>  <div class="dialog-buttons">  </div></div>')};JSDialog.prototype.getInput=function(a){return this.getHTMLElement().querySelector("[name='"+a+"']")};JSDialog.prototype.getCloseButton=function(){return this.getHTMLElement().querySelector(".dialog-close-button")};JSDialog.prototype.validate=function(){if(this.applier!=null){this.applier(this)}this.close()};JSDialog.prototype.cancel=function(){this.close()};JSDialog.prototype.close=function(){this.getHTMLElement().classList.add("closing");var a=this;setTimeout(function(){a.getHTMLElement().classList.remove("visible");a.dispose();if(a.getHTMLElement()&&document.body.contains(a.getHTMLElement())){document.body.removeChild(a.getHTMLElement())}},500)};JSDialog.prototype.dispose=function(){JSComponent.prototype.dispose.call(this);if(typeof this.disposer=="function"){this.disposer(this)}};JSDialog.prototype.setTitle=function(b){var a=this.findElement(".dialog-top .title");a.textContent=JSComponent.substituteWithLocale(this.getUserPreferences(),b||"")};JSDialog.prototype.isDisplayed=function(){return this.getHTMLElement().classList.contains("visible")};JSDialog.prototype.displayView=function(b){var a=this;this.getHTMLElement().style.display="block";setTimeout(function(){a.getHTMLElement().classList.add("visible");a.displayIndex=JSDialog.shownDialogsCounter++;var c=a.findElements("input");for(var d=0;d<c.length;d++){var e=c[d];if(!e.classList.contains("not-focusable-at-opening")){e.focus();break}}},100)};JSDialog.shownDialogsCounter=0;function JSWizardDialog(b,a,e,d){JSDialog.call(this,b,e,'<div class="wizard">  <div stepIcon><div></div></div>  <div stepView></div></div>',d);this.getHTMLElement().classList.add("wizard-dialog");this.controller=a;this.stepIconPanel=this.findElement("[stepIcon]");this.stepViewPanel=this.findElement("[stepView]");var c=this;this.cancelButton=this.findElement(".wizard-cancel-button");this.backButton=this.findElement(".wizard-back-button");this.nextButton=this.findElement(".wizard-next-button");this.registerEventListener(this.cancelButton,"click",function(f){c.cancel()});this.backButton.disabled=!a.isBackStepEnabled();this.registerPropertyChangeListener(a,"BACK_STEP_ENABLED",function(f){c.backButton.disabled=!a.isBackStepEnabled()});this.nextButton.disabled=!a.isNextStepEnabled();this.registerPropertyChangeListener(a,"NEXT_STEP_ENABLED",function(f){c.nextButton.disabled=!a.isNextStepEnabled()});this.updateNextButtonText();this.registerPropertyChangeListener(a,"LAST_STEP",function(f){c.updateNextButtonText()});this.registerEventListener(this.backButton,"click",function(f){a.goBackToPreviousStep()});this.registerEventListener(this.nextButton,"click",function(f){if(a.isLastStep()){a.finish();if(c!=null){c.validate()}}else{a.goToNextStep()}});this.updateStepView();this.registerPropertyChangeListener(a,"STEP_VIEW",function(f){c.updateStepView()});this.updateStepIcon();this.registerPropertyChangeListener(a,"STEP_ICON",function(f){c.updateStepIcon()});this.registerPropertyChangeListener(a,"TITLE",function(f){c.setTitle(a.getTitle())})}JSWizardDialog.prototype=Object.create(JSDialog.prototype);JSWizardDialog.prototype.constructor=JSWizardDialog;JSWizardDialog.prototype.appendButtons=function(a){var e="<button class='wizard-cancel-button'>@{InternalFrameTitlePane.closeButtonAccessibleName}</button>";var b="<button class='wizard-back-button'>@{WizardPane.backOptionButton.text}</button>";var d="<button class='wizard-next-button default-capable'></button>";var c="<div class='dialog-buttons'>"+(OperatingSystem.isMacOSX()?d+b:b+d)+e+"</div>";a.innerHTML=JSComponent.substituteWithLocale(this.getUserPreferences(),c)};JSWizardDialog.prototype.updateNextButtonText=function(){this.nextButton.innerText=this.getLocalizedLabelText("WizardPane",this.controller.isLastStep()?"finishOptionButton.text":"nextOptionButton.text")};JSWizardDialog.prototype.updateStepView=function(){var a=this.controller.getStepView();this.stepViewPanel.innerHTML="";this.stepViewPanel.appendChild(a.getHTMLElement())};JSWizardDialog.prototype.updateStepIcon=function(){var e=this.stepIconPanel;var h=this.stepIconPanel.querySelector("div");h.innerHTML="";var f=this.controller.getStepIcon();if(f!=null){var b="rgb(163, 168, 226)";var a="rgb(80, 86, 158)";try{var k=this.getLocalizedLabelText("WizardPane","stepIconBackgroundColors").trim().split(" ");b=k[0];if(k.length==1){a=b}else{if(k.length==2){a=k[1]}}}catch(g){}var d=b;var c=a;e.style.background="linear-gradient(180deg, "+d+" 0%, "+c+" 100%)";e.style.border="solid 1px #333333";var j=new Image();j.crossOrigin="anonymous";h.appendChild(j);j.src=ZIPTools.getScriptFolder()+"/"+f}};function JSImageResizingDialog(e,h,l,f,d,k,j,a){this.cancelButtonMessage=JSComponent.substituteWithLocale(e,f);this.keepUnchangedButtonMessage=JSComponent.substituteWithLocale(e,d);this.okButtonMessage=JSComponent.substituteWithLocale(e,k);JSDialog.call(this,e,JSComponent.substituteWithLocale(e,h),"<div>"+JSComponent.substituteWithLocale(e,l).replace("<br>"," ")+"</div>",{applier:function(m){if(m.resizeRequested){j()}else{a()}}});var g=this;var c=this.findElement(".dialog-cancel-button");this.registerEventListener(c,"click",function(m){g.cancel()});var b=this.findElements(".dialog-ok-button");this.registerEventListener(b,"click",function(m){g.resizeRequested=!m.target.classList.contains("keep-image-unchanged-button");g.validate()})}JSImageResizingDialog.prototype=Object.create(JSDialog.prototype);JSImageResizingDialog.prototype.constructor=JSImageResizingDialog;JSImageResizingDialog.prototype.appendButtons=function(a){a.innerHTML=JSComponent.substituteWithLocale(this.getUserPreferences(),"<button class='dialog-ok-button default-capable'>"+this.okButtonMessage+"</button><button class='keep-image-unchanged-button dialog-ok-button'>"+this.keepUnchangedButtonMessage+"</button><button class='dialog-cancel-button'>"+this.cancelButtonMessage+"</button>")};function JSPopupMenu(c,b,d){if(b==null||b.length===0){throw new Error("Cannot register a context menu on an empty list of elements")}JSComponent.call(this,c,"");this.sourceElements=b;if(!Array.isArray(b)){this.sourceElements=[b]}this.build=d;this.getHTMLElement().classList.add("popup-menu");document.body.appendChild(this.getHTMLElement());var a=this;this.registerEventListener(b,"contextmenu",function(e){e.preventDefault();if(JSPopupMenu.current!=null){JSPopupMenu.current.close()}a.showSourceElement(this,e)})}JSPopupMenu.prototype=Object.create(JSComponent.prototype);JSPopupMenu.prototype.constructor=JSPopupMenu;JSPopupMenu.closeOpenedMenu=function(){if(JSPopupMenu.current!=null){JSPopupMenu.current.close();return true}return false};JSPopupMenu.prototype.showSourceElement=function(d,e){this.menuItemListeners=[];var c=new JSPopupMenu.Builder();this.build(c,d);var b=c.items;if(b.length>0&&b[b.length-1]==JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM){b.pop()}var f=this.createMenuElement(b);this.getHTMLElement().appendChild(f);this.getHTMLElement().setAttribute("tabindex",1000);this.getHTMLElement().style.outline="none";this.getHTMLElement().style.outlineWidth="0";this.getHTMLElement().style.visibility="hidden";this.getHTMLElement().classList.add("visible");var a=e.clientX;if(f.clientWidth>window.innerWidth){a=0}else{if(a+f.clientWidth+20>window.innerWidth){a=Math.max(0,window.innerWidth-f.clientWidth-20)}}var g=e.clientY;if(f.clientHeight>window.innerHeight){g=0}else{if(g+f.clientHeight+10>window.innerHeight){g=window.innerHeight-f.clientHeight-10}}this.getHTMLElement().style.visibility="visible";this.getHTMLElement().style.left=a+"px";this.getHTMLElement().style.top=g+"px";this.getHTMLElement().focus();JSPopupMenu.current=this};JSPopupMenu.prototype.createMenuElement=function(b,g){if(g===undefined){g=1000}var f=document.createElement("ul");f.classList.add("items");f.style.zIndex=g;f.addEventListener("contextmenu",function(h){h.preventDefault()});var a=document.createElement("li");a.classList.add("item");a.classList.add("back");a.textContent="";this.registerEventListener(a,"click",function(j){var h=f.parentElement.tagName.toLowerCase()!="li";if(h){JSPopupMenu.closeOpenedMenu()}else{f.classList.remove("visible")}});f.appendChild(a);for(var d=0;d<b.length;d++){var e=b[d];var c=document.createElement("li");if(e==JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM){c.classList.add("separator")}else{this.initMenuItemElement(c,e,g)}f.appendChild(c)}return f};JSPopupMenu.prototype.initMenuItemElement=function(d,f,h){var b=this;var a=document.createElement("img");if(f.iconPath!=null){a.src=f.iconPath;a.classList.add("visible")}if(f.mode!==undefined){d.classList.add("checkable");if(f.selected===true){d.classList.add("selected")}if(f.iconPath==null){a=document.createElement("span");a.innerHTML=f.selected===true?"":"&nbsp;";a.classList.add("visible")}}var e=document.createElement("span");e.textContent=JSComponent.substituteWithLocale(this.getUserPreferences(),f.label);d.classList.add("item");a.classList.add("icon");d.appendChild(a);d.appendChild(e);if(Array.isArray(f.subItems)){d.classList.add("sub-menu");var c=this.createMenuElement(f.subItems,h+1);this.registerEventListener(d,"click",function(j){c.classList.add("visible")});this.registerEventListener(d,"mouseover",function(k){var m=d.getBoundingClientRect();c.style.position="fixed";var j=m.left+d.clientWidth;if(c.clientWidth>window.innerWidth){j=0}else{if(j+c.clientWidth>window.innerWidth){j=window.innerWidth-c.clientWidth}}var l=m.top;if(c.clientHeight>window.innerHeight){l=0}else{if(l+c.clientHeight>window.innerHeight){l=window.innerHeight-c.clientHeight}}c.style.left=j;c.style.top=l});d.appendChild(c)}if(typeof f.itemSelectedListener=="function"){var g=function(){b.close();setTimeout(function(){f.itemSelectedListener()},50)};d.addEventListener("click",g);d.addEventListener("mouseup",g);this.menuItemListeners.push(function(){d.removeEventListener("click",g);d.removeEventListener("mouseup",g)})}};JSPopupMenu.prototype.close=function(){this.getHTMLElement().removeAttribute("tabindex");this.getHTMLElement().classList.remove("visible");JSPopupMenu.current=null;if(this.menuItemListeners){for(var a=0;a<this.menuItemListeners.length;a++){this.menuItemListeners[a]()}}this.menuItemListeners=null;this.getHTMLElement().innerHTML=""};JSPopupMenu.Builder=function(){this.items=[]};JSPopupMenu.Builder.prototype=Object.create(JSPopupMenu.Builder.prototype);JSPopupMenu.Builder.prototype.constructor=JSPopupMenu.Builder;JSPopupMenu.Builder.prototype.addCheckBoxItem=function(b,a,c){this.addNewMenuItem(b,undefined,a,c===true,"checkbox")};JSPopupMenu.Builder.prototype.addRadioButtonItem=function(b,a,c){this.addNewMenuItem(b,undefined,a,c===true,"radiobutton")};JSPopupMenu.Builder.prototype.addMenuItem=function(d,g,b){var h=null;var e=null;var b=null;var j=undefined;var c=undefined;if(d instanceof ResourceAction){var a=d;if(!a.isEnabled()||a.getValue(ResourceAction.VISIBLE)===false){return this}h=a.getValue(ResourceAction.POPUP)||a.getValue(AbstractAction.NAME);var f=a.getValue(AbstractAction.SMALL_ICON);if(f!=null){e=ZIPTools.getScriptFolder()+"/"+f}if(a.getValue(ResourceAction.TOGGLE_BUTTON_GROUP)){c=a.getValue(AbstractAction.SELECTED_KEY)}b=function(){a.actionPerformed()}}else{if(typeof b=="function"){e=d;h=g;b=b}else{h=d;b=g}}this.addNewMenuItem(h,e,b,c,c!==undefined?"radiobutton":undefined);return this};JSPopupMenu.Builder.prototype.addNewMenuItem=function(b,c,a,d,e){this.items.push({label:b,iconPath:c,itemSelectedListener:a,selected:d,mode:e})};JSPopupMenu.Builder.prototype.addSubMenu=function(g,f){if(g.isEnabled()){var c=g.getValue(ResourceAction.POPUP)||g.getValue(AbstractAction.NAME);var e=g.getValue(AbstractAction.SMALL_ICON);var d=null;if(e!=null){d=ZIPTools.getScriptFolder()+"/"+e}var b=new JSPopupMenu.Builder();f(b);var a=b.items;if(a.length>0){this.items.push({label:c,iconPath:d,subItems:a})}}return this};JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM={};JSPopupMenu.Builder.prototype.addSeparator=function(){if(this.items.length>0&&this.items[this.items.length-1]!=JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM){this.items.push(JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM)}return this};if(!JSPopupMenu.globalCloserRegistered){var listener=function(a){if(JSPopupMenu.current!=null&&!JSComponent.isElementContained(a.target,JSPopupMenu.current.getHTMLElement())){if(JSPopupMenu.closeOpenedMenu()){a.stopPropagation();a.preventDefault()}}};document.addEventListener("click",listener);document.addEventListener("touchstart",listener);document.addEventListener("keydown",function(b){if(b.key=="Escape"||b.keyCode==27){JSDialog.closeTopMostDialog();JSPopupMenu.closeOpenedMenu()}else{if(b.keyCode==13&&JSDialog.getTopMostDialog()!=null){var a=JSDialog.getTopMostDialog().findElement(".default-capable");if(a!=null){a.click()}}}});JSPopupMenu.globalCloserRegistered=true}function JSSpinner(a,d,c){if(d.tagName.toUpperCase()!="SPAN"){throw new Error("JSSpinner: please provide a span for the spinner to work - "+d+" is not a span")}if(!c){c={}}this.checkMinimumMaximum(c.minimum,c.maximum);if(!isNaN(parseFloat(c.minimum))){this.minimum=c.minimum}if(!isNaN(parseFloat(c.maximum))){this.maximum=c.maximum}if(isNaN(parseFloat(c.stepSize))){this.stepSize=1}else{this.stepSize=c.stepSize}if(typeof c.nullable=="boolean"){this.nullable=c.nullable}else{this.nullable=false}if(c.format instanceof Format){this.format=c.format}else{this.format=new DecimalFormat()}var b=this;JSComponent.call(this,a,d,true);d.classList.add("spinner");this.textInput=document.createElement("input");this.textInput.type="text";d.appendChild(this.textInput);this.registerEventListener(this.textInput,"focus",function(e){b.updateUI()});this.registerEventListener(this.textInput,"focusout",function(e){b.updateUI()});this.registerEventListener(this.textInput,"input",function(f){if(b.isFocused()){var g=new ParsePosition(0);var e=b.parseValueFromInput(g);if(g.getIndex()!=b.textInput.value.length||e==null&&!b.nullable||(b.minimum!=null&&e<b.minimum)||(b.maximum!=null&&e>b.maximum)){b.textInput.style.color="red"}else{b.textInput.style.color=null;b.value=e}}});this.registerEventListener(this.textInput,"blur",function(g){var e=b.parseValueFromInput();if(e==null&&!b.nullable){var f=b.value;if(f==null){f=b.getDefaultValue()}e=f}b.textInput.style.color=null;b.setValue(e)});this.initIncrementDecrementButtons(d);Object.defineProperty(this,"width",{get:function(){return d.style.width},set:function(e){d.style.width=e}});Object.defineProperty(this,"parentElement",{get:function(){return d.parentElement}});Object.defineProperty(this,"previousElementSibling",{get:function(){return d.previousElementSibling}});Object.defineProperty(this,"style",{get:function(){return d.style}});this.setValue(c.value)}JSSpinner.prototype=Object.create(JSComponent.prototype);JSSpinner.prototype.constructor=JSSpinner;JSSpinner.prototype.getValue=function(){return this.value};JSSpinner.prototype.setValue=function(a){if(a instanceof Big){a=parseFloat(a)}if(a!=null&&typeof a!="number"){throw new Error("JSSpinner: Expected values of type number")}if(a==null&&!this.nullable){a=this.getDefaultValue()}if(a!=null&&this.minimum!=null&&a<this.minimum){a=this.minimum}if(a!=null&&this.maximum!=null&&a>this.maximum){a=this.maximum}if(a!=this.value){this.value=a;this.updateUI()}};JSSpinner.prototype.checkMinimumMaximum=function(a,b){if(a!=null&&b!=null&&a>b){throw new Error("JSSpinner: minimum is not below maximum - minimum = "+a+" maximum = "+b)}};JSSpinner.prototype.isNullable=function(){return this.nullable};JSSpinner.prototype.setNullable=function(b){var a=this.nullable&&this.value===null;this.nullable=b;if(!b&&a){this.value=this.getDefaultValue()}};JSSpinner.prototype.getFormat=function(){return this.format};JSSpinner.prototype.setFormat=function(a){this.format=a;this.updateUI()};JSSpinner.prototype.getMinimum=function(){return this.minimum};JSSpinner.prototype.setMinimum=function(a){this.checkMinimumMaximum(a,this.maximum);this.minimum=a};JSSpinner.prototype.getMinimum=function(){return this.minimum};JSSpinner.prototype.setMinimum=function(a){this.checkMinimumMaximum(a,this.maximum);this.minimum=a};JSSpinner.prototype.getMaximum=function(){return this.maximum};JSSpinner.prototype.setMaximum=function(a){this.checkMinimumMaximum(this.minimum,a);this.maximum=a};JSSpinner.prototype.getStepSize=function(){return this.stepSize};JSSpinner.prototype.setStepSize=function(a){this.stepSize=a};JSSpinner.prototype.getInputElement=function(){return this.textInput};JSSpinner.prototype.addEventListener=function(){return this.textInput.addEventListener.apply(this.textInput,arguments)};JSSpinner.prototype.removeEventListener=function(){return this.textInput.removeEventListener.apply(this.textInput,arguments)};JSSpinner.prototype.updateUI=function(){this.textInput.value=this.formatValueForUI(this.value)};JSSpinner.prototype.parseValueFromInput=function(a){if(!this.textInput.value||this.textInput.value.trim()==""){if(this.nullable){return null}else{return this.value}}return this.format.parse(this.textInput.value,a!=undefined?a:new ParsePosition(0))};JSSpinner.prototype.getDefaultValue=function(){var a=0;if(this.minimum!=null&&this.minimum>a){a=this.minimum}if(this.maximum!=null&&this.maximum<a){a=this.maximum}return a};JSSpinner.prototype.formatValueForUI=function(a){if(a==null){return""}if(!this.isFocused()){return this.format.format(a)}if(this.noGroupingFormat==null||this.lastFormat!==this.format){this.lastFormat=this.format;this.noGroupingFormat=this.lastFormat.clone();this.noGroupingFormat.setGroupingUsed(false)}return this.noGroupingFormat.format(a)};JSSpinner.prototype.isFocused=function(){return this.textInput===document.activeElement};JSSpinner.prototype.initIncrementDecrementButtons=function(e){var b=this;this.incrementButton=document.createElement("button");this.incrementButton.setAttribute("increment","");this.incrementButton.textContent="+";this.incrementButton.tabIndex=-1;e.appendChild(this.incrementButton);this.decrementButton=document.createElement("button");this.decrementButton.setAttribute("decrement","");this.decrementButton.textContent="-";this.decrementButton.tabIndex=-1;e.appendChild(this.decrementButton);var g=function(j){var h=b.value;if(h==null||isNaN(h)){h=b.getDefaultValue()}b.setValue(h+b.stepSize);b.fireInputEvent()};var d=function(j){var h=b.value;if(h==null||isNaN(h)){h=b.getDefaultValue()}b.setValue(h-b.stepSize);b.fireInputEvent()};var a=function(n,l,o){if(b.isFocused()){n.preventDefault()}var m=function(p){clearTimeout(k);l.removeEventListener("mouseleave",m);l.removeEventListener("mouseup",m)};var h=function(p){clearTimeout(k);l.removeEventListener("click",h);o()};l.addEventListener("click",h);var j=function(){o();k=setTimeout(j,80)};var k=setTimeout(function(){l.removeEventListener("click",h);l.addEventListener("mouseleave",m);l.addEventListener("mouseup",m);j()},400)};var f=function(h){a(h,b.incrementButton,g)};this.registerEventListener(b.incrementButton,"mousedown",f);var c=function(h){a(h,b.decrementButton,d)};this.registerEventListener(b.decrementButton,"mousedown",c);this.registerEventListener(b.textInput,"keydown",function(h){var j=KeyStroke.getKeyStrokeForEvent(h,"keydown");if(j.lastIndexOf(" UP")>0){h.stopImmediatePropagation();g()}else{if(j.lastIndexOf(" DOWN")>0){h.stopImmediatePropagation();d()}}});this.registerEventListener(this.textInput,"focus",function(h){b.updateUI()})};JSSpinner.prototype.fireInputEvent=function(){var a=document.createEvent("Event");a.initEvent("input",true,true);this.textInput.dispatchEvent(a)};JSSpinner.prototype.setEnabled=function(a){this.textInput.disabled=!a;this.incrementButton.disabled=!a;this.decrementButton.disabled=!a};function JSComboBox(a,d,c){JSComponent.call(this,a,d,true);if(!c){c={}}if(typeof c.nullable!="boolean"){c.nullable=false}if(!Array.isArray(c.availableValues)||c.availableValues.length<=0){throw new Error("JSComboBox: No available values provided")}if(typeof c.renderCell!="function"){c.renderCell=function(f,e){e.textContent=f==null?"":f.toString()}}if(c.value==null&&!c.nullable){c.value=c.availableValues[0]}this.options=c;d.classList.add("combo-box");this.button=document.createElement("button");d.appendChild(this.button);this.preview=document.createElement("div");this.preview.classList.add("preview");this.button.appendChild(this.preview);this.initSelectionPanel();var b=this;this.registerEventListener(this.button,"click",function(e){e.stopImmediatePropagation();b.openSelectionPanel(e.pageX,e.pageY)});this.setSelectedItem(c.value)}JSComboBox.prototype=Object.create(JSComponent.prototype);JSComboBox.prototype.constructor=JSComboBox;JSComboBox.prototype.initSelectionPanel=function(){var d=document.createElement("div");d.classList.add("selection-panel");for(var b=0;b<this.options.availableValues.length;b++){var c=document.createElement("div");c.value=this.options.availableValues[b];this.options.renderCell(c.value,c);d.appendChild(c)}this.getHTMLElement().appendChild(d);this.selectionPanel=d;var a=this;this.registerEventListener(d.children,"click",function(e){a.selectedItem=this.value;a.updateUI();if(typeof a.options.selectionChanged=="function"){a.options.selectionChanged(a.selectedItem)}})};JSComboBox.prototype.getSelectedItem=function(){return this.selectedItem};JSComboBox.prototype.setSelectedItem=function(c){var a=false;for(var b=0;b<this.options.availableValues.length;b++){if(this.areValuesEqual(c,this.options.availableValues[b])){a=true;break}}if(!a){c=null}if(c==null&&!this.options.nullable){c=this.options.availableValues[0]}if(!this.areValuesEqual(c,this.selectedItem)){this.selectedItem=c;this.updateUI()}};JSComboBox.prototype.setEnabled=function(a){this.button.disabled=!a};JSComboBox.prototype.openSelectionPanel=function(c,a){var d=this.selectionPanel;var b=function(){document.removeEventListener("click",b);d.style.opacity=0;d.style.display="none"};d.style.display="block";d.style.opacity=1;d.style.left=c+d.clientWidth>window.width?window.width-d.clientWidth:c;d.style.top=a+d.clientHeight>window.innerHeight?window.innerHeight-d.clientHeight:a;document.addEventListener("click",b)};JSComboBox.prototype.updateUI=function(){this.preview.innerHTML="";this.options.renderCell(this.getSelectedItem(),this.preview)};JSComboBox.prototype.areValuesEqual=function(b,a){return JSON.stringify(b)==JSON.stringify(a)};function JSTreeTable(a,b,c,d){JSComponent.call(this,b,a,true);this.state={};this.selectedRowsValues=[];this.tableElement=document.createElement("div");this.tableElement.classList.add("tree-table");a.appendChild(this.tableElement);this.setModel(c);this.setData(d?d:[])}JSTreeTable.prototype=Object.create(JSComponent.prototype);JSTreeTable.prototype.constructor=JSTreeTable;JSTreeTable.prototype.setData=function(b){this.data=b;var a=this.getExpandedRowsValues();if(a!=null){this.updateState({expandedRowsValues:a})}if(this.isDisplayed()){this.generateTableRows();this.fireExpandedRowsChanged()}};JSTreeTable.prototype.updateRowData=function(e,a){if(this.isDisplayed()){if(!this.state.sort||this.state.sort.columnName==null||(a!==undefined&&this.state.sort.columnName!=a)){var g=this.getColumnNames();var c=a!==undefined?g.indexOf(a):0;if(c>=0){var d=this.bodyElement.children;for(i=0;i<d.length;i++){var f=d[i];if(f._model.value===e){if(a!==undefined){this.model.renderCell(e,a,f.children[c])}else{for(var b=0;b<g.length;b++){this.model.renderCell(e,g[b],f.children[b])}}break}}}}else{this.generateTableRows()}}};JSTreeTable.prototype.getData=function(){return this.data};JSTreeTable.prototype.setModel=function(a){this.model=a;this.updateState(a.initialState);this.columnsWidths=this.getColumnsWidthByName();if(this.isDisplayed()){this.generateTableHeaders();this.generateTableRows()}};JSTreeTable.prototype.isDisplayed=function(){return window.getComputedStyle(this.getHTMLElement()).display!="none"};JSTreeTable.prototype.setSelectedRowsByValue=function(a){this.selectedRowsValues=a.slice(0);if(this.isDisplayed()){this.expandGroupOfSelectedRows(a);var d=this.bodyElement.children;for(var b=0;b<d.length;b++){var e=d[b];e._model.selected=false;e.classList.remove("selected")}for(var c=0;c<a.length;c++){for(var b=0;b<d.length;b++){var e=d[b];if(e._model.value===a[c]){this.selectRowAt(b);break}}}this.scrollToSelectedRowsIfNotVisible()}};JSTreeTable.prototype.selectRowAt=function(a){var d=this.bodyElement.children;var e=d[a];e._model.selected=true;e.classList.add("selected");if(e._model.group&&e._model.collapsed===false){for(var b=a+1;b<d.length;b++){var c=d[b];if(c._model.parentGroup&&c._model.parentGroup.value===e._model.value){this.selectRowAt(b)}}}};JSTreeTable.prototype.expandGroupOfSelectedRows=function(b){if(this.isDisplayed()){var f=this.bodyElement.children;for(var d=0;d<b.length;d++){for(var c=0;c<f.length;c++){var g=f[c];if(g._model.value===b[d]){if(g._model.hidden){this.expandOrCollapseRow(g._model.parentGroup,true);for(var a=c-1;a>=0;a--){if(g._model.parentGroup.value===f[a]._model.value){f[a]._model.collapsed=false;f[a].classList.remove("collapsed");for(a++;a<f.length;a++){var e=f[a];if(e._model.parentGroup&&e._model.parentGroup.value===g._model.parentGroup.value){e._model.hidden=false;e.style.display="flex"}}if(g._model.parentGroup.parentGroup){this.expandGroupOfSelectedRows([g._model.parentGroup.value])}break}}}break}}}}};JSTreeTable.prototype.scrollToSelectedRowsIfNotVisible=function(){var e=this.bodyElement.querySelectorAll(".selected");if(e.length>0){for(var b=0;b<e.length;b++){var c=e[b];var a=c.offsetTop-this.bodyElement.offsetTop;var d=a+c.clientHeight;if(a>=this.bodyElement.scrollTop&&d<=(this.bodyElement.scrollTop+this.bodyElement.clientHeight)){return}}this.bodyElement.scrollTop=e[0].offsetTop-this.bodyElement.offsetTop}};JSTreeTable.prototype.getExpandedRowsValues=function(){if(this.state&&this.state.expandedRowsValues){return this.state.expandedRowsValues}return undefined};JSTreeTable.prototype.fireExpandedRowsChanged=function(){if(this.state.expandedRowsValues!=null){this.updateExpandedRowsIndices();this.model.expandedRowsChanged(this.state.expandedRowsValues,this.state.expandedRowsIndices)}};JSTreeTable.prototype.updateExpandedRowsIndices=function(){if(this.state.expandedRowsValues!=null&&this.data!=null&&this.data.sortedList!=null){this.state.expandedRowsIndices=[];for(var a=0;a<this.data.sortedList.length;a++){var b=this.data.sortedList[a].value;if(this.state.expandedRowsValues.indexOf(b)>-1){this.state.expandedRowsIndices.push(a)}}}};JSTreeTable.prototype.fireSortChanged=function(){if(this.state.sort!=null){this.model.sortChanged(this.state.sort)}};JSTreeTable.prototype.updateState=function(a){if(a){CoreTools.merge(this.state,a)}};JSTreeTable.prototype.getValueComparator=function(){return this.model.getValueComparator(this.state.sort)};JSTreeTable.prototype.generateTableHeaders=function(){var b=this;var e=this.tableElement.querySelector("[header]");if(!e){e=document.createElement("div");e.setAttribute("header","true");this.tableElement.appendChild(e);this.tableElement.appendChild(document.createElement("br"))}e.innerHTML="";var d=this.getColumns();for(var c=0;c<d.length;c++){var f=d[c];var a=document.createElement("div");e.appendChild(a);a.setAttribute("cell","true");a.textContent=f.label;a.dataset.name=f.name;if(this.state.sort&&this.state.sort.columnName==f.name){a.classList.add("sort");if(this.state.sort.direction=="desc"){a.classList.add("descending")}}a.style.width=b.getColumnWidth(f.name)}this.registerEventListener(e.children,"click",function(h){var g=this.dataset.name;var j=this.classList.contains("sort")&&!this.classList.contains("descending");b.sortTable(g,j)})};JSTreeTable.prototype.generateTableRows=function(){var a=this;var b=function(){var e=0;var g=a.bodyElement;if(g){e=g.scrollTop;g.parentElement.removeChild(g)}var g=a.bodyElement=document.createElement("div");g.setAttribute("body","true");var k=a.data.sortedList=[];var d=a.getValueComparator();var h=function(p,q,v){var u=q>0;var x=d!=null?p.sort(function(z,y){return d(z.value,y.value)}):p;var r=[];for(var t=0;t<x.length;t++){var o=x[t];var w=a.selectedRowsValues.indexOf(o.value)>-1;var s=(v&&v.selected)||w;var n={value:o.value,indentation:q,group:false,parentGroup:v,selected:s,hidden:u,collapsed:undefined,childrenItems:undefined,setCollapsed:function(){},isInCollapsedGroup:function(){var y=this;while((y=y.parentGroup)){if(y.collapsed===true){return true}}return false}};r.push(n);k.push(n);if(Array.isArray(o.children)&&o.children.length>0){n.group=true;n.collapsed=true;n.childrenItems=h(o.children,q+1,n);n.setCollapsed=(function(y){return function(A){y.collapsed=A;for(var z=0;z<y.childrenItems.length;z++){y.childrenItems[z].hidden=A}}})(n)}}return r};h(a.data.slice(0),0);a.updateExpandedRowsIndices();if(a.state.expandedRowsIndices&&a.state.expandedRowsIndices.length>0){var c=[];for(var f=0;f<a.state.expandedRowsIndices.length;f++){var l=k[a.state.expandedRowsIndices[f]];if(l){c.push(l.value);if(!l.isInCollapsedGroup()){l.setCollapsed(false)}}}if(c.length>0){a.state.expandedRowsValues=c}}var j=a.getColumnNames();for(var f=0;f<k.length;f++){var m=a.generateRowElement(j,f,k[f]);g.appendChild(m)}a.tableElement.appendChild(g);g.scrollTop=e;delete a.generatingTableRows};if(this.data){if(a.bodyElement){if(!this.generatingTableRows){this.generatingTableRows=true;setTimeout(b,0)}}else{b()}}};JSTreeTable.prototype.generateRowElement=function(e,f,d){var b=this;var k=document.createElement("div");k.setAttribute("row","true");var g=null;for(var c=0;c<e.length;c++){var a=e[c];var h=document.createElement("div");h.setAttribute("cell","true");this.model.renderCell(d.value,a,h);h.style.width=this.getColumnWidth(a);if(g==null||h.classList.contains("main")){g=h}k.appendChild(h)}if(g!=null){g.classList.add("main");g.style.paddingLeft=(15+d.indentation*10)+"px";if(d.group){this.registerEventListener(g,"click",function(m){if(m.clientX<16){m.stopImmediatePropagation();var j=g.parentElement.classList.contains("collapsed");b.expandOrCollapseRow(d,j);g.parentElement._model.collapsed=!j;if(j){g.parentElement.classList.remove("collapsed")}else{g.parentElement.classList.add("collapsed")}var n=b.bodyElement.children;for(var l=0;l<n.length;l++){var o=n[l];var p=n[l]._model.isInCollapsedGroup();if(j&&n[l]._model.hidden!==p){n[l].classList.add("selected")}n[l]._model.hidden=p;n[l].style.display=p?"none":"flex"}}return false});k.classList.add("group");if(d.collapsed){k.classList.add("collapsed")}}}if(d.hidden){k.style.display="none"}if(d.selected){k.classList.add("selected")}this.registerEventListener(k,"click",function(m){var n=this;var l=n._model.value;if(OperatingSystem.isMacOSX()?m.metaKey:m.ctrlKey){var j=b.selectedRowsValues.indexOf(l);if(j<0){n.classList.add("selected");b.selectedRowsValues.push(l)}else{n.classList.remove("selected");b.selectedRowsValues.splice(j,1)}}else{n.classList.add("selected");b.selectedRowsValues=[l]}if(typeof b.model.selectionChanged=="function"){b.model.selectionChanged(b.selectedRowsValues)}});this.registerEventListener(k,"dblclick",function(l){if(typeof b.model.rowDoubleClicked=="function"){var m=this;var j=m._model.value;b.model.rowDoubleClicked(j)}});k._model=d;return k};JSTreeTable.prototype.expandOrCollapseRow=function(d,c){var a=this;if(a.state.expandedRowsValues==null){a.state.expandedRowsValues=[]}var b=a.state.expandedRowsValues.indexOf(d.value);if(c){if(b<0){a.state.expandedRowsValues.push(d.value);this.fireExpandedRowsChanged()}}else{if(b>=0){a.state.expandedRowsValues.splice(b,1);this.fireExpandedRowsChanged()}}};JSTreeTable.prototype.sortTable=function(a,b){if(!this.state.sort){this.state.sort={}}this.state.sort.columnName=a;this.state.sort.direction=b?"desc":"asc";this.fireSortChanged(this.state.sort)};JSTreeTable.prototype.getColumnWidth=function(a){return this.columnsWidths[a]};JSTreeTable.prototype.getColumns=function(){return this.model.columns.slice(0)};JSTreeTable.prototype.getColumnNames=function(){var b=new Array(this.model.columns.length);for(var a=0;a<b.length;a++){b[a]=this.model.columns[a].name}return b};JSTreeTable.prototype.getColumnsWidthByName=function(){var b=this.model.columns;var e={};for(var a=0;a<b.length;a++){var d=b[a];var c=d.defaultWidth?d.defaultWidth:"6rem";e[d.name]=c}return e};function ColorButton(b,a){JSComponent.call(this,b,document.createElement("span"),true);if(a!==undefined){this.observer=a}this.getHTMLElement().innerHTML='<button class="color-button"><div class="color-preview" /></button>';this.button=this.findElement(".color-button");var c=this;this.registerEventListener(this.button,"click",function(d){c.openColorDialog(b)});this.colorOverview=this.findElement(".color-preview")}ColorButton.prototype=Object.create(JSComponent.prototype);ColorButton.prototype.constructor=ColorButton;ColorButton.prototype.getColor=function(){return this.color};ColorButton.prototype.setColor=function(a){this.color=a;this.colorOverview.style.backgroundColor=a!=null?ColorTools.integerToHexadecimalString(a):"transparent"};ColorButton.prototype.getColorDialogTitle=function(){return this.colorDialogTitle};ColorButton.prototype.setColorDialogTitle=function(a){this.colorDialogTitle=a};ColorButton.prototype.setEnabled=function(a){this.button.disabled=!a};ColorButton.prototype.openColorDialog=function(a){var c=this;var b=new JSColorChooserDialog(this.getUserPreferences(),this.colorDialogTitle,this.color,{applier:function(){var d=b.getSelectedColor();if(d!=null){d|=4278190080}c.setColor(d);var e=a.getRecentColors().slice(0);var f=e.indexOf(d);if(f!=0){if(f>0){e.splice(f,1)}else{e.length=Math.min(e.length,13)}e.splice(0,0,d);a.setRecentColors(e)}if(c.observer!==undefined&&typeof c.observer.colorChanged=="function"){c.observer.colorChanged(d)}}});b.displayView()};function JSColorChooser(a,c){var b="<div class='picker'></div><hr /><div class='custom-color-editor'>  <input class='not-focusable-at-opening' type='text' value='FFFFFF' />  <div class='custom-color-preview'></div><div class='current-color-preview'></div></div><div class='recent-colors'></div>";JSComponent.call(this,a,b);if(c!=null){c.appendChild(this.getHTMLElement())}this.getHTMLElement().classList.add("color-chooser");this.pickerElement=this.findElement(".picker");this.recentColorsContainerElement=this.findElement(".recent-colors");this.customColorEditorInput=this.findElement(".custom-color-editor input");this.customColorEditorPreview=this.findElement(".custom-color-preview");this.currentColorEditorPreview=this.findElement(".current-color-preview");this.createPickerColorTiles();this.initCustomColorEditor()}JSColorChooser.prototype=Object.create(JSComponent.prototype);JSColorChooser.prototype.constructor=JSColorChooser;JSColorChooser.prototype.createPickerColorTiles=function(){var b=["#BEBD7F","#C2B078","#C6A664","#E5BE01","#CDA434","#A98307","#E4A010","#DC9D00","#8A6642","#C7B446","#EAE6CA","#E1CC4F","#E6D690","#EDFF21","#F5D033","#F8F32B","#9E9764","#999950","#F3DA0B","#FAD201","#AEA04B","#FFFF00","#9D9101","#F4A900","#D6AE01","#F3A505","#EFA94A","#6A5D4D","#705335","#F39F18","#ED760E","#C93C20","#CB2821","#FF7514","#F44611","#FF2301","#FFA420","#F75E25","#F54021","#D84B20","#EC7C26","#E55137","#C35831","#AF2B1E","#A52019","#A2231D","#9B111E","#75151E","#5E2129","#412227","#642424","#781F19","#C1876B","#A12312","#D36E70","#EA899A","#B32821","#E63244","#D53032","#CC0605","#D95030","#F80000","#FE0000","#CB3234","#B32428","#721422","#B44C43","#6D3F5B","#922B3E","#DE4C8A","#641C34","#6C4675","#A03472","#4A192C","#924E7D","#A18594","#CF3476","#8673A1","#6C6874","#354D73","#1F3438","#20214F","#1D1E33","#18171C","#1E2460","#3E5F8A","#26252D","#025669","#0E294B","#231A24","#3B83BD","#1E213D","#606E8C","#2271B3","#063971","#3F888F","#1B5583","#1D334A","#256D7B","#252850","#49678D","#5D9B9B","#2A6478","#102C54","#316650","#287233","#2D572C","#424632","#1F3A3D","#2F4538","#3E3B32","#343B29","#39352A","#31372B","#35682D","#587246","#343E40","#6C7156","#47402E","#3B3C36","#1E5945","#4C9141","#57A639","#BDECB6","#2E3A23","#89AC76","#25221B","#308446","#3D642D","#015D52","#84C3BE","#2C5545","#20603D","#317F43","#497E76","#7FB5B5","#1C542D","#193737","#008F39","#00BB2D","#78858B","#8A9597","#7E7B52","#6C7059","#969992","#646B63","#6D6552","#6A5F31","#4D5645","#4C514A","#434B4D","#4E5754","#464531","#434750","#293133","#23282B","#332F2C","#686C5E","#474A51","#2F353B","#8B8C7A","#474B4E","#B8B799","#7D8471","#8F8B66","#D7D7D7","#7F7679","#7D7F7D","#B5B8B1","#6C6960","#9DA1AA","#8D948D","#4E5452","#CAC4B0","#909090","#82898F","#D0D0D0","#898176","#826C34","#955F20","#6C3B2A","#734222","#8E402A","#59351F","#6F4F28","#5B3A29","#592321","#382C1E","#633A34","#4C2F27","#45322E","#403A3A","#212121","#A65E2E","#79553D","#755C48","#4E3B31","#763C28","#FDF4E3","#E7EBDA","#F4F4F4","#282828","#0A0A0A","#A5A5A5","#8F8F8F","#FFFFFF","#1C1C1C","#F6F6F6","#1E1E1E","#D7D7D7","#9C9C9C","#828282"];this.colorTileElements=[this.currentColorEditorPreview];for(var e=0;e<b.length;e++){var a=b[e];var f=this.createColorTile(a);this.pickerElement.appendChild(f)}var d=this.getUserPreferences().getRecentColors();for(var e=0;e<d.length;e++){var a=ColorTools.integerToHexadecimalString(d[e]);var f=this.createColorTile(a);this.recentColorsContainerElement.appendChild(f)}var c=this;this.registerEventListener(this.colorTileElements,"click",function(g){c.selectColorTile(this)})};JSColorChooser.prototype.initCustomColorEditor=function(){var b=this;var c=null;if(!OperatingSystem.isInternetExplorerOrLegacyEdge()){c=document.createElement("input");c.type="color";c.classList.add("color-input");this.customColorEditorPreview.appendChild(c);var a=function(d){b.customColorEditorPreview.style.backgroundColor=c.value;b.customColorEditorInput.value=c.value.substring(1).toUpperCase();b.color=ColorTools.hexadecimalStringToInteger(c.value)};c.value="#010101";this.registerEventListener(c,"input",a)}this.registerEventListener(this.customColorEditorInput,"input",function(e){var d="#"+b.customColorEditorInput.value;if(d.match(/#[0-9a-fA-F]{3,6}/)){b.customColorEditorPreview.style.backgroundColor=d;b.color=ColorTools.hexadecimalStringToInteger(d);if(c!=null){c.value=d}}})};JSColorChooser.prototype.getColor=function(){return this.color};JSColorChooser.prototype.setColor=function(a){this.color=a;var b=a!=null?a:16777215;var c=this.findElement("[data-color='"+b+"']");if(c!=null){this.selectColorTile(c)}else{this.customColorEditorInput.value=ColorTools.integerToHexadecimalString(b).substring(1);this.customColorEditorPreview.style.backgroundColor=ColorTools.integerToHexadecimalString(b)}if(this.findElement(".color-input")!=null){this.findElement(".color-input").value=ColorTools.integerToHexadecimalString(b)}this.currentColorEditorPreview.style.backgroundColor=ColorTools.integerToHexadecimalString(b);this.currentColorEditorPreview.dataset.color=b};JSColorChooser.prototype.selectColorTile=function(d){for(var c=0;c<this.colorTileElements.length;c++){var b=this.colorTileElements[c];if(b==d){b.classList.add("selected")}else{b.classList.remove("selected")}}this.color=this.getTileColor(d);var a=ColorTools.integerToHexadecimalString(this.color);this.customColorEditorInput.value=a.substring(1);this.customColorEditorPreview.style.backgroundColor=this.customColorEditorInput.value;if(this.findElement(".color-input")!=null){this.findElement(".color-input").value=a}};JSColorChooser.prototype.getTileColor=function(a){return parseInt(a.dataset.color)};JSColorChooser.prototype.createColorTile=function(a){var b=document.createElement("div");b.dataset.color=ColorTools.hexadecimalStringToInteger(a);b.style.backgroundColor=a;this.colorTileElements.push(b);return b};function JSColorChooserDialog(c,f,b,a){var e='<div>  <div data-name="color-chooser"></div></div>';JSDialog.call(this,c,f,e,{applier:a.applier});this.getHTMLElement().classList.add("color-chooser-dialog");this.getHTMLElement().classList.add("small");this.colorChooser=new JSColorChooser(c,this.getElement("color-chooser"));this.colorChooser.setColor(b);var d=this;this.registerEventListener(this.colorChooser.colorTileElements,"dblclick",function(g){d.validate()})}JSColorChooserDialog.prototype=Object.create(JSDialog.prototype);JSColorChooserDialog.prototype.constructor=JSColorChooserDialog;JSColorChooserDialog.prototype.getSelectedColor=function(){return this.colorChooser.getColor()};JSColorChooserDialog.prototype.dispose=function(){this.colorChooser.dispose();JSDialog.prototype.dispose.call(this)};function TextureChoiceComponent(b,a){JSComponent.call(this,b,document.createElement("span"),true);this.controller=a;this.getHTMLElement().innerHTML='<button class="texture-button"><div class="texture-preview" /></button>';this.button=this.findElement(".texture-button");var c=this;this.registerEventListener(this.button,"click",function(e){c.openTextureDialog()});this.preview=this.findElement(".texture-preview");var d=function(){c.updateTexture(a.getTexture())};this.registerPropertyChangeListener(a,"TEXTURE",d);this.updateTexture(a.getTexture())}TextureChoiceComponent.prototype=Object.create(JSComponent.prototype);TextureChoiceComponent.prototype.constructor=TextureChoiceComponent;TextureChoiceComponent.prototype.updateTexture=function(b){if(b==null){this.preview.style.backgroundImage="none"}else{var a=this;TextureManager.getInstance().loadTexture(b.getImage(),{textureUpdated:function(c){a.preview.style.backgroundImage="url('"+c.src+"')"},textureError:function(c){console.error("Image cannot be loaded",c)}})}};TextureChoiceComponent.prototype.setEnabled=function(a){this.button.disabled=!a};TextureChoiceComponent.prototype.openTextureDialog=function(){var a=new JSTextureDialog(this.getUserPreferences(),this.controller);if(this.controller.getTexture()!=null){a.setSelectedTexture(this.controller.getTexture())}a.displayView()};TextureChoiceComponent.prototype.confirmDeleteSelectedCatalogTexture=function(){var a=this.getLocalizedLabelText("TextureChoiceComponent","confirmDeleteSelectedCatalogTexture.message").replace(/\<[^\>]*\>/g," ").replace(/[ ]+/g," ").replace(/^\s*/,"");return confirm(a)};function JSTextureDialog(e,f){this.controller=f;this.selectedTextureModel={texture:null,xOffset:0,yOffset:0,angleInRadians:0,scale:1};var m=function(o){var n=o.getCategory();var j=document.createElement("div");j.classList.add("item");j.innerHTML='<img src="'+o.getImage().getURL()+'" />'+n.getName()+" - "+o.getName();j._catalogTexture=o;return j};var d='<div class="columns-2">  <div class="column1">    <div class="texture-search"><input type="text" /></div>    <div class="texture-catalog-list"></div>    <div class="recent-textures"></div>  </div>  <div class="column2">    <div class="selected-texture-preview">      <div></div>    </div>    <div class="selected-texture-config label-input-grid">      <div>@{TextureChoiceComponent.xOffsetLabel.text}</div>      <div><span data-name="selected-texture-offset-x" /></div>      <div>@{TextureChoiceComponent.yOffsetLabel.text}</div>      <div><span data-name="selected-texture-offset-y" /></div>      <div>@{TextureChoiceComponent.angleLabel.text}</div>      <div><span data-name="selected-texture-angle" /></div>      <div>@{TextureChoiceComponent.scaleLabel.text}</div>      <div><span data-name="selected-texture-scale" /></div>    </div>    <hr />    <div class="imported-textures-panel">      <div><button import>@{TextureChoiceComponent.importTextureButton.text}</button></div>      <div><button disabled modify>@{TextureChoiceComponent.modifyTextureButton.text}</button></div>      <div><button disabled delete>@{TextureChoiceComponent.deleteTextureButton.text}</button></div>    </div>  </div></div>';JSDialog.call(this,e,f.getDialogTitle(),d,{applier:function(n){this.updateTextureTransform();var j=n.getSelectedTexture();f.setTexture(j);if(j!=null){f.addRecentTexture(j)}},disposer:function(j){e.getTexturesCatalog().removeTexturesListener(j.texturesCatalogListener)}});this.getHTMLElement().classList.add("texture-chooser-dialog");this.recentTexturesPanel=this.findElement(".recent-textures");this.catalogList=this.findElement(".texture-catalog-list");this.selectedTexturePreview=this.findElement(".selected-texture-preview > div");this.xOffsetInput=new JSSpinner(e,this.getElement("selected-texture-offset-x"),{value:0,minimum:0,maximum:100,stepSize:5});this.yOffsetInput=new JSSpinner(e,this.getElement("selected-texture-offset-y"),{value:0,minimum:0,maximum:100,stepSize:5});this.angleInput=new JSSpinner(e,this.getElement("selected-texture-angle"),{format:new IntegerFormat(),value:0,minimum:0,maximum:360,stepSize:15});this.scaleInput=new JSSpinner(e,this.getElement("selected-texture-scale"),{value:100,minimum:1,maximum:10000,stepSize:5});var h=this;this.registerEventListener([this.xOffsetInput,this.yOffsetInput,this.angleInput,this.scaleInput],"input",function(j){h.updateTextureTransform()});var l=e.getTexturesCatalog().getCategories();for(var b=0;b<l.length;b++){var g=l[b];for(var a=0;a<g.getTextures().length;a++){var k=g.getTextures()[a];h.catalogList.appendChild(m(k))}}this.texturesCatalogItems=this.catalogList.childNodes;var c=function(j){h.selectTexture(h.getCatalogTextureFromItem(this))};this.registerEventListener(this.texturesCatalogItems,"click",c);this.initCatalogTextureSearch(e);this.initRecentTextures();this.registerPropertyChangeListener(e,"RECENT_TEXTURES",function(j){h.initRecentTextures()});this.registerEventListener(this.findElements(".item"),"dblclick",function(j){h.validate()});this.initImportTexturesPanel();this.texturesCatalogListener=function(o){var q=o.getItem&&o.getItem();switch(o.getType()){case CollectionEvent.Type.ADD:h.searchInput.value="";var n=m(q);h.catalogList.appendChild(n);h.registerEventListener(n,"click",c);h.selectTexture(q);break;case CollectionEvent.Type.DELETE:var j=h.getCatalogTextureItem(q);h.catalogList.removeChild(j);var p=h.catalogList.querySelector(".item");if(p){h.selectTexture(h.getCatalogTextureFromItem(p))}break}};e.getTexturesCatalog().addTexturesListener(this.texturesCatalogListener)}JSTextureDialog.prototype=Object.create(JSDialog.prototype);JSTextureDialog.prototype.constructor=JSTextureDialog;JSTextureDialog.prototype.getSelectedTexture=function(){return new HomeTexture(this.selectedTextureModel.texture,this.selectedTextureModel.xOffset,this.selectedTextureModel.yOffset,this.selectedTextureModel.angleInRadians,this.selectedTextureModel.scale,true)};JSTextureDialog.prototype.setSelectedTexture=function(f){if(f!=null){this.selectedTextureModel.xOffset=f.getXOffset();this.selectedTextureModel.yOffset=f.getYOffset();this.selectedTextureModel.angleInRadians=f.getAngle();this.selectedTextureModel.scale=f.getScale();this.xOffsetInput.setValue(this.selectedTextureModel.xOffset*100);this.yOffsetInput.setValue(this.selectedTextureModel.yOffset*100);this.angleInput.setValue(Math.toDegrees(this.selectedTextureModel.angleInRadians));this.scaleInput.setValue(this.selectedTextureModel.scale*100);var b=f.getImage().getURL();var e=this.getUserPreferences().getTexturesCatalog().getCategories();var g=null;for(var d=0;d<e.length&&g===null;d++){var a=e[d].getTextures();for(var c=0;c<a.length;c++){if(b==a[c].getImage().getURL()){g=a[c];break}}}if(g!==null){this.selectTexture(g)}else{this.selectTexture(f)}}else{this.selectedTexturePreview.style.backgroundImage="none"}this.updateTextureTransform()};JSTextureDialog.prototype.selectTexture=function(e){this.selectedTextureModel.texture=e;var f=false;if(e!=null){for(var c=0;c<this.texturesCatalogItems.length;c++){this.texturesCatalogItems[c].classList.remove("selected")}if(e instanceof CatalogTexture){var d=this.getCatalogTextureItem(e);d.classList.add("selected");var a=this.catalogList;setTimeout(function(){var g=d.offsetTop-a.offsetTop;var h=g+d.clientHeight;if(g<a.scrollTop||h>(a.scrollTop+a.clientHeight)){a.scrollTop=g-a.offsetTop}},10);this.selectedTexturePreview.style.backgroundImage="url('"+d.querySelector("img").src+"')";f=e!=null&&e.isModifiable()}else{var b=this;TextureManager.getInstance().loadTexture(e.getImage(),{textureUpdated:function(g){b.selectedTexturePreview.style.backgroundImage="url('"+g.src+"')"},textureError:function(g){b.selectedTexturePreview.style.backgroundImage="none"}})}}else{b.selectedTexturePreview.style.backgroundImage="none"}this.modifyTextureButton.disabled=!f;this.deleteTextureButton.disabled=!f};JSTextureDialog.prototype.updateTextureTransform=function(){this.selectedTextureModel.xOffset=this.xOffsetInput.getValue()/100;this.selectedTextureModel.yOffset=this.yOffsetInput.getValue()/100;this.selectedTextureModel.angleInRadians=Math.toRadians(this.angleInput.getValue());this.selectedTextureModel.scale=this.scaleInput.getValue()/100;this.selectedTexturePreview.style.transform=" rotate("+this.angleInput.getValue()+"deg)"};JSTextureDialog.prototype.getCatalogTextureItem=function(e){if(e!=null){var a=e.getImage().getURL();for(var b=0;b<this.texturesCatalogItems.length;b++){var d=this.texturesCatalogItems[b];var c=this.getCatalogTextureFromItem(d).getImage().getURL();if(a==c){return d}}}return null};JSTextureDialog.prototype.getCatalogTextureFromItem=function(a){return a._catalogTexture};JSTextureDialog.prototype.initCatalogTextureSearch=function(a){var b=this;this.searchInput=this.findElement(".texture-search input");this.searchInput.placeholder=ResourceAction.getLocalizedLabelText(a,"TextureChoiceComponent","searchLabel.text").replace(":","");this.registerEventListener(b.searchInput,"input",function(){var e=CoreTools.removeAccents(b.searchInput.value.trim());for(var d=0;d<b.texturesCatalogItems.length;d++){var f=b.texturesCatalogItems[d];var c=f._catalogTexture.getName()+"|"+f._catalogTexture.getCategory().getName();if(f._catalogTexture.getCreator()!==null){c+="|"+f._catalogTexture.getCreator()}if(RegExp(e,"i").test(CoreTools.removeAccents(c))){f.classList.remove("hidden")}else{f.classList.add("hidden")}}});this.searchInput.addEventListener("focusin",function(c){setTimeout(function(){if(b.searchInput.value!=""){b.searchInput.select()}},100)})};JSTextureDialog.prototype.initRecentTextures=function(){var c=this;this.recentTexturesPanel.innerHTML="";var e=this.getUserPreferences().getRecentTextures();for(var b=0;b<e.length;b++){var d=e[b];var a=document.createElement("div");a.classList.add("item");a._catalogTexture=d;this.recentTexturesPanel.appendChild(a);TextureManager.getInstance().loadTexture(d.getImage(),{textureUpdated:function(f){a.style.backgroundImage="url('"+f.src+"')"},textureError:function(f){c.recentTexturesPanel.removeChild(a)}})}var c=this;this.registerEventListener(this.recentTexturesPanel.childNodes,"click",function(f){c.selectTexture(c.getCatalogTextureFromItem(this))})};JSTextureDialog.prototype.initImportTexturesPanel=function(){this.importTextureButton=this.findElement(".imported-textures-panel [import]");this.modifyTextureButton=this.findElement(".imported-textures-panel [modify]");this.deleteTextureButton=this.findElement(".imported-textures-panel [delete]");var b=this;var a=this.controller;this.registerEventListener(this.importTextureButton,"click",function(c){a.importTexture()});this.registerEventListener(this.modifyTextureButton,"click",function(c){a.modifyTexture(b.selectedTextureModel.texture)});this.registerEventListener(this.deleteTextureButton,"click",function(c){a.deleteTexture(b.selectedTextureModel.texture)})};function ModelMaterialsComponent(b,a){JSComponent.call(this,b,document.createElement("span"),true);this.controller=a;this.getHTMLElement().innerHTML='<button class="model-materials-button">'+this.getLocalizedLabelText("ModelMaterialsComponent","modifyButton.text")+"</button>";this.button=this.findElement(".model-materials-button");this.button.disabled=true;var c=this;this.registerEventListener(this.button,"click",function(d){c.openModelMaterialsSelectorDialog()})}ModelMaterialsComponent.prototype=Object.create(JSComponent.prototype);ModelMaterialsComponent.prototype.constructor=ModelMaterialsComponent;ModelMaterialsComponent.prototype.setEnabled=function(a){this.button.disabled=!a};ModelMaterialsComponent.prototype.openModelMaterialsSelectorDialog=function(){var a=new JSModelMaterialsSelectorDialog(this.getUserPreferences(),this.controller);a.displayView()};ModelMaterialsComponent.prototype.dispose=function(){JSComponent.prototype.dispose.call(this)};function JSModelMaterialsSelectorDialog(c,b){this.controller=b;var e='  <div data-name="preview-panel">    <span>@{ModelMaterialsComponent.previewLabel.text}</span><br/>    <canvas id="model-preview-canvas"></canvas>  </div>  <div data-name="edit-panel">    <div>      <span>@{ModelMaterialsComponent.materialsLabel.text}</span>      <div data-name="materials-list">      </div>    </div>    <div class="color-texture-shininess-panel">      <span>@{ModelMaterialsComponent.colorAndTextureLabel.text}</span><br/>      <div class="label-input-grid">        <label class="whole-line"><input type="radio" name="color-and-texture-checkbox" value="DEFAULT">@{ModelMaterialsComponent.defaultColorAndTextureRadioButton.text}</label>        <label class="whole-line"><input type="radio" name="color-and-texture-checkbox" value="INVISIBLE">@{ModelMaterialsComponent.invisibleRadioButton.text}</label>        <label><input type="radio" name="color-and-texture-checkbox" value="COLOR">@{ModelMaterialsComponent.colorRadioButton.text}</label>        <span data-name="color-button"></span>        <label><input type="radio" name="color-and-texture-checkbox" value="TEXTURE">@{ModelMaterialsComponent.textureRadioButton.text}</label>        <span data-name="texture-component"></span>      </div>      <br />      <span>@{ModelMaterialsComponent.shininessLabel.text}</span><br/>      <input type="range" name="shininess-slider" min="0" max="128" list="model-materials-shininess-list" />       <datalist id="model-materials-shininess-list"></datalist>       <div class="slider-labels"><div>@{ModelMaterialsComponent.mattLabel.text}</div><div>@{ModelMaterialsComponent.shinyLabel.text}</div></div>    </div></div>';JSDialog.call(this,c,"@{HomeFurnitureController.modelMaterialsTitle}",e,{size:"medium",applier:function(g){b.setMaterials(g.materialsList.getMaterials())},disposer:function(g){g.selectedMaterialBlinker.stop();g.colorButton.dispose();g.textureComponent.dispose()}});this.getHTMLElement().classList.add("model-materials-chooser-dialog");this.initMaterialsList();this.initPreviewPanel();this.initColorAndTexturePanel();this.initShininessPanel();var d=this;if(this.materialsList.size()>0){this.materialsList.selectAt(0)}else{var a=function(){if(d.materialsList.size()>0){d.materialsList.selectAt(0);d.materialsList.removeListDataListener(a)}};this.materialsList.addListDataListener(a)}this.enableComponents();var f={delay:500,animationTask:null,start:function(){var h=d.materialsList;var g=function(){if(h.size()>1){var t=h.getMaterials();if(f.delay!==100){f.delay=100;if(t==null){t=d.newArray(h.size())}else{t=t.slice(0)}var k=h.getSelectedIndices();for(var n=0;n<k.length;n++){var o=k[n];var s=h.getDefaultMaterialAt(o);var p=t[o]!=null?t[o]:s;var r=4280435967;if(p.getTexture()==null){var j=p.getColor();if(j==null){j=s.getColor()}j&=16777215;var l=(j>>16)&255;var m=(j>>8)&255;var q=j&255;if(Math.max(l,Math.max(m,q))>119){r=4278190080|(l/2<<16)|(m/2<<8)|(q/2)}else{if((l+m+q)/3>15){r=4278190080|(Math.min(l*2,255)<<16)|(Math.min(m*2,255)<<8)|Math.min(q*2,255)}}}t[o]=new HomeMaterial(p.getName(),r,null,p.getShininess())}}else{f.delay=1000}d.previewComponent.setModelMaterials(t)}f.animationTask=setTimeout(g,f.delay)};f.animationTask=setTimeout(g,f.delay)},stop:function(){clearTimeout(f.animationTask)},restart:function(){f.stop();f.delay=101;f.start()}};f.start();this.materialsList.addListSelectionListener(function(g){f.restart()});this.selectedMaterialBlinker=f}JSModelMaterialsSelectorDialog.prototype=Object.create(JSDialog.prototype);JSModelMaterialsSelectorDialog.prototype.constructor=JSModelMaterialsSelectorDialog;JSModelMaterialsSelectorDialog.prototype.newArray=function(b){var c=new Array(b);for(var a=0;a<c.length;a++){c[a]=null}return c};JSModelMaterialsSelectorDialog.prototype.initMaterialsList=function(){var d=this;var b=this.controller;var f=this.getElement("materials-list");var e=[];var a=b.getMaterials();if(a!=null){a=a.slice(0)}ModelManager.getInstance().loadModel(b.getModel(),true,{modelUpdated:function(n){e=ModelManager.getInstance().getMaterials(n,b.getModelCreator());if(a!=null){var g=d.newArray(e.length);var l=false;for(var k=0;k<e.length;k++){var m=e[k].getName();for(var h=0;h<a.length;h++){if(a[h]!=null&&a[h].getName()==m){g[k]=a[h];l=true;break}}}if(l){a=g}else{a=null}}}});var c=this.materialsList={element:f,materials:a,defaultMaterials:e,dataListeners:[],selectionListeners:[],size:function(){if(c.defaultMaterials!=null){return c.defaultMaterials.length}else{return 0}},getMaterials:function(){return c.materials},getDefaultMaterialAt:function(g){return c.defaultMaterials[g]},getElementAt:function(g){var h;if(c.materials!=null&&c.materials[g]!=null&&c.materials[g].getName()!=null&&c.materials[g].getName()==c.defaultMaterials[g].getName()){h=c.materials[g]}else{h=new HomeMaterial(c.defaultMaterials[g].getName(),null,null,null)}return h},setMaterialAt:function(j,g){if(j.getColor()==null&&j.getTexture()==null&&j.getShininess()==null){if(c.materials!=null){c.materials[g]=null;var k=true;for(var h=0;h<c.materials.length;h++){if(c.materials[h]!=null){k=false;break}}if(k){c.materials=null}}}else{if(c.materials==null||c.materials.length!=c.defaultMaterials.length){c.materials=d.newArray(c.defaultMaterials.length)}c.materials[g]=j}c.fireContentsChanged()},fireContentsChanged:function(){for(var g=0;g<c.dataListeners.length;g++){c.dataListeners[g]()}c.repaint()},createListItem:function(k,j,h){var n=k.getTexture();var m=k.getColor();if(n==null&&m==null){n=j.getTexture();if(n==null){m=j.getColor()}}var g=document.createElement("div");g.classList.add("icon");if(n!=null&&n.getImage()!=null){TextureManager.getInstance().loadTexture(n.getImage(),{textureUpdated:function(o){g.style.backgroundImage="url('"+o.src+"')"},textureError:function(o){g.style.backgroundImage="none"}})}else{if(m!=null&&(m&4278190080)!=0){g.style.backgroundColor=ColorTools.integerToHexadecimalString(m)}else{}}var l=document.createElement("div");l.textContent=k.getName();if(h){l.classList.add("selected")}l.appendChild(g);return l},repaint:function(){var n=c.defaultMaterials;var g=c.materials;var m=c.getSelectedIndices();c.element.innerHTML="";if(n!=null){c.element.innerHTML="";for(var h=0;h<n.length;h++){var l=c.getElementAt(h);var k=c.getDefaultMaterialAt(h);var j=m.indexOf(h)>-1;c.element.appendChild(c.createListItem(l,k,j))}d.registerEventListener(c.element.children,"click",function(r){var q=this;var s=OperatingSystem.isMacOSX()?r.metaKey:r.ctrlKey;if(s){if(q.classList.contains("selected")){q.classList.remove("selected");c.fireSelectionChanged()}else{c.selectItem(q)}}else{for(var p=0;p<c.element.children.length;p++){var o=c.element.children[p];if(o!=q){o.classList.remove("selected")}}c.selectItem(q)}});d.registerEventListener(c.element.children,"dblclick",function(o){c.selectItem(this);if(d.colorButton.getColor()!=null){d.colorButton.findElement("button").click()}else{if(b.getTextureController().getTexture()!=null&&d.textureComponent!=null){d.textureComponent.findElement("button").click()}}})}},addListDataListener:function(g){c.dataListeners.push(g)},removeListDataListener:function(g){c.dataListeners.splice(c.dataListeners.index(g),1)},addListSelectionListener:function(g){c.selectionListeners.push(g)},selectAt:function(g){c.element.children[g].classList.add("selected");c.fireSelectionChanged()},selectItem:function(g){g.classList.add("selected");c.fireSelectionChanged()},fireSelectionChanged:function(){for(var g=0;g<c.selectionListeners.length;g++){c.selectionListeners[g]()}},isSelectionEmpty:function(){return c.element.querySelector(".selected")!=null},getSelectedIndices:function(){var j=[];var g=c.element.children;for(var h=0;h<g.length;h++){if(g[h].classList.contains("selected")){j.push(h)}}return j}};this.materialsList.repaint();this.materialsList.addListSelectionListener(function(){var l=d.materialsList.getSelectedIndices();if(l.length>0){var k=d.materialsList.getElementAt(l[0]);var m=k.getTexture();var g=k.getColor();var h=k.getShininess();var j=d.materialsList.getDefaultMaterialAt(l[0]);if(g==null&&m==null){d.defaultColorAndTextureRadioButton.checked=true;m=j.getTexture();if(m!=null){d.colorButton.setColor(null);b.getTextureController().setTexture(m)}else{g=j.getColor();if(g!=null){b.getTextureController().setTexture(null);d.colorButton.setColor(g)}}}else{if(m!=null){d.textureRadioButton.checked=true;d.colorButton.setColor(null);b.getTextureController().setTexture(m)}else{if((g&4278190080)==0){d.invisibleRadioButton.checked=true;m=j.getTexture();if(m!=null){d.colorButton.setColor(null);b.getTextureController().setTexture(m)}else{g=j.getColor();if(g!=null){b.getTextureController().setTexture(null);d.colorButton.setColor(g)}}}else{d.colorRadioButton.checked=true;b.getTextureController().setTexture(null);d.colorButton.setColor(g)}}}if(h!=null){d.shininessSlider.value=h*128}else{d.shininessSlider.value=j.getShininess()*128}}d.enableComponents()})};JSModelMaterialsSelectorDialog.prototype.initPreviewPanel=function(){var c=this.controller;var d=this;var a=this.getElement("preview-panel");var b=this.findElement("#model-preview-canvas");b.width=250;b.height=250;var e=d.previewComponent=new ModelPreviewComponent(b,true);ModelManager.getInstance().loadModel(c.getModel(),false,{modelUpdated:function(g){var f=d.materialsList;e.setModel(c.getModel(),c.isBackFaceShown(),c.getModelRotation(),c.getModelWidth(),c.getModelDepth(),c.getModelHeight());e.setModelMaterials(f.getMaterials());e.setModelTranformations(c.getModelTransformations());f.addListDataListener(function(){e.setModelMaterials(f.getMaterials())})},modelError:function(){a.style.visibility="hidden"}})};JSModelMaterialsSelectorDialog.prototype.initColorAndTexturePanel=function(){var d=this;var a=this.controller;this.defaultColorAndTextureRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='DEFAULT']");this.invisibleRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='INVISIBLE']");this.colorRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='COLOR']");this.textureRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='TEXTURE']");var c=function(k){var j=d.materialsList.getSelectedIndices();for(var g=0;g<j.length;g++){var f=j[g];var h=d.materialsList.getElementAt(f);d.materialsList.setMaterialAt(k(h,f),f)}};this.registerEventListener(this.defaultColorAndTextureRadioButton,"click",function(f){if(!this.disabled&&this.checked){c(function(g){return new HomeMaterial(g.getName(),null,null,g.getShininess())})}});this.registerEventListener(this.invisibleRadioButton,"click",function(f){if(!this.disabled&&this.checked){c(function(g){return new HomeMaterial(g.getName(),0,null,g.getShininess())})}});var e=function(){if(!d.colorRadioButton.disabled&&d.colorRadioButton.checked){c(function(j,g){var h=d.materialsList.getDefaultMaterialAt(g);var f=h.getColor()!=d.colorButton.getColor()||h.getTexture()!=null?d.colorButton.getColor():null;return new HomeMaterial(j.getName(),f,null,j.getShininess())})}};this.colorButton=new ColorButton(this.getUserPreferences(),{colorChanged:function(f){if(f!=null){d.colorRadioButton.checked=true;e()}}});this.colorButton.setColorDialogTitle(this.getUserPreferences().getLocalizedString("ModelMaterialsComponent","colorDialog.title"));this.registerEventListener(this.colorRadioButton,"click",function(f){if(d.colorRadioButton.checked){e()}});this.attachChildComponent("color-button",this.colorButton);var b=function(){if(!d.textureRadioButton.disabled&&d.textureRadioButton.checked){c(function(h,f){var g=d.materialsList.getDefaultMaterialAt(f).getTexture();var j=g!=a.getTextureController().getTexture()?a.getTextureController().getTexture():null;return new HomeMaterial(h.getName(),null,j,h.getShininess())})}};this.textureComponent=a.getTextureController().getView();this.textureComponent.textureChanged=function(f){if(f!=null){d.textureRadioButton.checked=true;b()}};this.registerEventListener(this.textureRadioButton,"click",function(f){if(d.textureRadioButton.checked){b()}});this.registerPropertyChangeListener(a.getTextureController(),"TEXTURE",function(f){if(f.getNewValue()!=null){if(!d.textureRadioButton.checked){d.textureRadioButton.checked=true}b()}});this.attachChildComponent("texture-component",this.textureComponent)};JSModelMaterialsSelectorDialog.prototype.initShininessPanel=function(){var b=this;this.shininessSlider=this.getElement("shininess-slider");var d=this.findElement("#model-materials-shininess-list");for(var a=0;a<=128;a+=16){var c=document.createElement("option");c.value=a;d.appendChild(c)}this.registerEventListener(this.shininessSlider,"input",function(k){var g=this.value;var j=b.materialsList.getSelectedIndices();for(var f=0;f<j.length;f++){var e=j[f];var h=b.materialsList.getElementAt(e);b.materialsList.setMaterialAt(new HomeMaterial(h.getName(),h.getColor(),h.getTexture(),g/128),e)}})};JSModelMaterialsSelectorDialog.prototype.enableComponents=function(){var a=!this.materialsList.isSelectionEmpty();this.defaultColorAndTextureRadioButton.disabled=a;this.invisibleRadioButton.disabled=a;this.textureRadioButton.disabled=a;this.textureComponent.setEnabled(!a);this.colorRadioButton.disabled=a;this.colorButton.setEnabled(!a);this.shininessSlider.disabled=a};function JSViewFactory(a){this.application=a}JSViewFactory.prototype=Object.create(JSViewFactory.prototype);JSViewFactory.prototype.constructor=JSViewFactory;JSViewFactory.__class="JSViewFactory";JSViewFactory.__interfaces=["com.eteks.sweethome3d.viewcontroller.ViewFactory"];JSViewFactory.dummyDialogView={displayView:function(a){}};JSViewFactory.prototype.createFurnitureCatalogView=function(a,b,c){return new FurnitureCatalogListPanel("furniture-catalog",a,b,c)};JSViewFactory.prototype.createFurnitureView=function(c,b,a){if(document.getElementById("furniture-view")!=null){return new FurnitureTablePanel("furniture-view",c,b,a)}else{return undefined}};JSViewFactory.prototype.createPlanView=function(c,a,b){return new PlanComponent("home-plan",c,a,b)};JSViewFactory.prototype.createView3D=function(c,a,b){return new HomeComponent3D("home-3D-view",c,a,null,b)};JSViewFactory.prototype.createHomeView=function(c,a,b){return new HomePane("home-pane",c,a,b)};JSViewFactory.prototype.createWizardView=function(b,a){return new JSWizardDialog(b,a,a.getTitle()||"@{WizardPane.wizard.title}",{})};JSViewFactory.prototype.createBackgroundImageWizardStepsView=function(f,b,a){var e=10000000;var d=8000000;var c=10;function g(){JSComponent.call(this,b,'<div choiceStep>  <div description>@{BackgroundImageWizardStepsPanel.imageChangeLabel.text}</div>  <div class="buttons">    <button selectImage></button>    <input type="file" accept="image/*" style="display: none" />   </div>  <div preview>    <img />  </div></div><div scaleStep>  <div>@{BackgroundImageWizardStepsPanel.scaleLabel.text}</div>  <br />  <div>    <span data-name="scale-distance-label"></span>    <span data-name="scale-distance-input"></span>  </div>  <br />  <div class="preview-panel">    <div preview>      <canvas />    </div>    <div class="preview-controls" style="z-index:5">      <div previewZoomIn></div>      <br />      <div previewZoomOut></div>    </div>  </div></div><div originStep>  <div>@{BackgroundImageWizardStepsPanel.originLabel.text}</div>  <br />  <div>    <span data-name="x-origin-label"></span>    <span data-name="x-origin-input"></span>    <span data-name="y-origin-label"></span>    <span data-name="y-origin-input"></span>  </div>  <br />  <div class="preview-panel">    <div preview>      <canvas />    </div>    <div class="preview-controls" style="z-index:5">      <div previewZoomIn></div>      <br />      <div previewZoomOut></div>    </div>  </div></div>');this.controller=a;this.getHTMLElement().classList.add("background-image-wizard");this.initImageChoiceStep();this.initScaleStep();this.initOriginStep();var h=this;this.registerPropertyChangeListener(a,"STEP",function(j){h.updateStep();h.repaintOriginCanvas()});this.registerPropertyChangeListener(a,"IMAGE",function(j){h.updatePreviewComponentsImage()});this.updateImage(f)}g.prototype=Object.create(JSComponent.prototype);g.prototype.constructor=g;g.prototype.buildHtmlFromTemplate=function(h){return JSComponent.prototype.buildHtmlFromTemplate.call(this,h).replace(/\<br\>/g," ")};g.prototype.initImageChoiceStep=function(){var j=this;j.imageChoiceStep={panel:j.findElement("[choiceStep]"),imageChoiceOrChangeLabel:j.findElement("[choiceStep] [description]"),imageChoiceOrChangeButton:j.findElement("[choiceStep] [selectImage]"),imageChooser:j.findElement("[choiceStep] input[type='file']"),preview:j.findElement("[choiceStep] [preview] img")};var h=function(k){console.warn("Error loading image: "+k);j.controller.setImage(null);j.setImageChoiceTexts();j.updatePreviewComponentsImage();alert(ResourceAction.getLocalizedLabelText(b,"BackgroundImageWizardStepsPanel","imageChoiceErrorLabel.text"))};j.registerEventListener(j.imageChoiceStep.imageChoiceOrChangeButton,"click",function(k){j.imageChoiceStep.imageChooser.click()});j.registerEventListener(j.imageChoiceStep.imageChooser,"input",function(m){var l=this.files[0];if(l){var k=new FileReader();k.addEventListener("load",function(n){var o=new Image();o.addEventListener("load",function(p){j.updateController(o,l)});o.addEventListener("error",h);o.src=n.target.result});k.addEventListener("error",h);k.readAsDataURL(l)}})};g.prototype.initScaleStep=function(){var q=this;var h=b.getLengthUnit().getName();var o=b.getLengthUnit().getMaximumLength();q.scaleStep={panel:q.findElement("[scaleStep]"),preview:q.findElement("[scaleStep] [preview] canvas"),previewZoomIn:q.findElement("[scaleStep] [previewZoomIn]"),previewZoomOut:q.findElement("[scaleStep] [previewZoomOut]"),scaleDistanceLabel:q.getElement("scale-distance-label"),scaleDistanceInput:new JSSpinner(b,q.getElement("scale-distance-input"),{format:b.getLengthUnit().getFormat(),minimum:b.getLengthUnit().getMinimumLength(),maximum:o,stepSize:b.getLengthUnit().getStepSize()})};q.scaleStep.scaleDistanceLabel.textContent=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","scaleDistanceLabel.text",h);q.registerEventListener(q.scaleStep.scaleDistanceInput,"input",function(s){a.setScaleDistance(q.scaleStep.scaleDistanceInput.getValue()!=null?parseFloat(q.scaleStep.scaleDistanceInput.getValue()):null)});var m=function(){var s=a.getScaleDistance();q.scaleStep.scaleDistanceInput.setNullable(s===null);q.scaleStep.scaleDistanceInput.setValue(s)};m();this.registerPropertyChangeListener(a,"SCALE_DISTANCE",m);var l=new ResourceAction(b,"BackgroundImageWizardStepsPanel","ZOOM_IN",true);var k=new ResourceAction(b,"BackgroundImageWizardStepsPanel","ZOOM_OUT",true);q.scaleStep.previewZoomIn.style.backgroundImage="url('"+ZIPTools.getScriptFolder()+"/"+l.getValue(AbstractAction.SMALL_ICON)+"')";q.registerEventListener(q.scaleStep.previewZoomIn,"click",function(s){q.scaleStep.preview.width*=2;q.repaintScaleCanvas()});q.scaleStep.previewZoomOut.style.backgroundImage="url('"+ZIPTools.getScriptFolder()+"/"+k.getValue(AbstractAction.SMALL_ICON)+"')";q.registerEventListener(q.scaleStep.previewZoomOut,"click",function(s){q.scaleStep.preview.width/=2;q.repaintScaleCanvas()});this.registerPropertyChangeListener(a,"SCALE_DISTANCE_POINTS",function(){q.repaintScaleCanvas()});q.repaintScaleCanvas();var j=this.scaleStep.preview;j.style.touchAction="none";var p=function(s){if(j.dragging){j.dragging=false;j.distanceStartPoint=j.distanceEndPoint=false}};var r=function(B){B.stopImmediatePropagation();var z=j.getBoundingClientRect();var v=B.touches&&B.touches.length>0?B.touches[0]:B;var D=v.clientX-z.left;var A=v.clientY-z.top;if(j.dragging){var u=j.width/q.selectedImage.width;var s=D/u;var F=A/u;var E=a.getScaleDistancePoints();var w;var C;if(j.distanceStartPoint){w=E[0];C=E[1]}else{w=E[1];C=E[0]}if(java.awt.geom.Point2D.distanceSq(C[0]*u,C[1]*u,s*u,F*u)>=4){if(B.shiftKey){var t=Math.abs(Math.atan2(C[1]-F,s-C[0]));if(t>Math.PI/4&&t<=3*Math.PI/4){s=C[0]}else{F=C[1]}}w[0]=s;w[1]=F;a.setScaleDistancePoints(E[0][0],E[0][1],E[1][0],E[1][1]);q.repaintScaleCanvas()}}else{j.distanceStartPoint=j.distanceEndPoint=false;var E=a.getScaleDistancePoints();var u=j.width/q.selectedImage.width;if(Math.abs(E[0][0]*u-D)<=c&&Math.abs(E[0][1]*u-A)<=c){j.distanceStartPoint=true}else{if(Math.abs(E[1][0]*u-D)<=c&&Math.abs(E[1][1]*u-A)<=c){j.distanceEndPoint=true}}if(j.distanceStartPoint||j.distanceEndPoint){j.style.cursor="crosshair"}else{j.style.cursor="default"}}};var n=function(s){s.stopImmediatePropagation();r(s);if(j.distanceStartPoint||j.distanceEndPoint){j.dragging=true}};this.registerEventListener(j,"mousedown",n,true);this.registerEventListener(j,"touchstart",n,true);this.registerEventListener(j,"mousemove",r,true);this.registerEventListener(j,"touchmove",r,true);this.registerEventListener(j,"mouseup",p,true);this.registerEventListener(j,"touchend",p,true)};g.prototype.repaintScaleCanvas=function(){var j=this.scaleStep.preview;var h=new Graphics2D(j);h.fillRect(0,0,j.width,j.height);var n=this.selectedImage;if(n){j.height=(n.height/n.width)*j.width;h.drawImageWithSize(n,0,0,j.width,j.height);h.setColor("blue");var o=h.getTransform();var l=j.width/n.width;h.scale(l,l);h.setStroke(new java.awt.BasicStroke(5/l,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL));var q=this.controller.getScaleDistancePoints();h.draw(new java.awt.geom.Line2D.Float(q[0][0],q[0][1],q[1][0],q[1][1]));h.setStroke(new java.awt.BasicStroke(1/l,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL));var m=Math.atan2(q[1][1]-q[0][1],q[1][0]-q[0][0]);var p=h.getTransform();h.translate(q[0][0],q[0][1]);h.rotate(m);var k=new java.awt.geom.Line2D.Double(0,5/l,0,-5/l);h.draw(k);h.setTransform(p);h.translate(q[1][0],q[1][1]);h.rotate(m);h.draw(k);h.setTransform(o)}};g.prototype.initOriginStep=function(){var p=this;var h=b.getLengthUnit().getName();var n=b.getLengthUnit().getMaximumLength();this.originStep={panel:this.findElement("[originStep]"),preview:this.findElement("[originStep] [preview] canvas"),previewZoomIn:this.findElement("[originStep] [previewZoomIn]"),previewZoomOut:this.findElement("[originStep] [previewZoomOut]"),xOriginLabel:this.getElement("x-origin-label"),xOriginInput:new JSSpinner(b,this.getElement("x-origin-input"),{format:b.getLengthUnit().getFormat(),value:a.getXOrigin(),minimum:-n,maximum:n,stepSize:b.getLengthUnit().getStepSize()}),yOriginLabel:this.getElement("y-origin-label"),yOriginInput:new JSSpinner(b,this.getElement("y-origin-input"),{format:b.getLengthUnit().getFormat(),value:a.getYOrigin(),minimum:-n,maximum:n,stepSize:b.getLengthUnit().getStepSize()})};this.originStep.xOriginLabel.textContent=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","xOriginLabel.text",h);this.originStep.yOriginLabel.textContent=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","yOriginLabel.text",h);this.registerEventListener([this.originStep.xOriginInput,this.originStep.yOriginInput],"input",function(r){a.setOrigin(p.originStep.xOriginInput.getValue(),p.originStep.yOriginInput.getValue())});this.registerPropertyChangeListener(a,"X_ORIGIN",function(){p.originStep.xOriginInput.setValue(a.getXOrigin());p.repaintOriginCanvas()});this.registerPropertyChangeListener(a,"Y_ORIGIN",function(){p.originStep.yOriginInput.setValue(a.getYOrigin());p.repaintOriginCanvas()});var j=this.originStep.preview;var l=new ResourceAction(b,"BackgroundImageWizardStepsPanel","ZOOM_IN",true);var k=new ResourceAction(b,"BackgroundImageWizardStepsPanel","ZOOM_OUT",true);this.originStep.previewZoomIn.style.backgroundImage="url('"+ZIPTools.getScriptFolder()+"/"+l.getValue(AbstractAction.SMALL_ICON)+"')";this.registerEventListener(this.originStep.previewZoomIn,"click",function(r){p.originStep.preview.width*=2;p.repaintOriginCanvas()});this.originStep.previewZoomOut.style.backgroundImage="url('"+ZIPTools.getScriptFolder()+"/"+k.getValue(AbstractAction.SMALL_ICON)+"')";this.registerEventListener(this.originStep.previewZoomOut,"click",function(r){p.originStep.preview.width/=2;p.repaintOriginCanvas()});var o=function(r){p.isMovingOrigin=false;j.style.cursor="default"};var q=function(v){v.stopImmediatePropagation();if(p.isMovingOrigin){var t=j.getBoundingClientRect();var u=v.touches&&v.touches.length>0?v.touches[0]:v;var w=a.getScaleDistancePoints();var r=p.originStep.preview.width/p.selectedImage.width;r=r/BackgroundImage.getScale(a.getScaleDistance(),w[0][0],w[0][1],w[1][0],w[1][1]);var x=Math.round((u.clientX-t.left)/r*10)/10;var s=Math.round((u.clientY-t.top)/r*10)/10;a.setOrigin(x,s);p.repaintOriginCanvas()}};var m=function(r){p.isMovingOrigin=true;j.style.cursor="crosshair";q(r)};this.registerEventListener(j,"mousedown",m,true);this.registerEventListener(j,"touchstart",m,true);this.registerEventListener(j,"mousemove",q,true);this.registerEventListener(j,"touchmove",q,true);this.registerEventListener(j,"mouseup",o,true);this.registerEventListener(j,"touchend",o,true)};g.prototype.repaintOriginCanvas=function(){var h=this.originStep.preview;var j=new Graphics2D(h);j.fillRect(0,0,h.width,h.height);var l=this.selectedImage;if(l){h.height=(l.height/l.width)*h.width;j.drawImageWithSize(l,0,0,h.width,h.height);j.setColor("blue");var o=j.getTransform();var m=h.width/l.width;var k=this.controller.getScaleDistancePoints();m=m/BackgroundImage.getScale(this.controller.getScaleDistance(),k[0][0],k[0][1],k[1][0],k[1][1]);j.scale(m,m);j.translate(this.controller.getXOrigin(),this.controller.getYOrigin());var n=4/m;j.fill(new java.awt.geom.Ellipse2D.Float(-n,-n,n*2,n*2));j.setStroke(new java.awt.BasicStroke(1/m,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL));j.draw(new java.awt.geom.Line2D.Double(8/m,0,-8/m,0));j.draw(new java.awt.geom.Line2D.Double(0,8/m,0,-8/m));j.setTransform(o)}};g.prototype.setImageChangeTexts=function(){this.imageChoiceStep.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChangeLabel.text").replace(/\<br\>/g," ");this.imageChoiceStep.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChangeButton.text")};g.prototype.setImageChoiceTexts=function(){this.imageChoiceStep.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChoiceLabel.text").replace(/\<br\>/g," ");this.imageChoiceStep.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChoiceButton.text")};g.prototype.updateImage=function(h){if(h==null){this.setImageChoiceTexts();this.updatePreviewComponentsImage()}else{this.setImageChangeTexts();setTimeout(function(){a.setImage(h.getImage());a.setScaleDistance(h.getScaleDistance());a.setScaleDistancePoints(h.getScaleDistanceXStart(),h.getScaleDistanceYStart(),h.getScaleDistanceXEnd(),h.getScaleDistanceYEnd());a.setOrigin(h.getXOrigin(),h.getYOrigin())},100)}};g.prototype.updateController=function(m,k){var j=this;var h=this.controller;var l=ImageTools.isImageWithAlpha(m)?"image/png":"image/jpeg";this.checkImageSize(m,l,function(o){var n=function(p){setTimeout(function(){h.setImage(p);j.setImageChangeTexts();var s=h.getReferenceBackgroundImage();if(s!=null&&s.getScaleDistanceXStart()<o.width&&s.getScaleDistanceXEnd()<o.width&&s.getScaleDistanceYStart()<o.height&&s.getScaleDistanceYEnd()<o.height){h.setScaleDistance(s.getScaleDistance());h.setScaleDistancePoints(s.getScaleDistanceXStart(),s.getScaleDistanceYStart(),s.getScaleDistanceXEnd(),s.getScaleDistanceYEnd());h.setOrigin(s.getXOrigin(),s.getYOrigin())}else{h.setScaleDistance(null);var q=o.width*0.1;var t=o.height/2;var r=o.width*0.9;h.setScaleDistancePoints(q,t,r,t);h.setOrigin(0,0)}},100)};if(m===o&&(k.type=="image/jpeg"||k.type=="image/png")){n(new BlobURLContent(k))}else{BlobURLContent.fromImage(o,l,n)}})};g.prototype.checkImageSize=function(j,k,l){if(j.width*j.height<e){l(j)}else{var h=this;var m=Math.sqrt(d/(j.width*j.height));var q=Math.round(j.width*m);var p=Math.round(j.height*m);var o=function(){ImageTools.resize(j,q,p,l,k)};if(this.getUserPreferences().isImportedImageResizedWithoutPrompting()){o()}else{var n=new JSImageResizingDialog(b,"@{BackgroundImageWizardStepsPanel.reduceImageSize.title}",h.getLocalizedLabelText("BackgroundImageWizardStepsPanel","reduceImageSize.message",[j.width,j.height,q,p]),"@{BackgroundImageWizardStepsPanel.reduceImageSize.cancel}","@{BackgroundImageWizardStepsPanel.reduceImageSize.keepUnchanged}","@{BackgroundImageWizardStepsPanel.reduceImageSize.reduceSize}",o,function(){l(j)});n.displayView()}}};g.prototype.updatePreviewComponentsImage=function(){var h=this;var j=this.controller.getImage();delete this.imageChoiceStep.preview.src;this.imageChoiceStep.preview.width=0;delete this.scaleStep.preview.src;delete this.originStep.preview.src;if(j!=null){TextureManager.getInstance().loadTexture(j,{textureUpdated:function(k){h.imageChoiceStep.preview.src=k.src;h.imageChoiceStep.preview.width=k.width;h.selectedImage=k;if(k.width>400){h.scaleStep.preview.width=400;h.originStep.preview.width=400}h.repaintScaleCanvas();h.repaintOriginCanvas()},textureError:function(k){imageErrorListener(k)}})}};g.prototype.updateStep=function(){var h=this.controller.getStep();switch(h){case BackgroundImageWizardController.Step.CHOICE:this.imageChoiceStep.panel.style.display="flex";this.scaleStep.panel.style.display="none";this.originStep.panel.style.display="none";break;case BackgroundImageWizardController.Step.SCALE:this.imageChoiceStep.panel.style.display="none";this.scaleStep.panel.style.display="flex";delete this.scaleStep.panel.style.display;this.originStep.panel.style.display="none";break;case BackgroundImageWizardController.Step.ORIGIN:this.imageChoiceStep.panel.style.display="none";this.scaleStep.panel.style.display="none";this.originStep.panel.style.display="flex";break}};return new g()};JSViewFactory.prototype.createImportedFurnitureWizardStepsView=function(c,a,e,b,d){return null};JSViewFactory.prototype.createImportedTextureWizardStepsView=function(h,c,d,b){var g=640*640;var e=512;var f=e*e;function a(){JSComponent.call(this,d,'<div imageStep>  <div description>@{ImportedTextureWizardStepsPanel.imageChangeLabel.text}</div>  <div class="buttons">    <button changeImage>@{ImportedTextureWizardStepsPanel.imageChangeButton.text}</button>    <button onclick="window.open(\'http://www.sweethome3d.com/fr/importTextures.jsp\', \'_blank\')">@{ImportedTextureWizardStepsPanel.findImagesButton.text}</button>    <input type="file" accept="image/*" style="display: none" />   </div>  <div preview>  </div></div><div attributesStep>  <div description></div>  <div form>     <div preview>       <img />     </div>     <div>@{ImportedTextureWizardStepsPanel.nameLabel.text}</div>     <div>      <input type="text" name="name" />    </div>     <div>@{ImportedTextureWizardStepsPanel.categoryLabel.text}</div>     <div>      <select name="category"></select>    </div>     <div>@{ImportedTextureWizardStepsPanel.creatorLabel.text}</div>     <div>      <input type="text" name="creator" />    </div>    <div data-name="width-label" class="label-cell"></div>    <div>       <span data-name="width-input"></span>    </div>    <div data-name="height-label" class="label-cell"></div>    <div>      <span data-name="height-input"></span>    </div>  </div></div>');this.controller=b;this.userCategory=new TexturesCategory(ResourceAction.getLocalizedLabelText(d,"ImportedTextureWizardStepsPanel","userCategory"));this.getHTMLElement().classList.add("imported-texture-wizard");this.initComponents();var j=this;this.registerPropertyChangeListener(b,"STEP",function(k){j.updateStep()})}a.prototype=Object.create(JSComponent.prototype);a.prototype.constructor=a;a.prototype.initComponents=function(){this.imageStepPanel=this.findElement("[imageStep]");this.imageChoiceOrChangeLabel=this.findElement("[imageStep] [description]");this.imageChoiceOrChangeButton=this.findElement("button[changeImage]");this.imageChooserInput=this.findElement("input[type='file']");this.previewPanel=this.findElement("[preview]");if(h==null){this.setImageChoiceTexts()}this.attributesStepPanel=this.findElement("[attributesStep]");this.attributesStepPanelDescription=this.findElement("[attributesStep] [description]");this.attributesPreviewPanel=this.findElement("[attributesStep] [preview]");this.nameInput=this.findElement("input[name='name']");this.categorySelect=this.findElement("select[name='category']");this.creatorInput=this.findElement("input[name='creator']");var j=d.getLengthUnit().getName();var q=d.getLengthUnit().getMinimumLength();var p=d.getLengthUnit().getMaximumLength();this.widthLabel=this.getElement("width-label"),this.widthLabel.textContent=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","widthLabel.text",j);this.widthInput=new JSSpinner(d,this.getElement("width-input"),{format:d.getLengthUnit().getFormat(),minimum:q,maximum:p,stepSize:d.getLengthUnit().getStepSize()});this.heightLabel=this.getElement("height-label"),this.heightLabel.textContent=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","heightLabel.text",j);this.heightInput=new JSSpinner(d,this.getElement("height-input"),{format:d.getLengthUnit().getFormat(),minimum:q,maximum:p,stepSize:d.getLengthUnit().getStepSize()});var m=this;var l=function(r){console.warn("Error loading image: "+r);m.controller.setImage(null);m.setImageChoiceTexts();m.updatePreviewComponentsImage();alert(ResourceAction.getLocalizedLabelText(d,"ImportedTextureWizardStepsPanel","imageChoiceErrorLabel.text"))};this.registerEventListener(this.imageChoiceOrChangeButton,"click",function(r){m.imageChooserInput.click()});this.registerEventListener(this.imageChooserInput,"input",function(t){var s=m.imageChooserInput.files[0];if(s){var r=new FileReader();r.addEventListener("load",function(u){var v=new Image();v.addEventListener("load",function(w){m.updateController(v,s)});v.addEventListener("error",l);v.src=u.target.result});r.addEventListener("error",l);r.readAsDataURL(s)}});this.registerPropertyChangeListener(b,"IMAGE",function(r){m.updatePreviewComponentsImage()});this.registerPropertyChangeListener(b,"WIDTH",function(r){m.updatePreviewComponentsImage()});this.registerPropertyChangeListener(b,"HEIGHT",function(r){m.updatePreviewComponentsImage()});var k=d.getTexturesCatalog().getCategories();if(this.findUserCategory(k)==null){k=k.concat([this.userCategory])}for(var n=0;n<k.length;n++){var o=document.createElement("option");o.value=k[n].getName();o.textContent=k[n].getName();o._category=k[n];this.categorySelect.appendChild(o)}this.attributesStepPanelDescription.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","attributesLabel.text").replace(/\<br\>/g," ");this.registerPropertyChangeListener(b,"NAME",function(){if(m.nameInput.value.trim()!=b.getName()){m.nameInput.value=b.getName()}});this.registerEventListener(this.nameInput,"input",function(r){b.setName(m.nameInput.value.trim())});this.registerPropertyChangeListener(b,"CATEGORY",function(s){var r=b.getCategory();if(r!=null){m.categorySelect.value=r.getName()}});this.registerEventListener(this.categorySelect,"change",function(s){var r=m.categorySelect.item(m.categorySelect.selectedIndex)._category;b.setCategory(r)});this.registerPropertyChangeListener(b,"CREATOR",function(r){if(m.creatorInput.value.trim()!=b.getCreator()){m.creatorInput.value=b.getCreator()}});this.registerEventListener(m.creatorInput,"input",function(r){b.setCreator(m.creatorInput.value.trim())});this.registerPropertyChangeListener(b,"WIDTH",function(r){m.widthInput.setValue(b.getWidth())});this.registerEventListener(this.widthInput,"input",function(r){b.setWidth(parseFloat(m.widthInput.value))});this.registerPropertyChangeListener(b,"HEIGHT",function(r){m.heightInput.setValue(b.getHeight())});this.registerEventListener(this.heightInput,"input",function(r){b.setHeight(parseFloat(m.heightInput.value))});if(h!=null){TextureManager.getInstance().loadTexture(h.getImage(),{textureUpdated:function(r){m.updateController(r,h)},textureError:function(r){l(r)}})}};a.prototype.updateController=function(q,m){var l=this;var k=this.controller;this.setImageChangeTexts();if(m instanceof CatalogTexture){var p=m;setTimeout(function(){k.setImage(p.getImage());k.setName(p.getName());k.setCategory(p.getCategory());k.setCreator(p.getCreator());k.setWidth(p.getWidth());k.setHeight(p.getHeight())},100)}else{var j="Texture";if(m.name.lastIndexOf(".")>0){var o=m.name.split(/\/|\\|\./);if(o.length>1){j=o[o.length-2]}}var n=ImageTools.isImageWithAlpha(q)?"image/png":"image/jpeg";this.checkImageSize(q,n,function(s){var r=function(t){setTimeout(function(){k.setImage(t);k.setName(j);var v=l.preferences.getTexturesCatalog().getCategories();var w=l.findUserCategory(v)||l.userCategory;k.setCategory(w);k.setCreator(null);var x=20;var u=l.preferences.getLengthUnit();if(u==LengthUnit.INCH||u==LengthUnit.INCH_DECIMALS){x=LengthUnit.inchToCentimeter(8)}k.setWidth(x);k.setHeight(x/s.width*s.height)},100)};if(q===s&&(m.type=="image/jpeg"||m.type=="image/png")){r(new BlobURLContent(m))}else{BlobURLContent.fromImage(s,n,r)}})}};a.prototype.setImageChangeTexts=function(){this.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChangeLabel.text").replace(/\<br\>/g," ");this.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChangeButton.text")};a.prototype.setImageChoiceTexts=function(){this.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChoiceLabel.text").replace(/\<br\>/g," ");this.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChoiceButton.text")};a.prototype.findUserCategory=function(j){var j=d.getTexturesCatalog().getCategories();for(var k=0;k<j.length;k++){if(j[k].equals(this.userCategory)){return j[k]}}return null};a.prototype.checkImageSize=function(j,k,l){if(j.width*j.height<g){l(j)}else{var n;var m=j.width/j.height;if(m<0.5||m>2){n=Math.sqrt(f/(j.width*j.height))}else{if(m<1){n=e/j.height}else{n=e/j.width}}var r=Math.round(j.width*n);var q=Math.round(j.height*n);var p=function(){ImageTools.resize(j,r,q,l,k)};if(this.getUserPreferences().isImportedImageResizedWithoutPrompting()){p()}else{var o=new JSImageResizingDialog(d,"@{ImportedTextureWizardStepsPanel.reduceImageSize.title}",this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","reduceImageSize.message",[j.width,j.height,r,q]),"@{ImportedTextureWizardStepsPanel.reduceImageSize.cancel}","@{ImportedTextureWizardStepsPanel.reduceImageSize.keepUnchanged}","@{ImportedTextureWizardStepsPanel.reduceImageSize.reduceSize}",p,function(){l(j)});o.displayView()}}};a.prototype.updatePreviewComponentsImage=function(){this.previewPanel.innerHTML="";var m=new Image();if(this.controller.getImage()!==null){m.src=this.controller.getImage().getURL()}this.previewPanel.appendChild(m);this.attributesPreviewPanel.innerHTML="";var l=document.createElement("div");l.style.backgroundImage="url('"+m.src+"')";l.style.backgroundRepeat="repeat";var k=this.controller.getWidth()/250;var j=this.controller.getHeight()/250;l.style.backgroundSize="calc(100% * "+k+") calc(100% * "+j+")";l.classList.add("image");this.attributesPreviewPanel.appendChild(l)};a.prototype.updateStep=function(){var j=this.controller.getStep();switch(j){case ImportedTextureWizardController.Step.IMAGE:this.imageStepPanel.style.display="block";this.attributesStepPanel.style.display="none";break;case ImportedTextureWizardController.Step.ATTRIBUTES:this.imageStepPanel.style.display="none";this.attributesStepPanel.style.display="block";break}};return new a()};JSViewFactory.prototype.createUserPreferencesView=function(r,u){var p=function(I){if(I instanceof JSComponent){I=I.getHTMLElement()}return window.getComputedStyle(I).display!=="none"};var z=function(J){J.parentElement.style.display="none";var I=J;while(I.parentElement!=null&&!I.parentElement.classList.contains("user-preferences-dialog")){I=I.parentElement}I.style.display="none";I.previousElementSibling.style.display="none"};var x=new JSDialog(r,"@{UserPreferencesPanel.preferences.title}",document.getElementById("user-preferences-dialog-template"),{applier:function(J){if(p(J.languageSelect)){var I=J.languageSelect.options[J.languageSelect.selectedIndex];u.setLanguage(I!=null?I.value:null)}if(p(J.furnitureCatalogViewTreeRadioButton)){u.setFurnitureCatalogViewedInTree(J.furnitureCatalogViewTreeRadioButton.checked)}if(p(J.navigationPanelCheckBox)){u.setNavigationPanelVisible(J.navigationPanelCheckBox.checked)}if(p(J.aerialViewCenteredOnSelectionCheckBox)){u.setAerialViewCenteredOnSelectionEnabled(J.aerialViewCenteredOnSelectionCheckBox.checked)}if(p(J.observerCameraSelectedAtChangeCheckBox)){u.setObserverCameraSelectedAtChange(J.observerCameraSelectedAtChangeCheckBox.checked)}if(p(J.magnetismCheckBox)){u.setMagnetismEnabled(J.magnetismCheckBox.checked)}if(p(J.rulersCheckBox)){u.setRulersVisible(J.rulersCheckBox.checked)}if(p(J.gridCheckBox)){u.setGridVisible(J.gridCheckBox.checked)}if(p(J.iconTopViewRadioButton)){u.setFurnitureViewedFromTop(J.iconTopViewRadioButton.checked)}if(p(J.iconSizeSelect)&&!J.iconSizeSelect.disabled){u.setFurnitureModelIconSize(parseInt(J.iconSizeSelect.value))}if(p(J.roomRenderingFloorColorOrTextureRadioButton)){u.setRoomFloorColoredOrTextured(J.roomRenderingFloorColorOrTextureRadioButton.checked)}if(p(J.newWallThicknessInput)){u.setNewWallThickness(parseFloat(J.newWallThicknessInput.getValue()))}if(p(J.newWallHeightInput)){u.setNewWallHeight(parseFloat(J.newWallHeightInput.getValue()))}if(p(J.newFloorThicknessInput)){u.setNewFloorThickness(parseFloat(J.newFloorThicknessInput.getValue()))}u.modifyUserPreferences()}});x.languageSelect=x.getElement("language-select");if(u.isPropertyEditable("LANGUAGE")){var j=r.getSupportedLanguages();for(var w=0;w<j.length;w++){var g=j[w].replace("_","-");var B=g;try{B=new Intl.DisplayNames([g,"en"],{type:"language"}).of(g);if(B==g){throw"No support for Intl.DisplayNames"}B=B.charAt(0).toUpperCase()+B.slice(1)}catch(C){B={bg:"",cs:"etina",de:"Deutsch",el:"",en:"English",es:"Espaol",fr:"Franais",it:"Italiano",ja:"",hu:"Magyar",nl:"Nederlands",pl:"Polski",pt:"Portugus",ru:"",sv:"Svenska",vi:"Ting Vit","zh-CN":"","zh-TW":""}[g];if(B===undefined){B=g;console.log("Unknown display name for "+g)}}var v=j[w]==u.getLanguage();var c=JSComponent.createOptionElement(j[w],B,v);x.languageSelect.appendChild(c)}}else{z(x.languageSelect)}x.unitSelect=x.getElement("unit-select");if(u.isPropertyEditable("UNIT")){x.unitSelect.appendChild(JSComponent.createOptionElement("MILLIMETER",r.getLocalizedString("UserPreferencesPanel","unitComboBox.millimeter.text"),u.getUnit()==LengthUnit.MILLIMETER));x.unitSelect.appendChild(JSComponent.createOptionElement("CENTIMETER",r.getLocalizedString("UserPreferencesPanel","unitComboBox.centimeter.text"),u.getUnit()==LengthUnit.CENTIMETER));x.unitSelect.appendChild(JSComponent.createOptionElement("METER",r.getLocalizedString("UserPreferencesPanel","unitComboBox.meter.text"),u.getUnit()==LengthUnit.METER));x.unitSelect.appendChild(JSComponent.createOptionElement("INCH",r.getLocalizedString("UserPreferencesPanel","unitComboBox.inch.text"),u.getUnit()==LengthUnit.INCH));x.unitSelect.appendChild(JSComponent.createOptionElement("INCH_DECIMALS",r.getLocalizedString("UserPreferencesPanel","unitComboBox.inchDecimals.text"),u.getUnit()==LengthUnit.INCH_DECIMALS));x.registerEventListener(x.unitSelect,"change",function(J){var I=x.unitSelect.options[x.unitSelect.selectedIndex];u.setUnit(I!=null?LengthUnit[I.value]:null)})}else{z(x.unitSelect)}x.currencySelect=x.getElement("currency-select");x.valueAddedTaxCheckBox=x.getElement("value-added-tax-checkbox");var l=x.getLocalizedLabelText("UserPreferencesPanel","currencyComboBox.noCurrency.text");if(u.isPropertyEditable("CURRENCY")){x.currencySelect.appendChild(JSComponent.createOptionElement("",l,!u.getCurrency()));var d={EUR:"EUR ",AED:"AED AED",AFN:"AFN ",ALL:"ALL Lek",AMD:"AMD ",ANG:"ANG NAf.",AOA:"AOA Kz",ARS:"ARS $",AUD:"AUD $",AWG:"AWG Afl.",AZN:"AZN ",BAM:"BAM KM",BBD:"BBD $",BDT:"BDT ",BGN:"BGN .",BHD:"BHD ..",BIF:"BIF FBu",BMD:"BMD $",BND:"BND $",BOB:"BOB Bs",BRL:"BRL R$",BSD:"BSD $",BTN:"BTN Nu.",BWP:"BWP P",BYN:"BYN Br",BZD:"BZD $",CAD:"CAD $",CDF:"CDF FC",CHF:"CHF CHF",CLP:"CLP $",CNY:"CNY ",COP:"COP $",CRC:"CRC ",CSD:"CSD CSD",CUP:"CUP $",CVE:"CVE ",CZK:"CZK K",DJF:"DJF Fdj",DKK:"DKK kr",DOP:"DOP RD$",DZD:"DZD DA",EGP:"EGP ..",ERN:"ERN Nfk",ETB:"ETB Br",EUR:"EUR ",FJD:"FJD $",FKP:"FKP ",GBP:"GBP ",GEL:"GEL ",GHS:"GHS GH",GIP:"GIP ",GMD:"GMD D",GNF:"GNF FG",GTQ:"GTQ Q",GYD:"GYD $",HKD:"HKD HK$",HNL:"HNL L",HRK:"HRK HRK",HTG:"HTG G",HUF:"HUF Ft",IDR:"IDR Rp",ILS:"ILS ",INR:"INR ",IQD:"IQD ..",IRR:"IRR IRR",ISK:"ISK ISK",JMD:"JMD $",JOD:"JOD ..",JPY:"JPY ",KES:"KES Ksh",KGS:"KGS ",KHR:"KHR ",KMF:"KMF CF",KPW:"KPW KPW",KRW:"KRW ",KWD:"KWD ..",KYD:"KYD $",KZT:"KZT ",LAK:"LAK ",LBP:"LBP ..",LKR:"LKR Rs.",LRD:"LRD $",LSL:"LSL LSL",LYD:"LYD ..",MAD:"MAD MAD",MDL:"MDL L",MGA:"MGA Ar",MKD:"MKD den",MMK:"MMK K",MNT:"MNT ",MOP:"MOP MOP$",MRU:"MRU UM",MUR:"MUR Rs",MWK:"MWK MK",MXN:"MXN $",MYR:"MYR RM",MZN:"MZN MTn",NAD:"NAD $",NGN:"NGN ",NIO:"NIO C$",NOK:"NOK kr",NPR:"NPR ",NZD:"NZD $",OMR:"OMR ..",PAB:"PAB B/.",PEN:"PEN S/",PGK:"PGK K",PHP:"PHP ",PKR:"PKR ",PLN:"PLN z",PYG:"PYG Gs.",QAR:"QAR ..",RON:"RON RON",RSD:"RSD RSD",RUB:"RUB ",RWF:"RWF RF",SAR:"SAR ..",SBD:"SBD $",SCR:"SCR SR",SDG:"SDG SDG",SEK:"SEK kr",SGD:"SGD $",SHP:"SHP ",SLL:"SLL Le",SOS:"SOS S",SRD:"SRD $",SSP:"SSP ",STN:"STN Db",SVC:"SVC C",SYP:"SYP LS",SZL:"SZL E",THB:"THB ",TJS:"TJS .",TMT:"TMT TMT",TND:"TND DT",TOP:"TOP T$",TRY:"TRY ",TTD:"TTD $",TWD:"TWD $",TZS:"TZS TSh",UAH:"UAH ",UGX:"UGX USh",USD:"USD $",UYU:"UYU $",UZS:"UZS ",VES:"VES Bs.S",VND:"VND ",VUV:"VUV VT",WST:"WST WS$",XAF:"XAF FCFA",XCD:"XCD $",XOF:"XOF CFA",XPF:"XPF FCFP",YER:"YER ..",ZAR:"ZAR R",ZMW:"ZMW K",ZWL:"ZWL ZWL"};var A=Object.keys(d);for(var w=0;w<A.length;w++){var o=A[w];var n=d[o];x.currencySelect.appendChild(JSComponent.createOptionElement(o,n,o==u.getCurrency()))}x.registerEventListener(x.currencySelect,"change",function(K){var I=x.currencySelect.selectedIndex;var J=x.currencySelect.options[I].value;u.setCurrency(J?J:null)});x.registerPropertyChangeListener(u,"CURRENCY",function(J){var I=x.currencySelect.querySelector("[value='"+(u.getCurrency()?u.getCurrency():"")+"']");I.selected=true;x.valueAddedTaxCheckBox.disabled=u.getCurrency()==null});var E=u.isPropertyEditable("VALUE_ADDED_TAX_ENABLED");x.valueAddedTaxCheckBox.parentElement.style.display=E?"initial":"none";x.valueAddedTaxCheckBox.disabled=u.getCurrency()==null;x.valueAddedTaxCheckBox.checked=u.isValueAddedTaxEnabled();x.registerEventListener(x.valueAddedTaxCheckBox,"change",function(I){u.setValueAddedTaxEnabled(x.valueAddedTaxCheckBox.checked)});x.registerPropertyChangeListener(u,"VALUE_ADDED_TAX_ENABLED",function(I){x.valueAddedTaxCheckBox.disabled=u.getCurrency()==null;x.valueAddedTaxCheckBox.checked=u.isValueAddedTaxEnabled()})}else{z(x.currencySelect)}x.furnitureCatalogViewTreeRadioButton=x.findElement("[name='furniture-catalog-view-radio'][value='tree']");if(u.isPropertyEditable("FURNITURE_CATALOG_VIEWED_IN_TREE")&&false){var b=u.isFurnitureCatalogViewedInTree()?"tree":"list";x.findElement("[name='furniture-catalog-view-radio'][value='"+b+"']").checked=true}else{z(x.furnitureCatalogViewTreeRadioButton)}x.navigationPanelCheckBox=x.getElement("navigation-panel-checkbox");if(u.isPropertyEditable("NAVIGATION_PANEL_VISIBLE")){x.navigationPanelCheckBox.checked=u.isNavigationPanelVisible()}else{z(x.navigationPanelCheckBox)}x.aerialViewCenteredOnSelectionCheckBox=x.getElement("aerial-view-centered-on-selection-checkbox");if(u.isPropertyEditable("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED")){x.aerialViewCenteredOnSelectionCheckBox.checked=u.isAerialViewCenteredOnSelectionEnabled()}else{z(x.aerialViewCenteredOnSelectionCheckBox)}x.observerCameraSelectedAtChangeCheckBox=x.getElement("observer-camera-selected-at-change-checkbox");if(u.isPropertyEditable("OBSERVER_CAMERA_SELECTED_AT_CHANGE")){x.observerCameraSelectedAtChangeCheckBox.checked=u.isObserverCameraSelectedAtChange()}else{z(x.observerCameraSelectedAtChangeCheckBox)}x.magnetismCheckBox=x.getElement("magnetism-checkbox");if(u.isPropertyEditable("MAGNETISM_ENABLED")){x.magnetismCheckBox.checked=u.isMagnetismEnabled()}else{z(x.magnetismCheckBox)}x.rulersCheckBox=x.getElement("rulers-checkbox");if(u.isPropertyEditable("RULERS_VISIBLE")&&false){x.rulersCheckBox.checked=u.isRulersVisible()}else{z(x.rulersCheckBox)}x.gridCheckBox=x.getElement("grid-checkbox");if(u.isPropertyEditable("GRID_VISIBLE")){x.gridCheckBox.checked=u.isGridVisible()}else{z(x.gridCheckBox)}x.defaultFontNameSelect=x.getElement("default-font-name-select");if(u.isPropertyEditable("DEFAULT_FONT_NAME")){var D="DEFAULT_SYSTEM_FONT_NAME";var a=function(){var I=u.getDefaultFontName()==null?D:u.getDefaultFontName();var J=x.defaultFontNameSelect.querySelector("[value='"+I+"']");if(J){J.selected=true}};CoreTools.loadAvailableFontNames(function(L){L=[D].concat(L);for(var K=0;K<L.length;K++){var I=L[K];var J=K==0?x.getLocalizedLabelText("FontNameComboBox","systemFontName"):I;x.defaultFontNameSelect.appendChild(JSComponent.createOptionElement(I,J))}a()});x.registerPropertyChangeListener(u,"DEFAULT_FONT_NAME",a);x.registerEventListener(x.defaultFontNameSelect,"change",function(J){var I=x.defaultFontNameSelect.querySelector("option:checked").value;u.setDefaultFontName(I==D?null:I)})}else{z(x.defaultFontNameSelect)}x.iconTopViewRadioButton=x.findElement("[name='furniture-icon-radio'][value='topView']");x.iconSizeSelect=x.getElement("icon-size-select");if(u.isPropertyEditable("FURNITURE_VIEWED_FROM_TOP")){var k=u.isFurnitureViewedFromTop()?"topView":"catalog";x.findElement("[name='furniture-icon-radio'][value='"+k+"']").checked=true;var q=[128,256,512,1024];for(var w=0;w<q.length;w++){var t=q[w];x.iconSizeSelect.appendChild(JSComponent.createOptionElement(t,t+""+t,u.getFurnitureModelIconSize()==t))}var F=function(I){I.iconSizeSelect.disabled=!I.iconTopViewRadioButton.checked};F(x);x.registerEventListener(x.findElements("[name='furniture-icon-radio']"),"change",function(I){F(x)})}else{z(x.iconTopViewRadioButton)}x.roomRenderingFloorColorOrTextureRadioButton=x.findElement("[name='room-rendering-radio'][value='floorColorOrTexture']");if(u.isPropertyEditable("ROOM_FLOOR_COLORED_OR_TEXTURED")){var s=u.isRoomFloorColoredOrTextured()?"floorColorOrTexture":"monochrome";x.findElement("[name='room-rendering-radio'][value='"+s+"']").checked=true}else{z(x.roomRenderingFloorColorOrTextureRadioButton)}var H=x.getElement("new-wall-pattern-select");if(u.isPropertyEditable("NEW_WALL_PATTERN")){var G={};var e=r.getPatternsCatalog().getPatterns();for(var w=0;w<e.length;w++){var m=e[w].getImage().getURL();G[m]=e[w]}H.classList.add("wall-pattern-combo-box");x.patternComboBox=new JSComboBox(r,H,{availableValues:Object.keys(G),renderCell:function(I,J){J.style.backgroundImage="url('"+I+"')"},selectionChanged:function(I){u.setNewWallPattern(G[I])}});var y=(u.getNewWallPattern()!=null?u.getNewWallPattern():u.getWallPattern()).getImage().getURL();x.patternComboBox.setSelectedItem(y);x.registerPropertyChangeListener(u,"NEW_WALL_PATTERN",function(){var I=u.getNewWallPattern().getImage().getURL();x.patternComboBox.setSelectedItem(I)})}else{z(x.newWallPatternSelect)}x.newWallThicknessInput=new JSSpinner(r,x.getElement("new-wall-thickness-input"),{value:1,minimum:0,maximum:100000});if(u.isPropertyEditable("NEW_WALL_THICKNESS")){x.newWallThicknessInput.setValue(u.getNewWallThickness())}else{z(x.newWallThicknessInput)}x.newWallHeightInput=new JSSpinner(r,x.getElement("new-wall-height-input"),{value:1,minimum:0,maximum:100000});if(u.isPropertyEditable("NEW_WALL_HEIGHT")){x.newWallHeightInput.setValue(u.getNewWallHeight())}else{z(x.newWallHeightInput)}x.newFloorThicknessInput=new JSSpinner(r,x.getElement("new-floor-thickness-input"),{value:1,minimum:0,maximum:100000});if(u.isPropertyEditable("NEW_FLOOR_THICKNESS")){x.newFloorThicknessInput.setValue(u.getNewFloorThickness())}else{z(x.newFloorThicknessInput)}var h=function(K,I,J){if(u.getUnit()==LengthUnit.INCH||u.getUnit()==LengthUnit.INCH_DECIMALS){K.setStepSize(LengthUnit.inchToCentimeter(J))}else{K.setStepSize(I)}K.setMinimum(u.getUnit().getMinimumLength());if(K.getMinimum()>K.getValue()){K.setValue(K.getMinimum())}K.setFormat(u.getUnit().getFormat())};var f=function(){h(x.newWallThicknessInput,0.5,0.125);h(x.newWallHeightInput,10,2);h(x.newFloorThicknessInput,0.5,0.125)};f();x.registerPropertyChangeListener(u,"UNIT",function(I){f()});return x};JSViewFactory.prototype.createLevelView=function(l,p){var t=new JSDialog(l,"@{LevelPanel.level.title}",document.getElementById("level-dialog-template"),{size:"medium",applier:function(){p.modifyLevels()}});var k=l.getLengthUnit().getName();var u=t.getElement("viewable-checkbox");var o=p.isPropertyEditable("VIEWABLE")?"initial":"none";u.parentElement.style.display=o;u.checked=p.getViewable();t.registerEventListener(u,"change",function(z){p.setViewable(u.checked)});t.registerPropertyChangeListener(p,"VIEWABLE",function(z){u.checked=p.getViewable()});var e=t.getElement("name-input");var j=p.isPropertyEditable("NAME")?"initial":"none";e.parentElement.style.display=j;e.parentElement.previousElementSibling.style.display=j;e.value=p.getName()!=null?p.getName():"";t.registerEventListener(e,"input",function(A){var z=e.value;if(z.trim().length==0){p.setName(null)}else{p.setName(z)}});t.registerPropertyChangeListener(p,"NAME",function(z){e.value=p.getName()!=null?p.getName():""});var x=l.getLengthUnit().getMinimumLength();var w=l.getLengthUnit().getMaximumLength();var g=function(){var A=p.getSelectedLevelIndex();if(A!=null){var z=p.getLevels();t.floorThicknessInput.setEnabled(z[A].getElevation()!=z[0].getElevation())}};var a=function(){var A=p.getSelectedLevelIndex();if(A!=null){var z=p.getLevels();t.increaseElevationButton.disabled=!(A<z.length-1&&z[A].getElevation()==z[A+1].getElevation());t.decreaseElevationButton.disabled=!(A>0&&z[A].getElevation()==z[A-1].getElevation())}else{t.increaseElevationButton.setEnabled(false);t.decreaseElevationButton.setEnabled(false)}};var c=p.isPropertyEditable("ELEVATION")?"initial":"none";t.getElement("elevation-label").textContent=t.getLocalizedLabelText("LevelPanel","elevationLabel.text",k);var d=new JSSpinner(l,t.getElement("elevation-input"),{nullable:p.getElevation()==null,format:l.getLengthUnit().getFormat(),value:p.getElevation(),minimum:-1000,maximum:l.getLengthUnit().getMaximumElevation(),stepSize:l.getLengthUnit().getStepSize()});d.parentElement.style.display=c;d.parentElement.previousElementSibling.style.display=c;t.registerEventListener(d,"input",function(z){p.setElevation(d.getValue());g();a()});t.registerPropertyChangeListener(p,"ELEVATION",function(z){d.setValue(z.getNewValue())});var h=p.isPropertyEditable("FLOOR_THICKNESS")?"initial":"none";t.getElement("floor-thickness-label").textContent=t.getLocalizedLabelText("LevelPanel","floorThicknessLabel.text",k);var m=new JSSpinner(l,t.getElement("floor-thickness-input"),{nullable:p.getFloorThickness()==null,format:l.getLengthUnit().getFormat(),value:p.getFloorThickness(),minimum:x,maximum:w/10,stepSize:l.getLengthUnit().getStepSize()});m.parentElement.style.display=h;m.parentElement.previousElementSibling.style.display=h;t.registerEventListener(m,"input",function(z){p.setFloorThickness(m.getValue())});t.registerPropertyChangeListener(p,"FLOOR_THICKNESS",function(z){m.setValue(z.getNewValue())});t.floorThicknessInput=m;g(p);var y=p.isPropertyEditable("HEIGHT")?"initial":"none";t.getElement("height-label").textContent=t.getLocalizedLabelText("LevelPanel","heightLabel.text",k);var n=new JSSpinner(l,t.getElement("height-input"),{nullable:p.getHeight()==null,format:l.getLengthUnit().getFormat(),value:p.getHeight(),minimum:x,maximum:w,stepSize:l.getLengthUnit().getStepSize()});n.parentElement.style.display=y;n.parentElement.previousElementSibling.style.display=y;t.registerEventListener(n,"input",function(z){p.setHeight(n.getValue())});t.registerPropertyChangeListener(p,"HEIGHT",function(z){n.setValue(z.getNewValue())});var s=p.isPropertyEditable("ELEVATION_INDEX")?"initial":"none";var b=new ResourceAction(l,"LevelPanel","INCREASE_ELEVATION_INDEX",true);var f=new ResourceAction(l,"LevelPanel","DECREASE_ELEVATION_INDEX",true);t.increaseElevationButton=t.getElement("increase-elevation-index-button");t.increaseElevationButton.style.backgroundImage="url('"+ZIPTools.getScriptFolder()+"/"+b.getValue(AbstractAction.SMALL_ICON)+"')";t.increaseElevationButton.style.display=s;t.registerEventListener(t.increaseElevationButton,"click",function(z){p.setElevationIndex(p.getElevationIndex()+1);a()});t.decreaseElevationButton=t.getElement("decrease-elevation-index-button");t.decreaseElevationButton.style.backgroundImage="url('"+ZIPTools.getScriptFolder()+"/"+f.getValue(AbstractAction.SMALL_ICON)+"')";t.decreaseElevationButton.style.display=s;t.registerEventListener(t.decreaseElevationButton,"click",function(z){p.setElevationIndex(p.getElevationIndex()-1);a()});a();var v=t.getElement("levels-table").querySelector("tbody");var r=function(){var B=p.getSelectedLevelIndex();var z=v.querySelector(".selected");if(z!=null){z.classList.remove("selected")}if(B!=null){var A=v.childElementCount-B-1;v.children[A].classList.add("selected")}};var q=function(){var D=p.getLevels();var B="";var z=l.getLengthUnit().getFormat();for(var C=D.length-1;C>=0;C--){var E=D[C];var A=E.isViewable()?"":"disabled";B+="<tr "+A+">  <td>"+E.getName()+"</td>  <td>"+z.format(E.getElevation())+"</td>  <td>"+(E.getElevation()==D[0].getElevation()?"":z.format(E.getFloorThickness()))+"</td>  <td>"+z.format(E.getHeight())+"</td></tr>"}v.innerHTML=B;r()};q();t.registerPropertyChangeListener(p,"SELECT_LEVEL_INDEX",r);t.registerPropertyChangeListener(p,"LEVELS",q);return t};JSViewFactory.prototype.createHomeFurnitureView=function(b,a){function c(){this.controller=a;JSDialog.call(this,b,"@{HomeFurniturePanel.homeFurniture.title}",document.getElementById("home-furniture-dialog-template"),{applier:function(){a.modifyFurniture()},disposer:function(f){f.paintPanel.colorButton.dispose();f.paintPanel.textureComponent.dispose()}});this.initNameAndPricePanel();this.initLocationPanel();this.initPaintPanel();this.initOrientationPanel();this.initSizePanel();this.initShininessPanel();var e=this;if(this.controller.isPropertyEditable("VISIBLE")){var d=this.getElement("visible-checkbox");d.checked=this.controller.getVisible();this.registerPropertyChangeListener(this.controller,"VISIBLE",function(f){d.checked=f.getNewValue()});this.registerEventListener(d,"change",function(f){e.controller.setVisible(d.checked)})}if(this.controller.isPropertyEditable("PAINT")){this.updatePaintRadioButtons()}}c.prototype=Object.create(JSDialog.prototype);c.prototype.constructor=c;c.prototype.initNameAndPricePanel=function(){var k=this.getElement("name-and-price-title");k.textContent=this.getLocalizedLabelText("HomeFurniturePanel",a.isPropertyEditable("PRICE")?"nameAndPricePanel.title":"namePanel.title");var m=this.getElement("name-label");var n=this.getElement("name-input");var o=this.getElement("name-visible-checkbox");var j=this.getElement("price-label");var l=new JSSpinner(this.preferences,this.getElement("price-input"),{nullable:this.controller.getPrice()==null,value:0,minimum:0,maximum:1000000000});var e=new JSSpinner(this.preferences,this.getElement("value-added-tax-percentage-input"),{nullable:this.controller.getValueAddedTaxPercentage()==null,value:0,minimum:0,maximum:100,stepSize:0.5});var f=this.controller.isPropertyEditable("NAME")?"initial":"none";var h=this.controller.isPropertyEditable("NAME_VISIBLE")?"initial":"none";var g=this.controller.isPropertyEditable("PRICE")?"inline-block":"none";var d=this.controller.isPropertyEditable("VALUE_ADDED_TAX_PERCENTAGE")?"inline-block":"none";m.style.display=f;n.style.display=f;o.parentElement.style.display=h;j.style.display=g;l.style.display=g;e.getHTMLElement().previousElementSibling.style.display=d;e.style.display=d;n.value=a.getName()!=null?a.getName():"";o.checked=this.controller.getNameVisible();l.setValue(this.controller.getPrice());if(this.controller.getValueAddedTaxPercentage()){e.setValue(this.controller.getValueAddedTaxPercentage()*100)}this.registerPropertyChangeListener(this.controller,"NAME",function(p){n.value=a.getName()!=null?a.getName():""});this.registerPropertyChangeListener(this.controller,"NAME_VISIBLE",function(p){o.checked=a.getNameVisible()});this.registerPropertyChangeListener(this.controller,"PRICE",function(p){l.setValue(a.getPrice())});this.registerPropertyChangeListener(this.controller,"VALUE_ADDED_TAX_PERCENTAGE",function(p){if(a.getValueAddedTaxPercentage()){e.setValue(a.getValueAddedTaxPercentage()*100)}else{e.setValue(null)}});this.registerEventListener(n,"input",function(q){var p=n.value;if(p.trim().length==0){a.setName(null)}else{a.setName(p)}});this.registerEventListener(o,"change",function(p){a.setNameVisible(o.checked)});this.registerEventListener(l,"input",function(p){a.setPrice(l.getValue()!=null?new Big(l.getValue()):null)});this.registerEventListener(e,"input",function(q){var p=e.getValue();a.setValueAddedTaxPercentage(p!=null?new Big(p/100):null)})};c.prototype.initLocationPanel=function(){var h=this.getElement("x-label");var j=new JSSpinner(this.preferences,this.getElement("x-input"),{nullable:this.controller.getX()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var o=this.getElement("y-label");var n=new JSSpinner(this.preferences,this.getElement("y-input"),{nullable:this.controller.getY()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var r=this.getElement("elevation-label");var s=new JSSpinner(this.preferences,this.getElement("elevation-input"),{nullable:this.controller.getElevation()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var u=this.getElement("mirrored-model-checkbox");var q=this.getElement("base-plan-item-checkbox");var p=this.controller.isPropertyEditable("X")?"initial":"none";var m=this.controller.isPropertyEditable("Y")?"initial":"none";var t=this.controller.isPropertyEditable("ELEVATION")?"initial":"none";var g=this.controller.isPropertyEditable("MODEL_MIRRORED")?"initial":"none";var e=this.controller.isPropertyEditable("BASE_PLAN_ITEM")?"initial":"none";h.style.display=p;j.getHTMLElement().parentElement.style.display=p;o.style.display=m;n.getHTMLElement().parentElement.style.display=m;r.style.display=t;s.getHTMLElement().parentElement.style.display=t;u.parentElement.style.display=g;q.parentElement.style.display=e;j.setValue(this.controller.getX());n.setValue(this.controller.getY());s.setValue(this.controller.getElevation());u.checked=this.controller.getModelMirrored();q.checked=this.controller.getBasePlanItem();var f=this.preferences.getLengthUnit().getName();h.textContent=this.getLocalizedLabelText("HomeFurniturePanel","xLabel.text",f);o.textContent=this.getLocalizedLabelText("HomeFurniturePanel","yLabel.text",f);r.textContent=this.getLocalizedLabelText("HomeFurniturePanel","elevationLabel.text",f);var l=this.preferences.getLengthUnit().getMaximumLength();var d=this.preferences.getLengthUnit().getMaximumElevation();j.setMinimum(-l);n.setMinimum(-l);j.setMaximum(l);n.setMaximum(l);s.setMinimum(0);s.setMaximum(d);var k=this.controller;this.registerPropertyChangeListener(this.controller,"X",function(v){j.setValue(k.getX())});this.registerPropertyChangeListener(this.controller,"Y",function(v){n.setValue(k.getY())});this.registerPropertyChangeListener(this.controller,"ELEVATION",function(v){s.setValue(k.getElevation())});this.registerPropertyChangeListener(this.controller,"MODEL_MIRRORED",function(v){u.checked=k.getModelMirrored()});this.registerPropertyChangeListener(this.controller,"BASE_PLAN_ITEM",function(v){q.checked=k.getBasePlanItem()});this.registerEventListener(j,"input",function(v){k.setX(j.getValue())});this.registerEventListener(n,"input",function(v){k.setY(n.getValue())});this.registerEventListener(s,"input",function(v){k.setElevation(s.getValue())});this.registerEventListener(u,"change",function(v){k.setModelMirrored(u.checked)});this.registerEventListener(q,"change",function(v){k.setBasePlanItem(q.checked)});this.locationPanel={element:this.findElement(".location-panel"),elevationInput:s}};c.prototype.initOrientationPanel=function(){var p=this.controller;var f=this.getElement("angle-label");var e=new DecimalFormat("0.#");var j=new JSSpinner(this.preferences,this.getElement("angle-input"),{nullable:this.controller.getAngle()==null,format:e,minimum:0,maximum:360});var g=this.findElement("[name='horizontal-rotation-radio'][value='ROLL']");var q=this.findElement("[name='horizontal-rotation-radio'][value='PITCH']");var l=new JSSpinner(this.preferences,this.getElement("roll-input"),{nullable:this.controller.getRoll()==null,format:e,minimum:0,maximum:360});var t=new JSSpinner(this.preferences,this.getElement("pitch-input"),{nullable:this.controller.getPitch()==null,format:e,minimum:0,maximum:360});var s=this.getElement("vertical-rotation-label");var w=this.getElement("horizontal-rotation-label");var v=this.getElement("furniture-orientation-image");v.innerHTML="<img src='"+ZIPTools.getScriptFolder()+"/resources/furnitureOrientation.png' />";var k=this.controller.isPropertyEditable("ANGLE_IN_DEGREES")||this.controller.isPropertyEditable("ANGLE")?"initial":"none";var u=this.controller.isPropertyEditable("ROLL")?"initial":"none";var r=this.controller.isPropertyEditable("PITCH")?"initial":"none";var n=this.controller.isPropertyEditable("ROLL")&&this.controller.isPropertyEditable("PITCH");var o=n?"initial":"none";var h=o;var m=this.controller.isTexturable()&&n?"initial":"none";f.style.display=k;j.getHTMLElement().parentElement.style.display=k;g.parentElement.style.display=u;l.getHTMLElement().parentElement.style.display=u;q.parentElement.style.display=r;t.getHTMLElement().parentElement.style.display=r;w.style.display=h;s.style.display=o;v.style.display=m;if(this.controller.getAngle()!=null){j.setValue(Math.toDegrees(this.controller.getAngle()))}else{j.setValue(null)}if(this.controller.getRoll()!=null){l.setValue(Math.toDegrees(this.controller.getRoll()))}else{l.setValue(null)}if(this.controller.getPitch()!=null){t.setValue(Math.toDegrees(this.controller.getPitch()))}else{t.setValue(null)}var d=function(){g.checked=p.getHorizontalAxis()==HomeFurnitureController.FurnitureHorizontalAxis.ROLL;q.checked=p.getHorizontalAxis()==HomeFurnitureController.FurnitureHorizontalAxis.PITCH};d();this.registerPropertyChangeListener(this.controller,"ANGLE",function(x){if(p.getAngle()!=null){j.setValue(Math.toDegrees(p.getAngle()))}else{j.setValue(null)}});this.registerPropertyChangeListener(this.controller,"ROLL",function(x){if(p.getRoll()!=null){l.setValue(Math.toDegrees(p.getRoll()))}else{l.setValue(null)}});this.registerPropertyChangeListener(this.controller,"PITCH",function(x){if(p.getPitch()!=null){t.setValue(Math.toDegrees(p.getPitch()))}else{t.setValue(null)}});this.registerPropertyChangeListener(this.controller,"HORIZONTAL_AXIS",function(x){d()});this.registerEventListener(j,"input",function(x){if(j.getValue()==null){p.setAngle(null)}else{p.setAngle(Math.toRadians(j.getValue()))}});this.registerEventListener(l,"input",function(x){if(l.getValue()==null){p.setRoll(null)}else{p.setRoll(Math.toRadians(l.getValue()));p.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.ROLL)}});this.registerEventListener(t,"input",function(x){if(t.getValue()==null){p.setPitch(null)}else{p.setPitch(Math.toRadians(t.getValue()));p.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.PITCH)}});this.registerEventListener([g,q],"change",function(x){if(g.checked){p.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.ROLL)}else{p.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.PITCH)}});if(!n){this.findElement(".orientation-column").style.display="none";this.locationPanel.elevationInput.parentElement.insertAdjacentElement("afterend",f);f.insertAdjacentElement("afterend",j.parentElement)}};c.prototype.initPaintPanel=function(){var l=this;var h=this.controller;var g=this.preferences;var p=new ColorButton(g,{colorChanged:function(q){n[HomeFurnitureController.FurniturePaint.COLORED].checked=true;h.setPaint(HomeFurnitureController.FurniturePaint.COLORED);h.setColor(q)}});this.attachChildComponent("color-button",p);p.setColor(h.getColor());p.setColorDialogTitle(g.getLocalizedString("HomeFurniturePanel","colorDialog.title"));var o=h.getTextureController().getView();this.attachChildComponent("texture-component",o);var e=h.getPaint();var n=[];n[HomeFurnitureController.FurniturePaint.DEFAULT]=l.findElement("[name='paint-checkbox'][value='default']");n[HomeFurnitureController.FurniturePaint.COLORED]=l.findElement("[name='paint-checkbox'][value='color']");n[HomeFurnitureController.FurniturePaint.TEXTURED]=l.findElement("[name='paint-checkbox'][value='texture']");n[HomeFurnitureController.FurniturePaint.MODEL_MATERIALS]=l.findElement("[name='paint-checkbox'][value='MODEL_MATERIALS']");for(var f=0;f<n.length;f++){var d=n[f];d.checked=f==e||(f==HomeFurnitureController.FurniturePaint.DEFAULT&&!n[e])}var m=h.getModelMaterialsController().getView();this.attachChildComponent("material-component",m);var j=h.getModelMaterialsController().getModel()!=null;n[HomeFurnitureController.FurniturePaint.MODEL_MATERIALS].disabled=!j;m.setEnabled(j);this.paintPanel={colorAndTextureRadioButtons:n,colorButton:p,textureComponent:o};var k=h.isPropertyEditable("PAINT")?undefined:"none";this.getElement("paint-panel").style.display=k;this.getElement("paint-panel").previousElementSibling.style.display=k;this.registerPropertyChangeListener(h,"PAINT",function(q){l.updatePaintRadioButtons()});this.registerEventListener(n,"change",function(q){var r=n.indexOf(q.target);h.setPaint(r)})};c.prototype.updatePaintRadioButtons=function(){var h=this;var d=this.controller;var g=h.paintPanel.colorAndTextureRadioButtons;if(d.getPaint()==null){for(var f=0;f<g.length;f++){g[f].checked=false}}else{var e=g[d.getPaint()];if(e){e.checked=true}this.updateShininessRadioButtons(d)}};c.prototype.initSizePanel=function(){var l=this;var j=this.controller;var r=this.getElement("width-label");var s=new JSSpinner(this.preferences,this.getElement("width-input"),{nullable:j.getWidth()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var f=this.getElement("depth-label");var g=new JSSpinner(this.preferences,this.getElement("depth-input"),{nullable:j.getDepth()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var o=this.getElement("height-label");var p=this.getElement("height-input");var p=new JSSpinner(this.preferences,this.getElement("height-input"),{nullable:j.getHeight()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var n=this.getElement("keep-proportions-checkbox");var q=this.controller.isPropertyEditable("WIDTH")?"initial":"none";var t=this.controller.isPropertyEditable("DEPTH")?"initial":"none";var m=this.controller.isPropertyEditable("HEIGHT")?"initial":"none";var d=this.controller.isPropertyEditable("PROPORTIONAL")?"initial":"none";r.style.display=q;s.parentElement.style.display=q;f.style.display=t;g.parentElement.style.display=t;o.style.display=m;p.parentElement.style.display=m;n.parentElement.style.display=d;s.setValue(this.controller.getWidth());g.setValue(this.controller.getDepth());p.setValue(this.controller.getHeight());n.checked=this.controller.isProportional();var e=this.preferences.getLengthUnit().getName();r.textContent=this.getLocalizedLabelText("HomeFurniturePanel","widthLabel.text",e);f.textContent=this.getLocalizedLabelText("HomeFurniturePanel","depthLabel.text",e);o.textContent=this.getLocalizedLabelText("HomeFurniturePanel","heightLabel.text",e);var h=this.preferences.getLengthUnit().getMinimumLength();var k=this.preferences.getLengthUnit().getMaximumLength();s.setMinimum(h);s.setMaximum(k);g.setMinimum(h);g.setMaximum(k);p.setMinimum(h);p.setMaximum(k);var j=this.controller;this.registerPropertyChangeListener(this.controller,"WIDTH",function(u){s.setValue(j.getWidth())});this.registerPropertyChangeListener(this.controller,"DEPTH",function(u){g.setValue(j.getDepth())});this.registerPropertyChangeListener(this.controller,"HEIGHT",function(u){p.setValue(j.getHeight())});this.registerPropertyChangeListener(this.controller,"PROPORTIONAL",function(u){n.checked=j.isProportional()});this.registerEventListener(s,"input",function(u){j.setWidth(s.getValue())});this.registerEventListener(g,"input",function(u){j.setDepth(g.getValue())});this.registerEventListener(p,"input",function(u){j.setHeight(p.getValue())});this.registerEventListener(n,"change",function(u){j.setProportional(n.checked)});this.sizePanel={widthLabel:r,widthInput:s,depthLabel:f,depthInput:g,heightLabel:o,heightInput:p,keepProportionsCheckBox:n};this.updateSizeComponents();this.registerPropertyChangeListener(this.controller,"RESIZABLE",function(u){dalog.updateSizeComponents()});this.registerPropertyChangeListener(this.controller,"DEFORMABLE",function(u){dalog.updateSizeComponents()})};c.prototype.updateSizeComponents=function(){var d=this.controller.isResizable();this.sizePanel.widthLabel.disabled=!d;this.sizePanel.widthInput.disabled=!d;this.sizePanel.depthLabel.disabled=!d;this.sizePanel.depthInput.disabled=!d;this.sizePanel.heightLabel.disabled=!d;this.sizePanel.heightInput.disabled=!d;this.sizePanel.keepProportionsCheckBox.disabled=!d||!this.controller.isDeformable()};c.prototype.initShininessPanel=function(){var d=this.controller;var e=this;var j=this.findElement("[name='shininess-radio'][value='DEFAULT']");var g=this.findElement("[name='shininess-radio'][value='MATT']");var f=this.findElement("[name='shininess-radio'][value='SHINY']");this.shininessPanel={defaultShininessRadioButton:j,mattRadioButton:g,shinyRadioButton:f};var h=d.isPropertyEditable("SHININESS")?"initial":"none";j.parentElement.style.display=h;g.parentElement.style.display=h;f.parentElement.style.display=h;if(d.isPropertyEditable("SHININESS")){this.registerEventListener([j,g,f],"change",function(l){var k=e.findElement("[name='shininess-radio']:checked");d.setShininess(HomeFurnitureController.FurnitureShininess[k.value])});this.registerPropertyChangeListener(d,"SHININESS",function(k){e.updateShininessRadioButtons(d)});this.updateShininessRadioButtons(d)}};c.prototype.updateShininessRadioButtons=function(){var d=this.controller;if(d.isPropertyEditable("SHININESS")){if(d.getShininess()==HomeFurnitureController.FurnitureShininess.DEFAULT){this.shininessPanel.defaultShininessRadioButton.checked=true}else{if(d.getShininess()==HomeFurnitureController.FurnitureShininess.MATT){this.shininessPanel.mattRadioButton.checked=true}else{if(d.getShininess()==HomeFurnitureController.FurnitureShininess.SHINY){this.shininessPanel.shinyRadioButton.checked=true}else{this.shininessPanel.defaultShininessRadioButton.checked=false;this.shininessPanel.mattRadioButton.checked=false;this.shininessPanel.shinyRadioButton.checked=false}}}var e=d.getPaint()!=HomeFurnitureController.FurniturePaint.MODEL_MATERIALS;this.shininessPanel.defaultShininessRadioButton.disabled=!e;this.shininessPanel.mattRadioButton.disabled=!e;this.shininessPanel.shinyRadioButton.disabled=!e;if(!e){this.shininessPanel.defaultShininessRadioButton.checked=false;this.shininessPanel.mattRadioButton.checked=false;this.shininessPanel.shinyRadioButton.checked=false}}};return new c()};JSViewFactory.prototype.createWallView=function(c,d){var k=function(v){var u=c.getLengthUnit().getMaximumLength();var q=v.getElement("x-start-label");var l=v.getElement("y-start-label");var r=new JSSpinner(c,v.getElement("x-start-input"),{nullable:d.getXStart()==null,format:c.getLengthUnit().getFormat(),value:d.getXStart(),minimum:-u,maximum:u,stepSize:c.getLengthUnit().getStepSize()});var m=new JSSpinner(c,v.getElement("y-start-input"),{nullable:d.getYStart()==null,format:c.getLengthUnit().getFormat(),value:d.getYStart(),minimum:-u,maximum:u,stepSize:c.getLengthUnit().getStepSize()});var p=v.getElement("x-end-label");var x=v.getElement("y-end-label");var t=v.getElement("distance-to-end-point-label");var o=new JSSpinner(c,v.getElement("x-end-input"),{nullable:d.getXEnd()==null,format:c.getLengthUnit().getFormat(),value:d.getXEnd(),minimum:-u,maximum:u,stepSize:c.getLengthUnit().getStepSize()});var w=new JSSpinner(c,v.getElement("y-end-input"),{nullable:d.getYEnd()==null,format:c.getLengthUnit().getFormat(),value:d.getYEnd(),minimum:-u,maximum:u,stepSize:c.getLengthUnit().getStepSize()});var s=new JSSpinner(c,v.getElement("distance-to-end-point-input"),{nullable:d.getDistanceToEndPoint()==null,format:c.getLengthUnit().getFormat(),value:d.getDistanceToEndPoint(),minimum:c.getLengthUnit().getMinimumLength(),maximum:2*u*Math.sqrt(2),stepSize:c.getLengthUnit().getStepSize()});var n=c.getLengthUnit().getName();q.textContent=v.getLocalizedLabelText("WallPanel","xLabel.text",n);p.textContent=v.getLocalizedLabelText("WallPanel","xLabel.text",n);l.textContent=v.getLocalizedLabelText("WallPanel","yLabel.text",n);x.textContent=v.getLocalizedLabelText("WallPanel","yLabel.text",n);t.textContent=v.getLocalizedLabelText("WallPanel","distanceToEndPointLabel.text",n);v.registerPropertyChangeListener(d,"X_START",function(y){r.setValue(y.getNewValue())});v.registerPropertyChangeListener(d,"Y_START",function(y){m.setValue(y.getNewValue())});v.registerPropertyChangeListener(d,"X_END",function(y){o.setValue(y.getNewValue())});v.registerPropertyChangeListener(d,"Y_END",function(y){w.setValue(y.getNewValue())});v.registerPropertyChangeListener(d,"DISTANCE_TO_END_POINT",function(y){s.setValue(y.getNewValue())});v.registerEventListener(r,"input",function(y){d.setXStart(r.getValue())});v.registerEventListener(m,"input",function(y){d.setYStart(m.getValue())});v.registerEventListener(o,"input",function(y){d.setXEnd(o.getValue())});v.registerEventListener(w,"input",function(y){d.setYEnd(w.getValue())});v.registerEventListener(s,"input",function(y){d.setDistanceToEndPoint(s.getValue());console.log("distance")})};var b=function(l,p){var s=p.getView();var r=new JSDialog(c,l,"<div data-name='content'></div>",{size:"small",applier:function(){},disposer:function(){s.dispose()}});r.attachChildComponent("content",s);var m=p.getVisible();var n=p.getColor();var q=p.getTextureController().getTexture();var o=p.getPaint();var t=p.getThickness();var u=p.getHeight();r.cancel=function(){p.setVisible(m);p.setColor(n);p.getTextureController().setTexture(q);p.setPaint(o);p.setThickness(t);p.setHeight(u);r.close()};r.displayView()};var e=function(s){var l=s.findElement("[name='left-side-color-and-texture-choice'][value='COLORED']");var r=s.findElement("[name='left-side-color-and-texture-choice'][value='TEXTURED']");var q=s.findElement("[name='right-side-color-and-texture-choice'][value='COLORED']");var y=s.findElement("[name='right-side-color-and-texture-choice'][value='TEXTURED']");var B=function(){l.checked=d.getLeftSidePaint()==WallController.WallPaint.COLORED;r.checked=d.getLeftSidePaint()==WallController.WallPaint.TEXTURED};var u=function(){q.checked=d.getRightSidePaint()==WallController.WallPaint.COLORED;y.checked=d.getRightSidePaint()==WallController.WallPaint.TEXTURED};B();u();s.registerPropertyChangeListener(d,"LEFT_SIDE_PAINT",function(){B()});s.registerPropertyChangeListener(d,"RIGHT_SIDE_PAINT",function(){u()});s.leftSideColorButton=new ColorButton(c,{colorChanged:function(C){s.findElement("[name='left-side-color-and-texture-choice'][value='COLORED']").checked=true;d.setLeftSidePaint(WallController.WallPaint.COLORED);d.setLeftSideColor(C)}});s.rightSideColorButton=new ColorButton(c,{colorChanged:function(C){s.findElement("[name='right-side-color-and-texture-choice'][value='COLORED']").checked=true;d.setRightSidePaint(WallController.WallPaint.COLORED);d.setRightSideColor(C)}});s.attachChildComponent("left-side-color-button",s.leftSideColorButton);s.attachChildComponent("right-side-color-button",s.rightSideColorButton);s.leftSideColorButton.setColor(d.getLeftSideColor());s.leftSideColorButton.setColorDialogTitle(c.getLocalizedString("WallPanel","leftSideColorDialog.title"));s.rightSideColorButton.setColor(d.getRightSideColor());s.rightSideColorButton.setColorDialogTitle(c.getLocalizedString("WallPanel","rightSideColorDialog.title"));s.registerPropertyChangeListener(d,"LEFT_SIDE_COLOR",function(){s.leftSideColorButton.setColor(d.getLeftSideColor())});s.registerPropertyChangeListener(d,"RIGHT_SIDE_COLOR",function(){s.rightSideColorButton.setColor(d.getRightSideColor())});s.leftSideTextureComponent=d.getLeftSideTextureController().getView();s.attachChildComponent("left-side-texture-component",s.leftSideTextureComponent);s.rightSideTextureComponent=d.getRightSideTextureController().getView();s.attachChildComponent("right-side-texture-component",s.rightSideTextureComponent);var p=s.findElement("[name='left-side-shininess-choice'][value='0']");var m=s.findElement("[name='left-side-shininess-choice'][value='0.25']");var x=s.findElement("[name='right-side-shininess-choice'][value='0']");var w=s.findElement("[name='right-side-shininess-choice'][value='0.25']");var z=function(){p.checked=d.getLeftSideShininess()==0;m.checked=d.getLeftSideShininess()==0.25};var o=function(){x.checked=d.getRightSideShininess()==0;w.checked=d.getRightSideShininess()==0.25};z();o();s.registerPropertyChangeListener(d,"LEFT_SIDE_SHININESS",function(C){z()});s.registerPropertyChangeListener(d,"RIGHT_SIDE_SHININESS",function(C){o()});s.registerEventListener([p,m],"change",function(C){d.setLeftSideShininess(parseFloat(this.value))});s.registerEventListener([x,w],"change",function(C){d.setRightSideShininess(parseFloat(this.value))});var n=s.getElement("left-side-modify-baseboard-button");var v=s.getElement("right-side-modify-baseboard-button");var A=new ResourceAction(c,"WallPanel","MODIFY_LEFT_SIDE_BASEBOARD",true);var t=new ResourceAction(c,"WallPanel","MODIFY_RIGHT_SIDE_BASEBOARD",true);n.textContent=A.getValue(AbstractAction.NAME);v.textContent=t.getValue(AbstractAction.NAME);s.registerEventListener(n,"click",function(C){b(s.getLocalizedLabelText("WallPanel","leftSideBaseboardDialog.title"),d.getLeftSideBaseboardController())});s.registerEventListener(v,"click",function(C){b(s.getLocalizedLabelText("WallPanel","rightSideBaseboardDialog.title"),d.getRightSideBaseboardController())})};var g=function(r){var t={};var n=c.getPatternsCatalog().getPatterns();for(var o=0;o<n.length;o++){var l=n[o].getImage().getURL();t[l]=n[o]}var p=r.getElement("pattern-select");p.classList.add("wall-pattern-combo-box");var s=new JSComboBox(this.preferences,p,{nullable:d.getPattern()!=null,availableValues:Object.keys(t),renderCell:function(x,y){y.style.backgroundImage="url('"+x+"')"},selectionChanged:function(x){d.setPattern(t[x])}});var u=function(){var x=d.getPattern();s.setSelectedItem(d.getPattern()!=null?x.getImage().getURL():null)};u();r.registerPropertyChangeListener(d,"PATTERN",function(x){u()});var q=r.findElement("[name='top-color-choice'][value='DEFAULT']");var v=r.findElement("[name='top-color-choice'][value='COLORED']");var m=[q,v];var w=function(){q.checked=d.getTopPaint()==WallController.WallPaint.DEFAULT;v.checked=d.getTopPaint()==WallController.WallPaint.COLORED};r.registerEventListener(m,"click",function(x){d.setTopPaint(WallController.WallPaint[this.value])});w();r.registerPropertyChangeListener(d,"TOP_PAINT",function(x){w()});r.topColorButton=new ColorButton(c,{colorChanged:function(x){v.checked=true;d.setTopPaint(WallController.WallPaint.COLORED);d.setTopColor(x)}});r.attachChildComponent("top-color-button",r.topColorButton);r.topColorButton.setColor(d.getTopColor());r.topColorButton.setColorDialogTitle(c.getLocalizedString("WallPanel","topColorDialog.title"));r.registerPropertyChangeListener(d,"TOP_COLOR",function(){r.topColorButton.setColor(d.getTopColor())})};var a=function(u){var m=c.getLengthUnit().getName();u.getElement("rectangular-wall-height-label").textContent=u.getLocalizedLabelText("WallPanel","rectangularWallHeightLabel.text",m);var v=u.findElement("[name='wall-shape-choice'][value='RECTANGULAR_WALL']");var z=u.findElement("[name='wall-shape-choice'][value='SLOPING_WALL']");u.registerEventListener([v,z],"change",function(A){d.setShape(WallController.WallShape[this.value])});var s=function(){v.checked=d.getShape()==WallController.WallShape.RECTANGULAR_WALL;z.checked=d.getShape()==WallController.WallShape.SLOPING_WALL};s();u.registerPropertyChangeListener(d,"SHAPE",function(A){s()});var p=c.getLengthUnit().getMinimumLength();var t=c.getLengthUnit().getMaximumLength();var o=new JSSpinner(c,u.getElement("rectangular-wall-height-input"),{nullable:d.getRectangularWallHeight()==null,format:c.getLengthUnit().getFormat(),value:d.getRectangularWallHeight(),minimum:p,maximum:t,stepSize:c.getLengthUnit().getStepSize()});u.registerPropertyChangeListener(d,"RECTANGULAR_WALL_HEIGHT",function(A){o.setValue(A.getNewValue())});u.registerEventListener(o,"input",function(A){d.setRectangularWallHeight(o.getValue())});var y=d.getSlopingWallHeightAtStart()!=null&&d.getSlopingWallHeightAtEnd()!=null?0:p;var x=new JSSpinner(c,u.getElement("sloping-wall-height-at-start-input"),{nullable:d.getSlopingWallHeightAtStart()==null,format:c.getLengthUnit().getFormat(),value:d.getSlopingWallHeightAtStart(),minimum:y,maximum:t,stepSize:c.getLengthUnit().getStepSize()});u.registerPropertyChangeListener(d,"SLOPING_WALL_HEIGHT_AT_START",function(A){x.setValue(A.getNewValue())});u.registerEventListener(x,"input",function(A){d.setSlopingWallHeightAtStart(x.getValue());if(y==0&&d.getSlopingWallHeightAtStart()==0&&d.getSlopingWallHeightAtEnd()==0){d.setSlopingWallHeightAtEnd(p)}});var w=new JSSpinner(c,u.getElement("sloping-wall-height-at-end-input"),{nullable:d.getSlopingWallHeightAtEnd()==null,format:c.getLengthUnit().getFormat(),value:d.getSlopingWallHeightAtEnd(),minimum:y,maximum:t,stepSize:c.getLengthUnit().getStepSize()});u.registerPropertyChangeListener(d,"SLOPING_WALL_HEIGHT_AT_END",function(A){w.setValue(A.getNewValue())});u.registerEventListener(w,"input",function(A){d.setSlopingWallHeightAtEnd(w.getValue());if(y==0&&d.getSlopingWallHeightAtStart()==0&&d.getSlopingWallHeightAtEnd()==0){d.setSlopingWallHeightAtStart(p)}});u.getElement("thickness-label").textContent=u.getLocalizedLabelText("WallPanel","thicknessLabel.text",m);var r=new JSSpinner(c,u.getElement("thickness-input"),{nullable:d.getThickness()==null,format:c.getLengthUnit().getFormat(),value:d.getThickness(),minimum:p,maximum:t/10,stepSize:c.getLengthUnit().getStepSize()});u.registerPropertyChangeListener(d,"THICKNESS",function(A){r.setValue(A.getNewValue())});u.registerEventListener(r,"input",function(A){d.setThickness(r.getValue())});u.getElement("arc-extent-label").textContent=u.getLocalizedLabelText("WallPanel","arcExtentLabel.text",m);var q=new DecimalFormat("0.#");var n=new JSSpinner(this.preferences,u.getElement("arc-extent-input"),{nullable:d.getArcExtentInDegrees()==null,format:q,value:0,minimum:-270,maximum:270,stepSize:5});var l=function(){n.setValue(d.getArcExtentInDegrees())};l();u.registerPropertyChangeListener(d,"ARC_EXTENT_IN_DEGREES",function(A){l()});u.registerEventListener(n,"input",function(A){d.setArcExtentInDegrees(n.getValue())})};var f=new JSDialog(c,"@{WallPanel.wall.title}",document.getElementById("wall-dialog-template"),{applier:function(l){d.modifyWalls()},disposer:function(l){l.leftSideColorButton.dispose();l.rightSideColorButton.dispose();l.leftSideTextureComponent.dispose();l.rightSideTextureComponent.dispose();l.topColorButton.dispose()},size:"medium"});k(f);e(f);g(f);a(f);f.getElement("wall-orientation-label").innerHTML=f.getLocalizedLabelText("WallPanel","wallOrientationLabel.text",ZIPTools.getScriptFolder()+"/resources/wallOrientation.png");var j=function(l,n,m){if(l!=null){if(m){l=l.parentElement}l.style.display=n?"":"none";l.previousElementSibling.style.display=n?"":"none";if(m){l.nextElementSibling.style.display=n?"":"none"}}};var h=function(){j(f.getElement("x-start-input"),d.isEditablePoints(),true);j(f.getElement("x-end-input"),d.isEditablePoints(),true);j(f.getElement("distance-to-end-point-input"),d.isEditablePoints());j(f.getElement("arc-extent-input"),d.isEditablePoints())};f.registerPropertyChangeListener(d,"EDITABLE_POINTS",h);h(d.isEditablePoints());return f};JSViewFactory.prototype.createRoomView=function(f,g){var h=function(q){var m=g.isPropertyEditable("FLOOR_VISIBLE")?"initial":"none";q.floorVisibleCheckBox=q.getElement("floor-visible-checkbox");q.floorVisibleCheckBox.checked=g.getFloorVisible();q.floorVisibleCheckBox.parentElement.style.display=m;q.registerEventListener(q.floorVisibleCheckBox,"change",function(u){g.setFloorVisible(q.floorVisibleCheckBox.checked)});q.registerPropertyChangeListener(g,"FLOOR_VISIBLE",function(u){q.floorVisibleCheckBox.checked=g.getFloorVisible(u)});var s=q.findElement("[name='floor-color-and-texture-choice'][value='COLORED']");q.floorColorButton=new ColorButton(f,{colorChanged:function(u){s.checked=true;g.setFloorPaint(RoomController.RoomPaint.COLORED);g.setFloorColor(u)}});q.attachChildComponent("floor-color-button",q.floorColorButton);q.floorColorButton.setColor(g.getFloorColor());q.floorColorButton.setColorDialogTitle(f.getLocalizedString("RoomPanel","floorColorDialog.title"));var r=q.findElement("[name='floor-color-and-texture-choice'][value='TEXTURED']");q.floorTextureComponent=g.getFloorTextureController().getView();q.attachChildComponent("floor-texture-component",q.floorTextureComponent);q.registerEventListener([s,r],"change",function(u){g.setFloorPaint(RoomController.RoomPaint[this.value])});var n=function(){s.checked=g.getFloorPaint()==RoomController.RoomPaint.COLORED;r.checked=g.getFloorPaint()==RoomController.RoomPaint.TEXTURED};n();q.registerPropertyChangeListener(g,"FLOOR_PAINT",n);var p=g.isPropertyEditable("FLOOR_PAINT")?"initial":"none";s.parentElement.parentElement.style.display=p;r.parentElement.parentElement.style.display=p;q.getElement("floor-color-button").style.display=p;q.getElement("floor-texture-component").style.display=p;var l=q.findElements("[name='floor-shininess-choice']");q.registerEventListener(l,"change",function(){g.setFloorShininess(parseFloat(this.value))});var t=function(){for(var u=0;u<l.length;u++){l[u].checked=g.getFloorShininess()==parseFloat(l[u].value)}};t();q.registerPropertyChangeListener(g,"FLOOR_SHININESS",t);var o=g.isPropertyEditable("FLOOR_SHININESS")?"initial":"none";l[0].parentElement.parentElement=o};var d=function(p){var n=g.isPropertyEditable("CEILING_VISIBLE")?"initial":"none";p.ceilingVisibleCheckBox=p.getElement("ceiling-visible-checkbox");p.ceilingVisibleCheckBox.checked=g.getCeilingVisible();p.ceilingVisibleCheckBox.parentElement.style.display=n;p.registerEventListener(p.ceilingVisibleCheckBox,"change",function(u){g.setCeilingVisible(p.ceilingVisibleCheckBox.checked)});p.registerPropertyChangeListener(g,"CEILING_VISIBLE",function(u){p.ceilingVisibleCheckBox.checked=g.getCeilingVisible()});var o=p.findElement("[name='ceiling-color-and-texture-choice'][value='COLORED']");p.ceilingColorButton=new ColorButton(f,{colorChanged:function(u){o.checked=true;g.setCeilingPaint(RoomController.RoomPaint.COLORED);g.setCeilingColor(u)}});p.attachChildComponent("ceiling-color-button",p.ceilingColorButton);p.ceilingColorButton.setColor(g.getCeilingColor());p.ceilingColorButton.setColorDialogTitle(f.getLocalizedString("RoomPanel","ceilingColorDialog.title"));var q=p.findElement("[name='ceiling-color-and-texture-choice'][value='TEXTURED']");p.ceilingTextureComponent=g.getCeilingTextureController().getView();p.attachChildComponent("ceiling-texture-component",p.ceilingTextureComponent);p.registerEventListener([o,q],"change",function(u){g.setCeilingPaint(RoomController.RoomPaint[this.value])});var m=function(){o.checked=g.getCeilingPaint()==RoomController.RoomPaint.COLORED;q.checked=g.getCeilingPaint()==RoomController.RoomPaint.TEXTURED};m();p.registerPropertyChangeListener(g,"CEILING_PAINT",m);var r=g.isPropertyEditable("CEILING_PAINT")?"initial":"none";o.parentElement.parentElement.style.display=r;q.parentElement.parentElement.style.display=r;p.getElement("ceiling-color-button").style.display=r;p.getElement("ceiling-texture-component").style.display=r;var l=p.findElements("[name='ceiling-shininess-choice']");p.registerEventListener(l,"change",function(){g.setCeilingShininess(parseFloat(this.value))});var s=function(){for(var u=0;u<l.length;u++){l[u].checked=g.getCeilingShininess()==parseFloat(l[u].value)}};s();p.registerPropertyChangeListener(g,"CEILING_SHININESS",s);var t=g.isPropertyEditable("CEILING_SHININESS")?"initial":"none";l[0].parentElement.parentElement=t};var b=function(l){if(l.firstWallChange&&l.splitSurroundingWallsCheckBox!=null&&!l.splitSurroundingWallsCheckBox.disabled){l.splitSurroundingWallsCheckBox.checked=true;var m=document.createEvent("Event");m.initEvent("change",true,true);l.splitSurroundingWallsCheckBox.dispatchEvent(m);l.firstWallChange=false}};var k=function(p){var r=function(){p.splitSurroundingWallsCheckBox.disabled=!g.isSplitSurroundingWallsNeeded();p.splitSurroundingWallsCheckBox.checked=g.isSplitSurroundingWalls()};var q=g.isPropertyEditable("SPLIT_SURROUNDING_WALLS")?"initial":"none";p.splitSurroundingWallsCheckBox=p.getElement("split-surrounding-walls-checkbox");p.splitSurroundingWallsCheckBox.parentElement.style.display=q;p.registerEventListener(p.splitSurroundingWallsCheckBox,"change",function(v){g.setSplitSurroundingWalls(p.splitSurroundingWallsCheckBox.checked);p.firstWallChange=false});r();p.registerPropertyChangeListener(g,"SPLIT_SURROUNDING_WALLS",function(v){r()});var o=p.findElement("[name='wall-sides-color-and-texture-choice'][value='COLORED']");p.wallSidesColorButton=new ColorButton(f,{colorChanged:function(v){o.checked=true;g.setWallSidesPaint(RoomController.RoomPaint.COLORED);g.setWallSidesColor(v);b(p)}});p.attachChildComponent("wall-sides-color-button",p.wallSidesColorButton);p.wallSidesColorButton.setColor(g.getWallSidesColor());p.wallSidesColorButton.setColorDialogTitle(f.getLocalizedString("RoomPanel","wallSidesColorDialog.title"));var u=p.findElement("[name='wall-sides-color-and-texture-choice'][value='TEXTURED']");p.wallSidesTextureComponent=g.getWallSidesTextureController().getView();p.registerPropertyChangeListener(g.getWallSidesTextureController(),"TEXTURE",function(v){b(p)});p.attachChildComponent("wall-sides-texture-component",p.wallSidesTextureComponent);p.registerEventListener([o,u],"change",function(v){g.setWallSidesPaint(RoomController.RoomPaint[this.value])});var n=function(){o.checked=g.getWallSidesPaint()==RoomController.RoomPaint.COLORED;u.checked=g.getWallSidesPaint()==RoomController.RoomPaint.TEXTURED};n();p.registerPropertyChangeListener(g,"WALL_SIDES_PAINT",n);var m=g.isPropertyEditable("WALL_SIDES_PAINT")?"initial":"none";o.parentElement.parentElement.style.display=m;u.parentElement.parentElement.style.display=m;p.getElement("wall-sides-color-button").style.display=m;p.getElement("wall-sides-texture-component").style.display=m;var l=p.findElements("[name='wall-sides-shininess-choice']");p.registerEventListener(l,"change",function(v){g.setWallSidesShininess(parseFloat(this.value))});var s=function(){for(var v=0;v<l.length;v++){l[v].checked=g.getWallSidesShininess()==parseFloat(l[v].value)}};s();p.registerPropertyChangeListener(g,"WALL_SIDES_SHININESS",s);var t=g.isPropertyEditable("WALL_SIDES_SHININESS")?"initial":"none";l[0].parentElement.parentElement.style.display=t;if(m=="none"&&t=="none"){p.getElement("wall-sides-panel").parentElement.style.display="none"}};var e=function(m){if(!g.isPropertyEditable("WALL_SIDES_BASEBOARD")){m.getElement("wall-sides-baseboard-panel").parentElement.style.display="none";return}var l=g.getWallSidesBaseboardController().getView();m.attachChildComponent("wall-sides-baseboard-panel",l);m.registerPropertyChangeListener(g.getWallSidesBaseboardController(),"VISIBLE",function(){b(m)})};var j=new JSDialog(f,"@{RoomPanel.room.title}",document.getElementById("room-dialog-template"),{applier:function(l){g.modifyRooms()},disposer:function(l){l.floorColorButton.dispose();l.floorTextureComponent.dispose();l.ceilingColorButton.dispose();l.ceilingTextureComponent.dispose();g.getWallSidesBaseboardController().getView().dispose()}});var c=g.isPropertyEditable("NAME")?"initial":"none";j.nameInput=j.getElement("name-input");j.nameInput.value=g.getName()!=null?g.getName():"";j.nameInput.parentElement.style.display=c;j.registerEventListener(j.nameInput,"input",function(l){g.setName(j.nameInput.value.trim())});j.registerPropertyChangeListener(g,"NAME",function(l){j.nameInput.value=g.getName()!=null?g.getName():""});var a=g.isPropertyEditable("AREA_VISIBLE")?"initial":"none";j.areaVisibleCheckBox=j.getElement("area-visible-checkbox");j.areaVisibleCheckBox.checked=g.getAreaVisible();j.areaVisibleCheckBox.parentElement.style.display=a;j.registerEventListener(j.areaVisibleCheckBox,"change",function(l){g.setAreaVisible(j.areaVisibleCheckBox.checked)});j.registerPropertyChangeListener(g,"AREA_VISIBLE",function(l){j.areaVisibleCheckBox.checked=g.getAreaVisible()});h(j);d(j);k(j);e(j);j.firstWallChange=true;return j};JSViewFactory.prototype.createPolylineView=function(c,b){var e=function(s){var v=[];var k=Object.keys(Polyline.ArrowStyle);for(var p=0;p<k.length;p++){var o=parseInt(k[p]);if(!isNaN(o)){v.push(o)}}var q=[];for(var p=0;p<v.length;p++){for(var n=0;n<v.length;n++){q.push({startStyle:v[p],endStyle:v[n]})}}var g=new java.awt.geom.GeneralPath();g.moveTo(15,4);g.lineTo(5,8);g.lineTo(15,12);var l=new java.awt.geom.GeneralPath();l.moveTo(3,8);l.lineTo(15,3);l.lineTo(15,13);l.closePath();var r=64;var t=new java.awt.geom.GeneralPath();t.moveTo(r-14,4);t.lineTo(r-4,8);t.lineTo(r-14,12);var h=new java.awt.geom.GeneralPath();h.moveTo(r-2,8);h.lineTo(r-14,3);h.lineTo(r-14,13);h.closePath();var u=new JSComboBox(this.preferences,s.getElement("arrows-style-select"),{nullable:b.getCapStyle()==null,availableValues:q,renderCell:function(j,y){y.style.border="none";y.style.maxWidth="6em";y.style.margin="auto";y.style.textAlign="center";var w=document.createElement("canvas");w.width=200;w.height=50;w.style.maxWidth="100%";w.style.height="1em";if(j!=null){var x=new Graphics2D(w);x.scale(w.width/r,w.width/r);x.setStroke(new java.awt.BasicStroke(2));x.draw(new java.awt.geom.Line2D.Float(6,8,r-6,8));switch(j.startStyle){case Polyline.ArrowStyle.DISC:x.fill(new java.awt.geom.Ellipse2D.Float(4,4,9,9));break;case Polyline.ArrowStyle.OPEN:x.draw(g);break;case Polyline.ArrowStyle.DELTA:x.fill(l);break}switch(j.endStyle){case Polyline.ArrowStyle.DISC:x.fill(new java.awt.geom.Ellipse2D.Float(r-12,4,9,9));break;case Polyline.ArrowStyle.OPEN:x.draw(t);break;case Polyline.ArrowStyle.DELTA:x.fill(h);break}y.appendChild(w)}},selectionChanged:function(j){b.setStartArrowStyle(j.startStyle);b.setEndArrowStyle(j.endStyle)}});var m=function(){var w=b.getStartArrowStyle();var j=b.getEndArrowStyle();u.setEnabled(b.isArrowsStyleEditable());u.setSelectedItem({startStyle:w,endStyle:j})};m();s.registerPropertyChangeListener(b,"START_ARROW_STYLE",m);s.registerPropertyChangeListener(b,"END_ARROW_STYLE",m)};var a=function(n){var l=[];var o=Object.keys(Polyline.JoinStyle);for(var k=0;k<o.length;k++){var j=parseInt(o[k]);if(!isNaN(j)){l.push(j)}}var h=new java.awt.geom.GeneralPath();h.moveTo(10,10);h.lineTo(80,10);h.lineTo(50,35);var m=new java.awt.geom.Arc2D.Float(10,20,80,20,0,180,java.awt.geom.Arc2D.OPEN);var p=new JSComboBox(this.preferences,n.getElement("join-style-select"),{nullable:b.getJoinStyle()==null,availableValues:l,renderCell:function(t,s){s.style.border="none";s.style.textAlign="center";var q=document.createElement("canvas");q.width=100;q.height=40;q.style.maxWidth="100%";q.style.height="1em";if(t!=null){var r=new Graphics2D(q);r.setStroke(ShapeTools.getStroke(8,Polyline.CapStyle.BUTT,t,null,0));if(t==Polyline.JoinStyle.CURVED){r.draw(m)}else{r.draw(h)}}s.appendChild(q)},selectionChanged:function(q){b.setJoinStyle(q)}});var g=function(){p.setEnabled(b.isJoinStyleEditable());p.setSelectedItem(b.getJoinStyle())};g();n.registerPropertyChangeListener(b,"JOIN_STYLE",g)};var f=function(k){var m=[];var l=Object.keys(Polyline.DashStyle);for(var j=0;j<l.length;j++){var o=parseInt(l[j]);if(!isNaN(o)&&(o!=Polyline.DashStyle.CUSTOMIZED||b.getDashStyle()==Polyline.DashStyle.CUSTOMIZED)){m.push(o)}}var n=new JSComboBox(this.preferences,k.getElement("dash-style-select"),{nullable:b.getDashStyle()==null,availableValues:m,renderCell:function(t,s){s.style.border="none";s.style.textAlign="center";s.style.maxHeight="2em";s.style.minWidth="4em";var q=document.createElement("canvas");q.width=500;q.height=100;q.style.maxWidth="100%";q.style.height="1em";var p=t!=null&&t!=Polyline.DashStyle.CUSTOMIZED?Polyline.DashStyle._$wrappers[t].getDashPattern():b.getDashPattern();if(p!=null){var r=new Graphics2D(q);var u=b.getDashOffset()!=null?b.getDashOffset():0;r.setStroke(ShapeTools.getStroke(12,Polyline.CapStyle.BUTT,Polyline.JoinStyle.MITER,p,u));r.draw(new java.awt.geom.Line2D.Float(20,q.height/2,q.width-60,q.height/2))}s.appendChild(q)},selectionChanged:function(p){b.setDashStyle(p)}});var g=new JSSpinner(c,k.getElement("dash-offset-input"),{nullable:b.getDashOffset()==null,value:b.getDashOffset()==null?null:b.getDashOffset()*100,minimum:0,maximum:100,stepSize:5});k.registerEventListener(g,"input",function(p){b.setDashOffset(g.getValue()!=null?g.getValue()/100:null)});k.registerPropertyChangeListener(b,"DASH_OFFSET",function(){g.setValue(b.getDashOffset()==null?null:b.getDashOffset()*100);n.updateUI()});var h=function(){g.setEnabled(b.getDashStyle()!=Polyline.DashStyle.SOLID);n.setSelectedItem(b.getDashStyle())};h();k.registerPropertyChangeListener(b,"DASH_STYLE",h)};var d=new JSDialog(c,"@{PolylinePanel.polyline.title}",document.getElementById("polyline-dialog-template"),{size:"small",applier:function(g){b.modifyPolylines()},disposer:function(g){g.colorButton.dispose()}});d.colorButton=new ColorButton(c,{colorChanged:function(g){b.setColor(g)}});d.attachChildComponent("color-button",d.colorButton);d.colorButton.setColor(b.getColor());d.colorButton.setColorDialogTitle(c.getLocalizedString("PolylinePanel","colorDialog.title"));d.thicknessLabelElement=d.getElement("thickness-label");d.thicknessLabelElement.textContent=d.getLocalizedLabelText("PolylinePanel","thicknessLabel.text",d.preferences.getLengthUnit().getName());d.thicknessInput=new JSSpinner(c,d.getElement("thickness-input"),{nullable:b.getThickness()==null,format:c.getLengthUnit().getFormat(),value:b.getThickness(),minimum:c.getLengthUnit().getMinimumLength(),maximum:50,stepSize:c.getLengthUnit().getStepSize()});d.registerPropertyChangeListener(b,"THICKNESS",function(g){d.thicknessInput.setValue(b.getThickness())});d.registerEventListener(d.thicknessInput,"input",function(g){b.setThickness(d.thicknessInput.getValue())});e(d);a(d);f(d);d.visibleIn3DCheckBox=d.getElement("visible-in-3D-checkbox");d.visibleIn3DCheckBox.checked=b.isElevationEnabled()&&b.getElevation()!=null;d.registerEventListener(d.visibleIn3DCheckBox,"change",function(g){if(d.visibleIn3DCheckBox.checked){b.setElevation(0)}else{b.setElevation(null)}});return d};JSViewFactory.prototype.createLabelView=function(j,e,f){var h=new JSDialog(e,"@{LabelPanel.labelModification.title}",document.getElementById("label-dialog-template"),{applier:function(m){if(j){f.modifyLabels()}else{f.createLabel()}},disposer:function(m){m.colorButton.dispose()},size:"small"});h.textInput=h.getElement("text");h.textInput.value=f.getText()!=null?f.getText():"";h.registerEventListener(h.textInput,"input",function(m){f.setText(h.textInput.value)});h.registerPropertyChangeListener(f,"TEXT",function(m){h.textInput.value=f.getText()!=null?f.getText():""});h.alignmentRadioButtons=h.getHTMLElement().querySelectorAll("[name='label-alignment-radio']");h.registerEventListener(h.alignmentRadioButtons,"change",function(n){for(var m=0;m<h.alignmentRadioButtons.length;m++){if(h.alignmentRadioButtons[m].checked){f.setAlignment(TextStyle.Alignment[h.alignmentRadioButtons[m].value])}}});var d=function(){var m=h.findElement("[name='label-alignment-radio'][value='"+TextStyle.Alignment[f.getAlignment()]+"']");if(m!=null){m.checked=true}};h.registerPropertyChangeListener(f,"ALIGNMENT",d);d();h.fontSelect=h.getElement("font-select");var a="DEFAULT_SYSTEM_FONT_NAME";h.registerEventListener(h.fontSelect,"change",function(n){var m=h.fontSelect.querySelector("option:checked").value;f.setFontName(m==a?null:m)});var g=function(){if(f.isFontNameSet()){var m=f.getFontName()==null?a:f.getFontName();var n=h.fontSelect.querySelector("[value='"+m+"']");if(n){n.selected=true}}else{h.fontSelect.selectedIndex=undefined}};h.registerPropertyChangeListener(f,"FONT_NAME",g);CoreTools.loadAvailableFontNames(function(p){p=[a].concat(p);for(var o=0;o<p.length;o++){var m=p[o];var n=o==0?h.getLocalizedLabelText("FontNameComboBox","systemFontName"):m;h.fontSelect.appendChild(JSComponent.createOptionElement(m,n))}g()});h.fontSizeLabel=h.getElement("font-size-label");h.fontSizeLabel.textContent=h.getLocalizedLabelText("LabelPanel","fontSizeLabel.text",h.preferences.getLengthUnit().getName());h.fontSizeInput=new JSSpinner(e,h.getElement("font-size-input"),{format:e.getLengthUnit().getFormat(),value:f.getFontSize(),minimum:5,maximum:999,stepSize:e.getLengthUnit().getStepSize()});var c=function(){var m=f.getFontSize();h.fontSizeInput.setNullable(m==null);h.fontSizeInput.setValue(m)};c();h.registerPropertyChangeListener(f,"FONT_SIZE",c);h.registerEventListener(h.fontSizeInput,"input",function(m){f.setFontSize(h.fontSizeInput.getValue())});h.colorButton=new ColorButton(e,{colorChanged:function(m){f.setColor(h.colorButton.getColor())}});h.attachChildComponent("color-button",h.colorButton);h.colorButton.setColor(f.getColor());h.colorButton.setColorDialogTitle(e.getLocalizedString("LabelPanel","colorDialog.title"));h.registerPropertyChangeListener(f,"COLOR",function(){h.colorButton.setColor(f.getColor())});var b=function(){var m=f.isPitchEnabled()===true;h.pitch0DegreeRadioButton.disabled=!m;h.pitch90DegreeRadioButton.disabled=!m;h.elevationInput.setEnabled(m);if(f.getPitch()!==null){if(f.getPitch()===0){h.pitch0DegreeRadioButton.checked=true}else{if(f.getPitch()===Math.PI/2){h.pitch90DegreeRadioButton.checked=true}}}};h.registerPropertyChangeListener(f,"PITCH",b);h.visibleIn3DCheckBox=h.getElement("visible-in-3D-checkbox");h.visibleIn3DCheckBox.checked=f.isPitchEnabled()!==null&&f.getPitch()!==null;h.registerEventListener(h.visibleIn3DCheckBox,"change",function(m){if(!h.visibleIn3DCheckBox.checked){f.setPitch(null)}else{if(h.pitch90DegreeRadioButton.checked){f.setPitch(Math.PI/2)}else{f.setPitch(0)}}b()});h.pitch0DegreeRadioButton=h.findElement("[name='label-pitch-radio'][value='0']");h.pitch90DegreeRadioButton=h.findElement("[name='label-pitch-radio'][value='90']");var k=function(){if(h.pitch0DegreeRadioButton.checked){f.setPitch(0)}else{if(h.pitch90DegreeRadioButton.checked){f.setPitch(Math.PI/2)}}};h.registerEventListener([h.pitch0DegreeRadioButton,h.pitch90DegreeRadioButton],"change",k);h.elevationLabel=h.getElement("elevation-label");h.elevationLabel.textContent=h.getLocalizedLabelText("LabelPanel","elevationLabel.text",h.preferences.getLengthUnit().getName());h.elevationInput=new JSSpinner(e,h.getElement("elevation-input"),{nullable:f.getElevation()==null,format:e.getLengthUnit().getFormat(),value:f.getElevation(),minimum:0,maximum:e.getLengthUnit().getMaximumElevation(),stepSize:e.getLengthUnit().getStepSize()});var l=function(m){h.elevationInput.setNullable(m.getNewValue()===null);h.elevationInput.setValue(m.getNewValue())};h.registerPropertyChangeListener(f,"ELEVATION",l);h.registerEventListener(h.elevationInput,"input",function(m){f.setElevation(h.elevationInput.getValue())});b();return h};JSViewFactory.prototype.createCompassView=function(b,a){function c(){this.controller=a;JSDialog.call(this,b,"@{CompassPanel.compass.title}",document.getElementById("compass-dialog-template"),{size:"medium",applier:function(d){d.controller.modifyCompass()}});this.initRosePanel();this.initGeographicLocationPanel()}c.prototype=Object.create(JSDialog.prototype);c.prototype.constructor=c;c.prototype.initRosePanel=function(){var h=this.preferences;var j=this.controller;var k=h.getLengthUnit().getMaximumLength();var e=this.getElement("x-label");var f=new JSSpinner(this.preferences,this.getElement("x-input"),{format:h.getLengthUnit().getFormat(),minimum:-k,maximum:k,stepSize:h.getLengthUnit().getStepSize()});var m=this.getElement("y-label");var l=new JSSpinner(this.preferences,this.getElement("y-input"),{format:h.getLengthUnit().getFormat(),minimum:-k,maximum:k,stepSize:h.getLengthUnit().getStepSize()});var o=this.getElement("diameter-label");var n=new JSSpinner(this.preferences,this.getElement("diameter-input"),{format:h.getLengthUnit().getFormat(),minimum:h.getLengthUnit().getMinimumLength(),maximum:h.getLengthUnit().getMaximumLength()/10,stepSize:h.getLengthUnit().getStepSize()});f.setValue(j.getX());l.setValue(j.getY());n.setValue(j.getDiameter());var d=this.preferences.getLengthUnit().getName();e.textContent=this.getLocalizedLabelText("CompassPanel","xLabel.text",d);m.textContent=this.getLocalizedLabelText("CompassPanel","yLabel.text",d);o.textContent=this.getLocalizedLabelText("CompassPanel","diameterLabel.text",d);var j=this.controller;this.registerPropertyChangeListener(this.controller,"X",function(p){f.setValue(j.getX())});this.registerPropertyChangeListener(this.controller,"Y",function(p){l.setValue(j.getY())});this.registerPropertyChangeListener(this.controller,"DIAMETER",function(p){n.setValue(j.getDiameter())});this.registerEventListener(f,"input",function(p){j.setX(f.getValue())});this.registerEventListener(l,"input",function(p){j.setY(l.getValue())});this.registerEventListener(n,"input",function(p){j.setDiameter(n.getValue())});var g=this.getElement("visible-checkbox");g.checked=j.isVisible();this.registerEventListener(g,"change",function(p){j.setVisible(g.checked)});this.registerPropertyChangeListener(j,"VISIBLE",function(p){g.checked=j.isVisible()})};c.prototype.initGeographicLocationPanel=function(){var g=this.preferences;var h=this.controller;var f=new JSSpinner(this.preferences,this.getElement("latitude-input"),{format:new DecimalFormat("N ##0.000;S ##0.000"),minimum:-90,maximum:90,stepSize:5});var j=new JSSpinner(this.preferences,this.getElement("longitude-input"),{format:new DecimalFormat("E ##0.000;W ##0.000"),minimum:-180,maximum:180,stepSize:5});var k=new JSSpinner(this.preferences,this.getElement("north-direction-input"),{format:new IntegerFormat(),minimum:0,maximum:360,stepSize:5});k.getHTMLElement().style.width="3em";k.style.verticalAlign="super";f.setValue(h.getLatitudeInDegrees());j.setValue(h.getLongitudeInDegrees());k.setValue(h.getNorthDirectionInDegrees());this.registerPropertyChangeListener(h,"LATITUDE_IN_DEGREES",function(n){f.setValue(h.getLatitudeInDegrees())});this.registerPropertyChangeListener(h,"LONGITUDE_IN_DEGREES",function(n){j.setValue(h.getLongitudeInDegrees())});this.registerPropertyChangeListener(h,"NORTH_DIRECTION_IN_DEGREES",function(n){k.setValue(h.getNorthDirectionInDegrees())});this.registerEventListener(f,"input",function(n){h.setLatitudeInDegrees(f.getValue())});this.registerEventListener(j,"input",function(n){h.setLongitudeInDegrees(j.getValue())});this.registerEventListener(k,"input",function(n){h.setNorthDirectionInDegrees(k.getValue());d()});var m=this.getElement("compass-preview");m.width=140;m.height=140;m.style.verticalAlign="middle";m.style.width="35px";var e=m.getContext("2d");var l=new Graphics2D(m);var d=function(){l.clear();var n=l.getTransform();l.translate(70,70);l.scale(100,100);l.setColor("#000000");l.fill(PlanComponent.COMPASS);l.setTransform(n);if(h.getNorthDirectionInDegrees()==0||h.getNorthDirectionInDegrees()==null){m.style.transform=""}else{m.style.transform="rotate("+h.getNorthDirectionInDegrees()+"deg)"}};d()};return new c()};JSViewFactory.prototype.createObserverCameraView=function(b,a){function c(){this.controller=a;JSDialog.call(this,b,"@{ObserverCameraPanel.observerCamera.title}",document.getElementById("observer-camera-dialog-template"),{applier:function(f){f.controller.modifyObserverCamera()}});this.initLocationPanel();this.initAnglesPanel();var e=this.getElement("adjust-observer-camera-elevation-checkbox");e.checked=a.isElevationAdjusted();var d=a.isObserverCameraElevationAdjustedEditable()?"initial":"none";e.parentElement.style.display=d;this.registerEventListener(e,"change",function(f){a.setElevationAdjusted(e.checked)});this.registerPropertyChangeListener(a,"OBSERVER_CAMERA_ELEVATION_ADJUSTED",function(f){e.checked=a.isElevationAdjusted()})}c.prototype=Object.create(JSDialog.prototype);c.prototype.constructor=c;c.prototype.initLocationPanel=function(){var h=500000;var e=this.getElement("x-label");var f=new JSSpinner(this.preferences,this.getElement("x-input"),{nullable:this.controller.getX()==null,format:this.preferences.getLengthUnit().getFormat(),minimum:-h,maximum:h,stepSize:this.preferences.getLengthUnit().getStepSize()});var k=this.getElement("y-label");var j=new JSSpinner(this.preferences,this.getElement("y-input"),{nullable:this.controller.getY()==null,format:this.preferences.getLengthUnit().getFormat(),minimum:-h,maximum:h,stepSize:this.preferences.getLengthUnit().getStepSize()});var l=this.getElement("elevation-label");var m=new JSSpinner(this.preferences,this.getElement("elevation-input"),{nullable:this.controller.getElevation()==null,format:this.preferences.getLengthUnit().getFormat(),minimum:this.controller.getMinimumElevation(),maximum:this.preferences.getLengthUnit().getMaximumElevation(),stepSize:this.preferences.getLengthUnit().getStepSize()});f.setValue(this.controller.getX());j.setValue(this.controller.getY());m.setValue(this.controller.getElevation());var d=this.preferences.getLengthUnit().getName();e.textContent=this.getLocalizedLabelText("HomeFurniturePanel","xLabel.text",d);k.textContent=this.getLocalizedLabelText("HomeFurniturePanel","yLabel.text",d);l.textContent=this.getLocalizedLabelText("ObserverCameraPanel","elevationLabel.text",d);var g=this.controller;this.registerPropertyChangeListener(this.controller,"X",function(n){f.setValue(g.getX())});this.registerPropertyChangeListener(this.controller,"Y",function(n){j.setValue(g.getY())});this.registerPropertyChangeListener(this.controller,"ELEVATION",function(n){m.setValue(g.getElevation())});this.registerEventListener(f,"input",function(n){g.setX(f.getValue())});this.registerEventListener(j,"input",function(n){g.setY(j.getValue())});this.registerEventListener(m,"input",function(n){g.setElevation(m.getValue())})};c.prototype.initAnglesPanel=function(){var h=new DecimalFormat("0.#");var g=new JSSpinner(this.preferences,this.getElement("yaw-input"),{format:h,value:Math.toDegrees(this.controller.getYaw()),minimum:-10000,maximum:10000,stepSize:5});var e=new JSSpinner(this.preferences,this.getElement("pitch-input"),{format:h,value:Math.toDegrees(this.controller.getPitch()),minimum:-90,maximum:90,stepSize:5});var f=new JSSpinner(this.preferences,this.getElement("field-of-view-input"),{nullable:this.controller.getFieldOfView()==null,format:h,value:Math.toDegrees(this.controller.getFieldOfView()),minimum:2,maximum:120,stepSize:1});var d=this.controller;this.registerPropertyChangeListener(this.controller,"YAW",function(j){g.setValue(Math.toDegrees(this.controller.getYaw()))});this.registerPropertyChangeListener(this.controller,"PITCH",function(j){e.setValue(Math.toDegrees(this.controller.getPitch()))});this.registerPropertyChangeListener(this.controller,"FIELD_OF_VIEW",function(j){f.setValue(Math.toDegrees(this.controller.getFieldOfView()))});this.registerEventListener(g,"input",function(j){d.setYaw(g.getValue()!=null?Math.toRadians(g.getValue()):null)});this.registerEventListener(e,"input",function(j){d.setPitch(e.getValue()!=null?Math.toRadians(e.getValue()):null)});this.registerEventListener(f,"input",function(j){d.setFieldOfView(f.getValue()!=null?Math.toRadians(f.getValue()):null)})};return new c()};JSViewFactory.prototype.createHome3DAttributesView=function(b,a){function c(){this.controller=a;JSDialog.call(this,b,"@{Home3DAttributesPanel.home3DAttributes.title}",document.getElementById("home-3Dattributes-dialog-template"),{size:"small",applier:function(d){d.controller.modify3DAttributes()},disposer:function(d){d.groundPanel.colorButton.dispose();d.groundPanel.textureComponent.dispose();d.skyPanel.colorButton.dispose();d.skyPanel.textureComponent.dispose()}});this.initGroundPanel();this.initSkyPanel();this.initRenderingPanel()}c.prototype=Object.create(JSDialog.prototype);c.prototype.constructor=c;c.prototype.initGroundPanel=function(){var h=this.controller;var k=this;var j=k.findElement("[name='ground-color-and-texture-choice'][value='COLORED']");var l=new ColorButton(b,{colorChanged:function(n){j.checked=true;h.setGroundPaint(Home3DAttributesController.EnvironmentPaint.COLORED);h.setGroundColor(n)}});k.attachChildComponent("ground-color-button",l);l.setColor(h.getGroundColor());l.setColorDialogTitle(b.getLocalizedString("Home3DAttributesPanel","groundColorDialog.title"));var d=k.findElement("[name='ground-color-and-texture-choice'][value='TEXTURED']");var m=h.getGroundTextureController().getView();k.attachChildComponent("ground-texture-component",m);var g=[j,d];k.registerEventListener(g,"change",function(n){if(n.target.checked){h.setGroundPaint(Home3DAttributesController.EnvironmentPaint[n.target.value])}});var f=function(){j.checked=h.getGroundPaint()==Home3DAttributesController.EnvironmentPaint.COLORED;d.checked=h.getGroundPaint()==Home3DAttributesController.EnvironmentPaint.TEXTURED};f();this.registerPropertyChangeListener(h,"GROUND_PAINT",f);this.registerPropertyChangeListener(h,"GROUND_COLOR",function(n){l.setColor(h.getGroundColor())});var e=this.getElement("background-image-visible-on-ground-3D-checkbox");e.checked=h.isBackgroundImageVisibleOnGround3D();this.registerEventListener(e,"change",function(n){h.setBackgroundImageVisibleOnGround3D(e.checked)});this.registerPropertyChangeListener(h,"BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",function(n){e.checked=h.isBackgroundImageVisibleOnGround3D()});this.groundPanel={colorButton:l,textureComponent:m}};c.prototype.initSkyPanel=function(){var e=this.controller;var h=this;var d=h.findElement("[name='sky-color-and-texture-choice'][value='COLORED']");var g=new ColorButton(b,{colorChanged:function(m){d.checked=true;e.setSkyPaint(Home3DAttributesController.EnvironmentPaint.COLORED);e.setSkyColor(m)}});h.attachChildComponent("sky-color-button",g);g.setColor(e.getSkyColor());g.setColorDialogTitle(b.getLocalizedString("Home3DAttributesPanel","skyColorDialog.title"));var k=h.findElement("[name='sky-color-and-texture-choice'][value='TEXTURED']");var f=e.getSkyTextureController().getView();h.attachChildComponent("sky-texture-component",f);var j=[d,k];h.registerEventListener(j,"change",function(m){if(m.target.checked){e.setSkyPaint(Home3DAttributesController.EnvironmentPaint[m.target.value])}});var l=function(){d.checked=e.getSkyPaint()==Home3DAttributesController.EnvironmentPaint.COLORED;k.checked=e.getSkyPaint()==Home3DAttributesController.EnvironmentPaint.TEXTURED};l();this.registerPropertyChangeListener(e,"SKY_PAINT",l);this.registerPropertyChangeListener(e,"SKY_COLOR",function(){g.setColor(e.getSkyColor())});this.skyPanel={colorButton:g,textureComponent:f}};c.prototype.initRenderingPanel=function(){var e=this.controller;var d=this.getElement("brightness-slider");var h=this.findElement("#home-3Dattributes-brightness-list");var k=this.getElement("walls-transparency-slider");var j=this.findElement("#home-3Dattributes-walls-transparency-list");for(var f=0;f<=255;f+=17){var g=document.createElement("option");g.value=f;h.appendChild(g);j.appendChild(g.cloneNode())}d.value=e.getLightColor()&255;k.value=e.getWallsAlpha()*255;this.registerEventListener(d,"input",function(l){var m=l.target.value;e.setLightColor((m<<16)|(m<<8)|m)});this.registerEventListener(k,"input",function(l){e.setWallsAlpha(this.value/255)});this.registerPropertyChangeListener(e,"LIGHT_COLOR",function(l){d.value=e.getLightColor()&255});this.registerPropertyChangeListener(e,"WALLS_ALPHA",function(l){k.value=e.getWallsAlpha()*255})};return new c()};JSViewFactory.prototype.createTextureChoiceView=function(b,a){return new TextureChoiceComponent(b,a)};JSViewFactory.prototype.createBaseboardChoiceView=function(b,a){function c(){JSComponent.call(this,b,'  <div class="whole-line">    <label>      <input name="baseboard-visible-checkbox" type="checkbox"/>      @{BaseboardChoiceComponent.visibleCheckBox.text}    </label>  </div>  <div class="whole-line">    <label>      <input type="radio" name="baseboard-color-and-texture-choice" value="sameColorAsWall"/>      @{BaseboardChoiceComponent.sameColorAsWallRadioButton.text}    </label>  </div>  <div>    <label>      <input type="radio" name="baseboard-color-and-texture-choice" value="COLORED">        @{BaseboardChoiceComponent.colorRadioButton.text}    </label>  </div>  <div data-name="baseboard-color-button"></div>  <div>    <label>      <input type="radio" name="baseboard-color-and-texture-choice" value="TEXTURED">        @{BaseboardChoiceComponent.textureRadioButton.text}    </label>  </div>  <div data-name="baseboard-texture-component"></div>  <div class="whole-line">    <hr/>  </div>  <div data-name="height-label" class="label-cell"></div>  <div><span data-name="height-input"></span></div>  <div data-name="thickness-label" class="label-cell"></div>  <div><span data-name="thickness-input"></span></div>');this.initComponents(a)}c.prototype=Object.create(JSComponent.prototype);c.prototype.constructor=c;c.prototype.dispose=function(){this.colorButton.dispose();this.textureComponent.dispose();JSComponent.prototype.dispose.call(this)};c.prototype.initComponents=function(h){var k=this;this.getHTMLElement().dataset.name="baseboard-panel";this.getHTMLElement().classList.add("label-input-grid");this.visibleCheckBox=this.getElement("baseboard-visible-checkbox");this.visibleCheckBox.checked=h.getVisible();this.registerEventListener(this.visibleCheckBox,"change",function(n){h.setVisible(k.visibleCheckBox.checked)});var m=function(){var p=h.getVisible();k.visibleCheckBox.checked=p;var o=p!==false;for(var n=0;n<k.colorAndTextureRadioButtons.length;n++){k.colorAndTextureRadioButtons[n].disabled=!o}k.colorButton.setEnabled(o);k.textureComponent.setEnabled(o);k.heightInput.setEnabled(o);k.thicknessInput.setEnabled(o)};this.registerPropertyChangeListener(h,"VISIBLE",function(n){m()});var l=this.findElement("[name='baseboard-color-and-texture-choice'][value='sameColorAsWall']");var d=this.findElement("[name='baseboard-color-and-texture-choice'][value='COLORED']");this.colorButton=new ColorButton(b,{colorChanged:function(n){d.checked=true;h.setPaint(BaseboardChoiceController.BaseboardPaint.COLORED);h.setColor(n)}});this.attachChildComponent("baseboard-color-button",this.colorButton);this.colorButton.setColor(h.getColor());this.colorButton.setColorDialogTitle(b.getLocalizedString("BaseboardChoiceComponent","colorDialog.title"));var j=this.findElement("[name='baseboard-color-and-texture-choice'][value='TEXTURED']");this.textureComponent=h.getTextureController().getView();this.attachChildComponent("baseboard-texture-component",this.textureComponent);this.colorAndTextureRadioButtons=[l,d,j];this.registerEventListener(this.colorAndTextureRadioButtons,"change",function(o){if(o.target.checked){var n=o.target.value=="sameColorAsWall"?BaseboardChoiceController.BaseboardPaint.DEFAULT:BaseboardChoiceController.BaseboardPaint[o.target.value];h.setPaint(n)}});var g=function(){l.checked=h.getPaint()==BaseboardChoiceController.BaseboardPaint.DEFAULT;d.checked=h.getPaint()==BaseboardChoiceController.BaseboardPaint.COLORED;j.checked=h.getPaint()==BaseboardChoiceController.BaseboardPaint.TEXTURED};g();this.registerPropertyChangeListener(h,"PAINT",g);var e=b.getLengthUnit().getName();this.getElement("height-label").textContent=this.getLocalizedLabelText("BaseboardChoiceComponent","heightLabel.text",e);this.getElement("thickness-label").textContent=this.getLocalizedLabelText("BaseboardChoiceComponent","thicknessLabel.text",e);var f=b.getLengthUnit().getMinimumLength();this.heightInput=new JSSpinner(b,this.getElement("height-input"),{nullable:h.getHeight()==null,format:b.getLengthUnit().getFormat(),value:h.getHeight()!=null&&h.getMaxHeight()!=null?Math.min(h.getHeight(),h.getMaxHeight()):h.getHeight(),minimum:f,maximum:h.getMaxHeight()==null?b.getLengthUnit().getMaximumLength()/10:h.getMaxHeight(),stepSize:b.getLengthUnit().getStepSize()});this.thicknessInput=new JSSpinner(b,this.getElement("thickness-input"),{nullable:h.getThickness()==null,format:b.getLengthUnit().getFormat(),value:h.getThickness(),minimum:f,maximum:2,stepSize:b.getLengthUnit().getStepSize()});this.registerPropertyChangeListener(h,"HEIGHT",function(n){k.heightInput.setValue(n.getNewValue())});this.registerPropertyChangeListener(h,"MAX_HEIGHT",function(n){if(n.getOldValue()==null||h.getMaxHeight()!=null&&k.heightInput.max<h.getMaxHeight()){k.heightInput.max=h.getMaxHeight()}});this.registerPropertyChangeListener(h,"THICKNESS",function(n){k.thicknessInput.setValue(n.getNewValue())});this.registerEventListener(this.heightInput,"input",function(n){h.setHeight(k.heightInput.getValue())});this.registerEventListener(this.thicknessInput,"input",function(n){h.setThickness(k.thicknessInput.getValue())});m()};return new c()};JSViewFactory.prototype.createModelMaterialsView=function(b,a){return new ModelMaterialsComponent(b,a)};JSViewFactory.prototype.createPageSetupView=function(a,b){return this.dummyDialogView};JSViewFactory.prototype.createPrintPreviewView=function(d,a,c,b){return this.dummyDialogView};JSViewFactory.prototype.createPhotoView=function(c,a,b){return this.dummyDialogView};JSViewFactory.prototype.createPhotosView=function(c,a,b){return this.dummyDialogView};JSViewFactory.prototype.createVideoView=function(c,b,a){return this.dummyDialogView};function IncrementalHomeRecorder(c,d){HomeRecorder.call(this);this.application=c;this.homeData={};this.configuration=d;this.online=true;var b=10000;if(this.configuration!==undefined&&this.configuration.pingURL!==undefined){var a=this;setTimeout(function(){a.checkServer(b)},b)}}IncrementalHomeRecorder.prototype=Object.create(HomeRecorder.prototype);IncrementalHomeRecorder.prototype.constructor=IncrementalHomeRecorder;IncrementalHomeRecorder.DEFAULT_TRACKED_HOME_PROPERTIES=[FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY,HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY,HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY,HomePane.MAIN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,HomePane.PLAN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,HomePane.CATALOG_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,PlanController.SCALE_VISUAL_PROPERTY,"CAMERA","STORED_CAMERAS","SELECTED_LEVEL","FURNITURE_SORTED_PROPERTY","FURNITURE_DESCENDING_SORTED","FURNITURE_VISIBLE_PROPERTIES","OBSERVER_CAMERA_ELEVATION_ADJUSTED","ALL_LEVELS_VISIBLE"];IncrementalHomeRecorder.prototype.getTrackedHomeProperties=function(){if(this.configuration&&this.configuration.trackedHomeProperties){return this.configuration.trackedHomeProperties}else{return IncrementalHomeRecorder.DEFAULT_TRACKED_HOME_PROPERTIES}};IncrementalHomeRecorder.prototype.configure=function(a){this.configuration=a};IncrementalHomeRecorder.prototype.checkServer=function(b){var a=this;var c=new XMLHttpRequest();c.open("GET",this.configuration.pingURL,true);c.addEventListener("load",function(d){if(c.readyState===XMLHttpRequest.DONE&&c.status===200){if(!a.online){if(a.configuration&&a.configuration.writingObserver&&a.configuration.writingObserver.connectionFound){a.configuration.writingObserver.connectionFound(a)}}a.online=true;setTimeout(function(){a.checkServer(b)},b)}else{if(a.online){if(a.configuration&&a.configuration.writingObserver&&a.configuration.writingObserver.connectionLost){a.configuration.writingObserver.connectionLost(c.status,c.statusText)}}a.online=false;setTimeout(function(){a.checkServer(b)},b)}});c.addEventListener("error",function(d){if(a.online){if(a.configuration&&a.configuration.writingObserver&&a.configuration.writingObserver.connectionLost){a.configuration.writingObserver.connectionLost(0,d)}}a.online=false;setTimeout(function(){a.checkServer(b)},b)});c.send()};IncrementalHomeRecorder.prototype.readHome=function(d,c){if(this.configuration!==undefined&&this.configuration.readHomeURL!==undefined){var a=CoreTools.format(this.configuration.readHomeURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(d));if(a.indexOf("?")>0){var b=HomeObject.createId("home");a+="&editionId="+b;var e=c;var c={homeLoaded:function(f){f.editionId=b;e.homeLoaded(f)},homeError:function(f){e.homeError(f)},progression:function(g,h,f){e.progression(g,h,f)}}}d=a}HomeRecorder.prototype.readHome.call(this,d,c)};IncrementalHomeRecorder.prototype.checkPoint=function(b){var a=this;a.homeData[b.editionId].existingHomeObjects={};b.getHomeObjects().forEach(function(c){a.homeData[b.editionId].existingHomeObjects[c.id]=c.id})};IncrementalHomeRecorder.prototype.addHome=function(g){if(this.configuration!==undefined&&this.configuration.writeHomeEditsURL!==undefined){if(g.editionId===undefined){g.editionId=HomeObject.createId("home")}this.homeData[g.editionId]={};this.checkPoint(g);var d=this.application.getHomeController(g);this.homeData[g.editionId].undoableEditSupport=d.getUndoableEditSupport();var j=this;var a={undoableEditHappened:function(l){j.storeEdit(g,l.getEdit());j.scheduleWrite(g)},source:j};this.homeData[g.editionId].undoableEditSupport.addUndoableEditListener(a);var k=d.undoManager;var h=k.undo;var e=k.redo;k.undo=function(){var l=k.editToBeUndone();h.call(k);j.storeEdit(g,l,true);j.scheduleWrite(g)};k.redo=function(){var l=k.editToBeRedone();e.call(k);j.storeEdit(g,l);j.scheduleWrite(g)};var b=function(l){var m=undefined;if(l.source===g.getObserverCamera()){m="observerCamera"}if(l.source===g.getTopCamera()){m="topCamera"}if(l.source===g||l.source===g.getEnvironment()){if(j.getTrackedHomeProperties().indexOf(l.getPropertyName())!==-1){m=l.getPropertyName()}}if(m!==undefined){if(j.homeData[g.editionId].trackedStateChanges===undefined){j.homeData[g.editionId].trackedStateChanges={}}j.homeData[g.editionId].trackedStateChanges[m]=true}};g.getObserverCamera().addPropertyChangeListener(b);g.getTopCamera().addPropertyChangeListener(b);var f=this.getTrackedHomeProperties();for(var c=0;c<f.length;c++){if(f[c]=="OBSERVER_CAMERA_ELEVATION_ADJUSTED"||f[c]=="ALL_LEVELS_VISIBLE"){g.getEnvironment().addPropertyChangeListener(f[c],b)}else{g.addPropertyChangeListener(f[c],b)}}if(j.getAutoWriteDelay()>0){j.scheduleWrite(g)}}};IncrementalHomeRecorder.prototype.getAutoWriteDelay=function(){if(this.configuration===undefined||this.configuration.autoWriteDelay===undefined){return -1}else{return this.configuration.autoWriteDelay}};IncrementalHomeRecorder.prototype.removeHome=function(e){if(this.configuration!==undefined){if(this.configuration.closeHomeURL!==undefined){var d=CoreTools.format(this.configuration.closeHomeURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(e.name));if(navigator.sendBeacon){navigator.sendBeacon(d)}else{try{var c=new XMLHttpRequest();c.open("GET",d,true);c.send()}catch(b){console.error(b)}}}if(this.configuration.writeHomeEditsURL!==undefined){var f=this.homeData[e.editionId].undoableEditSupport.getUndoableEditListeners();for(var a=0;a<f.length;a++){if(f[a].source===this){this.homeData[e.editionId].undoableEditSupport.removeUndoableEditListener(f[a]);break}}delete this.homeData[e.editionId]}}};IncrementalHomeRecorder.prototype.saveBlobs=function(b,l){if(b){if(b.blob instanceof Blob&&b.resourceFileName){var c=this.application.params.writeResourceURL;var h=CoreTools.format(c.replace(/(%[^s])/g,"%$1"),encodeURIComponent(b.resourceFileName));var e=new XMLHttpRequest();e.open("POST",h,true);e.addEventListener("load",function(j){if(e.readyState===XMLHttpRequest.DONE){if(e.status===200){delete b.blob;delete b.resourceFileName}else{l(e.status,e.statusText)}}});var k=function(j){l(0,j)};e.addEventListener("error",k);e.addEventListener("timeout",k);e.send(b.blob)}else{var a=Object.getOwnPropertyNames(b);for(var f=0;f<a.length;f++){var g=a[f];if(g!="_type"){var d=b[g];if(typeof d=="object"){this.saveBlobs(d,l)}}}}}};IncrementalHomeRecorder.prototype.sendUndoableEdits=function(d){if(!this.hasEdits(d)){return}this.addTrackedStateChange(d);var b=this;var f=this.beginUpdate(d);if(f!==null){var a=function(g,h){b.rollbackUpdate(d,f,g,h);b.scheduleWrite(d,10000)};if(this.application.params.writeResourceURL&&this.application.params.readResourceURL){for(var c=0;c<f.edits.length;c++){this.saveBlobs(f.edits[c],a)}}request=new XMLHttpRequest();request.open("POST",this.configuration.writeHomeEditsURL,true);request.withCredentials=true;request.addEventListener("load",function(h){if(request.readyState===XMLHttpRequest.DONE){if(request.status===200){var g=JSON.parse(request.responseText);if(g&&g.result===f.edits.length){b.commitUpdate(d,f)}else{console.error(request.responseText);a(request.status,request.responseText)}}else{a(request.status,request.statusText)}}});var e=function(g){a(0,g)};request.addEventListener("error",e);request.addEventListener("timeout",e);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");request.send("home="+encodeURIComponent(d.name)+"&editionId="+d.editionId+"&version="+this.application.getVersion()+"&edits="+encodeURIComponent(JSON.stringify(f.edits)))}};IncrementalHomeRecorder.prototype.hasEdits=function(a){return(this.queue!==undefined&&this.queue.length>0)||(this.configuration&&this.configuration.autoWriteTrackedStateChange&&this.homeData[a.editionId].trackedStateChanges!==undefined)};IncrementalHomeRecorder.prototype.addTrackedStateChange=function(f,e){if(this.homeData[f.editionId].trackedStateChanges!==undefined&&(e||(this.configuration&&this.configuration.autoWriteTrackedStateChange))){var b={_type:"com.eteks.sweethome3d.io.TrackedStateChangeUndoableEdit"};var a=this.getTrackedHomeProperties();for(var c=0;c<a.length;c++){var d=a[c];if(this.homeData[f.editionId].trackedStateChanges[d]){switch(d){case"CAMERA":b.camera=f.getCamera();break;case"STORED_CAMERAS":b.storedCameras=f.getStoredCameras();break;case"SELECTED_LEVEL":b.selectedLevel=f.getSelectedLevel();break;case"FURNITURE_SORTED_PROPERTY":b.furnitureSortedProperty=f.getFurnitureSortedProperty();break;case"FURNITURE_DESCENDING_SORTED":b.furnitureDescendingSorted=f.isFurnitureDescendingSorted();break;case"FURNITURE_VISIBLE_PROPERTIES":b.furnitureVisibleProperties=f.getFurnitureVisibleProperties();break;case"OBSERVER_CAMERA_ELEVATION_ADJUSTED":b.observerCameraElevationAdjusted=f.getEnvironment().isObserverCameraElevationAdjusted();break;case"ALL_LEVELS_VISIBLE":b.allLevelsVisible=f.getEnvironment().isAllLevelsVisible();break;default:if(b.homeProperties===undefined){b.homeProperties={}}b.homeProperties[d]=f.getProperty(d)}}}if(this.homeData[f.editionId].trackedStateChanges.topCamera){b.topCamera=f.getTopCamera().duplicate()}if(this.homeData[f.editionId].trackedStateChanges.observerCamera){b.observerCamera=f.getObserverCamera().duplicate()}this.homeData[f.editionId].trackedStateChanges=undefined;this.storeEdit(f,b)}};IncrementalHomeRecorder.prototype.scheduleWrite=function(c,b){if(b===undefined){b=this.getAutoWriteDelay()}if(b>=0){if(this.homeData[c.editionId].scheduledWrite!==undefined){clearTimeout(this.homeData[c.editionId].scheduledWrite);this.homeData[c.editionId].scheduledWrite=undefined}var a=this;this.homeData[c.editionId].scheduledWrite=setTimeout(function(){a.homeData[c.editionId].scheduledWrite=undefined;if(a.online&&a.hasEdits(c)){a.sendUndoableEdits(c)}if(a.getAutoWriteDelay()>0){a.scheduleWrite(c)}},b)}};IncrementalHomeRecorder.prototype.storeEdit=function(e,d,c){var b={};var f=[];var a=this.substituteIdentifiableObjects(e,d,b,f,["object3D","hasBeenDone","alive","presentationNameKey","__parent"],[UserPreferences,PlanController,Home],[Boolean,String,Number]);if(f.length>0){a._newObjects=f}if(c){a._action="undo"}a._undoableEditId=UUID.randomUUID();if(!this.queue){this.queue=[]}this.queue.push(a);if(d._type!="com.eteks.sweethome3d.io.TrackedStateChangeUndoableEdit"){this.checkPoint(e)}};IncrementalHomeRecorder.prototype.beginUpdate=function(a){if(this.homeData[a.editionId].ongoingUpdate!==undefined){this.homeData[a.editionId].rejectedUpdate=true;return null}this.homeData[a.editionId].ongoingUpdate={home:a,edits:this.queue.slice(0)};if(this.configuration!==undefined&&this.configuration.writingObserver&&this.configuration.writingObserver.writeStarted){this.configuration.writingObserver.writeStarted(this.homeData[a.editionId].ongoingUpdate)}return this.homeData[a.editionId].ongoingUpdate};IncrementalHomeRecorder.prototype.commitUpdate=function(b,c){for(var a=0;a<c.edits.length;a++){if(this.queue[0]===c.edits[a]){this.queue.shift()}else{throw new Error("Unexpected error while saving")}}if(this.configuration!==undefined&&this.configuration.writingObserver&&this.configuration.writingObserver.writeSucceeded){this.configuration.writingObserver.writeSucceeded(c)}this.homeData[b.editionId].ongoingUpdate=undefined;if(this.homeData[b.editionId].rejectedUpdate){this.homeData[b.editionId].rejectedUpdate=undefined;this.scheduleWrite(b,0)}};IncrementalHomeRecorder.prototype.rollbackUpdate=function(c,d,a,b){if(this.configuration!==undefined&&this.configuration.writingObserver&&this.configuration.writingObserver.writeFailed){this.configuration.writingObserver.writeFailed(d,a,b)}this.homeData[c.editionId].ongoingUpdate=undefined;this.homeData[c.editionId].rejectedUpdate=undefined};IncrementalHomeRecorder.prototype.substituteIdentifiableObjects=function(n,p,b,m,r,c,s){if(Array.isArray(p)){var o=p.slice(0);for(var k=0;k<p.length;k++){o[k]=this.substituteIdentifiableObjects(n,p[k],b,m,r,c,s)}return o}else{if(p instanceof Big){return{value:p.toString(),_type:"java.math.BigDecimal"}}else{if(p instanceof BlobURLContent){if(p.getSavedContent()!=null){return this.substituteIdentifiableObjects(n,p.getSavedContent(),b,m,r,c,s)}else{var a=p.getBlob();var q="dat";if(a.type=="image/png"){q="png"}else{if(a.type=="image/jpeg"){q="jpg"}}var d=UUID.randomUUID()+"."+q;var f=new URLContent(CoreTools.format(this.application.params.readResourceURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(d)));p.setSavedContent(f);var o=this.substituteIdentifiableObjects(n,p.getSavedContent(),b,m,r,c,s);o.resourceFileName=d;o.blob=a;return o}}else{if(p==null||p!==Object(p)||s.some(function(j){return p instanceof j})){return p}else{if(p.id!==undefined&&(this.homeData[n.editionId].existingHomeObjects[p.id]!==undefined||b[p.id]!==undefined||p instanceof Home)){return p.id}else{var o={};if(p.id!==undefined){b[p.id]=o;m.push(o)}if(p.constructor&&p.constructor.__class&&p.constructor.__class!="com.eteks.sweethome3d.tools.URLContent"){o._type=p.constructor.__class}var e=Object.getOwnPropertyNames(p);for(var h=0;h<e.length;h++){var l=e[h];if(p.constructor&&p.constructor.__transients&&p.constructor.__transients.indexOf(l)!=-1){continue}if(r.indexOf(l)===-1){var g=p[l];if(typeof g!=="function"&&!c.some(function(j){return g instanceof j})){o[l]=this.substituteIdentifiableObjects(n,g,b,m,r,c,s)}}}if(p.id!==undefined){return p.id}else{return o}}}}}}};function SweetHome3DJSApplication(b){HomeApplication.call(this);this.homeControllers=[];this.params=b;var a=this;this.addHomesListener(function(d){if(d.getType()==CollectionEvent.Type.ADD){var c=a.createHomeController(d.getItem());a.homeControllers.push(c);a.getHomeRecorder().addHome(d.getItem());c.getView()}else{if(d.getType()==CollectionEvent.Type.DELETE){a.homeControllers.splice(d.getIndex(),1);a.getHomeRecorder().removeHome(d.getItem())}}})}SweetHome3DJSApplication.prototype=Object.create(HomeApplication.prototype);SweetHome3DJSApplication.prototype.constructor=SweetHome3DJSApplication;SweetHome3DJSApplication.prototype.getVersion=function(){return"6.6.4i"};SweetHome3DJSApplication.prototype.getHomeController=function(a){return this.homeControllers[this.getHomes().indexOf(a)]};SweetHome3DJSApplication.prototype.getHomeRecorder=function(){if(!this.homeRecorder){this.homeRecorder=new IncrementalHomeRecorder(this,this.params)}return this.homeRecorder};SweetHome3DJSApplication.prototype.getUserPreferences=function(){if(this.preferences==null){if(this.params===undefined){this.preferences=new DefaultUserPreferences()}else{this.preferences=new RecordedUserPreferences(this.params)}this.preferences.setFurnitureViewedFromTop(true)}return this.preferences};SweetHome3DJSApplication.prototype.getViewFactory=function(){if(this.viewFactory==null){this.viewFactory=new JSViewFactory(this)}return this.viewFactory};SweetHome3DJSApplication.prototype.createHomeController=function(a){return new HomeController(a,this,this.getViewFactory())};
